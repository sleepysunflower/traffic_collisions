const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ModelOccurrence-DnJm3VgO.js","assets/mtheme-DLH-WzlQ.js","assets/ModelSeverity-CKJDnG33.js"])))=>i.map(i=>d[i]);
(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const tt of d)if(tt.type==="childList")for(const nt of tt.addedNodes)nt.tagName==="LINK"&&nt.rel==="modulepreload"&&c(nt)}).observe(document,{childList:!0,subtree:!0});function o(d){const tt={};return d.integrity&&(tt.integrity=d.integrity),d.referrerPolicy&&(tt.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?tt.credentials="include":d.crossOrigin==="anonymous"?tt.credentials="omit":tt.credentials="same-origin",tt}function c(d){if(d.ep)return;d.ep=!0;const tt=o(d);fetch(d.href,tt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var a=s.default;if(typeof a=="function"){var o=function c(){return this instanceof c?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};o.prototype=a.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(s).forEach(function(c){var d=Object.getOwnPropertyDescriptor(s,c);Object.defineProperty(o,c,d.get?d:{enumerable:!0,get:function(){return s[c]}})}),o}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$1(s){return s===null||typeof s!="object"?null:(s=z$2&&s[z$2]||s["@@iterator"],typeof s=="function"?s:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(s,a,o){this.props=s,this.context=a,this.refs=D$2,this.updater=o||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(s,a){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,a,"setState")};E$2.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$1(s,a,o){this.props=s,this.context=a,this.refs=D$2,this.updater=o||B$2}var H$2=G$1.prototype=new F$1;H$2.constructor=G$1;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$2={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$1(s,a,o){var c,d={},tt=null,nt=null;if(a!=null)for(c in a.ref!==void 0&&(nt=a.ref),a.key!==void 0&&(tt=""+a.key),a)J$1.call(a,c)&&!L$2.hasOwnProperty(c)&&(d[c]=a[c]);var it=arguments.length-2;if(it===1)d.children=o;else if(1<it){for(var st=Array(it),ut=0;ut<it;ut++)st[ut]=arguments[ut+2];d.children=st}if(s&&s.defaultProps)for(c in it=s.defaultProps,it)d[c]===void 0&&(d[c]=it[c]);return{$$typeof:l$1,type:s,key:tt,ref:nt,props:d,_owner:K$2.current}}function N$2(s,a){return{$$typeof:l$1,type:s.type,key:a,ref:s.ref,props:s.props,_owner:s._owner}}function O$2(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape(s){var a={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(o){return a[o]})}var P$2=/\/+/g;function Q$1(s,a){return typeof s=="object"&&s!==null&&s.key!=null?escape(""+s.key):a.toString(36)}function R$2(s,a,o,c,d){var tt=typeof s;(tt==="undefined"||tt==="boolean")&&(s=null);var nt=!1;if(s===null)nt=!0;else switch(tt){case"string":case"number":nt=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:nt=!0}}if(nt)return nt=s,d=d(nt),s=c===""?"."+Q$1(nt,0):c,I$2(d)?(o="",s!=null&&(o=s.replace(P$2,"$&/")+"/"),R$2(d,a,o,"",function(ut){return ut})):d!=null&&(O$2(d)&&(d=N$2(d,o+(!d.key||nt&&nt.key===d.key?"":(""+d.key).replace(P$2,"$&/")+"/")+s)),a.push(d)),1;if(nt=0,c=c===""?".":c+":",I$2(s))for(var it=0;it<s.length;it++){tt=s[it];var st=c+Q$1(tt,it);nt+=R$2(tt,a,o,st,d)}else if(st=A$1(s),typeof st=="function")for(s=st.call(s),it=0;!(tt=s.next()).done;)tt=tt.value,st=c+Q$1(tt,it++),nt+=R$2(tt,a,o,st,d);else if(tt==="object")throw a=String(s),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return nt}function S$2(s,a,o){if(s==null)return s;var c=[],d=0;return R$2(s,c,"","",function(tt){return a.call(o,tt,d++)}),c}function T$1(s){if(s._status===-1){var a=s._result;a=a(),a.then(function(o){(s._status===0||s._status===-1)&&(s._status=1,s._result=o)},function(o){(s._status===0||s._status===-1)&&(s._status=2,s._result=o)}),s._status===-1&&(s._status=0,s._result=a)}if(s._status===1)return s._result.default;throw s._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$2};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(s,a,o){S$2(s,function(){a.apply(this,arguments)},o)},count:function(s){var a=0;return S$2(s,function(){a++}),a},toArray:function(s){return S$2(s,function(a){return a})||[]},only:function(s){if(!O$2(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$2;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(s,a,o){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var c=C$2({},s.props),d=s.key,tt=s.ref,nt=s._owner;if(a!=null){if(a.ref!==void 0&&(tt=a.ref,nt=K$2.current),a.key!==void 0&&(d=""+a.key),s.type&&s.type.defaultProps)var it=s.type.defaultProps;for(st in a)J$1.call(a,st)&&!L$2.hasOwnProperty(st)&&(c[st]=a[st]===void 0&&it!==void 0?it[st]:a[st])}var st=arguments.length-2;if(st===1)c.children=o;else if(1<st){it=Array(st);for(var ut=0;ut<st;ut++)it[ut]=arguments[ut+2];c.children=it}return{$$typeof:l$1,type:s.type,key:d,ref:tt,props:c,_owner:nt}};react_production_min.createContext=function(s){return s={$$typeof:u,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t,_context:s},s.Consumer=s};react_production_min.createElement=M$1;react_production_min.createFactory=function(s){var a=M$1.bind(null,s);return a.type=s,a};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$1,render:s}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(s){return{$$typeof:y$1,_payload:{_status:-1,_result:s},_init:T$1}};react_production_min.memo=function(s,a){return{$$typeof:x$1,type:s,compare:a===void 0?null:a}};react_production_min.startTransition=function(s){var a=V$2.transition;V$2.transition={};try{s()}finally{V$2.transition=a}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(s,a){return U$2.current.useCallback(s,a)};react_production_min.useContext=function(s){return U$2.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$2.current.useDeferredValue(s)};react_production_min.useEffect=function(s,a){return U$2.current.useEffect(s,a)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(s,a,o){return U$2.current.useImperativeHandle(s,a,o)};react_production_min.useInsertionEffect=function(s,a){return U$2.current.useInsertionEffect(s,a)};react_production_min.useLayoutEffect=function(s,a){return U$2.current.useLayoutEffect(s,a)};react_production_min.useMemo=function(s,a){return U$2.current.useMemo(s,a)};react_production_min.useReducer=function(s,a,o){return U$2.current.useReducer(s,a,o)};react_production_min.useRef=function(s){return U$2.current.useRef(s)};react_production_min.useState=function(s){return U$2.current.useState(s)};react_production_min.useSyncExternalStore=function(s,a,o){return U$2.current.useSyncExternalStore(s,a,o)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React$2=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$3=Object.prototype.hasOwnProperty,n=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(s,a,o){var c,d={},tt=null,nt=null;o!==void 0&&(tt=""+o),a.key!==void 0&&(tt=""+a.key),a.ref!==void 0&&(nt=a.ref);for(c in a)m$3.call(a,c)&&!p$2.hasOwnProperty(c)&&(d[c]=a[c]);if(s&&s.defaultProps)for(c in a=s.defaultProps,a)d[c]===void 0&&(d[c]=a[c]);return{$$typeof:k$2,type:s,key:tt,ref:nt,props:d,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function a(dr,mr){var Dr=dr.length;dr.push(mr);e:for(;0<Dr;){var kr=Dr-1>>>1,Yr=dr[kr];if(0<d(Yr,mr))dr[kr]=mr,dr[Dr]=Yr,Dr=kr;else break e}}function o(dr){return dr.length===0?null:dr[0]}function c(dr){if(dr.length===0)return null;var mr=dr[0],Dr=dr.pop();if(Dr!==mr){dr[0]=Dr;e:for(var kr=0,Yr=dr.length,Mr=Yr>>>1;kr<Mr;){var Jr=2*(kr+1)-1,an=dr[Jr],xn=Jr+1,Rn=dr[xn];if(0>d(an,Dr))xn<Yr&&0>d(Rn,an)?(dr[kr]=Rn,dr[xn]=Dr,kr=xn):(dr[kr]=an,dr[Jr]=Dr,kr=Jr);else if(xn<Yr&&0>d(Rn,Dr))dr[kr]=Rn,dr[xn]=Dr,kr=xn;else break e}}return mr}function d(dr,mr){var Dr=dr.sortIndex-mr.sortIndex;return Dr!==0?Dr:dr.id-mr.id}if(typeof performance=="object"&&typeof performance.now=="function"){var tt=performance;s.unstable_now=function(){return tt.now()}}else{var nt=Date,it=nt.now();s.unstable_now=function(){return nt.now()-it}}var st=[],ut=[],ct=1,ot=null,at=3,ht=!1,ft=!1,mt=!1,yt=typeof setTimeout=="function"?setTimeout:null,bt=typeof clearTimeout=="function"?clearTimeout:null,wt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Tt(dr){for(var mr=o(ut);mr!==null;){if(mr.callback===null)c(ut);else if(mr.startTime<=dr)c(ut),mr.sortIndex=mr.expirationTime,a(st,mr);else break;mr=o(ut)}}function Ct(dr){if(mt=!1,Tt(dr),!ft)if(o(st)!==null)ft=!0,nr(Dt);else{var mr=o(ut);mr!==null&&cr(Ct,mr.startTime-dr)}}function Dt(dr,mr){ft=!1,mt&&(mt=!1,bt(Ft),Ft=-1),ht=!0;var Dr=at;try{for(Tt(mr),ot=o(st);ot!==null&&(!(ot.expirationTime>mr)||dr&&!Ht());){var kr=ot.callback;if(typeof kr=="function"){ot.callback=null,at=ot.priorityLevel;var Yr=kr(ot.expirationTime<=mr);mr=s.unstable_now(),typeof Yr=="function"?ot.callback=Yr:ot===o(st)&&c(st),Tt(mr)}else c(st);ot=o(st)}if(ot!==null)var Mr=!0;else{var Jr=o(ut);Jr!==null&&cr(Ct,Jr.startTime-mr),Mr=!1}return Mr}finally{ot=null,at=Dr,ht=!1}}var Ot=!1,$t=null,Ft=-1,kt=5,Vt=-1;function Ht(){return!(s.unstable_now()-Vt<kt)}function Qt(){if($t!==null){var dr=s.unstable_now();Vt=dr;var mr=!0;try{mr=$t(!0,dr)}finally{mr?Xt():(Ot=!1,$t=null)}}else Ot=!1}var Xt;if(typeof wt=="function")Xt=function(){wt(Qt)};else if(typeof MessageChannel<"u"){var Zt=new MessageChannel,ar=Zt.port2;Zt.port1.onmessage=Qt,Xt=function(){ar.postMessage(null)}}else Xt=function(){yt(Qt,0)};function nr(dr){$t=dr,Ot||(Ot=!0,Xt())}function cr(dr,mr){Ft=yt(function(){dr(s.unstable_now())},mr)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(dr){dr.callback=null},s.unstable_continueExecution=function(){ft||ht||(ft=!0,nr(Dt))},s.unstable_forceFrameRate=function(dr){0>dr||125<dr?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<dr?Math.floor(1e3/dr):5},s.unstable_getCurrentPriorityLevel=function(){return at},s.unstable_getFirstCallbackNode=function(){return o(st)},s.unstable_next=function(dr){switch(at){case 1:case 2:case 3:var mr=3;break;default:mr=at}var Dr=at;at=mr;try{return dr()}finally{at=Dr}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(dr,mr){switch(dr){case 1:case 2:case 3:case 4:case 5:break;default:dr=3}var Dr=at;at=dr;try{return mr()}finally{at=Dr}},s.unstable_scheduleCallback=function(dr,mr,Dr){var kr=s.unstable_now();switch(typeof Dr=="object"&&Dr!==null?(Dr=Dr.delay,Dr=typeof Dr=="number"&&0<Dr?kr+Dr:kr):Dr=kr,dr){case 1:var Yr=-1;break;case 2:Yr=250;break;case 5:Yr=1073741823;break;case 4:Yr=1e4;break;default:Yr=5e3}return Yr=Dr+Yr,dr={id:ct++,callback:mr,priorityLevel:dr,startTime:Dr,expirationTime:Yr,sortIndex:-1},Dr>kr?(dr.sortIndex=Dr,a(ut,dr),o(st)===null&&dr===o(ut)&&(mt?(bt(Ft),Ft=-1):mt=!0,cr(Ct,Dr-kr))):(dr.sortIndex=Yr,a(st,dr),ft||ht||(ft=!0,nr(Dt))),dr},s.unstable_shouldYield=Ht,s.unstable_wrapCallback=function(dr){var mr=at;return function(){var Dr=at;at=mr;try{return dr.apply(this,arguments)}finally{at=Dr}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(s){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+s,o=1;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,a){ha(s,a),ha(s+"Capture",a)}function ha(s,a){for(ea[s]=a,s=0;s<a.length;s++)da.add(a[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,a,o,c){if(o!==null&&o.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,a,o,c){if(a===null||typeof a>"u"||pa(s,a,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function v(s,a,o,c,d,tt,nt){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=o,this.propertyName=s,this.type=a,this.sanitizeURL=tt,this.removeEmptyString=nt}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z$1[s]=new v(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var a=s[0];z$1[a]=new v(a,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z$1[s]=new v(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z$1[s]=new v(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z$1[s]=new v(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z$1[s]=new v(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z$1[s]=new v(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z$1[s]=new v(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z$1[s]=new v(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var a=s.replace(ra,sa);z$1[a]=new v(a,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var a=s.replace(ra,sa);z$1[a]=new v(a,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var a=s.replace(ra,sa);z$1[a]=new v(a,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z$1[s]=new v(s,1,!1,s.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z$1[s]=new v(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,a,o,c){var d=z$1.hasOwnProperty(a)?z$1[a]:null;(d!==null?d.type!==0:c||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(qa(a,o,d,c)&&(o=null),c||d===null?oa(a)&&(o===null?s.removeAttribute(a):s.setAttribute(a,""+o)):d.mustUseProperty?s[d.propertyName]=o===null?d.type===3?!1:"":o:(a=d.attributeName,c=d.attributeNamespace,o===null?s.removeAttribute(a):(d=d.type,o=d===3||d===4&&o===!0?"":""+o,c?s.setAttributeNS(c,a,o):s.setAttribute(a,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);La=a&&a[1]||""}return`
`+La+s}var Na=!1;function Oa(s,a){if(!s||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ut){var c=ut}Reflect.construct(s,[],a)}else{try{a.call()}catch(ut){c=ut}s.call(a.prototype)}else{try{throw Error()}catch(ut){c=ut}s()}}catch(ut){if(ut&&c&&typeof ut.stack=="string"){for(var d=ut.stack.split(`
`),tt=c.stack.split(`
`),nt=d.length-1,it=tt.length-1;1<=nt&&0<=it&&d[nt]!==tt[it];)it--;for(;1<=nt&&0<=it;nt--,it--)if(d[nt]!==tt[it]){if(nt!==1||it!==1)do if(nt--,it--,0>it||d[nt]!==tt[it]){var st=`
`+d[nt].replace(" at new "," at ");return s.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",s.displayName)),st}while(1<=nt&&0<=it);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return a=s.displayName||null,a!==null?a:Qa(s.type)||"Memo";case Ha:a=s._payload,s=s._init;try{return Qa(s(a))}catch{}}return null}function Ra(s){var a=s.type;switch(s.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=a.render,s=s.displayName||s.name||"",a.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(a);case 8:return a===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ua(s){var a=Ta(s)?"checked":"value",o=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),c=""+s[a];if(!s.hasOwnProperty(a)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,tt=o.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return d.call(this)},set:function(nt){c=""+nt,tt.call(this,nt)}}),Object.defineProperty(s,a,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(nt){c=""+nt},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=Ta(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,a){var o=a.checked;return A({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??s._wrapperState.initialChecked})}function Za(s,a){var o=a.defaultValue==null?"":a.defaultValue,c=a.checked!=null?a.checked:a.defaultChecked;o=Sa(a.value!=null?a.value:o),s._wrapperState={initialChecked:c,initialValue:o,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function ab(s,a){a=a.checked,a!=null&&ta(s,"checked",a,!1)}function bb(s,a){ab(s,a);var o=Sa(a.value),c=a.type;if(o!=null)c==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+o):s.value!==""+o&&(s.value=""+o);else if(c==="submit"||c==="reset"){s.removeAttribute("value");return}a.hasOwnProperty("value")?cb(s,a.type,o):a.hasOwnProperty("defaultValue")&&cb(s,a.type,Sa(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(s.defaultChecked=!!a.defaultChecked)}function db(s,a,o){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var c=a.type;if(!(c!=="submit"&&c!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+s._wrapperState.initialValue,o||a===s.value||(s.value=a),s.defaultValue=a}o=s.name,o!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,o!==""&&(s.name=o)}function cb(s,a,o){(a!=="number"||Xa(s.ownerDocument)!==s)&&(o==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+o&&(s.defaultValue=""+o))}var eb=Array.isArray;function fb(s,a,o,c){if(s=s.options,a){a={};for(var d=0;d<o.length;d++)a["$"+o[d]]=!0;for(o=0;o<s.length;o++)d=a.hasOwnProperty("$"+s[o].value),s[o].selected!==d&&(s[o].selected=d),d&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Sa(o),a=null,d=0;d<s.length;d++){if(s[d].value===o){s[d].selected=!0,c&&(s[d].defaultSelected=!0);return}a!==null||s[d].disabled||(a=s[d])}a!==null&&(a.selected=!0)}}function gb(s,a){if(a.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A({},a,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,a){var o=a.value;if(o==null){if(o=a.children,a=a.defaultValue,o!=null){if(a!=null)throw Error(p$1(92));if(eb(o)){if(1<o.length)throw Error(p$1(93));o=o[0]}a=o}a==null&&(a=""),o=a}s._wrapperState={initialValue:Sa(o)}}function ib(s,a){var o=Sa(a.value),c=Sa(a.defaultValue);o!=null&&(o=""+o,o!==s.value&&(s.value=o),a.defaultValue==null&&s.defaultValue!==o&&(s.defaultValue=o)),c!=null&&(s.defaultValue=""+c)}function jb(s){var a=s.textContent;a===s._wrapperState.initialValue&&a!==""&&a!==null&&(s.value=a)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(s,a){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(a):s==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,o,c,d){MSApp.execUnsafeLocalFunction(function(){return s(a,o,c,d)})}:s}(function(s,a){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=a;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;a.firstChild;)s.appendChild(a.firstChild)}});function ob(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(a){a=a+s.charAt(0).toUpperCase()+s.substring(1),pb[a]=pb[s]})});function rb$1(s,a,o){return a==null||typeof a=="boolean"||a===""?"":o||typeof a!="number"||a===0||pb.hasOwnProperty(s)&&pb[s]?(""+a).trim():a+"px"}function sb(s,a){s=s.style;for(var o in a)if(a.hasOwnProperty(o)){var c=o.indexOf("--")===0,d=rb$1(o,a[o],c);o==="float"&&(o="cssFloat"),c?s.setProperty(o,d):s[o]=d}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,a){if(a){if(tb[s]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(p$1(137,s));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(p$1(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(p$1(61))}if(a.style!=null&&typeof a.style!="object")throw Error(p$1(62))}}function vb(s,a){if(s.indexOf("-")===-1)return typeof a.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p$1(280));var a=s.stateNode;a&&(a=Db(a),yb(s.stateNode,s.type,a))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,a=Ab;if(Ab=zb=null,Bb(s),a)for(s=0;s<a.length;s++)Bb(a[s])}}function Gb(s,a){return s(a)}function Hb(){}var Ib=!1;function Jb(s,a,o){if(Ib)return s(a,o);Ib=!0;try{return Gb(s,a,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,a){var o=s.stateNode;if(o===null)return null;var c=Db(o);if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(p$1(231,a,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,a,o,c,d,tt,nt,it,st){var ut=Array.prototype.slice.call(arguments,3);try{a.apply(o,ut)}catch(ct){this.onError(ct)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,a,o,c,d,tt,nt,it,st){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,a,o,c,d,tt,nt,it,st){if(Tb.apply(this,arguments),Ob){if(Ob){var ut=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=ut)}}function Vb(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,a.flags&4098&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function Wb(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p$1(188))}function Yb(s){var a=s.alternate;if(!a){if(a=Vb(s),a===null)throw Error(p$1(188));return a!==s?null:s}for(var o=s,c=a;;){var d=o.return;if(d===null)break;var tt=d.alternate;if(tt===null){if(c=d.return,c!==null){o=c;continue}break}if(d.child===tt.child){for(tt=d.child;tt;){if(tt===o)return Xb(d),s;if(tt===c)return Xb(d),a;tt=tt.sibling}throw Error(p$1(188))}if(o.return!==c.return)o=d,c=tt;else{for(var nt=!1,it=d.child;it;){if(it===o){nt=!0,o=d,c=tt;break}if(it===c){nt=!0,c=d,o=tt;break}it=it.sibling}if(!nt){for(it=tt.child;it;){if(it===o){nt=!0,o=tt,c=d;break}if(it===c){nt=!0,c=tt,o=d;break}it=it.sibling}if(!nt)throw Error(p$1(189))}}if(o.alternate!==c)throw Error(p$1(190))}if(o.tag!==3)throw Error(p$1(188));return o.stateNode.current===o?s:a}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var a=$b(s);if(a!==null)return a;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec$1=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,a){var o=s.pendingLanes;if(o===0)return 0;var c=0,d=s.suspendedLanes,tt=s.pingedLanes,nt=o&268435455;if(nt!==0){var it=nt&~d;it!==0?c=tc(it):(tt&=nt,tt!==0&&(c=tc(tt)))}else nt=o&~d,nt!==0?c=tc(nt):tt!==0&&(c=tc(tt));if(c===0)return 0;if(a!==0&&a!==c&&!(a&d)&&(d=c&-c,tt=a&-a,d>=tt||d===16&&(tt&4194240)!==0))return a;if(c&4&&(c|=o&16),a=s.entangledLanes,a!==0)for(s=s.entanglements,a&=c;0<a;)o=31-oc(a),d=1<<o,c|=s[o],a&=~d;return c}function vc(s,a){switch(s){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,d=s.expirationTimes,tt=s.pendingLanes;0<tt;){var nt=31-oc(tt),it=1<<nt,st=d[nt];st===-1?(!(it&o)||it&c)&&(d[nt]=vc(it,a)):st<=a&&(s.expiredLanes|=it),tt&=~it}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Ac(s,a,o){s.pendingLanes|=a,a!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,a=31-oc(a),s[a]=o}function Bc(s,a){var o=s.pendingLanes&~a;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=a,s.mutableReadLanes&=a,s.entangledLanes&=a,a=s.entanglements;var c=s.eventTimes;for(s=s.expirationTimes;0<o;){var d=31-oc(o),tt=1<<d;a[d]=0,c[d]=-1,s[d]=-1,o&=~tt}}function Cc(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-oc(o),d=1<<c;d&a|s[c]&a&&(s[c]|=a),o&=~d}}var C$1=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,a){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(a.pointerId)}}function Tc(s,a,o,c,d,tt){return s===null||s.nativeEvent!==tt?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:tt,targetContainers:[d]},a!==null&&(a=Cb(a),a!==null&&Fc(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,d!==null&&a.indexOf(d)===-1&&a.push(d),s)}function Uc(s,a,o,c,d){switch(a){case"focusin":return Lc=Tc(Lc,s,a,o,c,d),!0;case"dragenter":return Mc=Tc(Mc,s,a,o,c,d),!0;case"mouseover":return Nc=Tc(Nc,s,a,o,c,d),!0;case"pointerover":var tt=d.pointerId;return Oc.set(tt,Tc(Oc.get(tt)||null,s,a,o,c,d)),!0;case"gotpointercapture":return tt=d.pointerId,Pc.set(tt,Tc(Pc.get(tt)||null,s,a,o,c,d)),!0}return!1}function Vc(s){var a=Wc(s.target);if(a!==null){var o=Vb(a);if(o!==null){if(a=o.tag,a===13){if(a=Wb(o),a!==null){s.blockedOn=a,Ic(s.priority,function(){Gc(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=Yc(s.domEventName,s.eventSystemFlags,a[0],s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);wb=c,o.target.dispatchEvent(c),wb=null}else return a=Cb(o),a!==null&&Fc(a),s.blockedOn=o,!1;a.shift()}return!0}function Zc(s,a,o){Xc(s)&&o.delete(a)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,a){s.blockedOn===a&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function a(d){return ad(d,s)}if(0<Kc.length){ad(Kc[0],s);for(var o=1;o<Kc.length;o++){var c=Kc[o];c.blockedOn===s&&(c.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(a),Pc.forEach(a),o=0;o<Qc.length;o++)c=Qc[o],c.blockedOn===s&&(c.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,a,o,c){var d=C$1,tt=cd.transition;cd.transition=null;try{C$1=1,fd$1(s,a,o,c)}finally{C$1=d,cd.transition=tt}}function gd(s,a,o,c){var d=C$1,tt=cd.transition;cd.transition=null;try{C$1=4,fd$1(s,a,o,c)}finally{C$1=d,cd.transition=tt}}function fd$1(s,a,o,c){if(dd){var d=Yc(s,a,o,c);if(d===null)hd(s,a,c,id$1,o),Sc(s,c);else if(Uc(d,s,a,o,c))c.stopPropagation();else if(Sc(s,c),a&4&&-1<Rc.indexOf(s)){for(;d!==null;){var tt=Cb(d);if(tt!==null&&Ec(tt),tt=Yc(s,a,o,c),tt===null&&hd(s,a,c,id$1,o),tt===d)break;d=tt}d!==null&&c.stopPropagation()}else hd(s,a,c,null,o)}}var id$1=null;function Yc(s,a,o,c){if(id$1=null,s=xb(c),s=Wc(s),s!==null)if(a=Vb(s),a===null)s=null;else if(o=a.tag,o===13){if(s=Wb(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null);return id$1=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,a=ld,o=a.length,c,d="value"in kd?kd.value:kd.textContent,tt=d.length;for(s=0;s<o&&a[s]===d[s];s++);var nt=o-s;for(c=1;c<=nt&&a[o-c]===d[tt-c];c++);return md=d.slice(s,1<c?1-c:void 0)}function od(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function a(o,c,d,tt,nt){this._reactName=o,this._targetInst=d,this.type=c,this.nativeEvent=tt,this.target=nt,this.currentTarget=null;for(var it in s)s.hasOwnProperty(it)&&(o=s[it],this[it]=o?o(tt):tt[it]);return this.isDefaultPrevented=(tt.defaultPrevented!=null?tt.defaultPrevented:tt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),a}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Od[s])?!!a[s]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(s){if(s.key){var a=Md[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be,de=ia&&(!ae$1||be&&8<be&&11>=be),ee$1=" ",fe=!1;function ge(s,a){switch(s){case"keyup":return $d.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,a){switch(s){case"compositionend":return he(a);case"keypress":return a.which!==32?null:(fe=!0,ee$1);case"textInput":return s=a.data,s===ee$1&&fe?null:s;default:return null}}function ke(s,a){if(ie)return s==="compositionend"||!ae$1&&ge(s,a)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return de&&a.locale!=="ko"?null:a.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!le[s.type]:a==="textarea"}function ne$1(s,a,o,c){Eb(c),a=oe$1(a,"onChange"),0<a.length&&(o=new td$1("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var pe=null,qe=null;function re$1(s){se$1(s,0)}function te$1(s){var a=ue(s);if(Wa(a))return s}function ve(s,a){if(s==="change")return a}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te$1(qe)){var a=[];ne$1(a,qe,s,xb(s)),Jb(re$1,a)}}function Ce(s,a,o){s==="focusin"?(Ae(),pe=a,qe=o,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te$1(qe)}function Ee(s,a){if(s==="click")return te$1(a)}function Fe(s,a){if(s==="input"||s==="change")return te$1(a)}function Ge(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,a){if(He(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var d=o[c];if(!ja.call(a,d)||!He(s[d],a[d]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,a){var o=Je(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Je(o)}}function Le(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Le(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Me(){for(var s=window,a=Xa();a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Xa(s.document)}return a}function Ne(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}function Oe(s){var a=Me(),o=s.focusedElem,c=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(c!==null&&Ne(o)){if(a=c.start,s=c.end,s===void 0&&(s=a),"selectionStart"in o)o.selectionStart=a,o.selectionEnd=Math.min(s,o.value.length);else if(s=(a=o.ownerDocument||document)&&a.defaultView||window,s.getSelection){s=s.getSelection();var d=o.textContent.length,tt=Math.min(c.start,d);c=c.end===void 0?tt:Math.min(c.end,d),!s.extend&&tt>c&&(d=c,c=tt,tt=d),d=Ke(o,tt);var nt=Ke(o,c);d&&nt&&(s.rangeCount!==1||s.anchorNode!==d.node||s.anchorOffset!==d.offset||s.focusNode!==nt.node||s.focusOffset!==nt.offset)&&(a=a.createRange(),a.setStart(d.node,d.offset),s.removeAllRanges(),tt>c?(s.addRange(a),s.extend(nt.node,nt.offset)):(a.setEnd(nt.node,nt.offset),s.addRange(a)))}}for(a=[],s=o;s=s.parentNode;)s.nodeType===1&&a.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<a.length;o++)s=a[o],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te||Qe==null||Qe!==Xa(c)||(c=Qe,"selectionStart"in c&&Ne(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Se&&Ie(Se,c)||(Se=c,c=oe$1(Re,"onSelect"),0<c.length&&(a=new td$1("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=Qe)))}function Ve(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye$1={};ia&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var a=We[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in Ye$1)return Xe[s]=a[o];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,a){df.set(s,a),fa(a,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,a,o){var c=s.type||"unknown-event";s.currentTarget=o,Ub(c,a,void 0,s),s.currentTarget=null}function se$1(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],d=c.event;c=c.listeners;e:{var tt=void 0;if(a)for(var nt=c.length-1;0<=nt;nt--){var it=c[nt],st=it.instance,ut=it.currentTarget;if(it=it.listener,st!==tt&&d.isPropagationStopped())break e;nf(d,it,ut),tt=st}else for(nt=0;nt<c.length;nt++){if(it=c[nt],st=it.instance,ut=it.currentTarget,it=it.listener,st!==tt&&d.isPropagationStopped())break e;nf(d,it,ut),tt=st}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D$1(s,a){var o=a[of];o===void 0&&(o=a[of]=new Set);var c=s+"__bubble";o.has(c)||(pf(a,s,2,!1),o.add(c))}function qf(s,a,o){var c=0;a&&(c|=4),pf(o,s,c,a)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,s),qf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[rf]||(a[rf]=!0,qf("selectionchange",!1,a))}}function pf(s,a,o,c){switch(jd(a)){case 1:var d=ed;break;case 4:d=gd;break;default:d=fd$1}o=d.bind(null,a,o,s),d=void 0,!Lb||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(d=!0),c?d!==void 0?s.addEventListener(a,o,{capture:!0,passive:d}):s.addEventListener(a,o,!0):d!==void 0?s.addEventListener(a,o,{passive:d}):s.addEventListener(a,o,!1)}function hd(s,a,o,c,d){var tt=c;if(!(a&1)&&!(a&2)&&c!==null)e:for(;;){if(c===null)return;var nt=c.tag;if(nt===3||nt===4){var it=c.stateNode.containerInfo;if(it===d||it.nodeType===8&&it.parentNode===d)break;if(nt===4)for(nt=c.return;nt!==null;){var st=nt.tag;if((st===3||st===4)&&(st=nt.stateNode.containerInfo,st===d||st.nodeType===8&&st.parentNode===d))return;nt=nt.return}for(;it!==null;){if(nt=Wc(it),nt===null)return;if(st=nt.tag,st===5||st===6){c=tt=nt;continue e}it=it.parentNode}}c=c.return}Jb(function(){var ut=tt,ct=xb(o),ot=[];e:{var at=df.get(s);if(at!==void 0){var ht=td$1,ft=s;switch(s){case"keypress":if(od(o)===0)break e;case"keydown":case"keyup":ht=Rd;break;case"focusin":ft="focus",ht=Fd;break;case"focusout":ft="blur",ht=Fd;break;case"beforeblur":case"afterblur":ht=Fd;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ht=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ht=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ht=Vd;break;case $e:case af:case bf:ht=Hd;break;case cf:ht=Xd;break;case"scroll":ht=vd;break;case"wheel":ht=Zd;break;case"copy":case"cut":case"paste":ht=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ht=Td}var mt=(a&4)!==0,yt=!mt&&s==="scroll",bt=mt?at!==null?at+"Capture":null:at;mt=[];for(var wt=ut,Tt;wt!==null;){Tt=wt;var Ct=Tt.stateNode;if(Tt.tag===5&&Ct!==null&&(Tt=Ct,bt!==null&&(Ct=Kb(wt,bt),Ct!=null&&mt.push(tf(wt,Ct,Tt)))),yt)break;wt=wt.return}0<mt.length&&(at=new ht(at,ft,null,o,ct),ot.push({event:at,listeners:mt}))}}if(!(a&7)){e:{if(at=s==="mouseover"||s==="pointerover",ht=s==="mouseout"||s==="pointerout",at&&o!==wb&&(ft=o.relatedTarget||o.fromElement)&&(Wc(ft)||ft[uf]))break e;if((ht||at)&&(at=ct.window===ct?ct:(at=ct.ownerDocument)?at.defaultView||at.parentWindow:window,ht?(ft=o.relatedTarget||o.toElement,ht=ut,ft=ft?Wc(ft):null,ft!==null&&(yt=Vb(ft),ft!==yt||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(ht=null,ft=ut),ht!==ft)){if(mt=Bd,Ct="onMouseLeave",bt="onMouseEnter",wt="mouse",(s==="pointerout"||s==="pointerover")&&(mt=Td,Ct="onPointerLeave",bt="onPointerEnter",wt="pointer"),yt=ht==null?at:ue(ht),Tt=ft==null?at:ue(ft),at=new mt(Ct,wt+"leave",ht,o,ct),at.target=yt,at.relatedTarget=Tt,Ct=null,Wc(ct)===ut&&(mt=new mt(bt,wt+"enter",ft,o,ct),mt.target=Tt,mt.relatedTarget=yt,Ct=mt),yt=Ct,ht&&ft)t:{for(mt=ht,bt=ft,wt=0,Tt=mt;Tt;Tt=vf(Tt))wt++;for(Tt=0,Ct=bt;Ct;Ct=vf(Ct))Tt++;for(;0<wt-Tt;)mt=vf(mt),wt--;for(;0<Tt-wt;)bt=vf(bt),Tt--;for(;wt--;){if(mt===bt||bt!==null&&mt===bt.alternate)break t;mt=vf(mt),bt=vf(bt)}mt=null}else mt=null;ht!==null&&wf(ot,at,ht,mt,!1),ft!==null&&yt!==null&&wf(ot,yt,ft,mt,!0)}}e:{if(at=ut?ue(ut):window,ht=at.nodeName&&at.nodeName.toLowerCase(),ht==="select"||ht==="input"&&at.type==="file")var Dt=ve;else if(me(at))if(we)Dt=Fe;else{Dt=De;var Ot=Ce}else(ht=at.nodeName)&&ht.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(Dt=Ee);if(Dt&&(Dt=Dt(s,ut))){ne$1(ot,Dt,o,ct);break e}Ot&&Ot(s,at,ut),s==="focusout"&&(Ot=at._wrapperState)&&Ot.controlled&&at.type==="number"&&cb(at,"number",at.value)}switch(Ot=ut?ue(ut):window,s){case"focusin":(me(Ot)||Ot.contentEditable==="true")&&(Qe=Ot,Re=ut,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ot,o,ct);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ot,o,ct)}var $t;if(ae$1)e:{switch(s){case"compositionstart":var Ft="onCompositionStart";break e;case"compositionend":Ft="onCompositionEnd";break e;case"compositionupdate":Ft="onCompositionUpdate";break e}Ft=void 0}else ie?ge(s,o)&&(Ft="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ft="onCompositionStart");Ft&&(de&&o.locale!=="ko"&&(ie||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&ie&&($t=nd()):(kd=ct,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Ot=oe$1(ut,Ft),0<Ot.length&&(Ft=new Ld(Ft,s,null,o,ct),ot.push({event:Ft,listeners:Ot}),$t?Ft.data=$t:($t=he(o),$t!==null&&(Ft.data=$t)))),($t=ce$1?je(s,o):ke(s,o))&&(ut=oe$1(ut,"onBeforeInput"),0<ut.length&&(ct=new Ld("onBeforeInput","beforeinput",null,o,ct),ot.push({event:ct,listeners:ut}),ct.data=$t))}se$1(ot,a)})}function tf(s,a,o){return{instance:s,listener:a,currentTarget:o}}function oe$1(s,a){for(var o=a+"Capture",c=[];s!==null;){var d=s,tt=d.stateNode;d.tag===5&&tt!==null&&(d=tt,tt=Kb(s,o),tt!=null&&c.unshift(tf(s,tt,d)),tt=Kb(s,a),tt!=null&&c.push(tf(s,tt,d))),s=s.return}return c}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,a,o,c,d){for(var tt=a._reactName,nt=[];o!==null&&o!==c;){var it=o,st=it.alternate,ut=it.stateNode;if(st!==null&&st===c)break;it.tag===5&&ut!==null&&(it=ut,d?(st=Kb(o,tt),st!=null&&nt.unshift(tf(o,st,it))):d||(st=Kb(o,tt),st!=null&&nt.push(tf(o,st,it)))),o=o.return}nt.length!==0&&s.push({event:a,listeners:nt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,a,o){if(a=zf(a),zf(s)!==a&&o)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,a){var o=a,c=0;do{var d=o.nextSibling;if(s.removeChild(o),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(c===0){s.removeChild(d),bd(a);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=d}while(o);bd(a)}function Lf(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"){if(a===0)return s;a--}else o==="/$"&&a++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var a=s[Of];if(a)return a;for(var o=s.parentNode;o;){if(a=o[uf]||o[Of]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=Mf(s);s!==null;){if(o=s[Of])return o;s=Mf(s)}return a}s=o,o=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p$1(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E$1(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(s,a){Tf++,Sf[Tf]=s.current,s.current=a}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,a){var o=s.type.contextTypes;if(!o)return Vf;var c=s.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===a)return c.__reactInternalMemoizedMaskedChildContext;var d={},tt;for(tt in o)d[tt]=a[tt];return c&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=d),d}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(s,a,o){if(H$1.current!==Vf)throw Error(p$1(168));G(H$1,a),G(Wf,o)}function bg(s,a,o){var c=s.stateNode;if(a=a.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var d in c)if(!(d in a))throw Error(p$1(108,Ra(s)||"Unknown",d));return A({},o,c)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G(H$1,s),G(Wf,Wf.current),!0}function dg(s,a,o){var c=s.stateNode;if(!c)throw Error(p$1(169));o?(s=bg(s,a,Xf),c.__reactInternalMemoizedMergedChildContext=s,E$1(Wf),E$1(H$1),G(H$1,s)):E$1(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,a=C$1;try{var o=eg;for(C$1=1;s<o.length;s++){var c=o[s];do c=c(!0);while(c!==null)}eg=null,fg=!1}catch(d){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),d}finally{C$1=a,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,a){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=a}function ug(s,a,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var c=rg;s=sg;var d=32-oc(c)-1;c&=~(1<<d),o+=1;var tt=32-oc(a)+d;if(30<tt){var nt=d-d%5;tt=(c&(1<<nt)-1).toString(32),c>>=nt,d-=nt,rg=1<<32-oc(a)+d|o<<d|c,sg=tt+s}else rg=1<<tt|o<<d|c,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(s,a){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=a,o.return=s,a=s.deletions,a===null?(s.deletions=[o],s.flags|=16):a.push(o)}function Cg(s,a){switch(s.tag){case 5:var o=s.type;return a=a.nodeType!==1||o.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(s.stateNode=a,xg=s,yg=Lf(a.firstChild),!0):!1;case 6:return a=s.pendingProps===""||a.nodeType!==3?null:a,a!==null?(s.stateNode=a,xg=s,yg=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(o=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:a,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=a,o.return=s,s.child=o,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I$1){var a=yg;if(a){var o=a;if(!Cg(s,a)){if(Dg(s))throw Error(p$1(418));a=Lf(o.nextSibling);var c=xg;a&&Cg(s,a)?Ag(c,o):(s.flags=s.flags&-4097|2,I$1=!1,xg=s)}}else{if(Dg(s))throw Error(p$1(418));s.flags=s.flags&-4097|2,I$1=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I$1)return Fg(s),I$1=!0,!1;var a;if((a=s.tag!==3)&&!(a=s.tag!==5)&&(a=s.type,a=a!=="head"&&a!=="body"&&!Ef(s.type,s.memoizedProps)),a&&(a=yg)){if(Dg(s))throw Hg(),Error(p$1(418));for(;a;)Ag(s,a),a=Lf(a.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p$1(317));e:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"){if(a===0){yg=Lf(s.nextSibling);break e}a--}else o!=="$"&&o!=="$!"&&o!=="$?"||a++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,a,o){if(s=o.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p$1(309));var c=o.stateNode}if(!c)throw Error(p$1(147,s));var d=c,tt=""+s;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===tt?a.ref:(a=function(nt){var it=d.refs;nt===null?delete it[tt]:it[tt]=nt},a._stringRef=tt,a)}if(typeof s!="string")throw Error(p$1(284));if(!o._owner)throw Error(p$1(290,s))}return s}function Mg(s,a){throw s=Object.prototype.toString.call(a),Error(p$1(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s))}function Ng(s){var a=s._init;return a(s._payload)}function Og(s){function a(bt,wt){if(s){var Tt=bt.deletions;Tt===null?(bt.deletions=[wt],bt.flags|=16):Tt.push(wt)}}function o(bt,wt){if(!s)return null;for(;wt!==null;)a(bt,wt),wt=wt.sibling;return null}function c(bt,wt){for(bt=new Map;wt!==null;)wt.key!==null?bt.set(wt.key,wt):bt.set(wt.index,wt),wt=wt.sibling;return bt}function d(bt,wt){return bt=Pg(bt,wt),bt.index=0,bt.sibling=null,bt}function tt(bt,wt,Tt){return bt.index=Tt,s?(Tt=bt.alternate,Tt!==null?(Tt=Tt.index,Tt<wt?(bt.flags|=2,wt):Tt):(bt.flags|=2,wt)):(bt.flags|=1048576,wt)}function nt(bt){return s&&bt.alternate===null&&(bt.flags|=2),bt}function it(bt,wt,Tt,Ct){return wt===null||wt.tag!==6?(wt=Qg(Tt,bt.mode,Ct),wt.return=bt,wt):(wt=d(wt,Tt),wt.return=bt,wt)}function st(bt,wt,Tt,Ct){var Dt=Tt.type;return Dt===ya?ct(bt,wt,Tt.props.children,Ct,Tt.key):wt!==null&&(wt.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===Ha&&Ng(Dt)===wt.type)?(Ct=d(wt,Tt.props),Ct.ref=Lg(bt,wt,Tt),Ct.return=bt,Ct):(Ct=Rg(Tt.type,Tt.key,Tt.props,null,bt.mode,Ct),Ct.ref=Lg(bt,wt,Tt),Ct.return=bt,Ct)}function ut(bt,wt,Tt,Ct){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==Tt.containerInfo||wt.stateNode.implementation!==Tt.implementation?(wt=Sg(Tt,bt.mode,Ct),wt.return=bt,wt):(wt=d(wt,Tt.children||[]),wt.return=bt,wt)}function ct(bt,wt,Tt,Ct,Dt){return wt===null||wt.tag!==7?(wt=Tg(Tt,bt.mode,Ct,Dt),wt.return=bt,wt):(wt=d(wt,Tt),wt.return=bt,wt)}function ot(bt,wt,Tt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return wt=Qg(""+wt,bt.mode,Tt),wt.return=bt,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case va:return Tt=Rg(wt.type,wt.key,wt.props,null,bt.mode,Tt),Tt.ref=Lg(bt,null,wt),Tt.return=bt,Tt;case wa:return wt=Sg(wt,bt.mode,Tt),wt.return=bt,wt;case Ha:var Ct=wt._init;return ot(bt,Ct(wt._payload),Tt)}if(eb(wt)||Ka(wt))return wt=Tg(wt,bt.mode,Tt,null),wt.return=bt,wt;Mg(bt,wt)}return null}function at(bt,wt,Tt,Ct){var Dt=wt!==null?wt.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return Dt!==null?null:it(bt,wt,""+Tt,Ct);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case va:return Tt.key===Dt?st(bt,wt,Tt,Ct):null;case wa:return Tt.key===Dt?ut(bt,wt,Tt,Ct):null;case Ha:return Dt=Tt._init,at(bt,wt,Dt(Tt._payload),Ct)}if(eb(Tt)||Ka(Tt))return Dt!==null?null:ct(bt,wt,Tt,Ct,null);Mg(bt,Tt)}return null}function ht(bt,wt,Tt,Ct,Dt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return bt=bt.get(Tt)||null,it(wt,bt,""+Ct,Dt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case va:return bt=bt.get(Ct.key===null?Tt:Ct.key)||null,st(wt,bt,Ct,Dt);case wa:return bt=bt.get(Ct.key===null?Tt:Ct.key)||null,ut(wt,bt,Ct,Dt);case Ha:var Ot=Ct._init;return ht(bt,wt,Tt,Ot(Ct._payload),Dt)}if(eb(Ct)||Ka(Ct))return bt=bt.get(Tt)||null,ct(wt,bt,Ct,Dt,null);Mg(wt,Ct)}return null}function ft(bt,wt,Tt,Ct){for(var Dt=null,Ot=null,$t=wt,Ft=wt=0,kt=null;$t!==null&&Ft<Tt.length;Ft++){$t.index>Ft?(kt=$t,$t=null):kt=$t.sibling;var Vt=at(bt,$t,Tt[Ft],Ct);if(Vt===null){$t===null&&($t=kt);break}s&&$t&&Vt.alternate===null&&a(bt,$t),wt=tt(Vt,wt,Ft),Ot===null?Dt=Vt:Ot.sibling=Vt,Ot=Vt,$t=kt}if(Ft===Tt.length)return o(bt,$t),I$1&&tg(bt,Ft),Dt;if($t===null){for(;Ft<Tt.length;Ft++)$t=ot(bt,Tt[Ft],Ct),$t!==null&&(wt=tt($t,wt,Ft),Ot===null?Dt=$t:Ot.sibling=$t,Ot=$t);return I$1&&tg(bt,Ft),Dt}for($t=c(bt,$t);Ft<Tt.length;Ft++)kt=ht($t,bt,Ft,Tt[Ft],Ct),kt!==null&&(s&&kt.alternate!==null&&$t.delete(kt.key===null?Ft:kt.key),wt=tt(kt,wt,Ft),Ot===null?Dt=kt:Ot.sibling=kt,Ot=kt);return s&&$t.forEach(function(Ht){return a(bt,Ht)}),I$1&&tg(bt,Ft),Dt}function mt(bt,wt,Tt,Ct){var Dt=Ka(Tt);if(typeof Dt!="function")throw Error(p$1(150));if(Tt=Dt.call(Tt),Tt==null)throw Error(p$1(151));for(var Ot=Dt=null,$t=wt,Ft=wt=0,kt=null,Vt=Tt.next();$t!==null&&!Vt.done;Ft++,Vt=Tt.next()){$t.index>Ft?(kt=$t,$t=null):kt=$t.sibling;var Ht=at(bt,$t,Vt.value,Ct);if(Ht===null){$t===null&&($t=kt);break}s&&$t&&Ht.alternate===null&&a(bt,$t),wt=tt(Ht,wt,Ft),Ot===null?Dt=Ht:Ot.sibling=Ht,Ot=Ht,$t=kt}if(Vt.done)return o(bt,$t),I$1&&tg(bt,Ft),Dt;if($t===null){for(;!Vt.done;Ft++,Vt=Tt.next())Vt=ot(bt,Vt.value,Ct),Vt!==null&&(wt=tt(Vt,wt,Ft),Ot===null?Dt=Vt:Ot.sibling=Vt,Ot=Vt);return I$1&&tg(bt,Ft),Dt}for($t=c(bt,$t);!Vt.done;Ft++,Vt=Tt.next())Vt=ht($t,bt,Ft,Vt.value,Ct),Vt!==null&&(s&&Vt.alternate!==null&&$t.delete(Vt.key===null?Ft:Vt.key),wt=tt(Vt,wt,Ft),Ot===null?Dt=Vt:Ot.sibling=Vt,Ot=Vt);return s&&$t.forEach(function(Qt){return a(bt,Qt)}),I$1&&tg(bt,Ft),Dt}function yt(bt,wt,Tt,Ct){if(typeof Tt=="object"&&Tt!==null&&Tt.type===ya&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case va:e:{for(var Dt=Tt.key,Ot=wt;Ot!==null;){if(Ot.key===Dt){if(Dt=Tt.type,Dt===ya){if(Ot.tag===7){o(bt,Ot.sibling),wt=d(Ot,Tt.props.children),wt.return=bt,bt=wt;break e}}else if(Ot.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===Ha&&Ng(Dt)===Ot.type){o(bt,Ot.sibling),wt=d(Ot,Tt.props),wt.ref=Lg(bt,Ot,Tt),wt.return=bt,bt=wt;break e}o(bt,Ot);break}else a(bt,Ot);Ot=Ot.sibling}Tt.type===ya?(wt=Tg(Tt.props.children,bt.mode,Ct,Tt.key),wt.return=bt,bt=wt):(Ct=Rg(Tt.type,Tt.key,Tt.props,null,bt.mode,Ct),Ct.ref=Lg(bt,wt,Tt),Ct.return=bt,bt=Ct)}return nt(bt);case wa:e:{for(Ot=Tt.key;wt!==null;){if(wt.key===Ot)if(wt.tag===4&&wt.stateNode.containerInfo===Tt.containerInfo&&wt.stateNode.implementation===Tt.implementation){o(bt,wt.sibling),wt=d(wt,Tt.children||[]),wt.return=bt,bt=wt;break e}else{o(bt,wt);break}else a(bt,wt);wt=wt.sibling}wt=Sg(Tt,bt.mode,Ct),wt.return=bt,bt=wt}return nt(bt);case Ha:return Ot=Tt._init,yt(bt,wt,Ot(Tt._payload),Ct)}if(eb(Tt))return ft(bt,wt,Tt,Ct);if(Ka(Tt))return mt(bt,wt,Tt,Ct);Mg(bt,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"?(Tt=""+Tt,wt!==null&&wt.tag===6?(o(bt,wt.sibling),wt=d(wt,Tt),wt.return=bt,bt=wt):(o(bt,wt),wt=Qg(Tt,bt.mode,Ct),wt.return=bt,bt=wt),nt(bt)):o(bt,wt)}return yt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var a=Wg.current;E$1(Wg),s._currentValue=a}function bh(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function ch(s,a){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&a&&(dh=!0),s.firstContext=null)}function eh(s){var a=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:a,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return a}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,a,o,c){var d=a.interleaved;return d===null?(o.next=o,gh(a)):(o.next=d.next,d.next=o),a.interleaved=o,ih(s,c)}function ih(s,a){s.lanes|=a;var o=s.alternate;for(o!==null&&(o.lanes|=a),o=s,s=s.return;s!==null;)s.childLanes|=a,o=s.alternate,o!==null&&(o.childLanes|=a),o=s,s=s.return;return o.tag===3?o.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,a){return{eventTime:s,lane:a,tag:0,payload:null,callback:null,next:null}}function nh(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,K$1&2){var d=c.pending;return d===null?a.next=a:(a.next=d.next,d.next=a),c.pending=a,ih(s,o)}return d=c.interleaved,d===null?(a.next=a,gh(c)):(a.next=d.next,d.next=a),c.interleaved=a,ih(s,o)}function oh(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194240)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Cc(s,o)}}function ph(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var d=null,tt=null;if(o=o.firstBaseUpdate,o!==null){do{var nt={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};tt===null?d=tt=nt:tt=tt.next=nt,o=o.next}while(o!==null);tt===null?d=tt=a:tt=tt.next=a}else d=tt=a;o={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:tt,shared:c.shared,effects:c.effects},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}function qh(s,a,o,c){var d=s.updateQueue;jh=!1;var tt=d.firstBaseUpdate,nt=d.lastBaseUpdate,it=d.shared.pending;if(it!==null){d.shared.pending=null;var st=it,ut=st.next;st.next=null,nt===null?tt=ut:nt.next=ut,nt=st;var ct=s.alternate;ct!==null&&(ct=ct.updateQueue,it=ct.lastBaseUpdate,it!==nt&&(it===null?ct.firstBaseUpdate=ut:it.next=ut,ct.lastBaseUpdate=st))}if(tt!==null){var ot=d.baseState;nt=0,ct=ut=st=null,it=tt;do{var at=it.lane,ht=it.eventTime;if((c&at)===at){ct!==null&&(ct=ct.next={eventTime:ht,lane:0,tag:it.tag,payload:it.payload,callback:it.callback,next:null});e:{var ft=s,mt=it;switch(at=a,ht=o,mt.tag){case 1:if(ft=mt.payload,typeof ft=="function"){ot=ft.call(ht,ot,at);break e}ot=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=mt.payload,at=typeof ft=="function"?ft.call(ht,ot,at):ft,at==null)break e;ot=A({},ot,at);break e;case 2:jh=!0}}it.callback!==null&&it.lane!==0&&(s.flags|=64,at=d.effects,at===null?d.effects=[it]:at.push(it))}else ht={eventTime:ht,lane:at,tag:it.tag,payload:it.payload,callback:it.callback,next:null},ct===null?(ut=ct=ht,st=ot):ct=ct.next=ht,nt|=at;if(it=it.next,it===null){if(it=d.shared.pending,it===null)break;at=it,it=at.next,at.next=null,d.lastBaseUpdate=at,d.shared.pending=null}}while(!0);if(ct===null&&(st=ot),d.baseState=st,d.firstBaseUpdate=ut,d.lastBaseUpdate=ct,a=d.shared.interleaved,a!==null){d=a;do nt|=d.lane,d=d.next;while(d!==a)}else tt===null&&(d.shared.lanes=0);rh|=nt,s.lanes=nt,s.memoizedState=ot}}function sh(s,a,o){if(s=a.effects,a.effects=null,s!==null)for(a=0;a<s.length;a++){var c=s[a],d=c.callback;if(d!==null){if(c.callback=null,c=o,typeof d!="function")throw Error(p$1(191,d));d.call(c)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p$1(174));return s}function yh(s,a){switch(G(wh,a),G(vh,s),G(uh,th),s=a.nodeType,s){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:lb$1(null,"");break;default:s=s===8?a.parentNode:a,a=s.namespaceURI||null,s=s.tagName,a=lb$1(a,s)}E$1(uh),G(uh,a)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(s){xh(wh.current);var a=xh(uh.current),o=lb$1(a,s.type);a!==o&&(G(vh,s),G(uh,o))}function Bh(s){vh.current===s&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N$1=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$1(321))}function Mh(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!He(s[o],a[o]))return!1;return!0}function Nh(s,a,o,c,d,tt){if(Hh=tt,M=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=o(c,d),Jh){tt=0;do{if(Jh=!1,Kh=0,25<=tt)throw Error(p$1(301));tt+=1,O$1=N$1=null,a.updateQueue=null,Fh.current=Qh,s=o(c,d)}while(Jh)}if(Fh.current=Rh,a=N$1!==null&&N$1.next!==null,Hh=0,O$1=N$1=M=null,Ih=!1,a)throw Error(p$1(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M.memoizedState=O$1=s:O$1=O$1.next=s,O$1}function Uh(){if(N$1===null){var s=M.alternate;s=s!==null?s.memoizedState:null}else s=N$1.next;var a=O$1===null?M.memoizedState:O$1.next;if(a!==null)O$1=a,N$1=s;else{if(s===null)throw Error(p$1(310));N$1=s,s={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$1===null?M.memoizedState=O$1=s:O$1=O$1.next=s}return O$1}function Vh(s,a){return typeof a=="function"?a(s):a}function Wh(s){var a=Uh(),o=a.queue;if(o===null)throw Error(p$1(311));o.lastRenderedReducer=s;var c=N$1,d=c.baseQueue,tt=o.pending;if(tt!==null){if(d!==null){var nt=d.next;d.next=tt.next,tt.next=nt}c.baseQueue=d=tt,o.pending=null}if(d!==null){tt=d.next,c=c.baseState;var it=nt=null,st=null,ut=tt;do{var ct=ut.lane;if((Hh&ct)===ct)st!==null&&(st=st.next={lane:0,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null}),c=ut.hasEagerState?ut.eagerState:s(c,ut.action);else{var ot={lane:ct,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null};st===null?(it=st=ot,nt=c):st=st.next=ot,M.lanes|=ct,rh|=ct}ut=ut.next}while(ut!==null&&ut!==tt);st===null?nt=c:st.next=it,He(c,a.memoizedState)||(dh=!0),a.memoizedState=c,a.baseState=nt,a.baseQueue=st,o.lastRenderedState=c}if(s=o.interleaved,s!==null){d=s;do tt=d.lane,M.lanes|=tt,rh|=tt,d=d.next;while(d!==s)}else d===null&&(o.lanes=0);return[a.memoizedState,o.dispatch]}function Xh(s){var a=Uh(),o=a.queue;if(o===null)throw Error(p$1(311));o.lastRenderedReducer=s;var c=o.dispatch,d=o.pending,tt=a.memoizedState;if(d!==null){o.pending=null;var nt=d=d.next;do tt=s(tt,nt.action),nt=nt.next;while(nt!==d);He(tt,a.memoizedState)||(dh=!0),a.memoizedState=tt,a.baseQueue===null&&(a.baseState=tt),o.lastRenderedState=tt}return[tt,c]}function Yh(){}function Zh(s,a){var o=M,c=Uh(),d=a(),tt=!He(c.memoizedState,d);if(tt&&(c.memoizedState=d,dh=!0),c=c.queue,$h(ai.bind(null,o,c,s),[s]),c.getSnapshot!==a||tt||O$1!==null&&O$1.memoizedState.tag&1){if(o.flags|=2048,bi(9,ci.bind(null,o,c,d,a),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(o,a,d)}return d}function di(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=M.updateQueue,a===null?(a={lastEffect:null,stores:null},M.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function ci(s,a,o,c){a.value=o,a.getSnapshot=c,ei(a)&&fi(s)}function ai(s,a,o){return o(function(){ei(a)&&fi(s)})}function ei(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!He(s,o)}catch{return!0}}function fi(s){var a=ih(s,1);a!==null&&gi(a,s,1,-1)}function hi(s){var a=Th();return typeof s=="function"&&(s=s()),a.memoizedState=a.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},a.queue=s,s=s.dispatch=ii.bind(null,M,s),[a.memoizedState,s]}function bi(s,a,o,c){return s={tag:s,create:a,destroy:o,deps:c,next:null},a=M.updateQueue,a===null?(a={lastEffect:null,stores:null},M.updateQueue=a,a.lastEffect=s.next=s):(o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,a,o,c){var d=Th();M.flags|=s,d.memoizedState=bi(1|a,o,void 0,c===void 0?null:c)}function li(s,a,o,c){var d=Uh();c=c===void 0?null:c;var tt=void 0;if(N$1!==null){var nt=N$1.memoizedState;if(tt=nt.destroy,c!==null&&Mh(c,nt.deps)){d.memoizedState=bi(a,o,tt,c);return}}M.flags|=s,d.memoizedState=bi(1|a,o,tt,c)}function mi(s,a){return ki(8390656,8,s,a)}function $h(s,a){return li(2048,8,s,a)}function ni(s,a){return li(4,2,s,a)}function oi(s,a){return li(4,4,s,a)}function pi(s,a){if(typeof a=="function")return s=s(),a(s),function(){a(null)};if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function qi(s,a,o){return o=o!=null?o.concat([s]):null,li(4,4,pi.bind(null,a,s),o)}function ri(){}function si(s,a){var o=Uh();a=a===void 0?null:a;var c=o.memoizedState;return c!==null&&a!==null&&Mh(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function ti(s,a){var o=Uh();a=a===void 0?null:a;var c=o.memoizedState;return c!==null&&a!==null&&Mh(a,c[1])?c[0]:(s=s(),o.memoizedState=[s,a],s)}function ui(s,a,o){return Hh&21?(He(o,a)||(o=yc(),M.lanes|=o,rh|=o,s.baseState=!0),a):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=o)}function vi(s,a){var o=C$1;C$1=o!==0&&4>o?o:4,s(!0);var c=Gh.transition;Gh.transition={};try{s(!1),a()}finally{C$1=o,Gh.transition=c}}function wi(){return Uh().memoizedState}function xi(s,a,o){var c=yi(s);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(a,o);else if(o=hh(s,a,o,c),o!==null){var d=R$1();gi(o,s,c,d),Bi(o,a,c)}}function ii(s,a,o){var c=yi(s),d={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(a,d);else{var tt=s.alternate;if(s.lanes===0&&(tt===null||tt.lanes===0)&&(tt=a.lastRenderedReducer,tt!==null))try{var nt=a.lastRenderedState,it=tt(nt,o);if(d.hasEagerState=!0,d.eagerState=it,He(it,nt)){var st=a.interleaved;st===null?(d.next=d,gh(a)):(d.next=st.next,st.next=d),a.interleaved=d;return}}catch{}finally{}o=hh(s,a,d,c),o!==null&&(d=R$1(),gi(o,s,c,d),Bi(o,a,c))}}function zi(s){var a=s.alternate;return s===M||a!==null&&a===M}function Ai(s,a){Jh=Ih=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function Bi(s,a,o){if(o&4194240){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Cc(s,o)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,a){return Th().memoizedState=[s,a===void 0?null:a],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,a,o){return o=o!=null?o.concat([s]):null,ki(4194308,4,pi.bind(null,a,s),o)},useLayoutEffect:function(s,a){return ki(4194308,4,s,a)},useInsertionEffect:function(s,a){return ki(4,2,s,a)},useMemo:function(s,a){var o=Th();return a=a===void 0?null:a,s=s(),o.memoizedState=[s,a],s},useReducer:function(s,a,o){var c=Th();return a=o!==void 0?o(a):a,c.memoizedState=c.baseState=a,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:a},c.queue=s,s=s.dispatch=xi.bind(null,M,s),[c.memoizedState,s]},useRef:function(s){var a=Th();return s={current:s},a.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),a=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[a,s]},useMutableSource:function(){},useSyncExternalStore:function(s,a,o){var c=M,d=Th();if(I$1){if(o===void 0)throw Error(p$1(407));o=o()}else{if(o=a(),Q===null)throw Error(p$1(349));Hh&30||di(c,a,o)}d.memoizedState=o;var tt={value:o,getSnapshot:a};return d.queue=tt,mi(ai.bind(null,c,tt,s),[s]),c.flags|=2048,bi(9,ci.bind(null,c,tt,o,a),void 0,null),o},useId:function(){var s=Th(),a=Q.identifierPrefix;if(I$1){var o=sg,c=rg;o=(c&~(1<<32-oc(c)-1)).toString(32)+o,a=":"+a+"R"+o,o=Kh++,0<o&&(a+="H"+o.toString(32)),a+=":"}else o=Lh++,a=":"+a+"r"+o.toString(32)+":";return s.memoizedState=a},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var a=Uh();return ui(a,N$1.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],a=Uh().memoizedState;return[s,a]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var a=Uh();return N$1===null?a.memoizedState=s:ui(a,N$1.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],a=Uh().memoizedState;return[s,a]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,a){if(s&&s.defaultProps){a=A({},a),s=s.defaultProps;for(var o in s)a[o]===void 0&&(a[o]=s[o]);return a}return a}function Di(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:A({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,a,o){s=s._reactInternals;var c=R$1(),d=yi(s),tt=mh(c,d);tt.payload=a,o!=null&&(tt.callback=o),a=nh(s,tt,d),a!==null&&(gi(a,s,d,c),oh(a,s,d))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=R$1(),d=yi(s),tt=mh(c,d);tt.tag=1,tt.payload=a,o!=null&&(tt.callback=o),a=nh(s,tt,d),a!==null&&(gi(a,s,d,c),oh(a,s,d))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=R$1(),c=yi(s),d=mh(o,c);d.tag=2,a!=null&&(d.callback=a),a=nh(s,d,c),a!==null&&(gi(a,s,c,o),oh(a,s,c))}};function Fi(s,a,o,c,d,tt,nt){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,tt,nt):a.prototype&&a.prototype.isPureReactComponent?!Ie(o,c)||!Ie(d,tt):!0}function Gi(s,a,o){var c=!1,d=Vf,tt=a.contextType;return typeof tt=="object"&&tt!==null?tt=eh(tt):(d=Zf(a)?Xf:H$1.current,c=a.contextTypes,tt=(c=c!=null)?Yf(s,d):Vf),a=new a(o,tt),s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Ei,s.stateNode=a,a._reactInternals=s,c&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=d,s.__reactInternalMemoizedMaskedChildContext=tt),a}function Hi(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&Ei.enqueueReplaceState(a,a.state,null)}function Ii(s,a,o,c){var d=s.stateNode;d.props=o,d.state=s.memoizedState,d.refs={},kh(s);var tt=a.contextType;typeof tt=="object"&&tt!==null?d.context=eh(tt):(tt=Zf(a)?Xf:H$1.current,d.context=Yf(s,tt)),d.state=s.memoizedState,tt=a.getDerivedStateFromProps,typeof tt=="function"&&(Di(s,a,tt,o),d.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(a=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),a!==d.state&&Ei.enqueueReplaceState(d,d.state,null),qh(s,o,d,c),d.state=s.memoizedState),typeof d.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,a){try{var o="",c=a;do o+=Pa(c),c=c.return;while(c);var d=o}catch(tt){d=`
Error generating stack: `+tt.message+`
`+tt.stack}return{value:s,source:a,stack:d,digest:null}}function Ki(s,a,o){return{value:s,source:null,stack:o??null,digest:a??null}}function Li(s,a){try{console.error(a.value)}catch(o){setTimeout(function(){throw o})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,a,o){o=mh(-1,o),o.tag=3,o.payload={element:null};var c=a.value;return o.callback=function(){Oi||(Oi=!0,Pi=c),Li(s,a)},o}function Qi(s,a,o){o=mh(-1,o),o.tag=3;var c=s.type.getDerivedStateFromError;if(typeof c=="function"){var d=a.value;o.payload=function(){return c(d)},o.callback=function(){Li(s,a)}}var tt=s.stateNode;return tt!==null&&typeof tt.componentDidCatch=="function"&&(o.callback=function(){Li(s,a),typeof c!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var nt=a.stack;this.componentDidCatch(a.value,{componentStack:nt!==null?nt:""})}),o}function Si(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Mi;var d=new Set;c.set(a,d)}else d=c.get(a),d===void 0&&(d=new Set,c.set(a,d));d.has(o)||(d.add(o),s=Ti.bind(null,s,a,o),a.then(s,s))}function Ui(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function Vi(s,a,o,c,d){return s.mode&1?(s.flags|=65536,s.lanes=d,s):(s===a?s.flags|=65536:(s.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(a=mh(-1,1),a.tag=2,nh(o,a,1))),o.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,a,o,c){a.child=s===null?Vg(a,null,o,c):Ug(a,s.child,o,c)}function Yi(s,a,o,c,d){o=o.render;var tt=a.ref;return ch(a,d),c=Nh(s,a,o,c,tt,d),o=Sh(),s!==null&&!dh?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~d,Zi(s,a,d)):(I$1&&o&&vg(a),a.flags|=1,Xi(s,a,c,d),a.child)}function $i(s,a,o,c,d){if(s===null){var tt=o.type;return typeof tt=="function"&&!aj(tt)&&tt.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(a.tag=15,a.type=tt,bj(s,a,tt,c,d)):(s=Rg(o.type,null,c,a,a.mode,d),s.ref=a.ref,s.return=a,a.child=s)}if(tt=s.child,!(s.lanes&d)){var nt=tt.memoizedProps;if(o=o.compare,o=o!==null?o:Ie,o(nt,c)&&s.ref===a.ref)return Zi(s,a,d)}return a.flags|=1,s=Pg(tt,c),s.ref=a.ref,s.return=a,a.child=s}function bj(s,a,o,c,d){if(s!==null){var tt=s.memoizedProps;if(Ie(tt,c)&&s.ref===a.ref)if(dh=!1,a.pendingProps=c=tt,(s.lanes&d)!==0)s.flags&131072&&(dh=!0);else return a.lanes=s.lanes,Zi(s,a,d)}return cj(s,a,o,c,d)}function dj(s,a,o){var c=a.pendingProps,d=c.children,tt=s!==null?s.memoizedState:null;if(c.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=o;else{if(!(o&1073741824))return s=tt!==null?tt.baseLanes|o:o,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,G(ej,fj),fj|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=tt!==null?tt.baseLanes:o,G(ej,fj),fj|=c}else tt!==null?(c=tt.baseLanes|o,a.memoizedState=null):c=o,G(ej,fj),fj|=c;return Xi(s,a,d,o),a.child}function gj(s,a){var o=a.ref;(s===null&&o!==null||s!==null&&s.ref!==o)&&(a.flags|=512,a.flags|=2097152)}function cj(s,a,o,c,d){var tt=Zf(o)?Xf:H$1.current;return tt=Yf(a,tt),ch(a,d),o=Nh(s,a,o,c,tt,d),c=Sh(),s!==null&&!dh?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~d,Zi(s,a,d)):(I$1&&c&&vg(a),a.flags|=1,Xi(s,a,o,d),a.child)}function hj(s,a,o,c,d){if(Zf(o)){var tt=!0;cg(a)}else tt=!1;if(ch(a,d),a.stateNode===null)ij(s,a),Gi(a,o,c),Ii(a,o,c,d),c=!0;else if(s===null){var nt=a.stateNode,it=a.memoizedProps;nt.props=it;var st=nt.context,ut=o.contextType;typeof ut=="object"&&ut!==null?ut=eh(ut):(ut=Zf(o)?Xf:H$1.current,ut=Yf(a,ut));var ct=o.getDerivedStateFromProps,ot=typeof ct=="function"||typeof nt.getSnapshotBeforeUpdate=="function";ot||typeof nt.UNSAFE_componentWillReceiveProps!="function"&&typeof nt.componentWillReceiveProps!="function"||(it!==c||st!==ut)&&Hi(a,nt,c,ut),jh=!1;var at=a.memoizedState;nt.state=at,qh(a,c,nt,d),st=a.memoizedState,it!==c||at!==st||Wf.current||jh?(typeof ct=="function"&&(Di(a,o,ct,c),st=a.memoizedState),(it=jh||Fi(a,o,it,c,at,st,ut))?(ot||typeof nt.UNSAFE_componentWillMount!="function"&&typeof nt.componentWillMount!="function"||(typeof nt.componentWillMount=="function"&&nt.componentWillMount(),typeof nt.UNSAFE_componentWillMount=="function"&&nt.UNSAFE_componentWillMount()),typeof nt.componentDidMount=="function"&&(a.flags|=4194308)):(typeof nt.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=st),nt.props=c,nt.state=st,nt.context=ut,c=it):(typeof nt.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{nt=a.stateNode,lh(s,a),it=a.memoizedProps,ut=a.type===a.elementType?it:Ci(a.type,it),nt.props=ut,ot=a.pendingProps,at=nt.context,st=o.contextType,typeof st=="object"&&st!==null?st=eh(st):(st=Zf(o)?Xf:H$1.current,st=Yf(a,st));var ht=o.getDerivedStateFromProps;(ct=typeof ht=="function"||typeof nt.getSnapshotBeforeUpdate=="function")||typeof nt.UNSAFE_componentWillReceiveProps!="function"&&typeof nt.componentWillReceiveProps!="function"||(it!==ot||at!==st)&&Hi(a,nt,c,st),jh=!1,at=a.memoizedState,nt.state=at,qh(a,c,nt,d);var ft=a.memoizedState;it!==ot||at!==ft||Wf.current||jh?(typeof ht=="function"&&(Di(a,o,ht,c),ft=a.memoizedState),(ut=jh||Fi(a,o,ut,c,at,ft,st)||!1)?(ct||typeof nt.UNSAFE_componentWillUpdate!="function"&&typeof nt.componentWillUpdate!="function"||(typeof nt.componentWillUpdate=="function"&&nt.componentWillUpdate(c,ft,st),typeof nt.UNSAFE_componentWillUpdate=="function"&&nt.UNSAFE_componentWillUpdate(c,ft,st)),typeof nt.componentDidUpdate=="function"&&(a.flags|=4),typeof nt.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof nt.componentDidUpdate!="function"||it===s.memoizedProps&&at===s.memoizedState||(a.flags|=4),typeof nt.getSnapshotBeforeUpdate!="function"||it===s.memoizedProps&&at===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ft),nt.props=c,nt.state=ft,nt.context=st,c=ut):(typeof nt.componentDidUpdate!="function"||it===s.memoizedProps&&at===s.memoizedState||(a.flags|=4),typeof nt.getSnapshotBeforeUpdate!="function"||it===s.memoizedProps&&at===s.memoizedState||(a.flags|=1024),c=!1)}return jj(s,a,o,c,tt,d)}function jj(s,a,o,c,d,tt){gj(s,a);var nt=(a.flags&128)!==0;if(!c&&!nt)return d&&dg(a,o,!1),Zi(s,a,tt);c=a.stateNode,Wi.current=a;var it=nt&&typeof o.getDerivedStateFromError!="function"?null:c.render();return a.flags|=1,s!==null&&nt?(a.child=Ug(a,s.child,null,tt),a.child=Ug(a,null,it,tt)):Xi(s,a,it,tt),a.memoizedState=c.state,d&&dg(a,o,!0),a.child}function kj(s){var a=s.stateNode;a.pendingContext?ag(s,a.pendingContext,a.pendingContext!==a.context):a.context&&ag(s,a.context,!1),yh(s,a.containerInfo)}function lj(s,a,o,c,d){return Ig(),Jg(d),a.flags|=256,Xi(s,a,o,c),a.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,a,o){var c=a.pendingProps,d=L$1.current,tt=!1,nt=(a.flags&128)!==0,it;if((it=nt)||(it=s!==null&&s.memoizedState===null?!1:(d&2)!==0),it?(tt=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(d|=1),G(L$1,d&1),s===null)return Eg(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(a.mode&1?s.data==="$!"?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(nt=c.children,s=c.fallback,tt?(c=a.mode,tt=a.child,nt={mode:"hidden",children:nt},!(c&1)&&tt!==null?(tt.childLanes=0,tt.pendingProps=nt):tt=pj(nt,c,0,null),s=Tg(s,c,o,null),tt.return=a,s.return=a,tt.sibling=s,a.child=tt,a.child.memoizedState=nj(o),a.memoizedState=mj,s):qj(a,nt));if(d=s.memoizedState,d!==null&&(it=d.dehydrated,it!==null))return rj(s,a,nt,c,it,d,o);if(tt){tt=c.fallback,nt=a.mode,d=s.child,it=d.sibling;var st={mode:"hidden",children:c.children};return!(nt&1)&&a.child!==d?(c=a.child,c.childLanes=0,c.pendingProps=st,a.deletions=null):(c=Pg(d,st),c.subtreeFlags=d.subtreeFlags&14680064),it!==null?tt=Pg(it,tt):(tt=Tg(tt,nt,o,null),tt.flags|=2),tt.return=a,c.return=a,c.sibling=tt,a.child=c,c=tt,tt=a.child,nt=s.child.memoizedState,nt=nt===null?nj(o):{baseLanes:nt.baseLanes|o,cachePool:null,transitions:nt.transitions},tt.memoizedState=nt,tt.childLanes=s.childLanes&~o,a.memoizedState=mj,c}return tt=s.child,s=tt.sibling,c=Pg(tt,{mode:"visible",children:c.children}),!(a.mode&1)&&(c.lanes=o),c.return=a,c.sibling=null,s!==null&&(o=a.deletions,o===null?(a.deletions=[s],a.flags|=16):o.push(s)),a.child=c,a.memoizedState=null,c}function qj(s,a){return a=pj({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function sj(s,a,o,c){return c!==null&&Jg(c),Ug(a,s.child,null,o),s=qj(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function rj(s,a,o,c,d,tt,nt){if(o)return a.flags&256?(a.flags&=-257,c=Ki(Error(p$1(422))),sj(s,a,nt,c)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(tt=c.fallback,d=a.mode,c=pj({mode:"visible",children:c.children},d,0,null),tt=Tg(tt,d,nt,null),tt.flags|=2,c.return=a,tt.return=a,c.sibling=tt,a.child=c,a.mode&1&&Ug(a,s.child,null,nt),a.child.memoizedState=nj(nt),a.memoizedState=mj,tt);if(!(a.mode&1))return sj(s,a,nt,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var it=c.dgst;return c=it,tt=Error(p$1(419)),c=Ki(tt,c,void 0),sj(s,a,nt,c)}if(it=(nt&s.childLanes)!==0,dh||it){if(c=Q,c!==null){switch(nt&-nt){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|nt)?0:d,d!==0&&d!==tt.retryLane&&(tt.retryLane=d,ih(s,d),gi(c,s,d,-1))}return tj(),c=Ki(Error(p$1(421))),sj(s,a,nt,c)}return d.data==="$?"?(a.flags|=128,a.child=s.child,a=uj.bind(null,s),d._reactRetry=a,null):(s=tt.treeContext,yg=Lf(d.nextSibling),xg=a,I$1=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=a),a=qj(a,c.children),a.flags|=4096,a)}function vj(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),bh(s.return,a,o)}function wj(s,a,o,c,d){var tt=s.memoizedState;tt===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:d}:(tt.isBackwards=a,tt.rendering=null,tt.renderingStartTime=0,tt.last=c,tt.tail=o,tt.tailMode=d)}function xj(s,a,o){var c=a.pendingProps,d=c.revealOrder,tt=c.tail;if(Xi(s,a,c.children,o),c=L$1.current,c&2)c=c&1|2,a.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,o,a);else if(s.tag===19)vj(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}c&=1}if(G(L$1,c),!(a.mode&1))a.memoizedState=null;else switch(d){case"forwards":for(o=a.child,d=null;o!==null;)s=o.alternate,s!==null&&Ch(s)===null&&(d=o),o=o.sibling;o=d,o===null?(d=a.child,a.child=null):(d=o.sibling,o.sibling=null),wj(a,!1,d,o,tt);break;case"backwards":for(o=null,d=a.child,a.child=null;d!==null;){if(s=d.alternate,s!==null&&Ch(s)===null){a.child=d;break}s=d.sibling,d.sibling=o,o=d,d=s}wj(a,!0,o,null,tt);break;case"together":wj(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ij(s,a){!(a.mode&1)&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function Zi(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),rh|=a.lanes,!(o&a.childLanes))return null;if(s!==null&&a.child!==s.child)throw Error(p$1(153));if(a.child!==null){for(s=a.child,o=Pg(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Pg(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function yj(s,a,o){switch(a.tag){case 3:kj(a),Ig();break;case 5:Ah(a);break;case 1:Zf(a.type)&&cg(a);break;case 4:yh(a,a.stateNode.containerInfo);break;case 10:var c=a.type._context,d=a.memoizedProps.value;G(Wg,c._currentValue),c._currentValue=d;break;case 13:if(c=a.memoizedState,c!==null)return c.dehydrated!==null?(G(L$1,L$1.current&1),a.flags|=128,null):o&a.child.childLanes?oj(s,a,o):(G(L$1,L$1.current&1),s=Zi(s,a,o),s!==null?s.sibling:null);G(L$1,L$1.current&1);break;case 19:if(c=(o&a.childLanes)!==0,s.flags&128){if(c)return xj(s,a,o);a.flags|=128}if(d=a.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),G(L$1,L$1.current),c)break;return null;case 22:case 23:return a.lanes=0,dj(s,a,o)}return Zi(s,a,o)}var zj,Aj,Bj,Cj;zj=function(s,a){for(var o=a.child;o!==null;){if(o.tag===5||o.tag===6)s.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Aj=function(){};Bj=function(s,a,o,c){var d=s.memoizedProps;if(d!==c){s=a.stateNode,xh(uh.current);var tt=null;switch(o){case"input":d=Ya(s,d),c=Ya(s,c),tt=[];break;case"select":d=A({},d,{value:void 0}),c=A({},c,{value:void 0}),tt=[];break;case"textarea":d=gb(s,d),c=gb(s,c),tt=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(s.onclick=Bf)}ub(o,c);var nt;o=null;for(ut in d)if(!c.hasOwnProperty(ut)&&d.hasOwnProperty(ut)&&d[ut]!=null)if(ut==="style"){var it=d[ut];for(nt in it)it.hasOwnProperty(nt)&&(o||(o={}),o[nt]="")}else ut!=="dangerouslySetInnerHTML"&&ut!=="children"&&ut!=="suppressContentEditableWarning"&&ut!=="suppressHydrationWarning"&&ut!=="autoFocus"&&(ea.hasOwnProperty(ut)?tt||(tt=[]):(tt=tt||[]).push(ut,null));for(ut in c){var st=c[ut];if(it=d?.[ut],c.hasOwnProperty(ut)&&st!==it&&(st!=null||it!=null))if(ut==="style")if(it){for(nt in it)!it.hasOwnProperty(nt)||st&&st.hasOwnProperty(nt)||(o||(o={}),o[nt]="");for(nt in st)st.hasOwnProperty(nt)&&it[nt]!==st[nt]&&(o||(o={}),o[nt]=st[nt])}else o||(tt||(tt=[]),tt.push(ut,o)),o=st;else ut==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,it=it?it.__html:void 0,st!=null&&it!==st&&(tt=tt||[]).push(ut,st)):ut==="children"?typeof st!="string"&&typeof st!="number"||(tt=tt||[]).push(ut,""+st):ut!=="suppressContentEditableWarning"&&ut!=="suppressHydrationWarning"&&(ea.hasOwnProperty(ut)?(st!=null&&ut==="onScroll"&&D$1("scroll",s),tt||it===st||(tt=[])):(tt=tt||[]).push(ut,st))}o&&(tt=tt||[]).push("style",o);var ut=tt;(a.updateQueue=ut)&&(a.flags|=4)}};Cj=function(s,a,o,c){o!==c&&(a.flags|=4)};function Dj(s,a){if(!I$1)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function S$1(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var d=s.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=s,d=d.sibling;else for(d=s.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=s,d=d.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function Ej(s,a,o){var c=a.pendingProps;switch(wg(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(a),null;case 1:return Zf(a.type)&&$f(),S$1(a),null;case 3:return c=a.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Gg(a)?a.flags|=4:s===null||s.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,a),S$1(a),null;case 5:Bh(a);var d=xh(wh.current);if(o=a.type,s!==null&&a.stateNode!=null)Bj(s,a,o,c,d),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!c){if(a.stateNode===null)throw Error(p$1(166));return S$1(a),null}if(s=xh(uh.current),Gg(a)){c=a.stateNode,o=a.type;var tt=a.memoizedProps;switch(c[Of]=a,c[Pf]=tt,s=(a.mode&1)!==0,o){case"dialog":D$1("cancel",c),D$1("close",c);break;case"iframe":case"object":case"embed":D$1("load",c);break;case"video":case"audio":for(d=0;d<lf.length;d++)D$1(lf[d],c);break;case"source":D$1("error",c);break;case"img":case"image":case"link":D$1("error",c),D$1("load",c);break;case"details":D$1("toggle",c);break;case"input":Za(c,tt),D$1("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!tt.multiple},D$1("invalid",c);break;case"textarea":hb(c,tt),D$1("invalid",c)}ub(o,tt),d=null;for(var nt in tt)if(tt.hasOwnProperty(nt)){var it=tt[nt];nt==="children"?typeof it=="string"?c.textContent!==it&&(tt.suppressHydrationWarning!==!0&&Af(c.textContent,it,s),d=["children",it]):typeof it=="number"&&c.textContent!==""+it&&(tt.suppressHydrationWarning!==!0&&Af(c.textContent,it,s),d=["children",""+it]):ea.hasOwnProperty(nt)&&it!=null&&nt==="onScroll"&&D$1("scroll",c)}switch(o){case"input":Va(c),db(c,tt,!0);break;case"textarea":Va(c),jb(c);break;case"select":case"option":break;default:typeof tt.onClick=="function"&&(c.onclick=Bf)}c=d,a.updateQueue=c,c!==null&&(a.flags|=4)}else{nt=d.nodeType===9?d:d.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(o)),s==="http://www.w3.org/1999/xhtml"?o==="script"?(s=nt.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof c.is=="string"?s=nt.createElement(o,{is:c.is}):(s=nt.createElement(o),o==="select"&&(nt=s,c.multiple?nt.multiple=!0:c.size&&(nt.size=c.size))):s=nt.createElementNS(s,o),s[Of]=a,s[Pf]=c,zj(s,a,!1,!1),a.stateNode=s;e:{switch(nt=vb(o,c),o){case"dialog":D$1("cancel",s),D$1("close",s),d=c;break;case"iframe":case"object":case"embed":D$1("load",s),d=c;break;case"video":case"audio":for(d=0;d<lf.length;d++)D$1(lf[d],s);d=c;break;case"source":D$1("error",s),d=c;break;case"img":case"image":case"link":D$1("error",s),D$1("load",s),d=c;break;case"details":D$1("toggle",s),d=c;break;case"input":Za(s,c),d=Ya(s,c),D$1("invalid",s);break;case"option":d=c;break;case"select":s._wrapperState={wasMultiple:!!c.multiple},d=A({},c,{value:void 0}),D$1("invalid",s);break;case"textarea":hb(s,c),d=gb(s,c),D$1("invalid",s);break;default:d=c}ub(o,d),it=d;for(tt in it)if(it.hasOwnProperty(tt)){var st=it[tt];tt==="style"?sb(s,st):tt==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,st!=null&&nb(s,st)):tt==="children"?typeof st=="string"?(o!=="textarea"||st!=="")&&ob(s,st):typeof st=="number"&&ob(s,""+st):tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&tt!=="autoFocus"&&(ea.hasOwnProperty(tt)?st!=null&&tt==="onScroll"&&D$1("scroll",s):st!=null&&ta(s,tt,st,nt))}switch(o){case"input":Va(s),db(s,c,!1);break;case"textarea":Va(s),jb(s);break;case"option":c.value!=null&&s.setAttribute("value",""+Sa(c.value));break;case"select":s.multiple=!!c.multiple,tt=c.value,tt!=null?fb(s,!!c.multiple,tt,!1):c.defaultValue!=null&&fb(s,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(s.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return S$1(a),null;case 6:if(s&&a.stateNode!=null)Cj(s,a,s.memoizedProps,c);else{if(typeof c!="string"&&a.stateNode===null)throw Error(p$1(166));if(o=xh(wh.current),xh(uh.current),Gg(a)){if(c=a.stateNode,o=a.memoizedProps,c[Of]=a,(tt=c.nodeValue!==o)&&(s=xg,s!==null))switch(s.tag){case 3:Af(c.nodeValue,o,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(c.nodeValue,o,(s.mode&1)!==0)}tt&&(a.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[Of]=a,a.stateNode=c}return S$1(a),null;case 13:if(E$1(L$1),c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&a.mode&1&&!(a.flags&128))Hg(),Ig(),a.flags|=98560,tt=!1;else if(tt=Gg(a),c!==null&&c.dehydrated!==null){if(s===null){if(!tt)throw Error(p$1(318));if(tt=a.memoizedState,tt=tt!==null?tt.dehydrated:null,!tt)throw Error(p$1(317));tt[Of]=a}else Ig(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;S$1(a),tt=!1}else zg!==null&&(Fj(zg),zg=null),tt=!0;if(!tt)return a.flags&65536?a:null}return a.flags&128?(a.lanes=o,a):(c=c!==null,c!==(s!==null&&s.memoizedState!==null)&&c&&(a.child.flags|=8192,a.mode&1&&(s===null||L$1.current&1?T===0&&(T=3):tj())),a.updateQueue!==null&&(a.flags|=4),S$1(a),null);case 4:return zh(),Aj(s,a),s===null&&sf(a.stateNode.containerInfo),S$1(a),null;case 10:return ah(a.type._context),S$1(a),null;case 17:return Zf(a.type)&&$f(),S$1(a),null;case 19:if(E$1(L$1),tt=a.memoizedState,tt===null)return S$1(a),null;if(c=(a.flags&128)!==0,nt=tt.rendering,nt===null)if(c)Dj(tt,!1);else{if(T!==0||s!==null&&s.flags&128)for(s=a.child;s!==null;){if(nt=Ch(s),nt!==null){for(a.flags|=128,Dj(tt,!1),c=nt.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),a.subtreeFlags=0,c=o,o=a.child;o!==null;)tt=o,s=c,tt.flags&=14680066,nt=tt.alternate,nt===null?(tt.childLanes=0,tt.lanes=s,tt.child=null,tt.subtreeFlags=0,tt.memoizedProps=null,tt.memoizedState=null,tt.updateQueue=null,tt.dependencies=null,tt.stateNode=null):(tt.childLanes=nt.childLanes,tt.lanes=nt.lanes,tt.child=nt.child,tt.subtreeFlags=0,tt.deletions=null,tt.memoizedProps=nt.memoizedProps,tt.memoizedState=nt.memoizedState,tt.updateQueue=nt.updateQueue,tt.type=nt.type,s=nt.dependencies,tt.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),o=o.sibling;return G(L$1,L$1.current&1|2),a.child}s=s.sibling}tt.tail!==null&&B$1()>Gj&&(a.flags|=128,c=!0,Dj(tt,!1),a.lanes=4194304)}else{if(!c)if(s=Ch(nt),s!==null){if(a.flags|=128,c=!0,o=s.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),Dj(tt,!0),tt.tail===null&&tt.tailMode==="hidden"&&!nt.alternate&&!I$1)return S$1(a),null}else 2*B$1()-tt.renderingStartTime>Gj&&o!==1073741824&&(a.flags|=128,c=!0,Dj(tt,!1),a.lanes=4194304);tt.isBackwards?(nt.sibling=a.child,a.child=nt):(o=tt.last,o!==null?o.sibling=nt:a.child=nt,tt.last=nt)}return tt.tail!==null?(a=tt.tail,tt.rendering=a,tt.tail=a.sibling,tt.renderingStartTime=B$1(),a.sibling=null,o=L$1.current,G(L$1,c?o&1|2:o&1),a):(S$1(a),null);case 22:case 23:return Hj(),c=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==c&&(a.flags|=8192),c&&a.mode&1?fj&1073741824&&(S$1(a),a.subtreeFlags&6&&(a.flags|=8192)):S$1(a),null;case 24:return null;case 25:return null}throw Error(p$1(156,a.tag))}function Ij(s,a){switch(wg(a),a.tag){case 1:return Zf(a.type)&&$f(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),s=a.flags,s&65536&&!(s&128)?(a.flags=s&-65537|128,a):null;case 5:return Bh(a),null;case 13:if(E$1(L$1),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(p$1(340));Ig()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(a.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj(s,a){var o=s.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){W$1(s,a,c)}else o.current=null}function Mj(s,a,o){try{o()}catch(c){W$1(s,a,c)}}var Nj=!1;function Oj(s,a){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var d=c.anchorOffset,tt=c.focusNode;c=c.focusOffset;try{o.nodeType,tt.nodeType}catch{o=null;break e}var nt=0,it=-1,st=-1,ut=0,ct=0,ot=s,at=null;t:for(;;){for(var ht;ot!==o||d!==0&&ot.nodeType!==3||(it=nt+d),ot!==tt||c!==0&&ot.nodeType!==3||(st=nt+c),ot.nodeType===3&&(nt+=ot.nodeValue.length),(ht=ot.firstChild)!==null;)at=ot,ot=ht;for(;;){if(ot===s)break t;if(at===o&&++ut===d&&(it=nt),at===tt&&++ct===c&&(st=nt),(ht=ot.nextSibling)!==null)break;ot=at,at=ot.parentNode}ot=ht}o=it===-1||st===-1?null:{start:it,end:st}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:s,selectionRange:o},dd=!1,V$1=a;V$1!==null;)if(a=V$1,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,V$1=s;else for(;V$1!==null;){a=V$1;try{var ft=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var mt=ft.memoizedProps,yt=ft.memoizedState,bt=a.stateNode,wt=bt.getSnapshotBeforeUpdate(a.elementType===a.type?mt:Ci(a.type,mt),yt);bt.__reactInternalSnapshotBeforeUpdate=wt}break;case 3:var Tt=a.stateNode.containerInfo;Tt.nodeType===1?Tt.textContent="":Tt.nodeType===9&&Tt.documentElement&&Tt.removeChild(Tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(Ct){W$1(a,a.return,Ct)}if(s=a.sibling,s!==null){s.return=a.return,V$1=s;break}V$1=a.return}return ft=Nj,Nj=!1,ft}function Pj(s,a,o){var c=a.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&s)===s){var tt=d.destroy;d.destroy=void 0,tt!==void 0&&Mj(a,o,tt)}d=d.next}while(d!==c)}}function Qj(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var o=a=a.next;do{if((o.tag&s)===s){var c=o.create;o.destroy=c()}o=o.next}while(o!==a)}}function Rj(s){var a=s.ref;if(a!==null){var o=s.stateNode;switch(s.tag){case 5:s=o;break;default:s=o}typeof a=="function"?a(s):a.current=s}}function Sj(s){var a=s.alternate;a!==null&&(s.alternate=null,Sj(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&(delete a[Of],delete a[Pf],delete a[of],delete a[Qf],delete a[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.nodeType===8?o.parentNode.insertBefore(s,a):o.insertBefore(s,a):(o.nodeType===8?(a=o.parentNode,a.insertBefore(s,o)):(a=o,a.appendChild(s)),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Bf));else if(c!==4&&(s=s.child,s!==null))for(Vj(s,a,o),s=s.sibling;s!==null;)Vj(s,a,o),s=s.sibling}function Wj(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(s=s.child,s!==null))for(Wj(s,a,o),s=s.sibling;s!==null;)Wj(s,a,o),s=s.sibling}var X$1=null,Xj=!1;function Yj(s,a,o){for(o=o.child;o!==null;)Zj(s,a,o),o=o.sibling}function Zj(s,a,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U$1||Lj(o,a);case 6:var c=X$1,d=Xj;X$1=null,Yj(s,a,o),X$1=c,Xj=d,X$1!==null&&(Xj?(s=X$1,o=o.stateNode,s.nodeType===8?s.parentNode.removeChild(o):s.removeChild(o)):X$1.removeChild(o.stateNode));break;case 18:X$1!==null&&(Xj?(s=X$1,o=o.stateNode,s.nodeType===8?Kf(s.parentNode,o):s.nodeType===1&&Kf(s,o),bd(s)):Kf(X$1,o.stateNode));break;case 4:c=X$1,d=Xj,X$1=o.stateNode.containerInfo,Xj=!0,Yj(s,a,o),X$1=c,Xj=d;break;case 0:case 11:case 14:case 15:if(!U$1&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var tt=d,nt=tt.destroy;tt=tt.tag,nt!==void 0&&(tt&2||tt&4)&&Mj(o,a,nt),d=d.next}while(d!==c)}Yj(s,a,o);break;case 1:if(!U$1&&(Lj(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(it){W$1(o,a,it)}Yj(s,a,o);break;case 21:Yj(s,a,o);break;case 22:o.mode&1?(U$1=(c=U$1)||o.memoizedState!==null,Yj(s,a,o),U$1=c):Yj(s,a,o);break;default:Yj(s,a,o)}}function ak(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var o=s.stateNode;o===null&&(o=s.stateNode=new Kj),a.forEach(function(c){var d=bk.bind(null,s,c);o.has(c)||(o.add(c),c.then(d,d))})}}function ck(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];try{var tt=s,nt=a,it=nt;e:for(;it!==null;){switch(it.tag){case 5:X$1=it.stateNode,Xj=!1;break e;case 3:X$1=it.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=it.stateNode.containerInfo,Xj=!0;break e}it=it.return}if(X$1===null)throw Error(p$1(160));Zj(tt,nt,d),X$1=null,Xj=!1;var st=d.alternate;st!==null&&(st.return=null),d.return=null}catch(ut){W$1(d,a,ut)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)dk(a,s),a=a.sibling}function dk(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(a,s),ek(s),c&4){try{Pj(3,s,s.return),Qj(3,s)}catch(mt){W$1(s,s.return,mt)}try{Pj(5,s,s.return)}catch(mt){W$1(s,s.return,mt)}}break;case 1:ck(a,s),ek(s),c&512&&o!==null&&Lj(o,o.return);break;case 5:if(ck(a,s),ek(s),c&512&&o!==null&&Lj(o,o.return),s.flags&32){var d=s.stateNode;try{ob(d,"")}catch(mt){W$1(s,s.return,mt)}}if(c&4&&(d=s.stateNode,d!=null)){var tt=s.memoizedProps,nt=o!==null?o.memoizedProps:tt,it=s.type,st=s.updateQueue;if(s.updateQueue=null,st!==null)try{it==="input"&&tt.type==="radio"&&tt.name!=null&&ab(d,tt),vb(it,nt);var ut=vb(it,tt);for(nt=0;nt<st.length;nt+=2){var ct=st[nt],ot=st[nt+1];ct==="style"?sb(d,ot):ct==="dangerouslySetInnerHTML"?nb(d,ot):ct==="children"?ob(d,ot):ta(d,ct,ot,ut)}switch(it){case"input":bb(d,tt);break;case"textarea":ib(d,tt);break;case"select":var at=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!tt.multiple;var ht=tt.value;ht!=null?fb(d,!!tt.multiple,ht,!1):at!==!!tt.multiple&&(tt.defaultValue!=null?fb(d,!!tt.multiple,tt.defaultValue,!0):fb(d,!!tt.multiple,tt.multiple?[]:"",!1))}d[Pf]=tt}catch(mt){W$1(s,s.return,mt)}}break;case 6:if(ck(a,s),ek(s),c&4){if(s.stateNode===null)throw Error(p$1(162));d=s.stateNode,tt=s.memoizedProps;try{d.nodeValue=tt}catch(mt){W$1(s,s.return,mt)}}break;case 3:if(ck(a,s),ek(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(a.containerInfo)}catch(mt){W$1(s,s.return,mt)}break;case 4:ck(a,s),ek(s);break;case 13:ck(a,s),ek(s),d=s.child,d.flags&8192&&(tt=d.memoizedState!==null,d.stateNode.isHidden=tt,!tt||d.alternate!==null&&d.alternate.memoizedState!==null||(fk=B$1())),c&4&&ak(s);break;case 22:if(ct=o!==null&&o.memoizedState!==null,s.mode&1?(U$1=(ut=U$1)||ct,ck(a,s),U$1=ut):ck(a,s),ek(s),c&8192){if(ut=s.memoizedState!==null,(s.stateNode.isHidden=ut)&&!ct&&s.mode&1)for(V$1=s,ct=s.child;ct!==null;){for(ot=V$1=ct;V$1!==null;){switch(at=V$1,ht=at.child,at.tag){case 0:case 11:case 14:case 15:Pj(4,at,at.return);break;case 1:Lj(at,at.return);var ft=at.stateNode;if(typeof ft.componentWillUnmount=="function"){c=at,o=at.return;try{a=c,ft.props=a.memoizedProps,ft.state=a.memoizedState,ft.componentWillUnmount()}catch(mt){W$1(c,o,mt)}}break;case 5:Lj(at,at.return);break;case 22:if(at.memoizedState!==null){gk(ot);continue}}ht!==null?(ht.return=at,V$1=ht):gk(ot)}ct=ct.sibling}e:for(ct=null,ot=s;;){if(ot.tag===5){if(ct===null){ct=ot;try{d=ot.stateNode,ut?(tt=d.style,typeof tt.setProperty=="function"?tt.setProperty("display","none","important"):tt.display="none"):(it=ot.stateNode,st=ot.memoizedProps.style,nt=st!=null&&st.hasOwnProperty("display")?st.display:null,it.style.display=rb$1("display",nt))}catch(mt){W$1(s,s.return,mt)}}}else if(ot.tag===6){if(ct===null)try{ot.stateNode.nodeValue=ut?"":ot.memoizedProps}catch(mt){W$1(s,s.return,mt)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===s)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===s)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===s)break e;ct===ot&&(ct=null),ot=ot.return}ct===ot&&(ct=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:ck(a,s),ek(s),c&4&&ak(s);break;case 21:break;default:ck(a,s),ek(s)}}function ek(s){var a=s.flags;if(a&2){try{e:{for(var o=s.return;o!==null;){if(Tj(o)){var c=o;break e}o=o.return}throw Error(p$1(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(ob(d,""),c.flags&=-33);var tt=Uj(s);Wj(s,tt,d);break;case 3:case 4:var nt=c.stateNode.containerInfo,it=Uj(s);Vj(s,it,nt);break;default:throw Error(p$1(161))}}catch(st){W$1(s,s.return,st)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function hk(s,a,o){V$1=s,ik(s)}function ik(s,a,o){for(var c=(s.mode&1)!==0;V$1!==null;){var d=V$1,tt=d.child;if(d.tag===22&&c){var nt=d.memoizedState!==null||Jj;if(!nt){var it=d.alternate,st=it!==null&&it.memoizedState!==null||U$1;it=Jj;var ut=U$1;if(Jj=nt,(U$1=st)&&!ut)for(V$1=d;V$1!==null;)nt=V$1,st=nt.child,nt.tag===22&&nt.memoizedState!==null?jk(d):st!==null?(st.return=nt,V$1=st):jk(d);for(;tt!==null;)V$1=tt,ik(tt),tt=tt.sibling;V$1=d,Jj=it,U$1=ut}kk(s)}else d.subtreeFlags&8772&&tt!==null?(tt.return=d,V$1=tt):kk(s)}}function kk(s){for(;V$1!==null;){var a=V$1;if(a.flags&8772){var o=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:U$1||Qj(5,a);break;case 1:var c=a.stateNode;if(a.flags&4&&!U$1)if(o===null)c.componentDidMount();else{var d=a.elementType===a.type?o.memoizedProps:Ci(a.type,o.memoizedProps);c.componentDidUpdate(d,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var tt=a.updateQueue;tt!==null&&sh(a,tt,c);break;case 3:var nt=a.updateQueue;if(nt!==null){if(o=null,a.child!==null)switch(a.child.tag){case 5:o=a.child.stateNode;break;case 1:o=a.child.stateNode}sh(a,nt,o)}break;case 5:var it=a.stateNode;if(o===null&&a.flags&4){o=it;var st=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":st.autoFocus&&o.focus();break;case"img":st.src&&(o.src=st.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ut=a.alternate;if(ut!==null){var ct=ut.memoizedState;if(ct!==null){var ot=ct.dehydrated;ot!==null&&bd(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$1||a.flags&512&&Rj(a)}catch(at){W$1(a,a.return,at)}}if(a===s){V$1=null;break}if(o=a.sibling,o!==null){o.return=a.return,V$1=o;break}V$1=a.return}}function gk(s){for(;V$1!==null;){var a=V$1;if(a===s){V$1=null;break}var o=a.sibling;if(o!==null){o.return=a.return,V$1=o;break}V$1=a.return}}function jk(s){for(;V$1!==null;){var a=V$1;try{switch(a.tag){case 0:case 11:case 15:var o=a.return;try{Qj(4,a)}catch(st){W$1(a,o,st)}break;case 1:var c=a.stateNode;if(typeof c.componentDidMount=="function"){var d=a.return;try{c.componentDidMount()}catch(st){W$1(a,d,st)}}var tt=a.return;try{Rj(a)}catch(st){W$1(a,tt,st)}break;case 5:var nt=a.return;try{Rj(a)}catch(st){W$1(a,nt,st)}}}catch(st){W$1(a,a.return,st)}if(a===s){V$1=null;break}var it=a.sibling;if(it!==null){it.return=a.return,V$1=it;break}V$1=a.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K$1=0,Q=null,Y$1=null,Z$1=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$1&6?B$1():Ak!==-1?Ak:Ak=B$1()}function yi(s){return s.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C$1,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,a,o,c){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(s,o,c),(!(K$1&2)||s!==Q)&&(s===Q&&(!(K$1&2)&&(qk|=o),T===4&&Ck(s,Z$1)),Dk(s,c),o===1&&K$1===0&&!(a.mode&1)&&(Gj=B$1()+500,fg&&jg()))}function Dk(s,a){var o=s.callbackNode;wc(s,a);var c=uc(s,s===Q?Z$1:0);if(c===0)o!==null&&bc(o),s.callbackNode=null,s.callbackPriority=0;else if(a=c&-c,s.callbackPriority!==a){if(o!=null&&bc(o),a===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K$1&6)&&jg()}),o=null;else{switch(Dc(c)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Fk(o,Gk.bind(null,s))}s.callbackPriority=a,s.callbackNode=o}}function Gk(s,a){if(Ak=-1,Bk=0,K$1&6)throw Error(p$1(327));var o=s.callbackNode;if(Hk()&&s.callbackNode!==o)return null;var c=uc(s,s===Q?Z$1:0);if(c===0)return null;if(c&30||c&s.expiredLanes||a)a=Ik(s,c);else{a=c;var d=K$1;K$1|=2;var tt=Jk();(Q!==s||Z$1!==a)&&(uk=null,Gj=B$1()+500,Kk(s,a));do try{Lk();break}catch(it){Mk(s,it)}while(!0);$g(),mk.current=tt,K$1=d,Y$1!==null?a=0:(Q=null,Z$1=0,a=T)}if(a!==0){if(a===2&&(d=xc(s),d!==0&&(c=d,a=Nk(s,d))),a===1)throw o=pk,Kk(s,0),Ck(s,c),Dk(s,B$1()),o;if(a===6)Ck(s,c);else{if(d=s.current.alternate,!(c&30)&&!Ok(d)&&(a=Ik(s,c),a===2&&(tt=xc(s),tt!==0&&(c=tt,a=Nk(s,tt))),a===1))throw o=pk,Kk(s,0),Ck(s,c),Dk(s,B$1()),o;switch(s.finishedWork=d,s.finishedLanes=c,a){case 0:case 1:throw Error(p$1(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,c),(c&130023424)===c&&(a=fk+500-B$1(),10<a)){if(uc(s,0)!==0)break;if(d=s.suspendedLanes,(d&c)!==c){R$1(),s.pingedLanes|=s.suspendedLanes&d;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),a);break}Pk(s,tk,uk);break;case 4:if(Ck(s,c),(c&4194240)===c)break;for(a=s.eventTimes,d=-1;0<c;){var nt=31-oc(c);tt=1<<nt,nt=a[nt],nt>d&&(d=nt),c&=~tt}if(c=d,c=B$1()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*lk(c/1960))-c,10<c){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),c);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(s,B$1()),s.callbackNode===o?Gk.bind(null,s):null}function Nk(s,a){var o=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,a).flags|=256),s=Ik(s,a),s!==2&&(a=tk,tk=o,a!==null&&Fj(a)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var a=s;;){if(a.flags&16384){var o=a.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var d=o[c],tt=d.getSnapshot;d=d.value;try{if(!He(tt(),d))return!1}catch{return!1}}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ck(s,a){for(a&=~rk,a&=~qk,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var o=31-oc(a),c=1<<o;s[o]=-1,a&=~c}}function Ek(s){if(K$1&6)throw Error(p$1(327));Hk();var a=uc(s,0);if(!(a&1))return Dk(s,B$1()),null;var o=Ik(s,a);if(s.tag!==0&&o===2){var c=xc(s);c!==0&&(a=c,o=Nk(s,c))}if(o===1)throw o=pk,Kk(s,0),Ck(s,a),Dk(s,B$1()),o;if(o===6)throw Error(p$1(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,Pk(s,tk,uk),Dk(s,B$1()),null}function Qk(s,a){var o=K$1;K$1|=1;try{return s(a)}finally{K$1=o,K$1===0&&(Gj=B$1()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K$1&6)&&Hk();var a=K$1;K$1|=1;var o=ok.transition,c=C$1;try{if(ok.transition=null,C$1=1,s)return s()}finally{C$1=c,ok.transition=o,K$1=a,!(K$1&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(s,a){s.finishedWork=null,s.finishedLanes=0;var o=s.timeoutHandle;if(o!==-1&&(s.timeoutHandle=-1,Gf(o)),Y$1!==null)for(o=Y$1.return;o!==null;){var c=o;switch(wg(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(c);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(c.type._context);break;case 22:case 23:Hj()}o=o.return}if(Q=s,Y$1=s=Pg(s.current,null),Z$1=fj=a,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(a=0;a<fh.length;a++)if(o=fh[a],c=o.interleaved,c!==null){o.interleaved=null;var d=c.next,tt=o.pending;if(tt!==null){var nt=tt.next;tt.next=d,c.next=nt}o.pending=c}fh=null}return s}function Mk(s,a){do{var o=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var c=M.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}Ih=!1}if(Hh=0,O$1=N$1=M=null,Jh=!1,Kh=0,nk.current=null,o===null||o.return===null){T=1,pk=a,Y$1=null;break}e:{var tt=s,nt=o.return,it=o,st=a;if(a=Z$1,it.flags|=32768,st!==null&&typeof st=="object"&&typeof st.then=="function"){var ut=st,ct=it,ot=ct.tag;if(!(ct.mode&1)&&(ot===0||ot===11||ot===15)){var at=ct.alternate;at?(ct.updateQueue=at.updateQueue,ct.memoizedState=at.memoizedState,ct.lanes=at.lanes):(ct.updateQueue=null,ct.memoizedState=null)}var ht=Ui(nt);if(ht!==null){ht.flags&=-257,Vi(ht,nt,it,tt,a),ht.mode&1&&Si(tt,ut,a),a=ht,st=ut;var ft=a.updateQueue;if(ft===null){var mt=new Set;mt.add(st),a.updateQueue=mt}else ft.add(st);break e}else{if(!(a&1)){Si(tt,ut,a),tj();break e}st=Error(p$1(426))}}else if(I$1&&it.mode&1){var yt=Ui(nt);if(yt!==null){!(yt.flags&65536)&&(yt.flags|=256),Vi(yt,nt,it,tt,a),Jg(Ji(st,it));break e}}tt=st=Ji(st,it),T!==4&&(T=2),sk===null?sk=[tt]:sk.push(tt),tt=nt;do{switch(tt.tag){case 3:tt.flags|=65536,a&=-a,tt.lanes|=a;var bt=Ni(tt,st,a);ph(tt,bt);break e;case 1:it=st;var wt=tt.type,Tt=tt.stateNode;if(!(tt.flags&128)&&(typeof wt.getDerivedStateFromError=="function"||Tt!==null&&typeof Tt.componentDidCatch=="function"&&(Ri===null||!Ri.has(Tt)))){tt.flags|=65536,a&=-a,tt.lanes|=a;var Ct=Qi(tt,it,a);ph(tt,Ct);break e}}tt=tt.return}while(tt!==null)}Sk(o)}catch(Dt){a=Dt,Y$1===o&&o!==null&&(Y$1=o=o.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z$1)}function Ik(s,a){var o=K$1;K$1|=2;var c=Jk();(Q!==s||Z$1!==a)&&(uk=null,Kk(s,a));do try{Tk();break}catch(d){Mk(s,d)}while(!0);if($g(),K$1=o,mk.current=c,Y$1!==null)throw Error(p$1(261));return Q=null,Z$1=0,T}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(s){var a=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,a===null?Sk(s):Y$1=a,nk.current=null}function Sk(s){var a=s;do{var o=a.alternate;if(s=a.return,a.flags&32768){if(o=Ij(o,a),o!==null){o.flags&=32767,Y$1=o;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T=6,Y$1=null;return}}else if(o=Ej(o,a,fj),o!==null){Y$1=o;return}if(a=a.sibling,a!==null){Y$1=a;return}Y$1=a=s}while(a!==null);T===0&&(T=5)}function Pk(s,a,o){var c=C$1,d=ok.transition;try{ok.transition=null,C$1=1,Wk(s,a,o,c)}finally{ok.transition=d,C$1=c}return null}function Wk(s,a,o,c){do Hk();while(wk!==null);if(K$1&6)throw Error(p$1(327));o=s.finishedWork;var d=s.finishedLanes;if(o===null)return null;if(s.finishedWork=null,s.finishedLanes=0,o===s.current)throw Error(p$1(177));s.callbackNode=null,s.callbackPriority=0;var tt=o.lanes|o.childLanes;if(Bc(s,tt),s===Q&&(Y$1=Q=null,Z$1=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),tt=(o.flags&15990)!==0,o.subtreeFlags&15990||tt){tt=ok.transition,ok.transition=null;var nt=C$1;C$1=1;var it=K$1;K$1|=4,nk.current=null,Oj(s,o),dk(o,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=o,hk(o),dc(),K$1=it,C$1=nt,ok.transition=tt}else s.current=o;if(vk&&(vk=!1,wk=s,xk=d),tt=s.pendingLanes,tt===0&&(Ri=null),mc(o.stateNode),Dk(s,B$1()),a!==null)for(c=s.onRecoverableError,o=0;o<a.length;o++)d=a[o],c(d.value,{componentStack:d.stack,digest:d.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),tt=s.pendingLanes,tt&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),a=ok.transition,o=C$1;try{if(ok.transition=null,C$1=16>s?16:s,wk===null)var c=!1;else{if(s=wk,wk=null,xk=0,K$1&6)throw Error(p$1(331));var d=K$1;for(K$1|=4,V$1=s.current;V$1!==null;){var tt=V$1,nt=tt.child;if(V$1.flags&16){var it=tt.deletions;if(it!==null){for(var st=0;st<it.length;st++){var ut=it[st];for(V$1=ut;V$1!==null;){var ct=V$1;switch(ct.tag){case 0:case 11:case 15:Pj(8,ct,tt)}var ot=ct.child;if(ot!==null)ot.return=ct,V$1=ot;else for(;V$1!==null;){ct=V$1;var at=ct.sibling,ht=ct.return;if(Sj(ct),ct===ut){V$1=null;break}if(at!==null){at.return=ht,V$1=at;break}V$1=ht}}}var ft=tt.alternate;if(ft!==null){var mt=ft.child;if(mt!==null){ft.child=null;do{var yt=mt.sibling;mt.sibling=null,mt=yt}while(mt!==null)}}V$1=tt}}if(tt.subtreeFlags&2064&&nt!==null)nt.return=tt,V$1=nt;else e:for(;V$1!==null;){if(tt=V$1,tt.flags&2048)switch(tt.tag){case 0:case 11:case 15:Pj(9,tt,tt.return)}var bt=tt.sibling;if(bt!==null){bt.return=tt.return,V$1=bt;break e}V$1=tt.return}}var wt=s.current;for(V$1=wt;V$1!==null;){nt=V$1;var Tt=nt.child;if(nt.subtreeFlags&2064&&Tt!==null)Tt.return=nt,V$1=Tt;else e:for(nt=wt;V$1!==null;){if(it=V$1,it.flags&2048)try{switch(it.tag){case 0:case 11:case 15:Qj(9,it)}}catch(Dt){W$1(it,it.return,Dt)}if(it===nt){V$1=null;break e}var Ct=it.sibling;if(Ct!==null){Ct.return=it.return,V$1=Ct;break e}V$1=it.return}}if(K$1=d,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}c=!0}return c}finally{C$1=o,ok.transition=a}}return!1}function Xk(s,a,o){a=Ji(o,a),a=Ni(s,a,1),s=nh(s,a,1),a=R$1(),s!==null&&(Ac(s,1,a),Dk(s,a))}function W$1(s,a,o){if(s.tag===3)Xk(s,s,o);else for(;a!==null;){if(a.tag===3){Xk(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ri===null||!Ri.has(c))){s=Ji(o,s),s=Qi(a,s,1),a=nh(a,s,1),s=R$1(),a!==null&&(Ac(a,1,s),Dk(a,s));break}}a=a.return}}function Ti(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),a=R$1(),s.pingedLanes|=s.suspendedLanes&o,Q===s&&(Z$1&o)===o&&(T===4||T===3&&(Z$1&130023424)===Z$1&&500>B$1()-fk?Kk(s,0):rk|=o),Dk(s,a)}function Yk(s,a){a===0&&(s.mode&1?(a=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):a=1);var o=R$1();s=ih(s,a),s!==null&&(Ac(s,a,o),Dk(s,o))}function uj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),Yk(s,o)}function bk(s,a){var o=0;switch(s.tag){case 13:var c=s.stateNode,d=s.memoizedState;d!==null&&(o=d.retryLane);break;case 19:c=s.stateNode;break;default:throw Error(p$1(314))}c!==null&&c.delete(a),Yk(s,o)}var Vk;Vk=function(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&o)&&!(a.flags&128))return dh=!1,yj(s,a,o);dh=!!(s.flags&131072)}else dh=!1,I$1&&a.flags&1048576&&ug(a,ng,a.index);switch(a.lanes=0,a.tag){case 2:var c=a.type;ij(s,a),s=a.pendingProps;var d=Yf(a,H$1.current);ch(a,o),d=Nh(null,a,c,s,d,o);var tt=Sh();return a.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Zf(c)?(tt=!0,cg(a)):tt=!1,a.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,kh(a),d.updater=Ei,a.stateNode=d,d._reactInternals=a,Ii(a,c,s,o),a=jj(null,a,c,!0,tt,o)):(a.tag=0,I$1&&tt&&vg(a),Xi(null,a,d,o),a=a.child),a;case 16:c=a.elementType;e:{switch(ij(s,a),s=a.pendingProps,d=c._init,c=d(c._payload),a.type=c,d=a.tag=Zk(c),s=Ci(c,s),d){case 0:a=cj(null,a,c,s,o);break e;case 1:a=hj(null,a,c,s,o);break e;case 11:a=Yi(null,a,c,s,o);break e;case 14:a=$i(null,a,c,Ci(c.type,s),o);break e}throw Error(p$1(306,c,""))}return a;case 0:return c=a.type,d=a.pendingProps,d=a.elementType===c?d:Ci(c,d),cj(s,a,c,d,o);case 1:return c=a.type,d=a.pendingProps,d=a.elementType===c?d:Ci(c,d),hj(s,a,c,d,o);case 3:e:{if(kj(a),s===null)throw Error(p$1(387));c=a.pendingProps,tt=a.memoizedState,d=tt.element,lh(s,a),qh(a,c,null,o);var nt=a.memoizedState;if(c=nt.element,tt.isDehydrated)if(tt={element:c,isDehydrated:!1,cache:nt.cache,pendingSuspenseBoundaries:nt.pendingSuspenseBoundaries,transitions:nt.transitions},a.updateQueue.baseState=tt,a.memoizedState=tt,a.flags&256){d=Ji(Error(p$1(423)),a),a=lj(s,a,c,o,d);break e}else if(c!==d){d=Ji(Error(p$1(424)),a),a=lj(s,a,c,o,d);break e}else for(yg=Lf(a.stateNode.containerInfo.firstChild),xg=a,I$1=!0,zg=null,o=Vg(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),c===d){a=Zi(s,a,o);break e}Xi(s,a,c,o)}a=a.child}return a;case 5:return Ah(a),s===null&&Eg(a),c=a.type,d=a.pendingProps,tt=s!==null?s.memoizedProps:null,nt=d.children,Ef(c,d)?nt=null:tt!==null&&Ef(c,tt)&&(a.flags|=32),gj(s,a),Xi(s,a,nt,o),a.child;case 6:return s===null&&Eg(a),null;case 13:return oj(s,a,o);case 4:return yh(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Ug(a,null,c,o):Xi(s,a,c,o),a.child;case 11:return c=a.type,d=a.pendingProps,d=a.elementType===c?d:Ci(c,d),Yi(s,a,c,d,o);case 7:return Xi(s,a,a.pendingProps,o),a.child;case 8:return Xi(s,a,a.pendingProps.children,o),a.child;case 12:return Xi(s,a,a.pendingProps.children,o),a.child;case 10:e:{if(c=a.type._context,d=a.pendingProps,tt=a.memoizedProps,nt=d.value,G(Wg,c._currentValue),c._currentValue=nt,tt!==null)if(He(tt.value,nt)){if(tt.children===d.children&&!Wf.current){a=Zi(s,a,o);break e}}else for(tt=a.child,tt!==null&&(tt.return=a);tt!==null;){var it=tt.dependencies;if(it!==null){nt=tt.child;for(var st=it.firstContext;st!==null;){if(st.context===c){if(tt.tag===1){st=mh(-1,o&-o),st.tag=2;var ut=tt.updateQueue;if(ut!==null){ut=ut.shared;var ct=ut.pending;ct===null?st.next=st:(st.next=ct.next,ct.next=st),ut.pending=st}}tt.lanes|=o,st=tt.alternate,st!==null&&(st.lanes|=o),bh(tt.return,o,a),it.lanes|=o;break}st=st.next}}else if(tt.tag===10)nt=tt.type===a.type?null:tt.child;else if(tt.tag===18){if(nt=tt.return,nt===null)throw Error(p$1(341));nt.lanes|=o,it=nt.alternate,it!==null&&(it.lanes|=o),bh(nt,o,a),nt=tt.sibling}else nt=tt.child;if(nt!==null)nt.return=tt;else for(nt=tt;nt!==null;){if(nt===a){nt=null;break}if(tt=nt.sibling,tt!==null){tt.return=nt.return,nt=tt;break}nt=nt.return}tt=nt}Xi(s,a,d.children,o),a=a.child}return a;case 9:return d=a.type,c=a.pendingProps.children,ch(a,o),d=eh(d),c=c(d),a.flags|=1,Xi(s,a,c,o),a.child;case 14:return c=a.type,d=Ci(c,a.pendingProps),d=Ci(c.type,d),$i(s,a,c,d,o);case 15:return bj(s,a,a.type,a.pendingProps,o);case 17:return c=a.type,d=a.pendingProps,d=a.elementType===c?d:Ci(c,d),ij(s,a),a.tag=1,Zf(c)?(s=!0,cg(a)):s=!1,ch(a,o),Gi(a,c,d),Ii(a,c,d,o),jj(null,a,c,!0,s,o);case 19:return xj(s,a,o);case 22:return dj(s,a,o)}throw Error(p$1(156,a.tag))};function Fk(s,a){return ac(s,a)}function $k(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,a,o,c){return new $k(s,a,o,c)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,a){var o=s.alternate;return o===null?(o=Bg(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&14680064,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o}function Rg(s,a,o,c,d,tt){var nt=2;if(c=s,typeof s=="function")aj(s)&&(nt=1);else if(typeof s=="string")nt=5;else e:switch(s){case ya:return Tg(o.children,d,tt,a);case za:nt=8,d|=8;break;case Aa:return s=Bg(12,o,a,d|2),s.elementType=Aa,s.lanes=tt,s;case Ea:return s=Bg(13,o,a,d),s.elementType=Ea,s.lanes=tt,s;case Fa:return s=Bg(19,o,a,d),s.elementType=Fa,s.lanes=tt,s;case Ia:return pj(o,d,tt,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:nt=10;break e;case Ca:nt=9;break e;case Da:nt=11;break e;case Ga:nt=14;break e;case Ha:nt=16,c=null;break e}throw Error(p$1(130,s==null?s:typeof s,""))}return a=Bg(nt,o,a,d),a.elementType=s,a.type=c,a.lanes=tt,a}function Tg(s,a,o,c){return s=Bg(7,s,c,a),s.lanes=o,s}function pj(s,a,o,c){return s=Bg(22,s,c,a),s.elementType=Ia,s.lanes=o,s.stateNode={isHidden:!1},s}function Qg(s,a,o){return s=Bg(6,s,null,a),s.lanes=o,s}function Sg(s,a,o){return a=Bg(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function al(s,a,o,c,d){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function bl(s,a,o,c,d,tt,nt,it,st){return s=new al(s,a,o,it,st),a===1?(a=1,tt===!0&&(a|=8)):a=0,tt=Bg(3,null,null,a),s.current=tt,tt.stateNode=s,tt.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(tt),s}function cl(s,a,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:c==null?null:""+c,children:s,containerInfo:a,implementation:o}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p$1(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Zf(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(p$1(171))}if(s.tag===1){var o=s.type;if(Zf(o))return bg(s,o,a)}return a}function el(s,a,o,c,d,tt,nt,it,st){return s=bl(o,c,!0,s,d,tt,nt,it,st),s.context=dl(null),o=s.current,c=R$1(),d=yi(o),tt=mh(c,d),tt.callback=a??null,nh(o,tt,d),s.current.lanes=d,Ac(s,d,c),Dk(s,c),s}function fl$1(s,a,o,c){var d=a.current,tt=R$1(),nt=yi(d);return o=dl(o),a.context===null?a.context=o:a.pendingContext=o,a=mh(tt,nt),a.payload={element:s},c=c===void 0?null:c,c!==null&&(a.callback=c),s=nh(d,a,nt),s!==null&&(gi(s,d,nt,tt),oh(s,d,nt)),nt}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function il(s,a){hl(s,a),(s=s.alternate)&&hl(s,a)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(p$1(409));fl$1(s,a,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Rk(function(){fl$1(null,s,null,null)}),a[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var a=Hc();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Qc.length&&a!==0&&a<Qc[o].priority;o++);Qc.splice(o,0,s),o===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,a,o,c,d){if(d){if(typeof c=="function"){var tt=c;c=function(){var ut=gl(nt);tt.call(ut)}}var nt=el(a,c,s,0,null,!1,!1,"",pl);return s._reactRootContainer=nt,s[uf]=nt.current,sf(s.nodeType===8?s.parentNode:s),Rk(),nt}for(;d=s.lastChild;)s.removeChild(d);if(typeof c=="function"){var it=c;c=function(){var ut=gl(st);it.call(ut)}}var st=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=st,s[uf]=st.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl$1(a,st,o,c)}),st}function rl(s,a,o,c,d){var tt=o._reactRootContainer;if(tt){var nt=tt;if(typeof d=="function"){var it=d;d=function(){var st=gl(nt);it.call(st)}}fl$1(a,nt,s,d)}else nt=ql(o,a,s,d,c);return gl(nt)}Ec=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var o=tc(a.pendingLanes);o!==0&&(Cc(a,o|1),Dk(a,B$1()),!(K$1&6)&&(Gj=B$1()+500,jg()))}break;case 13:Rk(function(){var c=ih(s,1);if(c!==null){var d=R$1();gi(c,s,1,d)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var a=ih(s,134217728);if(a!==null){var o=R$1();gi(a,s,134217728,o)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var a=yi(s),o=ih(s,a);if(o!==null){var c=R$1();gi(o,s,a,c)}il(s,a)}};Hc=function(){return C$1};Ic=function(s,a){var o=C$1;try{return C$1=s,a()}finally{C$1=o}};yb=function(s,a,o){switch(a){case"input":if(bb(s,o),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var d=Db(c);if(!d)throw Error(p$1(90));Wa(c),bb(c,d)}}}break;case"textarea":ib(s,o);break;case"select":a=o.value,a!=null&&fb(s,!!o.multiple,a,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,a){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(a))throw Error(p$1(200));return cl(s,a,null,o)};reactDom_production_min.createRoot=function(s,a){if(!nl(s))throw Error(p$1(299));var o=!1,c="",d=kl;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),a=bl(s,1,!1,null,null,o,!1,c,d),s[uf]=a.current,sf(s.nodeType===8?s.parentNode:s),new ll(a)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(p$1(188)):(s=Object.keys(s).join(","),Error(p$1(268,s)));return s=Zb(a),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,a,o){if(!ol(a))throw Error(p$1(200));return rl(null,s,a,!0,o)};reactDom_production_min.hydrateRoot=function(s,a,o){if(!nl(s))throw Error(p$1(405));var c=o!=null&&o.hydratedSources||null,d=!1,tt="",nt=kl;if(o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(tt=o.identifierPrefix),o.onRecoverableError!==void 0&&(nt=o.onRecoverableError)),a=el(a,null,s,1,o??null,d,!1,tt,nt),s[uf]=a.current,sf(s),c)for(s=0;s<c.length;s++)o=c[s],d=o._getVersion,d=d(o._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[o,d]:a.mutableSourceEagerHydrationData.push(o,d);return new ml(a)};reactDom_production_min.render=function(s,a,o){if(!ol(a))throw Error(p$1(200));return rl(null,s,a,!1,o)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p$1(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,a,o,c){if(!ol(o))throw Error(p$1(200));if(s==null||s._reactInternals===void 0)throw Error(p$1(38));return rl(s,a,o,!1,c)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$2=reactDomExports;client.createRoot=m$2.createRoot,client.hydrateRoot=m$2.hydrateRoot;/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createHashHistory(s={}){function a(d,tt){let{pathname:nt="/",search:it="",hash:st=""}=parsePath(d.location.hash.substring(1));return!nt.startsWith("/")&&!nt.startsWith(".")&&(nt="/"+nt),createLocation("",{pathname:nt,search:it,hash:st},tt.state&&tt.state.usr||null,tt.state&&tt.state.key||"default")}function o(d,tt){let nt=d.document.querySelector("base"),it="";if(nt&&nt.getAttribute("href")){let st=d.location.href,ut=st.indexOf("#");it=ut===-1?st:st.slice(0,ut)}return it+"#"+(typeof tt=="string"?tt:createPath$1(tt))}function c(d,tt){warning(d.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(tt)})`)}return getUrlBasedHistory(a,o,c,s)}function invariant(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function warning(s,a){if(!s){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(s,a){return{usr:s.state,key:s.key,idx:a}}function createLocation(s,a,o=null,c){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof a=="string"?parsePath(a):a,state:o,key:a&&a.key||c||createKey()}}function createPath$1({pathname:s="/",search:a="",hash:o=""}){return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(s+=o.charAt(0)==="#"?o:"#"+o),s}function parsePath(s){let a={};if(s){let o=s.indexOf("#");o>=0&&(a.hash=s.substring(o),s=s.substring(0,o));let c=s.indexOf("?");c>=0&&(a.search=s.substring(c),s=s.substring(0,c)),s&&(a.pathname=s)}return a}function getUrlBasedHistory(s,a,o,c={}){let{window:d=document.defaultView,v5Compat:tt=!1}=c,nt=d.history,it="POP",st=null,ut=ct();ut==null&&(ut=0,nt.replaceState({...nt.state,idx:ut},""));function ct(){return(nt.state||{idx:null}).idx}function ot(){it="POP";let yt=ct(),bt=yt==null?null:yt-ut;ut=yt,st&&st({action:it,location:mt.location,delta:bt})}function at(yt,bt){it="PUSH";let wt=createLocation(mt.location,yt,bt);o&&o(wt,yt),ut=ct()+1;let Tt=getHistoryState(wt,ut),Ct=mt.createHref(wt);try{nt.pushState(Tt,"",Ct)}catch(Dt){if(Dt instanceof DOMException&&Dt.name==="DataCloneError")throw Dt;d.location.assign(Ct)}tt&&st&&st({action:it,location:mt.location,delta:1})}function ht(yt,bt){it="REPLACE";let wt=createLocation(mt.location,yt,bt);o&&o(wt,yt),ut=ct();let Tt=getHistoryState(wt,ut),Ct=mt.createHref(wt);nt.replaceState(Tt,"",Ct),tt&&st&&st({action:it,location:mt.location,delta:0})}function ft(yt){return createBrowserURLImpl(yt)}let mt={get action(){return it},get location(){return s(d,nt)},listen(yt){if(st)throw new Error("A history only accepts one active listener");return d.addEventListener(PopStateEventType,ot),st=yt,()=>{d.removeEventListener(PopStateEventType,ot),st=null}},createHref(yt){return a(d,yt)},createURL:ft,encodeLocation(yt){let bt=ft(yt);return{pathname:bt.pathname,search:bt.search,hash:bt.hash}},push:at,replace:ht,go(yt){return nt.go(yt)}};return mt}function createBrowserURLImpl(s,a=!1){let o="http://localhost";typeof window<"u"&&(o=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(o,"No window.location.(origin|href) available to create URL");let c=typeof s=="string"?s:createPath$1(s);return c=c.replace(/ $/,"%20"),!a&&c.startsWith("//")&&(c=o+c),new URL(c,o)}function matchRoutes(s,a,o="/"){return matchRoutesImpl(s,a,o,!1)}function matchRoutesImpl(s,a,o,c){let d=typeof a=="string"?parsePath(a):a,tt=stripBasename(d.pathname||"/",o);if(tt==null)return null;let nt=flattenRoutes(s);rankRouteBranches(nt);let it=null;for(let st=0;it==null&&st<nt.length;++st){let ut=decodePath(tt);it=matchRouteBranch(nt[st],ut,c)}return it}function flattenRoutes(s,a=[],o=[],c="",d=!1){let tt=(nt,it,st=d,ut)=>{let ct={relativePath:ut===void 0?nt.path||"":ut,caseSensitive:nt.caseSensitive===!0,childrenIndex:it,route:nt};if(ct.relativePath.startsWith("/")){if(!ct.relativePath.startsWith(c)&&st)return;invariant(ct.relativePath.startsWith(c),`Absolute route path "${ct.relativePath}" nested under path "${c}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),ct.relativePath=ct.relativePath.slice(c.length)}let ot=joinPaths([c,ct.relativePath]),at=o.concat(ct);nt.children&&nt.children.length>0&&(invariant(nt.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${ot}".`),flattenRoutes(nt.children,a,at,ot,st)),!(nt.path==null&&!nt.index)&&a.push({path:ot,score:computeScore(ot,nt.index),routesMeta:at})};return s.forEach((nt,it)=>{if(nt.path===""||!nt.path?.includes("?"))tt(nt,it);else for(let st of explodeOptionalSegments(nt.path))tt(nt,it,!0,st)}),a}function explodeOptionalSegments(s){let a=s.split("/");if(a.length===0)return[];let[o,...c]=a,d=o.endsWith("?"),tt=o.replace(/\?$/,"");if(c.length===0)return d?[tt,""]:[tt];let nt=explodeOptionalSegments(c.join("/")),it=[];return it.push(...nt.map(st=>st===""?tt:[tt,st].join("/"))),d&&it.push(...nt),it.map(st=>s.startsWith("/")&&st===""?"/":st)}function rankRouteBranches(s){s.sort((a,o)=>a.score!==o.score?o.score-a.score:compareIndexes(a.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,a){let o=s.split("/"),c=o.length;return o.some(isSplat)&&(c+=splatPenalty),a&&(c+=indexRouteValue),o.filter(d=>!isSplat(d)).reduce((d,tt)=>d+(paramRe.test(tt)?dynamicSegmentValue:tt===""?emptySegmentValue:staticSegmentValue),c)}function compareIndexes(s,a){return s.length===a.length&&s.slice(0,-1).every((c,d)=>c===a[d])?s[s.length-1]-a[a.length-1]:0}function matchRouteBranch(s,a,o=!1){let{routesMeta:c}=s,d={},tt="/",nt=[];for(let it=0;it<c.length;++it){let st=c[it],ut=it===c.length-1,ct=tt==="/"?a:a.slice(tt.length)||"/",ot=matchPath({path:st.relativePath,caseSensitive:st.caseSensitive,end:ut},ct),at=st.route;if(!ot&&ut&&o&&!c[c.length-1].route.index&&(ot=matchPath({path:st.relativePath,caseSensitive:st.caseSensitive,end:!1},ct)),!ot)return null;Object.assign(d,ot.params),nt.push({params:d,pathname:joinPaths([tt,ot.pathname]),pathnameBase:normalizePathname(joinPaths([tt,ot.pathnameBase])),route:at}),ot.pathnameBase!=="/"&&(tt=joinPaths([tt,ot.pathnameBase]))}return nt}function matchPath(s,a){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[o,c]=compilePath(s.path,s.caseSensitive,s.end),d=a.match(o);if(!d)return null;let tt=d[0],nt=tt.replace(/(.)\/+$/,"$1"),it=d.slice(1);return{params:c.reduce((ut,{paramName:ct,isOptional:ot},at)=>{if(ct==="*"){let ft=it[at]||"";nt=tt.slice(0,tt.length-ft.length).replace(/(.)\/+$/,"$1")}const ht=it[at];return ot&&!ht?ut[ct]=void 0:ut[ct]=(ht||"").replace(/%2F/g,"/"),ut},{}),pathname:tt,pathnameBase:nt,pattern:s}}function compilePath(s,a=!1,o=!0){warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let c=[],d="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(nt,it,st)=>(c.push({paramName:it,isOptional:st!=null}),st?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(c.push({paramName:"*"}),d+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?d+="\\/*$":s!==""&&s!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,a?void 0:"i"),c]}function decodePath(s){try{return s.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return warning(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),s}}function stripBasename(s,a){if(a==="/")return s;if(!s.toLowerCase().startsWith(a.toLowerCase()))return null;let o=a.endsWith("/")?a.length-1:a.length,c=s.charAt(o);return c&&c!=="/"?null:s.slice(o)||"/"}function resolvePath(s,a="/"){let{pathname:o,search:c="",hash:d=""}=typeof s=="string"?parsePath(s):s;return{pathname:o?o.startsWith("/")?o:resolvePathname(o,a):a,search:normalizeSearch(c),hash:normalizeHash(d)}}function resolvePathname(s,a){let o=a.replace(/\/+$/,"").split("/");return s.split("/").forEach(d=>{d===".."?o.length>1&&o.pop():d!=="."&&o.push(d)}),o.length>1?o.join("/"):"/"}function getInvalidPathError(s,a,o,c){return`Cannot include a '${s}' character in a manually specified \`to.${a}\` field [${JSON.stringify(c)}].  Please separate it out to the \`to.${o}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(s){return s.filter((a,o)=>o===0||a.route.path&&a.route.path.length>0)}function getResolveToMatches(s){let a=getPathContributingMatches(s);return a.map((o,c)=>c===a.length-1?o.pathname:o.pathnameBase)}function resolveTo(s,a,o,c=!1){let d;typeof s=="string"?d=parsePath(s):(d={...s},invariant(!d.pathname||!d.pathname.includes("?"),getInvalidPathError("?","pathname","search",d)),invariant(!d.pathname||!d.pathname.includes("#"),getInvalidPathError("#","pathname","hash",d)),invariant(!d.search||!d.search.includes("#"),getInvalidPathError("#","search","hash",d)));let tt=s===""||d.pathname==="",nt=tt?"/":d.pathname,it;if(nt==null)it=o;else{let ot=a.length-1;if(!c&&nt.startsWith("..")){let at=nt.split("/");for(;at[0]==="..";)at.shift(),ot-=1;d.pathname=at.join("/")}it=ot>=0?a[ot]:"/"}let st=resolvePath(d,it),ut=nt&&nt!=="/"&&nt.endsWith("/"),ct=(tt||nt===".")&&o.endsWith("/");return!st.pathname.endsWith("/")&&(ut||ct)&&(st.pathname+="/"),st}var joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(s,{relative:a}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:o,navigator:c}=reactExports.useContext(NavigationContext),{hash:d,pathname:tt,search:nt}=useResolvedPath(s,{relative:a}),it=tt;return o!=="/"&&(it=tt==="/"?o:joinPaths([o,tt])),c.createHref({pathname:it,search:nt,hash:d})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let s=reactExports.useContext(DataRouterContext),{basename:a,navigator:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),tt=JSON.stringify(getResolveToMatches(c)),nt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{nt.current=!0}),reactExports.useCallback((st,ut={})=>{if(warning(nt.current,navigateEffectWarning),!nt.current)return;if(typeof st=="number"){o.go(st);return}let ct=resolveTo(st,JSON.parse(tt),d,ut.relative==="path");s==null&&a!=="/"&&(ct.pathname=ct.pathname==="/"?a:joinPaths([a,ct.pathname])),(ut.replace?o.replace:o.push)(ct,ut.state,ut)},[a,o,tt,d,s])}reactExports.createContext(null);function useResolvedPath(s,{relative:a}={}){let{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(o));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(d),c,a==="path"),[s,d,c,a])}function useRoutes(s,a){return useRoutesImpl(s,a)}function useRoutesImpl(s,a,o,c,d){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:tt}=reactExports.useContext(NavigationContext),{matches:nt}=reactExports.useContext(RouteContext),it=nt[nt.length-1],st=it?it.params:{},ut=it?it.pathname:"/",ct=it?it.pathnameBase:"/",ot=it&&it.route;{let wt=ot&&ot.path||"";warningOnce(ut,!ot||wt.endsWith("*")||wt.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${ut}" (under <Route path="${wt}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${wt}"> to <Route path="${wt==="/"?"*":`${wt}/*`}">.`)}let at=useLocation(),ht;if(a){let wt=typeof a=="string"?parsePath(a):a;invariant(ct==="/"||wt.pathname?.startsWith(ct),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ct}" but pathname "${wt.pathname}" was given in the \`location\` prop.`),ht=wt}else ht=at;let ft=ht.pathname||"/",mt=ft;if(ct!=="/"){let wt=ct.replace(/^\//,"").split("/");mt="/"+ft.replace(/^\//,"").split("/").slice(wt.length).join("/")}let yt=matchRoutes(s,{pathname:mt});warning(ot||yt!=null,`No routes matched location "${ht.pathname}${ht.search}${ht.hash}" `),warning(yt==null||yt[yt.length-1].route.element!==void 0||yt[yt.length-1].route.Component!==void 0||yt[yt.length-1].route.lazy!==void 0,`Matched leaf route at location "${ht.pathname}${ht.search}${ht.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let bt=_renderMatches(yt&&yt.map(wt=>Object.assign({},wt,{params:Object.assign({},st,wt.params),pathname:joinPaths([ct,tt.encodeLocation?tt.encodeLocation(wt.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:wt.pathname]),pathnameBase:wt.pathnameBase==="/"?ct:joinPaths([ct,tt.encodeLocation?tt.encodeLocation(wt.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:wt.pathnameBase])})),nt,o,c,d);return a&&bt?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...ht},navigationType:"POP"}},bt):bt}function DefaultErrorComponent(){let s=useRouteError(),a=isRouteErrorResponse(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),o=s instanceof Error?s.stack:null,c="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:c},tt={padding:"2px 4px",backgroundColor:c},nt=null;return console.error("Error handled by React Router default ErrorBoundary:",s),nt=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:tt},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:tt},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},a),o?reactExports.createElement("pre",{style:d},o):null,nt)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){this.props.unstable_onError?this.props.unstable_onError(s,a):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:s,match:a,children:o}){let c=reactExports.useContext(DataRouterContext);return c&&c.static&&c.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=a.route.id),reactExports.createElement(RouteContext.Provider,{value:s},o)}function _renderMatches(s,a=[],o=null,c=null,d=null){if(s==null){if(!o)return null;if(o.errors)s=o.matches;else if(a.length===0&&!o.initialized&&o.matches.length>0)s=o.matches;else return null}let tt=s,nt=o?.errors;if(nt!=null){let ut=tt.findIndex(ct=>ct.route.id&&nt?.[ct.route.id]!==void 0);invariant(ut>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(nt).join(",")}`),tt=tt.slice(0,Math.min(tt.length,ut+1))}let it=!1,st=-1;if(o)for(let ut=0;ut<tt.length;ut++){let ct=tt[ut];if((ct.route.HydrateFallback||ct.route.hydrateFallbackElement)&&(st=ut),ct.route.id){let{loaderData:ot,errors:at}=o,ht=ct.route.loader&&!ot.hasOwnProperty(ct.route.id)&&(!at||at[ct.route.id]===void 0);if(ct.route.lazy||ht){it=!0,st>=0?tt=tt.slice(0,st+1):tt=[tt[0]];break}}}return tt.reduceRight((ut,ct,ot)=>{let at,ht=!1,ft=null,mt=null;o&&(at=nt&&ct.route.id?nt[ct.route.id]:void 0,ft=ct.route.errorElement||defaultErrorElement,it&&(st<0&&ot===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),ht=!0,mt=null):st===ot&&(ht=!0,mt=ct.route.hydrateFallbackElement||null)));let yt=a.concat(tt.slice(0,ot+1)),bt=()=>{let wt;return at?wt=ft:ht?wt=mt:ct.route.Component?wt=reactExports.createElement(ct.route.Component,null):ct.route.element?wt=ct.route.element:wt=ut,reactExports.createElement(RenderedRoute,{match:ct,routeContext:{outlet:ut,matches:yt,isDataRoute:o!=null},children:wt})};return o&&(ct.route.ErrorBoundary||ct.route.errorElement||ot===0)?reactExports.createElement(RenderErrorBoundary,{location:o.location,revalidation:o.revalidation,component:ft,error:at,children:bt(),routeContext:{outlet:null,matches:yt,isDataRoute:!0},unstable_onError:c}):bt()},null)}function getDataRouterConsoleError(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(s){let a=reactExports.useContext(DataRouterContext);return invariant(a,getDataRouterConsoleError(s)),a}function useDataRouterState(s){let a=reactExports.useContext(DataRouterStateContext);return invariant(a,getDataRouterConsoleError(s)),a}function useRouteContext(s){let a=reactExports.useContext(RouteContext);return invariant(a,getDataRouterConsoleError(s)),a}function useCurrentRouteId(s){let a=useRouteContext(s),o=a.matches[a.matches.length-1];return invariant(o.route.id,`${s} can only be used on routes that contain a unique "id"`),o.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let s=reactExports.useContext(RouteErrorContext),a=useDataRouterState("useRouteError"),o=useCurrentRouteId("useRouteError");return s!==void 0?s:a.errors?.[o]}function useNavigateStable(){let{router:s}=useDataRouterContext("useNavigate"),a=useCurrentRouteId("useNavigate"),o=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{o.current=!0}),reactExports.useCallback(async(d,tt={})=>{warning(o.current,navigateEffectWarning),o.current&&(typeof d=="number"?s.navigate(d):await s.navigate(d,{fromRouteId:a,...tt}))},[s,a])}var alreadyWarned={};function warningOnce(s,a,o){!a&&!alreadyWarned[s]&&(alreadyWarned[s]=!0,warning(!1,o))}reactExports.memo(DataRoutes);function DataRoutes({routes:s,future:a,state:o,unstable_onError:c}){return useRoutesImpl(s,void 0,o,c,a)}function Navigate({to:s,replace:a,state:o,relative:c}){invariant(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:d}=reactExports.useContext(NavigationContext);warning(!d,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:tt}=reactExports.useContext(RouteContext),{pathname:nt}=useLocation(),it=useNavigate(),st=resolveTo(s,getResolveToMatches(tt),nt,c==="path"),ut=JSON.stringify(st);return reactExports.useEffect(()=>{it(JSON.parse(ut),{replace:a,state:o,relative:c})},[it,ut,c,a,o]),null}function Route(s){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:s="/",children:a=null,location:o,navigationType:c="POP",navigator:d,static:tt=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let nt=s.replace(/^\/*/,"/"),it=reactExports.useMemo(()=>({basename:nt,navigator:d,static:tt,future:{}}),[nt,d,tt]);typeof o=="string"&&(o=parsePath(o));let{pathname:st="/",search:ut="",hash:ct="",state:ot=null,key:at="default"}=o,ht=reactExports.useMemo(()=>{let ft=stripBasename(st,nt);return ft==null?null:{location:{pathname:ft,search:ut,hash:ct,state:ot,key:at},navigationType:c}},[nt,st,ut,ct,ot,at,c]);return warning(ht!=null,`<Router basename="${nt}"> is not able to match the URL "${st}${ut}${ct}" because it does not start with the basename, so the <Router> won't render anything.`),ht==null?null:reactExports.createElement(NavigationContext.Provider,{value:it},reactExports.createElement(LocationContext.Provider,{children:a,value:ht}))}function Routes({children:s,location:a}){return useRoutes(createRoutesFromChildren(s),a)}function createRoutesFromChildren(s,a=[]){let o=[];return reactExports.Children.forEach(s,(c,d)=>{if(!reactExports.isValidElement(c))return;let tt=[...a,d];if(c.type===reactExports.Fragment){o.push.apply(o,createRoutesFromChildren(c.props.children,tt));return}invariant(c.type===Route,`[${typeof c.type=="string"?c.type:c.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!c.props.index||!c.props.children,"An index route cannot have child routes.");let nt={id:c.props.id||tt.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,middleware:c.props.middleware,loader:c.props.loader,action:c.props.action,hydrateFallbackElement:c.props.hydrateFallbackElement,HydrateFallback:c.props.HydrateFallback,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.hasErrorBoundary===!0||c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(nt.children=createRoutesFromChildren(c.props.children,tt)),o.push(nt)}),o}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(s){return s!=null&&typeof s.tagName=="string"}function isButtonElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="button"}function isFormElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="form"}function isInputElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="input"}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,a){return s.button===0&&(!a||a==="_self")&&!isModifiedEvent(s)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(s){return s!=null&&!supportedFormEncTypes.has(s)?(warning(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):s}function getFormSubmissionInfo(s,a){let o,c,d,tt,nt;if(isFormElement(s)){let it=s.getAttribute("action");c=it?stripBasename(it,a):null,o=s.getAttribute("method")||defaultMethod,d=getFormEncType(s.getAttribute("enctype"))||defaultEncType,tt=new FormData(s)}else if(isButtonElement(s)||isInputElement(s)&&(s.type==="submit"||s.type==="image")){let it=s.form;if(it==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let st=s.getAttribute("formaction")||it.getAttribute("action");if(c=st?stripBasename(st,a):null,o=s.getAttribute("formmethod")||it.getAttribute("method")||defaultMethod,d=getFormEncType(s.getAttribute("formenctype"))||getFormEncType(it.getAttribute("enctype"))||defaultEncType,tt=new FormData(it,s),!isFormDataSubmitterSupported()){let{name:ut,type:ct,value:ot}=s;if(ct==="image"){let at=ut?`${ut}.`:"";tt.append(`${at}x`,"0"),tt.append(`${at}y`,"0")}else ut&&tt.append(ut,ot)}}else{if(isHtmlElement(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');o=defaultMethod,c=null,d=defaultEncType,nt=s}return tt&&d==="text/plain"&&(nt=tt,tt=void 0),{action:c,method:o.toLowerCase(),encType:d,formData:tt,body:nt}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function singleFetchUrl(s,a,o){let c=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return c.pathname==="/"?c.pathname=`_root.${o}`:a&&stripBasename(c.pathname,a)==="/"?c.pathname=`${a.replace(/\/$/,"")}/_root.${o}`:c.pathname=`${c.pathname.replace(/\/$/,"")}.${o}`,c}async function loadRouteModule(s,a){if(s.id in a)return a[s.id];try{let o=await import(s.module);return a[s.id]=o,o}catch(o){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(o),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function getKeyedPrefetchLinks(s,a,o){let c=await Promise.all(s.map(async d=>{let tt=a.routes[d.route.id];if(tt){let nt=await loadRouteModule(tt,o);return nt.links?nt.links():[]}return[]}));return dedupeLinkDescriptors(c.flat(1).filter(isHtmlLinkDescriptor).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function getNewMatchesForLinks(s,a,o,c,d,tt){let nt=(st,ut)=>o[ut]?st.route.id!==o[ut].route.id:!0,it=(st,ut)=>o[ut].pathname!==st.pathname||o[ut].route.path?.endsWith("*")&&o[ut].params["*"]!==st.params["*"];return tt==="assets"?a.filter((st,ut)=>nt(st,ut)||it(st,ut)):tt==="data"?a.filter((st,ut)=>{let ct=c.routes[st.route.id];if(!ct||!ct.hasLoader)return!1;if(nt(st,ut)||it(st,ut))return!0;if(st.route.shouldRevalidate){let ot=st.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:o[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:st.params,defaultShouldRevalidate:!0});if(typeof ot=="boolean")return ot}return!0}):[]}function getModuleLinkHrefs(s,a,{includeHydrateFallback:o}={}){return dedupeHrefs(s.map(c=>{let d=a.routes[c.route.id];if(!d)return[];let tt=[d.module];return d.clientActionModule&&(tt=tt.concat(d.clientActionModule)),d.clientLoaderModule&&(tt=tt.concat(d.clientLoaderModule)),o&&d.hydrateFallbackModule&&(tt=tt.concat(d.hydrateFallbackModule)),d.imports&&(tt=tt.concat(d.imports)),tt}).flat(1))}function dedupeHrefs(s){return[...new Set(s)]}function sortKeys(s){let a={},o=Object.keys(s).sort();for(let c of o)a[c]=s[c];return a}function dedupeLinkDescriptors(s,a){let o=new Set;return new Set(a),s.reduce((c,d)=>{let tt=JSON.stringify(sortKeys(d));return o.has(tt)||(o.add(tt),c.push({key:tt,link:d})),c},[])}function useDataRouterContext2(){let s=reactExports.useContext(DataRouterContext);return invariant2(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function useDataRouterStateContext(){let s=reactExports.useContext(DataRouterStateContext);return invariant2(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let s=reactExports.useContext(FrameworkContext);return invariant2(s,"You must render this element inside a <HydratedRouter> element"),s}function usePrefetchBehavior(s,a){let o=reactExports.useContext(FrameworkContext),[c,d]=reactExports.useState(!1),[tt,nt]=reactExports.useState(!1),{onFocus:it,onBlur:st,onMouseEnter:ut,onMouseLeave:ct,onTouchStart:ot}=a,at=reactExports.useRef(null);reactExports.useEffect(()=>{if(s==="render"&&nt(!0),s==="viewport"){let mt=bt=>{bt.forEach(wt=>{nt(wt.isIntersecting)})},yt=new IntersectionObserver(mt,{threshold:.5});return at.current&&yt.observe(at.current),()=>{yt.disconnect()}}},[s]),reactExports.useEffect(()=>{if(c){let mt=setTimeout(()=>{nt(!0)},100);return()=>{clearTimeout(mt)}}},[c]);let ht=()=>{d(!0)},ft=()=>{d(!1),nt(!1)};return o?s!=="intent"?[tt,at,{}]:[tt,at,{onFocus:composeEventHandlers(it,ht),onBlur:composeEventHandlers(st,ft),onMouseEnter:composeEventHandlers(ut,ht),onMouseLeave:composeEventHandlers(ct,ft),onTouchStart:composeEventHandlers(ot,ht)}]:[!1,at,{}]}function composeEventHandlers(s,a){return o=>{s&&s(o),o.defaultPrevented||a(o)}}function PrefetchPageLinks({page:s,...a}){let{router:o}=useDataRouterContext2(),c=reactExports.useMemo(()=>matchRoutes(o.routes,s,o.basename),[o.routes,s,o.basename]);return c?reactExports.createElement(PrefetchPageLinksImpl,{page:s,matches:c,...a}):null}function useKeyedPrefetchLinks(s){let{manifest:a,routeModules:o}=useFrameworkContext(),[c,d]=reactExports.useState([]);return reactExports.useEffect(()=>{let tt=!1;return getKeyedPrefetchLinks(s,a,o).then(nt=>{tt||d(nt)}),()=>{tt=!0}},[s,a,o]),c}function PrefetchPageLinksImpl({page:s,matches:a,...o}){let c=useLocation(),{manifest:d,routeModules:tt}=useFrameworkContext(),{basename:nt}=useDataRouterContext2(),{loaderData:it,matches:st}=useDataRouterStateContext(),ut=reactExports.useMemo(()=>getNewMatchesForLinks(s,a,st,d,c,"data"),[s,a,st,d,c]),ct=reactExports.useMemo(()=>getNewMatchesForLinks(s,a,st,d,c,"assets"),[s,a,st,d,c]),ot=reactExports.useMemo(()=>{if(s===c.pathname+c.search+c.hash)return[];let ft=new Set,mt=!1;if(a.forEach(bt=>{let wt=d.routes[bt.route.id];!wt||!wt.hasLoader||(!ut.some(Tt=>Tt.route.id===bt.route.id)&&bt.route.id in it&&tt[bt.route.id]?.shouldRevalidate||wt.hasClientLoader?mt=!0:ft.add(bt.route.id))}),ft.size===0)return[];let yt=singleFetchUrl(s,nt,"data");return mt&&ft.size>0&&yt.searchParams.set("_routes",a.filter(bt=>ft.has(bt.route.id)).map(bt=>bt.route.id).join(",")),[yt.pathname+yt.search]},[nt,it,c,d,ut,a,s,tt]),at=reactExports.useMemo(()=>getModuleLinkHrefs(ct,d),[ct,d]),ht=useKeyedPrefetchLinks(ct);return reactExports.createElement(reactExports.Fragment,null,ot.map(ft=>reactExports.createElement("link",{key:ft,rel:"prefetch",as:"fetch",href:ft,...o})),at.map(ft=>reactExports.createElement("link",{key:ft,rel:"modulepreload",href:ft,...o})),ht.map(({key:ft,link:mt})=>reactExports.createElement("link",{key:ft,nonce:o.nonce,...mt})))}function mergeRefs(...s){return a=>{s.forEach(o=>{typeof o=="function"?o(a):o!=null&&(o.current=a)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.9.4")}catch{}function HashRouter({basename:s,children:a,window:o}){let c=reactExports.useRef();c.current==null&&(c.current=createHashHistory({window:o,v5Compat:!0}));let d=c.current,[tt,nt]=reactExports.useState({action:d.action,location:d.location}),it=reactExports.useCallback(st=>{reactExports.startTransition(()=>nt(st))},[nt]);return reactExports.useLayoutEffect(()=>d.listen(it),[d,it]),reactExports.createElement(Router,{basename:s,children:a,location:tt.location,navigationType:tt.action,navigator:d})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:a,discover:o="render",prefetch:c="none",relative:d,reloadDocument:tt,replace:nt,state:it,target:st,to:ut,preventScrollReset:ct,viewTransition:ot,...at},ht){let{basename:ft}=reactExports.useContext(NavigationContext),mt=typeof ut=="string"&&ABSOLUTE_URL_REGEX2.test(ut),yt,bt=!1;if(typeof ut=="string"&&mt&&(yt=ut,isBrowser))try{let kt=new URL(window.location.href),Vt=ut.startsWith("//")?new URL(kt.protocol+ut):new URL(ut),Ht=stripBasename(Vt.pathname,ft);Vt.origin===kt.origin&&Ht!=null?ut=Ht+Vt.search+Vt.hash:bt=!0}catch{warning(!1,`<Link to="${ut}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let wt=useHref(ut,{relative:d}),[Tt,Ct,Dt]=usePrefetchBehavior(c,at),Ot=useLinkClickHandler(ut,{replace:nt,state:it,target:st,preventScrollReset:ct,relative:d,viewTransition:ot});function $t(kt){a&&a(kt),kt.defaultPrevented||Ot(kt)}let Ft=reactExports.createElement("a",{...at,...Dt,href:yt||wt,onClick:bt||tt?a:$t,ref:mergeRefs(ht,Ct),target:st,"data-discover":!mt&&o==="render"?"true":void 0});return Tt&&!mt?reactExports.createElement(reactExports.Fragment,null,Ft,reactExports.createElement(PrefetchPageLinks,{page:wt})):Ft});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":a="page",caseSensitive:o=!1,className:c="",end:d=!1,style:tt,to:nt,viewTransition:it,children:st,...ut},ct){let ot=useResolvedPath(nt,{relative:ut.relative}),at=useLocation(),ht=reactExports.useContext(DataRouterStateContext),{navigator:ft,basename:mt}=reactExports.useContext(NavigationContext),yt=ht!=null&&useViewTransitionState(ot)&&it===!0,bt=ft.encodeLocation?ft.encodeLocation(ot).pathname:ot.pathname,wt=at.pathname,Tt=ht&&ht.navigation&&ht.navigation.location?ht.navigation.location.pathname:null;o||(wt=wt.toLowerCase(),Tt=Tt?Tt.toLowerCase():null,bt=bt.toLowerCase()),Tt&&mt&&(Tt=stripBasename(Tt,mt)||Tt);const Ct=bt!=="/"&&bt.endsWith("/")?bt.length-1:bt.length;let Dt=wt===bt||!d&&wt.startsWith(bt)&&wt.charAt(Ct)==="/",Ot=Tt!=null&&(Tt===bt||!d&&Tt.startsWith(bt)&&Tt.charAt(bt.length)==="/"),$t={isActive:Dt,isPending:Ot,isTransitioning:yt},Ft=Dt?a:void 0,kt;typeof c=="function"?kt=c($t):kt=[c,Dt?"active":null,Ot?"pending":null,yt?"transitioning":null].filter(Boolean).join(" ");let Vt=typeof tt=="function"?tt($t):tt;return reactExports.createElement(Link,{...ut,"aria-current":Ft,className:kt,ref:ct,style:Vt,to:nt,viewTransition:it},typeof st=="function"?st($t):st)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:s="render",fetcherKey:a,navigate:o,reloadDocument:c,replace:d,state:tt,method:nt=defaultMethod,action:it,onSubmit:st,relative:ut,preventScrollReset:ct,viewTransition:ot,...at},ht)=>{let ft=useSubmit(),mt=useFormAction(it,{relative:ut}),yt=nt.toLowerCase()==="get"?"get":"post",bt=typeof it=="string"&&ABSOLUTE_URL_REGEX2.test(it),wt=Tt=>{if(st&&st(Tt),Tt.defaultPrevented)return;Tt.preventDefault();let Ct=Tt.nativeEvent.submitter,Dt=Ct?.getAttribute("formmethod")||nt;ft(Ct||Tt.currentTarget,{fetcherKey:a,method:Dt,navigate:o,replace:d,state:tt,relative:ut,preventScrollReset:ct,viewTransition:ot})};return reactExports.createElement("form",{ref:ht,method:yt,action:mt,onSubmit:c?st:wt,...at,"data-discover":!bt&&s==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(s){let a=reactExports.useContext(DataRouterContext);return invariant(a,getDataRouterConsoleError2(s)),a}function useLinkClickHandler(s,{target:a,replace:o,state:c,preventScrollReset:d,relative:tt,viewTransition:nt}={}){let it=useNavigate(),st=useLocation(),ut=useResolvedPath(s,{relative:tt});return reactExports.useCallback(ct=>{if(shouldProcessLinkClick(ct,a)){ct.preventDefault();let ot=o!==void 0?o:createPath$1(st)===createPath$1(ut);it(s,{replace:ot,state:c,preventScrollReset:d,relative:tt,viewTransition:nt})}},[st,it,ut,o,c,a,s,d,tt,nt])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:s}=useDataRouterContext3("useSubmit"),{basename:a}=reactExports.useContext(NavigationContext),o=useRouteId();return reactExports.useCallback(async(c,d={})=>{let{action:tt,method:nt,encType:it,formData:st,body:ut}=getFormSubmissionInfo(c,a);if(d.navigate===!1){let ct=d.fetcherKey||getUniqueFetcherId();await s.fetch(ct,o,d.action||tt,{preventScrollReset:d.preventScrollReset,formData:st,body:ut,formMethod:d.method||nt,formEncType:d.encType||it,flushSync:d.flushSync})}else await s.navigate(d.action||tt,{preventScrollReset:d.preventScrollReset,formData:st,body:ut,formMethod:d.method||nt,formEncType:d.encType||it,replace:d.replace,state:d.state,fromRouteId:o,flushSync:d.flushSync,viewTransition:d.viewTransition})},[s,a,o])}function useFormAction(s,{relative:a}={}){let{basename:o}=reactExports.useContext(NavigationContext),c=reactExports.useContext(RouteContext);invariant(c,"useFormAction must be used inside a RouteContext");let[d]=c.matches.slice(-1),tt={...useResolvedPath(s||".",{relative:a})},nt=useLocation();if(s==null){tt.search=nt.search;let it=new URLSearchParams(tt.search),st=it.getAll("index");if(st.some(ct=>ct==="")){it.delete("index"),st.filter(ot=>ot).forEach(ot=>it.append("index",ot));let ct=it.toString();tt.search=ct?`?${ct}`:""}}return(!s||s===".")&&d.route.index&&(tt.search=tt.search?tt.search.replace(/^\?/,"?index&"):"?index"),o!=="/"&&(tt.pathname=tt.pathname==="/"?o:joinPaths([o,tt.pathname])),createPath$1(tt)}function useViewTransitionState(s,{relative:a}={}){let o=reactExports.useContext(ViewTransitionContext);invariant(o!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:c}=useDataRouterContext3("useViewTransitionState"),d=useResolvedPath(s,{relative:a});if(!o.isTransitioning)return!1;let tt=stripBasename(o.currentLocation.pathname,c)||o.currentLocation.pathname,nt=stripBasename(o.nextLocation.pathname,c)||o.nextLocation.pathname;return matchPath(d.pathname,nt)!=null||matchPath(d.pathname,tt)!=null}var ortWeb_min={exports:{}};const backends={},backendsSortedByPriority=[],registerBackend=(s,a,o)=>{if(a&&typeof a.init=="function"&&typeof a.createSessionHandler=="function"){const c=backends[s];if(c===void 0)backends[s]={backend:a,priority:o};else{if(c.priority>o)return;if(c.priority===o&&c.backend!==a)throw new Error(`cannot register backend "${s}" using priority ${o}`)}if(o>=0){const d=backendsSortedByPriority.indexOf(s);d!==-1&&backendsSortedByPriority.splice(d,1);for(let tt=0;tt<backendsSortedByPriority.length;tt++)if(backends[backendsSortedByPriority[tt]].priority<=o){backendsSortedByPriority.splice(tt,0,s);return}backendsSortedByPriority.push(s)}return}throw new TypeError("not a valid backend")},resolveBackend=async s=>{const a=s.length===0?backendsSortedByPriority:s,o=[];for(const c of a){const d=backends[c];if(d){if(d.initialized)return d.backend;if(d.aborted)continue;const tt=!!d.initPromise;try{return tt||(d.initPromise=d.backend.init()),await d.initPromise,d.initialized=!0,d.backend}catch(nt){tt||o.push({name:c,err:nt}),d.aborted=!0}finally{delete d.initPromise}}}throw new Error(`no available backend found. ERR: ${o.map(c=>`[${c.name}] ${c.err}`).join(", ")}`)};class EnvImpl{constructor(){this.wasm={},this.webgl={},this.logLevelInternal="warning"}set logLevel(a){if(a!==void 0){if(typeof a!="string"||["verbose","info","warning","error","fatal"].indexOf(a)===-1)throw new Error(`Unsupported logging level: ${a}`);this.logLevelInternal=a}}get logLevel(){return this.logLevelInternal}}const env$1=new EnvImpl,isBigInt64ArrayAvailable=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",isBigUint64ArrayAvailable=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function",NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);isBigInt64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64"));isBigUint64ArrayAvailable&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64"));const calculateSize=s=>{let a=1;for(let o=0;o<s.length;o++){const c=s[o];if(typeof c!="number"||!Number.isSafeInteger(c))throw new TypeError(`dims[${o}] must be an integer, got: ${c}`);if(c<0)throw new RangeError(`dims[${o}] must be a non-negative integer, got: ${c}`);a*=c}return a};let Tensor$1=class Np{constructor(a,o,c){let d,tt,nt;if(typeof a=="string")if(d=a,nt=c,a==="string"){if(!Array.isArray(o))throw new TypeError("A string tensor's data must be a string array.");tt=o}else{const st=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(a);if(st===void 0)throw new TypeError(`Unsupported tensor type: ${a}.`);if(Array.isArray(o))tt=st.from(o);else if(o instanceof st)tt=o;else throw new TypeError(`A ${d} tensor's data must be type of ${st}`)}else if(nt=o,Array.isArray(a)){if(a.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const st=typeof a[0];if(st==="string")d="string",tt=a;else if(st==="boolean")d="bool",tt=Uint8Array.from(a);else throw new TypeError(`Invalid element type of data array: ${st}.`)}else{const st=NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(a.constructor);if(st===void 0)throw new TypeError(`Unsupported type for tensor data: ${a.constructor}.`);d=st,tt=a}if(nt===void 0)nt=[tt.length];else if(!Array.isArray(nt))throw new TypeError("A tensor's dims must be a number array");const it=calculateSize(nt);if(it!==tt.length)throw new Error(`Tensor's size(${it}) does not match data length(${tt.length}).`);this.dims=nt,this.type=d,this.data=tt,this.size=it}static bufferToTensor(a,o){if(a===void 0)throw new Error("Image buffer must be defined");if(o.height===void 0||o.width===void 0)throw new Error("Image height and width must be defined");const{height:c,width:d}=o,tt=o.norm;let nt,it;tt===void 0||tt.mean===void 0?nt=255:nt=tt.mean,tt===void 0||tt.bias===void 0?it=0:it=tt.bias;const st=o.bitmapFormat!==void 0?o.bitmapFormat:"RGBA",ut=o.tensorFormat!==void 0&&o.tensorFormat!==void 0?o.tensorFormat:"RGB",ct=c*d,ot=ut==="RGBA"?new Float32Array(ct*4):new Float32Array(ct*3);let at=4,ht=0,ft=1,mt=2,yt=3,bt=0,wt=ct,Tt=ct*2,Ct=-1;st==="RGB"&&(at=3,ht=0,ft=1,mt=2,yt=-1),ut==="RGBA"?Ct=ct*3:ut==="RBG"?(bt=0,Tt=ct,wt=ct*2):ut==="BGR"&&(Tt=0,wt=ct,bt=ct*2);for(let Ot=0;Ot<ct;Ot++,ht+=at,mt+=at,ft+=at,yt+=at)ot[bt++]=(a[ht]+it)/nt,ot[wt++]=(a[ft]+it)/nt,ot[Tt++]=(a[mt]+it)/nt,Ct!==-1&&yt!==-1&&(ot[Ct++]=(a[yt]+it)/nt);return ut==="RGBA"?new Np("float32",ot,[1,4,c,d]):new Np("float32",ot,[1,3,c,d])}static async fromImage(a,o){const c=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,d=typeof ImageData<"u"&&a instanceof ImageData,tt=typeof ImageBitmap<"u"&&a instanceof ImageBitmap,nt=typeof String<"u"&&(a instanceof String||typeof a=="string");let it,st={};if(c){const ut=document.createElement("canvas"),ct=ut.getContext("2d");if(ct!=null){let ot=a.naturalHeight,at=a.naturalWidth;if(o!==void 0&&o.resizedHeight!==void 0&&o.resizedWidth!==void 0&&(ot=o.resizedHeight,at=o.resizedWidth),o!==void 0){if(st=o,o.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");if(st.tensorFormat="RGBA",o.height!==void 0&&o.height!==ot)throw new Error("Image input config height doesn't match HTMLImageElement height");if(st.height=ot,o.width!==void 0&&o.width!==at)throw new Error("Image input config width doesn't match HTMLImageElement width");st.width=at}else st.tensorFormat="RGBA",st.height=ot,st.width=at;ut.width=at,ut.height=ot,ct.drawImage(a,0,0,at,ot),it=ct.getImageData(0,0,at,ot).data}else throw new Error("Can not access image data")}else if(d){const ut="RGBA";let ct,ot;if(o!==void 0&&o.resizedWidth!==void 0&&o.resizedHeight!==void 0?(ct=o.resizedHeight,ot=o.resizedWidth):(ct=a.height,ot=a.width),o!==void 0){if(st=o,o.bitmapFormat!==void 0&&o.bitmapFormat!==ut)throw new Error("Image input config format must be RGBA for ImageData");st.bitmapFormat="RGBA"}else st.bitmapFormat="RGBA";if(st.height=ct,st.width=ot,o!==void 0){const at=document.createElement("canvas");at.width=ot,at.height=ct;const ht=at.getContext("2d");if(ht!=null)ht.putImageData(a,0,0),it=ht.getImageData(0,0,ot,ct).data;else throw new Error("Can not access image data")}else it=a.data}else if(tt){if(o===void 0)throw new Error("Please provide image config with format for Imagebitmap");if(o.bitmapFormat!==void 0)throw new Error("Image input config format must be defined for ImageBitmap");const ut=document.createElement("canvas").getContext("2d");if(ut!=null){const ct=a.height,ot=a.width;if(ut.drawImage(a,0,0,ot,ct),it=ut.getImageData(0,0,ot,ct).data,o!==void 0){if(o.height!==void 0&&o.height!==ct)throw new Error("Image input config height doesn't match ImageBitmap height");if(st.height=ct,o.width!==void 0&&o.width!==ot)throw new Error("Image input config width doesn't match ImageBitmap width");st.width=ot}else st.height=ct,st.width=ot;return Np.bufferToTensor(it,st)}else throw new Error("Can not access image data")}else{if(nt)return new Promise((ut,ct)=>{const ot=document.createElement("canvas"),at=ot.getContext("2d");if(!a||!at)return ct();const ht=new Image;ht.crossOrigin="Anonymous",ht.src=a,ht.onload=()=>{ot.width=ht.width,ot.height=ht.height,at.drawImage(ht,0,0,ot.width,ot.height);const ft=at.getImageData(0,0,ot.width,ot.height);if(o!==void 0){if(o.height!==void 0&&o.height!==ot.height)throw new Error("Image input config height doesn't match ImageBitmap height");if(st.height=ot.height,o.width!==void 0&&o.width!==ot.width)throw new Error("Image input config width doesn't match ImageBitmap width");st.width=ot.width}else st.height=ot.height,st.width=ot.width;ut(Np.bufferToTensor(ft.data,st))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(it!==void 0)return Np.bufferToTensor(it,st);throw new Error("Input data provided is not supported - aborted tensor creation")}toImageData(a){var o,c;const d=document.createElement("canvas").getContext("2d");let tt;if(d!=null){const nt=this.dims[3],it=this.dims[2],st=this.dims[1],ut=a!==void 0&&a.format!==void 0?a.format:"RGB",ct=a!==void 0&&((o=a.norm)===null||o===void 0?void 0:o.mean)!==void 0?a.norm.mean:255,ot=a!==void 0&&((c=a.norm)===null||c===void 0?void 0:c.bias)!==void 0?a.norm.bias:0,at=it*nt;if(a!==void 0){if(a.height!==void 0&&a.height!==it)throw new Error("Image output config height doesn't match tensor height");if(a.width!==void 0&&a.width!==nt)throw new Error("Image output config width doesn't match tensor width");if(a.format!==void 0&&st===4&&a.format!=="RGBA"||st===3&&a.format!=="RGB"&&a.format!=="BGR")throw new Error("Tensor format doesn't match input tensor dims")}const ht=4;let ft=0,mt=1,yt=2,bt=3,wt=0,Tt=at,Ct=at*2,Dt=-1;ut==="RGBA"?(wt=0,Tt=at,Ct=at*2,Dt=at*3):ut==="RGB"?(wt=0,Tt=at,Ct=at*2):ut==="RBG"&&(wt=0,Ct=at,Tt=at*2),tt=d.createImageData(nt,it);for(let Ot=0;Ot<it*nt;ft+=ht,mt+=ht,yt+=ht,bt+=ht,Ot++)tt.data[ft]=(this.data[wt++]-ot)*ct,tt.data[mt]=(this.data[Tt++]-ot)*ct,tt.data[yt]=(this.data[Ct++]-ot)*ct,tt.data[bt]=Dt===-1?255:(this.data[Dt++]-ot)*ct}else throw new Error("Can not access image data");return tt}reshape(a){return new Np(this.type,this.data,a)}};const Tensor=Tensor$1;let InferenceSession$1=class E1{constructor(a){this.handler=a}async run(a,o,c){const d={};let tt={};if(typeof a!="object"||a===null||a instanceof Tensor||Array.isArray(a))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let nt=!0;if(typeof o=="object"){if(o===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(o instanceof Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(o)){if(o.length===0)throw new TypeError("'fetches' cannot be an empty array.");nt=!1;for(const ut of o){if(typeof ut!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(ut)===-1)throw new RangeError(`'fetches' contains invalid output name: ${ut}.`);d[ut]=null}if(typeof c=="object"&&c!==null)tt=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else{let ut=!1;const ct=Object.getOwnPropertyNames(o);for(const ot of this.outputNames)if(ct.indexOf(ot)!==-1){const at=o[ot];(at===null||at instanceof Tensor)&&(ut=!0,nt=!1,d[ot]=at)}if(ut){if(typeof c=="object"&&c!==null)tt=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else tt=o}}else if(typeof o<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const ut of this.inputNames)if(typeof a[ut]>"u")throw new Error(`input '${ut}' is missing in 'feeds'.`);if(nt)for(const ut of this.outputNames)d[ut]=null;const it=await this.handler.run(a,d,tt),st={};for(const ut in it)Object.hasOwnProperty.call(it,ut)&&(st[ut]=new Tensor(it[ut].type,it[ut].data,it[ut].dims));return st}static async create(a,o,c,d){let tt,nt={};if(typeof a=="string"){if(tt=a,typeof o=="object"&&o!==null)nt=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(a instanceof Uint8Array){if(tt=a,typeof o=="object"&&o!==null)nt=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(a instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&a instanceof SharedArrayBuffer){const ot=a;let at=0,ht=a.byteLength;if(typeof o=="object"&&o!==null)nt=o;else if(typeof o=="number"){if(at=o,!Number.isSafeInteger(at))throw new RangeError("'byteOffset' must be an integer.");if(at<0||at>=ot.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${ot.byteLength}).`);if(ht=a.byteLength-at,typeof c=="number"){if(ht=c,!Number.isSafeInteger(ht))throw new RangeError("'byteLength' must be an integer.");if(ht<=0||at+ht>ot.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${ot.byteLength-at}].`);if(typeof d=="object"&&d!==null)nt=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else if(typeof c<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof o<"u")throw new TypeError("'options' must be an object.");tt=new Uint8Array(ot,at,ht)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const st=(nt.executionProviders||[]).map(ot=>typeof ot=="string"?ot:ot.name),ct=await(await resolveBackend(st)).createSessionHandler(tt,nt);return new E1(ct)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const InferenceSession=InferenceSession$1,lib$1=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession,Tensor,env:env$1,registerBackend},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(lib$1);/*!
* ONNX Runtime Web v1.14.0
* Copyright (c) Microsoft Corporation. All rights reserved.
* Licensed under the MIT License.
*/(function(module,exports){(function(s,a){module.exports=a(require$$0)})(self,__WEBPACK_EXTERNAL_MODULE__1670__=>(()=>{var __webpack_modules__={3474:(s,a,o)=>{var c,d=(c=(c=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(tt){function nt(){return mr.buffer!=kr&&Bn(mr.buffer),Yr}function it(){return mr.buffer!=kr&&Bn(mr.buffer),Mr}function st(){return mr.buffer!=kr&&Bn(mr.buffer),Jr}function ut(){return mr.buffer!=kr&&Bn(mr.buffer),an}function ct(){return mr.buffer!=kr&&Bn(mr.buffer),xn}var ot,at,ht;tt=tt||{},ot||(ot=tt!==void 0?tt:{}),ot.ready=new Promise(function(rr,hr){at=rr,ht=hr});var ft,mt,yt,bt,wt,Tt,Ct=Object.assign({},ot),Dt="./this.program",Ot=(rr,hr)=>{throw hr},$t=typeof window=="object",Ft=typeof importScripts=="function",kt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Vt=ot.ENVIRONMENT_IS_PTHREAD||!1,Ht="";function Qt(rr){return ot.locateFile?ot.locateFile(rr,Ht):Ht+rr}if(kt){let rr;Ht=Ft?o(908).dirname(Ht)+"/":"//",Tt=()=>{wt||(bt=o(1384),wt=o(908))},ft=function(hr,xr){return Tt(),hr=wt.normalize(hr),bt.readFileSync(hr,xr?void 0:"utf8")},yt=hr=>((hr=ft(hr,!0)).buffer||(hr=new Uint8Array(hr)),hr),mt=(hr,xr,Or)=>{Tt(),hr=wt.normalize(hr),bt.readFile(hr,function(Zr,rn){Zr?Or(Zr):xr(rn.buffer)})},1<process.argv.length&&(Dt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(hr){if(!(hr instanceof Jo))throw hr}),process.on("unhandledRejection",function(hr){throw hr}),Ot=(hr,xr)=>{if(no())throw process.exitCode=hr,xr;xr instanceof Jo||cr("exiting due to exception: "+xr),process.exit(hr)},ot.inspect=function(){return"[Emscripten Module object]"};try{rr=o(9925)}catch(hr){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),hr}o.g.Worker=rr.Worker}else($t||Ft)&&(Ft?Ht=self.location.href:typeof document<"u"&&document.currentScript&&(Ht=document.currentScript.src),c&&(Ht=c),Ht=Ht.indexOf("blob:")!==0?Ht.substr(0,Ht.replace(/[?#].*/,"").lastIndexOf("/")+1):"",kt||(ft=rr=>{var hr=new XMLHttpRequest;return hr.open("GET",rr,!1),hr.send(null),hr.responseText},Ft&&(yt=rr=>{var hr=new XMLHttpRequest;return hr.open("GET",rr,!1),hr.responseType="arraybuffer",hr.send(null),new Uint8Array(hr.response)}),mt=(rr,hr,xr)=>{var Or=new XMLHttpRequest;Or.open("GET",rr,!0),Or.responseType="arraybuffer",Or.onload=()=>{Or.status==200||Or.status==0&&Or.response?hr(Or.response):xr()},Or.onerror=xr,Or.send(null)}));kt&&typeof performance>"u"&&(o.g.performance=o(6953).performance);var Xt=console.log.bind(console),Zt=console.warn.bind(console);kt&&(Tt(),Xt=rr=>bt.writeSync(1,rr+`
`),Zt=rr=>bt.writeSync(2,rr+`
`));var ar,nr=ot.print||Xt,cr=ot.printErr||Zt;Object.assign(ot,Ct),Ct=null,ot.thisProgram&&(Dt=ot.thisProgram),ot.quit&&(Ot=ot.quit),ot.wasmBinary&&(ar=ot.wasmBinary);var dr=ot.noExitRuntime||!1;typeof WebAssembly!="object"&&eo("no native wasm support detected");var mr,Dr,kr,Yr,Mr,Jr,an,xn,Rn=!1,hn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function pn(rr,hr,xr){var Or=(hr>>>=0)+xr;for(xr=hr;rr[xr]&&!(xr>=Or);)++xr;if(16<xr-hr&&rr.buffer&&hn)return hn.decode(rr.buffer instanceof SharedArrayBuffer?rr.slice(hr,xr):rr.subarray(hr,xr));for(Or="";hr<xr;){var Zr=rr[hr++];if(128&Zr){var rn=63&rr[hr++];if((224&Zr)==192)Or+=String.fromCharCode((31&Zr)<<6|rn);else{var wn=63&rr[hr++];65536>(Zr=(240&Zr)==224?(15&Zr)<<12|rn<<6|wn:(7&Zr)<<18|rn<<12|wn<<6|63&rr[hr++])?Or+=String.fromCharCode(Zr):(Zr-=65536,Or+=String.fromCharCode(55296|Zr>>10,56320|1023&Zr))}}else Or+=String.fromCharCode(Zr)}return Or}function yn(rr,hr){return(rr>>>=0)?pn(it(),rr,hr):""}function un(rr,hr,xr,Or){if(!(0<Or))return 0;var Zr=xr>>>=0;Or=xr+Or-1;for(var rn=0;rn<rr.length;++rn){var wn=rr.charCodeAt(rn);if(55296<=wn&&57343>=wn&&(wn=65536+((1023&wn)<<10)|1023&rr.charCodeAt(++rn)),127>=wn){if(xr>=Or)break;hr[xr++>>>0]=wn}else{if(2047>=wn){if(xr+1>=Or)break;hr[xr++>>>0]=192|wn>>6}else{if(65535>=wn){if(xr+2>=Or)break;hr[xr++>>>0]=224|wn>>12}else{if(xr+3>=Or)break;hr[xr++>>>0]=240|wn>>18,hr[xr++>>>0]=128|wn>>12&63}hr[xr++>>>0]=128|wn>>6&63}hr[xr++>>>0]=128|63&wn}}return hr[xr>>>0]=0,xr-Zr}function fn(rr){for(var hr=0,xr=0;xr<rr.length;++xr){var Or=rr.charCodeAt(xr);127>=Or?hr++:2047>=Or?hr+=2:55296<=Or&&57343>=Or?(hr+=4,++xr):hr+=3}return hr}function Bn(rr){kr=rr,ot.HEAP8=Yr=new Int8Array(rr),ot.HEAP16=new Int16Array(rr),ot.HEAP32=Jr=new Int32Array(rr),ot.HEAPU8=Mr=new Uint8Array(rr),ot.HEAPU16=new Uint16Array(rr),ot.HEAPU32=an=new Uint32Array(rr),ot.HEAPF32=new Float32Array(rr),ot.HEAPF64=xn=new Float64Array(rr)}Vt&&(kr=ot.buffer);var Dn=ot.INITIAL_MEMORY||16777216;if(Vt)mr=ot.wasmMemory,kr=ot.buffer;else if(ot.wasmMemory)mr=ot.wasmMemory;else if(!((mr=new WebAssembly.Memory({initial:Dn/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw cr("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),kt&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");mr&&(kr=mr.buffer),Dn=kr.byteLength,Bn(kr);var Qn,zr=[],ao=[],oo=[],Wn=[];function no(){return dr||!1}function Eo(){var rr=ot.preRun.shift();zr.unshift(rr)}var xo,Mo=0,ls=null;function eo(rr){throw Vt?postMessage({cmd:"onAbort",arg:rr}):ot.onAbort&&ot.onAbort(rr),cr(rr="Aborted("+rr+")"),Rn=!0,rr=new WebAssembly.RuntimeError(rr+". Build with -sASSERTIONS for more info."),ht(rr),rr}function wl(){return xo.startsWith("data:application/octet-stream;base64,")}function qs(){var rr=xo;try{if(rr==xo&&ar)return new Uint8Array(ar);if(yt)return yt(rr);throw"both async and sync fetching of the wasm failed"}catch(hr){eo(hr)}}xo="ort-wasm-threaded.wasm",wl()||(xo=Qt(xo));var gn={};function Jo(rr){this.name="ExitStatus",this.message="Program terminated with exit("+rr+")",this.status=rr}function Wo(rr){(rr=bn.Vb[rr])||eo(),bn.mc(rr)}function us(rr){var hr=bn.Cc();if(!hr)return 6;bn.ac.push(hr),bn.Vb[rr.Ub]=hr,hr.Ub=rr.Ub;var xr={cmd:"run",start_routine:rr.Ic,arg:rr.zc,pthread_ptr:rr.Ub};return hr.$b=()=>{xr.time=performance.now(),hr.postMessage(xr,rr.Nc)},hr.loaded&&(hr.$b(),delete hr.$b),0}function ko(rr){if(Vt)return An(1,1,rr);no()||(bn.oc(),ot.onExit&&ot.onExit(rr),Rn=!0),Ot(rr,new Jo(rr))}function _n(rr,hr){if(!hr&&Vt)throw ms(rr),"unwind";no()||Vt||(Sl(),Zn(oo),Fl(0),hs[1].length&&Ol(1,10),hs[2].length&&Ol(2,10),bn.oc()),ko(rr)}var bn={Yb:[],ac:[],qc:[],Vb:{},fc:function(){Vt&&bn.Ec()},Pc:function(){},Ec:function(){bn.receiveObjectTransfer=bn.Gc,bn.threadInitTLS=bn.pc,bn.setExitStatus=bn.nc,dr=!1},nc:function(){},oc:function(){for(var rr of Object.values(bn.Vb))bn.mc(rr);for(rr of bn.Yb)rr.terminate();bn.Yb=[]},mc:function(rr){var hr=rr.Ub;delete bn.Vb[hr],bn.Yb.push(rr),bn.ac.splice(bn.ac.indexOf(rr),1),rr.Ub=0,hu(hr)},Gc:function(){},pc:function(){bn.qc.forEach(rr=>rr())},Fc:function(rr,hr){rr.onmessage=xr=>{var Or=(xr=xr.data).cmd;if(rr.Ub&&(bn.Bc=rr.Ub),xr.targetThread&&xr.targetThread!=vs()){var Zr=bn.Vb[xr.Qc];Zr?Zr.postMessage(xr,xr.transferList):cr('Internal error! Worker sent a message "'+Or+'" to target pthread '+xr.targetThread+", but that thread no longer exists!")}else Or==="processProxyingQueue"?Nr(xr.queue):Or==="spawnThread"?us(xr):Or==="cleanupThread"?Wo(xr.thread):Or==="killThread"?(xr=xr.thread,Or=bn.Vb[xr],delete bn.Vb[xr],Or.terminate(),hu(xr),bn.ac.splice(bn.ac.indexOf(Or),1),Or.Ub=0):Or==="cancelThread"?bn.Vb[xr.thread].postMessage({cmd:"cancel"}):Or==="loaded"?(rr.loaded=!0,hr&&hr(rr),rr.$b&&(rr.$b(),delete rr.$b)):Or==="print"?nr("Thread "+xr.threadId+": "+xr.text):Or==="printErr"?cr("Thread "+xr.threadId+": "+xr.text):Or==="alert"?alert("Thread "+xr.threadId+": "+xr.text):xr.target==="setimmediate"?rr.postMessage(xr):Or==="onAbort"?ot.onAbort&&ot.onAbort(xr.arg):Or&&cr("worker sent an unknown command "+Or);bn.Bc=void 0},rr.onerror=xr=>{throw cr("worker sent an error! "+xr.filename+":"+xr.lineno+": "+xr.message),xr},kt&&(rr.on("message",function(xr){rr.onmessage({data:xr})}),rr.on("error",function(xr){rr.onerror(xr)}),rr.on("detachedExit",function(){})),rr.postMessage({cmd:"load",urlOrBlob:ot.mainScriptUrlOrBlob||c,wasmMemory:mr,wasmModule:Dr})},yc:function(){var rr=Qt("ort-wasm-threaded.worker.js");bn.Yb.push(new Worker(rr))},Cc:function(){return bn.Yb.length==0&&(bn.yc(),bn.Fc(bn.Yb[0])),bn.Yb.pop()}};function Zn(rr){for(;0<rr.length;)rr.shift()(ot)}function ts(rr){var hr=so();return rr=rr(),ho(hr),rr}function ms(rr){if(Vt)return An(2,0,rr);try{_n(rr)}catch(hr){hr instanceof Jo||hr=="unwind"||Ot(1,hr)}}ot.PThread=bn,ot.establishStackSpace=function(){var rr=vs(),hr=st()[rr+44>>2>>>0];rr=st()[rr+48>>2>>>0],du(hr,hr-rr),ho(hr)};var Kn=[];function co(rr){var hr=Kn[rr];return hr||(rr>=Kn.length&&(Kn.length=rr+1),Kn[rr]=hr=Qn.get(rr)),hr}ot.invokeEntryPoint=function(rr,hr){rr=co(rr)(hr),no()?bn.nc(rr):fu(rr)};var cs,Ms,ns=[],yr=0,er=0;function tr(rr){this.Zb=rr,this.Sb=rr-24,this.xc=function(hr){ut()[this.Sb+4>>2>>>0]=hr},this.bc=function(){return ut()[this.Sb+4>>2>>>0]},this.wc=function(hr){ut()[this.Sb+8>>2>>>0]=hr},this.Dc=function(){return ut()[this.Sb+8>>2>>>0]},this.rc=function(){st()[this.Sb>>2>>>0]=0},this.hc=function(hr){hr=hr?1:0,nt()[this.Sb+12>>0>>>0]=hr},this.uc=function(){return nt()[this.Sb+12>>0>>>0]!=0},this.ic=function(hr){hr=hr?1:0,nt()[this.Sb+13>>0>>>0]=hr},this.kc=function(){return nt()[this.Sb+13>>0>>>0]!=0},this.fc=function(hr,xr){this.cc(0),this.xc(hr),this.wc(xr),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(st(),this.Sb>>2,1)},this.Hc=function(){return Atomics.sub(st(),this.Sb>>2,1)===1},this.cc=function(hr){ut()[this.Sb+16>>2>>>0]=hr},this.tc=function(){return ut()[this.Sb+16>>2>>>0]},this.vc=function(){if(Fp(this.bc()))return ut()[this.Zb>>2>>>0];var hr=this.tc();return hr!==0?hr:this.Zb}}function fr(rr){return cu(new tr(rr).Sb)}function wr(rr,hr,xr,Or){return Vt?An(3,1,rr,hr,xr,Or):Lr(rr,hr,xr,Or)}function Lr(rr,hr,xr,Or){if(typeof SharedArrayBuffer>"u")return cr("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Zr=[];return Vt&&Zr.length===0?wr(rr,hr,xr,Or):(rr={Ic:xr,Ub:rr,zc:Or,Nc:Zr},Vt?(rr.Oc="spawnThread",postMessage(rr,Zr),0):us(rr))}function Fr(rr,hr,xr){return Vt?An(4,1,rr,hr,xr):0}function Hr(rr,hr){if(Vt)return An(5,1,rr,hr)}function Pr(rr,hr){if(Vt)return An(6,1,rr,hr)}function Qr(rr,hr,xr){if(Vt)return An(7,1,rr,hr,xr)}function sn(rr,hr,xr){return Vt?An(8,1,rr,hr,xr):0}function Kr(rr,hr){if(Vt)return An(9,1,rr,hr)}function vn(rr,hr,xr){if(Vt)return An(10,1,rr,hr,xr)}function zn(rr,hr,xr,Or){if(Vt)return An(11,1,rr,hr,xr,Or)}function Yn(rr,hr,xr,Or){if(Vt)return An(12,1,rr,hr,xr,Or)}function po(rr,hr,xr,Or){if(Vt)return An(13,1,rr,hr,xr,Or)}function ga(rr){if(Vt)return An(14,1,rr)}function ur(rr,hr){if(Vt)return An(15,1,rr,hr)}function br(rr,hr,xr){if(Vt)return An(16,1,rr,hr,xr)}function Nr(rr){Atomics.store(st(),rr>>2,1),vs()&&Wl(rr),Atomics.compareExchange(st(),rr>>2,1,0)}function Ur(rr){return ut()[rr>>>2]+4294967296*st()[rr+4>>>2]}function Vr(rr,hr,xr,Or,Zr,rn){return Vt?An(17,1,rr,hr,xr,Or,Zr,rn):-52}function Xr(rr,hr,xr,Or,Zr,rn){if(Vt)return An(18,1,rr,hr,xr,Or,Zr,rn)}function cn(rr){var hr=fn(rr)+1,xr=up(hr);return xr&&un(rr,nt(),xr,hr),xr}function $n(rr,hr,xr){function Or(io){return(io=io.toTimeString().match(/\(([A-Za-z ]+)\)$/))?io[1]:"GMT"}if(Vt)return An(19,1,rr,hr,xr);var Zr=new Date().getFullYear(),rn=new Date(Zr,0,1),wn=new Date(Zr,6,1);Zr=rn.getTimezoneOffset();var Xn=wn.getTimezoneOffset(),fo=Math.max(Zr,Xn);st()[rr>>2>>>0]=60*fo,st()[hr>>2>>>0]=+(Zr!=Xn),rr=Or(rn),hr=Or(wn),rr=cn(rr),hr=cn(hr),Xn<Zr?(ut()[xr>>2>>>0]=rr,ut()[xr+4>>2>>>0]=hr):(ut()[xr>>2>>>0]=hr,ut()[xr+4>>2>>>0]=rr)}function An(rr,hr){var xr=arguments.length-2,Or=arguments;return ts(()=>{for(var Zr=cp(8*xr),rn=Zr>>3,wn=0;wn<xr;wn++){var Xn=Or[2+wn];ct()[rn+wn>>>0]=Xn}return Lu(rr,xr,Zr,hr)})}ot.executeNotifiedProxyingQueue=Nr,Ms=kt?()=>{var rr=process.hrtime();return 1e3*rr[0]+rr[1]/1e6}:Vt?()=>performance.now()-ot.__performance_now_clock_drift:()=>performance.now();var na,wo=[],ro={};function jo(){if(!na){var rr,hr={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Dt||"./this.program"};for(rr in ro)ro[rr]===void 0?delete hr[rr]:hr[rr]=ro[rr];var xr=[];for(rr in hr)xr.push(rr+"="+hr[rr]);na=xr}return na}function nn(rr,hr){if(Vt)return An(20,1,rr,hr);var xr=0;return jo().forEach(function(Or,Zr){var rn=hr+xr;for(Zr=ut()[rr+4*Zr>>2>>>0]=rn,rn=0;rn<Or.length;++rn)nt()[Zr++>>0>>>0]=Or.charCodeAt(rn);nt()[Zr>>0>>>0]=0,xr+=Or.length+1}),0}function to(rr,hr){if(Vt)return An(21,1,rr,hr);var xr=jo();ut()[rr>>2>>>0]=xr.length;var Or=0;return xr.forEach(function(Zr){Or+=Zr.length+1}),ut()[hr>>2>>>0]=Or,0}function mo(rr){return Vt?An(22,1,rr):52}function Rs(rr,hr,xr,Or){return Vt?An(23,1,rr,hr,xr,Or):52}function Yo(rr,hr,xr,Or,Zr){return Vt?An(24,1,rr,hr,xr,Or,Zr):70}var hs=[null,[],[]];function Ol(rr,hr){var xr=hs[rr];hr===0||hr===10?((rr===1?nr:cr)(pn(xr,0)),xr.length=0):xr.push(hr)}function $l(rr,hr,xr,Or){if(Vt)return An(25,1,rr,hr,xr,Or);for(var Zr=0,rn=0;rn<xr;rn++){var wn=ut()[hr>>2>>>0],Xn=ut()[hr+4>>2>>>0];hr+=8;for(var fo=0;fo<Xn;fo++)Ol(rr,it()[wn+fo>>>0]);Zr+=Xn}return ut()[Or>>2>>>0]=Zr,0}var To=0;function Nl(rr){return rr%4==0&&(rr%100!=0||rr%400==0)}var Ls=[31,29,31,30,31,30,31,31,30,31,30,31],Uo=[31,28,31,30,31,30,31,31,30,31,30,31];function uu(rr,hr,xr,Or){function Zr(tn,Gn,Ro){for(tn=typeof tn=="number"?tn.toString():tn||"";tn.length<Gn;)tn=Ro[0]+tn;return tn}function rn(tn,Gn){return Zr(tn,Gn,"0")}function wn(tn,Gn){function Ro(Us){return 0>Us?-1:0<Us?1:0}var Tl;return(Tl=Ro(tn.getFullYear()-Gn.getFullYear()))===0&&(Tl=Ro(tn.getMonth()-Gn.getMonth()))===0&&(Tl=Ro(tn.getDate()-Gn.getDate())),Tl}function Xn(tn){switch(tn.getDay()){case 0:return new Date(tn.getFullYear()-1,11,29);case 1:return tn;case 2:return new Date(tn.getFullYear(),0,3);case 3:return new Date(tn.getFullYear(),0,2);case 4:return new Date(tn.getFullYear(),0,1);case 5:return new Date(tn.getFullYear()-1,11,31);case 6:return new Date(tn.getFullYear()-1,11,30)}}function fo(tn){var Gn=tn.Wb;for(tn=new Date(new Date(tn.Xb+1900,0,1).getTime());0<Gn;){var Ro=tn.getMonth(),Tl=(Nl(tn.getFullYear())?Ls:Uo)[Ro];if(!(Gn>Tl-tn.getDate())){tn.setDate(tn.getDate()+Gn);break}Gn-=Tl-tn.getDate()+1,tn.setDate(1),11>Ro?tn.setMonth(Ro+1):(tn.setMonth(0),tn.setFullYear(tn.getFullYear()+1))}return Ro=new Date(tn.getFullYear()+1,0,4),Gn=Xn(new Date(tn.getFullYear(),0,4)),Ro=Xn(Ro),0>=wn(Gn,tn)?0>=wn(Ro,tn)?tn.getFullYear()+1:tn.getFullYear():tn.getFullYear()-1}var io=st()[Or+40>>2>>>0];for(var Go in Or={Lc:st()[Or>>2>>>0],Kc:st()[Or+4>>2>>>0],dc:st()[Or+8>>2>>>0],jc:st()[Or+12>>2>>>0],ec:st()[Or+16>>2>>>0],Xb:st()[Or+20>>2>>>0],Tb:st()[Or+24>>2>>>0],Wb:st()[Or+28>>2>>>0],Rc:st()[Or+32>>2>>>0],Jc:st()[Or+36>>2>>>0],Mc:io?yn(io):""},xr=yn(xr),io={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})xr=xr.replace(new RegExp(Go,"g"),io[Go]);var Os="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Qo="January February March April May June July August September October November December".split(" ");for(Go in io={"%a":function(tn){return Os[tn.Tb].substring(0,3)},"%A":function(tn){return Os[tn.Tb]},"%b":function(tn){return Qo[tn.ec].substring(0,3)},"%B":function(tn){return Qo[tn.ec]},"%C":function(tn){return rn((tn.Xb+1900)/100|0,2)},"%d":function(tn){return rn(tn.jc,2)},"%e":function(tn){return Zr(tn.jc,2," ")},"%g":function(tn){return fo(tn).toString().substring(2)},"%G":function(tn){return fo(tn)},"%H":function(tn){return rn(tn.dc,2)},"%I":function(tn){return(tn=tn.dc)==0?tn=12:12<tn&&(tn-=12),rn(tn,2)},"%j":function(tn){for(var Gn=0,Ro=0;Ro<=tn.ec-1;Gn+=(Nl(tn.Xb+1900)?Ls:Uo)[Ro++]);return rn(tn.jc+Gn,3)},"%m":function(tn){return rn(tn.ec+1,2)},"%M":function(tn){return rn(tn.Kc,2)},"%n":function(){return`
`},"%p":function(tn){return 0<=tn.dc&&12>tn.dc?"AM":"PM"},"%S":function(tn){return rn(tn.Lc,2)},"%t":function(){return"	"},"%u":function(tn){return tn.Tb||7},"%U":function(tn){return rn(Math.floor((tn.Wb+7-tn.Tb)/7),2)},"%V":function(tn){var Gn=Math.floor((tn.Wb+7-(tn.Tb+6)%7)/7);if(2>=(tn.Tb+371-tn.Wb-2)%7&&Gn++,Gn)Gn==53&&((Ro=(tn.Tb+371-tn.Wb)%7)==4||Ro==3&&Nl(tn.Xb)||(Gn=1));else{Gn=52;var Ro=(tn.Tb+7-tn.Wb-1)%7;(Ro==4||Ro==5&&Nl(tn.Xb%400-1))&&Gn++}return rn(Gn,2)},"%w":function(tn){return tn.Tb},"%W":function(tn){return rn(Math.floor((tn.Wb+7-(tn.Tb+6)%7)/7),2)},"%y":function(tn){return(tn.Xb+1900).toString().substring(2)},"%Y":function(tn){return tn.Xb+1900},"%z":function(tn){var Gn=0<=(tn=tn.Jc);return tn=Math.abs(tn)/60,(Gn?"+":"-")+("0000"+(tn/60*100+tn%60)).slice(-4)},"%Z":function(tn){return tn.Mc},"%%":function(){return"%"}},xr=xr.replace(/%%/g,"\0\0"),io)xr.includes(Go)&&(xr=xr.replace(new RegExp(Go,"g"),io[Go](Or)));return Go=function(tn){var Gn=Array(fn(tn)+1);return un(tn,Gn,0,Gn.length),Gn}(xr=xr.replace(/\0\0/g,"%")),Go.length>hr?0:(function(tn,Gn){nt().set(tn,Gn>>>0)}(Go,rr),Go.length-1)}bn.fc();var Vs=[null,ko,ms,wr,Fr,Hr,Pr,Qr,sn,Kr,vn,zn,Yn,po,ga,ur,br,Vr,Xr,$n,nn,to,mo,Rs,Yo,$l],lp={b:function(rr){return up(rr+24)+24},n:function(rr){return(rr=new tr(rr)).uc()||(rr.hc(!0),yr--),rr.ic(!1),ns.push(rr),rr.sc(),rr.vc()},ma:function(rr){throw cr("Unexpected exception thrown, this is not properly supported - aborting"),Rn=!0,rr},x:function(){lo(0);var rr=ns.pop();if(rr.Hc()&&!rr.kc()){var hr=rr.Dc();hr&&co(hr)(rr.Zb),fr(rr.Zb)}er=0},e:function(){var rr=er;if(!rr)return To=0;var hr=new tr(rr);hr.cc(rr);var xr=hr.bc();if(!xr)return To=0,rr;for(var Or=Array.prototype.slice.call(arguments),Zr=0;Zr<Or.length;Zr++){var rn=Or[Zr];if(rn===0||rn===xr)break;if(pu(rn,xr,hr.Sb+16))return To=rn,rr}return To=xr,rr},l:function(){var rr=er;if(!rr)return To=0;var hr=new tr(rr);hr.cc(rr);var xr=hr.bc();if(!xr)return To=0,rr;for(var Or=Array.prototype.slice.call(arguments),Zr=0;Zr<Or.length;Zr++){var rn=Or[Zr];if(rn===0||rn===xr)break;if(pu(rn,xr,hr.Sb+16))return To=rn,rr}return To=xr,rr},h:function(){var rr=er;if(!rr)return To=0;var hr=new tr(rr);hr.cc(rr);var xr=hr.bc();if(!xr)return To=0,rr;for(var Or=Array.prototype.slice.call(arguments),Zr=0;Zr<Or.length;Zr++){var rn=Or[Zr];if(rn===0||rn===xr)break;if(pu(rn,xr,hr.Sb+16))return To=rn,rr}return To=xr,rr},t:fr,M:function(){var rr=ns.pop();rr||eo("no exception to throw");var hr=rr.Zb;throw rr.kc()||(ns.push(rr),rr.ic(!0),rr.hc(!1),yr++),er=hr,hr},c:function(rr,hr,xr){throw new tr(rr).fc(hr,xr),er=rr,yr++,rr},pa:function(){return yr},Fa:function(rr){So(rr,!Ft,1,!$t),bn.pc()},T:function(rr){Vt?postMessage({cmd:"cleanupThread",thread:rr}):Wo(rr)},xa:Lr,j:function(rr){throw er||(er=rr),rr},H:Fr,Ma:Hr,ua:Pr,wa:Qr,oa:sn,Ka:Kr,Ca:vn,Ja:zn,V:Yn,va:po,sa:ga,La:ur,ta:br,Ta:function(){},X:function(){eo("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){eo("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(rr,hr,xr,Or){if(rr==hr)setTimeout(()=>Nr(Or));else if(Vt)postMessage({targetThread:rr,cmd:"processProxyingQueue",queue:Or});else{if(!(rr=bn.Vb[rr]))return;rr.postMessage({cmd:"processProxyingQueue",queue:Or})}return 1},Ea:function(){return-1},Pa:function(rr,hr){rr=new Date(1e3*Ur(rr)),st()[hr>>2>>>0]=rr.getUTCSeconds(),st()[hr+4>>2>>>0]=rr.getUTCMinutes(),st()[hr+8>>2>>>0]=rr.getUTCHours(),st()[hr+12>>2>>>0]=rr.getUTCDate(),st()[hr+16>>2>>>0]=rr.getUTCMonth(),st()[hr+20>>2>>>0]=rr.getUTCFullYear()-1900,st()[hr+24>>2>>>0]=rr.getUTCDay(),rr=(rr.getTime()-Date.UTC(rr.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,st()[hr+28>>2>>>0]=rr},Qa:function(rr,hr){rr=new Date(1e3*Ur(rr)),st()[hr>>2>>>0]=rr.getSeconds(),st()[hr+4>>2>>>0]=rr.getMinutes(),st()[hr+8>>2>>>0]=rr.getHours(),st()[hr+12>>2>>>0]=rr.getDate(),st()[hr+16>>2>>>0]=rr.getMonth(),st()[hr+20>>2>>>0]=rr.getFullYear()-1900,st()[hr+24>>2>>>0]=rr.getDay();var xr=new Date(rr.getFullYear(),0,1),Or=(rr.getTime()-xr.getTime())/864e5|0;st()[hr+28>>2>>>0]=Or,st()[hr+36>>2>>>0]=-60*rr.getTimezoneOffset(),Or=new Date(rr.getFullYear(),6,1).getTimezoneOffset(),rr=0|(Or!=(xr=xr.getTimezoneOffset())&&rr.getTimezoneOffset()==Math.min(xr,Or)),st()[hr+32>>2>>>0]=rr},Ra:function(rr){var hr=new Date(st()[rr+20>>2>>>0]+1900,st()[rr+16>>2>>>0],st()[rr+12>>2>>>0],st()[rr+8>>2>>>0],st()[rr+4>>2>>>0],st()[rr>>2>>>0],0),xr=st()[rr+32>>2>>>0],Or=hr.getTimezoneOffset(),Zr=new Date(hr.getFullYear(),0,1),rn=new Date(hr.getFullYear(),6,1).getTimezoneOffset(),wn=Zr.getTimezoneOffset(),Xn=Math.min(wn,rn);return 0>xr?st()[rr+32>>2>>>0]=+(rn!=wn&&Xn==Or):0<xr!=(Xn==Or)&&(rn=Math.max(wn,rn),hr.setTime(hr.getTime()+6e4*((0<xr?Xn:rn)-Or))),st()[rr+24>>2>>>0]=hr.getDay(),xr=(hr.getTime()-Zr.getTime())/864e5|0,st()[rr+28>>2>>>0]=xr,st()[rr>>2>>>0]=hr.getSeconds(),st()[rr+4>>2>>>0]=hr.getMinutes(),st()[rr+8>>2>>>0]=hr.getHours(),st()[rr+12>>2>>>0]=hr.getDate(),st()[rr+16>>2>>>0]=hr.getMonth(),hr.getTime()/1e3|0},Aa:Vr,Ba:Xr,Sa:function rr(hr,xr,Or){rr.Ac||(rr.Ac=!0,$n(hr,xr,Or))},y:function(){eo("")},U:function(){if(!kt&&!Ft){var rr="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";cs||(cs={}),cs[rr]||(cs[rr]=1,kt&&(rr="warning: "+rr),cr(rr))}},ra:function(){return 4294901760},B:Ms,Ia:function(rr,hr,xr){it().copyWithin(rr>>>0,hr>>>0,hr+xr>>>0)},F:function(){return kt?o(3993).cpus().length:navigator.hardwareConcurrency},Da:function(rr,hr,xr){wo.length=hr,xr>>=3;for(var Or=0;Or<hr;Or++)wo[Or]=ct()[xr+Or>>>0];return(0>rr?gn[-rr-1]:Vs[rr]).apply(null,wo)},qa:function(rr){var hr=it().length;if((rr>>>=0)<=hr||4294901760<rr)return!1;for(var xr=1;4>=xr;xr*=2){var Or=hr*(1+.2/xr);Or=Math.min(Or,rr+100663296);var Zr=Math;Or=Math.max(rr,Or),Zr=Zr.min.call(Zr,4294901760,Or+(65536-Or%65536)%65536);e:{try{mr.grow(Zr-kr.byteLength+65535>>>16),Bn(mr.buffer);var rn=1;break e}catch{}rn=void 0}if(rn)return!0}return!1},Na:function(){throw"unwind"},Ga:nn,Ha:to,J:_n,I:mo,S:Rs,ga:Yo,R:$l,d:function(){return To},na:function rr(hr,xr){rr.lc||(rr.lc=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var Zr=new Uint8Array(1);return()=>(crypto.getRandomValues(Zr),Zr[0])}if(kt)try{var rn=o(Object(function(){var wn=new Error("Cannot find module 'crypto'");throw wn.code="MODULE_NOT_FOUND",wn}()));return()=>rn.randomBytes(1)[0]}catch{}return()=>eo("randomDevice")}());for(var Or=0;Or<xr;Or++)nt()[hr+Or>>0>>>0]=rr.lc();return 0},ia:function(rr,hr,xr){var Or=so();try{return co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},ja:function(rr,hr,xr){var Or=so();try{return co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},K:function(rr){var hr=so();try{return co(rr)()}catch(xr){if(ho(hr),xr!==xr+0)throw xr;lo(1,0)}},f:function(rr,hr){var xr=so();try{return co(rr)(hr)}catch(Or){if(ho(xr),Or!==Or+0)throw Or;lo(1,0)}},P:function(rr,hr,xr){var Or=so();try{return co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},Q:function(rr,hr,xr){var Or=so();try{return co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},k:function(rr,hr,xr){var Or=so();try{return co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},p:function(rr,hr,xr,Or){var Zr=so();try{return co(rr)(hr,xr,Or)}catch(rn){if(ho(Zr),rn!==rn+0)throw rn;lo(1,0)}},q:function(rr,hr,xr,Or,Zr){var rn=so();try{return co(rr)(hr,xr,Or,Zr)}catch(wn){if(ho(rn),wn!==wn+0)throw wn;lo(1,0)}},N:function(rr,hr,xr,Or,Zr,rn){var wn=so();try{return co(rr)(hr,xr,Or,Zr,rn)}catch(Xn){if(ho(wn),Xn!==Xn+0)throw Xn;lo(1,0)}},s:function(rr,hr,xr,Or,Zr,rn){var wn=so();try{return co(rr)(hr,xr,Or,Zr,rn)}catch(Xn){if(ho(wn),Xn!==Xn+0)throw Xn;lo(1,0)}},w:function(rr,hr,xr,Or,Zr,rn,wn){var Xn=so();try{return co(rr)(hr,xr,Or,Zr,rn,wn)}catch(fo){if(ho(Xn),fo!==fo+0)throw fo;lo(1,0)}},L:function(rr,hr,xr,Or,Zr,rn,wn,Xn){var fo=so();try{return co(rr)(hr,xr,Or,Zr,rn,wn,Xn)}catch(io){if(ho(fo),io!==io+0)throw io;lo(1,0)}},E:function(rr,hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os){var Qo=so();try{return co(rr)(hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os)}catch(tn){if(ho(Qo),tn!==tn+0)throw tn;lo(1,0)}},aa:function(rr,hr,xr,Or,Zr,rn,wn,Xn){var fo=so();try{return Yl(rr,hr,xr,Or,Zr,rn,wn,Xn)}catch(io){if(ho(fo),io!==io+0)throw io;lo(1,0)}},_:function(rr,hr,xr,Or,Zr,rn,wn){var Xn=so();try{return tu(rr,hr,xr,Or,Zr,rn,wn)}catch(fo){if(ho(Xn),fo!==fo+0)throw fo;lo(1,0)}},Z:function(rr,hr,xr,Or,Zr){var rn=so();try{return Bp(rr,hr,xr,Or,Zr)}catch(wn){if(ho(rn),wn!==wn+0)throw wn;lo(1,0)}},ca:function(rr,hr,xr,Or){var Zr=so();try{return vu(rr,hr,xr,Or)}catch(rn){if(ho(Zr),rn!==rn+0)throw rn;lo(1,0)}},$:function(rr){var hr=so();try{return Bl(rr)}catch(xr){if(ho(hr),xr!==xr+0)throw xr;lo(1,0)}},ba:function(rr,hr){var xr=so();try{return hp(rr,hr)}catch(Or){if(ho(xr),Or!==Or+0)throw Or;lo(1,0)}},Y:function(rr,hr,xr){var Or=so();try{return fs(rr,hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},g:function(rr){var hr=so();try{co(rr)()}catch(xr){if(ho(hr),xr!==xr+0)throw xr;lo(1,0)}},r:function(rr,hr){var xr=so();try{co(rr)(hr)}catch(Or){if(ho(xr),Or!==Or+0)throw Or;lo(1,0)}},i:function(rr,hr,xr){var Or=so();try{co(rr)(hr,xr)}catch(Zr){if(ho(Or),Zr!==Zr+0)throw Zr;lo(1,0)}},ha:function(rr,hr,xr,Or){var Zr=so();try{co(rr)(hr,xr,Or)}catch(rn){if(ho(Zr),rn!==rn+0)throw rn;lo(1,0)}},m:function(rr,hr,xr,Or){var Zr=so();try{co(rr)(hr,xr,Or)}catch(rn){if(ho(Zr),rn!==rn+0)throw rn;lo(1,0)}},v:function(rr,hr,xr,Or,Zr){var rn=so();try{co(rr)(hr,xr,Or,Zr)}catch(wn){if(ho(rn),wn!==wn+0)throw wn;lo(1,0)}},u:function(rr,hr,xr,Or,Zr,rn){var wn=so();try{co(rr)(hr,xr,Or,Zr,rn)}catch(Xn){if(ho(wn),Xn!==Xn+0)throw Xn;lo(1,0)}},O:function(rr,hr,xr,Or,Zr,rn,wn){var Xn=so();try{co(rr)(hr,xr,Or,Zr,rn,wn)}catch(fo){if(ho(Xn),fo!==fo+0)throw fo;lo(1,0)}},A:function(rr,hr,xr,Or,Zr,rn,wn,Xn){var fo=so();try{co(rr)(hr,xr,Or,Zr,rn,wn,Xn)}catch(io){if(ho(fo),io!==io+0)throw io;lo(1,0)}},ka:function(rr,hr,xr,Or,Zr,rn,wn,Xn,fo){var io=so();try{co(rr)(hr,xr,Or,Zr,rn,wn,Xn,fo)}catch(Go){if(ho(io),Go!==Go+0)throw Go;lo(1,0)}},C:function(rr,hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go){var Os=so();try{co(rr)(hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go)}catch(Qo){if(ho(Os),Qo!==Qo+0)throw Qo;lo(1,0)}},D:function(rr,hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os,Qo,tn,Gn,Ro){var Tl=so();try{co(rr)(hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os,Qo,tn,Gn,Ro)}catch(Us){if(ho(Tl),Us!==Us+0)throw Us;lo(1,0)}},fa:function(rr,hr,xr,Or,Zr,rn,wn,Xn){var fo=so();try{ds(rr,hr,xr,Or,Zr,rn,wn,Xn)}catch(io){if(ho(fo),io!==io+0)throw io;lo(1,0)}},da:function(rr,hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os){var Qo=so();try{mu(rr,hr,xr,Or,Zr,rn,wn,Xn,fo,io,Go,Os)}catch(tn){if(ho(Qo),tn!==tn+0)throw tn;lo(1,0)}},ea:function(rr,hr,xr,Or,Zr,rn){var wn=so();try{gu(rr,hr,xr,Or,Zr,rn)}catch(Xn){if(ho(wn),Xn!==Xn+0)throw Xn;lo(1,0)}},o:function(rr){return rr},a:mr||ot.wasmMemory,G:function(rr){To=rr},la:uu,z:function(rr,hr,xr,Or){return uu(rr,hr,xr,Or)}};(function(){function rr(Zr,rn){ot.asm=Zr.exports,bn.qc.push(ot.asm.sb),Qn=ot.asm.ub,ao.unshift(ot.asm.Va),Dr=rn,Vt||(Mo--,ot.monitorRunDependencies&&ot.monitorRunDependencies(Mo),Mo==0&&ls&&(Zr=ls,ls=null,Zr()))}function hr(Zr){rr(Zr.instance,Zr.module)}function xr(Zr){return function(){if(!ar&&($t||Ft)){if(typeof fetch=="function"&&!xo.startsWith("file://"))return fetch(xo,{credentials:"same-origin"}).then(function(rn){if(!rn.ok)throw"failed to load wasm binary file at '"+xo+"'";return rn.arrayBuffer()}).catch(function(){return qs()});if(mt)return new Promise(function(rn,wn){mt(xo,function(Xn){rn(new Uint8Array(Xn))},wn)})}return Promise.resolve().then(function(){return qs()})}().then(function(rn){return WebAssembly.instantiate(rn,Or)}).then(function(rn){return rn}).then(Zr,function(rn){cr("failed to asynchronously prepare wasm: "+rn),eo(rn)})}var Or={a:lp};if(Vt||(Mo++,ot.monitorRunDependencies&&ot.monitorRunDependencies(Mo)),ot.instantiateWasm)try{return ot.instantiateWasm(Or,rr)}catch(Zr){return cr("Module.instantiateWasm callback failed with error: "+Zr),!1}(ar||typeof WebAssembly.instantiateStreaming!="function"||wl()||xo.startsWith("file://")||kt||typeof fetch!="function"?xr(hr):fetch(xo,{credentials:"same-origin"}).then(function(Zr){return WebAssembly.instantiateStreaming(Zr,Or).then(hr,function(rn){return cr("wasm streaming compile failed: "+rn),cr("falling back to ArrayBuffer instantiation"),xr(hr)})})).catch(ht)})(),ot.___wasm_call_ctors=function(){return(ot.___wasm_call_ctors=ot.asm.Va).apply(null,arguments)},ot._OrtInit=function(){return(ot._OrtInit=ot.asm.Wa).apply(null,arguments)},ot._OrtCreateSessionOptions=function(){return(ot._OrtCreateSessionOptions=ot.asm.Xa).apply(null,arguments)},ot._OrtAppendExecutionProvider=function(){return(ot._OrtAppendExecutionProvider=ot.asm.Ya).apply(null,arguments)},ot._OrtAddSessionConfigEntry=function(){return(ot._OrtAddSessionConfigEntry=ot.asm.Za).apply(null,arguments)},ot._OrtReleaseSessionOptions=function(){return(ot._OrtReleaseSessionOptions=ot.asm._a).apply(null,arguments)},ot._OrtCreateSession=function(){return(ot._OrtCreateSession=ot.asm.$a).apply(null,arguments)},ot._OrtReleaseSession=function(){return(ot._OrtReleaseSession=ot.asm.ab).apply(null,arguments)},ot._OrtGetInputCount=function(){return(ot._OrtGetInputCount=ot.asm.bb).apply(null,arguments)},ot._OrtGetOutputCount=function(){return(ot._OrtGetOutputCount=ot.asm.cb).apply(null,arguments)},ot._OrtGetInputName=function(){return(ot._OrtGetInputName=ot.asm.db).apply(null,arguments)},ot._OrtGetOutputName=function(){return(ot._OrtGetOutputName=ot.asm.eb).apply(null,arguments)},ot._OrtFree=function(){return(ot._OrtFree=ot.asm.fb).apply(null,arguments)},ot._OrtCreateTensor=function(){return(ot._OrtCreateTensor=ot.asm.gb).apply(null,arguments)},ot._OrtGetTensorData=function(){return(ot._OrtGetTensorData=ot.asm.hb).apply(null,arguments)},ot._OrtReleaseTensor=function(){return(ot._OrtReleaseTensor=ot.asm.ib).apply(null,arguments)},ot._OrtCreateRunOptions=function(){return(ot._OrtCreateRunOptions=ot.asm.jb).apply(null,arguments)},ot._OrtAddRunConfigEntry=function(){return(ot._OrtAddRunConfigEntry=ot.asm.kb).apply(null,arguments)},ot._OrtReleaseRunOptions=function(){return(ot._OrtReleaseRunOptions=ot.asm.lb).apply(null,arguments)},ot._OrtRun=function(){return(ot._OrtRun=ot.asm.mb).apply(null,arguments)},ot._OrtEndProfiling=function(){return(ot._OrtEndProfiling=ot.asm.nb).apply(null,arguments)};var vs=ot._pthread_self=function(){return(vs=ot._pthread_self=ot.asm.ob).apply(null,arguments)},up=ot._malloc=function(){return(up=ot._malloc=ot.asm.pb).apply(null,arguments)},cu=ot._free=function(){return(cu=ot._free=ot.asm.qb).apply(null,arguments)},Fl=ot._fflush=function(){return(Fl=ot._fflush=ot.asm.rb).apply(null,arguments)};ot.__emscripten_tls_init=function(){return(ot.__emscripten_tls_init=ot.asm.sb).apply(null,arguments)};var Sl=ot.___funcs_on_exit=function(){return(Sl=ot.___funcs_on_exit=ot.asm.tb).apply(null,arguments)},So=ot.__emscripten_thread_init=function(){return(So=ot.__emscripten_thread_init=ot.asm.vb).apply(null,arguments)};ot.__emscripten_thread_crashed=function(){return(ot.__emscripten_thread_crashed=ot.asm.wb).apply(null,arguments)};var eu,Lu=ot._emscripten_run_in_main_runtime_thread_js=function(){return(Lu=ot._emscripten_run_in_main_runtime_thread_js=ot.asm.xb).apply(null,arguments)},Wl=ot.__emscripten_proxy_execute_task_queue=function(){return(Wl=ot.__emscripten_proxy_execute_task_queue=ot.asm.yb).apply(null,arguments)},hu=ot.__emscripten_thread_free_data=function(){return(hu=ot.__emscripten_thread_free_data=ot.asm.zb).apply(null,arguments)},fu=ot.__emscripten_thread_exit=function(){return(fu=ot.__emscripten_thread_exit=ot.asm.Ab).apply(null,arguments)},lo=ot._setThrew=function(){return(lo=ot._setThrew=ot.asm.Bb).apply(null,arguments)},du=ot._emscripten_stack_set_limits=function(){return(du=ot._emscripten_stack_set_limits=ot.asm.Cb).apply(null,arguments)},so=ot.stackSave=function(){return(so=ot.stackSave=ot.asm.Db).apply(null,arguments)},ho=ot.stackRestore=function(){return(ho=ot.stackRestore=ot.asm.Eb).apply(null,arguments)},cp=ot.stackAlloc=function(){return(cp=ot.stackAlloc=ot.asm.Fb).apply(null,arguments)},pu=ot.___cxa_can_catch=function(){return(pu=ot.___cxa_can_catch=ot.asm.Gb).apply(null,arguments)},Fp=ot.___cxa_is_pointer_type=function(){return(Fp=ot.___cxa_is_pointer_type=ot.asm.Hb).apply(null,arguments)},Bl=ot.dynCall_j=function(){return(Bl=ot.dynCall_j=ot.asm.Ib).apply(null,arguments)},tu=ot.dynCall_iiiiij=function(){return(tu=ot.dynCall_iiiiij=ot.asm.Jb).apply(null,arguments)},fs=ot.dynCall_jii=function(){return(fs=ot.dynCall_jii=ot.asm.Kb).apply(null,arguments)},ds=ot.dynCall_viiiiij=function(){return(ds=ot.dynCall_viiiiij=ot.asm.Lb).apply(null,arguments)},gu=ot.dynCall_vjji=function(){return(gu=ot.dynCall_vjji=ot.asm.Mb).apply(null,arguments)},mu=ot.dynCall_viiijjjii=function(){return(mu=ot.dynCall_viiijjjii=ot.asm.Nb).apply(null,arguments)},vu=ot.dynCall_iij=function(){return(vu=ot.dynCall_iij=ot.asm.Ob).apply(null,arguments)},hp=ot.dynCall_ji=function(){return(hp=ot.dynCall_ji=ot.asm.Pb).apply(null,arguments)},Yl=ot.dynCall_iiiiiij=function(){return(Yl=ot.dynCall_iiiiiij=ot.asm.Qb).apply(null,arguments)},Bp=ot.dynCall_iiij=function(){return(Bp=ot.dynCall_iiij=ot.asm.Rb).apply(null,arguments)};function fp(){function rr(){if(!eu&&(eu=!0,ot.calledRun=!0,!Rn)&&(Vt||Zn(ao),at(ot),ot.onRuntimeInitialized&&ot.onRuntimeInitialized(),!Vt)){if(ot.postRun)for(typeof ot.postRun=="function"&&(ot.postRun=[ot.postRun]);ot.postRun.length;){var hr=ot.postRun.shift();Wn.unshift(hr)}Zn(Wn)}}if(!(0<Mo))if(Vt)at(ot),Vt||Zn(ao),postMessage({cmd:"loaded"});else{if(ot.preRun)for(typeof ot.preRun=="function"&&(ot.preRun=[ot.preRun]);ot.preRun.length;)Eo();Zn(zr),0<Mo||(ot.setStatus?(ot.setStatus("Running..."),setTimeout(function(){setTimeout(function(){ot.setStatus("")},1),rr()},1)):rr())}}if(ot.UTF8ToString=yn,ot.stringToUTF8=function(rr,hr,xr){return un(rr,it(),hr,xr)},ot.lengthBytesUTF8=fn,ot.keepRuntimeAlive=no,ot.wasmMemory=mr,ot.stackSave=so,ot.stackRestore=ho,ot.stackAlloc=cp,ot.ExitStatus=Jo,ot.PThread=bn,ls=function rr(){eu||fp(),eu||(ls=rr)},ot.preInit)for(typeof ot.preInit=="function"&&(ot.preInit=[ot.preInit]);0<ot.preInit.length;)ot.preInit.pop()();return fp(),tt.ready});s.exports=d},932:(s,a,o)=>{var c,d=(c=(c=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(tt){var nt,it,st;tt=tt||{},nt||(nt=tt!==void 0?tt:{}),nt.ready=new Promise(function(ur,br){it=ur,st=br});var ut,ct,ot,at,ht,ft,mt=Object.assign({},nt),yt="./this.program",bt=(ur,br)=>{throw br},wt=typeof window=="object",Tt=typeof importScripts=="function",Ct=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Dt="";Ct?(Dt=Tt?o(908).dirname(Dt)+"/":"//",ft=()=>{ht||(at=o(1384),ht=o(908))},ut=function(ur,br){return ft(),ur=ht.normalize(ur),at.readFileSync(ur,br?void 0:"utf8")},ot=ur=>((ur=ut(ur,!0)).buffer||(ur=new Uint8Array(ur)),ur),ct=(ur,br,Nr)=>{ft(),ur=ht.normalize(ur),at.readFile(ur,function(Ur,Vr){Ur?Nr(Ur):br(Vr.buffer)})},1<process.argv.length&&(yt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(ur){if(!(ur instanceof ao))throw ur}),process.on("unhandledRejection",function(ur){throw ur}),bt=(ur,br)=>{if(kt||0<hn)throw process.exitCode=ur,br;br instanceof ao||Ft("exiting due to exception: "+br),process.exit(ur)},nt.inspect=function(){return"[Emscripten Module object]"}):(wt||Tt)&&(Tt?Dt=self.location.href:typeof document<"u"&&document.currentScript&&(Dt=document.currentScript.src),c&&(Dt=c),Dt=Dt.indexOf("blob:")!==0?Dt.substr(0,Dt.replace(/[?#].*/,"").lastIndexOf("/")+1):"",ut=ur=>{var br=new XMLHttpRequest;return br.open("GET",ur,!1),br.send(null),br.responseText},Tt&&(ot=ur=>{var br=new XMLHttpRequest;return br.open("GET",ur,!1),br.responseType="arraybuffer",br.send(null),new Uint8Array(br.response)}),ct=(ur,br,Nr)=>{var Ur=new XMLHttpRequest;Ur.open("GET",ur,!0),Ur.responseType="arraybuffer",Ur.onload=()=>{Ur.status==200||Ur.status==0&&Ur.response?br(Ur.response):Nr()},Ur.onerror=Nr,Ur.send(null)});var Ot,$t=nt.print||console.log.bind(console),Ft=nt.printErr||console.warn.bind(console);Object.assign(nt,mt),mt=null,nt.thisProgram&&(yt=nt.thisProgram),nt.quit&&(bt=nt.quit),nt.wasmBinary&&(Ot=nt.wasmBinary);var kt=nt.noExitRuntime||!1;typeof WebAssembly!="object"&&Bn("no native wasm support detected");var Vt,Ht,Qt,Xt,Zt,ar,nr=!1,cr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function dr(ur,br,Nr){var Ur=(br>>>=0)+Nr;for(Nr=br;ur[Nr]&&!(Nr>=Ur);)++Nr;if(16<Nr-br&&ur.buffer&&cr)return cr.decode(ur.subarray(br,Nr));for(Ur="";br<Nr;){var Vr=ur[br++];if(128&Vr){var Xr=63&ur[br++];if((224&Vr)==192)Ur+=String.fromCharCode((31&Vr)<<6|Xr);else{var cn=63&ur[br++];65536>(Vr=(240&Vr)==224?(15&Vr)<<12|Xr<<6|cn:(7&Vr)<<18|Xr<<12|cn<<6|63&ur[br++])?Ur+=String.fromCharCode(Vr):(Vr-=65536,Ur+=String.fromCharCode(55296|Vr>>10,56320|1023&Vr))}}else Ur+=String.fromCharCode(Vr)}return Ur}function mr(ur,br){return(ur>>>=0)?dr(Xt,ur,br):""}function Dr(ur,br,Nr,Ur){if(!(0<Ur))return 0;var Vr=Nr>>>=0;Ur=Nr+Ur-1;for(var Xr=0;Xr<ur.length;++Xr){var cn=ur.charCodeAt(Xr);if(55296<=cn&&57343>=cn&&(cn=65536+((1023&cn)<<10)|1023&ur.charCodeAt(++Xr)),127>=cn){if(Nr>=Ur)break;br[Nr++>>>0]=cn}else{if(2047>=cn){if(Nr+1>=Ur)break;br[Nr++>>>0]=192|cn>>6}else{if(65535>=cn){if(Nr+2>=Ur)break;br[Nr++>>>0]=224|cn>>12}else{if(Nr+3>=Ur)break;br[Nr++>>>0]=240|cn>>18,br[Nr++>>>0]=128|cn>>12&63}br[Nr++>>>0]=128|cn>>6&63}br[Nr++>>>0]=128|63&cn}}return br[Nr>>>0]=0,Nr-Vr}function kr(ur){for(var br=0,Nr=0;Nr<ur.length;++Nr){var Ur=ur.charCodeAt(Nr);127>=Ur?br++:2047>=Ur?br+=2:55296<=Ur&&57343>=Ur?(br+=4,++Nr):br+=3}return br}function Yr(){var ur=Vt.buffer;Ht=ur,nt.HEAP8=Qt=new Int8Array(ur),nt.HEAP16=new Int16Array(ur),nt.HEAP32=Zt=new Int32Array(ur),nt.HEAPU8=Xt=new Uint8Array(ur),nt.HEAPU16=new Uint16Array(ur),nt.HEAPU32=ar=new Uint32Array(ur),nt.HEAPF32=new Float32Array(ur),nt.HEAPF64=new Float64Array(ur)}var Mr,Jr=[],an=[],xn=[],Rn=[],hn=0;function pn(){var ur=nt.preRun.shift();Jr.unshift(ur)}var yn,un=0,fn=null;function Bn(ur){throw nt.onAbort&&nt.onAbort(ur),Ft(ur="Aborted("+ur+")"),nr=!0,ur=new WebAssembly.RuntimeError(ur+". Build with -sASSERTIONS for more info."),st(ur),ur}function Dn(){return yn.startsWith("data:application/octet-stream;base64,")}if(yn="ort-wasm.wasm",!Dn()){var Qn=yn;yn=nt.locateFile?nt.locateFile(Qn,Dt):Dt+Qn}function zr(){var ur=yn;try{if(ur==yn&&Ot)return new Uint8Array(Ot);if(ot)return ot(ur);throw"both async and sync fetching of the wasm failed"}catch(br){Bn(br)}}function ao(ur){this.name="ExitStatus",this.message="Program terminated with exit("+ur+")",this.status=ur}function oo(ur){for(;0<ur.length;)ur.shift()(nt)}var Wn=[],no=0,Eo=0;function xo(ur){this.Db=ur,this.zb=ur-24,this.Ub=function(br){ar[this.zb+4>>2>>>0]=br},this.Eb=function(){return ar[this.zb+4>>2>>>0]},this.Sb=function(br){ar[this.zb+8>>2>>>0]=br},this.Wb=function(){return ar[this.zb+8>>2>>>0]},this.Tb=function(){Zt[this.zb>>2>>>0]=0},this.Ib=function(br){Qt[this.zb+12>>0>>>0]=br?1:0},this.Pb=function(){return Qt[this.zb+12>>0>>>0]!=0},this.Jb=function(br){Qt[this.zb+13>>0>>>0]=br?1:0},this.Lb=function(){return Qt[this.zb+13>>0>>>0]!=0},this.Rb=function(br,Nr){this.Fb(0),this.Ub(br),this.Sb(Nr),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){Zt[this.zb>>2>>>0]+=1},this.Xb=function(){var br=Zt[this.zb>>2>>>0];return Zt[this.zb>>2>>>0]=br-1,br===1},this.Fb=function(br){ar[this.zb+16>>2>>>0]=br},this.Ob=function(){return ar[this.zb+16>>2>>>0]},this.Qb=function(){if(Lr(this.Eb()))return ar[this.Db>>2>>>0];var br=this.Ob();return br!==0?br:this.Db}}function Mo(ur){return cs(new xo(ur).zb)}var ls=[];function eo(ur){var br=ls[ur];return br||(ur>=ls.length&&(ls.length=ur+1),ls[ur]=br=Mr.get(ur)),br}function wl(ur){var br=kr(ur)+1,Nr=co(br);return Nr&&Dr(ur,Qt,Nr,br),Nr}var qs={};function gn(){if(!Jo){var ur,br={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:yt||"./this.program"};for(ur in qs)qs[ur]===void 0?delete br[ur]:br[ur]=qs[ur];var Nr=[];for(ur in br)Nr.push(ur+"="+br[ur]);Jo=Nr}return Jo}var Jo,Wo=[null,[],[]];function us(ur,br){var Nr=Wo[ur];br===0||br===10?((ur===1?$t:Ft)(dr(Nr,0)),Nr.length=0):Nr.push(br)}var ko=0;function _n(ur){return ur%4==0&&(ur%100!=0||ur%400==0)}var bn=[31,29,31,30,31,30,31,31,30,31,30,31],Zn=[31,28,31,30,31,30,31,31,30,31,30,31];function ts(ur,br,Nr,Ur){function Vr(nn,to,mo){for(nn=typeof nn=="number"?nn.toString():nn||"";nn.length<to;)nn=mo[0]+nn;return nn}function Xr(nn,to){return Vr(nn,to,"0")}function cn(nn,to){function mo(Yo){return 0>Yo?-1:0<Yo?1:0}var Rs;return(Rs=mo(nn.getFullYear()-to.getFullYear()))===0&&(Rs=mo(nn.getMonth()-to.getMonth()))===0&&(Rs=mo(nn.getDate()-to.getDate())),Rs}function $n(nn){switch(nn.getDay()){case 0:return new Date(nn.getFullYear()-1,11,29);case 1:return nn;case 2:return new Date(nn.getFullYear(),0,3);case 3:return new Date(nn.getFullYear(),0,2);case 4:return new Date(nn.getFullYear(),0,1);case 5:return new Date(nn.getFullYear()-1,11,31);case 6:return new Date(nn.getFullYear()-1,11,30)}}function An(nn){var to=nn.Bb;for(nn=new Date(new Date(nn.Cb+1900,0,1).getTime());0<to;){var mo=nn.getMonth(),Rs=(_n(nn.getFullYear())?bn:Zn)[mo];if(!(to>Rs-nn.getDate())){nn.setDate(nn.getDate()+to);break}to-=Rs-nn.getDate()+1,nn.setDate(1),11>mo?nn.setMonth(mo+1):(nn.setMonth(0),nn.setFullYear(nn.getFullYear()+1))}return mo=new Date(nn.getFullYear()+1,0,4),to=$n(new Date(nn.getFullYear(),0,4)),mo=$n(mo),0>=cn(to,nn)?0>=cn(mo,nn)?nn.getFullYear()+1:nn.getFullYear():nn.getFullYear()-1}var na=Zt[Ur+40>>2>>>0];for(var wo in Ur={$b:Zt[Ur>>2>>>0],Zb:Zt[Ur+4>>2>>>0],Gb:Zt[Ur+8>>2>>>0],Kb:Zt[Ur+12>>2>>>0],Hb:Zt[Ur+16>>2>>>0],Cb:Zt[Ur+20>>2>>>0],Ab:Zt[Ur+24>>2>>>0],Bb:Zt[Ur+28>>2>>>0],bc:Zt[Ur+32>>2>>>0],Yb:Zt[Ur+36>>2>>>0],ac:na?mr(na):""},Nr=mr(Nr),na={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})Nr=Nr.replace(new RegExp(wo,"g"),na[wo]);var ro="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),jo="January February March April May June July August September October November December".split(" ");for(wo in na={"%a":function(nn){return ro[nn.Ab].substring(0,3)},"%A":function(nn){return ro[nn.Ab]},"%b":function(nn){return jo[nn.Hb].substring(0,3)},"%B":function(nn){return jo[nn.Hb]},"%C":function(nn){return Xr((nn.Cb+1900)/100|0,2)},"%d":function(nn){return Xr(nn.Kb,2)},"%e":function(nn){return Vr(nn.Kb,2," ")},"%g":function(nn){return An(nn).toString().substring(2)},"%G":function(nn){return An(nn)},"%H":function(nn){return Xr(nn.Gb,2)},"%I":function(nn){return(nn=nn.Gb)==0?nn=12:12<nn&&(nn-=12),Xr(nn,2)},"%j":function(nn){for(var to=0,mo=0;mo<=nn.Hb-1;to+=(_n(nn.Cb+1900)?bn:Zn)[mo++]);return Xr(nn.Kb+to,3)},"%m":function(nn){return Xr(nn.Hb+1,2)},"%M":function(nn){return Xr(nn.Zb,2)},"%n":function(){return`
`},"%p":function(nn){return 0<=nn.Gb&&12>nn.Gb?"AM":"PM"},"%S":function(nn){return Xr(nn.$b,2)},"%t":function(){return"	"},"%u":function(nn){return nn.Ab||7},"%U":function(nn){return Xr(Math.floor((nn.Bb+7-nn.Ab)/7),2)},"%V":function(nn){var to=Math.floor((nn.Bb+7-(nn.Ab+6)%7)/7);if(2>=(nn.Ab+371-nn.Bb-2)%7&&to++,to)to==53&&((mo=(nn.Ab+371-nn.Bb)%7)==4||mo==3&&_n(nn.Cb)||(to=1));else{to=52;var mo=(nn.Ab+7-nn.Bb-1)%7;(mo==4||mo==5&&_n(nn.Cb%400-1))&&to++}return Xr(to,2)},"%w":function(nn){return nn.Ab},"%W":function(nn){return Xr(Math.floor((nn.Bb+7-(nn.Ab+6)%7)/7),2)},"%y":function(nn){return(nn.Cb+1900).toString().substring(2)},"%Y":function(nn){return nn.Cb+1900},"%z":function(nn){var to=0<=(nn=nn.Yb);return nn=Math.abs(nn)/60,(to?"+":"-")+("0000"+(nn/60*100+nn%60)).slice(-4)},"%Z":function(nn){return nn.ac},"%%":function(){return"%"}},Nr=Nr.replace(/%%/g,"\0\0"),na)Nr.includes(wo)&&(Nr=Nr.replace(new RegExp(wo,"g"),na[wo](Ur)));return wo=function(nn){var to=Array(kr(nn)+1);return Dr(nn,to,0,to.length),to}(Nr=Nr.replace(/\0\0/g,"%")),wo.length>br?0:(Qt.set(wo,ur>>>0),wo.length-1)}var ms={a:function(ur){return co(ur+24)+24},m:function(ur){return(ur=new xo(ur)).Pb()||(ur.Ib(!0),no--),ur.Jb(!1),Wn.push(ur),ur.Nb(),ur.Qb()},ia:function(ur){throw Ft("Unexpected exception thrown, this is not properly supported - aborting"),nr=!0,ur},w:function(){yr(0);var ur=Wn.pop();if(ur.Xb()&&!ur.Lb()){var br=ur.Wb();br&&eo(br)(ur.Db),Mo(ur.Db)}Eo=0},d:function(){var ur=Eo;if(!ur)return ko=0;var br=new xo(ur);br.Fb(ur);var Nr=br.Eb();if(!Nr)return ko=0,ur;for(var Ur=Array.prototype.slice.call(arguments),Vr=0;Vr<Ur.length;Vr++){var Xr=Ur[Vr];if(Xr===0||Xr===Nr)break;if(wr(Xr,Nr,br.zb+16))return ko=Xr,ur}return ko=Nr,ur},k:function(){var ur=Eo;if(!ur)return ko=0;var br=new xo(ur);br.Fb(ur);var Nr=br.Eb();if(!Nr)return ko=0,ur;for(var Ur=Array.prototype.slice.call(arguments),Vr=0;Vr<Ur.length;Vr++){var Xr=Ur[Vr];if(Xr===0||Xr===Nr)break;if(wr(Xr,Nr,br.zb+16))return ko=Xr,ur}return ko=Nr,ur},g:function(){var ur=Eo;if(!ur)return ko=0;var br=new xo(ur);br.Fb(ur);var Nr=br.Eb();if(!Nr)return ko=0,ur;for(var Ur=Array.prototype.slice.call(arguments),Vr=0;Vr<Ur.length;Vr++){var Xr=Ur[Vr];if(Xr===0||Xr===Nr)break;if(wr(Xr,Nr,br.zb+16))return ko=Xr,ur}return ko=Nr,ur},s:Mo,L:function(){var ur=Wn.pop();ur||Bn("no exception to throw");var br=ur.Db;throw ur.Lb()||(Wn.push(ur),ur.Jb(!0),ur.Ib(!1),no++),Eo=br,br},b:function(ur,br,Nr){throw new xo(ur).Rb(br,Nr),Eo=ur,no++,ur},la:function(){return no},i:function(ur){throw Eo||(Eo=ur),ur},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){Bn("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){Bn("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(ur,br){ur=new Date(1e3*(ar[ur>>>2]+4294967296*Zt[ur+4>>>2])),Zt[br>>2>>>0]=ur.getUTCSeconds(),Zt[br+4>>2>>>0]=ur.getUTCMinutes(),Zt[br+8>>2>>>0]=ur.getUTCHours(),Zt[br+12>>2>>>0]=ur.getUTCDate(),Zt[br+16>>2>>>0]=ur.getUTCMonth(),Zt[br+20>>2>>>0]=ur.getUTCFullYear()-1900,Zt[br+24>>2>>>0]=ur.getUTCDay(),Zt[br+28>>2>>>0]=(ur.getTime()-Date.UTC(ur.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(ur,br){ur=new Date(1e3*(ar[ur>>>2]+4294967296*Zt[ur+4>>>2])),Zt[br>>2>>>0]=ur.getSeconds(),Zt[br+4>>2>>>0]=ur.getMinutes(),Zt[br+8>>2>>>0]=ur.getHours(),Zt[br+12>>2>>>0]=ur.getDate(),Zt[br+16>>2>>>0]=ur.getMonth(),Zt[br+20>>2>>>0]=ur.getFullYear()-1900,Zt[br+24>>2>>>0]=ur.getDay();var Nr=new Date(ur.getFullYear(),0,1);Zt[br+28>>2>>>0]=(ur.getTime()-Nr.getTime())/864e5|0,Zt[br+36>>2>>>0]=-60*ur.getTimezoneOffset();var Ur=new Date(ur.getFullYear(),6,1).getTimezoneOffset();Nr=Nr.getTimezoneOffset(),Zt[br+32>>2>>>0]=0|(Ur!=Nr&&ur.getTimezoneOffset()==Math.min(Nr,Ur))},Fa:function(ur){var br=new Date(Zt[ur+20>>2>>>0]+1900,Zt[ur+16>>2>>>0],Zt[ur+12>>2>>>0],Zt[ur+8>>2>>>0],Zt[ur+4>>2>>>0],Zt[ur>>2>>>0],0),Nr=Zt[ur+32>>2>>>0],Ur=br.getTimezoneOffset(),Vr=new Date(br.getFullYear(),0,1),Xr=new Date(br.getFullYear(),6,1).getTimezoneOffset(),cn=Vr.getTimezoneOffset(),$n=Math.min(cn,Xr);return 0>Nr?Zt[ur+32>>2>>>0]=+(Xr!=cn&&$n==Ur):0<Nr!=($n==Ur)&&(Xr=Math.max(cn,Xr),br.setTime(br.getTime()+6e4*((0<Nr?$n:Xr)-Ur))),Zt[ur+24>>2>>>0]=br.getDay(),Zt[ur+28>>2>>>0]=(br.getTime()-Vr.getTime())/864e5|0,Zt[ur>>2>>>0]=br.getSeconds(),Zt[ur+4>>2>>>0]=br.getMinutes(),Zt[ur+8>>2>>>0]=br.getHours(),Zt[ur+12>>2>>>0]=br.getDate(),Zt[ur+16>>2>>>0]=br.getMonth(),br.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function ur(br,Nr,Ur){ur.Vb||(ur.Vb=!0,function(Vr,Xr,cn){function $n(jo){return(jo=jo.toTimeString().match(/\(([A-Za-z ]+)\)$/))?jo[1]:"GMT"}var An=new Date().getFullYear(),na=new Date(An,0,1),wo=new Date(An,6,1);An=na.getTimezoneOffset();var ro=wo.getTimezoneOffset();Zt[Vr>>2>>>0]=60*Math.max(An,ro),Zt[Xr>>2>>>0]=+(An!=ro),Vr=$n(na),Xr=$n(wo),Vr=wl(Vr),Xr=wl(Xr),ro<An?(ar[cn>>2>>>0]=Vr,ar[cn+4>>2>>>0]=Xr):(ar[cn>>2>>>0]=Xr,ar[cn+4>>2>>>0]=Vr)}(br,Nr,Ur))},B:function(){Bn("")},ma:function(){return 4294901760},I:Ct?()=>{var ur=process.hrtime();return 1e3*ur[0]+ur[1]/1e6}:()=>performance.now(),xa:function(ur,br,Nr){Xt.copyWithin(ur>>>0,br>>>0,br+Nr>>>0)},G:function(ur){var br=Xt.length;if(4294901760<(ur>>>=0))return!1;for(var Nr=1;4>=Nr;Nr*=2){var Ur=br*(1+.2/Nr);Ur=Math.min(Ur,ur+100663296);var Vr=Math;Ur=Math.max(ur,Ur),Vr=Vr.min.call(Vr,4294901760,Ur+(65536-Ur%65536)%65536);e:{try{Vt.grow(Vr-Ht.byteLength+65535>>>16),Yr();var Xr=1;break e}catch{}Xr=void 0}if(Xr)return!0}return!1},va:function(ur,br){var Nr=0;return gn().forEach(function(Ur,Vr){var Xr=br+Nr;for(Vr=ar[ur+4*Vr>>2>>>0]=Xr,Xr=0;Xr<Ur.length;++Xr)Qt[Vr++>>0>>>0]=Ur.charCodeAt(Xr);Qt[Vr>>0>>>0]=0,Nr+=Ur.length+1}),0},wa:function(ur,br){var Nr=gn();ar[ur>>2>>>0]=Nr.length;var Ur=0;return Nr.forEach(function(Vr){Ur+=Vr.length+1}),ar[br>>2>>>0]=Ur,0},ba:function(ur){kt||0<hn||(ns(),oo(xn),Ms(0),Wo[1].length&&us(1,10),Wo[2].length&&us(2,10)),kt||0<hn||(nt.onExit&&nt.onExit(ur),nr=!0),bt(ur,new ao(ur))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(ur,br,Nr,Ur){for(var Vr=0,Xr=0;Xr<Nr;Xr++){var cn=ar[br>>2>>>0],$n=ar[br+4>>2>>>0];br+=8;for(var An=0;An<$n;An++)us(ur,Xt[cn+An>>>0]);Vr+=$n}return ar[Ur>>2>>>0]=Vr,0},c:function(){return ko},ja:function ur(br,Nr){ur.Mb||(ur.Mb=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var Vr=new Uint8Array(1);return()=>(crypto.getRandomValues(Vr),Vr[0])}if(Ct)try{var Xr=o(Object(function(){var cn=new Error("Cannot find module 'crypto'");throw cn.code="MODULE_NOT_FOUND",cn}()));return()=>Xr.randomBytes(1)[0]}catch{}return()=>Bn("randomDevice")}());for(var Ur=0;Ur<Nr;Ur++)Qt[br+Ur>>0>>>0]=ur.Mb();return 0},ea:function(ur,br,Nr){var Ur=er();try{return eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},fa:function(ur,br,Nr){var Ur=er();try{return eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},J:function(ur){var br=er();try{return eo(ur)()}catch(Nr){if(tr(br),Nr!==Nr+0)throw Nr;yr(1,0)}},e:function(ur,br){var Nr=er();try{return eo(ur)(br)}catch(Ur){if(tr(Nr),Ur!==Ur+0)throw Ur;yr(1,0)}},N:function(ur,br,Nr){var Ur=er();try{return eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},O:function(ur,br,Nr){var Ur=er();try{return eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},j:function(ur,br,Nr){var Ur=er();try{return eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},o:function(ur,br,Nr,Ur){var Vr=er();try{return eo(ur)(br,Nr,Ur)}catch(Xr){if(tr(Vr),Xr!==Xr+0)throw Xr;yr(1,0)}},p:function(ur,br,Nr,Ur,Vr){var Xr=er();try{return eo(ur)(br,Nr,Ur,Vr)}catch(cn){if(tr(Xr),cn!==cn+0)throw cn;yr(1,0)}},M:function(ur,br,Nr,Ur,Vr,Xr){var cn=er();try{return eo(ur)(br,Nr,Ur,Vr,Xr)}catch($n){if(tr(cn),$n!==$n+0)throw $n;yr(1,0)}},r:function(ur,br,Nr,Ur,Vr,Xr){var cn=er();try{return eo(ur)(br,Nr,Ur,Vr,Xr)}catch($n){if(tr(cn),$n!==$n+0)throw $n;yr(1,0)}},v:function(ur,br,Nr,Ur,Vr,Xr,cn){var $n=er();try{return eo(ur)(br,Nr,Ur,Vr,Xr,cn)}catch(An){if(tr($n),An!==An+0)throw An;yr(1,0)}},K:function(ur,br,Nr,Ur,Vr,Xr,cn,$n){var An=er();try{return eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n)}catch(na){if(tr(An),na!==na+0)throw na;yr(1,0)}},D:function(ur,br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro){var jo=er();try{return eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro)}catch(nn){if(tr(jo),nn!==nn+0)throw nn;yr(1,0)}},X:function(ur,br,Nr,Ur,Vr,Xr,cn,$n){var An=er();try{return Yn(ur,br,Nr,Ur,Vr,Xr,cn,$n)}catch(na){if(tr(An),na!==na+0)throw na;yr(1,0)}},V:function(ur,br,Nr,Ur,Vr,Xr,cn){var $n=er();try{return Hr(ur,br,Nr,Ur,Vr,Xr,cn)}catch(An){if(tr($n),An!==An+0)throw An;yr(1,0)}},U:function(ur,br,Nr,Ur,Vr){var Xr=er();try{return po(ur,br,Nr,Ur,Vr)}catch(cn){if(tr(Xr),cn!==cn+0)throw cn;yr(1,0)}},Z:function(ur,br,Nr,Ur){var Vr=er();try{return vn(ur,br,Nr,Ur)}catch(Xr){if(tr(Vr),Xr!==Xr+0)throw Xr;yr(1,0)}},W:function(ur){var br=er();try{return Fr(ur)}catch(Nr){if(tr(br),Nr!==Nr+0)throw Nr;yr(1,0)}},Y:function(ur,br){var Nr=er();try{return zn(ur,br)}catch(Ur){if(tr(Nr),Ur!==Ur+0)throw Ur;yr(1,0)}},T:function(ur,br,Nr){var Ur=er();try{return Pr(ur,br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},f:function(ur){var br=er();try{eo(ur)()}catch(Nr){if(tr(br),Nr!==Nr+0)throw Nr;yr(1,0)}},q:function(ur,br){var Nr=er();try{eo(ur)(br)}catch(Ur){if(tr(Nr),Ur!==Ur+0)throw Ur;yr(1,0)}},h:function(ur,br,Nr){var Ur=er();try{eo(ur)(br,Nr)}catch(Vr){if(tr(Ur),Vr!==Vr+0)throw Vr;yr(1,0)}},da:function(ur,br,Nr,Ur){var Vr=er();try{eo(ur)(br,Nr,Ur)}catch(Xr){if(tr(Vr),Xr!==Xr+0)throw Xr;yr(1,0)}},l:function(ur,br,Nr,Ur){var Vr=er();try{eo(ur)(br,Nr,Ur)}catch(Xr){if(tr(Vr),Xr!==Xr+0)throw Xr;yr(1,0)}},t:function(ur,br,Nr,Ur,Vr){var Xr=er();try{eo(ur)(br,Nr,Ur,Vr)}catch(cn){if(tr(Xr),cn!==cn+0)throw cn;yr(1,0)}},u:function(ur,br,Nr,Ur,Vr,Xr){var cn=er();try{eo(ur)(br,Nr,Ur,Vr,Xr)}catch($n){if(tr(cn),$n!==$n+0)throw $n;yr(1,0)}},x:function(ur,br,Nr,Ur,Vr,Xr,cn){var $n=er();try{eo(ur)(br,Nr,Ur,Vr,Xr,cn)}catch(An){if(tr($n),An!==An+0)throw An;yr(1,0)}},z:function(ur,br,Nr,Ur,Vr,Xr,cn,$n){var An=er();try{eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n)}catch(na){if(tr(An),na!==na+0)throw na;yr(1,0)}},ga:function(ur,br,Nr,Ur,Vr,Xr,cn,$n,An){var na=er();try{eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n,An)}catch(wo){if(tr(na),wo!==wo+0)throw wo;yr(1,0)}},A:function(ur,br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo){var ro=er();try{eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo)}catch(jo){if(tr(ro),jo!==jo+0)throw jo;yr(1,0)}},C:function(ur,br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro,jo,nn,to,mo){var Rs=er();try{eo(ur)(br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro,jo,nn,to,mo)}catch(Yo){if(tr(Rs),Yo!==Yo+0)throw Yo;yr(1,0)}},aa:function(ur,br,Nr,Ur,Vr,Xr,cn,$n){var An=er();try{Qr(ur,br,Nr,Ur,Vr,Xr,cn,$n)}catch(na){if(tr(An),na!==na+0)throw na;yr(1,0)}},_:function(ur,br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro){var jo=er();try{Kr(ur,br,Nr,Ur,Vr,Xr,cn,$n,An,na,wo,ro)}catch(nn){if(tr(jo),nn!==nn+0)throw nn;yr(1,0)}},$:function(ur,br,Nr,Ur,Vr,Xr){var cn=er();try{sn(ur,br,Nr,Ur,Vr,Xr)}catch($n){if(tr(cn),$n!==$n+0)throw $n;yr(1,0)}},n:function(ur){return ur},F:function(ur){ko=ur},ha:ts,y:function(ur,br,Nr,Ur){return ts(ur,br,Nr,Ur)}};(function(){function ur(Vr){nt.asm=Vr.exports,Vt=nt.asm.Ka,Yr(),Mr=nt.asm.ib,an.unshift(nt.asm.La),un--,nt.monitorRunDependencies&&nt.monitorRunDependencies(un),un==0&&fn&&(Vr=fn,fn=null,Vr())}function br(Vr){ur(Vr.instance)}function Nr(Vr){return function(){if(!Ot&&(wt||Tt)){if(typeof fetch=="function"&&!yn.startsWith("file://"))return fetch(yn,{credentials:"same-origin"}).then(function(Xr){if(!Xr.ok)throw"failed to load wasm binary file at '"+yn+"'";return Xr.arrayBuffer()}).catch(function(){return zr()});if(ct)return new Promise(function(Xr,cn){ct(yn,function($n){Xr(new Uint8Array($n))},cn)})}return Promise.resolve().then(function(){return zr()})}().then(function(Xr){return WebAssembly.instantiate(Xr,Ur)}).then(function(Xr){return Xr}).then(Vr,function(Xr){Ft("failed to asynchronously prepare wasm: "+Xr),Bn(Xr)})}var Ur={a:ms};if(un++,nt.monitorRunDependencies&&nt.monitorRunDependencies(un),nt.instantiateWasm)try{return nt.instantiateWasm(Ur,ur)}catch(Vr){return Ft("Module.instantiateWasm callback failed with error: "+Vr),!1}(Ot||typeof WebAssembly.instantiateStreaming!="function"||Dn()||yn.startsWith("file://")||Ct||typeof fetch!="function"?Nr(br):fetch(yn,{credentials:"same-origin"}).then(function(Vr){return WebAssembly.instantiateStreaming(Vr,Ur).then(br,function(Xr){return Ft("wasm streaming compile failed: "+Xr),Ft("falling back to ArrayBuffer instantiation"),Nr(br)})})).catch(st)})(),nt.___wasm_call_ctors=function(){return(nt.___wasm_call_ctors=nt.asm.La).apply(null,arguments)},nt._OrtInit=function(){return(nt._OrtInit=nt.asm.Ma).apply(null,arguments)},nt._OrtCreateSessionOptions=function(){return(nt._OrtCreateSessionOptions=nt.asm.Na).apply(null,arguments)},nt._OrtAppendExecutionProvider=function(){return(nt._OrtAppendExecutionProvider=nt.asm.Oa).apply(null,arguments)},nt._OrtAddSessionConfigEntry=function(){return(nt._OrtAddSessionConfigEntry=nt.asm.Pa).apply(null,arguments)},nt._OrtReleaseSessionOptions=function(){return(nt._OrtReleaseSessionOptions=nt.asm.Qa).apply(null,arguments)},nt._OrtCreateSession=function(){return(nt._OrtCreateSession=nt.asm.Ra).apply(null,arguments)},nt._OrtReleaseSession=function(){return(nt._OrtReleaseSession=nt.asm.Sa).apply(null,arguments)},nt._OrtGetInputCount=function(){return(nt._OrtGetInputCount=nt.asm.Ta).apply(null,arguments)},nt._OrtGetOutputCount=function(){return(nt._OrtGetOutputCount=nt.asm.Ua).apply(null,arguments)},nt._OrtGetInputName=function(){return(nt._OrtGetInputName=nt.asm.Va).apply(null,arguments)},nt._OrtGetOutputName=function(){return(nt._OrtGetOutputName=nt.asm.Wa).apply(null,arguments)},nt._OrtFree=function(){return(nt._OrtFree=nt.asm.Xa).apply(null,arguments)},nt._OrtCreateTensor=function(){return(nt._OrtCreateTensor=nt.asm.Ya).apply(null,arguments)},nt._OrtGetTensorData=function(){return(nt._OrtGetTensorData=nt.asm.Za).apply(null,arguments)},nt._OrtReleaseTensor=function(){return(nt._OrtReleaseTensor=nt.asm._a).apply(null,arguments)},nt._OrtCreateRunOptions=function(){return(nt._OrtCreateRunOptions=nt.asm.$a).apply(null,arguments)},nt._OrtAddRunConfigEntry=function(){return(nt._OrtAddRunConfigEntry=nt.asm.ab).apply(null,arguments)},nt._OrtReleaseRunOptions=function(){return(nt._OrtReleaseRunOptions=nt.asm.bb).apply(null,arguments)},nt._OrtRun=function(){return(nt._OrtRun=nt.asm.cb).apply(null,arguments)},nt._OrtEndProfiling=function(){return(nt._OrtEndProfiling=nt.asm.db).apply(null,arguments)};var Kn,co=nt._malloc=function(){return(co=nt._malloc=nt.asm.eb).apply(null,arguments)},cs=nt._free=function(){return(cs=nt._free=nt.asm.fb).apply(null,arguments)},Ms=nt._fflush=function(){return(Ms=nt._fflush=nt.asm.gb).apply(null,arguments)},ns=nt.___funcs_on_exit=function(){return(ns=nt.___funcs_on_exit=nt.asm.hb).apply(null,arguments)},yr=nt._setThrew=function(){return(yr=nt._setThrew=nt.asm.jb).apply(null,arguments)},er=nt.stackSave=function(){return(er=nt.stackSave=nt.asm.kb).apply(null,arguments)},tr=nt.stackRestore=function(){return(tr=nt.stackRestore=nt.asm.lb).apply(null,arguments)},fr=nt.stackAlloc=function(){return(fr=nt.stackAlloc=nt.asm.mb).apply(null,arguments)},wr=nt.___cxa_can_catch=function(){return(wr=nt.___cxa_can_catch=nt.asm.nb).apply(null,arguments)},Lr=nt.___cxa_is_pointer_type=function(){return(Lr=nt.___cxa_is_pointer_type=nt.asm.ob).apply(null,arguments)},Fr=nt.dynCall_j=function(){return(Fr=nt.dynCall_j=nt.asm.pb).apply(null,arguments)},Hr=nt.dynCall_iiiiij=function(){return(Hr=nt.dynCall_iiiiij=nt.asm.qb).apply(null,arguments)},Pr=nt.dynCall_jii=function(){return(Pr=nt.dynCall_jii=nt.asm.rb).apply(null,arguments)},Qr=nt.dynCall_viiiiij=function(){return(Qr=nt.dynCall_viiiiij=nt.asm.sb).apply(null,arguments)},sn=nt.dynCall_vjji=function(){return(sn=nt.dynCall_vjji=nt.asm.tb).apply(null,arguments)},Kr=nt.dynCall_viiijjjii=function(){return(Kr=nt.dynCall_viiijjjii=nt.asm.ub).apply(null,arguments)},vn=nt.dynCall_iij=function(){return(vn=nt.dynCall_iij=nt.asm.vb).apply(null,arguments)},zn=nt.dynCall_ji=function(){return(zn=nt.dynCall_ji=nt.asm.wb).apply(null,arguments)},Yn=nt.dynCall_iiiiiij=function(){return(Yn=nt.dynCall_iiiiiij=nt.asm.xb).apply(null,arguments)},po=nt.dynCall_iiij=function(){return(po=nt.dynCall_iiij=nt.asm.yb).apply(null,arguments)};function ga(){function ur(){if(!Kn&&(Kn=!0,nt.calledRun=!0,!nr)){if(oo(an),it(nt),nt.onRuntimeInitialized&&nt.onRuntimeInitialized(),nt.postRun)for(typeof nt.postRun=="function"&&(nt.postRun=[nt.postRun]);nt.postRun.length;){var br=nt.postRun.shift();Rn.unshift(br)}oo(Rn)}}if(!(0<un)){if(nt.preRun)for(typeof nt.preRun=="function"&&(nt.preRun=[nt.preRun]);nt.preRun.length;)pn();oo(Jr),0<un||(nt.setStatus?(nt.setStatus("Running..."),setTimeout(function(){setTimeout(function(){nt.setStatus("")},1),ur()},1)):ur())}}if(nt.UTF8ToString=mr,nt.stringToUTF8=function(ur,br,Nr){return Dr(ur,Xt,br,Nr)},nt.lengthBytesUTF8=kr,nt.stackSave=er,nt.stackRestore=tr,nt.stackAlloc=fr,fn=function ur(){Kn||ga(),Kn||(fn=ur)},nt.preInit)for(typeof nt.preInit=="function"&&(nt.preInit=[nt.preInit]);0<nt.preInit.length;)nt.preInit.pop()();return ga(),tt.ready});s.exports=d},4537:s=>{s.exports=function(a,o){for(var c=new Array(arguments.length-1),d=0,tt=2,nt=!0;tt<arguments.length;)c[d++]=arguments[tt++];return new Promise(function(it,st){c[d]=function(ut){if(nt)if(nt=!1,ut)st(ut);else{for(var ct=new Array(arguments.length-1),ot=0;ot<ct.length;)ct[ot++]=arguments[ot];it.apply(null,ct)}};try{a.apply(o||null,c)}catch(ut){nt&&(nt=!1,st(ut))}})}},7419:(s,a)=>{var o=a;o.length=function(it){var st=it.length;if(!st)return 0;for(var ut=0;--st%4>1&&it.charAt(st)==="=";)++ut;return Math.ceil(3*it.length)/4-ut};for(var c=new Array(64),d=new Array(123),tt=0;tt<64;)d[c[tt]=tt<26?tt+65:tt<52?tt+71:tt<62?tt-4:tt-59|43]=tt++;o.encode=function(it,st,ut){for(var ct,ot=null,at=[],ht=0,ft=0;st<ut;){var mt=it[st++];switch(ft){case 0:at[ht++]=c[mt>>2],ct=(3&mt)<<4,ft=1;break;case 1:at[ht++]=c[ct|mt>>4],ct=(15&mt)<<2,ft=2;break;case 2:at[ht++]=c[ct|mt>>6],at[ht++]=c[63&mt],ft=0}ht>8191&&((ot||(ot=[])).push(String.fromCharCode.apply(String,at)),ht=0)}return ft&&(at[ht++]=c[ct],at[ht++]=61,ft===1&&(at[ht++]=61)),ot?(ht&&ot.push(String.fromCharCode.apply(String,at.slice(0,ht))),ot.join("")):String.fromCharCode.apply(String,at.slice(0,ht))};var nt="invalid encoding";o.decode=function(it,st,ut){for(var ct,ot=ut,at=0,ht=0;ht<it.length;){var ft=it.charCodeAt(ht++);if(ft===61&&at>1)break;if((ft=d[ft])===void 0)throw Error(nt);switch(at){case 0:ct=ft,at=1;break;case 1:st[ut++]=ct<<2|(48&ft)>>4,ct=ft,at=2;break;case 2:st[ut++]=(15&ct)<<4|(60&ft)>>2,ct=ft,at=3;break;case 3:st[ut++]=(3&ct)<<6|ft,at=0}}if(at===1)throw Error(nt);return ut-ot},o.test=function(it){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(it)}},9211:s=>{function a(){this._listeners={}}s.exports=a,a.prototype.on=function(o,c,d){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:c,ctx:d||this}),this},a.prototype.off=function(o,c){if(o===void 0)this._listeners={};else if(c===void 0)this._listeners[o]=[];else for(var d=this._listeners[o],tt=0;tt<d.length;)d[tt].fn===c?d.splice(tt,1):++tt;return this},a.prototype.emit=function(o){var c=this._listeners[o];if(c){for(var d=[],tt=1;tt<arguments.length;)d.push(arguments[tt++]);for(tt=0;tt<c.length;)c[tt].fn.apply(c[tt++].ctx,d)}return this}},945:s=>{function a(nt){return typeof Float32Array<"u"?function(){var it=new Float32Array([-0]),st=new Uint8Array(it.buffer),ut=st[3]===128;function ct(ft,mt,yt){it[0]=ft,mt[yt]=st[0],mt[yt+1]=st[1],mt[yt+2]=st[2],mt[yt+3]=st[3]}function ot(ft,mt,yt){it[0]=ft,mt[yt]=st[3],mt[yt+1]=st[2],mt[yt+2]=st[1],mt[yt+3]=st[0]}function at(ft,mt){return st[0]=ft[mt],st[1]=ft[mt+1],st[2]=ft[mt+2],st[3]=ft[mt+3],it[0]}function ht(ft,mt){return st[3]=ft[mt],st[2]=ft[mt+1],st[1]=ft[mt+2],st[0]=ft[mt+3],it[0]}nt.writeFloatLE=ut?ct:ot,nt.writeFloatBE=ut?ot:ct,nt.readFloatLE=ut?at:ht,nt.readFloatBE=ut?ht:at}():function(){function it(ut,ct,ot,at){var ht=ct<0?1:0;if(ht&&(ct=-ct),ct===0)ut(1/ct>0?0:2147483648,ot,at);else if(isNaN(ct))ut(2143289344,ot,at);else if(ct>34028234663852886e22)ut((ht<<31|2139095040)>>>0,ot,at);else if(ct<11754943508222875e-54)ut((ht<<31|Math.round(ct/1401298464324817e-60))>>>0,ot,at);else{var ft=Math.floor(Math.log(ct)/Math.LN2);ut((ht<<31|ft+127<<23|8388607&Math.round(ct*Math.pow(2,-ft)*8388608))>>>0,ot,at)}}function st(ut,ct,ot){var at=ut(ct,ot),ht=2*(at>>31)+1,ft=at>>>23&255,mt=8388607&at;return ft===255?mt?NaN:ht*(1/0):ft===0?1401298464324817e-60*ht*mt:ht*Math.pow(2,ft-150)*(mt+8388608)}nt.writeFloatLE=it.bind(null,o),nt.writeFloatBE=it.bind(null,c),nt.readFloatLE=st.bind(null,d),nt.readFloatBE=st.bind(null,tt)}(),typeof Float64Array<"u"?function(){var it=new Float64Array([-0]),st=new Uint8Array(it.buffer),ut=st[7]===128;function ct(ft,mt,yt){it[0]=ft,mt[yt]=st[0],mt[yt+1]=st[1],mt[yt+2]=st[2],mt[yt+3]=st[3],mt[yt+4]=st[4],mt[yt+5]=st[5],mt[yt+6]=st[6],mt[yt+7]=st[7]}function ot(ft,mt,yt){it[0]=ft,mt[yt]=st[7],mt[yt+1]=st[6],mt[yt+2]=st[5],mt[yt+3]=st[4],mt[yt+4]=st[3],mt[yt+5]=st[2],mt[yt+6]=st[1],mt[yt+7]=st[0]}function at(ft,mt){return st[0]=ft[mt],st[1]=ft[mt+1],st[2]=ft[mt+2],st[3]=ft[mt+3],st[4]=ft[mt+4],st[5]=ft[mt+5],st[6]=ft[mt+6],st[7]=ft[mt+7],it[0]}function ht(ft,mt){return st[7]=ft[mt],st[6]=ft[mt+1],st[5]=ft[mt+2],st[4]=ft[mt+3],st[3]=ft[mt+4],st[2]=ft[mt+5],st[1]=ft[mt+6],st[0]=ft[mt+7],it[0]}nt.writeDoubleLE=ut?ct:ot,nt.writeDoubleBE=ut?ot:ct,nt.readDoubleLE=ut?at:ht,nt.readDoubleBE=ut?ht:at}():function(){function it(ut,ct,ot,at,ht,ft){var mt=at<0?1:0;if(mt&&(at=-at),at===0)ut(0,ht,ft+ct),ut(1/at>0?0:2147483648,ht,ft+ot);else if(isNaN(at))ut(0,ht,ft+ct),ut(2146959360,ht,ft+ot);else if(at>17976931348623157e292)ut(0,ht,ft+ct),ut((mt<<31|2146435072)>>>0,ht,ft+ot);else{var yt;if(at<22250738585072014e-324)ut((yt=at/5e-324)>>>0,ht,ft+ct),ut((mt<<31|yt/4294967296)>>>0,ht,ft+ot);else{var bt=Math.floor(Math.log(at)/Math.LN2);bt===1024&&(bt=1023),ut(4503599627370496*(yt=at*Math.pow(2,-bt))>>>0,ht,ft+ct),ut((mt<<31|bt+1023<<20|1048576*yt&1048575)>>>0,ht,ft+ot)}}}function st(ut,ct,ot,at,ht){var ft=ut(at,ht+ct),mt=ut(at,ht+ot),yt=2*(mt>>31)+1,bt=mt>>>20&2047,wt=4294967296*(1048575&mt)+ft;return bt===2047?wt?NaN:yt*(1/0):bt===0?5e-324*yt*wt:yt*Math.pow(2,bt-1075)*(wt+4503599627370496)}nt.writeDoubleLE=it.bind(null,o,0,4),nt.writeDoubleBE=it.bind(null,c,4,0),nt.readDoubleLE=st.bind(null,d,0,4),nt.readDoubleBE=st.bind(null,tt,4,0)}(),nt}function o(nt,it,st){it[st]=255&nt,it[st+1]=nt>>>8&255,it[st+2]=nt>>>16&255,it[st+3]=nt>>>24}function c(nt,it,st){it[st]=nt>>>24,it[st+1]=nt>>>16&255,it[st+2]=nt>>>8&255,it[st+3]=255&nt}function d(nt,it){return(nt[it]|nt[it+1]<<8|nt[it+2]<<16|nt[it+3]<<24)>>>0}function tt(nt,it){return(nt[it]<<24|nt[it+1]<<16|nt[it+2]<<8|nt[it+3])>>>0}s.exports=a(a)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(s){}return null}module.exports=inquire},6662:s=>{s.exports=function(a,o,c){var d=c||8192,tt=d>>>1,nt=null,it=d;return function(st){if(st<1||st>tt)return a(st);it+st>d&&(nt=a(d),it=0);var ut=o.call(nt,it,it+=st);return 7&it&&(it=1+(7|it)),ut}}},4997:(s,a)=>{var o=a;o.length=function(c){for(var d=0,tt=0,nt=0;nt<c.length;++nt)(tt=c.charCodeAt(nt))<128?d+=1:tt<2048?d+=2:(64512&tt)==55296&&(64512&c.charCodeAt(nt+1))==56320?(++nt,d+=4):d+=3;return d},o.read=function(c,d,tt){if(tt-d<1)return"";for(var nt,it=null,st=[],ut=0;d<tt;)(nt=c[d++])<128?st[ut++]=nt:nt>191&&nt<224?st[ut++]=(31&nt)<<6|63&c[d++]:nt>239&&nt<365?(nt=((7&nt)<<18|(63&c[d++])<<12|(63&c[d++])<<6|63&c[d++])-65536,st[ut++]=55296+(nt>>10),st[ut++]=56320+(1023&nt)):st[ut++]=(15&nt)<<12|(63&c[d++])<<6|63&c[d++],ut>8191&&((it||(it=[])).push(String.fromCharCode.apply(String,st)),ut=0);return it?(ut&&it.push(String.fromCharCode.apply(String,st.slice(0,ut))),it.join("")):String.fromCharCode.apply(String,st.slice(0,ut))},o.write=function(c,d,tt){for(var nt,it,st=tt,ut=0;ut<c.length;++ut)(nt=c.charCodeAt(ut))<128?d[tt++]=nt:nt<2048?(d[tt++]=nt>>6|192,d[tt++]=63&nt|128):(64512&nt)==55296&&(64512&(it=c.charCodeAt(ut+1)))==56320?(nt=65536+((1023&nt)<<10)+(1023&it),++ut,d[tt++]=nt>>18|240,d[tt++]=nt>>12&63|128,d[tt++]=nt>>6&63|128,d[tt++]=63&nt|128):(d[tt++]=nt>>12|224,d[tt++]=nt>>6&63|128,d[tt++]=63&nt|128);return tt-st}},3442:(s,a)=>{a.__esModule=!0;var o=function(){function c(d){if(!d)throw new TypeError("Invalid argument; `value` has no value.");this.value=c.EMPTY,d&&c.isGuid(d)&&(this.value=d)}return c.isGuid=function(d){var tt=d.toString();return d&&(d instanceof c||c.validator.test(tt))},c.create=function(){return new c([c.gen(2),c.gen(1),c.gen(1),c.gen(1),c.gen(3)].join("-"))},c.createEmpty=function(){return new c("emptyguid")},c.parse=function(d){return new c(d)},c.raw=function(){return[c.gen(2),c.gen(1),c.gen(1),c.gen(1),c.gen(3)].join("-")},c.gen=function(d){for(var tt="",nt=0;nt<d;nt++)tt+=(65536*(1+Math.random())|0).toString(16).substring(1);return tt},c.prototype.equals=function(d){return c.isGuid(d)&&this.value===d.toString()},c.prototype.isEmpty=function(){return this.value===c.EMPTY},c.prototype.toString=function(){return this.value},c.prototype.toJSON=function(){return{value:this.value}},c.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),c.EMPTY="00000000-0000-0000-0000-000000000000",c}();a.Guid=o},3720:s=>{s.exports=o;var a=null;try{a=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function o(kt,Vt,Ht){this.low=0|kt,this.high=0|Vt,this.unsigned=!!Ht}function c(kt){return(kt&&kt.__isLong__)===!0}o.prototype.__isLong__,Object.defineProperty(o.prototype,"__isLong__",{value:!0}),o.isLong=c;var d={},tt={};function nt(kt,Vt){var Ht,Qt,Xt;return Vt?(Xt=0<=(kt>>>=0)&&kt<256)&&(Qt=tt[kt])?Qt:(Ht=st(kt,(0|kt)<0?-1:0,!0),Xt&&(tt[kt]=Ht),Ht):(Xt=-128<=(kt|=0)&&kt<128)&&(Qt=d[kt])?Qt:(Ht=st(kt,kt<0?-1:0,!1),Xt&&(d[kt]=Ht),Ht)}function it(kt,Vt){if(isNaN(kt))return Vt?bt:yt;if(Vt){if(kt<0)return bt;if(kt>=ht)return Ot}else{if(kt<=-ft)return $t;if(kt+1>=ft)return Dt}return kt<0?it(-kt,Vt).neg():st(kt%at|0,kt/at|0,Vt)}function st(kt,Vt,Ht){return new o(kt,Vt,Ht)}o.fromInt=nt,o.fromNumber=it,o.fromBits=st;var ut=Math.pow;function ct(kt,Vt,Ht){if(kt.length===0)throw Error("empty string");if(kt==="NaN"||kt==="Infinity"||kt==="+Infinity"||kt==="-Infinity")return yt;if(typeof Vt=="number"?(Ht=Vt,Vt=!1):Vt=!!Vt,(Ht=Ht||10)<2||36<Ht)throw RangeError("radix");var Qt;if((Qt=kt.indexOf("-"))>0)throw Error("interior hyphen");if(Qt===0)return ct(kt.substring(1),Vt,Ht).neg();for(var Xt=it(ut(Ht,8)),Zt=yt,ar=0;ar<kt.length;ar+=8){var nr=Math.min(8,kt.length-ar),cr=parseInt(kt.substring(ar,ar+nr),Ht);if(nr<8){var dr=it(ut(Ht,nr));Zt=Zt.mul(dr).add(it(cr))}else Zt=(Zt=Zt.mul(Xt)).add(it(cr))}return Zt.unsigned=Vt,Zt}function ot(kt,Vt){return typeof kt=="number"?it(kt,Vt):typeof kt=="string"?ct(kt,Vt):st(kt.low,kt.high,typeof Vt=="boolean"?Vt:kt.unsigned)}o.fromString=ct,o.fromValue=ot;var at=4294967296,ht=at*at,ft=ht/2,mt=nt(1<<24),yt=nt(0);o.ZERO=yt;var bt=nt(0,!0);o.UZERO=bt;var wt=nt(1);o.ONE=wt;var Tt=nt(1,!0);o.UONE=Tt;var Ct=nt(-1);o.NEG_ONE=Ct;var Dt=st(-1,2147483647,!1);o.MAX_VALUE=Dt;var Ot=st(-1,-1,!0);o.MAX_UNSIGNED_VALUE=Ot;var $t=st(0,-2147483648,!1);o.MIN_VALUE=$t;var Ft=o.prototype;Ft.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ft.toNumber=function(){return this.unsigned?(this.high>>>0)*at+(this.low>>>0):this.high*at+(this.low>>>0)},Ft.toString=function(kt){if((kt=kt||10)<2||36<kt)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq($t)){var Vt=it(kt),Ht=this.div(Vt),Qt=Ht.mul(Vt).sub(this);return Ht.toString(kt)+Qt.toInt().toString(kt)}return"-"+this.neg().toString(kt)}for(var Xt=it(ut(kt,6),this.unsigned),Zt=this,ar="";;){var nr=Zt.div(Xt),cr=(Zt.sub(nr.mul(Xt)).toInt()>>>0).toString(kt);if((Zt=nr).isZero())return cr+ar;for(;cr.length<6;)cr="0"+cr;ar=""+cr+ar}},Ft.getHighBits=function(){return this.high},Ft.getHighBitsUnsigned=function(){return this.high>>>0},Ft.getLowBits=function(){return this.low},Ft.getLowBitsUnsigned=function(){return this.low>>>0},Ft.getNumBitsAbs=function(){if(this.isNegative())return this.eq($t)?64:this.neg().getNumBitsAbs();for(var kt=this.high!=0?this.high:this.low,Vt=31;Vt>0&&!(kt&1<<Vt);Vt--);return this.high!=0?Vt+33:Vt+1},Ft.isZero=function(){return this.high===0&&this.low===0},Ft.eqz=Ft.isZero,Ft.isNegative=function(){return!this.unsigned&&this.high<0},Ft.isPositive=function(){return this.unsigned||this.high>=0},Ft.isOdd=function(){return(1&this.low)==1},Ft.isEven=function(){return(1&this.low)==0},Ft.equals=function(kt){return c(kt)||(kt=ot(kt)),(this.unsigned===kt.unsigned||this.high>>>31!=1||kt.high>>>31!=1)&&this.high===kt.high&&this.low===kt.low},Ft.eq=Ft.equals,Ft.notEquals=function(kt){return!this.eq(kt)},Ft.neq=Ft.notEquals,Ft.ne=Ft.notEquals,Ft.lessThan=function(kt){return this.comp(kt)<0},Ft.lt=Ft.lessThan,Ft.lessThanOrEqual=function(kt){return this.comp(kt)<=0},Ft.lte=Ft.lessThanOrEqual,Ft.le=Ft.lessThanOrEqual,Ft.greaterThan=function(kt){return this.comp(kt)>0},Ft.gt=Ft.greaterThan,Ft.greaterThanOrEqual=function(kt){return this.comp(kt)>=0},Ft.gte=Ft.greaterThanOrEqual,Ft.ge=Ft.greaterThanOrEqual,Ft.compare=function(kt){if(c(kt)||(kt=ot(kt)),this.eq(kt))return 0;var Vt=this.isNegative(),Ht=kt.isNegative();return Vt&&!Ht?-1:!Vt&&Ht?1:this.unsigned?kt.high>>>0>this.high>>>0||kt.high===this.high&&kt.low>>>0>this.low>>>0?-1:1:this.sub(kt).isNegative()?-1:1},Ft.comp=Ft.compare,Ft.negate=function(){return!this.unsigned&&this.eq($t)?$t:this.not().add(wt)},Ft.neg=Ft.negate,Ft.add=function(kt){c(kt)||(kt=ot(kt));var Vt=this.high>>>16,Ht=65535&this.high,Qt=this.low>>>16,Xt=65535&this.low,Zt=kt.high>>>16,ar=65535&kt.high,nr=kt.low>>>16,cr=0,dr=0,mr=0,Dr=0;return mr+=(Dr+=Xt+(65535&kt.low))>>>16,dr+=(mr+=Qt+nr)>>>16,cr+=(dr+=Ht+ar)>>>16,cr+=Vt+Zt,st((mr&=65535)<<16|(Dr&=65535),(cr&=65535)<<16|(dr&=65535),this.unsigned)},Ft.subtract=function(kt){return c(kt)||(kt=ot(kt)),this.add(kt.neg())},Ft.sub=Ft.subtract,Ft.multiply=function(kt){if(this.isZero())return yt;if(c(kt)||(kt=ot(kt)),a)return st(a.mul(this.low,this.high,kt.low,kt.high),a.get_high(),this.unsigned);if(kt.isZero())return yt;if(this.eq($t))return kt.isOdd()?$t:yt;if(kt.eq($t))return this.isOdd()?$t:yt;if(this.isNegative())return kt.isNegative()?this.neg().mul(kt.neg()):this.neg().mul(kt).neg();if(kt.isNegative())return this.mul(kt.neg()).neg();if(this.lt(mt)&&kt.lt(mt))return it(this.toNumber()*kt.toNumber(),this.unsigned);var Vt=this.high>>>16,Ht=65535&this.high,Qt=this.low>>>16,Xt=65535&this.low,Zt=kt.high>>>16,ar=65535&kt.high,nr=kt.low>>>16,cr=65535&kt.low,dr=0,mr=0,Dr=0,kr=0;return Dr+=(kr+=Xt*cr)>>>16,mr+=(Dr+=Qt*cr)>>>16,Dr&=65535,mr+=(Dr+=Xt*nr)>>>16,dr+=(mr+=Ht*cr)>>>16,mr&=65535,dr+=(mr+=Qt*nr)>>>16,mr&=65535,dr+=(mr+=Xt*ar)>>>16,dr+=Vt*cr+Ht*nr+Qt*ar+Xt*Zt,st((Dr&=65535)<<16|(kr&=65535),(dr&=65535)<<16|(mr&=65535),this.unsigned)},Ft.mul=Ft.multiply,Ft.divide=function(kt){if(c(kt)||(kt=ot(kt)),kt.isZero())throw Error("division by zero");var Vt,Ht,Qt;if(a)return this.unsigned||this.high!==-2147483648||kt.low!==-1||kt.high!==-1?st((this.unsigned?a.div_u:a.div_s)(this.low,this.high,kt.low,kt.high),a.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?bt:yt;if(this.unsigned){if(kt.unsigned||(kt=kt.toUnsigned()),kt.gt(this))return bt;if(kt.gt(this.shru(1)))return Tt;Qt=bt}else{if(this.eq($t))return kt.eq(wt)||kt.eq(Ct)?$t:kt.eq($t)?wt:(Vt=this.shr(1).div(kt).shl(1)).eq(yt)?kt.isNegative()?wt:Ct:(Ht=this.sub(kt.mul(Vt)),Qt=Vt.add(Ht.div(kt)));if(kt.eq($t))return this.unsigned?bt:yt;if(this.isNegative())return kt.isNegative()?this.neg().div(kt.neg()):this.neg().div(kt).neg();if(kt.isNegative())return this.div(kt.neg()).neg();Qt=yt}for(Ht=this;Ht.gte(kt);){Vt=Math.max(1,Math.floor(Ht.toNumber()/kt.toNumber()));for(var Xt=Math.ceil(Math.log(Vt)/Math.LN2),Zt=Xt<=48?1:ut(2,Xt-48),ar=it(Vt),nr=ar.mul(kt);nr.isNegative()||nr.gt(Ht);)nr=(ar=it(Vt-=Zt,this.unsigned)).mul(kt);ar.isZero()&&(ar=wt),Qt=Qt.add(ar),Ht=Ht.sub(nr)}return Qt},Ft.div=Ft.divide,Ft.modulo=function(kt){return c(kt)||(kt=ot(kt)),a?st((this.unsigned?a.rem_u:a.rem_s)(this.low,this.high,kt.low,kt.high),a.get_high(),this.unsigned):this.sub(this.div(kt).mul(kt))},Ft.mod=Ft.modulo,Ft.rem=Ft.modulo,Ft.not=function(){return st(~this.low,~this.high,this.unsigned)},Ft.and=function(kt){return c(kt)||(kt=ot(kt)),st(this.low&kt.low,this.high&kt.high,this.unsigned)},Ft.or=function(kt){return c(kt)||(kt=ot(kt)),st(this.low|kt.low,this.high|kt.high,this.unsigned)},Ft.xor=function(kt){return c(kt)||(kt=ot(kt)),st(this.low^kt.low,this.high^kt.high,this.unsigned)},Ft.shiftLeft=function(kt){return c(kt)&&(kt=kt.toInt()),(kt&=63)==0?this:kt<32?st(this.low<<kt,this.high<<kt|this.low>>>32-kt,this.unsigned):st(0,this.low<<kt-32,this.unsigned)},Ft.shl=Ft.shiftLeft,Ft.shiftRight=function(kt){return c(kt)&&(kt=kt.toInt()),(kt&=63)==0?this:kt<32?st(this.low>>>kt|this.high<<32-kt,this.high>>kt,this.unsigned):st(this.high>>kt-32,this.high>=0?0:-1,this.unsigned)},Ft.shr=Ft.shiftRight,Ft.shiftRightUnsigned=function(kt){if(c(kt)&&(kt=kt.toInt()),(kt&=63)==0)return this;var Vt=this.high;return kt<32?st(this.low>>>kt|Vt<<32-kt,Vt>>>kt,this.unsigned):st(kt===32?Vt:Vt>>>kt-32,0,this.unsigned)},Ft.shru=Ft.shiftRightUnsigned,Ft.shr_u=Ft.shiftRightUnsigned,Ft.toSigned=function(){return this.unsigned?st(this.low,this.high,!1):this},Ft.toUnsigned=function(){return this.unsigned?this:st(this.low,this.high,!0)},Ft.toBytes=function(kt){return kt?this.toBytesLE():this.toBytesBE()},Ft.toBytesLE=function(){var kt=this.high,Vt=this.low;return[255&Vt,Vt>>>8&255,Vt>>>16&255,Vt>>>24,255&kt,kt>>>8&255,kt>>>16&255,kt>>>24]},Ft.toBytesBE=function(){var kt=this.high,Vt=this.low;return[kt>>>24,kt>>>16&255,kt>>>8&255,255&kt,Vt>>>24,Vt>>>16&255,Vt>>>8&255,255&Vt]},o.fromBytes=function(kt,Vt,Ht){return Ht?o.fromBytesLE(kt,Vt):o.fromBytesBE(kt,Vt)},o.fromBytesLE=function(kt,Vt){return new o(kt[0]|kt[1]<<8|kt[2]<<16|kt[3]<<24,kt[4]|kt[5]<<8|kt[6]<<16|kt[7]<<24,Vt)},o.fromBytesBE=function(kt,Vt){return new o(kt[4]<<24|kt[5]<<16|kt[6]<<8|kt[7],kt[0]<<24|kt[1]<<16|kt[2]<<8|kt[3],Vt)}},1446:(s,a,o)=>{var c,d,tt,nt=o(2100),it=nt.Reader,st=nt.Writer,ut=nt.util,ct=nt.roots.default||(nt.roots.default={});ct.onnx=((tt={}).Version=(c={},(d=Object.create(c))[c[0]="_START_VERSION"]=0,d[c[1]="IR_VERSION_2017_10_10"]=1,d[c[2]="IR_VERSION_2017_10_30"]=2,d[c[3]="IR_VERSION_2017_11_3"]=3,d[c[4]="IR_VERSION_2019_1_22"]=4,d[c[5]="IR_VERSION"]=5,d),tt.AttributeProto=function(){function ot(at){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.name="",ot.prototype.refAttrName="",ot.prototype.docString="",ot.prototype.type=0,ot.prototype.f=0,ot.prototype.i=ut.Long?ut.Long.fromBits(0,0,!1):0,ot.prototype.s=ut.newBuffer([]),ot.prototype.t=null,ot.prototype.g=null,ot.prototype.floats=ut.emptyArray,ot.prototype.ints=ut.emptyArray,ot.prototype.strings=ut.emptyArray,ot.prototype.tensors=ut.emptyArray,ot.prototype.graphs=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.name!=null&&at.hasOwnProperty("name")&&ht.uint32(10).string(at.name),at.f!=null&&at.hasOwnProperty("f")&&ht.uint32(21).float(at.f),at.i!=null&&at.hasOwnProperty("i")&&ht.uint32(24).int64(at.i),at.s!=null&&at.hasOwnProperty("s")&&ht.uint32(34).bytes(at.s),at.t!=null&&at.hasOwnProperty("t")&&ct.onnx.TensorProto.encode(at.t,ht.uint32(42).fork()).ldelim(),at.g!=null&&at.hasOwnProperty("g")&&ct.onnx.GraphProto.encode(at.g,ht.uint32(50).fork()).ldelim(),at.floats!=null&&at.floats.length){ht.uint32(58).fork();for(var ft=0;ft<at.floats.length;++ft)ht.float(at.floats[ft]);ht.ldelim()}if(at.ints!=null&&at.ints.length){for(ht.uint32(66).fork(),ft=0;ft<at.ints.length;++ft)ht.int64(at.ints[ft]);ht.ldelim()}if(at.strings!=null&&at.strings.length)for(ft=0;ft<at.strings.length;++ft)ht.uint32(74).bytes(at.strings[ft]);if(at.tensors!=null&&at.tensors.length)for(ft=0;ft<at.tensors.length;++ft)ct.onnx.TensorProto.encode(at.tensors[ft],ht.uint32(82).fork()).ldelim();if(at.graphs!=null&&at.graphs.length)for(ft=0;ft<at.graphs.length;++ft)ct.onnx.GraphProto.encode(at.graphs[ft],ht.uint32(90).fork()).ldelim();return at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(106).string(at.docString),at.type!=null&&at.hasOwnProperty("type")&&ht.uint32(160).int32(at.type),at.refAttrName!=null&&at.hasOwnProperty("refAttrName")&&ht.uint32(170).string(at.refAttrName),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.AttributeProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.name=at.string();break;case 21:mt.refAttrName=at.string();break;case 13:mt.docString=at.string();break;case 20:mt.type=at.int32();break;case 2:mt.f=at.float();break;case 3:mt.i=at.int64();break;case 4:mt.s=at.bytes();break;case 5:mt.t=ct.onnx.TensorProto.decode(at,at.uint32());break;case 6:mt.g=ct.onnx.GraphProto.decode(at,at.uint32());break;case 7:if(mt.floats&&mt.floats.length||(mt.floats=[]),(7&yt)==2)for(var bt=at.uint32()+at.pos;at.pos<bt;)mt.floats.push(at.float());else mt.floats.push(at.float());break;case 8:if(mt.ints&&mt.ints.length||(mt.ints=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.ints.push(at.int64());else mt.ints.push(at.int64());break;case 9:mt.strings&&mt.strings.length||(mt.strings=[]),mt.strings.push(at.bytes());break;case 10:mt.tensors&&mt.tensors.length||(mt.tensors=[]),mt.tensors.push(ct.onnx.TensorProto.decode(at,at.uint32()));break;case 11:mt.graphs&&mt.graphs.length||(mt.graphs=[]),mt.graphs.push(ct.onnx.GraphProto.decode(at,at.uint32()));break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.name!=null&&at.hasOwnProperty("name")&&!ut.isString(at.name))return"name: string expected";if(at.refAttrName!=null&&at.hasOwnProperty("refAttrName")&&!ut.isString(at.refAttrName))return"refAttrName: string expected";if(at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString))return"docString: string expected";if(at.type!=null&&at.hasOwnProperty("type"))switch(at.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(at.f!=null&&at.hasOwnProperty("f")&&typeof at.f!="number")return"f: number expected";if(at.i!=null&&at.hasOwnProperty("i")&&!(ut.isInteger(at.i)||at.i&&ut.isInteger(at.i.low)&&ut.isInteger(at.i.high)))return"i: integer|Long expected";if(at.s!=null&&at.hasOwnProperty("s")&&!(at.s&&typeof at.s.length=="number"||ut.isString(at.s)))return"s: buffer expected";if(at.t!=null&&at.hasOwnProperty("t")&&(ft=ct.onnx.TensorProto.verify(at.t)))return"t."+ft;if(at.g!=null&&at.hasOwnProperty("g")&&(ft=ct.onnx.GraphProto.verify(at.g)))return"g."+ft;if(at.floats!=null&&at.hasOwnProperty("floats")){if(!Array.isArray(at.floats))return"floats: array expected";for(var ht=0;ht<at.floats.length;++ht)if(typeof at.floats[ht]!="number")return"floats: number[] expected"}if(at.ints!=null&&at.hasOwnProperty("ints")){if(!Array.isArray(at.ints))return"ints: array expected";for(ht=0;ht<at.ints.length;++ht)if(!(ut.isInteger(at.ints[ht])||at.ints[ht]&&ut.isInteger(at.ints[ht].low)&&ut.isInteger(at.ints[ht].high)))return"ints: integer|Long[] expected"}if(at.strings!=null&&at.hasOwnProperty("strings")){if(!Array.isArray(at.strings))return"strings: array expected";for(ht=0;ht<at.strings.length;++ht)if(!(at.strings[ht]&&typeof at.strings[ht].length=="number"||ut.isString(at.strings[ht])))return"strings: buffer[] expected"}if(at.tensors!=null&&at.hasOwnProperty("tensors")){if(!Array.isArray(at.tensors))return"tensors: array expected";for(ht=0;ht<at.tensors.length;++ht)if(ft=ct.onnx.TensorProto.verify(at.tensors[ht]))return"tensors."+ft}if(at.graphs!=null&&at.hasOwnProperty("graphs")){if(!Array.isArray(at.graphs))return"graphs: array expected";for(ht=0;ht<at.graphs.length;++ht){var ft;if(ft=ct.onnx.GraphProto.verify(at.graphs[ht]))return"graphs."+ft}}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.AttributeProto)return at;var ht=new ct.onnx.AttributeProto;switch(at.name!=null&&(ht.name=String(at.name)),at.refAttrName!=null&&(ht.refAttrName=String(at.refAttrName)),at.docString!=null&&(ht.docString=String(at.docString)),at.type){case"UNDEFINED":case 0:ht.type=0;break;case"FLOAT":case 1:ht.type=1;break;case"INT":case 2:ht.type=2;break;case"STRING":case 3:ht.type=3;break;case"TENSOR":case 4:ht.type=4;break;case"GRAPH":case 5:ht.type=5;break;case"FLOATS":case 6:ht.type=6;break;case"INTS":case 7:ht.type=7;break;case"STRINGS":case 8:ht.type=8;break;case"TENSORS":case 9:ht.type=9;break;case"GRAPHS":case 10:ht.type=10}if(at.f!=null&&(ht.f=Number(at.f)),at.i!=null&&(ut.Long?(ht.i=ut.Long.fromValue(at.i)).unsigned=!1:typeof at.i=="string"?ht.i=parseInt(at.i,10):typeof at.i=="number"?ht.i=at.i:typeof at.i=="object"&&(ht.i=new ut.LongBits(at.i.low>>>0,at.i.high>>>0).toNumber())),at.s!=null&&(typeof at.s=="string"?ut.base64.decode(at.s,ht.s=ut.newBuffer(ut.base64.length(at.s)),0):at.s.length&&(ht.s=at.s)),at.t!=null){if(typeof at.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");ht.t=ct.onnx.TensorProto.fromObject(at.t)}if(at.g!=null){if(typeof at.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");ht.g=ct.onnx.GraphProto.fromObject(at.g)}if(at.floats){if(!Array.isArray(at.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");ht.floats=[];for(var ft=0;ft<at.floats.length;++ft)ht.floats[ft]=Number(at.floats[ft])}if(at.ints){if(!Array.isArray(at.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(ht.ints=[],ft=0;ft<at.ints.length;++ft)ut.Long?(ht.ints[ft]=ut.Long.fromValue(at.ints[ft])).unsigned=!1:typeof at.ints[ft]=="string"?ht.ints[ft]=parseInt(at.ints[ft],10):typeof at.ints[ft]=="number"?ht.ints[ft]=at.ints[ft]:typeof at.ints[ft]=="object"&&(ht.ints[ft]=new ut.LongBits(at.ints[ft].low>>>0,at.ints[ft].high>>>0).toNumber())}if(at.strings){if(!Array.isArray(at.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(ht.strings=[],ft=0;ft<at.strings.length;++ft)typeof at.strings[ft]=="string"?ut.base64.decode(at.strings[ft],ht.strings[ft]=ut.newBuffer(ut.base64.length(at.strings[ft])),0):at.strings[ft].length&&(ht.strings[ft]=at.strings[ft])}if(at.tensors){if(!Array.isArray(at.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(ht.tensors=[],ft=0;ft<at.tensors.length;++ft){if(typeof at.tensors[ft]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");ht.tensors[ft]=ct.onnx.TensorProto.fromObject(at.tensors[ft])}}if(at.graphs){if(!Array.isArray(at.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(ht.graphs=[],ft=0;ft<at.graphs.length;++ft){if(typeof at.graphs[ft]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");ht.graphs[ft]=ct.onnx.GraphProto.fromObject(at.graphs[ft])}}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.floats=[],ft.ints=[],ft.strings=[],ft.tensors=[],ft.graphs=[]),ht.defaults){if(ft.name="",ft.f=0,ut.Long){var mt=new ut.Long(0,0,!1);ft.i=ht.longs===String?mt.toString():ht.longs===Number?mt.toNumber():mt}else ft.i=ht.longs===String?"0":0;ht.bytes===String?ft.s="":(ft.s=[],ht.bytes!==Array&&(ft.s=ut.newBuffer(ft.s))),ft.t=null,ft.g=null,ft.docString="",ft.type=ht.enums===String?"UNDEFINED":0,ft.refAttrName=""}if(at.name!=null&&at.hasOwnProperty("name")&&(ft.name=at.name),at.f!=null&&at.hasOwnProperty("f")&&(ft.f=ht.json&&!isFinite(at.f)?String(at.f):at.f),at.i!=null&&at.hasOwnProperty("i")&&(typeof at.i=="number"?ft.i=ht.longs===String?String(at.i):at.i:ft.i=ht.longs===String?ut.Long.prototype.toString.call(at.i):ht.longs===Number?new ut.LongBits(at.i.low>>>0,at.i.high>>>0).toNumber():at.i),at.s!=null&&at.hasOwnProperty("s")&&(ft.s=ht.bytes===String?ut.base64.encode(at.s,0,at.s.length):ht.bytes===Array?Array.prototype.slice.call(at.s):at.s),at.t!=null&&at.hasOwnProperty("t")&&(ft.t=ct.onnx.TensorProto.toObject(at.t,ht)),at.g!=null&&at.hasOwnProperty("g")&&(ft.g=ct.onnx.GraphProto.toObject(at.g,ht)),at.floats&&at.floats.length){ft.floats=[];for(var yt=0;yt<at.floats.length;++yt)ft.floats[yt]=ht.json&&!isFinite(at.floats[yt])?String(at.floats[yt]):at.floats[yt]}if(at.ints&&at.ints.length)for(ft.ints=[],yt=0;yt<at.ints.length;++yt)typeof at.ints[yt]=="number"?ft.ints[yt]=ht.longs===String?String(at.ints[yt]):at.ints[yt]:ft.ints[yt]=ht.longs===String?ut.Long.prototype.toString.call(at.ints[yt]):ht.longs===Number?new ut.LongBits(at.ints[yt].low>>>0,at.ints[yt].high>>>0).toNumber():at.ints[yt];if(at.strings&&at.strings.length)for(ft.strings=[],yt=0;yt<at.strings.length;++yt)ft.strings[yt]=ht.bytes===String?ut.base64.encode(at.strings[yt],0,at.strings[yt].length):ht.bytes===Array?Array.prototype.slice.call(at.strings[yt]):at.strings[yt];if(at.tensors&&at.tensors.length)for(ft.tensors=[],yt=0;yt<at.tensors.length;++yt)ft.tensors[yt]=ct.onnx.TensorProto.toObject(at.tensors[yt],ht);if(at.graphs&&at.graphs.length)for(ft.graphs=[],yt=0;yt<at.graphs.length;++yt)ft.graphs[yt]=ct.onnx.GraphProto.toObject(at.graphs[yt],ht);return at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),at.type!=null&&at.hasOwnProperty("type")&&(ft.type=ht.enums===String?ct.onnx.AttributeProto.AttributeType[at.type]:at.type),at.refAttrName!=null&&at.hasOwnProperty("refAttrName")&&(ft.refAttrName=at.refAttrName),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot.AttributeType=function(){var at={},ht=Object.create(at);return ht[at[0]="UNDEFINED"]=0,ht[at[1]="FLOAT"]=1,ht[at[2]="INT"]=2,ht[at[3]="STRING"]=3,ht[at[4]="TENSOR"]=4,ht[at[5]="GRAPH"]=5,ht[at[6]="FLOATS"]=6,ht[at[7]="INTS"]=7,ht[at[8]="STRINGS"]=8,ht[at[9]="TENSORS"]=9,ht[at[10]="GRAPHS"]=10,ht}(),ot}(),tt.ValueInfoProto=function(){function ot(at){if(at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.name="",ot.prototype.type=null,ot.prototype.docString="",ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){return ht||(ht=st.create()),at.name!=null&&at.hasOwnProperty("name")&&ht.uint32(10).string(at.name),at.type!=null&&at.hasOwnProperty("type")&&ct.onnx.TypeProto.encode(at.type,ht.uint32(18).fork()).ldelim(),at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(26).string(at.docString),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.ValueInfoProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.name=at.string();break;case 2:mt.type=ct.onnx.TypeProto.decode(at,at.uint32());break;case 3:mt.docString=at.string();break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.name!=null&&at.hasOwnProperty("name")&&!ut.isString(at.name))return"name: string expected";if(at.type!=null&&at.hasOwnProperty("type")){var ht=ct.onnx.TypeProto.verify(at.type);if(ht)return"type."+ht}return at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString)?"docString: string expected":null},ot.fromObject=function(at){if(at instanceof ct.onnx.ValueInfoProto)return at;var ht=new ct.onnx.ValueInfoProto;if(at.name!=null&&(ht.name=String(at.name)),at.type!=null){if(typeof at.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");ht.type=ct.onnx.TypeProto.fromObject(at.type)}return at.docString!=null&&(ht.docString=String(at.docString)),ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};return ht.defaults&&(ft.name="",ft.type=null,ft.docString=""),at.name!=null&&at.hasOwnProperty("name")&&(ft.name=at.name),at.type!=null&&at.hasOwnProperty("type")&&(ft.type=ct.onnx.TypeProto.toObject(at.type,ht)),at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.NodeProto=function(){function ot(at){if(this.input=[],this.output=[],this.attribute=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.input=ut.emptyArray,ot.prototype.output=ut.emptyArray,ot.prototype.name="",ot.prototype.opType="",ot.prototype.domain="",ot.prototype.attribute=ut.emptyArray,ot.prototype.docString="",ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.input!=null&&at.input.length)for(var ft=0;ft<at.input.length;++ft)ht.uint32(10).string(at.input[ft]);if(at.output!=null&&at.output.length)for(ft=0;ft<at.output.length;++ft)ht.uint32(18).string(at.output[ft]);if(at.name!=null&&at.hasOwnProperty("name")&&ht.uint32(26).string(at.name),at.opType!=null&&at.hasOwnProperty("opType")&&ht.uint32(34).string(at.opType),at.attribute!=null&&at.attribute.length)for(ft=0;ft<at.attribute.length;++ft)ct.onnx.AttributeProto.encode(at.attribute[ft],ht.uint32(42).fork()).ldelim();return at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(50).string(at.docString),at.domain!=null&&at.hasOwnProperty("domain")&&ht.uint32(58).string(at.domain),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.NodeProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.input&&mt.input.length||(mt.input=[]),mt.input.push(at.string());break;case 2:mt.output&&mt.output.length||(mt.output=[]),mt.output.push(at.string());break;case 3:mt.name=at.string();break;case 4:mt.opType=at.string();break;case 7:mt.domain=at.string();break;case 5:mt.attribute&&mt.attribute.length||(mt.attribute=[]),mt.attribute.push(ct.onnx.AttributeProto.decode(at,at.uint32()));break;case 6:mt.docString=at.string();break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.input!=null&&at.hasOwnProperty("input")){if(!Array.isArray(at.input))return"input: array expected";for(var ht=0;ht<at.input.length;++ht)if(!ut.isString(at.input[ht]))return"input: string[] expected"}if(at.output!=null&&at.hasOwnProperty("output")){if(!Array.isArray(at.output))return"output: array expected";for(ht=0;ht<at.output.length;++ht)if(!ut.isString(at.output[ht]))return"output: string[] expected"}if(at.name!=null&&at.hasOwnProperty("name")&&!ut.isString(at.name))return"name: string expected";if(at.opType!=null&&at.hasOwnProperty("opType")&&!ut.isString(at.opType))return"opType: string expected";if(at.domain!=null&&at.hasOwnProperty("domain")&&!ut.isString(at.domain))return"domain: string expected";if(at.attribute!=null&&at.hasOwnProperty("attribute")){if(!Array.isArray(at.attribute))return"attribute: array expected";for(ht=0;ht<at.attribute.length;++ht){var ft=ct.onnx.AttributeProto.verify(at.attribute[ht]);if(ft)return"attribute."+ft}}return at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString)?"docString: string expected":null},ot.fromObject=function(at){if(at instanceof ct.onnx.NodeProto)return at;var ht=new ct.onnx.NodeProto;if(at.input){if(!Array.isArray(at.input))throw TypeError(".onnx.NodeProto.input: array expected");ht.input=[];for(var ft=0;ft<at.input.length;++ft)ht.input[ft]=String(at.input[ft])}if(at.output){if(!Array.isArray(at.output))throw TypeError(".onnx.NodeProto.output: array expected");for(ht.output=[],ft=0;ft<at.output.length;++ft)ht.output[ft]=String(at.output[ft])}if(at.name!=null&&(ht.name=String(at.name)),at.opType!=null&&(ht.opType=String(at.opType)),at.domain!=null&&(ht.domain=String(at.domain)),at.attribute){if(!Array.isArray(at.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(ht.attribute=[],ft=0;ft<at.attribute.length;++ft){if(typeof at.attribute[ft]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");ht.attribute[ft]=ct.onnx.AttributeProto.fromObject(at.attribute[ft])}}return at.docString!=null&&(ht.docString=String(at.docString)),ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.input=[],ft.output=[],ft.attribute=[]),ht.defaults&&(ft.name="",ft.opType="",ft.docString="",ft.domain=""),at.input&&at.input.length){ft.input=[];for(var mt=0;mt<at.input.length;++mt)ft.input[mt]=at.input[mt]}if(at.output&&at.output.length)for(ft.output=[],mt=0;mt<at.output.length;++mt)ft.output[mt]=at.output[mt];if(at.name!=null&&at.hasOwnProperty("name")&&(ft.name=at.name),at.opType!=null&&at.hasOwnProperty("opType")&&(ft.opType=at.opType),at.attribute&&at.attribute.length)for(ft.attribute=[],mt=0;mt<at.attribute.length;++mt)ft.attribute[mt]=ct.onnx.AttributeProto.toObject(at.attribute[mt],ht);return at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),at.domain!=null&&at.hasOwnProperty("domain")&&(ft.domain=at.domain),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.ModelProto=function(){function ot(at){if(this.opsetImport=[],this.metadataProps=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.irVersion=ut.Long?ut.Long.fromBits(0,0,!1):0,ot.prototype.opsetImport=ut.emptyArray,ot.prototype.producerName="",ot.prototype.producerVersion="",ot.prototype.domain="",ot.prototype.modelVersion=ut.Long?ut.Long.fromBits(0,0,!1):0,ot.prototype.docString="",ot.prototype.graph=null,ot.prototype.metadataProps=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.irVersion!=null&&at.hasOwnProperty("irVersion")&&ht.uint32(8).int64(at.irVersion),at.producerName!=null&&at.hasOwnProperty("producerName")&&ht.uint32(18).string(at.producerName),at.producerVersion!=null&&at.hasOwnProperty("producerVersion")&&ht.uint32(26).string(at.producerVersion),at.domain!=null&&at.hasOwnProperty("domain")&&ht.uint32(34).string(at.domain),at.modelVersion!=null&&at.hasOwnProperty("modelVersion")&&ht.uint32(40).int64(at.modelVersion),at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(50).string(at.docString),at.graph!=null&&at.hasOwnProperty("graph")&&ct.onnx.GraphProto.encode(at.graph,ht.uint32(58).fork()).ldelim(),at.opsetImport!=null&&at.opsetImport.length)for(var ft=0;ft<at.opsetImport.length;++ft)ct.onnx.OperatorSetIdProto.encode(at.opsetImport[ft],ht.uint32(66).fork()).ldelim();if(at.metadataProps!=null&&at.metadataProps.length)for(ft=0;ft<at.metadataProps.length;++ft)ct.onnx.StringStringEntryProto.encode(at.metadataProps[ft],ht.uint32(114).fork()).ldelim();return ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.ModelProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.irVersion=at.int64();break;case 8:mt.opsetImport&&mt.opsetImport.length||(mt.opsetImport=[]),mt.opsetImport.push(ct.onnx.OperatorSetIdProto.decode(at,at.uint32()));break;case 2:mt.producerName=at.string();break;case 3:mt.producerVersion=at.string();break;case 4:mt.domain=at.string();break;case 5:mt.modelVersion=at.int64();break;case 6:mt.docString=at.string();break;case 7:mt.graph=ct.onnx.GraphProto.decode(at,at.uint32());break;case 14:mt.metadataProps&&mt.metadataProps.length||(mt.metadataProps=[]),mt.metadataProps.push(ct.onnx.StringStringEntryProto.decode(at,at.uint32()));break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.irVersion!=null&&at.hasOwnProperty("irVersion")&&!(ut.isInteger(at.irVersion)||at.irVersion&&ut.isInteger(at.irVersion.low)&&ut.isInteger(at.irVersion.high)))return"irVersion: integer|Long expected";if(at.opsetImport!=null&&at.hasOwnProperty("opsetImport")){if(!Array.isArray(at.opsetImport))return"opsetImport: array expected";for(var ht=0;ht<at.opsetImport.length;++ht)if(ft=ct.onnx.OperatorSetIdProto.verify(at.opsetImport[ht]))return"opsetImport."+ft}if(at.producerName!=null&&at.hasOwnProperty("producerName")&&!ut.isString(at.producerName))return"producerName: string expected";if(at.producerVersion!=null&&at.hasOwnProperty("producerVersion")&&!ut.isString(at.producerVersion))return"producerVersion: string expected";if(at.domain!=null&&at.hasOwnProperty("domain")&&!ut.isString(at.domain))return"domain: string expected";if(at.modelVersion!=null&&at.hasOwnProperty("modelVersion")&&!(ut.isInteger(at.modelVersion)||at.modelVersion&&ut.isInteger(at.modelVersion.low)&&ut.isInteger(at.modelVersion.high)))return"modelVersion: integer|Long expected";if(at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString))return"docString: string expected";if(at.graph!=null&&at.hasOwnProperty("graph")&&(ft=ct.onnx.GraphProto.verify(at.graph)))return"graph."+ft;if(at.metadataProps!=null&&at.hasOwnProperty("metadataProps")){if(!Array.isArray(at.metadataProps))return"metadataProps: array expected";for(ht=0;ht<at.metadataProps.length;++ht){var ft;if(ft=ct.onnx.StringStringEntryProto.verify(at.metadataProps[ht]))return"metadataProps."+ft}}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.ModelProto)return at;var ht=new ct.onnx.ModelProto;if(at.irVersion!=null&&(ut.Long?(ht.irVersion=ut.Long.fromValue(at.irVersion)).unsigned=!1:typeof at.irVersion=="string"?ht.irVersion=parseInt(at.irVersion,10):typeof at.irVersion=="number"?ht.irVersion=at.irVersion:typeof at.irVersion=="object"&&(ht.irVersion=new ut.LongBits(at.irVersion.low>>>0,at.irVersion.high>>>0).toNumber())),at.opsetImport){if(!Array.isArray(at.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");ht.opsetImport=[];for(var ft=0;ft<at.opsetImport.length;++ft){if(typeof at.opsetImport[ft]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");ht.opsetImport[ft]=ct.onnx.OperatorSetIdProto.fromObject(at.opsetImport[ft])}}if(at.producerName!=null&&(ht.producerName=String(at.producerName)),at.producerVersion!=null&&(ht.producerVersion=String(at.producerVersion)),at.domain!=null&&(ht.domain=String(at.domain)),at.modelVersion!=null&&(ut.Long?(ht.modelVersion=ut.Long.fromValue(at.modelVersion)).unsigned=!1:typeof at.modelVersion=="string"?ht.modelVersion=parseInt(at.modelVersion,10):typeof at.modelVersion=="number"?ht.modelVersion=at.modelVersion:typeof at.modelVersion=="object"&&(ht.modelVersion=new ut.LongBits(at.modelVersion.low>>>0,at.modelVersion.high>>>0).toNumber())),at.docString!=null&&(ht.docString=String(at.docString)),at.graph!=null){if(typeof at.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");ht.graph=ct.onnx.GraphProto.fromObject(at.graph)}if(at.metadataProps){if(!Array.isArray(at.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(ht.metadataProps=[],ft=0;ft<at.metadataProps.length;++ft){if(typeof at.metadataProps[ft]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");ht.metadataProps[ft]=ct.onnx.StringStringEntryProto.fromObject(at.metadataProps[ft])}}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.opsetImport=[],ft.metadataProps=[]),ht.defaults){if(ut.Long){var mt=new ut.Long(0,0,!1);ft.irVersion=ht.longs===String?mt.toString():ht.longs===Number?mt.toNumber():mt}else ft.irVersion=ht.longs===String?"0":0;ft.producerName="",ft.producerVersion="",ft.domain="",ut.Long?(mt=new ut.Long(0,0,!1),ft.modelVersion=ht.longs===String?mt.toString():ht.longs===Number?mt.toNumber():mt):ft.modelVersion=ht.longs===String?"0":0,ft.docString="",ft.graph=null}if(at.irVersion!=null&&at.hasOwnProperty("irVersion")&&(typeof at.irVersion=="number"?ft.irVersion=ht.longs===String?String(at.irVersion):at.irVersion:ft.irVersion=ht.longs===String?ut.Long.prototype.toString.call(at.irVersion):ht.longs===Number?new ut.LongBits(at.irVersion.low>>>0,at.irVersion.high>>>0).toNumber():at.irVersion),at.producerName!=null&&at.hasOwnProperty("producerName")&&(ft.producerName=at.producerName),at.producerVersion!=null&&at.hasOwnProperty("producerVersion")&&(ft.producerVersion=at.producerVersion),at.domain!=null&&at.hasOwnProperty("domain")&&(ft.domain=at.domain),at.modelVersion!=null&&at.hasOwnProperty("modelVersion")&&(typeof at.modelVersion=="number"?ft.modelVersion=ht.longs===String?String(at.modelVersion):at.modelVersion:ft.modelVersion=ht.longs===String?ut.Long.prototype.toString.call(at.modelVersion):ht.longs===Number?new ut.LongBits(at.modelVersion.low>>>0,at.modelVersion.high>>>0).toNumber():at.modelVersion),at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),at.graph!=null&&at.hasOwnProperty("graph")&&(ft.graph=ct.onnx.GraphProto.toObject(at.graph,ht)),at.opsetImport&&at.opsetImport.length){ft.opsetImport=[];for(var yt=0;yt<at.opsetImport.length;++yt)ft.opsetImport[yt]=ct.onnx.OperatorSetIdProto.toObject(at.opsetImport[yt],ht)}if(at.metadataProps&&at.metadataProps.length)for(ft.metadataProps=[],yt=0;yt<at.metadataProps.length;++yt)ft.metadataProps[yt]=ct.onnx.StringStringEntryProto.toObject(at.metadataProps[yt],ht);return ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.StringStringEntryProto=function(){function ot(at){if(at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.key="",ot.prototype.value="",ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){return ht||(ht=st.create()),at.key!=null&&at.hasOwnProperty("key")&&ht.uint32(10).string(at.key),at.value!=null&&at.hasOwnProperty("value")&&ht.uint32(18).string(at.value),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.StringStringEntryProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.key=at.string();break;case 2:mt.value=at.string();break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){return typeof at!="object"||at===null?"object expected":at.key!=null&&at.hasOwnProperty("key")&&!ut.isString(at.key)?"key: string expected":at.value!=null&&at.hasOwnProperty("value")&&!ut.isString(at.value)?"value: string expected":null},ot.fromObject=function(at){if(at instanceof ct.onnx.StringStringEntryProto)return at;var ht=new ct.onnx.StringStringEntryProto;return at.key!=null&&(ht.key=String(at.key)),at.value!=null&&(ht.value=String(at.value)),ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};return ht.defaults&&(ft.key="",ft.value=""),at.key!=null&&at.hasOwnProperty("key")&&(ft.key=at.key),at.value!=null&&at.hasOwnProperty("value")&&(ft.value=at.value),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.TensorAnnotation=function(){function ot(at){if(this.quantParameterTensorNames=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.tensorName="",ot.prototype.quantParameterTensorNames=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.tensorName!=null&&at.hasOwnProperty("tensorName")&&ht.uint32(10).string(at.tensorName),at.quantParameterTensorNames!=null&&at.quantParameterTensorNames.length)for(var ft=0;ft<at.quantParameterTensorNames.length;++ft)ct.onnx.StringStringEntryProto.encode(at.quantParameterTensorNames[ft],ht.uint32(18).fork()).ldelim();return ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.TensorAnnotation;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.tensorName=at.string();break;case 2:mt.quantParameterTensorNames&&mt.quantParameterTensorNames.length||(mt.quantParameterTensorNames=[]),mt.quantParameterTensorNames.push(ct.onnx.StringStringEntryProto.decode(at,at.uint32()));break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.tensorName!=null&&at.hasOwnProperty("tensorName")&&!ut.isString(at.tensorName))return"tensorName: string expected";if(at.quantParameterTensorNames!=null&&at.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(at.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var ht=0;ht<at.quantParameterTensorNames.length;++ht){var ft=ct.onnx.StringStringEntryProto.verify(at.quantParameterTensorNames[ht]);if(ft)return"quantParameterTensorNames."+ft}}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.TensorAnnotation)return at;var ht=new ct.onnx.TensorAnnotation;if(at.tensorName!=null&&(ht.tensorName=String(at.tensorName)),at.quantParameterTensorNames){if(!Array.isArray(at.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");ht.quantParameterTensorNames=[];for(var ft=0;ft<at.quantParameterTensorNames.length;++ft){if(typeof at.quantParameterTensorNames[ft]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");ht.quantParameterTensorNames[ft]=ct.onnx.StringStringEntryProto.fromObject(at.quantParameterTensorNames[ft])}}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.quantParameterTensorNames=[]),ht.defaults&&(ft.tensorName=""),at.tensorName!=null&&at.hasOwnProperty("tensorName")&&(ft.tensorName=at.tensorName),at.quantParameterTensorNames&&at.quantParameterTensorNames.length){ft.quantParameterTensorNames=[];for(var mt=0;mt<at.quantParameterTensorNames.length;++mt)ft.quantParameterTensorNames[mt]=ct.onnx.StringStringEntryProto.toObject(at.quantParameterTensorNames[mt],ht)}return ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.GraphProto=function(){function ot(at){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.node=ut.emptyArray,ot.prototype.name="",ot.prototype.initializer=ut.emptyArray,ot.prototype.docString="",ot.prototype.input=ut.emptyArray,ot.prototype.output=ut.emptyArray,ot.prototype.valueInfo=ut.emptyArray,ot.prototype.quantizationAnnotation=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.node!=null&&at.node.length)for(var ft=0;ft<at.node.length;++ft)ct.onnx.NodeProto.encode(at.node[ft],ht.uint32(10).fork()).ldelim();if(at.name!=null&&at.hasOwnProperty("name")&&ht.uint32(18).string(at.name),at.initializer!=null&&at.initializer.length)for(ft=0;ft<at.initializer.length;++ft)ct.onnx.TensorProto.encode(at.initializer[ft],ht.uint32(42).fork()).ldelim();if(at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(82).string(at.docString),at.input!=null&&at.input.length)for(ft=0;ft<at.input.length;++ft)ct.onnx.ValueInfoProto.encode(at.input[ft],ht.uint32(90).fork()).ldelim();if(at.output!=null&&at.output.length)for(ft=0;ft<at.output.length;++ft)ct.onnx.ValueInfoProto.encode(at.output[ft],ht.uint32(98).fork()).ldelim();if(at.valueInfo!=null&&at.valueInfo.length)for(ft=0;ft<at.valueInfo.length;++ft)ct.onnx.ValueInfoProto.encode(at.valueInfo[ft],ht.uint32(106).fork()).ldelim();if(at.quantizationAnnotation!=null&&at.quantizationAnnotation.length)for(ft=0;ft<at.quantizationAnnotation.length;++ft)ct.onnx.TensorAnnotation.encode(at.quantizationAnnotation[ft],ht.uint32(114).fork()).ldelim();return ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.GraphProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.node&&mt.node.length||(mt.node=[]),mt.node.push(ct.onnx.NodeProto.decode(at,at.uint32()));break;case 2:mt.name=at.string();break;case 5:mt.initializer&&mt.initializer.length||(mt.initializer=[]),mt.initializer.push(ct.onnx.TensorProto.decode(at,at.uint32()));break;case 10:mt.docString=at.string();break;case 11:mt.input&&mt.input.length||(mt.input=[]),mt.input.push(ct.onnx.ValueInfoProto.decode(at,at.uint32()));break;case 12:mt.output&&mt.output.length||(mt.output=[]),mt.output.push(ct.onnx.ValueInfoProto.decode(at,at.uint32()));break;case 13:mt.valueInfo&&mt.valueInfo.length||(mt.valueInfo=[]),mt.valueInfo.push(ct.onnx.ValueInfoProto.decode(at,at.uint32()));break;case 14:mt.quantizationAnnotation&&mt.quantizationAnnotation.length||(mt.quantizationAnnotation=[]),mt.quantizationAnnotation.push(ct.onnx.TensorAnnotation.decode(at,at.uint32()));break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.node!=null&&at.hasOwnProperty("node")){if(!Array.isArray(at.node))return"node: array expected";for(var ht=0;ht<at.node.length;++ht)if(ft=ct.onnx.NodeProto.verify(at.node[ht]))return"node."+ft}if(at.name!=null&&at.hasOwnProperty("name")&&!ut.isString(at.name))return"name: string expected";if(at.initializer!=null&&at.hasOwnProperty("initializer")){if(!Array.isArray(at.initializer))return"initializer: array expected";for(ht=0;ht<at.initializer.length;++ht)if(ft=ct.onnx.TensorProto.verify(at.initializer[ht]))return"initializer."+ft}if(at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString))return"docString: string expected";if(at.input!=null&&at.hasOwnProperty("input")){if(!Array.isArray(at.input))return"input: array expected";for(ht=0;ht<at.input.length;++ht)if(ft=ct.onnx.ValueInfoProto.verify(at.input[ht]))return"input."+ft}if(at.output!=null&&at.hasOwnProperty("output")){if(!Array.isArray(at.output))return"output: array expected";for(ht=0;ht<at.output.length;++ht)if(ft=ct.onnx.ValueInfoProto.verify(at.output[ht]))return"output."+ft}if(at.valueInfo!=null&&at.hasOwnProperty("valueInfo")){if(!Array.isArray(at.valueInfo))return"valueInfo: array expected";for(ht=0;ht<at.valueInfo.length;++ht)if(ft=ct.onnx.ValueInfoProto.verify(at.valueInfo[ht]))return"valueInfo."+ft}if(at.quantizationAnnotation!=null&&at.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(at.quantizationAnnotation))return"quantizationAnnotation: array expected";for(ht=0;ht<at.quantizationAnnotation.length;++ht){var ft;if(ft=ct.onnx.TensorAnnotation.verify(at.quantizationAnnotation[ht]))return"quantizationAnnotation."+ft}}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.GraphProto)return at;var ht=new ct.onnx.GraphProto;if(at.node){if(!Array.isArray(at.node))throw TypeError(".onnx.GraphProto.node: array expected");ht.node=[];for(var ft=0;ft<at.node.length;++ft){if(typeof at.node[ft]!="object")throw TypeError(".onnx.GraphProto.node: object expected");ht.node[ft]=ct.onnx.NodeProto.fromObject(at.node[ft])}}if(at.name!=null&&(ht.name=String(at.name)),at.initializer){if(!Array.isArray(at.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(ht.initializer=[],ft=0;ft<at.initializer.length;++ft){if(typeof at.initializer[ft]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");ht.initializer[ft]=ct.onnx.TensorProto.fromObject(at.initializer[ft])}}if(at.docString!=null&&(ht.docString=String(at.docString)),at.input){if(!Array.isArray(at.input))throw TypeError(".onnx.GraphProto.input: array expected");for(ht.input=[],ft=0;ft<at.input.length;++ft){if(typeof at.input[ft]!="object")throw TypeError(".onnx.GraphProto.input: object expected");ht.input[ft]=ct.onnx.ValueInfoProto.fromObject(at.input[ft])}}if(at.output){if(!Array.isArray(at.output))throw TypeError(".onnx.GraphProto.output: array expected");for(ht.output=[],ft=0;ft<at.output.length;++ft){if(typeof at.output[ft]!="object")throw TypeError(".onnx.GraphProto.output: object expected");ht.output[ft]=ct.onnx.ValueInfoProto.fromObject(at.output[ft])}}if(at.valueInfo){if(!Array.isArray(at.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(ht.valueInfo=[],ft=0;ft<at.valueInfo.length;++ft){if(typeof at.valueInfo[ft]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");ht.valueInfo[ft]=ct.onnx.ValueInfoProto.fromObject(at.valueInfo[ft])}}if(at.quantizationAnnotation){if(!Array.isArray(at.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(ht.quantizationAnnotation=[],ft=0;ft<at.quantizationAnnotation.length;++ft){if(typeof at.quantizationAnnotation[ft]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");ht.quantizationAnnotation[ft]=ct.onnx.TensorAnnotation.fromObject(at.quantizationAnnotation[ft])}}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.node=[],ft.initializer=[],ft.input=[],ft.output=[],ft.valueInfo=[],ft.quantizationAnnotation=[]),ht.defaults&&(ft.name="",ft.docString=""),at.node&&at.node.length){ft.node=[];for(var mt=0;mt<at.node.length;++mt)ft.node[mt]=ct.onnx.NodeProto.toObject(at.node[mt],ht)}if(at.name!=null&&at.hasOwnProperty("name")&&(ft.name=at.name),at.initializer&&at.initializer.length)for(ft.initializer=[],mt=0;mt<at.initializer.length;++mt)ft.initializer[mt]=ct.onnx.TensorProto.toObject(at.initializer[mt],ht);if(at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),at.input&&at.input.length)for(ft.input=[],mt=0;mt<at.input.length;++mt)ft.input[mt]=ct.onnx.ValueInfoProto.toObject(at.input[mt],ht);if(at.output&&at.output.length)for(ft.output=[],mt=0;mt<at.output.length;++mt)ft.output[mt]=ct.onnx.ValueInfoProto.toObject(at.output[mt],ht);if(at.valueInfo&&at.valueInfo.length)for(ft.valueInfo=[],mt=0;mt<at.valueInfo.length;++mt)ft.valueInfo[mt]=ct.onnx.ValueInfoProto.toObject(at.valueInfo[mt],ht);if(at.quantizationAnnotation&&at.quantizationAnnotation.length)for(ft.quantizationAnnotation=[],mt=0;mt<at.quantizationAnnotation.length;++mt)ft.quantizationAnnotation[mt]=ct.onnx.TensorAnnotation.toObject(at.quantizationAnnotation[mt],ht);return ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt.TensorProto=function(){function ot(at){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.dims=ut.emptyArray,ot.prototype.dataType=0,ot.prototype.segment=null,ot.prototype.floatData=ut.emptyArray,ot.prototype.int32Data=ut.emptyArray,ot.prototype.stringData=ut.emptyArray,ot.prototype.int64Data=ut.emptyArray,ot.prototype.name="",ot.prototype.docString="",ot.prototype.rawData=ut.newBuffer([]),ot.prototype.externalData=ut.emptyArray,ot.prototype.dataLocation=0,ot.prototype.doubleData=ut.emptyArray,ot.prototype.uint64Data=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.dims!=null&&at.dims.length){ht.uint32(10).fork();for(var ft=0;ft<at.dims.length;++ft)ht.int64(at.dims[ft]);ht.ldelim()}if(at.dataType!=null&&at.hasOwnProperty("dataType")&&ht.uint32(16).int32(at.dataType),at.segment!=null&&at.hasOwnProperty("segment")&&ct.onnx.TensorProto.Segment.encode(at.segment,ht.uint32(26).fork()).ldelim(),at.floatData!=null&&at.floatData.length){for(ht.uint32(34).fork(),ft=0;ft<at.floatData.length;++ft)ht.float(at.floatData[ft]);ht.ldelim()}if(at.int32Data!=null&&at.int32Data.length){for(ht.uint32(42).fork(),ft=0;ft<at.int32Data.length;++ft)ht.int32(at.int32Data[ft]);ht.ldelim()}if(at.stringData!=null&&at.stringData.length)for(ft=0;ft<at.stringData.length;++ft)ht.uint32(50).bytes(at.stringData[ft]);if(at.int64Data!=null&&at.int64Data.length){for(ht.uint32(58).fork(),ft=0;ft<at.int64Data.length;++ft)ht.int64(at.int64Data[ft]);ht.ldelim()}if(at.name!=null&&at.hasOwnProperty("name")&&ht.uint32(66).string(at.name),at.rawData!=null&&at.hasOwnProperty("rawData")&&ht.uint32(74).bytes(at.rawData),at.doubleData!=null&&at.doubleData.length){for(ht.uint32(82).fork(),ft=0;ft<at.doubleData.length;++ft)ht.double(at.doubleData[ft]);ht.ldelim()}if(at.uint64Data!=null&&at.uint64Data.length){for(ht.uint32(90).fork(),ft=0;ft<at.uint64Data.length;++ft)ht.uint64(at.uint64Data[ft]);ht.ldelim()}if(at.docString!=null&&at.hasOwnProperty("docString")&&ht.uint32(98).string(at.docString),at.externalData!=null&&at.externalData.length)for(ft=0;ft<at.externalData.length;++ft)ct.onnx.StringStringEntryProto.encode(at.externalData[ft],ht.uint32(106).fork()).ldelim();return at.dataLocation!=null&&at.hasOwnProperty("dataLocation")&&ht.uint32(112).int32(at.dataLocation),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.TensorProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:if(mt.dims&&mt.dims.length||(mt.dims=[]),(7&yt)==2)for(var bt=at.uint32()+at.pos;at.pos<bt;)mt.dims.push(at.int64());else mt.dims.push(at.int64());break;case 2:mt.dataType=at.int32();break;case 3:mt.segment=ct.onnx.TensorProto.Segment.decode(at,at.uint32());break;case 4:if(mt.floatData&&mt.floatData.length||(mt.floatData=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.floatData.push(at.float());else mt.floatData.push(at.float());break;case 5:if(mt.int32Data&&mt.int32Data.length||(mt.int32Data=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.int32Data.push(at.int32());else mt.int32Data.push(at.int32());break;case 6:mt.stringData&&mt.stringData.length||(mt.stringData=[]),mt.stringData.push(at.bytes());break;case 7:if(mt.int64Data&&mt.int64Data.length||(mt.int64Data=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.int64Data.push(at.int64());else mt.int64Data.push(at.int64());break;case 8:mt.name=at.string();break;case 12:mt.docString=at.string();break;case 9:mt.rawData=at.bytes();break;case 13:mt.externalData&&mt.externalData.length||(mt.externalData=[]),mt.externalData.push(ct.onnx.StringStringEntryProto.decode(at,at.uint32()));break;case 14:mt.dataLocation=at.int32();break;case 10:if(mt.doubleData&&mt.doubleData.length||(mt.doubleData=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.doubleData.push(at.double());else mt.doubleData.push(at.double());break;case 11:if(mt.uint64Data&&mt.uint64Data.length||(mt.uint64Data=[]),(7&yt)==2)for(bt=at.uint32()+at.pos;at.pos<bt;)mt.uint64Data.push(at.uint64());else mt.uint64Data.push(at.uint64());break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.dims!=null&&at.hasOwnProperty("dims")){if(!Array.isArray(at.dims))return"dims: array expected";for(var ht=0;ht<at.dims.length;++ht)if(!(ut.isInteger(at.dims[ht])||at.dims[ht]&&ut.isInteger(at.dims[ht].low)&&ut.isInteger(at.dims[ht].high)))return"dims: integer|Long[] expected"}if(at.dataType!=null&&at.hasOwnProperty("dataType")&&!ut.isInteger(at.dataType))return"dataType: integer expected";if(at.segment!=null&&at.hasOwnProperty("segment")&&(ft=ct.onnx.TensorProto.Segment.verify(at.segment)))return"segment."+ft;if(at.floatData!=null&&at.hasOwnProperty("floatData")){if(!Array.isArray(at.floatData))return"floatData: array expected";for(ht=0;ht<at.floatData.length;++ht)if(typeof at.floatData[ht]!="number")return"floatData: number[] expected"}if(at.int32Data!=null&&at.hasOwnProperty("int32Data")){if(!Array.isArray(at.int32Data))return"int32Data: array expected";for(ht=0;ht<at.int32Data.length;++ht)if(!ut.isInteger(at.int32Data[ht]))return"int32Data: integer[] expected"}if(at.stringData!=null&&at.hasOwnProperty("stringData")){if(!Array.isArray(at.stringData))return"stringData: array expected";for(ht=0;ht<at.stringData.length;++ht)if(!(at.stringData[ht]&&typeof at.stringData[ht].length=="number"||ut.isString(at.stringData[ht])))return"stringData: buffer[] expected"}if(at.int64Data!=null&&at.hasOwnProperty("int64Data")){if(!Array.isArray(at.int64Data))return"int64Data: array expected";for(ht=0;ht<at.int64Data.length;++ht)if(!(ut.isInteger(at.int64Data[ht])||at.int64Data[ht]&&ut.isInteger(at.int64Data[ht].low)&&ut.isInteger(at.int64Data[ht].high)))return"int64Data: integer|Long[] expected"}if(at.name!=null&&at.hasOwnProperty("name")&&!ut.isString(at.name))return"name: string expected";if(at.docString!=null&&at.hasOwnProperty("docString")&&!ut.isString(at.docString))return"docString: string expected";if(at.rawData!=null&&at.hasOwnProperty("rawData")&&!(at.rawData&&typeof at.rawData.length=="number"||ut.isString(at.rawData)))return"rawData: buffer expected";if(at.externalData!=null&&at.hasOwnProperty("externalData")){if(!Array.isArray(at.externalData))return"externalData: array expected";for(ht=0;ht<at.externalData.length;++ht){var ft;if(ft=ct.onnx.StringStringEntryProto.verify(at.externalData[ht]))return"externalData."+ft}}if(at.dataLocation!=null&&at.hasOwnProperty("dataLocation"))switch(at.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(at.doubleData!=null&&at.hasOwnProperty("doubleData")){if(!Array.isArray(at.doubleData))return"doubleData: array expected";for(ht=0;ht<at.doubleData.length;++ht)if(typeof at.doubleData[ht]!="number")return"doubleData: number[] expected"}if(at.uint64Data!=null&&at.hasOwnProperty("uint64Data")){if(!Array.isArray(at.uint64Data))return"uint64Data: array expected";for(ht=0;ht<at.uint64Data.length;++ht)if(!(ut.isInteger(at.uint64Data[ht])||at.uint64Data[ht]&&ut.isInteger(at.uint64Data[ht].low)&&ut.isInteger(at.uint64Data[ht].high)))return"uint64Data: integer|Long[] expected"}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.TensorProto)return at;var ht=new ct.onnx.TensorProto;if(at.dims){if(!Array.isArray(at.dims))throw TypeError(".onnx.TensorProto.dims: array expected");ht.dims=[];for(var ft=0;ft<at.dims.length;++ft)ut.Long?(ht.dims[ft]=ut.Long.fromValue(at.dims[ft])).unsigned=!1:typeof at.dims[ft]=="string"?ht.dims[ft]=parseInt(at.dims[ft],10):typeof at.dims[ft]=="number"?ht.dims[ft]=at.dims[ft]:typeof at.dims[ft]=="object"&&(ht.dims[ft]=new ut.LongBits(at.dims[ft].low>>>0,at.dims[ft].high>>>0).toNumber())}if(at.dataType!=null&&(ht.dataType=0|at.dataType),at.segment!=null){if(typeof at.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");ht.segment=ct.onnx.TensorProto.Segment.fromObject(at.segment)}if(at.floatData){if(!Array.isArray(at.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(ht.floatData=[],ft=0;ft<at.floatData.length;++ft)ht.floatData[ft]=Number(at.floatData[ft])}if(at.int32Data){if(!Array.isArray(at.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(ht.int32Data=[],ft=0;ft<at.int32Data.length;++ft)ht.int32Data[ft]=0|at.int32Data[ft]}if(at.stringData){if(!Array.isArray(at.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(ht.stringData=[],ft=0;ft<at.stringData.length;++ft)typeof at.stringData[ft]=="string"?ut.base64.decode(at.stringData[ft],ht.stringData[ft]=ut.newBuffer(ut.base64.length(at.stringData[ft])),0):at.stringData[ft].length&&(ht.stringData[ft]=at.stringData[ft])}if(at.int64Data){if(!Array.isArray(at.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(ht.int64Data=[],ft=0;ft<at.int64Data.length;++ft)ut.Long?(ht.int64Data[ft]=ut.Long.fromValue(at.int64Data[ft])).unsigned=!1:typeof at.int64Data[ft]=="string"?ht.int64Data[ft]=parseInt(at.int64Data[ft],10):typeof at.int64Data[ft]=="number"?ht.int64Data[ft]=at.int64Data[ft]:typeof at.int64Data[ft]=="object"&&(ht.int64Data[ft]=new ut.LongBits(at.int64Data[ft].low>>>0,at.int64Data[ft].high>>>0).toNumber())}if(at.name!=null&&(ht.name=String(at.name)),at.docString!=null&&(ht.docString=String(at.docString)),at.rawData!=null&&(typeof at.rawData=="string"?ut.base64.decode(at.rawData,ht.rawData=ut.newBuffer(ut.base64.length(at.rawData)),0):at.rawData.length&&(ht.rawData=at.rawData)),at.externalData){if(!Array.isArray(at.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(ht.externalData=[],ft=0;ft<at.externalData.length;++ft){if(typeof at.externalData[ft]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");ht.externalData[ft]=ct.onnx.StringStringEntryProto.fromObject(at.externalData[ft])}}switch(at.dataLocation){case"DEFAULT":case 0:ht.dataLocation=0;break;case"EXTERNAL":case 1:ht.dataLocation=1}if(at.doubleData){if(!Array.isArray(at.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(ht.doubleData=[],ft=0;ft<at.doubleData.length;++ft)ht.doubleData[ft]=Number(at.doubleData[ft])}if(at.uint64Data){if(!Array.isArray(at.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(ht.uint64Data=[],ft=0;ft<at.uint64Data.length;++ft)ut.Long?(ht.uint64Data[ft]=ut.Long.fromValue(at.uint64Data[ft])).unsigned=!0:typeof at.uint64Data[ft]=="string"?ht.uint64Data[ft]=parseInt(at.uint64Data[ft],10):typeof at.uint64Data[ft]=="number"?ht.uint64Data[ft]=at.uint64Data[ft]:typeof at.uint64Data[ft]=="object"&&(ht.uint64Data[ft]=new ut.LongBits(at.uint64Data[ft].low>>>0,at.uint64Data[ft].high>>>0).toNumber(!0))}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.dims=[],ft.floatData=[],ft.int32Data=[],ft.stringData=[],ft.int64Data=[],ft.doubleData=[],ft.uint64Data=[],ft.externalData=[]),ht.defaults&&(ft.dataType=0,ft.segment=null,ft.name="",ht.bytes===String?ft.rawData="":(ft.rawData=[],ht.bytes!==Array&&(ft.rawData=ut.newBuffer(ft.rawData))),ft.docString="",ft.dataLocation=ht.enums===String?"DEFAULT":0),at.dims&&at.dims.length){ft.dims=[];for(var mt=0;mt<at.dims.length;++mt)typeof at.dims[mt]=="number"?ft.dims[mt]=ht.longs===String?String(at.dims[mt]):at.dims[mt]:ft.dims[mt]=ht.longs===String?ut.Long.prototype.toString.call(at.dims[mt]):ht.longs===Number?new ut.LongBits(at.dims[mt].low>>>0,at.dims[mt].high>>>0).toNumber():at.dims[mt]}if(at.dataType!=null&&at.hasOwnProperty("dataType")&&(ft.dataType=at.dataType),at.segment!=null&&at.hasOwnProperty("segment")&&(ft.segment=ct.onnx.TensorProto.Segment.toObject(at.segment,ht)),at.floatData&&at.floatData.length)for(ft.floatData=[],mt=0;mt<at.floatData.length;++mt)ft.floatData[mt]=ht.json&&!isFinite(at.floatData[mt])?String(at.floatData[mt]):at.floatData[mt];if(at.int32Data&&at.int32Data.length)for(ft.int32Data=[],mt=0;mt<at.int32Data.length;++mt)ft.int32Data[mt]=at.int32Data[mt];if(at.stringData&&at.stringData.length)for(ft.stringData=[],mt=0;mt<at.stringData.length;++mt)ft.stringData[mt]=ht.bytes===String?ut.base64.encode(at.stringData[mt],0,at.stringData[mt].length):ht.bytes===Array?Array.prototype.slice.call(at.stringData[mt]):at.stringData[mt];if(at.int64Data&&at.int64Data.length)for(ft.int64Data=[],mt=0;mt<at.int64Data.length;++mt)typeof at.int64Data[mt]=="number"?ft.int64Data[mt]=ht.longs===String?String(at.int64Data[mt]):at.int64Data[mt]:ft.int64Data[mt]=ht.longs===String?ut.Long.prototype.toString.call(at.int64Data[mt]):ht.longs===Number?new ut.LongBits(at.int64Data[mt].low>>>0,at.int64Data[mt].high>>>0).toNumber():at.int64Data[mt];if(at.name!=null&&at.hasOwnProperty("name")&&(ft.name=at.name),at.rawData!=null&&at.hasOwnProperty("rawData")&&(ft.rawData=ht.bytes===String?ut.base64.encode(at.rawData,0,at.rawData.length):ht.bytes===Array?Array.prototype.slice.call(at.rawData):at.rawData),at.doubleData&&at.doubleData.length)for(ft.doubleData=[],mt=0;mt<at.doubleData.length;++mt)ft.doubleData[mt]=ht.json&&!isFinite(at.doubleData[mt])?String(at.doubleData[mt]):at.doubleData[mt];if(at.uint64Data&&at.uint64Data.length)for(ft.uint64Data=[],mt=0;mt<at.uint64Data.length;++mt)typeof at.uint64Data[mt]=="number"?ft.uint64Data[mt]=ht.longs===String?String(at.uint64Data[mt]):at.uint64Data[mt]:ft.uint64Data[mt]=ht.longs===String?ut.Long.prototype.toString.call(at.uint64Data[mt]):ht.longs===Number?new ut.LongBits(at.uint64Data[mt].low>>>0,at.uint64Data[mt].high>>>0).toNumber(!0):at.uint64Data[mt];if(at.docString!=null&&at.hasOwnProperty("docString")&&(ft.docString=at.docString),at.externalData&&at.externalData.length)for(ft.externalData=[],mt=0;mt<at.externalData.length;++mt)ft.externalData[mt]=ct.onnx.StringStringEntryProto.toObject(at.externalData[mt],ht);return at.dataLocation!=null&&at.hasOwnProperty("dataLocation")&&(ft.dataLocation=ht.enums===String?ct.onnx.TensorProto.DataLocation[at.dataLocation]:at.dataLocation),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot.DataType=function(){var at={},ht=Object.create(at);return ht[at[0]="UNDEFINED"]=0,ht[at[1]="FLOAT"]=1,ht[at[2]="UINT8"]=2,ht[at[3]="INT8"]=3,ht[at[4]="UINT16"]=4,ht[at[5]="INT16"]=5,ht[at[6]="INT32"]=6,ht[at[7]="INT64"]=7,ht[at[8]="STRING"]=8,ht[at[9]="BOOL"]=9,ht[at[10]="FLOAT16"]=10,ht[at[11]="DOUBLE"]=11,ht[at[12]="UINT32"]=12,ht[at[13]="UINT64"]=13,ht[at[14]="COMPLEX64"]=14,ht[at[15]="COMPLEX128"]=15,ht[at[16]="BFLOAT16"]=16,ht}(),ot.Segment=function(){function at(ht){if(ht)for(var ft=Object.keys(ht),mt=0;mt<ft.length;++mt)ht[ft[mt]]!=null&&(this[ft[mt]]=ht[ft[mt]])}return at.prototype.begin=ut.Long?ut.Long.fromBits(0,0,!1):0,at.prototype.end=ut.Long?ut.Long.fromBits(0,0,!1):0,at.create=function(ht){return new at(ht)},at.encode=function(ht,ft){return ft||(ft=st.create()),ht.begin!=null&&ht.hasOwnProperty("begin")&&ft.uint32(8).int64(ht.begin),ht.end!=null&&ht.hasOwnProperty("end")&&ft.uint32(16).int64(ht.end),ft},at.encodeDelimited=function(ht,ft){return this.encode(ht,ft).ldelim()},at.decode=function(ht,ft){ht instanceof it||(ht=it.create(ht));for(var mt=ft===void 0?ht.len:ht.pos+ft,yt=new ct.onnx.TensorProto.Segment;ht.pos<mt;){var bt=ht.uint32();switch(bt>>>3){case 1:yt.begin=ht.int64();break;case 2:yt.end=ht.int64();break;default:ht.skipType(7&bt)}}return yt},at.decodeDelimited=function(ht){return ht instanceof it||(ht=new it(ht)),this.decode(ht,ht.uint32())},at.verify=function(ht){return typeof ht!="object"||ht===null?"object expected":ht.begin!=null&&ht.hasOwnProperty("begin")&&!(ut.isInteger(ht.begin)||ht.begin&&ut.isInteger(ht.begin.low)&&ut.isInteger(ht.begin.high))?"begin: integer|Long expected":ht.end!=null&&ht.hasOwnProperty("end")&&!(ut.isInteger(ht.end)||ht.end&&ut.isInteger(ht.end.low)&&ut.isInteger(ht.end.high))?"end: integer|Long expected":null},at.fromObject=function(ht){if(ht instanceof ct.onnx.TensorProto.Segment)return ht;var ft=new ct.onnx.TensorProto.Segment;return ht.begin!=null&&(ut.Long?(ft.begin=ut.Long.fromValue(ht.begin)).unsigned=!1:typeof ht.begin=="string"?ft.begin=parseInt(ht.begin,10):typeof ht.begin=="number"?ft.begin=ht.begin:typeof ht.begin=="object"&&(ft.begin=new ut.LongBits(ht.begin.low>>>0,ht.begin.high>>>0).toNumber())),ht.end!=null&&(ut.Long?(ft.end=ut.Long.fromValue(ht.end)).unsigned=!1:typeof ht.end=="string"?ft.end=parseInt(ht.end,10):typeof ht.end=="number"?ft.end=ht.end:typeof ht.end=="object"&&(ft.end=new ut.LongBits(ht.end.low>>>0,ht.end.high>>>0).toNumber())),ft},at.toObject=function(ht,ft){ft||(ft={});var mt={};if(ft.defaults){if(ut.Long){var yt=new ut.Long(0,0,!1);mt.begin=ft.longs===String?yt.toString():ft.longs===Number?yt.toNumber():yt}else mt.begin=ft.longs===String?"0":0;ut.Long?(yt=new ut.Long(0,0,!1),mt.end=ft.longs===String?yt.toString():ft.longs===Number?yt.toNumber():yt):mt.end=ft.longs===String?"0":0}return ht.begin!=null&&ht.hasOwnProperty("begin")&&(typeof ht.begin=="number"?mt.begin=ft.longs===String?String(ht.begin):ht.begin:mt.begin=ft.longs===String?ut.Long.prototype.toString.call(ht.begin):ft.longs===Number?new ut.LongBits(ht.begin.low>>>0,ht.begin.high>>>0).toNumber():ht.begin),ht.end!=null&&ht.hasOwnProperty("end")&&(typeof ht.end=="number"?mt.end=ft.longs===String?String(ht.end):ht.end:mt.end=ft.longs===String?ut.Long.prototype.toString.call(ht.end):ft.longs===Number?new ut.LongBits(ht.end.low>>>0,ht.end.high>>>0).toNumber():ht.end),mt},at.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},at}(),ot.DataLocation=function(){var at={},ht=Object.create(at);return ht[at[0]="DEFAULT"]=0,ht[at[1]="EXTERNAL"]=1,ht}(),ot}(),tt.TensorShapeProto=function(){function ot(at){if(this.dim=[],at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.dim=ut.emptyArray,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){if(ht||(ht=st.create()),at.dim!=null&&at.dim.length)for(var ft=0;ft<at.dim.length;++ft)ct.onnx.TensorShapeProto.Dimension.encode(at.dim[ft],ht.uint32(10).fork()).ldelim();return ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.TensorShapeProto;at.pos<ft;){var yt=at.uint32();yt>>>3==1?(mt.dim&&mt.dim.length||(mt.dim=[]),mt.dim.push(ct.onnx.TensorShapeProto.Dimension.decode(at,at.uint32()))):at.skipType(7&yt)}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){if(typeof at!="object"||at===null)return"object expected";if(at.dim!=null&&at.hasOwnProperty("dim")){if(!Array.isArray(at.dim))return"dim: array expected";for(var ht=0;ht<at.dim.length;++ht){var ft=ct.onnx.TensorShapeProto.Dimension.verify(at.dim[ht]);if(ft)return"dim."+ft}}return null},ot.fromObject=function(at){if(at instanceof ct.onnx.TensorShapeProto)return at;var ht=new ct.onnx.TensorShapeProto;if(at.dim){if(!Array.isArray(at.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");ht.dim=[];for(var ft=0;ft<at.dim.length;++ft){if(typeof at.dim[ft]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");ht.dim[ft]=ct.onnx.TensorShapeProto.Dimension.fromObject(at.dim[ft])}}return ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.dim=[]),at.dim&&at.dim.length){ft.dim=[];for(var mt=0;mt<at.dim.length;++mt)ft.dim[mt]=ct.onnx.TensorShapeProto.Dimension.toObject(at.dim[mt],ht)}return ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot.Dimension=function(){function at(ft){if(ft)for(var mt=Object.keys(ft),yt=0;yt<mt.length;++yt)ft[mt[yt]]!=null&&(this[mt[yt]]=ft[mt[yt]])}var ht;return at.prototype.dimValue=ut.Long?ut.Long.fromBits(0,0,!1):0,at.prototype.dimParam="",at.prototype.denotation="",Object.defineProperty(at.prototype,"value",{get:ut.oneOfGetter(ht=["dimValue","dimParam"]),set:ut.oneOfSetter(ht)}),at.create=function(ft){return new at(ft)},at.encode=function(ft,mt){return mt||(mt=st.create()),ft.dimValue!=null&&ft.hasOwnProperty("dimValue")&&mt.uint32(8).int64(ft.dimValue),ft.dimParam!=null&&ft.hasOwnProperty("dimParam")&&mt.uint32(18).string(ft.dimParam),ft.denotation!=null&&ft.hasOwnProperty("denotation")&&mt.uint32(26).string(ft.denotation),mt},at.encodeDelimited=function(ft,mt){return this.encode(ft,mt).ldelim()},at.decode=function(ft,mt){ft instanceof it||(ft=it.create(ft));for(var yt=mt===void 0?ft.len:ft.pos+mt,bt=new ct.onnx.TensorShapeProto.Dimension;ft.pos<yt;){var wt=ft.uint32();switch(wt>>>3){case 1:bt.dimValue=ft.int64();break;case 2:bt.dimParam=ft.string();break;case 3:bt.denotation=ft.string();break;default:ft.skipType(7&wt)}}return bt},at.decodeDelimited=function(ft){return ft instanceof it||(ft=new it(ft)),this.decode(ft,ft.uint32())},at.verify=function(ft){if(typeof ft!="object"||ft===null)return"object expected";var mt={};if(ft.dimValue!=null&&ft.hasOwnProperty("dimValue")&&(mt.value=1,!(ut.isInteger(ft.dimValue)||ft.dimValue&&ut.isInteger(ft.dimValue.low)&&ut.isInteger(ft.dimValue.high))))return"dimValue: integer|Long expected";if(ft.dimParam!=null&&ft.hasOwnProperty("dimParam")){if(mt.value===1)return"value: multiple values";if(mt.value=1,!ut.isString(ft.dimParam))return"dimParam: string expected"}return ft.denotation!=null&&ft.hasOwnProperty("denotation")&&!ut.isString(ft.denotation)?"denotation: string expected":null},at.fromObject=function(ft){if(ft instanceof ct.onnx.TensorShapeProto.Dimension)return ft;var mt=new ct.onnx.TensorShapeProto.Dimension;return ft.dimValue!=null&&(ut.Long?(mt.dimValue=ut.Long.fromValue(ft.dimValue)).unsigned=!1:typeof ft.dimValue=="string"?mt.dimValue=parseInt(ft.dimValue,10):typeof ft.dimValue=="number"?mt.dimValue=ft.dimValue:typeof ft.dimValue=="object"&&(mt.dimValue=new ut.LongBits(ft.dimValue.low>>>0,ft.dimValue.high>>>0).toNumber())),ft.dimParam!=null&&(mt.dimParam=String(ft.dimParam)),ft.denotation!=null&&(mt.denotation=String(ft.denotation)),mt},at.toObject=function(ft,mt){mt||(mt={});var yt={};return mt.defaults&&(yt.denotation=""),ft.dimValue!=null&&ft.hasOwnProperty("dimValue")&&(typeof ft.dimValue=="number"?yt.dimValue=mt.longs===String?String(ft.dimValue):ft.dimValue:yt.dimValue=mt.longs===String?ut.Long.prototype.toString.call(ft.dimValue):mt.longs===Number?new ut.LongBits(ft.dimValue.low>>>0,ft.dimValue.high>>>0).toNumber():ft.dimValue,mt.oneofs&&(yt.value="dimValue")),ft.dimParam!=null&&ft.hasOwnProperty("dimParam")&&(yt.dimParam=ft.dimParam,mt.oneofs&&(yt.value="dimParam")),ft.denotation!=null&&ft.hasOwnProperty("denotation")&&(yt.denotation=ft.denotation),yt},at.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},at}(),ot}(),tt.TypeProto=function(){function ot(ht){if(ht)for(var ft=Object.keys(ht),mt=0;mt<ft.length;++mt)ht[ft[mt]]!=null&&(this[ft[mt]]=ht[ft[mt]])}var at;return ot.prototype.tensorType=null,ot.prototype.denotation="",Object.defineProperty(ot.prototype,"value",{get:ut.oneOfGetter(at=["tensorType"]),set:ut.oneOfSetter(at)}),ot.create=function(ht){return new ot(ht)},ot.encode=function(ht,ft){return ft||(ft=st.create()),ht.tensorType!=null&&ht.hasOwnProperty("tensorType")&&ct.onnx.TypeProto.Tensor.encode(ht.tensorType,ft.uint32(10).fork()).ldelim(),ht.denotation!=null&&ht.hasOwnProperty("denotation")&&ft.uint32(50).string(ht.denotation),ft},ot.encodeDelimited=function(ht,ft){return this.encode(ht,ft).ldelim()},ot.decode=function(ht,ft){ht instanceof it||(ht=it.create(ht));for(var mt=ft===void 0?ht.len:ht.pos+ft,yt=new ct.onnx.TypeProto;ht.pos<mt;){var bt=ht.uint32();switch(bt>>>3){case 1:yt.tensorType=ct.onnx.TypeProto.Tensor.decode(ht,ht.uint32());break;case 6:yt.denotation=ht.string();break;default:ht.skipType(7&bt)}}return yt},ot.decodeDelimited=function(ht){return ht instanceof it||(ht=new it(ht)),this.decode(ht,ht.uint32())},ot.verify=function(ht){if(typeof ht!="object"||ht===null)return"object expected";if(ht.tensorType!=null&&ht.hasOwnProperty("tensorType")){var ft=ct.onnx.TypeProto.Tensor.verify(ht.tensorType);if(ft)return"tensorType."+ft}return ht.denotation!=null&&ht.hasOwnProperty("denotation")&&!ut.isString(ht.denotation)?"denotation: string expected":null},ot.fromObject=function(ht){if(ht instanceof ct.onnx.TypeProto)return ht;var ft=new ct.onnx.TypeProto;if(ht.tensorType!=null){if(typeof ht.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");ft.tensorType=ct.onnx.TypeProto.Tensor.fromObject(ht.tensorType)}return ht.denotation!=null&&(ft.denotation=String(ht.denotation)),ft},ot.toObject=function(ht,ft){ft||(ft={});var mt={};return ft.defaults&&(mt.denotation=""),ht.tensorType!=null&&ht.hasOwnProperty("tensorType")&&(mt.tensorType=ct.onnx.TypeProto.Tensor.toObject(ht.tensorType,ft),ft.oneofs&&(mt.value="tensorType")),ht.denotation!=null&&ht.hasOwnProperty("denotation")&&(mt.denotation=ht.denotation),mt},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot.Tensor=function(){function ht(ft){if(ft)for(var mt=Object.keys(ft),yt=0;yt<mt.length;++yt)ft[mt[yt]]!=null&&(this[mt[yt]]=ft[mt[yt]])}return ht.prototype.elemType=0,ht.prototype.shape=null,ht.create=function(ft){return new ht(ft)},ht.encode=function(ft,mt){return mt||(mt=st.create()),ft.elemType!=null&&ft.hasOwnProperty("elemType")&&mt.uint32(8).int32(ft.elemType),ft.shape!=null&&ft.hasOwnProperty("shape")&&ct.onnx.TensorShapeProto.encode(ft.shape,mt.uint32(18).fork()).ldelim(),mt},ht.encodeDelimited=function(ft,mt){return this.encode(ft,mt).ldelim()},ht.decode=function(ft,mt){ft instanceof it||(ft=it.create(ft));for(var yt=mt===void 0?ft.len:ft.pos+mt,bt=new ct.onnx.TypeProto.Tensor;ft.pos<yt;){var wt=ft.uint32();switch(wt>>>3){case 1:bt.elemType=ft.int32();break;case 2:bt.shape=ct.onnx.TensorShapeProto.decode(ft,ft.uint32());break;default:ft.skipType(7&wt)}}return bt},ht.decodeDelimited=function(ft){return ft instanceof it||(ft=new it(ft)),this.decode(ft,ft.uint32())},ht.verify=function(ft){if(typeof ft!="object"||ft===null)return"object expected";if(ft.elemType!=null&&ft.hasOwnProperty("elemType")&&!ut.isInteger(ft.elemType))return"elemType: integer expected";if(ft.shape!=null&&ft.hasOwnProperty("shape")){var mt=ct.onnx.TensorShapeProto.verify(ft.shape);if(mt)return"shape."+mt}return null},ht.fromObject=function(ft){if(ft instanceof ct.onnx.TypeProto.Tensor)return ft;var mt=new ct.onnx.TypeProto.Tensor;if(ft.elemType!=null&&(mt.elemType=0|ft.elemType),ft.shape!=null){if(typeof ft.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");mt.shape=ct.onnx.TensorShapeProto.fromObject(ft.shape)}return mt},ht.toObject=function(ft,mt){mt||(mt={});var yt={};return mt.defaults&&(yt.elemType=0,yt.shape=null),ft.elemType!=null&&ft.hasOwnProperty("elemType")&&(yt.elemType=ft.elemType),ft.shape!=null&&ft.hasOwnProperty("shape")&&(yt.shape=ct.onnx.TensorShapeProto.toObject(ft.shape,mt)),yt},ht.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ht}(),ot}(),tt.OperatorSetIdProto=function(){function ot(at){if(at)for(var ht=Object.keys(at),ft=0;ft<ht.length;++ft)at[ht[ft]]!=null&&(this[ht[ft]]=at[ht[ft]])}return ot.prototype.domain="",ot.prototype.version=ut.Long?ut.Long.fromBits(0,0,!1):0,ot.create=function(at){return new ot(at)},ot.encode=function(at,ht){return ht||(ht=st.create()),at.domain!=null&&at.hasOwnProperty("domain")&&ht.uint32(10).string(at.domain),at.version!=null&&at.hasOwnProperty("version")&&ht.uint32(16).int64(at.version),ht},ot.encodeDelimited=function(at,ht){return this.encode(at,ht).ldelim()},ot.decode=function(at,ht){at instanceof it||(at=it.create(at));for(var ft=ht===void 0?at.len:at.pos+ht,mt=new ct.onnx.OperatorSetIdProto;at.pos<ft;){var yt=at.uint32();switch(yt>>>3){case 1:mt.domain=at.string();break;case 2:mt.version=at.int64();break;default:at.skipType(7&yt)}}return mt},ot.decodeDelimited=function(at){return at instanceof it||(at=new it(at)),this.decode(at,at.uint32())},ot.verify=function(at){return typeof at!="object"||at===null?"object expected":at.domain!=null&&at.hasOwnProperty("domain")&&!ut.isString(at.domain)?"domain: string expected":at.version!=null&&at.hasOwnProperty("version")&&!(ut.isInteger(at.version)||at.version&&ut.isInteger(at.version.low)&&ut.isInteger(at.version.high))?"version: integer|Long expected":null},ot.fromObject=function(at){if(at instanceof ct.onnx.OperatorSetIdProto)return at;var ht=new ct.onnx.OperatorSetIdProto;return at.domain!=null&&(ht.domain=String(at.domain)),at.version!=null&&(ut.Long?(ht.version=ut.Long.fromValue(at.version)).unsigned=!1:typeof at.version=="string"?ht.version=parseInt(at.version,10):typeof at.version=="number"?ht.version=at.version:typeof at.version=="object"&&(ht.version=new ut.LongBits(at.version.low>>>0,at.version.high>>>0).toNumber())),ht},ot.toObject=function(at,ht){ht||(ht={});var ft={};if(ht.defaults)if(ft.domain="",ut.Long){var mt=new ut.Long(0,0,!1);ft.version=ht.longs===String?mt.toString():ht.longs===Number?mt.toNumber():mt}else ft.version=ht.longs===String?"0":0;return at.domain!=null&&at.hasOwnProperty("domain")&&(ft.domain=at.domain),at.version!=null&&at.hasOwnProperty("version")&&(typeof at.version=="number"?ft.version=ht.longs===String?String(at.version):at.version:ft.version=ht.longs===String?ut.Long.prototype.toString.call(at.version):ht.longs===Number?new ut.LongBits(at.version.low>>>0,at.version.high>>>0).toNumber():at.version),ft},ot.prototype.toJSON=function(){return this.constructor.toObject(this,nt.util.toJSONOptions)},ot}(),tt),s.exports=ct},2100:(s,a,o)=>{s.exports=o(9482)},9482:(s,a,o)=>{var c=a;function d(){c.util._configure(),c.Writer._configure(c.BufferWriter),c.Reader._configure(c.BufferReader)}c.build="minimal",c.Writer=o(1173),c.BufferWriter=o(3155),c.Reader=o(1408),c.BufferReader=o(593),c.util=o(9693),c.rpc=o(5994),c.roots=o(5054),c.configure=d,d()},1408:(s,a,o)=>{s.exports=st;var c,d=o(9693),tt=d.LongBits,nt=d.utf8;function it(mt,yt){return RangeError("index out of range: "+mt.pos+" + "+(yt||1)+" > "+mt.len)}function st(mt){this.buf=mt,this.pos=0,this.len=mt.length}var ut,ct=typeof Uint8Array<"u"?function(mt){if(mt instanceof Uint8Array||Array.isArray(mt))return new st(mt);throw Error("illegal buffer")}:function(mt){if(Array.isArray(mt))return new st(mt);throw Error("illegal buffer")},ot=function(){return d.Buffer?function(mt){return(st.create=function(yt){return d.Buffer.isBuffer(yt)?new c(yt):ct(yt)})(mt)}:ct};function at(){var mt=new tt(0,0),yt=0;if(!(this.len-this.pos>4)){for(;yt<3;++yt){if(this.pos>=this.len)throw it(this);if(mt.lo=(mt.lo|(127&this.buf[this.pos])<<7*yt)>>>0,this.buf[this.pos++]<128)return mt}return mt.lo=(mt.lo|(127&this.buf[this.pos++])<<7*yt)>>>0,mt}for(;yt<4;++yt)if(mt.lo=(mt.lo|(127&this.buf[this.pos])<<7*yt)>>>0,this.buf[this.pos++]<128)return mt;if(mt.lo=(mt.lo|(127&this.buf[this.pos])<<28)>>>0,mt.hi=(mt.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return mt;if(yt=0,this.len-this.pos>4){for(;yt<5;++yt)if(mt.hi=(mt.hi|(127&this.buf[this.pos])<<7*yt+3)>>>0,this.buf[this.pos++]<128)return mt}else for(;yt<5;++yt){if(this.pos>=this.len)throw it(this);if(mt.hi=(mt.hi|(127&this.buf[this.pos])<<7*yt+3)>>>0,this.buf[this.pos++]<128)return mt}throw Error("invalid varint encoding")}function ht(mt,yt){return(mt[yt-4]|mt[yt-3]<<8|mt[yt-2]<<16|mt[yt-1]<<24)>>>0}function ft(){if(this.pos+8>this.len)throw it(this,8);return new tt(ht(this.buf,this.pos+=4),ht(this.buf,this.pos+=4))}st.create=ot(),st.prototype._slice=d.Array.prototype.subarray||d.Array.prototype.slice,st.prototype.uint32=(ut=4294967295,function(){if(ut=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(ut=(ut|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(ut=(ut|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(ut=(ut|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(ut=(ut|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return ut;if((this.pos+=5)>this.len)throw this.pos=this.len,it(this,10);return ut}),st.prototype.int32=function(){return 0|this.uint32()},st.prototype.sint32=function(){var mt=this.uint32();return mt>>>1^-(1&mt)|0},st.prototype.bool=function(){return this.uint32()!==0},st.prototype.fixed32=function(){if(this.pos+4>this.len)throw it(this,4);return ht(this.buf,this.pos+=4)},st.prototype.sfixed32=function(){if(this.pos+4>this.len)throw it(this,4);return 0|ht(this.buf,this.pos+=4)},st.prototype.float=function(){if(this.pos+4>this.len)throw it(this,4);var mt=d.float.readFloatLE(this.buf,this.pos);return this.pos+=4,mt},st.prototype.double=function(){if(this.pos+8>this.len)throw it(this,4);var mt=d.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,mt},st.prototype.bytes=function(){var mt=this.uint32(),yt=this.pos,bt=this.pos+mt;if(bt>this.len)throw it(this,mt);return this.pos+=mt,Array.isArray(this.buf)?this.buf.slice(yt,bt):yt===bt?new this.buf.constructor(0):this._slice.call(this.buf,yt,bt)},st.prototype.string=function(){var mt=this.bytes();return nt.read(mt,0,mt.length)},st.prototype.skip=function(mt){if(typeof mt=="number"){if(this.pos+mt>this.len)throw it(this,mt);this.pos+=mt}else do if(this.pos>=this.len)throw it(this);while(128&this.buf[this.pos++]);return this},st.prototype.skipType=function(mt){switch(mt){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(mt=7&this.uint32())!=4;)this.skipType(mt);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+mt+" at offset "+this.pos)}return this},st._configure=function(mt){c=mt,st.create=ot(),c._configure();var yt=d.Long?"toLong":"toNumber";d.merge(st.prototype,{int64:function(){return at.call(this)[yt](!1)},uint64:function(){return at.call(this)[yt](!0)},sint64:function(){return at.call(this).zzDecode()[yt](!1)},fixed64:function(){return ft.call(this)[yt](!0)},sfixed64:function(){return ft.call(this)[yt](!1)}})}},593:(s,a,o)=>{s.exports=tt;var c=o(1408);(tt.prototype=Object.create(c.prototype)).constructor=tt;var d=o(9693);function tt(nt){c.call(this,nt)}tt._configure=function(){d.Buffer&&(tt.prototype._slice=d.Buffer.prototype.slice)},tt.prototype.string=function(){var nt=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+nt,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+nt,this.len))},tt._configure()},5054:s=>{s.exports={}},5994:(s,a,o)=>{a.Service=o(7948)},7948:(s,a,o)=>{s.exports=d;var c=o(9693);function d(tt,nt,it){if(typeof tt!="function")throw TypeError("rpcImpl must be a function");c.EventEmitter.call(this),this.rpcImpl=tt,this.requestDelimited=!!nt,this.responseDelimited=!!it}(d.prototype=Object.create(c.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function tt(nt,it,st,ut,ct){if(!ut)throw TypeError("request must be specified");var ot=this;if(!ct)return c.asPromise(tt,ot,nt,it,st,ut);if(ot.rpcImpl)try{return ot.rpcImpl(nt,it[ot.requestDelimited?"encodeDelimited":"encode"](ut).finish(),function(at,ht){if(at)return ot.emit("error",at,nt),ct(at);if(ht!==null){if(!(ht instanceof st))try{ht=st[ot.responseDelimited?"decodeDelimited":"decode"](ht)}catch(ft){return ot.emit("error",ft,nt),ct(ft)}return ot.emit("data",ht,nt),ct(null,ht)}ot.end(!0)})}catch(at){return ot.emit("error",at,nt),void setTimeout(function(){ct(at)},0)}else setTimeout(function(){ct(Error("already ended"))},0)},d.prototype.end=function(tt){return this.rpcImpl&&(tt||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(s,a,o)=>{s.exports=d;var c=o(9693);function d(st,ut){this.lo=st>>>0,this.hi=ut>>>0}var tt=d.zero=new d(0,0);tt.toNumber=function(){return 0},tt.zzEncode=tt.zzDecode=function(){return this},tt.length=function(){return 1};var nt=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(st){if(st===0)return tt;var ut=st<0;ut&&(st=-st);var ct=st>>>0,ot=(st-ct)/4294967296>>>0;return ut&&(ot=~ot>>>0,ct=~ct>>>0,++ct>4294967295&&(ct=0,++ot>4294967295&&(ot=0))),new d(ct,ot)},d.from=function(st){if(typeof st=="number")return d.fromNumber(st);if(c.isString(st)){if(!c.Long)return d.fromNumber(parseInt(st,10));st=c.Long.fromString(st)}return st.low||st.high?new d(st.low>>>0,st.high>>>0):tt},d.prototype.toNumber=function(st){if(!st&&this.hi>>>31){var ut=1+~this.lo>>>0,ct=~this.hi>>>0;return ut||(ct=ct+1>>>0),-(ut+4294967296*ct)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(st){return c.Long?new c.Long(0|this.lo,0|this.hi,!!st):{low:0|this.lo,high:0|this.hi,unsigned:!!st}};var it=String.prototype.charCodeAt;d.fromHash=function(st){return st===nt?tt:new d((it.call(st,0)|it.call(st,1)<<8|it.call(st,2)<<16|it.call(st,3)<<24)>>>0,(it.call(st,4)|it.call(st,5)<<8|it.call(st,6)<<16|it.call(st,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var st=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^st)>>>0,this.lo=(this.lo<<1^st)>>>0,this},d.prototype.zzDecode=function(){var st=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^st)>>>0,this.hi=(this.hi>>>1^st)>>>0,this},d.prototype.length=function(){var st=this.lo,ut=(this.lo>>>28|this.hi<<4)>>>0,ct=this.hi>>>24;return ct===0?ut===0?st<16384?st<128?1:2:st<2097152?3:4:ut<16384?ut<128?5:6:ut<2097152?7:8:ct<128?9:10}},9693:function(s,a,o){var c=a;function d(nt,it,st){for(var ut=Object.keys(it),ct=0;ct<ut.length;++ct)nt[ut[ct]]!==void 0&&st||(nt[ut[ct]]=it[ut[ct]]);return nt}function tt(nt){function it(st,ut){if(!(this instanceof it))return new it(st,ut);Object.defineProperty(this,"message",{get:function(){return st}}),Error.captureStackTrace?Error.captureStackTrace(this,it):Object.defineProperty(this,"stack",{value:new Error().stack||""}),ut&&d(this,ut)}return(it.prototype=Object.create(Error.prototype)).constructor=it,Object.defineProperty(it.prototype,"name",{get:function(){return nt}}),it.prototype.toString=function(){return this.name+": "+this.message},it}c.asPromise=o(4537),c.base64=o(7419),c.EventEmitter=o(9211),c.float=o(945),c.inquire=o(7199),c.utf8=o(4997),c.pool=o(6662),c.LongBits=o(1945),c.isNode=!!(o.g!==void 0&&o.g&&o.g.process&&o.g.process.versions&&o.g.process.versions.node),c.global=c.isNode&&o.g||typeof window<"u"&&window||typeof self<"u"&&self||this,c.emptyArray=Object.freeze?Object.freeze([]):[],c.emptyObject=Object.freeze?Object.freeze({}):{},c.isInteger=Number.isInteger||function(nt){return typeof nt=="number"&&isFinite(nt)&&Math.floor(nt)===nt},c.isString=function(nt){return typeof nt=="string"||nt instanceof String},c.isObject=function(nt){return nt&&typeof nt=="object"},c.isset=c.isSet=function(nt,it){var st=nt[it];return!(st==null||!nt.hasOwnProperty(it))&&(typeof st!="object"||(Array.isArray(st)?st.length:Object.keys(st).length)>0)},c.Buffer=function(){try{var nt=c.inquire("buffer").Buffer;return nt.prototype.utf8Write?nt:null}catch{return null}}(),c._Buffer_from=null,c._Buffer_allocUnsafe=null,c.newBuffer=function(nt){return typeof nt=="number"?c.Buffer?c._Buffer_allocUnsafe(nt):new c.Array(nt):c.Buffer?c._Buffer_from(nt):typeof Uint8Array>"u"?nt:new Uint8Array(nt)},c.Array=typeof Uint8Array<"u"?Uint8Array:Array,c.Long=c.global.dcodeIO&&c.global.dcodeIO.Long||c.global.Long||c.inquire("long"),c.key2Re=/^true|false|0|1$/,c.key32Re=/^-?(?:0|[1-9][0-9]*)$/,c.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,c.longToHash=function(nt){return nt?c.LongBits.from(nt).toHash():c.LongBits.zeroHash},c.longFromHash=function(nt,it){var st=c.LongBits.fromHash(nt);return c.Long?c.Long.fromBits(st.lo,st.hi,it):st.toNumber(!!it)},c.merge=d,c.lcFirst=function(nt){return nt.charAt(0).toLowerCase()+nt.substring(1)},c.newError=tt,c.ProtocolError=tt("ProtocolError"),c.oneOfGetter=function(nt){for(var it={},st=0;st<nt.length;++st)it[nt[st]]=1;return function(){for(var ut=Object.keys(this),ct=ut.length-1;ct>-1;--ct)if(it[ut[ct]]===1&&this[ut[ct]]!==void 0&&this[ut[ct]]!==null)return ut[ct]}},c.oneOfSetter=function(nt){return function(it){for(var st=0;st<nt.length;++st)nt[st]!==it&&delete this[nt[st]]}},c.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},c._configure=function(){var nt=c.Buffer;nt?(c._Buffer_from=nt.from!==Uint8Array.from&&nt.from||function(it,st){return new nt(it,st)},c._Buffer_allocUnsafe=nt.allocUnsafe||function(it){return new nt(it)}):c._Buffer_from=c._Buffer_allocUnsafe=null}},1173:(s,a,o)=>{s.exports=ot;var c,d=o(9693),tt=d.LongBits,nt=d.base64,it=d.utf8;function st(wt,Tt,Ct){this.fn=wt,this.len=Tt,this.next=void 0,this.val=Ct}function ut(){}function ct(wt){this.head=wt.head,this.tail=wt.tail,this.len=wt.len,this.next=wt.states}function ot(){this.len=0,this.head=new st(ut,0,0),this.tail=this.head,this.states=null}var at=function(){return d.Buffer?function(){return(ot.create=function(){return new c})()}:function(){return new ot}};function ht(wt,Tt,Ct){Tt[Ct]=255&wt}function ft(wt,Tt){this.len=wt,this.next=void 0,this.val=Tt}function mt(wt,Tt,Ct){for(;wt.hi;)Tt[Ct++]=127&wt.lo|128,wt.lo=(wt.lo>>>7|wt.hi<<25)>>>0,wt.hi>>>=7;for(;wt.lo>127;)Tt[Ct++]=127&wt.lo|128,wt.lo=wt.lo>>>7;Tt[Ct++]=wt.lo}function yt(wt,Tt,Ct){Tt[Ct]=255&wt,Tt[Ct+1]=wt>>>8&255,Tt[Ct+2]=wt>>>16&255,Tt[Ct+3]=wt>>>24}ot.create=at(),ot.alloc=function(wt){return new d.Array(wt)},d.Array!==Array&&(ot.alloc=d.pool(ot.alloc,d.Array.prototype.subarray)),ot.prototype._push=function(wt,Tt,Ct){return this.tail=this.tail.next=new st(wt,Tt,Ct),this.len+=Tt,this},ft.prototype=Object.create(st.prototype),ft.prototype.fn=function(wt,Tt,Ct){for(;wt>127;)Tt[Ct++]=127&wt|128,wt>>>=7;Tt[Ct]=wt},ot.prototype.uint32=function(wt){return this.len+=(this.tail=this.tail.next=new ft((wt>>>=0)<128?1:wt<16384?2:wt<2097152?3:wt<268435456?4:5,wt)).len,this},ot.prototype.int32=function(wt){return wt<0?this._push(mt,10,tt.fromNumber(wt)):this.uint32(wt)},ot.prototype.sint32=function(wt){return this.uint32((wt<<1^wt>>31)>>>0)},ot.prototype.uint64=function(wt){var Tt=tt.from(wt);return this._push(mt,Tt.length(),Tt)},ot.prototype.int64=ot.prototype.uint64,ot.prototype.sint64=function(wt){var Tt=tt.from(wt).zzEncode();return this._push(mt,Tt.length(),Tt)},ot.prototype.bool=function(wt){return this._push(ht,1,wt?1:0)},ot.prototype.fixed32=function(wt){return this._push(yt,4,wt>>>0)},ot.prototype.sfixed32=ot.prototype.fixed32,ot.prototype.fixed64=function(wt){var Tt=tt.from(wt);return this._push(yt,4,Tt.lo)._push(yt,4,Tt.hi)},ot.prototype.sfixed64=ot.prototype.fixed64,ot.prototype.float=function(wt){return this._push(d.float.writeFloatLE,4,wt)},ot.prototype.double=function(wt){return this._push(d.float.writeDoubleLE,8,wt)};var bt=d.Array.prototype.set?function(wt,Tt,Ct){Tt.set(wt,Ct)}:function(wt,Tt,Ct){for(var Dt=0;Dt<wt.length;++Dt)Tt[Ct+Dt]=wt[Dt]};ot.prototype.bytes=function(wt){var Tt=wt.length>>>0;if(!Tt)return this._push(ht,1,0);if(d.isString(wt)){var Ct=ot.alloc(Tt=nt.length(wt));nt.decode(wt,Ct,0),wt=Ct}return this.uint32(Tt)._push(bt,Tt,wt)},ot.prototype.string=function(wt){var Tt=it.length(wt);return Tt?this.uint32(Tt)._push(it.write,Tt,wt):this._push(ht,1,0)},ot.prototype.fork=function(){return this.states=new ct(this),this.head=this.tail=new st(ut,0,0),this.len=0,this},ot.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new st(ut,0,0),this.len=0),this},ot.prototype.ldelim=function(){var wt=this.head,Tt=this.tail,Ct=this.len;return this.reset().uint32(Ct),Ct&&(this.tail.next=wt.next,this.tail=Tt,this.len+=Ct),this},ot.prototype.finish=function(){for(var wt=this.head.next,Tt=this.constructor.alloc(this.len),Ct=0;wt;)wt.fn(wt.val,Tt,Ct),Ct+=wt.len,wt=wt.next;return Tt},ot._configure=function(wt){c=wt,ot.create=at(),c._configure()}},3155:(s,a,o)=>{s.exports=tt;var c=o(1173);(tt.prototype=Object.create(c.prototype)).constructor=tt;var d=o(9693);function tt(){c.call(this)}function nt(it,st,ut){it.length<40?d.utf8.write(it,st,ut):st.utf8Write?st.utf8Write(it,ut):st.write(it,ut)}tt._configure=function(){tt.alloc=d._Buffer_allocUnsafe,tt.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&d.Buffer.prototype.set.name==="set"?function(it,st,ut){st.set(it,ut)}:function(it,st,ut){if(it.copy)it.copy(st,ut,0,it.length);else for(var ct=0;ct<it.length;)st[ut++]=it[ct++]}},tt.prototype.bytes=function(it){d.isString(it)&&(it=d._Buffer_from(it,"base64"));var st=it.length>>>0;return this.uint32(st),st&&this._push(tt.writeBytesBuffer,st,it),this},tt.prototype.string=function(it){var st=d.Buffer.byteLength(it);return this.uint32(st),st&&this._push(nt,st,it),this},tt._configure()},7714:(s,a,o)=>{a.R=void 0;const c=o(6919),d=o(7448);a.R=new class{async init(){}async createSessionHandler(tt,nt){const it=new c.Session(nt);return await it.loadModel(tt),new d.OnnxjsSessionHandler(it)}}},4200:(s,a,o)=>{a.c8=a.rX=void 0;const c=o(1670),d=o(5381),tt=o(2157),nt=o(2306);a.rX=()=>{if((typeof c.env.wasm.initTimeout!="number"||c.env.wasm.initTimeout<0)&&(c.env.wasm.initTimeout=0),typeof c.env.wasm.simd!="boolean"&&(c.env.wasm.simd=!0),typeof c.env.wasm.proxy!="boolean"&&(c.env.wasm.proxy=!1),typeof c.env.wasm.numThreads!="number"||!Number.isInteger(c.env.wasm.numThreads)||c.env.wasm.numThreads<=0){const it=typeof navigator>"u"?(0,d.cpus)().length:navigator.hardwareConcurrency;c.env.wasm.numThreads=Math.min(4,Math.ceil((it||1)/2))}},a.c8=new class{async init(){(0,a.rX)(),await(0,tt.initWasm)()}async createSessionHandler(it,st){const ut=new nt.OnnxruntimeWebAssemblySessionHandler;return await ut.loadModel(it,st),Promise.resolve(ut)}}},6018:function(s,a,o){var c=this&&this.__createBinding||(Object.create?function(nt,it,st,ut){ut===void 0&&(ut=st);var ct=Object.getOwnPropertyDescriptor(it,st);ct&&!("get"in ct?!it.__esModule:ct.writable||ct.configurable)||(ct={enumerable:!0,get:function(){return it[st]}}),Object.defineProperty(nt,ut,ct)}:function(nt,it,st,ut){ut===void 0&&(ut=st),nt[ut]=it[st]}),d=this&&this.__exportStar||function(nt,it){for(var st in nt)st==="default"||Object.prototype.hasOwnProperty.call(it,st)||c(it,nt,st)};Object.defineProperty(a,"__esModule",{value:!0}),d(o(1670),a);const tt=o(1670);{const nt=o(7714).R;(0,tt.registerBackend)("webgl",nt,-10)}{const nt=o(4200).c8;(0,tt.registerBackend)("cpu",nt,10),(0,tt.registerBackend)("wasm",nt,10),(0,tt.registerBackend)("xnnpack",nt,9)}},246:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createAttributeWithCacheKey=void 0;class o{constructor(d){Object.assign(this,d)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(d=>`${this[d]}`).join(";")),this._cacheKey}}a.createAttributeWithCacheKey=c=>new o(c)},7778:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Attribute=void 0;const c=o(1446),d=o(9395),tt=o(9162),nt=o(2517);var it=d.onnxruntime.experimental.fbs;class st{constructor(ct){if(this._attributes=new Map,ct!=null){for(const ot of ct)ot instanceof c.onnx.AttributeProto?this._attributes.set(ot.name,[st.getValue(ot),st.getType(ot)]):ot instanceof it.Attribute&&this._attributes.set(ot.name(),[st.getValue(ot),st.getType(ot)]);if(this._attributes.size<ct.length)throw new Error("duplicated attribute names")}}set(ct,ot,at){this._attributes.set(ct,[at,ot])}delete(ct){this._attributes.delete(ct)}getFloat(ct,ot){return this.get(ct,"float",ot)}getInt(ct,ot){return this.get(ct,"int",ot)}getString(ct,ot){return this.get(ct,"string",ot)}getTensor(ct,ot){return this.get(ct,"tensor",ot)}getFloats(ct,ot){return this.get(ct,"floats",ot)}getInts(ct,ot){return this.get(ct,"ints",ot)}getStrings(ct,ot){return this.get(ct,"strings",ot)}getTensors(ct,ot){return this.get(ct,"tensors",ot)}get(ct,ot,at){const ht=this._attributes.get(ct);if(ht===void 0){if(at!==void 0)return at;throw new Error(`required attribute not found: ${ct}`)}if(ht[1]!==ot)throw new Error(`type mismatch: expected ${ot} but got ${ht[1]}`);return ht[0]}static getType(ct){const ot=ct instanceof c.onnx.AttributeProto?ct.type:ct.type();switch(ot){case c.onnx.AttributeProto.AttributeType.FLOAT:return"float";case c.onnx.AttributeProto.AttributeType.INT:return"int";case c.onnx.AttributeProto.AttributeType.STRING:return"string";case c.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case c.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case c.onnx.AttributeProto.AttributeType.INTS:return"ints";case c.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case c.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${c.onnx.AttributeProto.AttributeType[ot]}`)}}static getValue(ct){const ot=ct instanceof c.onnx.AttributeProto?ct.type:ct.type();if(ot===c.onnx.AttributeProto.AttributeType.GRAPH||ot===c.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const at=this.getValueNoCheck(ct);if(ot===c.onnx.AttributeProto.AttributeType.INT&&nt.LongUtil.isLong(at))return nt.LongUtil.longToNumber(at);if(ot===c.onnx.AttributeProto.AttributeType.INTS){const ht=at,ft=new Array(ht.length);for(let mt=0;mt<ht.length;mt++){const yt=ht[mt];ft[mt]=nt.LongUtil.longToNumber(yt)}return ft}if(ot===c.onnx.AttributeProto.AttributeType.TENSOR)return ct instanceof c.onnx.AttributeProto?tt.Tensor.fromProto(at):tt.Tensor.fromOrtTensor(at);if(ot===c.onnx.AttributeProto.AttributeType.TENSORS){if(ct instanceof c.onnx.AttributeProto)return at.map(ht=>tt.Tensor.fromProto(ht));if(ct instanceof it.Attribute)return at.map(ht=>tt.Tensor.fromOrtTensor(ht))}if(ot===c.onnx.AttributeProto.AttributeType.STRING&&ct instanceof c.onnx.AttributeProto){const ht=at;return(0,nt.decodeUtf8String)(ht)}return ot===c.onnx.AttributeProto.AttributeType.STRINGS&&ct instanceof c.onnx.AttributeProto?at.map(nt.decodeUtf8String):at}static getValueNoCheck(ct){return ct instanceof c.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(ct):this.getValueNoCheckFromOrtFormat(ct)}static getValueNoCheckFromOnnxFormat(ct){switch(ct.type){case c.onnx.AttributeProto.AttributeType.FLOAT:return ct.f;case c.onnx.AttributeProto.AttributeType.INT:return ct.i;case c.onnx.AttributeProto.AttributeType.STRING:return ct.s;case c.onnx.AttributeProto.AttributeType.TENSOR:return ct.t;case c.onnx.AttributeProto.AttributeType.GRAPH:return ct.g;case c.onnx.AttributeProto.AttributeType.FLOATS:return ct.floats;case c.onnx.AttributeProto.AttributeType.INTS:return ct.ints;case c.onnx.AttributeProto.AttributeType.STRINGS:return ct.strings;case c.onnx.AttributeProto.AttributeType.TENSORS:return ct.tensors;case c.onnx.AttributeProto.AttributeType.GRAPHS:return ct.graphs;default:throw new Error(`unsupported attribute type: ${c.onnx.AttributeProto.AttributeType[ct.type]}`)}}static getValueNoCheckFromOrtFormat(ct){switch(ct.type()){case it.AttributeType.FLOAT:return ct.f();case it.AttributeType.INT:return ct.i();case it.AttributeType.STRING:return ct.s();case it.AttributeType.TENSOR:return ct.t();case it.AttributeType.GRAPH:return ct.g();case it.AttributeType.FLOATS:return ct.floatsArray();case it.AttributeType.INTS:{const ot=[];for(let at=0;at<ct.intsLength();at++)ot.push(ct.ints(at));return ot}case it.AttributeType.STRINGS:{const ot=[];for(let at=0;at<ct.stringsLength();at++)ot.push(ct.strings(at));return ot}case it.AttributeType.TENSORS:{const ot=[];for(let at=0;at<ct.tensorsLength();at++)ot.push(ct.tensors(at));return ot}default:throw new Error(`unsupported attribute type: ${it.AttributeType[ct.type()]}`)}}}a.Attribute=st},7091:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.resolveBackend=a.backend=void 0;const c=o(5038),d=new Map;async function tt(nt){const it=a.backend;if(it[nt]!==void 0&&function(st){const ut=st;return"initialize"in ut&&typeof ut.initialize=="function"&&"createSessionHandler"in ut&&typeof ut.createSessionHandler=="function"&&"dispose"in ut&&typeof ut.dispose=="function"}(it[nt])){const st=it[nt];let ut=st.initialize();if(typeof ut=="object"&&"then"in ut&&(ut=await ut),ut)return d.set(nt,st),st}}a.backend={webgl:new c.WebGLBackend},a.resolveBackend=async function nt(it){if(!it)return nt(["webgl"]);{const st=typeof it=="string"?[it]:it;for(const ut of st){const ct=d.get(ut);if(ct)return ct;const ot=await tt(ut);if(ot)return ot}}throw new Error("no available backend to use")}},5038:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WebGLBackend=void 0;const c=o(1670),d=o(6231),tt=o(6416),nt=o(7305);a.WebGLBackend=class{get contextId(){return c.env.webgl.contextId}set contextId(it){c.env.webgl.contextId=it}get matmulMaxBatchSize(){return c.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(it){c.env.webgl.matmulMaxBatchSize=it}get textureCacheMode(){return c.env.webgl.textureCacheMode}set textureCacheMode(it){c.env.webgl.textureCacheMode=it}get pack(){return c.env.webgl.pack}set pack(it){c.env.webgl.pack=it}get async(){return c.env.webgl.async}set async(it){c.env.webgl.async=it}initialize(){try{return this.glContext=(0,nt.createWebGLContext)(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),d.Logger.setWithEnv(c.env),d.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(it){return d.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${it}`),!1}}createSessionHandler(it){return new tt.WebGLSessionHandler(this,it)}dispose(){this.glContext.dispose()}}},5107:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoordsGlslLib=void 0;const c=o(2517),d=o(8520),tt=o(5060),nt=o(7859),it=o(9390);class st extends d.GlslLib{constructor(ct){super(ct)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new d.GlslLibRoutine(`
      vec2 offsetToCoords(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){return{coordsToOffset:new d.GlslLibRoutine(`
      int coordsToOffset(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){const ct=this.context.outputTextureLayout;return ct.isPacked?this.getPackedOutputSamplingSnippet(ct):this.getUnpackedOutputSamplingSnippet(ct)}getPackedOutputSamplingSnippet(ct){const ot=ct.unpackedShape,at=[ct.width,ct.height],ht={},ft="getOutputCoords";switch(ot.length){case 0:ht[ft]=this.getOutputScalarCoords();break;case 1:ht[ft]=this.getOutputPacked1DCoords(ot,at);break;case 2:ht[ft]=this.getOutputPacked2DCoords(ot,at);break;case 3:ht[ft]=this.getOutputPacked3DCoords(ot,at);break;default:ht[ft]=this.getOutputPackedNDCoords(ot,at)}const mt=`
      void setOutput(vec4 val) {
        ${(0,tt.getGlsl)(this.context.glContext.version).output} = val;
      }
    `;return ht.floatTextureSetRGBA=new d.GlslLibRoutine(mt),ht}getUnpackedOutputSamplingSnippet(ct){const ot=ct.unpackedShape,at=[ct.width,ct.height],ht={},ft="getOutputCoords";switch(ot.length){case 0:ht[ft]=this.getOutputScalarCoords();break;case 1:ht[ft]=this.getOutputUnpacked1DCoords(ot,at);break;case 2:ht[ft]=this.getOutputUnpacked2DCoords(ot,at);break;case 3:ht[ft]=this.getOutputUnpacked3DCoords(ot,at);break;case 4:ht[ft]=this.getOutputUnpacked4DCoords(ot,at);break;case 5:ht[ft]=this.getOutputUnpacked5DCoords(ot,at);break;case 6:ht[ft]=this.getOutputUnpacked6DCoords(ot,at);break;default:throw new Error(`Unsupported output dimensionality: ${ot.length}`)}const mt=`
        void setOutput(float val) {
          ${(0,tt.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return ht.floatTextureSetR=new d.GlslLibRoutine(mt),ht}getOutputScalarCoords(){return new d.GlslLibRoutine(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(ct,ot){const at=ot;let ht="";return at[0]===1?(ht=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${at[1]}.0);
          }
        `,new d.GlslLibRoutine(ht)):at[1]===1?(ht=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${at[0]}.0);
          }
        `,new d.GlslLibRoutine(ht)):(ht=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${at[0]}, ${at[1]}));
          return 2 * (resTexRC.y * ${at[0]} + resTexRC.x);
        }
      `,new d.GlslLibRoutine(ht))}getOutputPacked2DCoords(ct,ot){let at="";if(c.ArrayUtil.arraysEqual(ct,ot))return at=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${ot[0]}, ${ot[1]}));
        }
      `,new d.GlslLibRoutine(at);const ht=ot,ft=Math.ceil(ct[1]/2);return at=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ht[0]}, ${ht[1]}));

          int index = resTexRC.y * ${ht[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${ft}) * 2;
          int c = 2 * (index / ${ft});

          return ivec2(r, c);
        }
      `,new d.GlslLibRoutine(at)}getOutputPacked3DCoords(ct,ot){const at=[ot[0],ot[1]],ht=Math.ceil(ct[2]/2),ft=ht*Math.ceil(ct[1]/2),mt=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${at[0]}, ${at[1]}));
          int index = resTexRC.y * ${at[0]} + resTexRC.x;

          int b = index / ${ft};
          index -= b * ${ft};

          // reverse r and c order for packed texture
          int r = imod(index, ${ht}) * 2;
          int c = 2 * (index / ${ht});

          return ivec3(b, r, c);
        }
      `;return new d.GlslLibRoutine(mt)}getOutputPackedNDCoords(ct,ot){const at=[ot[0],ot[1]],ht=Math.ceil(ct[ct.length-1]/2),ft=ht*Math.ceil(ct[ct.length-2]/2);let mt=ft,yt="",bt="b, r, c";for(let Tt=2;Tt<ct.length-1;Tt++)mt*=ct[ct.length-Tt-1],yt=`
      int b${Tt} = index / ${mt};
      index -= b${Tt} * ${mt};
    `+yt,bt=`b${Tt}, `+bt;const wt=`
      ivec${ct.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${at[0]}, ${at[1]}));
        int index = resTexRC.y * ${at[0]} + resTexRC.x;

        ${yt}

        int b = index / ${ft};
        index -= b * ${ft};

        // reverse r and c order for packed texture
        int r = imod(index, ${ht}) * 2;
        int c = 2 * (index / ${ht});

        return ivec${ct.length}(${bt});
      }
    `;return new d.GlslLibRoutine(wt)}getOutputUnpacked1DCoords(ct,ot){const at=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ot[0]}, ${ot[1]}));
          return resTexRC.y * ${ot[0]} + resTexRC.x;
        }
      `;return new d.GlslLibRoutine(at)}getOutputUnpacked2DCoords(ct,ot){const at=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ot[0]}, ${ot[1]}));
          int index = resTexRC.y * ${ot[0]} + resTexRC.x;
          int r = index / ${ct[1]};
          int c = index - r * ${ct[1]};
          return ivec2(r, c);
        }
      `;return new d.GlslLibRoutine(at)}getOutputUnpacked3DCoords(ct,ot){let at="";const ht=ct.length;let ft=null;ht<2&&(ft=[]),ft=new Array(ht-1),ft[ht-2]=ct[ht-1];for(let bt=ht-3;bt>=0;--bt)ft[bt]=ft[bt+1]*ct[bt+1];const mt=["r","c","d"],yt=ft.map((bt,wt)=>`int ${mt[wt]} = index / ${bt}; ${wt===ft.length-1?`int ${mt[wt+1]} = index - ${mt[wt]} * ${bt}`:`index -= ${mt[wt]} * ${bt}`};`).join("");return at=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ot[0]}, ${ot[1]}));
          int index = resTexRC.y * ${ot[0]} + resTexRC.x;
          ${yt}
          return ivec3(r, c, d);
        }
      `,new d.GlslLibRoutine(at)}getOutputUnpacked4DCoords(ct,ot){let at="";const ht=ct.length;let ft=null;ht<2&&(ft=[]),ft=new Array(ht-1),ft[ht-2]=ct[ht-1];for(let bt=ht-3;bt>=0;--bt)ft[bt]=ft[bt+1]*ct[bt+1];const mt=["r","c","d","d2"],yt=ft.map((bt,wt)=>`int ${mt[wt]} = index / ${bt}; ${wt===ft.length-1?`int ${mt[wt+1]} = index - ${mt[wt]} * ${bt}`:`index -= ${mt[wt]} * ${bt}`};`).join("");return at=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ot[0]}, ${ot[1]}));
          int index = resTexRC.y * ${ot[0]} + resTexRC.x;
          ${yt}
          return ivec4(r, c, d, d2);
        }
      `,new d.GlslLibRoutine(at)}getOutputUnpacked5DCoords(ct,ot){let at="";const ht=ct.length;let ft=null;ht<2&&(ft=[]),ft=new Array(ht-1),ft[ht-2]=ct[ht-1];for(let bt=ht-3;bt>=0;--bt)ft[bt]=ft[bt+1]*ct[bt+1];const mt=["r","c","d","d2","d3"],yt=ft.map((bt,wt)=>`int ${mt[wt]} = index / ${bt}; ${wt===ft.length-1?`int ${mt[wt+1]} = index - ${mt[wt]} * ${bt}`:`index -= ${mt[wt]} * ${bt}`};`).join("");return at=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${ot[0]}, ${ot[1]}));
          int index = resTexRC.y * ${ot[0]} + resTexRC.x;
          ${yt}
          return ivec5(r, c, d, d2, d3);
        }
      `,new d.GlslLibRoutine(at)}getOutputUnpacked6DCoords(ct,ot){let at="";const ht=ct.length;let ft=null;ht<2&&(ft=[]),ft=new Array(ht-1),ft[ht-2]=ct[ht-1];for(let bt=ht-3;bt>=0;--bt)ft[bt]=ft[bt+1]*ct[bt+1];const mt=["r","c","d","d2","d3","d4"],yt=ft.map((bt,wt)=>`int ${mt[wt]} = index / ${bt}; ${wt===ft.length-1?`int ${mt[wt+1]} = index - ${mt[wt]} * ${bt}`:`index -= ${mt[wt]} * ${bt}`};`).join("");return at=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${ot[0]}, ${ot[1]}));
         int index = resTexRC.y * ${ot[0]} + resTexRC.x;
         ${yt}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new d.GlslLibRoutine(at)}getCommonUtilFuncs(){const ct={};let ot="uvFromFlat";ct[ot]=new d.GlslLibRoutine(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),ot="packedUVfrom1D",ct[ot]=new d.GlslLibRoutine(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),ot="packedUVfrom2D",ct[ot]=new d.GlslLibRoutine(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),ot="packedUVfrom3D",ct[ot]=new d.GlslLibRoutine(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),ot="sampleTexture";const at=(0,tt.getGlsl)(this.context.glContext.version);return ct[ot]=new d.GlslLibRoutine(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${at.texture2D}(textureSampler, uv).r;
        }`),ct}getInputsSamplingSnippets(){const ct={},ot=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((at,ht)=>{const ft=this.context.inputTextureLayouts[ht],mt=(0,it.generateShaderFuncNameFromInputSamplerName)(at);ft.isPacked?ct[mt]=this.getPackedSamplerFromInput(mt,at,ft):ct[mt]=this.getUnpackedSamplerFromInput(mt,at,ft);const yt=(0,it.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(at);ft.unpackedShape.length<=ot.unpackedShape.length&&(ft.isPacked?ct[yt]=this.getPackedSamplerAtOutputCoords(yt,ft,ot,at):ct[yt]=this.getUnpackedSamplerAtOutputCoords(yt,ft,ot,at))}),ct}getPackedSamplerAtOutputCoords(ct,ot,at,ht){const ft=ot.unpackedShape,mt=at.unpackedShape,yt=ht,bt=(0,it.generateShaderFuncNameFromInputSamplerName)(yt),wt=ft.length,Tt=mt.length,Ct=c.BroadcastUtil.getBroadcastDims(ft,mt),Dt=(0,it.getCoordsDataType)(Tt),Ot=Tt-wt;let $t;const Ft=(0,it.getGlChannels)();$t=wt===0?"":Tt<2&&Ct.length>=1?"coords = 0;":Ct.map(Zt=>`coords.${Ft[Zt+Ot]} = 0;`).join(`
`);let kt="";kt=Tt<2&&wt>0?"coords":ft.map((Zt,ar)=>`coords.${Ft[ar+Ot]}`).join(", ");let Vt="return outputValue;";const Ht=c.ShapeUtil.size(ft)===1,Qt=c.ShapeUtil.size(mt)===1;if(wt!==1||Ht||Qt){if(Ht&&!Qt)Vt=Tt===1?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(Ct.length){const Zt=wt-2,ar=wt-1;Ct.indexOf(Zt)>-1&&Ct.indexOf(ar)>-1?Vt="return vec4(outputValue.x);":Ct.indexOf(Zt)>-1?Vt="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":Ct.indexOf(ar)>-1&&(Vt="return vec4(outputValue.xx, outputValue.zz);")}}else Vt=`
        return vec4(outputValue.xy, outputValue.xy);
      `;const Xt=`
      vec4 ${ct}() {
        ${Dt} coords = getOutputCoords();
        
        int lastDim = coords.${Ft[Tt-1]};
        coords.${Ft[Tt-1]} = coords.${Ft[Tt-2]};
        coords.${Ft[Tt-2]} = lastDim;
      
        ${$t}
        vec4 outputValue = ${bt}(${kt});
        ${Vt}
      }
    `;return new d.GlslLibRoutine(Xt,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(ct,ot,at,ht){const ft=[at.width,at.height],mt=[ot.width,ot.height],yt=ot.unpackedShape.length,bt=at.unpackedShape.length,wt=ot.unpackedShape,Tt=at.unpackedShape,Ct=(0,it.generateShaderFuncNameFromInputSamplerName)(ht);if(yt===bt&&c.ArrayUtil.arraysEqual(mt,ft)){const Qt=`
          float ${ct}() {
            return sampleTexture(${ht}, TexCoords);
          }
        `;return new d.GlslLibRoutine(Qt,["coordinates.sampleTexture"])}const Dt=(0,it.getCoordsDataType)(bt),Ot=c.BroadcastUtil.getBroadcastDims(wt,Tt),$t=bt-yt;let Ft;const kt=(0,it.getGlChannels)();Ft=yt===0?"":bt<2&&Ot.length>=1?"coords = 0;":Ot.map(Qt=>`coords.${kt[Qt+$t]} = 0;`).join(`
`);let Vt="";Vt=bt<2&&yt>0?"coords":ot.unpackedShape.map((Qt,Xt)=>`coords.${kt[Xt+$t]}`).join(", ");const Ht=`
        float ${ct}() {
          ${Dt} coords = getOutputCoords();
          ${Ft}
          return ${Ct}(${Vt});
        }
      `;return new d.GlslLibRoutine(Ht,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(ct,ot,at){switch(at.unpackedShape.length){case 0:return this.getPackedSamplerScalar(ct,ot);case 1:return this.getPackedSampler1D(ct,ot,at);case 2:return this.getPackedSampler2D(ct,ot,at);case 3:return this.getPackedSampler3D(ct,ot,at);default:return this.getPackedSamplerND(ct,ot,at)}}getUnpackedSamplerFromInput(ct,ot,at){const ht=at.unpackedShape;switch(ht.length){case 0:return this.getUnpackedSamplerScalar(ct,ot,at);case 1:return this.getUnpackedSampler1D(ct,ot,at);case 2:return this.getUnpackedSampler2D(ct,ot,at);case 3:return this.getUnpackedSampler3D(ct,ot,at);case 4:return this.getUnpackedSampler4D(ct,ot,at);case 5:return this.getUnpackedSampler5D(ct,ot,at);case 6:return this.getUnpackedSampler6D(ct,ot,at);default:throw new Error(`Unsupported dimension ${ht.length}-D`)}}getPackedSamplerScalar(ct,ot){const at=`
          vec4 ${ct}() {
            return ${(0,tt.getGlsl)(this.context.glContext.version).texture2D}(${ot}, halfCR);
          }
        `;return new d.GlslLibRoutine(at)}getPackedSampler1D(ct,ot,at){const ht=[at.width,at.height],ft=[ht[1],ht[0]],mt=(0,tt.getGlsl)(this.context.glContext.version),yt=`vec4 ${ct}(int index) {
      vec2 uv = packedUVfrom1D(
      ${ft[0]}, ${ft[1]}, index);
      return ${mt.texture2D}(${ot}, uv);
    }`;return new d.GlslLibRoutine(yt,["coordinates.packedUVfrom1D"])}getPackedSampler2D(ct,ot,at){const ht=at.unpackedShape,ft=[at.width,at.height],mt=(0,tt.getGlsl)(this.context.glContext.version),yt=ft[0],bt=ft[1];if(ft!=null&&c.ArrayUtil.arraysEqual(ht,ft)){const Dt=`vec4 ${ct}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${bt}.0, ${yt}.0);
        return ${mt.texture2D}(${ot}, uv);
      }`;return new d.GlslLibRoutine(Dt)}const wt=ft,Tt=Math.ceil(ht[1]/2),Ct=`vec4 ${ct}(int row, int col) {
      vec2 uv = packedUVfrom2D(${wt[1]}, ${wt[0]}, ${Tt}, row, col);
      return ${mt.texture2D}(${ot}, uv);
    }`;return new d.GlslLibRoutine(Ct,["coordinates.packedUVfrom2D"])}getPackedSampler3D(ct,ot,at){const ht=at.unpackedShape,ft=[at.width,at.height],mt=[ft[0],ft[1]],yt=(0,tt.getGlsl)(this.context.glContext.version);if(ht[0]===1){const Dt=ht.slice(1),Ot=[1,2],$t=(0,it.squeezeInputShape)(ht,Dt),Ft=["b","row","col"],kt=JSON.parse(JSON.stringify(at));kt.unpackedShape=$t;const Vt=this.getPackedSamplerFromInput(ct,ot,kt),Ht=`${Vt.routineBody}
      vec4 ${ct}(int b, int row, int col) {
        return ${ct}(${(0,it.getSqueezedParams)(Ft,Ot)});
      } `;return new d.GlslLibRoutine(Ht,Vt.dependencies)}const bt=mt[0],wt=mt[1],Tt=Math.ceil(ht[2]/2),Ct=`vec4 ${ct}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${wt}, ${bt}, ${Tt*Math.ceil(ht[1]/2)}, ${Tt}, b, row, col);
      return ${yt.texture2D}(${ot}, uv);}`;return new d.GlslLibRoutine(Ct,["coordinates.packedUVfrom3D"])}getPackedSamplerND(ct,ot,at){const ht=at.unpackedShape,ft=ht.length,mt=[at.width,at.height],yt=(0,tt.getGlsl)(this.context.glContext.version),bt=[mt[0],mt[1]],wt=bt[1],Tt=bt[0],Ct=Math.ceil(ht[ft-1]/2);let Dt=Ct*Math.ceil(ht[ft-2]/2),Ot="int b, int row, int col",$t=`b * ${Dt} + (row / 2) * ${Ct} + (col / 2)`;for(let kt=2;kt<ft-1;kt++)Ot=`int b${kt}, `+Ot,Dt*=ht[ft-kt-1],$t=`b${kt} * ${Dt} + `+$t;const Ft=`vec4 ${ct}(${Ot}) {
      int index = ${$t};
      int texR = index / ${Tt};
      int texC = index - texR * ${Tt};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${Tt}, ${wt});
      return ${yt.texture2D}(${ot}, uv);
    }`;return new d.GlslLibRoutine(Ft)}getUnpackedSamplerScalar(ct,ot,at){const[ht,ft]=[at.width,at.height];if(ht===1&&ft===1){const yt=`
          float ${ct}() {
            return sampleTexture(${ot}, halfCR);
          }
        `;return new d.GlslLibRoutine(yt,["coordinates.sampleTexture"])}const mt=`
        float ${ct}() {
          int offset_${ot} = coordsToOffset(TexCoords, ${ht}, ${ft});
          vec2 uv = uvFromFlat(${ht}, ${ft}, offset_${ot});
          return sampleTexture(${ot}, uv);
        }
      `;return new d.GlslLibRoutine(mt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(ct,ot,at){const ht=at.width,ft=at.height;if(ft===1&&ht===1){const yt=`
        float ${ct}(int index) {
          return sampleTexture(${ot}, halfCR);
        }
      `;return new d.GlslLibRoutine(yt,["coordinates.sampleTexture"])}if(ft===1){const yt=`
          float ${ct}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${ht}.0, 0.5);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(yt,["coordinates.sampleTexture"])}if(ht===1){const yt=`
          float ${ct}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${ft}.0);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(yt,["coordinates.sampleTexture"])}const mt=`
        float ${ct}(int index) {
          vec2 uv = uvFromFlat(${ht}, ${ft}, index);
          return sampleTexture(${ot}, uv);
        }
      `;return new d.GlslLibRoutine(mt,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(ct,ot,at){const ht=at.unpackedShape,ft=[at.height,at.width];if(ft!=null&&c.ArrayUtil.arraysEqual(ht,ft)){const Dt=`
          float ${ct}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${ft[1]}.0, ${ft[0]}.0);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(Dt,["coordinates.sampleTexture"])}const{newShape:mt,keptDims:yt}=(0,nt.squeezeShape)(ht),bt=mt;if(bt.length<ht.length){const Dt=(0,it.squeezeInputShape)(ht,bt),Ot=JSON.parse(JSON.stringify(at));Ot.unpackedShape=Dt;const $t=["col","row"],Ft=`
          ${this.getUnpackedSamplerFromInput(ct,ot,Ot).routineBody}
          float ${ct}(int row, int col) {
            return ${ct}(${(0,it.getSqueezedParams)($t,yt)});
          }
        `;return new d.GlslLibRoutine(Ft,["coordinates.sampleTexture"])}const wt=ft[1],Tt=ft[0];if(Tt===1){const Dt=`
          float ${ct}(int row, int col) {
            int offset_${ot} = coordsToOffset(TexCoords, ${wt}, ${Tt});
            float index = dot(vec3(row, col, offset_${ot}), vec3(${ht[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${wt}.0);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(Dt,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(wt===1){const Dt=`
          float ${ct}(int row, int col) {
            int offset_${ot} = coordsToOffset(TexCoords, ${wt}, ${Tt});
            float index = dot(vec3(row, col, offset_${ot}), vec3(${ht[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${Tt}.0, 0.5);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(Dt,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const Ct=`
        float ${ct}(int row, int col) {
          int index = col * ${ht[1]} + row;
          vec2 uv = uvFromFlat(${wt}, ${Tt}, index);
          return sampleTexture(${ot}, uv);
        }
      `;return new d.GlslLibRoutine(Ct,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(ct,ot,at){const ht=at.unpackedShape,ft=ht[1]*ht[2],mt=ht[2],{newShape:yt,keptDims:bt}=(0,nt.squeezeShape)(ht),wt=yt;if(wt.length<ht.length){const Ct=(0,it.squeezeInputShape)(ht,wt),Dt=["batch","col","row"],Ot=JSON.parse(JSON.stringify(at));Ot.unpackedShape=Ct;const $t=this.getUnpackedSamplerFromInput(ct,ot,Ot),Ft=bt.reverse(),kt=`
          ${$t.routineBody}
          float ${ct}(int batch, int row, int col) {
            return ${ct}(${(0,it.getSqueezedParams)(Dt,Ft)});
          }
        `;return new d.GlslLibRoutine(kt,$t.dependencies)}const Tt=`
          float ${ct}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${ft} + col * ${mt} + row;
            vec2 uv = uvFromFlat(${at.width}, ${at.height}, index);
            return sampleTexture(${ot}, uv);
          }
      `;return new d.GlslLibRoutine(Tt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(ct,ot,at){const ht=at.unpackedShape,ft=ht[3],mt=ht[2]*ft,yt=`
        float ${ct}(int row, int col, int depth, int depth2) {
          int index = row * ${ht[1]*mt} + col * ${mt} +
              depth2 * ${ft} + depth;
          vec2 uv = uvFromFlat(${at.width}, ${at.height}, index);
          return sampleTexture(${ot}, uv);
        }
      `;return new d.GlslLibRoutine(yt,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(ct,ot,at){const ht=at.unpackedShape,ft=ht[4],mt=ht[3]*ft,yt=ht[2]*mt,bt=ht[1]*yt,{newShape:wt,keptDims:Tt}=(0,nt.squeezeShape)(ht);if(wt.length<ht.length){const Dt=(0,it.squeezeInputShape)(ht,wt),Ot=["row","col","depth","depth2","depth3"],$t=JSON.parse(JSON.stringify(at));$t.unpackedShape=Dt;const Ft=`
          ${this.getUnpackedSamplerFromInput(ct,ot,$t).routineBody}
          float ${ct}(int row, int col, int depth, int depth2, int depth3) {
            return ${ct}(${(0,it.getSqueezedParams)(Ot,Tt)});
          }
        `;return new d.GlslLibRoutine(Ft,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const Ct=`
        float ${ct}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${bt} + col * ${yt} + depth * ${mt} +
          depth3 * ${ft} + depth2;
          vec2 uv = uvFromFlat(${at.width}, ${at.height}, index);
          return sampleTexture(${ot}, uv);
        }
      `;return new d.GlslLibRoutine(Ct,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(ct,ot,at){const ht=at.unpackedShape,ft=ht[5],mt=ht[4]*ft,yt=ht[3]*mt,bt=ht[2]*yt,wt=ht[1]*bt,{newShape:Tt,keptDims:Ct}=(0,nt.squeezeShape)(ht);if(Tt.length<ht.length){const Ot=(0,it.squeezeInputShape)(ht,Tt),$t=["row","col","depth","depth2","depth3","depth4"],Ft=JSON.parse(JSON.stringify(at));Ft.unpackedShape=Ot;const kt=`
            ${this.getUnpackedSamplerFromInput(ct,ot,Ft).routineBody}
            float ${ct}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${ct}(${(0,it.getSqueezedParams)($t,Ct)});
            }
          `;return new d.GlslLibRoutine(kt,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const Dt=`
          float ${ct}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${wt} + col * ${bt} + depth * ${yt} +
            depth2 * ${mt} + depth3 * ${ft} + depth4;
            vec2 uv = uvFromFlat(${at.width}, ${at.height}, index);
            return sampleTexture(${ot}, uv);
          }
        `;return new d.GlslLibRoutine(Dt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const ct=this.context.outputTextureLayout,ot=ct.shape.length,at=ct.strides,ht=ct.width,ft=ct.height,mt=[];for(let bt=0;bt<ot-1;++bt)mt.push(`
        c[${bt}] = offset / ${at[bt]};`),mt.push(`
        offset -= c[${bt}] * ${at[bt]};`);mt.push(`
        c[${ot-1}] = offset;`);const yt=`
      void toVec(vec2 texCoords, out int c[${ot}]) {
        int offset = coordsToOffset(texCoords, ${ht}, ${ft});
        ${mt.join("")}
      }
      void toVec(int offset, out int c[${ot}]) {
        ${mt.join("")}
      }
    `;return{toVec:new d.GlslLibRoutine(yt,["coordinates.coordsToOffset"])}}valueFrom(){const ct={};return this.context.programInfo.inputNames.forEach((ot,at)=>{const ht=this.context.inputTextureLayouts[at],ft=(ht.unpackedShape.length>0?ht.unpackedShape:ht.shape).length;let mt=`_${ot}`;ct[mt]=new d.GlslLibRoutine(this.getValueFromSingle(ot,ft,ht.width,ht.height,!1),[`shapeUtils.indicesToOffset${mt}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),mt+="_T",ct[mt]=new d.GlslLibRoutine(this.getValueFromSingle(ot,ft,ht.width,ht.height,!0),[`shapeUtils.indicesToOffset${mt}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),ct}getValueFromSingle(ct,ot,at,ht,ft){let mt=`_${ct}`;return ft&&(mt+="_T"),`
        float ${mt}(int m[${ot}]) {
          int offset = indicesToOffset${mt}(m);
          vec2 coords = offsetToCoords(offset, ${at}, ${ht});
          float value = getColorAsFloat(${(0,tt.getGlsl)(this.context.glContext.version).texture2D}(${ct}, coords));
          return value;
        }
        `}getPackedValueFrom(ct,ot,at,ht,ft){let mt=`_${ct}_Pack`;return ft&&(mt+="_T"),`
        vec4 ${mt}(int m[${ot}]) {
          int offset = indicesToOffset_${ct}(m);
          vec2 coords = offsetToCoords(offset, ${at}, ${ht});
          return ${(0,tt.getGlsl)(this.context.glContext.version).texture2D}(${ct}, coords);
        }
        `}}a.CoordsGlslLib=st},8520:(s,a)=>{var o;Object.defineProperty(a,"__esModule",{value:!0}),a.TopologicalSortGlslRoutines=a.GlslLibRoutineNode=a.GlslLibRoutine=a.GlslLib=a.GlslContext=a.FunctionType=void 0,(o=a.FunctionType||(a.FunctionType={}))[o.ValueBased=0]="ValueBased",o[o.Positional=1]="Positional",a.GlslContext=class{constructor(c,d,tt,nt){this.glContext=c,this.programInfo=d,this.inputTextureLayouts=tt,this.outputTextureLayout=nt}},a.GlslLib=class{constructor(c){this.context=c}},a.GlslLibRoutine=class{constructor(c,d){this.routineBody=c,this.dependencies=d}},a.GlslLibRoutineNode=class{constructor(c,d,tt){this.name=c,this.dependencies=tt||[],d&&(this.routineBody=d)}addDependency(c){c&&this.dependencies.push(c)}},a.TopologicalSortGlslRoutines=class{static returnOrderedNodes(c){if(!c||c.length===0)return[];if(c.length===1)return c;const d=new Set,tt=new Set,nt=new Array;return this.createOrderedNodes(c,d,tt,nt),nt}static createOrderedNodes(c,d,tt,nt){for(let it=0;it<c.length;++it)this.dfsTraverse(c[it],d,tt,nt)}static dfsTraverse(c,d,tt,nt){if(!c||tt.has(c.name))return;if(d.has(c.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");d.add(c.name);const it=c.dependencies;if(it&&it.length>0)for(let st=0;st<it.length;++st)this.dfsTraverse(it[st],d,tt,nt);nt.push(c),tt.add(c.name),d.delete(c.name)}}},7341:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.EncodingGlslLib=void 0;const c=o(8520);class d extends c.GlslLib{constructor(nt){super(nt)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new c.GlslLibRoutine(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new c.GlslLibRoutine(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){const nt=d.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new c.GlslLibRoutine(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${nt}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){const nt=d.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new c.GlslLibRoutine(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${nt}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){const nt=new ArrayBuffer(4),it=new Uint32Array(nt),st=new Uint8Array(nt);if(it[0]=3735928559,st[0]===239)return!0;if(st[0]===222)return!1;throw new Error("unknown endianness")}}a.EncodingGlslLib=d},9894:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FragColorGlslLib=void 0;const c=o(8520),d=o(5060);class tt extends c.GlslLib{constructor(it){super(it)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const it=(0,d.getGlsl)(this.context.glContext.version);return{setFragColor:new c.GlslLibRoutine(`
        void setFragColor(float value) {
            ${it.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new c.GlslLibRoutine(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}a.FragColorGlslLib=tt},2848:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.replaceInlines=void 0;const o=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;a.replaceInlines=function(c){const d={};let tt;for(;(tt=o.exec(c))!==null;){const nt=tt[3].split(",").map(it=>{const st=it.trim().split(" ");return st&&st.length===2?{type:st[0],name:st[1]}:null}).filter(it=>it!==null);d[tt[2]]={params:nt,body:tt[4]}}for(const nt in d){const it="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",nt),st=new RegExp(it,"gm");for(;(tt=st.exec(c))!==null;){const ut=tt[1],ct=tt[2],ot=tt[3].split(","),at=ut?`${ut} ${ct};`:"";let ht=d[nt].body,ft="";d[nt].params.forEach((yt,bt)=>{yt&&(ft+=`${yt.type} ${yt.name} = ${ot[bt]};
`)}),ht=`${ft}
 ${ht}`,ht=ht.replace("return",`${ct} = `);const mt=`
      ${at}
      {
        ${ht}
      }
      `;c=c.replace(tt[0],mt)}}return c.replace(o,"")}},8879:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlslPreprocessor=void 0;const c=o(8520),d=o(2848),tt=o(5483),nt=o(5060);a.GlslPreprocessor=class{constructor(it,st,ut,ct){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new c.GlslContext(it,st,ut,ct),Object.keys(tt.glslRegistry).forEach(at=>{const ht=new tt.glslRegistry[at](this.context);this.libs[at]=ht});const ot=this.glslLibRoutineDependencyGraph;for(const at in this.libs){const ht=this.libs[at].getFunctions();for(const ft in ht){const mt=at+"."+ft;let yt;ot[mt]?(yt=ot[mt],yt.routineBody=ht[ft].routineBody):(yt=new c.GlslLibRoutineNode(mt,ht[ft].routineBody),ot[mt]=yt);const bt=ht[ft].dependencies;if(bt)for(let wt=0;wt<bt.length;++wt)if(ot[bt[wt]])yt.addDependency(ot[bt[wt]]);else{const Tt=new c.GlslLibRoutineNode(bt[wt]);ot[bt[wt]]=Tt,yt.addDependency(Tt)}}}}preprocess(){const it=this.context.programInfo;let st=it.shaderSource;return this.context.programInfo.hasMain||(st=`${st}
      ${(0,nt.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),st=(0,d.replaceInlines)(st),`${(0,nt.getFragShaderPreamble)(this.context.glContext.version)}
    ${this.getUniforms(it.inputNames,it.variables)}
    ${this.getImports(st)}
    ${st}`}getImports(it){const st=this.selectGlslLibRoutinesToBeIncluded(it);if(st.length===0)return"";let ut="";for(let ct=0;ct<st.length;++ct){if(!st[ct].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${st[ct].name}`);ut+=st[ct].routineBody+`
`}return ut}selectGlslLibRoutinesToBeIncluded(it){const st=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(ut=>{const ct=ut.split(".")[1];it.indexOf(ct)!==-1&&st.push(this.glslLibRoutineDependencyGraph[ut])}),c.TopologicalSortGlslRoutines.returnOrderedNodes(st)}getUniforms(it,st){const ut=[];if(it)for(const ct of it)ut.push(`uniform sampler2D ${ct};`);if(st)for(const ct of st)ut.push(`uniform ${ct.type} ${ct.name}${ct.arrayLength?`[${ct.arrayLength}]`:""};`);return ut.join(`
`)}}},5483:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.glslRegistry=void 0;const c=o(5107),d=o(7341),tt=o(9894),nt=o(2655),it=o(3891);a.glslRegistry={encoding:d.EncodingGlslLib,fragcolor:tt.FragColorGlslLib,vec:it.VecGlslLib,shapeUtils:nt.ShapeUtilsGlslLib,coordinates:c.CoordsGlslLib}},2655:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ShapeUtilsGlslLib=void 0;const c=o(8520);class d extends c.GlslLib{constructor(nt){super(nt)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const nt=this.context.outputTextureLayout.shape.length,it={};return this.context.programInfo.inputNames.forEach((st,ut)=>{const ct=this.context.inputTextureLayouts[ut].unpackedShape;if(ct.length<=nt){const ot=ct.length,at=nt-ot,ht=`bcastIndices_${st}`;let ft="";for(let yt=0;yt<ot;++yt)ft+=`
          realIndices[${yt}] = int( mod(float(bcastedIndices[${at+yt}]), ${ct[yt]}.0) );
          `;const mt=`
        void ${ht} (int bcastedIndices[${nt}], out int realIndices[${ot}]) {
          ${ft}
        }
        `;it[ht]=new c.GlslLibRoutine(mt)}}),it}bcastMatmulIndex(){const nt=this.context.outputTextureLayout.shape.length,it={};return this.context.programInfo.inputNames.forEach((st,ut)=>{const ct=this.context.inputTextureLayouts[ut].shape;if(!(ct.length<2||ct.length>nt)){const ot=ct.length,at=nt-ot,ht=`bcastMatmulIndices_${st}`;let ft="";for(let yt=0;yt<ot-2;++yt)ft+=`
          realIndices[${yt}] = int( mod(float(bcastedIndices[${at+yt}]), ${ct[yt]}.0) );
          `;const mt=`
        void ${ht}(int bcastedIndices[${nt}], out int realIndices[${ot}]) {
          ${ft}
          realIndices[${ot-1}] = bcastedIndices[${nt-1}];
          realIndices[${ot-2}] = bcastedIndices[${nt-2}];
        }
        `;it[ht]=new c.GlslLibRoutine(mt)}}),it}indicesToOffset(){const nt={};return this.context.programInfo.inputNames.forEach((it,st)=>{const ut=this.context.inputTextureLayouts[st].shape,ct=this.context.inputTextureLayouts[st].strides,ot=ut.length;let at=`indicesToOffset_${it}`;nt[at]=new c.GlslLibRoutine(d.indexToOffsetSingle(at,ot,ct)),at=`indicesToOffset_${it}_T`,nt[at]=new c.GlslLibRoutine(d.indexToOffsetSingle(at,ot,ct.slice().reverse()))}),nt}static indexToOffsetSingle(nt,it,st){let ut="";for(let ct=it-1;ct>=0;--ct)ut+=`
        offset += indices[${ct}] * ${st[ct]};
        `;return`
      int ${nt}(int indices[${it}]) {
        int offset = 0;
        ${ut}
        return offset;
      }
      `}offsetToIndices(){const nt={};return this.context.programInfo.inputNames.forEach((it,st)=>{const ut=this.context.inputTextureLayouts[st].shape,ct=this.context.inputTextureLayouts[st].strides,ot=ut.length;let at=`offsetToIndices_${it}`;nt[at]=new c.GlslLibRoutine(d.offsetToIndicesSingle(at,ot,ct)),at=`offsetToIndices_${it}_T`,nt[at]=new c.GlslLibRoutine(d.offsetToIndicesSingle(at,ot,ct.slice().reverse()))}),nt}static offsetToIndicesSingle(nt,it,st){const ut=[];for(let ct=0;ct<it-1;++ct)ut.push(`
      indices[${ct}] = offset / ${st[ct]};`),ut.push(`
        offset -= indices[${ct}] * ${st[ct]};`);return ut.push(`
      indices[${it-1}] = offset;`),`
      void ${nt}(int offset, out int indices[${it}]) {
        ${ut.join("")}
      }
      `}incrementIndices(){const nt={};return this.context.programInfo.inputNames.forEach((it,st)=>{const ut=this.context.inputTextureLayouts[st].shape,ct=ut.length,ot=`incrementIndices_${it}`;let at="";for(let ft=0;ft<ct;++ft)at+=`
        shape[${ft}] = ${ut[ft]};`;const ht=`
        void ${ot}(int axis, out int indices[${ct}]) {
          int shape[${ct}];
          ${at};
          for(int i = ${ct} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;nt[ot]=new c.GlslLibRoutine(ht)}),nt}}a.ShapeUtilsGlslLib=d},5060:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getDefaultFragShaderMain=a.getFragShaderPreamble=a.getVertexShaderSource=a.getGlsl=void 0;const o={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},c={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function d(tt){return tt===1?o:c}a.getGlsl=d,a.getVertexShaderSource=function(tt){const nt=d(tt);return`${nt.version}
      precision highp float;
      ${nt.attribute} vec3 position;
      ${nt.attribute} vec2 textureCoord;

      ${nt.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`},a.getFragShaderPreamble=function(tt){const nt=d(tt);return`${nt.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${nt.varyingFrag} vec2 TexCoords;
    ${nt.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `},a.getDefaultFragShaderMain=function(tt,nt){return`
  void main() {
    int indices[${nt}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${d(tt).output} = result;
  }
  `}},3891:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.VecGlslLib=void 0;const c=o(8520);class d extends c.GlslLib{constructor(nt){super(nt)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const nt=this.context.outputTextureLayout.shape.length,it={add:"+=",sub:"-=",mul:"*=",div:"/="},st={};for(const ut in it){const ct=`${ut}Vec`;let ot="";for(let ht=0;ht<nt;++ht)ot+=`
          dest[${ht}] ${it[ut]} src[${ht}];
          `;const at=`
        void ${ct}(int src[${nt}], out int dest[${nt}]) {
          ${ot}
        }
        `;st[ct]=new c.GlslLibRoutine(at)}return st}copyVec(){const nt=this.context.outputTextureLayout.shape.length;let it="";for(let ut=0;ut<nt;++ut)it+=`
        dest[${ut}] = src[${ut}];
        `;const st=`
      void copyVec(int src[${nt}], out int dest[${nt}]) {
        ${it}
      }
      `;return{copyVec:new c.GlslLibRoutine(st)}}setVecItem(){const nt=this.context.outputTextureLayout.shape.length;let it=`
        if(index < 0)
            index =${nt} + index;
        if (index == 0)
            m[0] = value;
        `;for(let ut=1;ut<nt-1;++ut)it+=`
        else if (index == ${ut})
            m[${ut}] = value;
            `;it+=`
        else
            m[${nt-1}] = value;
        `;const st=`
      void setVecItem(out int m[${nt}], int index, int value) {
        ${it}
      }
        `;return{setVecItem:new c.GlslLibRoutine(st)}}getVecItem(){const nt=this.context.outputTextureLayout.shape.length;let it=`
        if(index < 0)
            index = ${nt} + index;
        if (index == 0)
            return m[0];
      `;for(let ut=1;ut<nt-1;++ut)it+=`
        else if (index == ${ut})
            return m[${ut}];
      `;it+=`
        else
            return m[${nt-1}];
        `;const st=`
      int getVecItem(int m[${nt}], int index) {
        ${it}
      }
    `;return{getVecItem:new c.GlslLibRoutine(st)}}}a.VecGlslLib=d},8316:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WebGLInferenceHandler=void 0;const c=o(6231),d=o(9162),tt=o(2517),nt=o(2403),it=o(7019),st=o(8710),ut=o(5611),ct=o(4057),ot=o(2039);a.WebGLInferenceHandler=class{constructor(at){this.session=at,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(at,ht){return(0,ct.calculateTextureWidthAndHeight)(this.session.layoutStrategy,at,ht)}executeProgram(at,ht){if(ht.length<at.inputNames.length)throw new Error(`Input size mustn't be less than ${at.inputNames.length}.`);if(at.inputNames.length!==at.inputTypes.length)throw new Error("input names size does not match input types");const ft=[];for(let Ct=0;Ct<at.inputNames.length;++Ct)ft[Ct]=this.getOrCreateTextureData(ht[Ct],at.inputTypes[Ct]);const mt=((Ct,Dt)=>{const Ot=Dt.map(Ft=>`${Ft.unpackedShape.join(",")};${Ft.width}x${Ft.height}`).join("_");let $t=Ct.name;return Ct.cacheHint&&($t+="["+Ct.cacheHint+"]"),$t+=":"+Ot,$t})(at,ft);let yt=this.session.programManager.getArtifact(mt);const bt=yt?yt.programInfo:typeof at.get=="function"?at.get():at,wt=(0,ct.createTextureLayoutFromTextureType)(this.session.layoutStrategy,bt.output.dims,bt.output.textureType),Tt=this.createTextureData(wt,bt.output.type);return yt||(yt=this.session.programManager.build(bt,ft,Tt),this.session.programManager.setArtifact(mt,yt)),this.runProgram(yt,ft,Tt),Tt}run(at,ht){return this.executeProgram(at,ht).tensor}runProgram(at,ht,ft){for(let mt=0;mt<ht.length;++mt)if(!!ht[mt].isPacked!=(at.programInfo.inputTypes[mt]===ot.TextureType.packed))throw new Error(`input[${mt}] property packed inconsistent`);if(!!ft.isPacked!=(at.programInfo.output.textureType===ot.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(at,ht,ft)}getOrCreateTextureData(at,ht){let ft=this.getTextureData(at.dataId,ht===ot.TextureType.packed);if(!ft&&(ft=this.getTextureData(at.dataId,ht!==ot.TextureType.packed),ft))return ht===ot.TextureType.packed?this.pack(ft):this.unpack(ft);if(!ft){const mt=(0,ct.createTextureLayoutFromTextureType)(this.session.layoutStrategy,at.dims,ht);if(ht===ot.TextureType.packedLastDimension){const wt=at.dims;if(wt.length===4){const Tt=[wt[0],Math.ceil(wt[1]*wt[2]*wt[3]/4)],Ct=(0,ct.createTextureLayoutFromTextureType)(this.session.layoutStrategy,Tt,ht);let Dt=at.numberData;if(wt[1]*wt[2]*wt[3]%4!=0){const Ot=wt[0],$t=wt[1]*wt[2]*wt[3],Ft=Math.ceil($t*1/4)*4;Dt=new Float32Array(Ot*Ft);for(let kt=0;kt<Ot;++kt){const Vt=kt*$t,Ht=kt*Ft+kt%1*$t;Dt.set(at.numberData.subarray(Vt,Vt+$t),Ht)}}return this.createTextureData(Ct,at.type,Dt,at,1)}}if(ht===ot.TextureType.packed){const yt=(0,ct.createTextureLayoutFromShape)(this.session.layoutStrategy,at.dims,1,[],{reverseWH:!0}),bt=this.createTextureData(yt,at.type,at.numberData,at,1);ft=this.pack(bt)}else ft=this.createTextureData(mt,at.type,at.numberData,at,1)}return ft}createTextureDataFromLayoutBindTensor(at,ht,ft,mt){return this.createTextureData(at,ht,ft,mt,1)}createTextureData(at,ht,ft,mt,yt){c.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(at)}]`);const bt=this.session.textureManager.createTextureFromLayout(ht,at,ft,yt);return this.createTextureDataFromTexture(at,ht,bt,mt)}reshapeUnpacked(at,ht){const ft=this.getOrCreateTextureData(at,ot.TextureType.unpacked),mt={channels:ft.channels,height:ft.height,width:ft.width,shape:ht.length!==0?ht:[1],strides:tt.ShapeUtil.computeStrides(ht),unpackedShape:ht};return this.createTextureDataFromTexture(mt,at.type,ft.texture).tensor}reshapePacked(at,ht){const ft=this.getOrCreateTextureData(at,ot.TextureType.packed);if((0,it.isReshapeCheap)(at.dims,ht)){const Tt={channels:ft.channels,height:ft.height,width:ft.width,shape:ht.length!==0?ht:[1],strides:tt.ShapeUtil.computeStrides(ht),unpackedShape:ht,isPacked:!0};return this.createTextureDataFromTexture(Tt,at.type,ft.texture).tensor}const mt=(0,it.processDims3D)(at.dims),yt=(0,it.processDims3D)(ht),bt=this.reshapePacked(at,mt),wt=this.run((0,it.createPackedReshape3DProgramInfoLoader)(this,bt,yt),[bt]);return this.reshapePacked(wt,ht)}cast(at,ht){const ft=this.getOrCreateTextureData(at,ot.TextureType.unpacked);return this.createTextureDataFromTexture(ft,ht,ft.texture).tensor}createTextureDataFromTexture(at,ht,ft,mt,yt){const bt=Object.assign(Object.assign({},at),{tensor:mt||new d.Tensor(at.unpackedShape,ht,wt=>this.readTexture(bt),async wt=>this.readTextureAsync(bt),void 0,yt),texture:ft});return this.setTextureData(bt.tensor.dataId,bt,at.isPacked),bt}getTextureData(at,ht=!1){return this.session.isInitializer(at)?this.session.getTextureData(at,ht):ht?this.packedTextureDataCache.get(at):this.unpackedTextureDataCache.get(at)}setTextureData(at,ht,ft=!1){this.session.isInitializer(at)?this.session.setTextureData(at,ht,ft):(ft?this.packedTextureDataCache:this.unpackedTextureDataCache).set(at,ht)}isTextureLayoutCached(at,ht=!1){return!!this.getTextureData(at.dataId,ht)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(at=>this.session.textureManager.releaseTexture(at)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(at=>this.session.textureManager.releaseTexture(at)),this.unpackedTextureDataCache=new Map}readTexture(at){return at.isPacked?this.readTexture(this.unpack(at)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(at,at.tensor.type,at.channels):this.session.textureManager.readUint8TextureAsFloat((0,st.encodeAsUint8)(this,at))}async readTextureAsync(at){return at.isPacked?this.readTextureAsync(this.unpack(at)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(at,at.tensor.type,at.channels):this.session.textureManager.readUint8TextureAsFloat((0,st.encodeAsUint8)(this,at))}pack(at){return this.executeProgram((0,nt.createPackProgramInfoLoader)(this,at.tensor),[at.tensor])}unpack(at){return this.executeProgram((0,ut.createUnpackProgramInfoLoader)(this,at.tensor),[at.tensor])}}},1640:function(s,a,o){var c=this&&this.__createBinding||(Object.create?function(mr,Dr,kr,Yr){Yr===void 0&&(Yr=kr);var Mr=Object.getOwnPropertyDescriptor(Dr,kr);Mr&&!("get"in Mr?!Dr.__esModule:Mr.writable||Mr.configurable)||(Mr={enumerable:!0,get:function(){return Dr[kr]}}),Object.defineProperty(mr,Yr,Mr)}:function(mr,Dr,kr,Yr){Yr===void 0&&(Yr=kr),mr[Yr]=Dr[kr]}),d=this&&this.__setModuleDefault||(Object.create?function(mr,Dr){Object.defineProperty(mr,"default",{enumerable:!0,value:Dr})}:function(mr,Dr){mr.default=Dr}),tt=this&&this.__importStar||function(mr){if(mr&&mr.__esModule)return mr;var Dr={};if(mr!=null)for(var kr in mr)kr!=="default"&&Object.prototype.hasOwnProperty.call(mr,kr)&&c(Dr,mr,kr);return d(Dr,mr),Dr};Object.defineProperty(a,"__esModule",{value:!0}),a.WEBGL_OP_RESOLVE_RULES=void 0;const nt=o(2898),it=tt(o(7839)),st=o(4196),ut=o(2069),ct=o(8138),ot=o(9663),at=o(5193),ht=o(7992),ft=o(1253),mt=o(4776),yt=o(6572),bt=o(3346),wt=o(5623),Tt=o(2870),Ct=o(2143),Dt=o(4939),Ot=o(718),$t=o(2268),Ft=o(8117),kt=o(2278),Vt=o(5524),Ht=o(5975),Qt=o(3933),Xt=o(6558),Zt=o(5723),ar=o(3738),nr=tt(o(4909)),cr=o(8428),dr=o(9793);a.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",nr.abs],["Acos","","7+",nr.acos],["Add","","7+",it.add],["And","","7+",it.and],["Asin","","7+",nr.asin],["Atan","","7+",nr.atan],["AveragePool","","7+",Ct.averagePool,Ct.parseAveragePoolAttributes],["BatchNormalization","","7+",nt.batchNormalization,nt.parseBatchNormalizationAttributes],["Cast","","6+",st.cast,st.parseCastAttributes],["Ceil","","6+",nr.ceil],["Clip","","6-10",nr.clip,nr.parseClipAttributes],["Clip","","11+",nr.clipV11],["Concat","","4+",ut.concat,ut.parseConcatAttributes],["Conv","","1+",ct.conv,ct.parseConvAttributes],["ConvTranspose","","1+",ot.convTranspose,ot.parseConvTransposeAttributes],["Cos","","7+",nr.cos],["Div","","7+",it.div],["Dropout","","7+",nr.identity],["DepthToSpace","","1+",at.depthToSpace,at.parseDepthToSpaceAttributes],["Equal","","7+",it.equal],["Elu","","6+",nr.elu,nr.parseEluAttributes],["Exp","","6+",nr.exp],["Flatten","","1+",ht.flatten,ht.parseFlattenAttributes],["Floor","","6+",nr.floor],["FusedConv","com.microsoft","1+",ct.conv,ct.parseConvAttributes],["Gather","","1+",ft.gather,ft.parseGatherAttributes],["Gemm","","7-10",mt.gemm,mt.parseGemmAttributesV7],["Gemm","","11+",mt.gemm,mt.parseGemmAttributesV11],["GlobalAveragePool","","1+",Ct.globalAveragePool,Ct.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",Ct.globalMaxPool],["Greater","","7+",it.greater],["Identity","","1+",nr.identity],["ImageScaler","","1+",yt.imageScaler,yt.parseImageScalerAttributes],["InstanceNormalization","","6+",bt.instanceNormalization,bt.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",nr.leakyRelu,nr.parseLeakyReluAttributes],["Less","","7+",it.less],["Log","","6+",nr.log],["MatMul","","1+",wt.matMul,wt.parseMatMulAttributes],["MaxPool","","1+",Ct.maxPool,Ct.parseMaxPoolAttributes],["Mul","","7+",it.mul],["Neg","","6+",nr.neg],["Not","","1+",nr.not],["Or","","7+",it.or],["Pad","","2-10",Tt.padV2,Tt.parsePadAttributesV2],["Pad","","11+",Tt.padV11,Tt.parsePadAttributesV11],["Pow","","7+",it.pow],["PRelu","","7+",it.pRelu],["ReduceLogSum","","1+",Dt.reduceLogSum,Dt.parseReduceAttributes],["ReduceMax","","1+",Dt.reduceMax,Dt.parseReduceAttributes],["ReduceMean","","1+",Dt.reduceMean,Dt.parseReduceAttributes],["ReduceMin","","1+",Dt.reduceMin,Dt.parseReduceAttributes],["ReduceProd","","1+",Dt.reduceProd,Dt.parseReduceAttributes],["ReduceSum","","1-12",Dt.reduceSum,Dt.parseReduceAttributes],["ReduceSumSquare","","1+",Dt.reduceLogSumSquare,Dt.parseReduceAttributes],["Relu","","6+",nr.relu],["Reshape","","5+",Ot.reshape],["Resize","","10",$t.resize,$t.parseResizeAttributesV10],["Resize","","11+",$t.resize,$t.parseResizeAttributesV11],["Shape","","1+",Ft.shape],["Sigmoid","","6+",nr.sigmoid],["Sin","","7+",nr.sin],["Slice","","10+",kt.sliceV10],["Slice","","1-9",kt.slice,kt.parseSliceAttributes],["Softmax","","1-12",Vt.softmax,Vt.parseSoftmaxAttributes],["Softmax","","13+",Vt.softmaxV13,Vt.parseSoftmaxAttributesV13],["Split","","2-12",Ht.split,Ht.parseSplitAttributes],["Sqrt","","6+",nr.sqrt],["Squeeze","","1-12",Qt.squeeze,Qt.parseSqueezeAttributes],["Squeeze","","13+",Qt.squeezeV13],["Sub","","7+",it.sub],["Sum","","6+",Xt.sum],["Tan","","7+",nr.tan],["Tanh","","6+",nr.tanh],["Tile","","6+",Zt.tile],["Transpose","","1+",ar.transpose,ar.parseTransposeAttributes],["Upsample","","7-8",dr.upsample,dr.parseUpsampleAttributesV7],["Upsample","","9",dr.upsample,dr.parseUpsampleAttributesV9],["Unsqueeze","","1-12",cr.unsqueeze,cr.parseUnsqueezeAttributes],["Unsqueeze","","13+",cr.unsqueezeV13],["Xor","","7+",it.xor]]},2898:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseBatchNormalizationAttributes=a.batchNormalization=void 0;const c=o(246),d=o(5060),tt=o(2039),nt={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked]};a.batchNormalization=(ut,ct,ot)=>(st(ct),[ut.run(Object.assign(Object.assign({},nt),{cacheHint:ot.cacheKey,get:()=>it(ut,ct,ot)}),ct)]),a.parseBatchNormalizationAttributes=ut=>{const ct=ut.attributes.getFloat("epsilon",1e-5),ot=ut.attributes.getFloat("momentum",.9),at=ut.attributes.getInt("spatial",1);return(0,c.createAttributeWithCacheKey)({epsilon:ct,momentum:ot,spatial:at})};const it=(ut,ct,ot)=>{const at=(0,d.getGlsl)(ut.session.backend.glContext.version),ht=ct[0].dims.length,[ft,mt]=ut.calculateTextureWidthAndHeight(ct[1].dims,tt.TextureType.unpacked),yt=`
  float process(int[${ht}] indices) {
    vec2 position = offsetToCoords(indices[1], ${ft}, ${mt});
    float scale = getColorAsFloat(${at.texture2D}(Scale, position));
    float mean = getColorAsFloat(${at.texture2D}(Mean, position));
    float variance = getColorAsFloat(${at.texture2D}(Variance, position));
    float b = getColorAsFloat(${at.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${ot.epsilon})) ) + b;
  }`;return Object.assign(Object.assign({},nt),{output:{dims:ct[0].dims,type:ct[0].type,textureType:tt.TextureType.unpacked},shaderSource:yt})},st=ut=>{if(!ut||ut.length!==5)throw new Error("BatchNormalization requires 5 inputs.");const ct=ut[0],ot=ut[1],at=ut[2],ht=ut[3],ft=ut[4];if(ct.dims.length<3||ot.dims.length!==1||at.dims.length!==1||ht.dims.length!==1||ft.dims.length!==1)throw new Error("invalid input shape.");if(ot.dims[0]!==ct.dims[1]||at.dims[0]!==ct.dims[1]||ht.dims[0]!==ct.dims[1]||ft.dims[0]!==ct.dims[1])throw new Error("invalid input shape.");if(ct.type!=="float32"&&ct.type!=="float64"||ot.type!=="float32"&&ot.type!=="float64"||at.type!=="float32"&&at.type!=="float64"||ht.type!=="float32"&&ht.type!=="float64"||ft.type!=="float32"&&ft.type!=="float64")throw new Error("invalid input tensor types.")}},7839:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.xor=a.sub=a.pRelu=a.pow=a.or=a.mul=a.less=a.greater=a.equal=a.div=a.and=a.add=a.glslPRelu=a.glslPow=a.glslXor=a.glslOr=a.glslAnd=a.glslLess=a.glslGreater=a.glslEqual=a.glslSub=a.glslMul=a.glslDiv=a.glslAdd=void 0;const c=o(2517),d=o(8520),tt=o(5060),nt=o(2039);function it(){const Dt="add_";return{body:`
  float ${Dt}(float a, float b) {
    return a + b;
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function st(){const Dt="div_";return{body:`
  float ${Dt}(float a, float b) {
    return a / b;
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function ut(){const Dt="mul_";return{body:`
  float ${Dt}(float a, float b) {
    return a * b;
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function ct(){const Dt="sub_";return{body:`
  float ${Dt}(float a, float b) {
    return a - b;
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function ot(){const Dt="equal_";return{body:`
  float ${Dt}(float a, float b) {
    return float(a == b);
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function at(){const Dt="greater_";return{body:`
  float ${Dt}(float a, float b) {
    return float(a > b);
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function ht(){const Dt="less_";return{body:`
  float ${Dt}(float a, float b) {
    return float(a < b);
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function ft(){const Dt="and_";return{body:`
  float ${Dt}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function mt(){const Dt="or_";return{body:`
  float ${Dt}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function yt(){const Dt="xor_";return{body:`
  float ${Dt}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}function bt(){return function(Dt){const Ot=`${Dt}_`;return{body:`
  float ${Ot}(float a, float b) {
    return ${Dt}(a, b);
  }
  vec4 ${Ot}(vec4 v1, vec4 v2) {
    return ${Dt}(v1, v2);
  }
  `,name:Ot,type:d.FunctionType.ValueBased}}("pow")}function wt(){const Dt="prelu_";return{body:`
  float ${Dt}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${Dt}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:Dt,type:d.FunctionType.ValueBased}}a.glslAdd=it,a.glslDiv=st,a.glslMul=ut,a.glslSub=ct,a.glslEqual=ot,a.glslGreater=at,a.glslLess=ht,a.glslAnd=ft,a.glslOr=mt,a.glslXor=yt,a.glslPow=bt,a.glslPRelu=wt;const Tt=(Dt,Ot,$t,Ft=Ot[0].type,kt)=>{const Vt=Dt.session.pack?nt.TextureType.packed:nt.TextureType.unpacked;return{name:$t.name,inputNames:["A","B"],inputTypes:[Vt,Vt],cacheHint:kt,get:()=>Ct(Dt,Ot,$t,Ft)}},Ct=(Dt,Ot,$t,Ft=Ot[0].type)=>{const kt=Dt.session.pack?nt.TextureType.packed:nt.TextureType.unpacked,Vt=!c.ShapeUtil.areEqual(Ot[0].dims,Ot[1].dims);let Ht=Ot[0].dims;const Qt=Dt.session.pack;if(Vt){const ar=c.BroadcastUtil.calcShape(Ot[0].dims,Ot[1].dims,!1);if(!ar)throw new Error("Can't perform binary op on the given tensors");Ht=ar;const nr=Ht.length,cr=Ot[0].dims.length!==0?Ot[0].dims.length:1,dr=Ot[1].dims.length!==0?Ot[1].dims.length:1,mr=Ot[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",Dr=Ot[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",kr=(0,tt.getGlsl)(Dt.session.backend.glContext.version),Yr=Qt?`
      ${$t.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${$t.name}(a, b);
        ${kr.output} = result;
      }`:`
      ${$t.body}
      float process(int indices[${nr}]) {
        int aindices[${cr}];
        int bindices[${dr}];
        ${mr}
        ${Dr}
        return ${$t.name}(_A(aindices), _B(bindices));
      }`;return{name:$t.name,inputNames:["A","B"],inputTypes:[kt,kt],output:{dims:Ht,type:Ft,textureType:kt},shaderSource:Yr,hasMain:Qt}}const Xt=(0,tt.getGlsl)(Dt.session.backend.glContext.version),Zt=`
    ${$t.body}
    void main() {
      vec4 v1 = ${Xt.texture2D}(A, TexCoords);
      vec4 v2 = ${Xt.texture2D}(B, TexCoords);
      vec4 result = ${$t.name}(v1, v2);
      ${Xt.output} = result;
    }
    `;return{name:$t.name,inputNames:["A","B"],inputTypes:[kt,kt],output:{dims:Ot[0].dims,type:Ft,textureType:kt},shaderSource:Zt,hasMain:!0}};a.add=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,it()),Ot)],a.and=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,ft(),"bool"),Ot)],a.div=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,st()),Ot)],a.equal=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,ot(),"bool"),Ot)],a.greater=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,at(),"bool"),Ot)],a.less=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,ht(),"bool"),Ot)],a.mul=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,ut()),Ot)],a.or=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,mt(),"bool"),Ot)],a.pow=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,bt()),Ot)],a.pRelu=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,wt()),Ot)],a.sub=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,ct()),Ot)],a.xor=(Dt,Ot)=>[Dt.run(Tt(Dt,Ot,yt(),"bool"),Ot)]},4196:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseCastAttributes=a.cast=void 0;const c=o(2517);a.cast=(tt,nt,it)=>(d(nt),[tt.cast(nt[0],it)]),a.parseCastAttributes=tt=>c.ProtoUtil.tensorDataTypeFromProto(tt.attributes.getInt("to"));const d=tt=>{if(!tt||tt.length!==1)throw new Error("Cast requires 1 input.");if(tt[0].type==="string")throw new Error("Invalid input type.")}},1163:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createPackedConcatProgramInfoLoader=void 0;const c=o(5060),d=o(2039),tt=o(9390),nt=o(2827);a.createPackedConcatProgramInfoLoader=(st,ut,ct)=>{const ot=(at=ut.length,ht=ct.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:at},(ft,mt)=>`X${mt}`),inputTypes:Array(at).fill(d.TextureType.packed),cacheHint:ht});var at,ht;return Object.assign(Object.assign({},ot),{get:()=>((ft,mt,yt,bt)=>{const wt=yt[0].dims.slice();if(bt>=wt.length||bt<-1*wt.length)throw new Error("axis specified for concat doesn't match input dimensionality");bt<0&&(bt=wt.length+bt);const Tt=wt.slice(0);for(let mr=1;mr<yt.length;mr++){const Dr=yt[mr].dims.slice();for(let kr=0;kr<wt.length;kr++)if(kr===bt)Tt[bt]+=Dr[kr];else if(wt[kr]!==Dr[kr])throw new Error("non concat dimensions must match")}const Ct=Tt.length,Dt=(0,nt.getChannels)("coords",Ct),Ot=(0,tt.getCoordsDataType)(Ct),$t=(0,nt.unpackFromChannel)(),Ft=yt.map(mr=>mr.dims),kt=(0,tt.getGlChannels)(Ct),Vt=new Array(Ft.length-1);Vt[0]=Ft[0][bt];for(let mr=1;mr<Vt.length;mr++)Vt[mr]=Vt[mr-1]+Ft[mr][bt];const Ht=kt[bt],Qt=kt.slice(-2),Xt=kt.join();let Zt=`if (${Ht} < ${Vt[0]}) {
        return getChannel(
            getX0(${Xt}), vec2(${Qt.join()}));
        }`;for(let mr=1;mr<Vt.length;mr++){const Dr=Vt[mr-1];Zt+=`
            if (${Ht} < ${Vt[mr]}  && ${Ht} >= ${Vt[mr-1]}) {
              return getChannel(
                getX${mr}(${it(kt,Ht,Dr)}),
                vec2(${it(Qt,Ht,Dr)}));
            }`}const ar=Vt.length,nr=Vt[Vt.length-1];Zt+=`
            return getChannel(
              getX${ar}(${it(kt,Ht,nr)}),
              vec2(${it(Qt,Ht,nr)}));`;const cr=(0,c.getGlsl)(ft.session.backend.glContext.version),dr=`
          ${$t}
          float getValue(${kt.map(mr=>"int "+mr)}) {
            ${Zt}
          }

          void main() {
            ${Ot} coords = getOutputCoords();
            int lastDim = coords.${kt[Ct-1]};
            coords.${kt[Ct-1]} = coords.${kt[Ct-2]};
            coords.${kt[Ct-2]} = lastDim;

            vec4 result = vec4(getValue(${Dt}), 0., 0., 0.);

            ${Dt[Ct-1]} = ${Dt[Ct-1]} + 1;
            if (${Dt[Ct-1]} < ${Tt[Ct-1]}) {
              result.g = getValue(${Dt});
            }

            ${Dt[Ct-2]} = ${Dt[Ct-2]} + 1;
            if (${Dt[Ct-2]} < ${Tt[Ct-2]}) {
              result.a = getValue(${Dt});
            }

            ${Dt[Ct-1]} = ${Dt[Ct-1]} - 1;
            if (${Dt[Ct-2]} < ${Tt[Ct-2]} &&
                ${Dt[Ct-1]} < ${Tt[Ct-1]}) {
              result.b = getValue(${Dt});
            }
            ${cr.output} = result;
          }
        `;return Object.assign(Object.assign({},mt),{output:{dims:Tt,type:yt[0].type,textureType:d.TextureType.packed},shaderSource:dr,hasMain:!0})})(st,ot,ut,ct.axis)})};const it=(st,ut,ct)=>{const ot=st.indexOf(ut);return st.map((at,ht)=>ht===ot?`${at} - ${ct}`:at).join()}},2069:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseConcatAttributes=a.concat=void 0;const c=o(246),d=o(2039),tt=o(1163);a.concat=(at,ht,ft)=>(ot(ht),at.session.pack&&ht[0].dims.length>1?[at.run((0,tt.createPackedConcatProgramInfoLoader)(at,ht,ft),ht)]:[at.run(nt(at,ht,ft),ht)]);const nt=(at,ht,ft)=>{const mt=(yt=ht.length,bt=ft.cacheKey,{name:"Concat",inputNames:Array.from({length:yt},(wt,Tt)=>`X${Tt}`),inputTypes:Array(yt).fill(d.TextureType.unpacked),cacheHint:bt});var yt,bt;return Object.assign(Object.assign({},mt),{get:()=>((wt,Tt,Ct,Dt)=>{const Ot=Ct[0].dims.slice();if(Dt>=Ot.length||Dt<-1*Ot.length)throw new Error("axis specified for concat doesn't match input dimensionality");Dt<0&&(Dt=Ot.length+Dt);const $t=Ot.slice(0);for(let Xt=1;Xt<Ct.length;Xt++){const Zt=Ct[Xt].dims.slice();for(let ar=0;ar<Ot.length;ar++)if(ar===Dt)$t[Dt]+=Zt[ar];else if(Ot[ar]!==Zt[ar])throw new Error("non concat dimensions must match")}const Ft=$t.length,kt=new Array(Ct.length);let Vt=0;for(let Xt=0;Xt<kt.length;++Xt)Vt+=Ct[Xt].dims[Dt],kt[Xt]=Vt;let Ht="";Ht=Ct.length<5?it(kt):st(kt);const Qt=`
        ${ut(Ct.length,Ft)}
        ${ct(kt)}
        ${Ht}
        float process(int indices[${Ft}]) {
          int textureIndex = getTextureWhereDataResides (indices[${Dt}]);

          if(textureIndex != 0) {
            indices[${Dt}] = indices[${Dt}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return Object.assign(Object.assign({},Tt),{output:{dims:$t,type:Ct[0].type,textureType:d.TextureType.unpacked},shaderSource:Qt})})(0,mt,ht,ft.axis)})},it=at=>`int getTextureWhereDataResides(int index) {
      ${at.map((ht,ft)=>`if(index<${ht}) {return ${ft};}
`).join("")}
    }`,st=at=>it(at),ut=(at,ht)=>{const ft=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${ht}]) {`];for(let mt=0;mt<at;++mt)mt===0?ft.push(`	if (textureIndex == ${mt}) { return _X${mt}(indices); }`):mt===at-1?ft.push(`	else { return _X${mt}(indices); }`):ft.push(`	else if (textureIndex == ${mt}) { return _X${mt}(indices); }`);return ft.push("	}"),ft.join(`
`)},ct=at=>{const ht=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let ft=0;ft<at.length;++ft)ft===0?ht.push(`	if (index == ${ft}) { return ${at[ft]}; }`):ft===at.length-1?ht.push(`	else { return ${at[ft]}; }`):ht.push(`	else if (index == ${ft}) { return ${at[ft]}; }`);return ht.push("	}"),ht.join(`
`)};a.parseConcatAttributes=at=>(0,c.createAttributeWithCacheKey)({axis:at.attributes.getInt("axis")});const ot=at=>{if(!at||at.length<1)throw new Error("too few inputs");const ht=at[0].type,ft=at[0].dims.length;if(ht==="string")throw new Error("string tensor is not supported yet");for(const mt of at){if(mt.type!==ht)throw new Error("input tensors should be one type");if(mt.dims.length!==ft)throw new Error("input tensors should have the same shape")}}},4770:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createUnpackedGroupedConvProgramInfoLoader=void 0;const c=o(6231),d=o(5060),tt=o(2039),nt=o(8138),it=o(2823);a.createUnpackedGroupedConvProgramInfoLoader=(st,ut,ct)=>{const ot=(at=ut.length>2,ht=ct.cacheKey,{name:"GroupedConv",inputNames:at?["X","W","Bias"]:["X","W"],inputTypes:at?[tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked]:[tt.TextureType.unpacked,tt.TextureType.unpacked],cacheHint:ht});var at,ht;return Object.assign(Object.assign({},ot),{get:()=>((ft,mt,yt,bt)=>{const wt=mt.length>2?"value += getBias(output_channel);":"",Tt=mt[0].dims.slice(),Ct=mt[1].dims.slice(),Dt=Ct[0]/bt.group;c.Logger.verbose("GroupedConv",`autpPad:${bt.autoPad}, dilations:${bt.dilations}, group:${bt.group}, kernelShape:${bt.kernelShape}, pads:${bt.pads}, strides:${bt.strides}`);const Ot=(0,nt.calculateOutputShape)(Tt,Ct,bt.dilations,bt.pads,bt.strides),$t=(0,d.getGlsl)(ft.session.backend.glContext.version),{activationFunction:Ft,applyActivation:kt}=(0,it.getActivationSnippet)(bt),Vt=`
  const ivec2 strides = ivec2(${bt.strides[0]}, ${bt.strides[1]});
  const ivec2 pads = ivec2(${bt.pads[0]}, ${bt.pads[1]});
  ${Ft}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${Dt};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${Ct[1]}; wInChannel++) {
      int input_channel = group_id * ${Ct[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${Ct[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${bt.dilations[0]};

        if (xHeight < 0 || xHeight >= ${Tt[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${Ct[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${bt.dilations[1]};
          if (xWidth < 0 || xWidth >= ${Tt[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${wt}
    ${kt}
    ${$t.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},yt),{output:{dims:Ot,type:mt[0].type,textureType:tt.TextureType.unpacked},shaderSource:Vt,hasMain:!0})})(st,ut,ot,ct)})}},1386:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.conv2DPacked=a.conv2DPackedPointwise=void 0;const c=o(8138),d=o(8555),tt=o(708);a.conv2DPackedPointwise=(nt,it,st)=>{const ut=it[0].dims,ct=it[1].dims,ot=(0,c.calculateOutputShape)(ut,ct,st.dilations,st.pads,st.strides),at=nt.reshapePacked(it[0],[ut[1],ut[2]*ut[3]]),ht=nt.reshapePacked(it[1],[ct[0],ct[1]]),ft=it.length>2?[ht,at,it[2]]:[ht,at],mt=nt.run((0,tt.createPackedMatmulProgramInfoLoader)(nt,ft,st),ft);return nt.reshapePacked(mt,ot)},a.conv2DPacked=(nt,it,st)=>{const ut=it[0].dims,ct=it[1].dims,ot=(0,c.calculateOutputShape)(ut,ct,st.dilations,st.pads,st.strides),at=nt.run((0,d.createPackedIm2ColProgramInfoLoader)(nt,it[0],it[1],ot,st),[it[0]]),ht=nt.reshapePacked(it[1],[ct[0],ct[1]*ct[2]*ct[3]]),ft=it.length===3?[ht,at,it[2]]:[ht,at],mt=nt.run((0,tt.createPackedMatmulProgramInfoLoader)(nt,ft,st),ft);return nt.reshapePacked(mt,ot)}},9663:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseConvTransposeAttributes=a.convTranspose=void 0;const c=o(246),d=o(5060),tt=o(2039),nt=o(2823),it=(ht,ft,mt,yt,bt,wt)=>(ht-1)*ft+mt+(yt-1)*bt+1-wt,st=(ht,ft,mt,yt,bt)=>{const wt=Math.floor(ht/2);ft==="SAME_UPPER"?(mt[yt]=wt,mt[bt]=ht-wt):ft==="SAME_LOWER"&&(mt[yt]=ht-wt,mt[bt]=wt)};a.convTranspose=(ht,ft,mt)=>(at(ft,mt),ut(ht,ft,mt));const ut=(ht,ft,mt)=>{const yt=ot(mt,ft);return[ct(ht,ft,yt)]},ct=(ht,ft,mt)=>ht.run(((yt,bt,wt)=>{const Tt=(Ct=bt.length>2,Dt=wt.cacheKey,{name:"ConvTranspose",inputNames:Ct?["X","W","B"]:["X","W"],inputTypes:Ct?[tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked]:[tt.TextureType.unpacked,tt.TextureType.unpacked],cacheHint:Dt});var Ct,Dt;return Object.assign(Object.assign({},Tt),{get:()=>((Ot,$t,Ft,kt)=>{const Vt=$t.length>2?"getB(output_channel)":"0.0",Ht=$t[0].dims,Qt=$t[1].dims,Xt=Qt[1],Zt=Qt[0]/kt.group,ar=[$t[0].dims[0],$t[1].dims[1]*kt.group,...kt.outputShape],nr=(0,d.getGlsl)(Ot.session.backend.glContext.version),{activationFunction:cr,applyActivation:dr}=(0,nt.getActivationSnippet)(kt),mr=`
  const ivec2 strides = ivec2(${kt.strides[0]}, ${kt.strides[1]});
  const ivec2 pads = ivec2(${kt.pads[0]}, ${kt.pads[1]});
  ${cr}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${Xt};
    int wOutChannel = output_channel - group_id * ${Xt};

    float value = ${Vt};
    for (int inChannelOffset = 0; inChannelOffset < ${Zt}; inChannelOffset++) {
      int input_channel = group_id * ${Zt} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${Qt[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${Qt[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${kt.dilations[0]}, wHOff * ${kt.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${Ht[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${Ht[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${dr}
    ${nr.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},Ft),{output:{dims:ar,type:$t[0].type,textureType:tt.TextureType.unpacked},shaderSource:mr,hasMain:!0})})(yt,bt,Tt,wt)})})(ht,ft,mt),ft),ot=(ht,ft)=>{const mt=ht.kernelShape.slice();if(ht.kernelShape.length===0)for(let Tt=2;Tt<ft[1].dims.length;++Tt)mt.push(ft[1].dims[Tt]);const yt=ht.pads.slice(),bt=ht.outputShape.slice();((Tt,Ct,Dt,Ot,$t,Ft,kt,Vt)=>{const Ht=Tt.length-2,Qt=Vt.length===0;for(let Xt=0;Xt<Ht;++Xt){const Zt=Qt?Tt[Xt+2]*Ft[Xt]:Vt[Xt],ar=it(Tt[Xt+2],Ft[Xt],$t[Xt],Ct[Xt],Dt[Xt],Zt);st(ar,Ot,$t,Xt,Xt+Ht),Qt&&Vt.push(Ft[Xt]*(Tt[Xt+2]-1)+kt[Xt]+(Ct[Xt]-1)*Dt[Xt]+1-$t[Xt]-$t[Xt+Ht])}})(ft[0].dims,mt,ht.dilations,ht.autoPad,yt,ht.strides,ht.outputPadding,bt);const wt=Object.assign({},ht);return Object.assign(wt,{kernelShape:mt,pads:yt,outputShape:bt,cacheKey:ht.cacheKey}),wt};a.parseConvTransposeAttributes=ht=>{const ft=ht.attributes,mt=(0,nt.parseInternalActivationAttributes)(ft),yt=ft.getString("auto_pad","NOTSET"),bt=ft.getInts("dilations",[1,1]),wt=ft.getInt("group",1),Tt=ft.getInts("kernel_shape",[]),Ct=ft.getInts("output_padding",[0,0]),Dt=ft.getInts("output_shape",[]),Ot=ft.getInts("pads",[0,0,0,0]),$t=ft.getInts("strides",[1,1]);return(0,c.createAttributeWithCacheKey)(Object.assign({autoPad:yt,dilations:bt,group:wt,kernelShape:Tt,outputPadding:Ct,outputShape:Dt,pads:Ot,strides:$t},mt))};const at=(ht,ft)=>{if(!ht||ht.length!==2&&ht.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(ht[0].dims.length!==4||ht[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(ht[0].dims[1]!==ht[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const mt=ht[1].dims[1]*ft.group;if(ht.length===3&&(ht[2].dims.length!==1||ht[2].dims[0]!==mt))throw new Error("invalid bias");const yt=ht[0].dims.length-2;if(ft.dilations.length!==yt)throw new Error(`dilations should be ${yt}D`);if(ft.strides.length!==yt)throw new Error(`strides should be ${yt}D`);if(ft.pads.length!==2*yt)throw new Error(`pads should be ${2*yt}D`);if(ft.outputPadding.length!==yt)throw new Error(`output_padding should be ${yt}D`);if(ft.kernelShape.length!==0&&ft.kernelShape.length!==ht[1].dims.length-2)throw new Error("invalid kernel shape");if(ft.outputShape.length!==0&&ft.outputShape.length!==ht[0].dims.length-2)throw new Error("invalid output shape");if(ht[0].type!=="float32"||ht[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(ht.length===3&&ht[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}},8138:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseConvAttributes=a.conv=a.calculateOutputShape=void 0;const c=o(246),d=o(2517),tt=o(4770),nt=o(1386),it=o(9828),st=o(2823),ut=o(3248),ct=o(5623);a.calculateOutputShape=(yt,bt,wt,Tt,Ct)=>{const Dt=yt[0],Ot=yt.slice(2),$t=Ot.length,Ft=bt[0],kt=bt.slice(2).map((Ht,Qt)=>Ht+(Ht-1)*(wt[Qt]-1)),Vt=Ot.map((Ht,Qt)=>Ht+Tt[Qt]+Tt[Qt+$t]).map((Ht,Qt)=>Math.floor((Ht-kt[Qt]+Ct[Qt])/Ct[Qt]));return[Dt,Ft].concat(...Vt)},a.conv=(yt,bt,wt)=>(mt(bt,wt),ot(yt,bt,wt));const ot=(yt,bt,wt)=>{const Tt=ft(wt,bt),Ct=yt.session.pack,Dt=Tt.kernelShape[0]===1&&Tt.kernelShape[1]===1;return Tt.group>1?[yt.run((0,tt.createUnpackedGroupedConvProgramInfoLoader)(yt,bt,Tt),bt)]:Dt&&Ct?[at(yt,bt,Tt)]:Ct&&bt[0].dims.length===4&&bt[0].dims[0]===1&&!Dt?[(0,nt.conv2DPacked)(yt,bt,Tt)]:[ht(yt,bt,Tt)]},at=(yt,bt,wt)=>{const Tt=bt[0].dims,Ct=bt[1].dims,Dt=(0,a.calculateOutputShape)(Tt,Ct,wt.dilations,wt.pads,wt.strides),Ot=yt.reshapeUnpacked(bt[0],[Tt[1],Tt[2]*Tt[3]]),$t=yt.reshapeUnpacked(bt[1],[Ct[0],Ct[1]]),Ft=bt.length>2?[$t,Ot,bt[2]]:[$t,Ot],kt=yt.run((0,ct.createMatmulProgramInfoLoader)(Ft,wt),Ft);return yt.reshapeUnpacked(kt,Dt)},ht=(yt,bt,wt)=>{const Tt=bt[0].dims,Ct=bt[1].dims,Dt=(0,a.calculateOutputShape)(Tt,Ct,wt.dilations,wt.pads,wt.strides),Ot=yt.run((0,ut.createIm2ColProgramInfoLoader)(yt,bt[0],bt[1],Dt,wt),[bt[0]]),$t=bt.length===3?[Ot,bt[1],bt[2]]:[Ot,bt[1]];return yt.run((0,it.createDotProductProgramInfoLoader)(yt,bt,Dt,wt),$t)},ft=(yt,bt)=>{const wt=yt.kernelShape.slice();if(yt.kernelShape.length===0)for(let Dt=2;Dt<bt[1].dims.length;++Dt)wt.push(bt[1].dims[Dt]);const Tt=yt.pads.slice();d.PoolConvUtil.adjustPadsBasedOnAutoPad(bt[0].dims,yt.strides,yt.dilations,wt,Tt,yt.autoPad);const Ct=Object.assign({},yt);return Object.assign(Ct,{kernelShape:wt,pads:Tt,cacheKey:yt.cacheKey}),Ct};a.parseConvAttributes=yt=>{const bt=yt.attributes,wt=(0,st.parseInternalActivationAttributes)(bt),Tt=bt.getString("auto_pad","NOTSET"),Ct=bt.getInts("dilations",[1,1]),Dt=bt.getInt("group",1),Ot=bt.getInts("kernel_shape",[]),$t=bt.getInts("pads",[0,0,0,0]),Ft=bt.getInts("strides",[1,1]);return(0,c.createAttributeWithCacheKey)(Object.assign({autoPad:Tt,dilations:Ct,group:Dt,kernelShape:Ot,pads:$t,strides:Ft},wt))};const mt=(yt,bt)=>{if(!yt||yt.length!==2&&yt.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(yt[0].dims.length!==4||yt[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(yt[0].dims[1]!==yt[1].dims[1]*bt.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(yt.length===3&&(yt[2].dims.length!==1||yt[1].dims[0]!==yt[2].dims[0]))throw new Error("invalid bias");const wt=yt[0].dims.length-2;if(bt.dilations.length!==wt)throw new Error(`dilations should be ${wt}D`);if(bt.strides.length!==wt)throw new Error(`strides should be ${wt}D`);if(bt.pads.length!==2*wt)throw new Error(`pads should be ${2*wt}D`);if(bt.kernelShape.length!==0&&bt.kernelShape.length!==yt[1].dims.length-2)throw new Error("invalid kernel shape");if(yt[0].type!=="float32"||yt[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(yt.length===3&&yt[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}},5193:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseDepthToSpaceAttributes=a.depthToSpace=void 0;const c=o(3738);a.depthToSpace=(tt,nt,it)=>{d(nt);const st=it.blocksize,ut=st*st,ct=it.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],ot=it.mode==="DCR"?[nt[0].dims[0],st,st,nt[0].dims[1]/ut,nt[0].dims[2],nt[0].dims[3]]:[nt[0].dims[0],nt[0].dims[1]/ut,st,st,nt[0].dims[2],nt[0].dims[3]],at=tt.reshapeUnpacked(nt[0],ot),ht={perm:ct,cacheKey:`${ct}`},[ft]=(0,c.transpose)(tt,[at],ht),mt=[nt[0].dims[0],nt[0].dims[1]/ut,nt[0].dims[2]*st,nt[0].dims[3]*st];return[tt.reshapeUnpacked(ft,mt)]},a.parseDepthToSpaceAttributes=tt=>{const nt=tt.attributes.getInt("blocksize");if(nt<1)throw new Error(`blocksize must be >= 1, but got : ${nt} for DepthToSpace`);const it=tt.attributes.getString("mode","DCR");if(it!=="DCR"&&it!=="CRD")throw new Error(`unrecognized mode: ${it} for DepthToSpace`);return{mode:it,blocksize:nt}};const d=tt=>{if(tt.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${tt.length}`);if(tt[0].type==="string"||tt[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},9828:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createDotProductProgramInfoLoader=void 0;const c=o(2517),d=o(5060),tt=o(2039),nt=o(2823),it=o(3248);a.createDotProductProgramInfoLoader=(st,ut,ct,ot)=>{const at=((ht,ft)=>({name:"ConvDotProduct",inputNames:ht?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:ht?[tt.TextureType.unpacked,tt.TextureType.packedLastDimension,tt.TextureType.unpacked]:[tt.TextureType.unpacked,tt.TextureType.packedLastDimension],cacheKey:ft.activationCacheKey}))(ut.length>2,ot);return Object.assign(Object.assign({},at),{get:()=>((ht,ft,mt,yt,bt)=>{const wt=mt[0].dims,Tt=mt[1].dims,Ct=[Tt[0],Math.ceil(wt[1]*Tt[2]*Tt[3]/4)],Dt=(0,it.calculateIm2ColDims)(wt,Tt,yt),[Ot,$t]=ht.calculateTextureWidthAndHeight(Ct,tt.TextureType.packedLastDimension),Ft=c.ShapeUtil.computeStrides(Dt),[kt,Vt]=ht.calculateTextureWidthAndHeight(Dt,tt.TextureType.packedLastDimension),Ht=yt.length,Qt=mt.length<3?"0.0":"_B(b)",Xt=Math.ceil(wt[1]*Tt[2]*Tt[3]/4),{activationFunction:Zt,applyActivation:ar}=(0,nt.getActivationSnippet)(bt),nr=(0,d.getGlsl)(ht.session.backend.glContext.version),cr=`
${Zt}
float process(int indices[${Ht}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${Ft[0]} + im2col[1] * ${Ft[1]} + im2col[2] * ${Ft[2]};
  int kernelOffset = indices[1] * ${Ct[1]};
  float value = ${Qt};
  for (int i = 0; i < ${Xt}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${kt}, ${Vt});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${Ot}, ${$t});
    value += dot(${nr.texture2D}(Im2Col, im2colCoords), ${nr.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${ar}
  return value;
}`;return Object.assign(Object.assign({},ft),{output:{dims:yt,type:mt[0].type,textureType:tt.TextureType.unpacked},shaderSource:cr})})(st,at,ut,ct,ot)})}},7992:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseFlattenAttributes=a.flatten=void 0;const c=o(2517);a.flatten=(tt,nt,it)=>{d(nt,it);const st=c.ShapeUtil.flattenShape(nt[0].dims,it);return[tt.reshapeUnpacked(nt[0],st)]},a.parseFlattenAttributes=tt=>tt.attributes.getInt("axis",1);const d=(tt,nt)=>{if(!tt||tt.length!==1)throw new Error("Flatten requires 1 input.");const it=tt[0].dims.length;if(it===0)throw new Error("scalar tensor is not supported.");if(nt<-it||nt>it)throw new Error("Invalid axis");if(tt[0].type==="string")throw new Error("string tensor is not supported.")}},2823:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseInternalActivationAttributes=a.getActivationSnippet=void 0;const c=o(2517),d=o(4909);a.getActivationSnippet=function(tt){let nt;switch(tt.activation){case"Relu":nt=(0,d.glslRelu)();break;case"Sigmoid":nt=(0,d.glslSigmoid)();break;case"Clip":nt=(0,d.glslClip)(tt.clipMin,tt.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const it=nt.name;return{activationFunction:nt.body,applyActivation:`value = ${it}_(value);`}},a.parseInternalActivationAttributes=tt=>{const nt=tt.getString("activation","");if(nt==="Clip"){const[it,st]=tt.getFloats("activation_params",[c.MIN_CLIP,c.MAX_CLIP]);return{activation:nt,clipMax:st,clipMin:it,activationCacheKey:`${nt}:${it},${st}`}}return{activation:nt,activationCacheKey:nt}}},1253:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseGatherAttributes=a.gather=void 0;const c=o(246),d=o(782),tt=o(2517),nt=o(2039);a.gather=(ct,ot,at)=>(ut(ot,at.axis),[ct.run(st(ct,ot,at),ot)]),a.parseGatherAttributes=ct=>(0,c.createAttributeWithCacheKey)({axis:ct.attributes.getInt("axis",0)});const it={name:"Gather",inputNames:["A","B"],inputTypes:[nt.TextureType.unpacked,nt.TextureType.unpacked]},st=(ct,ot,at)=>{const ht=Object.assign(Object.assign({},it),{cacheHint:at.cacheKey});return Object.assign(Object.assign({},ht),{get:()=>((ft,mt,yt,bt)=>{const wt=yt[0].dims.slice(),Tt=yt[1].dims.slice(),Ct=new Array(wt.length+Tt.length-1);bt=tt.ShapeUtil.normalizeAxis(bt,wt.length);const Dt=[];for(let $t=0;$t<Ct.length;$t++)$t<bt?(Ct[$t]=wt[$t],Dt.push(`inputIdx[${$t}] = outputIdx[${$t}];`)):$t<bt+Tt.length?(Ct[$t]=Tt[$t-bt],Dt.push(`indexDataIdx[${$t-bt}] = outputIdx[${$t}];`)):(Ct[$t]=wt[$t-Tt.length+1],Dt.push(`inputIdx[${$t-Tt.length+1}] = outputIdx[${$t}];`));const Ot=`
      float process(int outputIdx[${Ct.length||1}]) {
        int inputIdx[${wt.length}];
        int indexDataIdx[${Tt.length||1}];
        indexDataIdx[0] = 0;
        ${Dt.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${bt}] = idx < 0 ? idx + ${wt[bt]} : idx;
        return _A(inputIdx);
      }`;return Object.assign(Object.assign({},mt),{output:{dims:Ct,type:yt[0].type,textureType:nt.TextureType.unpacked},shaderSource:Ot})})(0,ht,ot,at.axis)})},ut=(ct,ot)=>{if(!ct||ct.length!==2)throw new Error("Gather requires 2 inputs.");const at=ct[0].dims.length;if(at<1)throw new Error("Invalid input shape.");if(ot<-at||ot>at-1)throw new Error("Invalid axis.");if(d.NUMBER_TYPES.indexOf(ct[0].type)===-1)throw new Error("Invaid input type.");if(ct[1].type!=="int32"&&ct[1].type!=="int16")throw new Error("Invaid input type.")}},4776:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseGemmAttributesV11=a.parseGemmAttributesV7=a.gemm=void 0;const c=o(246),d=o(2517),tt=o(2039);a.gemm=(ct,ot,at)=>(ut(ot,at),[ct.run(it(ot,at),ot)]);const nt=(ct,ot)=>{const at=ct.attributes.getInt("transA",0)!==0,ht=ct.attributes.getInt("transB",0)!==0,ft=ct.attributes.getFloat("alpha",1),mt=ct.attributes.getFloat("beta",1);return(0,c.createAttributeWithCacheKey)({transA:at,transB:ht,alpha:ft,beta:mt,isOptionalC:ot})};a.parseGemmAttributesV7=ct=>nt(ct,!1),a.parseGemmAttributesV11=ct=>nt(ct,!0);const it=(ct,ot)=>{const at={name:"Gemm",inputNames:ct.length===3?["A","B","C"]:["A","B"],inputTypes:ct.length===3?[tt.TextureType.unpacked,tt.TextureType.unpacked,tt.TextureType.unpacked]:[tt.TextureType.unpacked,tt.TextureType.unpacked],key:ot.cacheKey};return Object.assign(Object.assign({},at),{get:()=>st(at,ct,ot)})},st=(ct,ot,at)=>{const ht=ot[0].dims.slice(),ft=ot[1].dims.slice(),[mt,yt]=d.GemmUtil.getShapeOfGemmResult(ht,at.transA,ft,at.transB,ot.length===3?ot[2].dims:void 0),bt=[mt,yt];if(!bt)throw new Error("Can't use gemm on the given tensors");let wt=ht[ht.length-1],Tt="";at.transA&&(wt=ht[0]),at.transA&&at.transB?Tt="value += _A_T(a) * _B_T(b);":at.transA&&!at.transB?Tt="value += _A_T(a) * _B(b);":!at.transA&&at.transB?Tt="value += _A(a) * _B_T(b);":at.transA||at.transB||(Tt="value += _A(a) * _B(b);");const Ct=bt.length,Dt=`
      float process(int indices[${Ct}]) {
          int a[${Ct}];
          int b[${Ct}];
          ${ot.length===3?`int c[${ot[2].dims.length}];`:""}

          copyVec(indices, a);
          copyVec(indices, b);
          ${ot.length===3?"bcastIndices_C(indices, c);":""}

          float value = 0.0;
          for (int k=0; k<${wt}; ++k) {
              a[${Ct-1}] = k;
              b[${Ct-2}] = k;
              ${Tt}
          }

          value = value * alpha;
          ${ot.length===3?"value += beta * _C(c);":""}
          return value;
      }`;return Object.assign(Object.assign({},ct),{output:{dims:bt,type:ot[0].type,textureType:tt.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:at.alpha},{name:"beta",type:"float",data:at.beta}],shaderSource:Dt})},ut=(ct,ot)=>{if(!ct)throw new Error("Input is missing");if(ot.isOptionalC&&(ct.length<2||ct.length>3))throw new Error("Invaid input shape.");if(!ot.isOptionalC&&ct.length!==3)throw new Error("Gemm requires 3 inputs");if(ct.length===3&&ct[2].dims.length!==1&&ct[2].dims.length!==2)throw new Error("Invalid input shape of C");if(ct[0].type!=="float32"&&ct[0].type!=="float64"||ct[1].type!=="float32"&&ct[1].type!=="float64"||ct.length===3&&ct[2].type!=="float32"&&ct[2].type!=="float64")throw new Error("Invalid input type.");if(ct[0].type!==ct[1].type||ct.length===3&&ct[0].type!==ct[2].type)throw new Error("Input types are mismatched")}},8555:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createPackedIm2ColProgramInfoLoader=void 0;const c=o(5060),d=o(2039),tt=o(2827);a.createPackedIm2ColProgramInfoLoader=(nt,it,st,ut,ct)=>{const ot=(at=ct.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[d.TextureType.packed],cacheHint:at});var at;return Object.assign(Object.assign({},ot),{get:()=>((ht,ft,mt,yt,bt,wt)=>{const Tt=mt.dims,Ct=yt.dims,Dt=bt.length,Ot=[Ct[1]*Ct[2]*Ct[3],bt[2]*bt[3]],$t=Ct[2]*Ct[3],Ft=(0,tt.unpackFromChannel)(),kt=(0,c.getGlsl)(ht.session.backend.glContext.version);let Vt="";for(let Qt=0;Qt<=1;Qt++)for(let Xt=0;Xt<=1;Xt++)Vt+=`
            blockIndex = rc.x + ${Xt};
            pos = rc.y + ${Qt};

            if(blockIndex < ${Ot[1]} && pos < ${Ot[0]}) {
              offsetY = int(blockIndex / (${bt[Dt-1]})) * ${wt.strides[0]} -
                ${wt.pads[0]};
              d0 = offsetY + ${wt.dilations[0]} * (imod(pos, ${$t}) / ${Ct[2]});

              if(d0 < ${Tt[2]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${bt[Dt-1]}) * ${wt.strides[1]} -
                  ${wt.pads[1]};
                d1 = offsetX + ${wt.dilations[1]} * imod(imod(pos, ${$t}), ${Ct[2]});

                if(d1 < ${Tt[3]} && d1 >= 0) {

                  ch = int(float(pos)/ ${$t}.);
                    innerDims = vec2(d0, d1);
                    result[${2*Qt+Xt}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;const Ht=`
      ${Ft}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${Vt}
          ${kt.output} = result;
      }
            `;return Object.assign(Object.assign({},ft),{output:{dims:Ot,type:mt.type,textureType:d.TextureType.packed},shaderSource:Ht,hasMain:!0})})(nt,ot,it,st,ut,ct)})}},3248:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.calculateIm2ColDims=a.createIm2ColProgramInfoLoader=void 0;const c=o(2039);a.createIm2ColProgramInfoLoader=(d,tt,nt,it,st)=>{const ut=(ct=st.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[c.TextureType.unpacked],cacheHint:ct});var ct;return Object.assign(Object.assign({},ut),{get:()=>((ot,at,ht,ft,mt,yt)=>{const bt=ht.dims,wt=ft.dims,Tt=mt.length,Ct=(0,a.calculateIm2ColDims)(bt,wt,mt,4),Dt=`
        const int XC = ${bt[1]};
        const int XH = ${bt[2]};
        const int XW = ${bt[3]};
        const int KH = ${yt.kernelShape[0]};
        const int KW = ${yt.kernelShape[1]};
        const int dilationH = ${yt.dilations[0]};
        const int dilationW = ${yt.dilations[1]};
        const int strideH = ${yt.strides[0]};
        const int strideW = ${yt.strides[1]};
        const int padH = ${yt.pads[0]};
        const int padW = ${yt.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${Tt}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${bt.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return Object.assign(Object.assign({},at),{output:{dims:Ct,type:ht.type,textureType:c.TextureType.packedLastDimension},shaderSource:Dt})})(0,ut,tt,nt,it,st)})},a.calculateIm2ColDims=(d,tt,nt,it=4)=>[nt[0],nt[2],nt[3],Math.ceil(d[1]*tt[2]*tt[3]/it)]},6572:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseImageScalerAttributes=a.imageScaler=void 0;const c=o(246),d=o(2039);a.imageScaler=(ut,ct,ot)=>(st(ct),[ut.run(nt(ut,ct,ot),ct)]),a.parseImageScalerAttributes=ut=>{const ct=ut.attributes.getFloat("scale"),ot=ut.attributes.getFloats("bias");return(0,c.createAttributeWithCacheKey)({scale:ct,bias:ot})};const tt={name:"ImageScaler",inputNames:["X"],inputTypes:[d.TextureType.unpacked]},nt=(ut,ct,ot)=>{const at=Object.assign(Object.assign({},tt),{cacheHint:ot.cacheKey});return Object.assign(Object.assign({},at),{get:()=>((ht,ft,mt,yt)=>{const bt=mt[0].dims.slice(),wt=bt.length,Tt=`
      ${it(yt.bias.length)}
      float process(int indices[${wt}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return Object.assign(Object.assign({},ft),{output:{dims:bt,type:mt[0].type,textureType:d.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:yt.bias.length,data:yt.bias},{name:"scale",type:"float",data:yt.scale}],shaderSource:Tt})})(0,at,ct,ot)})},it=ut=>{const ct=[`float getBias(float bias[${ut}], int channel) {`];for(let ot=0;ot<ut;++ot)ot===0?ct.push(`	if (channel == ${ot}) { return bias[${ot}]; }`):ot===ut-1?ct.push(`	else { return bias[${ot}]; }`):ct.push(`	else if (channel == ${ot}) { return bias[${ot}]; }`);return ct.push("	}"),ct.join(`
`)},st=ut=>{if(!ut||ut.length!==1)throw new Error("ImageScaler requires 1 input.");if(ut[0].dims.length!==4)throw new Error("Invalid input shape.");if(ut[0].type!=="float32"&&ut[0].type!=="float64")throw new Error("Invalid input type.")}},3346:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseInstanceNormalizationAttributes=a.instanceNormalization=void 0;const c=o(5060),d=o(2039);a.instanceNormalization=(ct,ot,at)=>{ut(ot);const ht=ct.run(nt(ot[0]),ot);return[ct.run(st(ct,ot[0],at,ht.dims),[ot[0],ht,ot[1],ot[2]])]},a.parseInstanceNormalizationAttributes=ct=>ct.attributes.getFloat("epsilon",1e-5);const tt={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[d.TextureType.unpacked]},nt=ct=>Object.assign(Object.assign({},tt),{get:()=>((ot,at)=>{const ht=at.dims.slice(),ft=ht[1],mt=ht[2]*ht[3],yt=[ht[0],ft],bt=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${ht[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${ht[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${mt});
        temp = 0.0;
        for(int a2=0; a2<${ht[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${ht[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${mt});

        return v;
      }`;return Object.assign(Object.assign({},ot),{output:{dims:yt,type:at.type,textureType:d.TextureType.packedLastDimension},shaderSource:bt})})(tt,ct)}),it={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[d.TextureType.unpacked,d.TextureType.packedLastDimension,d.TextureType.unpacked,d.TextureType.unpacked]},st=(ct,ot,at,ht)=>{const ft=Object.assign(Object.assign({},it),{cacheHint:`${at}`});return Object.assign(Object.assign({},ft),{get:()=>((mt,yt,bt,wt,Tt)=>{const Ct=(0,c.getGlsl)(mt.session.backend.glContext.version),[Dt,Ot]=mt.calculateTextureWidthAndHeight(Tt,d.TextureType.packedLastDimension),[$t,Ft]=[Dt/4,Ot],kt=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${$t}, ${Ft});
        return ${Ct.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return Object.assign(Object.assign({},yt),{output:{dims:bt.dims,type:bt.type,textureType:d.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:wt}],shaderSource:kt})})(ct,ft,ot,at,ht)})},ut=ct=>{if(!ct||ct.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");const ot=ct[0],at=ct[1],ht=ct[2];if(ot.dims.length<3||at.dims.length!==1||ht.dims.length!==1)throw new Error("Invalid input shape.");if(at.dims[0]!==ot.dims[1]||ht.dims[0]!==ot.dims[1])throw new Error("Input shapes are mismatched.");if(ot.type!=="float32"&&ot.type!=="float64"||at.type!=="float32"&&at.type!=="float64"||ht.type!=="float32"&&ht.type!=="float64")throw new Error("Invalid input type.");if(ct[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}},708:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createPackedMatmulProgramInfoLoader=void 0;const c=o(2517),d=o(5060),tt=o(2039),nt=o(9390),it=o(2823),st=o(5623);a.createPackedMatmulProgramInfoLoader=(ut,ct,ot)=>{const at=(ht=ct.length>2,ft=ot.activationCacheKey,{name:"MatMul (packed)",inputNames:ht?["A","B","Bias"]:["A","B"],inputTypes:ht?[tt.TextureType.packed,tt.TextureType.packed,tt.TextureType.packed]:[tt.TextureType.packed,tt.TextureType.packed],cacheHint:ft});var ht,ft;return Object.assign(Object.assign({},at),{get:()=>((mt,yt,bt,wt)=>{const Tt=bt.length>2,Ct=Tt?"value += getBiasForMatmul();":"",Dt=bt[0].dims,Ot=bt[1].dims,$t=c.BroadcastUtil.calcShape(Dt,Ot,!0),Ft=!c.ShapeUtil.areEqual(bt[0].dims,bt[1].dims);if(!$t)throw new Error("Can't use matmul on the given tensors");const kt=Dt[Dt.length-1],Vt=Math.ceil(kt/2),Ht=Dt.length,Qt=Ot.length,Xt=(0,d.getGlsl)(mt.session.backend.glContext.version),Zt=(0,nt.getCoordsDataType)($t.length),ar=$t.length,nr=(0,nt.getGlChannels)(),{activationFunction:cr,applyActivation:dr}=(0,it.getActivationSnippet)(wt),mr=Tt?`${(0,st.getBiasForMatmul)(Zt,nr,bt[2].dims,$t,!0)}`:"",Dr=Ft?`${function(Jr,an,xn,Rn){let hn=[],pn=[];const yn=xn[0].dims,un=xn[1].dims,fn=yn.length,Bn=un.length,Dn=Rn.length,Qn=Dn-fn,zr=Dn-Bn;hn=yn.map((xo,Mo)=>`coords.${an[Mo+Qn]}`),hn[fn-1]="i*2",hn.join(", "),pn=un.map((xo,Mo)=>`coords.${an[Mo+zr]}`),pn[Bn-2]="i*2",pn.join(", ");const ao=c.BroadcastUtil.getBroadcastDims(yn,Rn),oo=c.BroadcastUtil.getBroadcastDims(un,Rn),Wn=ao.map(xo=>`coords.${an[xo+Qn]} = 0;`).join(`
`),no=oo.map(xo=>`coords.${an[xo+zr]} = 0;`).join(`
`),Eo=`int lastDim = coords.${an[Dn-1]};
  coords.${an[Dn-1]} = coords.${an[Dn-2]};
  coords.${an[Dn-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${Jr} coords = getOutputCoords();
  ${Eo}
  ${Wn}
  vec4 outputValue = getA(${hn});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${Jr} coords = getOutputCoords();
  ${Eo}
  ${no}
  vec4 outputValue = getB(${pn});
  return outputValue;
}`}(Zt,nr,bt,$t)}`:"",kr=Ft?"getAAtOutCoordsMatmul(i)":`getA(${function(Jr,an){let xn="";for(let Rn=0;Rn<an-2;Rn++)xn+=`rc.${Jr[Rn]}, `;return xn+=`rc.${Jr[an-2]}, i*2`,xn}(nr,Ht)})`,Yr=Ft?"getBAtOutCoordsMatmul(i)":`getB(${function(Jr,an){let xn="";for(let Rn=0;Rn<an-2;Rn++)xn+=`rc.${Jr[Rn]}, `;return xn+=`i*2, rc.${Jr[an-1]}`,xn}(nr,Qt)})`,Mr=`
            ${Dr}
            ${mr}
            ${cr}
            void main() {
              ${Ft?"":`${Zt} rc =
          getOutputCoords(); int lastDim = rc.${nr[ar-1]}; rc.${nr[ar-1]} =
          rc.${nr[ar-2]}; rc.${nr[ar-2]} = lastDim;
      `}

              vec4 value = vec4(0);
              for (int i = 0; i < ${Vt}; i++) {
                vec4 a = ${kr};
                vec4 b = ${Yr};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${Ct}
              ${dr}
              ${Xt.output} = value;
            }`;return Object.assign(Object.assign({},yt),{output:{dims:$t,type:bt[0].type,textureType:tt.TextureType.packed},shaderSource:Mr,hasMain:!0})})(ut,at,ct,ot)})}},5623:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getBiasForMatmul=a.createMatmulProgramInfoLoader=a.parseMatMulAttributes=a.matMul=void 0;const c=o(2517),d=o(2039),tt=o(9390),nt=o(2823),it=o(708);function st(ot,at){const ht=(ft=ot.length>2,mt=at.activationCacheKey,{name:"MatMul",inputNames:ft?["A","B","Bias"]:["A","B"],inputTypes:ft?[d.TextureType.unpacked,d.TextureType.unpacked,d.TextureType.unpacked]:[d.TextureType.unpacked,d.TextureType.unpacked],cacheHint:mt});var ft,mt;return Object.assign(Object.assign({},ht),{get:()=>function(yt,bt,wt){const Tt=bt[0].dims,Ct=bt[1].dims,Dt=c.BroadcastUtil.calcShape(Tt,Ct,!0);if(!Dt)throw new Error("Can't use matmul on the given tensors");const Ot=(0,tt.getCoordsDataType)(Dt.length),$t=(0,tt.getGlChannels)(),{activationFunction:Ft,applyActivation:kt}=(0,nt.getActivationSnippet)(wt),Vt=bt.length>2,Ht=Vt?"value += getBiasForMatmul();":"",Qt=Vt?`${ct(Ot,$t,bt[2].dims,Dt,!1)}`:"",Xt=Dt.length,Zt=Tt.length,ar=Ct.length,nr=`
    ${Ft}
    ${Qt}
    float process(int indices[${Xt}]) {
        int a[${Zt}];
        int b[${ar}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${Tt[Tt.length-1]}; ++k) {
            a[${Zt-1}] = k;
            b[${ar-2}] = k;
            value += _A(a) * _B(b);
        }
        ${Ht}
        ${kt}
        return value;
    }`;return Object.assign(Object.assign({},yt),{output:{dims:Dt,type:bt[0].type,textureType:d.TextureType.unpacked},shaderSource:nr})}(ht,ot,at)})}a.matMul=(ot,at,ht)=>(ut(at),ot.session.pack?[ot.run((0,it.createPackedMatmulProgramInfoLoader)(ot,at,ht),at)]:[ot.run(st(at,ht),at)]),a.parseMatMulAttributes=ot=>(0,nt.parseInternalActivationAttributes)(ot.attributes),a.createMatmulProgramInfoLoader=st;const ut=ot=>{if(!ot||ot.length!==2)throw new Error("MatMul requires 2 inputs.");if(ot[0].dims[ot[0].dims.length-1]!==ot[1].dims[ot[1].dims.length-2])throw new Error("shared dimension does not match.");if(ot[0].type!=="float32"&&ot[0].type!=="float64"||ot[1].type!=="float32"&&ot[1].type!=="float64")throw new Error("inputs should be float type");if(ot[0].type!==ot[1].type)throw new Error("inputs types should match")};function ct(ot,at,ht,ft,mt){let yt="";const bt=ht.length,wt=ft.length,Tt=wt-bt;yt=wt<2&&bt>0?"coords":ht.map((Ot,$t)=>`coords.${at[$t+Tt]}`).join(", ");const Ct=c.BroadcastUtil.getBroadcastDims(ht,ft).map(Ot=>`coords.${at[Ot+Tt]} = 0;`).join(`
`);let Dt="vec4(outputValue.xx, outputValue.yy)";return c.ShapeUtil.size(ht)===1&&(Dt="vec4(outputValue.x)"),mt?`
vec4 getBiasForMatmul() {
  ${ot} coords = getOutputCoords();
  ${Ct}
  vec4 outputValue = getBias(${yt});
  return ${Dt};
}`:`
float getBiasForMatmul() {
  ${ot} coords = getOutputCoords();
  ${Ct}
  return getBias(coords.x);
}`}a.getBiasForMatmul=ct},2403:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createPackProgramInfoLoader=void 0;const c=o(5060),d=o(2039),tt=o(9390),nt=o(2827),it={name:"pack",inputNames:["A"],inputTypes:[d.TextureType.unpackedReversed]};a.createPackProgramInfoLoader=(st,ut)=>Object.assign(Object.assign({},it),{get:()=>((ct,ot)=>{const at=(0,c.getGlsl)(ct.session.backend.glContext.version),ht=ot.dims,ft=ht.length,mt=ot.dims.length,yt=(0,tt.getCoordsDataType)(mt),bt=(0,nt.getChannels)("rc",mt),wt=(Tt=mt,Ct=bt,Dt=ht[ht.length-2],Ot=ht[ht.length-1],Tt===0||Tt===1?"":`
    int r = ${Ct[Tt-2]};
    int c = ${Ct[Tt-1]};
    int rp1 = ${Ct[Tt-2]} + 1;
    int cp1 = ${Ct[Tt-1]} + 1;
    bool rEdge = rp1 >= ${Ot};
    bool cEdge = cp1 >= ${Dt};
    `);var Tt,Ct,Dt,Ot;let $t;$t=ft===0?[1,1]:ft===1?[ht[0],1]:[ht[mt-1],ht[mt-2]];const Ft=function(Ht,Qt,Xt){if(Ht===0)return"false";if(Ht===1)return`rc > ${Qt[0]}`;let Zt="";for(let ar=Ht-2;ar<Ht;ar++)Zt+=`${Xt[ar]} >= ${Qt[ar-Ht+2]}`,ar<Ht-1&&(Zt+="||");return Zt}(mt,$t,bt),kt=function(Ht,Qt){const Xt=Ht.length;if(Xt===0)return"getA(), 0, 0, 0";if(Xt===1)return`getA(rc),
            rc + 1 >= ${Ht[0]} ? 0. : getA(rc + 1),
            0, 0`;let Zt="";if(Xt>2)for(let ar=0;ar<Xt-2;++ar)Zt+=`${Qt[ar]},`;return`getA(${Zt}r, c),
          rEdge ? 0. : getA(${Zt}rp1, c),
          cEdge ? 0. : getA(${Zt}r, cp1),
          rEdge || cEdge ? 0. : getA(${Zt}rp1, cp1)`}(ht,bt),Vt=`
        void main() {
          ${yt} rc = getOutputCoords();

          if(${Ft}) {
            ${at.output} = vec4(0);
          } else {
            ${wt}

            ${at.output} = vec4(${kt});
          }
        }
      `;return Object.assign(Object.assign({},it),{hasMain:!0,output:{dims:ot.dims,type:ot.type,textureType:d.TextureType.packed},shaderSource:Vt})})(st,ut)})},2827:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.unpackFromChannel=a.getChannels=a.getVecChannels=void 0;const c=o(9390);function d(tt,nt){return(0,c.getGlChannels)(nt).map(it=>`${tt}.${it}`)}a.getVecChannels=d,a.getChannels=function(tt,nt){return nt===1?[tt]:d(tt,nt)},a.unpackFromChannel=function(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}},2870:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parsePadAttributesV11=a.padV11=a.parsePadAttributesV2=a.padV2=void 0;const c=o(246),d=o(2517),tt=o(5060),nt=o(2039),it={name:"Pad",inputNames:["A"],inputTypes:[nt.TextureType.unpacked]};a.padV2=(yt,bt,wt)=>(ct(bt),[yt.run(Object.assign(Object.assign({},it),{cacheHint:wt.cacheKey,get:()=>ut(yt,bt[0],wt)}),bt)]),a.parsePadAttributesV2=yt=>{const bt=yt.attributes.getString("mode","constant"),wt=yt.attributes.getFloat("value",0),Tt=yt.attributes.getInts("pads");return(0,c.createAttributeWithCacheKey)({mode:bt,value:wt,pads:Tt})},a.padV11=(yt,bt,wt)=>{ot(bt);const Tt=st(yt,bt,wt);return(0,a.padV2)(yt,[bt[0]],Tt)},a.parsePadAttributesV11=yt=>yt.attributes.getString("mode","constant");const st=(yt,bt,wt)=>{if(!yt.session.isInitializer(bt[1].dataId)||bt.length>=3&&!yt.session.isInitializer(bt[2].dataId))throw new Error("dynamic pad attributes are not allowed");const Tt=Array.from(bt[1].integerData),Ct=bt.length>=3?bt[2].floatData[0]:0;return(0,c.createAttributeWithCacheKey)({mode:wt,pads:Tt,value:Ct})},ut=(yt,bt,wt)=>{const Tt=d.ShapeUtil.padShape(bt.dims.slice(),wt.pads),Ct=Tt.length,Dt=`
      ${at(yt,bt,wt)}
      float process(int[${Ct}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[nt.TextureType.unpacked],output:{dims:Tt,type:bt.type,textureType:nt.TextureType.unpacked},shaderSource:Dt}},ct=yt=>{if(!yt||yt.length!==1)throw new Error("Pad requires 1 input");if(yt[0].type!=="float32"&&yt[0].type!=="float64")throw new Error("Invalid input type.")},ot=yt=>{if(!yt||yt.length!==2&&yt.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(yt[1].type!=="int32")throw new Error("Invalid input type.");if(yt.length>=3&&yt[2].type==="string")throw new Error("Invalid input type.")},at=(yt,bt,wt)=>{const Tt=(0,tt.getGlsl)(yt.session.backend.glContext.version),[Ct,Dt]=yt.calculateTextureWidthAndHeight(bt.dims,nt.TextureType.unpacked),Ot=d.ShapeUtil.computeStrides(bt.dims);switch(wt.mode){case"constant":return ht(Tt,bt.dims,Ot,Ct,Dt,wt.pads,wt.value);case"reflect":return ft(Tt,bt.dims,Ot,Ct,Dt,wt.pads);case"edge":return mt(Tt,bt.dims,Ot,Ct,Dt,wt.pads);default:throw new Error("Invalid mode")}},ht=(yt,bt,wt,Tt,Ct,Dt,Ot)=>{const $t=bt.length;let Ft="";for(let kt=$t-1;kt>=0;--kt)Ft+=`
        k = m[${kt}] - ${Dt[kt]};
        if (k < 0)  return constant;
        if (k >= ${bt[kt]}) return constant;
        offset += k * ${wt[kt]};
        `;return`
      float padA(int m[${$t}]) {
        const float constant = float(${Ot});
        int offset = 0;
        int k = 0;
        ${Ft}
        vec2 coords = offsetToCoords(offset, ${Tt}, ${Ct});
        float value = getColorAsFloat(${yt.texture2D}(A, coords));
        return value;
      }
      `},ft=(yt,bt,wt,Tt,Ct,Dt)=>{const Ot=bt.length;let $t="";for(let Ft=Ot-1;Ft>=0;--Ft)$t+=`
        k = m[${Ft}] - ${Dt[Ft]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(bt[Ft]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${bt[Ft]}) { k = _2n_1 - k; }
        }
        offset += k * ${wt[Ft]};
        `;return`
      float padA(int m[${Ot}]) {
        int offset = 0;
        int k = 0;
        ${$t}
        vec2 coords = offsetToCoords(offset, ${Tt}, ${Ct});
        float value = getColorAsFloat(${yt.texture2D}(A, coords));
        return value;
      }
      `},mt=(yt,bt,wt,Tt,Ct,Dt)=>{const Ot=bt.length;let $t="";for(let Ft=Ot-1;Ft>=0;--Ft)$t+=`
        k = m[${Ft}] - ${Dt[Ft]};
        if (k < 0)  k = 0;
        if (k >= ${bt[Ft]}) k = ${bt[Ft]-1};
        offset += k * ${wt[Ft]};
      `;return`
      float padA(int m[${Ot}]) {
        int offset = 0;
        int k = 0;
        ${$t}
        vec2 coords = offsetToCoords(offset, ${Tt}, ${Ct});
        float value = getColorAsFloat(${yt.texture2D}(A, coords));
        return value;
      }
      `}},2143:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.globalMaxPool=a.parseMaxPoolAttributes=a.maxPool=a.parseGlobalAveragePoolAttributes=a.globalAveragePool=a.parseAveragePoolAttributes=a.averagePool=void 0;const c=o(246),d=o(2517),tt=o(2039);a.averagePool=(mt,yt,bt)=>{ot(yt);const wt={name:"AveragePool",inputNames:["X"],inputTypes:[tt.TextureType.unpacked],cacheHint:bt.cacheKey};return[mt.run(Object.assign(Object.assign({},wt),{get:()=>nt(yt,wt,!1,bt)}),yt)]},a.parseAveragePoolAttributes=mt=>{const yt=mt.attributes.getString("auto_pad","NOTSET"),bt=mt.attributes.getInt("ceil_mode",0),wt=mt.attributes.getInt("count_include_pad",0)!==0,Tt=mt.attributes.getInts("kernel_shape"),Ct=mt.attributes.getInts("strides",[]),Dt=mt.attributes.getInts("pads",[]);if(bt!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,c.createAttributeWithCacheKey)({autoPad:yt,ceilMode:bt,countIncludePad:wt,kernelShape:Tt,strides:Ct,pads:Dt})};const nt=(mt,yt,bt,wt)=>{const[Tt,Ct]=st(mt,wt,bt),Dt=d.ShapeUtil.size(Tt.kernelShape);let Ot="";Tt.countIncludePad?Ot+=`value /= float(${Dt});`:Ot+=`value /= float(${Dt} - pad);`;const $t=`
        ${at(mt[0].dims,Tt,"value += _X(x);",Ot,"0.0")}
      `;return Object.assign(Object.assign({},yt),{output:{dims:Ct,type:mt[0].type,textureType:tt.TextureType.unpacked},shaderSource:$t})};a.globalAveragePool=(mt,yt,bt)=>{ot(yt);const wt={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[tt.TextureType.unpacked],cacheHint:`${bt.countIncludePad}`};return[mt.run(Object.assign(Object.assign({},wt),{get:()=>nt(yt,wt,!0,bt)}),yt)]},a.parseGlobalAveragePoolAttributes=mt=>{const yt=mt.attributes.getInt("count_include_pad",0)!==0;return(0,c.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:yt,kernelShape:[],strides:[],pads:[]})},a.maxPool=(mt,yt,bt)=>{ot(yt);const wt={name:"MaxPool",inputNames:["X"],inputTypes:[tt.TextureType.unpacked],cacheHint:bt.cacheKey};return[mt.run(Object.assign(Object.assign({},wt),{get:()=>it(yt,wt,!1,bt)}),yt)]},a.parseMaxPoolAttributes=mt=>{const yt=mt.attributes.getString("auto_pad","NOTSET"),bt=mt.attributes.getInt("ceil_mode",0),wt=mt.attributes.getInts("kernel_shape"),Tt=mt.attributes.getInts("strides",[]),Ct=mt.attributes.getInts("pads",[]),Dt=mt.attributes.getInt("storage_order",0),Ot=mt.attributes.getInts("dilations",[]);if(Dt!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(bt!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,c.createAttributeWithCacheKey)({autoPad:yt,ceilMode:bt,countIncludePad:!1,kernelShape:wt,strides:Tt,pads:Ct,storageOrder:Dt,dilations:Ot})};const it=(mt,yt,bt,wt)=>{const[Tt,Ct]=st(mt,wt,bt),Dt=`
      ${at(mt[0].dims,Tt,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return Object.assign(Object.assign({},yt),{output:{dims:Ct,type:mt[0].type,textureType:tt.TextureType.unpacked},shaderSource:Dt})},st=(mt,yt,bt)=>{const wt=mt[0].dims.slice(),Tt=Object.hasOwnProperty.call(yt,"dilations"),Ct=yt.kernelShape.slice(),Dt=yt.strides.slice(),Ot=Tt?yt.dilations.slice():[],$t=yt.pads.slice();d.PoolConvUtil.adjustPoolAttributes(bt,wt,Ct,Dt,Ot,$t);const Ft=d.PoolConvUtil.computePoolOutputShape(bt,wt,Dt,Ot,Ct,$t,yt.autoPad),kt=Object.assign({},yt);return Tt?Object.assign(kt,{kernelShape:Ct,strides:Dt,pads:$t,dilations:Ot,cacheKey:yt.cacheKey}):Object.assign(kt,{kernelShape:Ct,strides:Dt,pads:$t,cacheKey:yt.cacheKey}),[kt,Ft]},ut={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},ct={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[tt.TextureType.unpacked]};a.globalMaxPool=(mt,yt)=>(ot(yt),[mt.run(Object.assign(Object.assign({},ct),{get:()=>it(yt,ct,!0,ut)}),yt)]);const ot=mt=>{if(!mt||mt.length!==1)throw new Error("Pool ops requires 1 input.");if(mt[0].type!=="float32"&&mt[0].type!=="float64")throw new Error("Invalid input type.")},at=(mt,yt,bt,wt,Tt)=>{const Ct=mt.length;if(yt.kernelShape.length<=2){const Dt=yt.kernelShape[yt.kernelShape.length-1],Ot=yt.strides[yt.strides.length-1],$t=yt.pads[yt.pads.length/2-1],Ft=yt.pads[yt.pads.length-1],kt=mt[Ct-1];let Vt="",Ht="",Qt="";if(Vt=$t+Ft!==0?`
          for (int i = 0; i < ${Dt}; i++) {
            x[${Ct} - 1] = indices[${Ct} - 1] * ${Ot} - ${$t} + i;
            if (x[${Ct} - 1] < 0 || x[${Ct} - 1] >= ${kt}) {
              pad++;
              continue;
            }
            ${bt}
          }`:`
          for (int i = 0; i < ${Dt}; i++) {
            x[${Ct} - 1] = indices[${Ct} - 1] * ${Ot} - ${$t} + i;
            ${bt}
          }`,yt.kernelShape.length===2){const Xt=yt.kernelShape[yt.kernelShape.length-2],Zt=yt.strides[yt.strides.length-2],ar=yt.pads[yt.pads.length/2-2],nr=yt.pads[yt.pads.length-2],cr=mt[Ct-2];Ht=ar+nr!==0?`
            for (int j = 0; j < ${Xt}; j++) {
              x[${Ct} - 2] = indices[${Ct} - 2] * ${Zt} - ${ar} + j;
              if (x[${Ct} - 2] < 0 || x[${Ct} - 2] >= ${cr}) {
                pad+= ${Dt};
                continue;
              }
          `:`
            for (int j = 0; j < ${Xt}; j++) {
              x[${Ct} - 2] = indices[${Ct} - 2] * ${Zt} - ${ar} + j;
            `,Qt=`
          }
        `}return`
        float process(int indices[${Ct}]) {
          int x[${Ct}];
          copyVec(indices, x);

          float value = ${Tt};
          int pad = 0;
          ${Ht}
          ${Vt}
          ${Qt}
          ${wt}
          return value;
        }
      `}{const Dt=d.ShapeUtil.size(yt.kernelShape),Ot=d.ShapeUtil.computeStrides(yt.kernelShape),$t=Ot.length,Ft=yt.pads.length,kt=ft($t),Vt=ht(mt,"inputDims"),Ht=ht(yt.pads,"pads"),Qt=ht(Ot,"kernelStrides"),Xt=ht(yt.strides,"strides");let Zt="";return Zt=yt.pads.reduce((ar,nr)=>ar+nr)?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${bt}
          }`:`
          }
          ${bt}
        `,`
        ${kt}
        float process(int indices[${Ct}]) {
          int x[${Ct}];
          copyVec(indices, x);
          int offset[${$t}];
          int pads[${Ft}];
          int inputDims[${Ct}];
          int kernelStrides[${$t}];
          int strides[${$t}];
          ${Ht}
          ${Vt}
          ${Xt}
          ${Qt}

          float value = ${Tt};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${Dt}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${Ct} - ${$t}; j < ${Ct}; j++) {
              x[j] = indices[j] * strides[j - ${Ct} + ${$t}]
                + offset[j - ${Ct} + ${$t}] - pads[j - 2];
              ${Zt}
          }
          ${wt}

          return value;
        }
      `}},ht=(mt,yt)=>{let bt="";for(let wt=0;wt<mt.length;wt++)bt+=`
      ${yt}[${wt}] = ${mt[wt]};
    `;return bt},ft=mt=>`
  void offsetToIndices(int offset, int[${mt}] strides, out int[${mt}] indices) {
    if (${mt} == 0) {
      return;
    }
    for (int i = 0; i < ${mt} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${mt} - 1] = offset;
  }`},4939:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.reduceLogSumSquare=a.reduceLogSum=a.reduceProd=a.reduceMin=a.reduceMax=a.reduceMean=a.reduceSum=a.parseReduceAttributes=void 0;const c=o(246),d=o(782),tt=o(2517),nt=o(2039),it=(ct,ot,at,ht,ft)=>{ut(ot);const mt={name:ht,inputNames:["A"],inputTypes:[nt.TextureType.unpacked]};return[ct.run(Object.assign(Object.assign({},mt),{cacheHint:at.cacheKey,get:()=>st(ct,ot,at,ht,ft,mt)}),ot)]};a.parseReduceAttributes=ct=>{const ot=ct.attributes.getInts("axes",[]),at=ct.attributes.getInt("keepdims",1)===1;return(0,c.createAttributeWithCacheKey)({axes:ot,keepDims:at})};const st=(ct,ot,at,ht,ft,mt)=>{const yt=[],bt=ot[0].dims.length||1,wt=[],Tt=tt.ShapeUtil.normalizeAxes(at.axes,ot[0].dims.length),Ct=ft(ot,Tt);let Dt=Ct[1];for(let $t=0;$t<ot[0].dims.length;$t++)Tt.indexOf($t)>=0||Tt.length===0?(at.keepDims&&yt.push(1),Dt=`
          for(int j${$t} = 0; j${$t} < ${ot[0].dims[$t]}; j${$t}++) {
            inputIdx[${$t}] = j${$t};
            ${Dt}
          }`):(wt.push(`inputIdx[${$t}] = outputIdx[${yt.length}];`),yt.push(ot[0].dims[$t]));const Ot=`
      float process(int outputIdx[${yt.length||1}]) {
        float value;                 // final result
        int inputIdx[${bt}];      // addressing input data
        ${wt.join(`
`)}
        ${Ct[0]}       // init ops for reduce max/min
        ${Dt}
        ${Ct[2]}       // final computation for reduce mean
        return value;
      }`;return Object.assign(Object.assign({},mt),{output:{dims:yt,type:ot[0].type,textureType:nt.TextureType.unpacked},shaderSource:Ot})},ut=ct=>{if(!ct||ct.length!==1)throw new Error("Reduce op requires 1 input.");if(d.NUMBER_TYPES.indexOf(ct[0].type)===-1)throw new Error("Invalid input type.")};a.reduceSum=(ct,ot,at)=>it(ct,ot,at,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),a.reduceMean=(ct,ot,at)=>it(ct,ot,at,"ReduceMean",(ht,ft)=>{let mt=1;for(let yt=0;yt<ht[0].dims.length;yt++)(ft.indexOf(yt)>=0||ft.length===0)&&(mt*=ht[0].dims[yt]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${mt}.;`]}),a.reduceMax=(ct,ot,at)=>it(ct,ot,at,"ReduceMax",(ht,ft)=>{const mt=[];for(let yt=0;yt<ht[0].dims.length;yt++)(ft.indexOf(yt)>=0||ft.length===0)&&mt.push(`inputIdx[${yt}] = 0;`);return[`${mt.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),a.reduceMin=(ct,ot,at)=>it(ct,ot,at,"ReduceMin",(ht,ft)=>{const mt=[];for(let yt=0;yt<ht[0].dims.length;yt++)(ft.indexOf(yt)>=0||ft.length===0)&&mt.push(`inputIdx[${yt}] = 0;`);return[`${mt.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),a.reduceProd=(ct,ot,at)=>it(ct,ot,at,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),a.reduceLogSum=(ct,ot,at)=>it(ct,ot,at,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),a.reduceLogSumSquare=(ct,ot,at)=>it(ct,ot,at,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])},7019:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isReshapeCheap=a.processDims3D=a.createPackedReshape3DProgramInfoLoader=void 0;const c=o(2517),d=o(5060),tt=o(2039),nt=o(2827);a.createPackedReshape3DProgramInfoLoader=(it,st,ut)=>{const ct=(ot=>({name:"Reshape (packed)",inputTypes:[tt.TextureType.packed],inputNames:["A"],cacheHint:`${ot}`}))(ut);return Object.assign(Object.assign({},ct),{get:()=>((ot,at,ht,ft)=>{const mt=at.dims,yt=ft;let bt="";for(let Ct=0;Ct<4;Ct++){let Dt="";switch(Ct){case 0:Dt="outputCoords = rc;";break;case 1:Dt="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:Dt="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:Dt="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}bt+=`
        ${Dt}
        ${Ct>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${Ct}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${Ct>0?"}":""}
      `}const wt=(0,d.getGlsl)(ot.session.backend.glContext.version),Tt=`
      ${function(Ct){const Dt=c.ShapeUtil.computeStrides(Ct),Ot=["b","r","c"],$t="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${Dt.map((Ft,kt)=>`int ${Ot[kt]} = ${$t} / ${Ft}; ${kt===Dt.length-1?`int ${Ot[kt+1]} = ${$t} - ${Ot[kt]} * ${Ft}`:`index -= ${Ot[kt]} * ${Ft}`};`).join("")}
      return ivec3(b, r, c);
    }
  `}(mt)}
      ${function(Ct){const Dt=c.ShapeUtil.computeStrides(Ct);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${Dt[0]} + coords.z * ${Dt[1]} + coords.y;
  }
`}(yt)}
      ${(0,nt.unpackFromChannel)()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${yt[2]};
        int cols = ${yt[1]};

        ${bt}
        ${wt.output} = result;
      }
    `;return Object.assign(Object.assign({},ht),{output:{dims:yt,type:at.type,textureType:tt.TextureType.packed},shaderSource:Tt,hasMain:!0})})(it,st,ct,ut)})},a.processDims3D=function(it){if(it.length===0)return[1,1,1];let st=1;for(let ut=0;ut<it.length-2;++ut)st*=it[ut];return[st,it.length>1?it[it.length-2]:1,it[it.length-1]]},a.isReshapeCheap=function(it,st){let ut=!1;return ut=it.length===0||st.length===0||(it.length<2||st.length<2?it[it.length-1]===st[st.length-1]:it[it.length-1]===st[st.length-1]&&it[it.length-2]===st[st.length-2]),ut}},718:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.reshape=void 0;const c=o(2517);a.reshape=(d,tt)=>{const nt=c.ShapeUtil.calculateReshapedDims(tt[0].dims,tt[1].integerData);return d.session.pack?[d.reshapePacked(tt[0],nt)]:[d.reshapeUnpacked(tt[0],nt)]}},2268:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseResizeAttributesV11=a.parseResizeAttributesV10=a.resize=void 0;const c=o(5060),d=o(2039),tt=o(9390),nt=o(2827),it=o(9793),st={name:"Resize",inputNames:["A"],inputTypes:[d.TextureType.packed]};a.resize=(ht,ft,mt)=>((0,it.validateInputs)(ft,mt),[ht.run(Object.assign(Object.assign({},st),{cacheHint:mt.cacheKey,get:()=>ut(ht,ft,mt)}),ft)]),a.parseResizeAttributesV10=ht=>(0,it.parseUpsampleAttributes)(ht,10),a.parseResizeAttributesV11=ht=>(0,it.parseUpsampleAttributes)(ht,11);const ut=(ht,ft,mt)=>{const yt=(0,c.getGlsl)(ht.session.backend.glContext.version),[bt,wt]=ct(ft,mt);if(bt.every(Zt=>Zt===1)&&mt.coordinateTransformMode!=="tf_crop_and_resize")return Object.assign(Object.assign({},st),{output:{dims:wt,type:ft[0].type,textureType:d.TextureType.packed},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${yt.texture2D}(X, TexCoords);
                    ${yt.output} = v;
                }`});const Tt=wt.length;if(Tt<2)throw new Error(`output dimension should be at least 2, but got ${Tt}`);const Ct=wt[Tt-2],Dt=wt[Tt-1],Ot=ft[0].dims;if(Tt!==Ot.length)throw new Error(`output dimension should match input ${Ot.length}, but got ${Tt}`);const $t=Ot[Tt-2],Ft=Ot[Tt-1],kt=bt[Tt-2],Vt=bt[Tt-1];let Ht="";if(mt.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${mt.mode}'`);switch(mt.coordinateTransformMode){case"asymmetric":Ht=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":Ht=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":Ht=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${Dt}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${Ct}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${Dt}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${Ct}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":Ht=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${Dt}.0 - 1.0, ${Ct}.0 - 1.0, ${Dt}.0 - 1.0,
                            ${Ct}.0 - 1.0);
                        vec4 original = vec4(${Ft}.0 - 1.0, ${$t}.0 - 1.0, ${Ft}.0 - 1.0,
                            ${$t}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${mt.coordinateTransformMode}'`)}const Qt=(0,tt.getCoordsDataType)(Tt),Xt=`
            const vec2 inputWH = vec2(${$t}.0, ${Ft}.0);
            const vec4 scaleWHWH = vec4(float(${kt}), float(${Vt}), float(${kt}), float(${Vt}));
            ${(0,nt.unpackFromChannel)()}
            ${Ht}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${Qt} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${Ct-1};
                bool hasNextCol = rc.z < ${Dt-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${yt.output} = vec4(newValue);
            }
        `;return Object.assign(Object.assign({},st),{output:{dims:wt,type:ft[0].type,textureType:d.TextureType.packed},hasMain:!0,shaderSource:Xt})},ct=(ht,ft)=>{const mt=ht[0].dims;let yt,bt=ft.scales;if(bt.length===0){const Tt=ht[ft.scalesInputIdx];if(Tt&&Tt.size!==0){if(ht[ft.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");bt=ot(Tt,ft.mode,ft.isResize)}else{const Ct=ht[ft.sizesInputIdx];if(!Ct||Ct.size===0)throw new Error("Either scales or sizes MUST be provided as input.");yt=Array.from(Ct.integerData),bt=at(yt,mt,ft.mode,ft.isResize)}}else if(ht[ft.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const wt=yt||mt.map((Tt,Ct)=>Math.floor(Tt*bt[Ct]));return[bt,wt]},ot=(ht,ft,mt)=>{const yt=Array.from(ht.floatData);return(0,it.scalesValidation)(yt,ft,mt),yt},at=(ht,ft,mt,yt)=>{const bt=ft.length,wt=new Array(bt);for(let Tt=0,Ct=bt;Tt<Ct;Tt++)if(ft[Tt]===0){if(ht[Tt]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");wt[Tt]=1}else wt[Tt]=ht[Tt]/ft[Tt];return(0,it.scalesValidation)(wt,mt,yt),wt}},8117:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.shape=void 0;const c=o(9162);a.shape=(tt,nt)=>(d(nt),[new c.Tensor([nt[0].dims.length],"int32",void 0,void 0,new Int32Array(nt[0].dims))]);const d=tt=>{if(!tt||tt.length!==1)throw new Error("Shape requires 1 input.")}},2278:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.sliceV10=a.parseSliceAttributes=a.slice=void 0;const c=o(246),d=o(782),tt=o(2517),nt=o(2039),it={name:"Slice",inputNames:["A"],inputTypes:[nt.TextureType.unpacked]};a.slice=(at,ht,ft)=>(ut(ht),[at.run(Object.assign(Object.assign({},it),{cacheHint:ft.cacheKey,get:()=>st(at,ht[0],ft)}),ht)]),a.parseSliceAttributes=at=>{const ht=at.attributes.getInts("starts"),ft=at.attributes.getInts("ends"),mt=at.attributes.getInts("axes",[]);return(0,c.createAttributeWithCacheKey)({starts:ht,ends:ft,axes:mt})};const st=(at,ht,ft)=>{const mt=ft.axes.length===0?ht.dims.slice(0).map((Ot,$t)=>$t):ft.axes,yt=tt.ShapeUtil.normalizeAxes(mt,ht.dims.length),bt=ft.starts.map((Ot,$t)=>Ot>ht.dims[yt[$t]]-1?ht.dims[yt[$t]]:tt.ShapeUtil.normalizeAxis(Ot,ht.dims[yt[$t]])),wt=ft.ends.map((Ot,$t)=>Ot>ht.dims[yt[$t]]-1?ht.dims[yt[$t]]:tt.ShapeUtil.normalizeAxis(Ot,ht.dims[yt[$t]])),Tt=ht.dims.slice(),Ct=[];for(let Ot=0;Ot<yt.length;Ot++)Tt[yt[Ot]]=wt[Ot]-bt[Ot],bt[Ot]>0&&Ct.push(`outputIdx[${yt[Ot]}] += ${bt[Ot]};`);const Dt=`
      float process(int outputIdx[${Tt.length}]) {
        ${Ct.join(`
      `)}
        return _A(outputIdx);
      }`;return Object.assign(Object.assign({},it),{output:{dims:Tt,type:ht.type,textureType:nt.TextureType.unpacked},shaderSource:Dt})},ut=at=>{if(!at||at.length!==1)throw new Error("Slice requires 1 input.");if(d.NUMBER_TYPES.indexOf(at[0].type)===-1)throw new Error("Invalid input type.")};a.sliceV10=(at,ht)=>{ot(ht);const ft=ct(at,ht);return[at.run(Object.assign(Object.assign({},it),{cacheHint:ft.cacheKey,get:()=>st(at,ht[0],ft)}),[ht[0]])]};const ct=(at,ht)=>{if(!at.session.isInitializer(ht[1].dataId)||!at.session.isInitializer(ht[2].dataId)||ht.length>=4&&!at.session.isInitializer(ht[3].dataId)||ht.length>=5&&!at.session.isInitializer(ht[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(ht.length>=5&&ht[4].integerData.some(bt=>bt!==1))throw new Error("currently non-1 steps is not supported for Slice");const ft=Array.from(ht[1].integerData),mt=Array.from(ht[2].integerData),yt=ht.length>=4?Array.from(ht[3].integerData):[];return{starts:ft,ends:mt,axes:yt,cacheKey:`${yt};${ft};${mt}`}},ot=at=>{if(!at||at.length<3||at.length>5)throw new Error("Invalid input number.");if(at[1].type!=="int32"||at[1].dims.length!==1)throw new Error("Invalid input type.");if(at[2].type!=="int32"||at[2].dims.length!==1)throw new Error("Invalid input type.");if(at.length>=4&&(at[3].type!=="int32"||at[3].dims.length!==1))throw new Error("Invalid input type.");if(at.length>=5&&(at[4].type!=="int32"||at[4].dims.length!==1))throw new Error("Invalid input type.")}},5524:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.softmaxV13=a.parseSoftmaxAttributesV13=a.parseSoftmaxAttributes=a.softmax=void 0;const c=o(246),d=o(2517),tt=o(5060),nt=o(2039),it=o(3738),st={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[nt.TextureType.unpacked]},ut={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[nt.TextureType.unpacked,nt.TextureType.unpacked]},ct={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[nt.TextureType.unpacked,nt.TextureType.unpacked,nt.TextureType.unpacked]};a.softmax=(yt,bt,wt)=>{mt(bt);const Tt=bt[0].dims.slice(),Ct=d.ShapeUtil.normalizeAxis(wt.axis,Tt.length),Dt=d.ShapeUtil.sizeToDimension(Tt,Ct),Ot=d.ShapeUtil.sizeFromDimension(Tt,Ct);return ot(yt,bt,wt,Dt,Ot)},a.parseSoftmaxAttributes=yt=>(0,c.createAttributeWithCacheKey)({axis:yt.attributes.getInt("axis",1)}),a.parseSoftmaxAttributesV13=yt=>(0,c.createAttributeWithCacheKey)({axis:yt.attributes.getInt("axis",-1)}),a.softmaxV13=(yt,bt,wt)=>{mt(bt);const Tt=bt[0].dims.slice(),Ct=d.ShapeUtil.normalizeAxis(wt.axis,Tt.length),Dt=Tt.length,Ot=Ct!==Dt-1,$t=[];let Ft,kt=[],Vt=[];Ot&&(kt=Array.from({length:Dt}).map((Zt,ar)=>ar),kt[Ct]=Dt-1,kt[Dt-1]=Ct,kt.map(Zt=>$t.push(Tt[Zt])),Ft=(0,c.createAttributeWithCacheKey)({perm:kt}),Vt=(0,it.transpose)(yt,bt,Ft));const Ht=Ot?d.ShapeUtil.sizeToDimension($t,Dt-1):d.ShapeUtil.sizeToDimension(Tt,Dt-1),Qt=Ot?d.ShapeUtil.sizeFromDimension($t,Dt-1):d.ShapeUtil.sizeFromDimension(Tt,Dt-1),Xt=ot(yt,Ot?Vt:bt,wt,Ht,Qt);return Ot?(0,it.transpose)(yt,Xt,Ft):Xt};const ot=(yt,bt,wt,Tt,Ct)=>{const Dt=at(yt,bt[0],Tt,Ct,[Tt]),Ot=yt.run(Object.assign(Object.assign({},st),{cacheHint:wt.cacheKey,get:()=>Dt}),bt),$t=ht(yt,bt[0],Tt,Ct,Dt.output.dims,[Tt]),Ft=yt.run(Object.assign(Object.assign({},ut),{cacheHint:wt.cacheKey,get:()=>$t}),[bt[0],Ot]),kt=ft(yt,bt[0],Tt,Ct,Dt.output.dims,$t.output.dims);return[yt.run(Object.assign(Object.assign({},ct),{cacheHint:wt.cacheKey,get:()=>kt}),[bt[0],Ot,Ft])]},at=(yt,bt,wt,Tt,Ct)=>{const[Dt,Ot]=yt.calculateTextureWidthAndHeight(bt.dims,nt.TextureType.unpacked),$t=Ct.length;if(wt<1||Tt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(Ct.length!==1)throw new Error("Dimensionality of the output should be 1");if(Ct[0]!==wt)throw new Error("Shape of the output should be equal to logical row count");const Ft=(0,tt.getGlsl)(yt.session.backend.glContext.version),kt=`
      float process(int[${$t}] indices) {
        int logical_row_start_offset = indices[0] * ${Tt};

        float max = getColorAsFloat(${Ft.texture2D}(A, offsetToCoords(logical_row_start_offset, ${Dt},
        ${Ot} )));
        for(int i=1; i<${Tt}; ++i)
        {
          float current = getColorAsFloat(${Ft.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${Dt}, ${Ot})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return Object.assign(Object.assign({},st),{output:{dims:Ct,type:bt.type,textureType:nt.TextureType.unpacked},shaderSource:kt})},ht=(yt,bt,wt,Tt,Ct,Dt)=>{const[Ot,$t]=yt.calculateTextureWidthAndHeight(bt.dims,nt.TextureType.unpacked),Ft=Dt.length;if(wt<1||Tt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(Dt.length!==1)throw new Error("Dimensionality of the output should be 1");if(Dt[0]!==wt)throw new Error("Shape of the output should be equal to logical row count");if(Ct.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(Ct[0]!==wt)throw new Error("Shape of the intermediate results should be equal to logical row count");const kt=`
      float process(int[${Ft}] indices) {
        int logical_row_start_offset = indices[0] * ${Tt};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${Tt}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${(0,tt.getGlsl)(yt.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${Ot}, ${$t}))) - max);
        }

        return norm_factor;
      }`;return Object.assign(Object.assign({},ut),{output:{dims:Dt,type:bt.type,textureType:nt.TextureType.unpacked},shaderSource:kt})},ft=(yt,bt,wt,Tt,Ct,Dt)=>{const[Ot,$t]=yt.calculateTextureWidthAndHeight(bt.dims,nt.TextureType.unpacked),Ft=bt.dims.length;if(wt<1||Tt<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(Ct.length!==1||Dt.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(Ct[0]!==wt||Dt[0]!==wt)throw new Error("Shape of the intermediate results should be equal to logical row count");const kt=`
      float process(int[${Ft}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${Ot}, ${$t});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${Tt};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return Object.assign(Object.assign({},ct),{output:{dims:bt.dims,type:bt.type,textureType:nt.TextureType.unpacked},shaderSource:kt})},mt=yt=>{if(!yt||yt.length!==1)throw new Error("Softmax requires 1 input.");if(yt[0].type!=="float32"&&yt[0].type!=="float64")throw new Error("Invalid input type")}},5975:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseSplitAttributes=a.split=void 0;const c=o(246),d=o(2517),tt=o(2039),nt={name:"Split",inputNames:["A"],inputTypes:[tt.TextureType.unpacked]};a.split=(ct,ot,at)=>{ut(ot);const ht=d.ShapeUtil.normalizeAxis(at.axis,ot[0].dims.length),ft=it(ct,ot,ht,at),mt=[];for(let yt=0;yt<ft;++yt)mt.push(ct.run(Object.assign(Object.assign({},nt),{cacheHint:`${at.cacheKey};${yt}`,get:()=>st(ct,ot[0],at,ht,yt)}),ot));return mt},a.parseSplitAttributes=ct=>{const ot=ct.attributes.getInt("axis",0),at=ct.attributes.getInts("split",[]),ht=ct.outputs.length;return(0,c.createAttributeWithCacheKey)({axis:ot,split:at,numOutputs:ht})};const it=(ct,ot,at,ht)=>{const[,ft]=d.SplitUtil.splitShape(ot[0].dims,at,ht.split,ht.numOutputs);return ft.length},st=(ct,ot,at,ht,ft)=>{const[mt,yt]=d.SplitUtil.splitShape(ot.dims,ht,at.split,at.numOutputs),bt=yt[ft],wt=mt[ft],Tt=`
      float process(int indices[${wt.length}]) {
        indices[${ht}] += ${bt};
        return _A(indices);
      }
    `;return Object.assign(Object.assign({},nt),{cacheHint:`${at.cacheKey}:${ft}`,output:{dims:wt,type:ot.type,textureType:tt.TextureType.unpacked},shaderSource:Tt})},ut=ct=>{if(!ct||ct.length!==1)throw new Error("Split requires one input.");if(ct[0].type!=="int8"&&ct[0].type!=="uint8"&&ct[0].type!=="int16"&&ct[0].type!=="uint16"&&ct[0].type!=="int32"&&ct[0].type!=="uint32"&&ct[0].type!=="float32"&&ct[0].type!=="float64"&&ct[0].type!=="bool")throw new Error("Invalid input type.")}},3933:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseSqueezeAttributes=a.squeezeV13=a.squeeze=void 0;const c=o(2517);a.squeeze=(nt,it,st)=>{d(it);const ut=c.ShapeUtil.squeezeShape(it[0].dims,st);return[nt.reshapeUnpacked(it[0],ut)]},a.squeezeV13=(nt,it)=>(tt(it),(0,a.squeeze)(nt,[it[0]],Array.from(it[1].integerData))),a.parseSqueezeAttributes=nt=>nt.attributes.getInts("axes");const d=nt=>{if(!nt||nt.length!==1)throw new Error("Squeeze requires 1 input.");if(nt[0].type==="string")throw new Error("invalid input tensor types.")},tt=nt=>{if(!nt||nt.length!==2)throw new Error("Squeeze requires 2 inputs.");if(nt[1].type!=="int32")throw new Error("Invalid input type.")}},6558:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.sum=void 0;const c=o(5060),d=o(2039);a.sum=(it,st)=>{nt(st);const ut={name:"Sum",inputNames:st.map((ct,ot)=>`X${ot}`),inputTypes:new Array(st.length).fill(d.TextureType.unpacked)};return[it.run(Object.assign(Object.assign({},ut),{get:()=>tt(it,st,ut)}),st)]};const tt=(it,st,ut)=>{const ct=(0,c.getGlsl)(it.session.backend.glContext.version),ot=st[0].dims.slice(),at=`
      void main() {
        vec4 result = ${st.map((ht,ft)=>`${ct.texture2D}(X${ft},TexCoords)`).join(" + ")};
        ${ct.output} = result;
      }
    `;return Object.assign(Object.assign({},ut),{output:{dims:ot,type:st[0].type,textureType:d.TextureType.unpacked},hasMain:!0,shaderSource:at})},nt=it=>{if(!it||it.length===0)throw new Error("Sum requires inputs.");const st=it[0].dims.length;for(let ut=1;ut<it.length;ut++){if(st!==it[ut].dims.length)throw new Error("Input shapes are mismatched.");for(let ct=0;ct<st;ct++)if(it[0].dims[ct]!==it[ut].dims[ct])throw new Error("Input shapes are not matched.")}if(it[0].type!=="float32"&&it[0].type!=="float64")throw new Error("Invalid input type.");for(let ut=1;ut<it.length;ut++)if(it[0].type!==it[ut].type)throw new Error("Input types are not matched.")}},5723:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.tile=void 0;const c=o(782),d=o(2039);a.tile=(it,st)=>{nt(st);const ut={name:"Tile",inputNames:["A"],inputTypes:[d.TextureType.unpacked]};return[it.run(Object.assign(Object.assign({},ut),{get:()=>tt(it,st,ut)}),st)]};const tt=(it,st,ut)=>{const ct=st[0].dims.slice(),ot=new Array(ct.length),at=[];for(let mt=0;mt<ct.length;mt++)ot[mt]=ct[mt]*st[1].numberData[mt],at.push(`inputIdx[${mt}] = int(mod(float(outputIdx[${mt}]), ${ct[mt]}.));`);const ht=ot.length,ft=`
      float process(int outputIdx[${ht}]) {
        int inputIdx[${ht}];
        ${at.join(`
`)}
        return _A(inputIdx);
      }
    `;return Object.assign(Object.assign({},ut),{output:{dims:ot,type:st[0].type,textureType:d.TextureType.unpacked},shaderSource:ft})},nt=it=>{if(!it||it.length!==2)throw new Error("Tile requires 2 input.");if(it[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(it[1].dims[0]!==it[0].dims.length)throw new Error("Invalid input shape.");if(c.NUMBER_TYPES.indexOf(it[0].type)===-1)throw new Error("Invalid input type.");if(it[1].type!=="int32"&&it[1].type!=="int16")throw new Error("Invalid repeat type.")}},3738:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseTransposeAttributes=a.transpose=void 0;const c=o(246),d=o(2517),tt=o(2039),nt={name:"Transpose",inputNames:["A"],inputTypes:[tt.TextureType.unpacked]};a.transpose=(at,ht,ft)=>(ot(ht),[at.run(Object.assign(Object.assign({},nt),{cacheHint:ft.cacheKey,get:()=>it(at,ht[0],ft.perm)}),ht)]),a.parseTransposeAttributes=at=>(0,c.createAttributeWithCacheKey)({perm:at.attributes.getInts("perm",[])});const it=(at,ht,ft)=>{const mt=ht.dims;ft=st(mt,ft);const yt=ut(mt,ft),bt=mt.length,wt=`
      ${ct("perm",ft,bt)}
      float process(int indices[${bt}]) {
        int a[${bt}];
        perm(a, indices);
        return _A(a);
      }`;return Object.assign(Object.assign({},nt),{output:{dims:yt,type:ht.type,textureType:tt.TextureType.unpacked},shaderSource:wt})},st=(at,ht)=>(ht&&ht.length!==at.length&&(ht=[...at.keys()].reverse()),ht),ut=(at,ht)=>(ht=st(at,ht),d.ShapeUtil.sortBasedOnPerm(at,ht)),ct=(at,ht,ft)=>{const mt=[];mt.push(`void ${at}(out int a[${ft}], int src[${ft}]) {`);for(let yt=0;yt<ft;++yt)mt.push(`	a[${ht[yt]}]=src[${yt}];`);return mt.push("	}"),mt.join(`
`)},ot=at=>{if(!at||at.length!==1)throw new Error("Transpose requires 1 input.");if(at[0].type!=="float32"&&at[0].type!=="float64")throw new Error("input should be float tensor")}},8710:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.encodeAsUint8=void 0;const c=o(5060),d=o(2039);a.encodeAsUint8=(tt,nt)=>{const it=nt.shape,st=(0,c.getGlsl)(tt.session.backend.glContext.version),ut=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${st.texture2D}(X,TexCoords).r;
      ${st.output} = encodeAsUint8(value);
    }`,ct={name:"Uint8Encode",inputTypes:[d.TextureType.unpacked],inputNames:["X"],output:{dims:it,type:nt.tensor.type,textureType:d.TextureType.downloadUint8AsFloat},shaderSource:ut,hasMain:!0};return tt.executeProgram(ct,[nt.tensor])}},4909:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.tanh=a.tan=a.sqrt=a.sin=a.sigmoid=a.relu=a.not=a.neg=a.log=a.parseLeakyReluAttributes=a.leakyRelu=a.identity=a.floor=a.exp=a.parseEluAttributes=a.elu=a.cos=a.ceil=a.clipV11=a.parseClipAttributes=a.clip=a.atan=a.asin=a.acos=a.abs=a.glslTanh=a.glslTan=a.glslSqrt=a.glslSigmoid=a.glslRelu=a.glslSin=a.glslNot=a.glslNeg=a.glslLog=a.glslLeakyRelu=a.glslIdentity=a.glslClip=a.glslFloor=a.glslExp=a.glslElu=a.glslCos=a.glslCeil=a.glslAtan=a.glslAsin=a.glslAcos=a.glslAbs=void 0;const c=o(246),d=o(2517),tt=o(8520),nt=o(5060),it=o(2039);function st(){return Xt("abs")}function ut(){return Xt("acos")}function ct(){return Xt("asin")}function ot(){return Xt("atan")}function at(){return Xt("ceil")}function ht(){return Xt("cos")}function ft(nr){const cr="elu";return{body:`
  const float alpha = float(${nr});

  float ${cr}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${cr}_(vec4 v) {
    return vec4(${cr}_(v.x), ${cr}_(v.y), ${cr}_(v.z), ${cr}_(v.w));
  }
  `,name:cr,type:tt.FunctionType.ValueBased}}function mt(){return Xt("exp")}function yt(){return Xt("floor")}function bt(nr,cr){const dr="clip";return{body:`
  const float min = float(${nr});
  const float max = float(${cr});

  float ${dr}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${dr}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:dr,type:tt.FunctionType.ValueBased}}function wt(){const nr="indentity";return{body:`
  float ${nr}_(float a) {
    return a;
  }
  vec4 ${nr}_(vec4 v) {
    return v;
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function Tt(nr){const cr="leakyRelu";return{body:`
  const float alpha = float(${nr});

  float ${cr}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${cr}_(vec4 v) {
    return vec4(${cr}_(v.x), ${cr}_(v.y), ${cr}_(v.z), ${cr}_(v.w));
  }
  `,name:cr,type:tt.FunctionType.ValueBased}}function Ct(){return Xt("log")}function Dt(){const nr="neg";return{body:`
  float ${nr}_(float a) {
    return -a;
  }
  vec4 ${nr}_(vec4 v) {
    return -v;
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function Ot(){const nr="not";return{body:`
  float ${nr}_(float a) {
    return float( ! bool(a) );
  }
  bool ${nr}_(bool a) {
    return !a;
  }
  vec4 ${nr}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${nr}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function $t(){return Xt("sin")}function Ft(){const nr="relu";return{body:`
  float ${nr}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${nr}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function kt(){const nr="sigmoid";return{body:`
  float ${nr}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${nr}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function Vt(){return Xt("sqrt")}function Ht(){return Xt("tan")}function Qt(){const nr="tanh";return{body:`
  float ${nr}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${nr}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}function Xt(nr){return{body:`
  float ${nr}_(float a) {
    return ${nr}(a);
  }
  vec4 ${nr}_(vec4 v) {
    return ${nr}(v);
  }
  `,name:nr,type:tt.FunctionType.ValueBased}}a.glslAbs=st,a.glslAcos=ut,a.glslAsin=ct,a.glslAtan=ot,a.glslCeil=at,a.glslCos=ht,a.glslElu=ft,a.glslExp=mt,a.glslFloor=yt,a.glslClip=bt,a.glslIdentity=wt,a.glslLeakyRelu=Tt,a.glslLog=Ct,a.glslNeg=Dt,a.glslNot=Ot,a.glslSin=$t,a.glslRelu=Ft,a.glslSigmoid=kt,a.glslSqrt=Vt,a.glslTan=Ht,a.glslTanh=Qt;const Zt=(nr,cr,dr,mr)=>{const Dr=nr.session.pack?it.TextureType.packed:it.TextureType.unpacked,kr={name:dr.name,inputTypes:[Dr],inputNames:["A"],cacheHint:mr};return Object.assign(Object.assign({},kr),{get:()=>((Yr,Mr,Jr,an)=>{const xn=Yr.session.pack?it.TextureType.packed:it.TextureType.unpacked,Rn=(0,nt.getGlsl)(Yr.session.backend.glContext.version);return Object.assign(Object.assign({},Mr),{output:{dims:Jr.dims,type:Jr.type,textureType:xn},shaderSource:`
     ${an.body}
     void main() {
       vec4 v = ${Rn.texture2D}(A, TexCoords);
       v = ${an.name}_(v);
       ${Rn.output} = v;
     }
     `,hasMain:!0})})(nr,kr,cr,dr)})};a.abs=(nr,cr)=>[nr.run(Zt(nr,cr[0],st()),cr)],a.acos=(nr,cr)=>[nr.run(Zt(nr,cr[0],ut()),cr)],a.asin=(nr,cr)=>[nr.run(Zt(nr,cr[0],ct()),cr)],a.atan=(nr,cr)=>[nr.run(Zt(nr,cr[0],ot()),cr)],a.clip=(nr,cr,dr)=>[nr.run(Zt(nr,cr[0],bt(dr.min,dr.max),dr.cacheKey),cr)],a.parseClipAttributes=nr=>(0,c.createAttributeWithCacheKey)({min:nr.attributes.getFloat("min",d.MIN_CLIP),max:nr.attributes.getFloat("max",d.MAX_CLIP)}),a.clipV11=(nr,cr)=>{const dr=ar(nr,cr);return(0,a.clip)(nr,[cr[0]],dr)};const ar=(nr,cr)=>{if(cr.length>=3&&(!nr.session.isInitializer(cr[1].dataId)||!nr.session.isInitializer(cr[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const dr=cr.length>=3?cr[1].numberData[0]:d.MIN_CLIP,mr=cr.length>=3?cr[2].numberData[0]:d.MAX_CLIP;return(0,c.createAttributeWithCacheKey)({min:dr,max:mr})};a.ceil=(nr,cr)=>[nr.run(Zt(nr,cr[0],at()),cr)],a.cos=(nr,cr)=>[nr.run(Zt(nr,cr[0],ht()),cr)],a.elu=(nr,cr,dr)=>[nr.run(Zt(nr,cr[0],ft(dr.alpha),dr.cacheKey),cr)],a.parseEluAttributes=nr=>(0,c.createAttributeWithCacheKey)({alpha:nr.attributes.getFloat("alpha",1)}),a.exp=(nr,cr)=>[nr.run(Zt(nr,cr[0],mt()),cr)],a.floor=(nr,cr)=>[nr.run(Zt(nr,cr[0],yt()),cr)],a.identity=(nr,cr)=>[nr.run(Zt(nr,cr[0],wt()),cr)],a.leakyRelu=(nr,cr,dr)=>[nr.run(Zt(nr,cr[0],Tt(dr.alpha),dr.cacheKey),cr)],a.parseLeakyReluAttributes=nr=>(0,c.createAttributeWithCacheKey)({alpha:nr.attributes.getFloat("alpha",.01)}),a.log=(nr,cr)=>[nr.run(Zt(nr,cr[0],Ct()),cr)],a.neg=(nr,cr)=>[nr.run(Zt(nr,cr[0],Dt()),cr)],a.not=(nr,cr)=>[nr.run(Zt(nr,cr[0],Ot()),cr)],a.relu=(nr,cr)=>[nr.run(Zt(nr,cr[0],Ft()),cr)],a.sigmoid=(nr,cr)=>[nr.run(Zt(nr,cr[0],kt()),cr)],a.sin=(nr,cr)=>[nr.run(Zt(nr,cr[0],$t()),cr)],a.sqrt=(nr,cr)=>[nr.run(Zt(nr,cr[0],Vt()),cr)],a.tan=(nr,cr)=>[nr.run(Zt(nr,cr[0],Ht()),cr)],a.tanh=(nr,cr)=>[nr.run(Zt(nr,cr[0],Qt()),cr)]},5611:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createUnpackProgramInfoLoader=a.createUnpackProgramInfo=void 0;const c=o(5060),d=o(2039),tt=o(9390),nt=o(2827),it={name:"unpack",inputNames:["A"],inputTypes:[d.TextureType.packed]};a.createUnpackProgramInfo=(st,ut)=>{const ct=ut.dims.length,ot=(0,nt.getChannels)("rc",ct),at=ot.slice(-2),ht=(0,tt.getCoordsDataType)(ct),ft=(0,nt.unpackFromChannel)(),mt=ut.dims.length===0?"":function(wt,Tt){if(wt===1)return"rc";let Ct="";for(let Dt=0;Dt<wt;Dt++)Ct+=Tt[Dt],Dt<wt-1&&(Ct+=",");return Ct}(ct,ot),yt=ct<=1?"rc":`vec2(${at.join(",")})`,bt=`
    ${ft}
    void main() {
      ${ht} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${mt});

       ${(0,c.getGlsl)(st.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${yt}), 0, 0, 0);
     }
   `;return Object.assign(Object.assign({},it),{hasMain:!0,output:{dims:ut.dims,type:ut.type,textureType:d.TextureType.unpacked},shaderSource:bt})},a.createUnpackProgramInfoLoader=(st,ut)=>Object.assign(Object.assign({},it),{get:()=>(0,a.createUnpackProgramInfo)(st,ut)})},8428:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.parseUnsqueezeAttributes=a.unsqueezeV13=a.unsqueeze=void 0;const c=o(2517);a.unsqueeze=(nt,it,st)=>{d(it);const ut=c.ShapeUtil.unsqueezeShape(it[0].dims,st);return[nt.reshapeUnpacked(it[0],ut)]},a.unsqueezeV13=(nt,it)=>(tt(it),(0,a.unsqueeze)(nt,[it[0]],Array.from(it[1].integerData))),a.parseUnsqueezeAttributes=nt=>nt.attributes.getInts("axes");const d=nt=>{if(!nt||nt.length!==1)throw new Error("Unsqueeze requires 1 input.");if(nt[0].type==="string")throw new Error("invalid input tensor types.")},tt=nt=>{if(!nt||nt.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(nt[1].type!=="int32")throw new Error("Invalid input type.")}},9793:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.scalesValidation=a.validateInputs=a.parseUpsampleAttributes=a.parseUpsampleAttributesV9=a.parseUpsampleAttributesV7=a.upsample=void 0;const c=o(246),d=o(5060),tt=o(2039),nt={name:"Upsample",inputNames:["X"],inputTypes:[tt.TextureType.unpacked]};a.upsample=(st,ut,ct)=>((0,a.validateInputs)(ut,ct),[st.run(Object.assign(Object.assign({},nt),{cacheHint:ct.cacheKey,get:()=>it(st,ut,ct)}),ut)]),a.parseUpsampleAttributesV7=st=>(0,a.parseUpsampleAttributes)(st,7),a.parseUpsampleAttributesV9=st=>(0,a.parseUpsampleAttributes)(st,9),a.parseUpsampleAttributes=(st,ut)=>{const ct=ut>=10,ot=st.attributes.getString("mode","nearest");if(ot!=="nearest"&&ot!=="linear"&&(ut<11||ot!=="cubic"))throw new Error(`unrecognized mode: ${ot}`);let at=[];ut<9&&(at=st.attributes.getFloats("scales"),(0,a.scalesValidation)(at,ot,ct));const ht=st.attributes.getFloat("extrapolation_value",0),ft=ut>10?st.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(ft)===-1)throw new Error(`coordinate_transform_mode '${ft}' is not supported`);const mt=ft==="tf_crop_and_resize",yt=mt,bt=ot==="nearest"&&ut>=11?st.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(bt)===-1)throw new Error(`nearest_mode '${bt}' is not supported`);const wt=st.attributes.getFloat("cubic_coeff_a",-.75),Tt=st.attributes.getInt("exclude_outside",0)!==0;if(Tt&&ot!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const Ct=ut<11||ot==="nearest"&&ft==="asymmetric"&&bt==="floor";let Dt=0,Ot=0,$t=0;return ut>10?st.inputs.length>2?(Dt=1,Ot=2,$t=3):(Ot=1,$t=2):ut===9&&(Ot=1),(0,c.createAttributeWithCacheKey)({opset:ut,isResize:ct,mode:ot,scales:at,extrapolationValue:ht,coordinateTransformMode:ft,useExtrapolation:yt,needRoiInput:mt,nearestMode:bt,cubicCoefficientA:wt,excludeOutside:Tt,useNearest2xOptimization:Ct,roiInputIdx:Dt,scalesInputIdx:Ot,sizesInputIdx:$t})};const it=(st,ut,ct)=>{const ot=(0,d.getGlsl)(st.session.backend.glContext.version),[at,ht]=st.calculateTextureWidthAndHeight(ut[0].dims,tt.TextureType.unpacked),ft=ut[0].dims.map(($t,Ft)=>Math.floor($t*ct.scales[Ft])),[mt,yt]=st.calculateTextureWidthAndHeight(ft,tt.TextureType.unpacked),bt=ft.length,wt=new Array(bt),Tt=new Array(bt);let Ct=`
      int output_pitches[${bt}];
      int input_pitches[${bt}];
      `;for(let $t=bt-1;$t>=0;$t--)wt[$t]=$t===bt-1?1:wt[$t+1]*ft[$t+1],Tt[$t]=$t===bt-1?1:Tt[$t+1]*ut[0].dims[$t+1],Ct+=`
        output_pitches[${$t}] = ${wt[$t]};
        input_pitches[${$t}] = ${Tt[$t]};
        `;const Dt=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${at}, ${ht});
        float value = getColorAsFloat(${ot.texture2D}(X, coords));
        return value;
      }
      `,Ot=ct.mode==="nearest"?`
    ${Dt}
    float process(int indices[${bt}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${mt}, ${yt});

      ${Ct}

      int d, m;
      for (int dim = 0; dim < ${bt}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:bt===4?`
    ${Dt}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${mt}, ${yt});

      ${Ct}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${ut[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${Dt}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${mt}, ${yt});

      ${Ct}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${ut[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return Object.assign(Object.assign({},nt),{output:{dims:ft,type:ut[0].type,textureType:tt.TextureType.unpacked},shaderSource:Ot,variables:[{name:"scales",type:"int",arrayLength:ct.scales.length,data:ct.scales.map($t=>Math.ceil($t))}]})};a.validateInputs=(st,ut)=>{if(!st||ut.opset<9&&st.length!==1||ut.opset>=9&&ut.opset<11&&st.length!==2||ut.opset>=11&&st.length<2)throw new Error("invalid inputs.");if(ut.scales.length>0&&st[0].dims.length!==ut.scales.length)throw new Error("Invalid input shape.");if(st[0].type==="string")throw new Error("Invalid input tensor types.")},a.scalesValidation=(st,ut,ct)=>{if(ct){for(const ot of st)if(ot<=0)throw new Error("Scale value should be greater than 0.")}else for(const ot of st)if(ot<1)throw new Error("Scale value should be greater than or equal to 1.");if(!(ut!=="linear"&&ut!=="cubic"||st.length===2||st.length===4&&st[0]===1&&st[1]===1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${ct?"Resize":"Upsample"} opeartor.`)}},1958:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ProgramManager=void 0;const c=o(1670),d=o(6231),tt=o(8879),nt=o(5060);a.ProgramManager=class{constructor(it,st,ut){this.profiler=it,this.glContext=st,this.textureLayoutStrategy=ut,this.repo=new Map,this.attributesBound=!1}getArtifact(it){return this.repo.get(it)}setArtifact(it,st){this.repo.set(it,st)}run(it,st,ut){var ct;this.profiler.event("op",`ProgramManager.run ${(ct=it.programInfo.name)!==null&&ct!==void 0?ct:"unknown kernel"}`,()=>{var ot;const at=this.glContext.gl,ht=it.program;at.useProgram(ht);try{this.bindOutput(ut),this.attributesBound||this.bindAttributes(it.attribLocations),this.bindUniforms(it.uniformLocations,(ot=it.programInfo.variables)!==null&&ot!==void 0?ot:[],st)}catch(ft){throw d.Logger.error("ProgramManager",it.programInfo.shaderSource),ft}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(it=>this.glContext.deleteProgram(it.program))}build(it,st,ut){return this.profiler.event("backend","ProgramManager.build",()=>{const ct=new tt.GlslPreprocessor(this.glContext,it,st,ut),ot=ct.preprocess(),at=this.compile(ot);return{programInfo:it,program:at,uniformLocations:this.getUniformLocations(at,ct.context.programInfo.inputNames,ct.context.programInfo.variables),attribLocations:this.getAttribLocations(at)}})}compile(it){if(!this.vertexShader){d.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const ct=(0,nt.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(ct,this.glContext.gl.VERTEX_SHADER)}c.env.debug&&d.Logger.verbose("ProrgramManager",`FragShader:
${it}
`);const st=this.glContext.compileShader(it,this.glContext.gl.FRAGMENT_SHADER),ut=this.glContext.createProgram(this.vertexShader,st);return this.glContext.deleteShader(st),ut}bindOutput(it){const st=it.width,ut=it.height;d.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${st}/${ut}, shape=${it.shape}, type=${it.tensor.type}`),this.glContext.attachFramebuffer(it.texture,st,ut)}bindAttributes(it){const st=it.position,ut=it.textureCoord;this.glContext.setVertexAttributes(st,ut),this.attributesBound=!0}bindUniforms(it,st,ut){var ct;const ot=this.glContext.gl;let at=0;for(const{name:ht,type:ft,location:mt,arrayLength:yt}of it){const bt=(ct=st.find(wt=>wt.name===ht))===null||ct===void 0?void 0:ct.data;if(ft!=="sampler2D"&&!bt)throw new Error(`variable '${ht}' does not have data defined in program info`);switch(ft){case"sampler2D":this.bindTexture(ut[at],mt,at),at++;break;case"float":yt?ot.uniform1fv(mt,bt):ot.uniform1f(mt,bt);break;case"int":yt?ot.uniform1iv(mt,bt):ot.uniform1i(mt,bt);break;default:throw new Error(`Uniform not implemented: ${ft}`)}}}bindTexture(it,st,ut){this.glContext.bindTextureToUniform(it.texture,ut,st)}getAttribLocations(it){return{position:this.getAttribLocation(it,"position"),textureCoord:this.getAttribLocation(it,"textureCoord")}}getUniformLocations(it,st,ut){const ct=[];if(st)for(const ot of st)ct.push({name:ot,type:"sampler2D",location:this.getUniformLocation(it,ot)});if(ut)for(const ot of ut)ct.push(Object.assign(Object.assign({},ot),{location:this.getUniformLocation(it,ot.name)}));return ct}getUniformLocation(it,st){const ut=this.glContext.gl.getUniformLocation(it,st);if(ut===null)throw new Error(`Uniform ${st} not found.`);return ut}getAttribLocation(it,st){return this.glContext.gl.getAttribLocation(it,st)}}},6416:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WebGLSessionHandler=void 0;const c=o(6231),d=o(1047),tt=o(8316),nt=o(1640),it=o(1958),st=o(7859),ut=o(5702);a.WebGLSessionHandler=class{constructor(ct,ot){this.backend=ct,this.context=ot,this.layoutStrategy=new st.PreferLogicalStrategy(ct.glContext.maxTextureSize),this.programManager=new it.ProgramManager(this.context.profiler,ct.glContext,this.layoutStrategy),this.textureManager=new ut.TextureManager(ct.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:ct.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=ct.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new tt.WebGLInferenceHandler(this)}onGraphInitialized(ct){const ot=ct.getValues().filter(at=>at.from===-1&&at.tensor).map(at=>at.tensor.dataId);this.initializers=new Set(ot)}isInitializer(ct){return!!this.initializers&&this.initializers.has(ct)}addInitializer(ct){this.initializers.add(ct)}getTextureData(ct,ot){return ot?this.packedTextureDataCache.get(ct):this.unpackedTextureDataCache.get(ct)}setTextureData(ct,ot,at=!1){c.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),at?this.packedTextureDataCache.set(ct,ot):this.unpackedTextureDataCache.set(ct,ot)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(ct=>this.textureManager.releaseTexture(ct,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(ct=>this.textureManager.releaseTexture(ct,!0)),this.unpackedTextureDataCache=new Map}resolve(ct,ot,at){const ht=(0,d.resolveOperator)(ct,ot,nt.WEBGL_OP_RESOLVE_RULES);return{impl:ht.opImpl,context:ht.opInit?ht.opInit(ct,at):ct}}}},7769:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Uint8DataEncoder=a.RGBAFloatDataEncoder=a.RedFloat32DataEncoder=void 0;const c=o(6231);a.RedFloat32DataEncoder=class{constructor(d,tt=1){if(tt===1)this.internalFormat=d.R32F,this.format=d.RED,this.textureType=d.FLOAT,this.channelSize=tt;else{if(tt!==4)throw new Error(`Invalid number of channels: ${tt}`);this.internalFormat=d.RGBA32F,this.format=d.RGBA,this.textureType=d.FLOAT,this.channelSize=tt}}encode(d,tt){let nt,it;return d.constructor!==Float32Array&&(c.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),it=new Float32Array(d)),tt*this.channelSize>d.length?(c.Logger.warning("Encoder","Source data too small. Allocating larger array"),it=d,nt=this.allocate(tt*this.channelSize),it.forEach((st,ut)=>nt[ut]=st)):(it=d,nt=it),nt}allocate(d){return new Float32Array(4*d)}decode(d,tt){return this.channelSize===1?d.filter((nt,it)=>it%4==0).subarray(0,tt):d.subarray(0,tt)}},a.RGBAFloatDataEncoder=class{constructor(d,tt=1,nt){if(tt!==1&&tt!==4)throw new Error(`Invalid number of channels: ${tt}`);this.internalFormat=d.RGBA,this.format=d.RGBA,this.channelSize=tt,this.textureType=nt||d.FLOAT}encode(d,tt){let nt=d;return this.channelSize===1&&(c.Logger.verbose("Encoder","Exploding into a larger array"),nt=this.allocate(tt),d.forEach((it,st)=>nt[4*st]=it)),nt}allocate(d){return new Float32Array(4*d)}decode(d,tt){return this.channelSize===1?d.filter((nt,it)=>it%4==0).subarray(0,tt):d.subarray(0,tt)}},a.Uint8DataEncoder=class{constructor(d,tt=1){if(this.channelSize=4,tt===1)this.internalFormat=d.ALPHA,this.format=d.ALPHA,this.textureType=d.UNSIGNED_BYTE,this.channelSize=tt;else{if(tt!==4)throw new Error(`Invalid number of channels: ${tt}`);this.internalFormat=d.RGBA,this.format=d.RGBA,this.textureType=d.UNSIGNED_BYTE,this.channelSize=tt}}encode(d,tt){return new Uint8Array(d.buffer,d.byteOffset,d.byteLength)}allocate(d){return new Uint8Array(d*this.channelSize)}decode(d,tt){if(d instanceof Uint8Array)return d.subarray(0,tt);throw new Error(`Invalid array type: ${d.constructor}`)}}},7859:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getBatchDim=a.sizeToSquarishShape=a.getRowsCols=a.sizeFromShape=a.isInt=a.parseAxisParam=a.squeezeShape=a.PreferLogicalStrategy=a.AlwaysKeepOriginalSizeStrategy=void 0;const c=o(6231),d=o(2517);function tt(ct,ot){const at=[],ht=[],ft=ot!=null&&Array.isArray(ot)&&ot.length===0,mt=ot==null||ft?null:nt(ot,ct).sort();let yt=0;for(let bt=0;bt<ct.length;++bt){if(mt!=null){if(mt[yt]===bt&&ct[bt]!==1)throw new Error(`Can't squeeze axis ${bt} since its dim '${ct[bt]}' is not 1`);(mt[yt]==null||mt[yt]>bt)&&ct[bt]===1&&(at.push(ct[bt]),ht.push(bt)),mt[yt]<=bt&&yt++}ct[bt]!==1&&(at.push(ct[bt]),ht.push(bt))}return{newShape:at,keptDims:ht}}function nt(ct,ot){const at=ot.length;return ct=ct==null?ot.map((ht,ft)=>ft):[].concat(ct),(0,d.assert)(ct.every(ht=>ht>=-at&&ht<at),()=>`All values in axis param must be in range [-${at}, ${at}) but got axis ${ct}`),(0,d.assert)(ct.every(it),()=>`All values in axis param must be integers but got axis ${ct}`),ct.map(ht=>ht<0?at+ht:ht)}function it(ct){return ct%1==0}function st(ct){if(ct.length===0)return 1;let ot=ct[0];for(let at=1;at<ct.length;at++)ot*=ct[at];return ot}function ut(ct){const ot=Math.ceil(Math.sqrt(ct));return[ot,Math.ceil(ct/ot)]}a.AlwaysKeepOriginalSizeStrategy=class{constructor(ct){this.maxTextureSize=ct}computeTextureWH(ct,ot){if(ct.length===0)return[1,1];const at=this.maxTextureSize;if(ot&&ot.breakAxis!==void 0){const mt=ot.breakAxis>=ct.length?1:ct.slice(ot.breakAxis).reduce((bt,wt)=>bt*wt),yt=ot.breakAxis<=0?1:ct.slice(0,ot.breakAxis).reduce((bt,wt)=>bt*wt);if(!(mt>at||yt>at))return[mt,yt];c.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${ct}, breakAxis:${ot.breakAxis}`)}const ht=ct.reduce((mt,yt)=>mt*yt);let ft=Math.floor(Math.sqrt(ht));for(;ft<at&&ft<ht&&ht%ft!=0;ft++);if(ft>=at||ht%ft!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${ct}`);return[ft,ht/ft]}},a.PreferLogicalStrategy=class{constructor(ct){this.maxTextureSize=ct}computeTextureWH(ct,ot){const at=this.computeTexture(ct,ot);return ot&&ot.isPacked&&(at[0]/=2,at[1]/=2),ot&&ot.reverseWH?[at[1],at[0]]:at}computeTexture(ct,ot){const at=ot&&ot.isPacked;if(ct.length===0)return at?[2,2]:[1,1];let ht=this.maxTextureSize;if(ot&&ot.breakAxis!==void 0){const yt=ot.breakAxis>=ct.length?1:ct.slice(ot.breakAxis).reduce((wt,Tt)=>wt*Tt),bt=ot.breakAxis<=0?1:ct.slice(0,ot.breakAxis).reduce((wt,Tt)=>wt*Tt);if(!(yt>ht||bt>ht))return[yt,bt];c.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${ct}, breakAxis:${ot.breakAxis}`)}let ft=ct.slice(0);at&&(ht*=2,ft=ft.map((yt,bt)=>bt>=ft.length-2?ft[bt]%2==0?ft[bt]:ft[bt]+1:ft[bt]),ft.length===1&&(ft=[2,ft[0]])),ft.length!==2&&(ft=tt(ft).newShape);const mt=st(ft);return ft.length<=1&&mt<=ht?[1,mt]:ft.length===2&&ft[0]<=ht&&ft[1]<=ht?ft:ft.length===3&&ft[0]*ft[1]<=ht&&ft[2]<=ht?[ft[0]*ft[1],ft[2]]:ft.length===3&&ft[0]<=ht&&ft[1]*ft[2]<=ht?[ft[0],ft[1]*ft[2]]:ft.length===4&&ft[0]*ft[1]*ft[2]<=ht&&ft[3]<=ht?[ft[0]*ft[1]*ft[2],ft[3]]:ft.length===4&&ft[0]<=ht&&ft[1]*ft[2]*ft[3]<=ht?[ft[0],ft[1]*ft[2]*ft[3]]:at?ut(mt/4).map(yt=>2*yt):ut(mt)}},a.squeezeShape=tt,a.parseAxisParam=nt,a.isInt=it,a.sizeFromShape=st,a.getRowsCols=function(ct){if(ct.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[ct.length>1?ct[ct.length-2]:1,ct[ct.length-1]]},a.sizeToSquarishShape=ut,a.getBatchDim=function(ct,ot=2){return st(ct.slice(0,ct.length-ot))}},4057:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createTextureLayoutFromShape=a.calculateTextureWidthAndHeight=a.createTextureLayoutFromTextureType=void 0;const c=o(2517),d=o(2039);a.createTextureLayoutFromTextureType=(tt,nt,it)=>{const st=it===d.TextureType.unpacked||it===d.TextureType.unpackedReversed?1:4,ut=it===d.TextureType.packed,ct=it===d.TextureType.unpackedReversed||it===d.TextureType.packed,ot=it===d.TextureType.packedLastDimension?nt.length-1:void 0,at=it===d.TextureType.packedLastDimension?nt.map((ht,ft)=>ft===nt.length-1?4*ht:ht):void 0;return(0,a.createTextureLayoutFromShape)(tt,nt,st,at,{isPacked:ut,reverseWH:ct,breakAxis:ot})},a.calculateTextureWidthAndHeight=(tt,nt,it)=>{const st=(0,a.createTextureLayoutFromTextureType)(tt,nt,it);return[st.width,st.height]},a.createTextureLayoutFromShape=(tt,nt,it=1,st,ut)=>{const ct=!(!ut||!ut.isPacked),[ot,at]=tt.computeTextureWH(ct&&st||nt,ut),ht=nt.length;let ft=nt.slice(0);if(ht===0&&(ft=[1]),it===1)st=nt;else if(ct){if(it!==4)throw new Error("a packed texture must be 4-channel");st=nt,ht>0&&(ft[ht-1]=Math.ceil(ft[ht-1]/2)),ht>1&&(ft[ht-2]=Math.ceil(ft[ht-2]/2))}else if(!st)throw new Error("Unpacked shape is needed when using channels > 1");return{width:ot,height:at,channels:it,isPacked:ct,shape:ft,strides:c.ShapeUtil.computeStrides(ft),unpackedShape:st,reversedWH:ut&&ut.reverseWH}}},5702:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextureManager=void 0;const c=o(6231);a.TextureManager=class{constructor(d,tt,nt,it){this.glContext=d,this.layoutStrategy=tt,this.profiler=nt,this.config=it,this.pendingRead=new Map,it.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(d,tt,nt,it){const st=this.toEncoderType(d),ut=this.glContext.getEncoder(st,tt.channels||1,it);if(tt.isPacked&&it===1)throw new Error("not implemented");const ct=tt.width,ot=tt.height;let at,ht;if(this.config.reuseTextures){at=`${ct}x${ot}_${ut.format}_${ut.internalFormat}_${ut.textureType}`,ht=this.inUseTextures.get(at),ht||(ht=[],this.inUseTextures.set(at,ht));const mt=this.idleTextures.get(at);if(mt&&mt.length>0){const yt=mt.pop();return ht.push(yt),it===1&&this.glContext.updateTexture(yt,ct,ot,ut,this.toTextureData(d,nt)),yt}}c.Logger.verbose("TextureManager",`Creating new texture of size ${tt.width}x${tt.height}`);const ft=this.glContext.allocateTexture(ct,ot,ut,this.toTextureData(d,nt));return this.config.reuseTextures&&(ht.push(ft),this.textureLookup.set(ft,at)),ft}readTexture(d,tt,nt){return nt||(nt=1),this.profiler.event("backend","TextureManager.readTexture",()=>{const it=d.shape.reduce((ut,ct)=>ut*ct)*nt,st=this.glContext.readTexture(d.texture,d.width,d.height,it,this.toEncoderType(tt),nt);return this.toTensorData(tt,st)})}async readTextureAsync(d,tt,nt){const it=d.tensor.dataId;if(nt||(nt=1),this.pendingRead.has(it)){const st=this.pendingRead.get(it);return new Promise(ut=>st?.push(ut))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(it,[]);const st=d.shape.reduce((at,ht)=>at*ht)*nt;await this.glContext.createAndWaitForFence();const ut=this.glContext.readTexture(d.texture,d.width,d.height,st,this.toEncoderType(tt),nt),ct=this.toTensorData(tt,ut),ot=this.pendingRead.get(it);return this.pendingRead.delete(it),ot?.forEach(at=>at(ct)),ct})}readUint8TextureAsFloat(d){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{const tt=d.shape.reduce((it,st)=>it*st),nt=this.glContext.readTexture(d.texture,d.width,d.height,4*tt,"byte",4);return new Float32Array(nt.buffer,nt.byteOffset,tt)})}releaseTexture(d,tt){let nt;if(this.config.reuseTextures&&(nt=this.textureLookup.get(d.texture),nt)){tt&&this.textureLookup.delete(nt);const it=this.inUseTextures.get(nt);if(it){const st=it.indexOf(d.texture);if(st!==-1){it.splice(st,1);let ut=this.idleTextures.get(nt);ut||(ut=[],this.idleTextures.set(nt,ut)),ut.push(d.texture)}}}nt&&!tt||(c.Logger.verbose("TextureManager",`Deleting texture of size ${d.width}x${d.height}`),this.glContext.deleteTexture(d.texture))}toTensorData(d,tt){switch(d){case"int16":return tt instanceof Int16Array?tt:Int16Array.from(tt);case"int32":return tt instanceof Int32Array?tt:Int32Array.from(tt);case"int8":return tt instanceof Int8Array?tt:Int8Array.from(tt);case"uint16":return tt instanceof Uint16Array?tt:Uint16Array.from(tt);case"uint32":return tt instanceof Uint32Array?tt:Uint32Array.from(tt);case"uint8":case"bool":return tt instanceof Uint8Array?tt:Uint8Array.from(tt);case"float32":return tt instanceof Float32Array?tt:Float32Array.from(tt);case"float64":return tt instanceof Float64Array?tt:Float64Array.from(tt);default:throw new Error(`TensorData type ${d} is not supported`)}}toTextureData(d,tt){if(tt)return tt instanceof Float32Array?tt:new Float32Array(tt)}toEncoderType(d){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},2039:(s,a)=>{var o;Object.defineProperty(a,"__esModule",{value:!0}),a.TextureType=void 0,(o=a.TextureType||(a.TextureType={}))[o.unpacked=0]="unpacked",o[o.unpackedReversed=1]="unpackedReversed",o[o.packed=2]="packed",o[o.downloadUint8AsFloat=3]="downloadUint8AsFloat",o[o.packedLastDimension=4]="packedLastDimension"},9390:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getGlChannels=a.getCoordsDataType=a.getSqueezedParams=a.squeezeInputShape=a.generateShaderFuncNameFromInputSamplerNameAtOutCoords=a.generateShaderFuncNameFromInputSamplerName=a.repeatedTry=a.getPackedShape=void 0;const c=o(2517);a.getPackedShape=function(d){const tt=d.length;return d.slice(0,tt-1).concat(d[tt-1]/4)},a.repeatedTry=async function(d,tt=it=>0,nt){return new Promise((it,st)=>{let ut=0;const ct=()=>{if(d())return void it();ut++;const ot=tt(ut);nt!=null&&ut>=nt?st():setTimeout(ct,ot)};ct()})},a.generateShaderFuncNameFromInputSamplerName=function(d){return(0,c.assert)(d!==void 0&&d.length!==0,()=>"empty string found for sampler name"),"get"+d.charAt(0).toUpperCase()+d.slice(1)},a.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(d){return(0,c.assert)(d!==void 0&&d.length!==0,()=>"empty string found for sampler name"),"get"+d.charAt(0).toUpperCase()+d.slice(1)+"AtOutCoords"},a.squeezeInputShape=function(d,tt){let nt=JSON.parse(JSON.stringify(d));return nt=tt,nt},a.getSqueezedParams=function(d,tt){return tt.map(nt=>d[nt]).join(", ")},a.getCoordsDataType=function(d){if(d<=1)return"int";if(d===2)return"ivec2";if(d===3)return"ivec3";if(d===4)return"ivec4";if(d===5)return"ivec5";if(d===6)return"ivec6";throw Error(`GPU for rank ${d} is not yet supported`)},a.getGlChannels=function(d=6){return["x","y","z","w","u","v"].slice(0,d)}},7305:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createNewWebGLContext=a.createWebGLContext=void 0;const c=o(6231),d=o(1713),tt={};function nt(it){const st=function(){if(typeof document>"u"){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}const ot=document.createElement("canvas");return ot.width=1,ot.height=1,ot}();let ut;const ct={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!it||it==="webgl2")&&(ut=st.getContext("webgl2",ct),ut))try{return new d.WebGLContext(ut,2)}catch(ot){c.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${ot}`)}if((!it||it==="webgl")&&(ut=st.getContext("webgl",ct)||st.getContext("experimental-webgl",ct),ut))try{return new d.WebGLContext(ut,1)}catch(ot){c.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${ot}`)}throw new Error("WebGL is not supported")}a.createWebGLContext=function it(st){let ut;st&&st!=="webgl2"||!("webgl2"in tt)?st&&st!=="webgl"||!("webgl"in tt)||(ut=tt.webgl):ut=tt.webgl2,ut=ut||nt(st),st=st||ut.version===1?"webgl":"webgl2";const ct=ut.gl;return tt[st]=ut,ct.isContextLost()?(delete tt[st],it(st)):(ct.disable(ct.DEPTH_TEST),ct.disable(ct.STENCIL_TEST),ct.disable(ct.BLEND),ct.disable(ct.DITHER),ct.disable(ct.POLYGON_OFFSET_FILL),ct.disable(ct.SAMPLE_COVERAGE),ct.enable(ct.SCISSOR_TEST),ct.enable(ct.CULL_FACE),ct.cullFace(ct.BACK),ut)},a.createNewWebGLContext=nt},1713:function(s,a,o){var c=this&&this.__createBinding||(Object.create?function(ct,ot,at,ht){ht===void 0&&(ht=at);var ft=Object.getOwnPropertyDescriptor(ot,at);ft&&!("get"in ft?!ot.__esModule:ft.writable||ft.configurable)||(ft={enumerable:!0,get:function(){return ot[at]}}),Object.defineProperty(ct,ht,ft)}:function(ct,ot,at,ht){ht===void 0&&(ht=at),ct[ht]=ot[at]}),d=this&&this.__setModuleDefault||(Object.create?function(ct,ot){Object.defineProperty(ct,"default",{enumerable:!0,value:ot})}:function(ct,ot){ct.default=ot}),tt=this&&this.__importStar||function(ct){if(ct&&ct.__esModule)return ct;var ot={};if(ct!=null)for(var at in ct)at!=="default"&&Object.prototype.hasOwnProperty.call(ct,at)&&c(ot,ct,at);return d(ot,ct),ot};Object.defineProperty(a,"__esModule",{value:!0}),a.WebGLContext=a.linearSearchLastTrue=void 0;const nt=o(1670),it=tt(o(7769)),st=o(9390);function ut(ct){let ot=0;for(;ot<ct.length&&ct[ot]();++ot);return ot-1}a.linearSearchLastTrue=ut,a.WebGLContext=class{constructor(ct,ot){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=ct,this.version=ot,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(ct,ot,at,ht){const ft=this.gl,mt=ft.createTexture();ft.bindTexture(ft.TEXTURE_2D,mt),ft.texParameteri(ft.TEXTURE_2D,ft.TEXTURE_MIN_FILTER,ft.NEAREST),ft.texParameteri(ft.TEXTURE_2D,ft.TEXTURE_MAG_FILTER,ft.NEAREST),ft.texParameteri(ft.TEXTURE_2D,ft.TEXTURE_WRAP_S,ft.CLAMP_TO_EDGE),ft.texParameteri(ft.TEXTURE_2D,ft.TEXTURE_WRAP_T,ft.CLAMP_TO_EDGE);const yt=ht?at.encode(ht,ct*ot):null;return ft.texImage2D(ft.TEXTURE_2D,0,at.internalFormat,ct,ot,0,at.format,at.textureType,yt),this.checkError(),mt}updateTexture(ct,ot,at,ht,ft){const mt=this.gl;mt.bindTexture(mt.TEXTURE_2D,ct);const yt=ht.encode(ft,ot*at);mt.texSubImage2D(mt.TEXTURE_2D,0,0,0,ot,at,ht.format,ht.textureType,yt),this.checkError()}attachFramebuffer(ct,ot,at){const ht=this.gl;ht.bindTexture(ht.TEXTURE_2D,ct),ht.bindFramebuffer(ht.FRAMEBUFFER,this.framebuffer),ht.framebufferTexture2D(ht.FRAMEBUFFER,ht.COLOR_ATTACHMENT0,ht.TEXTURE_2D,ct,0),this.checkError(),ht.viewport(0,0,ot,at),ht.scissor(0,0,ot,at)}readTexture(ct,ot,at,ht,ft,mt){const yt=this.gl;mt||(mt=1),this.frameBufferBound||this.attachFramebuffer(ct,ot,at);const bt=this.getEncoder(ft,mt),wt=bt.allocate(ot*at);return yt.bindTexture(yt.TEXTURE_2D,ct),yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,ct,0),yt.readPixels(0,0,ot,at,yt.RGBA,bt.textureType,wt),this.checkError(),bt.decode(wt,ht)}isFramebufferReady(){return!0}getActiveTexture(){const ct=this.gl;return"TEXTURE"+(ct.getParameter(this.gl.ACTIVE_TEXTURE)-ct.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(ct,ot){const at=this.gl;at.vertexAttribPointer(ct,3,at.FLOAT,!1,20,0),at.enableVertexAttribArray(ct),ot!==-1&&(at.vertexAttribPointer(ot,2,at.FLOAT,!1,20,12),at.enableVertexAttribArray(ot)),this.checkError()}createProgram(ct,ot){const at=this.gl,ht=at.createProgram();return at.attachShader(ht,ct),at.attachShader(ht,ot),at.linkProgram(ht),ht}compileShader(ct,ot){const at=this.gl,ht=at.createShader(ot);if(!ht)throw new Error(`createShader() returned null with type ${ot}`);if(at.shaderSource(ht,ct),at.compileShader(ht),at.getShaderParameter(ht,at.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${at.getShaderInfoLog(ht)}
Shader source:
${ct}`);return ht}deleteShader(ct){this.gl.deleteShader(ct)}bindTextureToUniform(ct,ot,at){const ht=this.gl;ht.activeTexture(ht.TEXTURE0+ot),this.checkError(),ht.bindTexture(ht.TEXTURE_2D,ct),this.checkError(),ht.uniform1i(at,ot),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(nt.env.debug){const ct=this.gl,ot=ct.getError();let at="";switch(ot){case ct.NO_ERROR:return;case ct.INVALID_ENUM:at="INVALID_ENUM";break;case ct.INVALID_VALUE:at="INVALID_VALUE";break;case ct.INVALID_OPERATION:at="INVALID_OPERATION";break;case ct.INVALID_FRAMEBUFFER_OPERATION:at="INVALID_FRAMEBUFFER_OPERATION";break;case ct.OUT_OF_MEMORY:at="OUT_OF_MEMORY";break;case ct.CONTEXT_LOST_WEBGL:at="CONTEXT_LOST_WEBGL";break;default:at=`Unknown WebGL Error: ${ot.toString(16)}`}throw new Error(at)}}deleteTexture(ct){this.gl.deleteTexture(ct)}deleteProgram(ct){this.gl.deleteProgram(ct)}getEncoder(ct,ot,at=0){if(this.version===2)return new it.RedFloat32DataEncoder(this.gl,ot);switch(ct){case"float":return at===1||this.isRenderFloat32Supported?new it.RGBAFloatDataEncoder(this.gl,ot):new it.RGBAFloatDataEncoder(this.gl,ot,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new it.Uint8DataEncoder(this.gl,ot);default:throw new Error(`Invalid dataType: ${ct}`)}}clearActiveTextures(){const ct=this.gl;for(let ot=0;ot<this.maxTextureImageUnits;++ot)ct.activeTexture(ct.TEXTURE0+ot),ct.bindTexture(ct.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const ct=this.gl;ct.bindFramebuffer(ct.FRAMEBUFFER,null),ct.deleteFramebuffer(this.framebuffer),ct.bindBuffer(ct.ARRAY_BUFFER,null),ct.deleteBuffer(this.vertexbuffer),ct.bindBuffer(ct.ELEMENT_ARRAY_BUFFER,null),ct.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const ct=this.gl,ot=ct.createBuffer();if(!ot)throw new Error("createBuffer() returned null");const at=this.createDefaultGeometry();return ct.bindBuffer(ct.ARRAY_BUFFER,ot),ct.bufferData(ct.ARRAY_BUFFER,at,ct.STATIC_DRAW),this.checkError(),ot}createFramebuffer(){const ct=this.gl.createFramebuffer();if(!ct)throw new Error("createFramebuffer returned null");return ct}queryVitalParameters(){const ct=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=ct.getParameter(ct.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=ct.getParameter(ct.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const ct=this.gl,ot=ct.createTexture();ct.bindTexture(ct.TEXTURE_2D,ot);const at=this.version===2?ct.RGBA32F:ct.RGBA;ct.texImage2D(ct.TEXTURE_2D,0,at,1,1,0,ct.RGBA,ct.FLOAT,null);const ht=ct.createFramebuffer();ct.bindFramebuffer(ct.FRAMEBUFFER,ht),ct.framebufferTexture2D(ct.FRAMEBUFFER,ct.COLOR_ATTACHMENT0,ct.TEXTURE_2D,ot,0);const ft=ct.checkFramebufferStatus(ct.FRAMEBUFFER)===ct.FRAMEBUFFER_COMPLETE;return ct.bindTexture(ct.TEXTURE_2D,null),ct.bindFramebuffer(ct.FRAMEBUFFER,null),ct.deleteTexture(ot),ct.deleteFramebuffer(ht),ft}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const ct=this.gl;let ot,at,ht,ft,mt;try{ot=ct.createTexture(),at=ct.createFramebuffer(),ct.bindTexture(ct.TEXTURE_2D,ot);const yt=this.version===2?ct.RGBA32F:ct.RGBA;return ct.texImage2D(ct.TEXTURE_2D,0,yt,1,1,0,ct.RGBA,ct.FLOAT,null),ct.bindFramebuffer(ct.FRAMEBUFFER,at),ct.framebufferTexture2D(ct.FRAMEBUFFER,ct.COLOR_ATTACHMENT0,ct.TEXTURE_2D,ot,0),ct.enable(ct.BLEND),ht=ct.createShader(ct.VERTEX_SHADER),!!ht&&(ct.shaderSource(ht,"void main(){}"),ct.compileShader(ht),ft=ct.createShader(ct.FRAGMENT_SHADER),!!ft&&(ct.shaderSource(ft,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),ct.compileShader(ft),mt=ct.createProgram(),!!mt&&(ct.attachShader(mt,ht),ct.attachShader(mt,ft),ct.linkProgram(mt),ct.useProgram(mt),ct.drawArrays(ct.POINTS,0,1),ct.getError()===ct.NO_ERROR)))}finally{ct.disable(ct.BLEND),mt&&ct.deleteProgram(mt),ht&&ct.deleteShader(ht),ft&&ct.deleteShader(ft),at&&(ct.bindFramebuffer(ct.FRAMEBUFFER,null),ct.deleteFramebuffer(at)),ot&&(ct.bindTexture(ct.TEXTURE_2D,null),ct.deleteTexture(ot))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){const ct=this.gl,ot=this.disjointTimerQueryWebgl2Extension,at=ct.createQuery();return ct.beginQuery(ot.TIME_ELAPSED_EXT,at),at}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const ct=this.gl,ot=this.disjointTimerQueryWebgl2Extension;ct.endQuery(ot.TIME_ELAPSED_EXT)}}isTimerResultAvailable(ct){let ot=!1,at=!1;if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const ht=this.gl,ft=this.disjointTimerQueryWebgl2Extension;ot=ht.getQueryParameter(ct,ht.QUERY_RESULT_AVAILABLE),at=ht.getParameter(ft.GPU_DISJOINT_EXT)}return ot&&!at}getTimerResult(ct){let ot=0;if(this.version!==2)throw new Error("WebGL1 profiling currently not supported");{const at=this.gl;ot=at.getQueryParameter(ct,at.QUERY_RESULT),at.deleteQuery(ct)}return ot/1e6}async waitForQueryAndGetTime(ct){return await(0,st.repeatedTry)(()=>this.isTimerResultAvailable(ct)),this.getTimerResult(ct)}async createAndWaitForFence(){const ct=this.createFence(this.gl);return this.pollFence(ct)}createFence(ct){let ot;const at=ct,ht=at.fenceSync(at.SYNC_GPU_COMMANDS_COMPLETE,0);return ct.flush(),ot=ht===null?()=>!0:()=>{const ft=at.clientWaitSync(ht,0,0);return ft===at.ALREADY_SIGNALED||ft===at.CONDITION_SATISFIED},{query:ht,isFencePassed:ot}}async pollFence(ct){return new Promise(ot=>{this.addItemToPoll(()=>ct.isFencePassed(),()=>ot())})}pollItems(){const ct=ut(this.itemsToPoll.map(ot=>ot.isDoneFn));for(let ot=0;ot<=ct;++ot){const{resolveFn:at}=this.itemsToPoll[ot];at()}this.itemsToPoll=this.itemsToPoll.slice(ct+1)}async addItemToPoll(ct,ot){this.itemsToPoll.push({isDoneFn:ct,resolveFn:ot}),this.itemsToPoll.length>1||await(0,st.repeatedTry)(()=>(this.pollItems(),this.itemsToPoll.length===0))}}},1036:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ExecutionPlan=void 0;const c=o(6231);class d{constructor(nt,it){this.op=nt,this.node=it}}a.ExecutionPlan=class{constructor(tt,nt,it){this.graph=tt,this.profiler=it,this.initialize(nt)}initialize(tt){this.profiler.event("session","ExecutionPlan.initialize",()=>{const nt=this.graph.getNodes();if(nt.length!==tt.length)throw new Error("The size of nodes and OPs do not match.");this._ops=tt.map((it,st)=>new d(it,nt[st])),this.reset(),this._starter=[],this._ops.forEach((it,st)=>{let ut=!0;for(const ct of it.node.inputs)if(!this._values[ct]&&this.graph.getInputIndices().indexOf(ct)===-1){ut=!1;break}ut&&this._starter.push(st)})})}reset(){this._values=this.graph.getValues().map(tt=>tt.tensor)}async execute(tt,nt){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();const it=tt.createInferenceHandler(),st=this.graph.getInputIndices();if(nt.length!==st.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${nt.length} expected: ${st.length}`);nt.forEach((ft,mt)=>{const yt=st[mt];this._values[yt]=ft});const ut=this._starter.slice(0),ct=this.graph.getValues(),ot=this.graph.getNodes();let at=0;for(;at<ut.length;){const ft=ut[at++],mt=this._ops[ft],yt=mt.node.inputs.map(Ct=>this._values[Ct]);if(yt.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${mt.node}`);const bt=yt;c.Logger.verbose("ExecPlan",`Runing op:${mt.node.name} (${bt.map((Ct,Dt)=>`'${mt.node.inputs[Dt]}': ${Ct.type}[${Ct.dims.join(",")}]`).join(", ")})`);const wt=await this.profiler.event("node",mt.node.name,async()=>mt.op.impl(it,bt,mt.op.context));if(wt.length!==mt.node.outputs.length)throw new Error("the size of output does not match model definition.");wt.forEach((Ct,Dt)=>{const Ot=mt.node.outputs[Dt];if(this._values[Ot])throw new Error(`output [${Ot}] already has value: op:${mt.node.name}`);this._values[Ot]=Ct});const Tt=new Set;wt.forEach((Ct,Dt)=>{const Ot=mt.node.outputs[Dt];for(const $t of ct[Ot].to){const Ft=ot[$t];let kt=!0;for(const Vt of Ft.inputs)if(!this._values[Vt]){kt=!1;break}kt&&Tt.add($t)}}),ut.push(...Tt)}const ht=[];for(let ft=0;ft<this.graph.getOutputIndices().length;ft++){const mt=this.graph.getOutputIndices()[ft],yt=this._values[mt];if(yt===void 0)throw new Error(`required output [${mt}] does not have value`);mt===0?await yt.getData():yt.data,ht.push(yt)}return c.Logger.verbose("ExecPlan","disposing of inferenceHandler"),it.dispose(),ht})}}},7070:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Graph=void 0;const c=o(1446),d=o(7778),tt=o(9395),nt=o(9162),it=o(2517);var st=tt.onnxruntime.experimental.fbs;a.Graph={from:(at,ht)=>new ot(at,ht)};class ut{constructor(ht){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,ht&&(this.type=it.ProtoUtil.tensorValueTypeFromProto(ht.type.tensorType))}get from(){return this._from}get to(){return this._to}}class ct{constructor(ht,ft){ht instanceof c.onnx.NodeProto?(this.name=ht.name,this.opType=ht.opType,this.attributes=new d.Attribute(ht.attribute)):ht instanceof st.Node&&(this.name=ft??ht.name(),this.opType=ht.opType(),this.attributes=new d.Attribute(it.ProtoUtil.tensorAttributesFromORTFormat(ht))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class ot{constructor(ht,ft){if(!ht)throw new TypeError("graph is empty");this.buildGraph(ht),this.transformGraph(ft),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(ht){if(ht instanceof c.onnx.GraphProto)this.buildGraphFromOnnxFormat(ht);else{if(!(ht instanceof st.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(ht)}}buildGraphFromOnnxFormat(ht){const ft=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const mt=new Map;if(!ht.input)throw new Error("missing information in graph: input");const yt=[];for(const bt of ht.input){if(ft.has(bt.name))throw new Error(`duplicated input name: ${bt.name}`);const wt=this._allData.push(new ut(bt))-1;ft.set(bt.name,wt),yt.push(bt.name)}if(!ht.initializer)throw new Error("missing information in graph: initializer");for(const bt of ht.initializer){let wt=ft.get(bt.name);if(wt===void 0){const Tt=new ut;Tt.type={shape:{dims:it.ProtoUtil.tensorDimsFromProto(bt.dims)},tensorType:it.ProtoUtil.tensorDataTypeFromProto(bt.dataType)},wt=this._allData.push(Tt)-1,ft.set(bt.name,wt)}this._allData[wt]._from=-1,this._allData[wt].tensor=nt.Tensor.fromProto(bt)}for(let bt=0;bt<this._allData.length;bt++)this._allData[bt].tensor||(this._allInputIndices.push(bt),this._allInputNames.push(yt[bt]));if(!ht.output)throw new Error("missing information in graph: output");for(const bt of ht.output){if(ft.has(bt.name))throw new Error(`duplicated output name: ${bt.name}`);const wt=this._allData.push(new ut(bt))-1;ft.set(bt.name,wt),this._allOutputIndices.push(wt),this._allOutputNames.push(bt.name)}if(!ht.node)throw new Error("missing information in graph: node");for(const bt of ht.node){if(!bt.name)for(let Tt=0;;Tt++){const Ct=`unnamed_${bt.opType}_${Tt}`;if(!mt.has(Ct)){bt.name=Ct;break}}if(mt.has(bt.name))throw new Error(`duplicated node name: ${bt.name}`);const wt=this._nodes.push(new ct(bt))-1;mt.set(bt.name,wt)}for(let bt=0;bt<this._nodes.length;bt++){const wt=this._nodes[bt],Tt=ht.node[bt];if(!Tt.output)throw new Error(`missing output for node: ${Tt.name}`);for(const Ct of Tt.output){let Dt=ft.get(Ct);if(Dt===void 0&&(Dt=this._allData.push(new ut)-1,ft.set(Ct,Dt)),wt.outputs.push(Dt),this._allData[Dt]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${Dt}`);if(this._allData[Dt]._from=bt,Tt.opType==="Constant"){if(!Tt.attribute||Tt.attribute.length!==1||!Tt.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!Tt.output||Tt.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");wt.outputs.pop(),wt.executeNode=!1,this._allData[Dt]._from=-1,this._allData[Dt].tensor=nt.Tensor.fromProto(Tt.attribute[0].t)}}}for(let bt=0;bt<this._nodes.length;bt++){const wt=this._nodes[bt],Tt=ht.node[bt];if(!Tt.input)throw new Error(`missing input for node: ${Tt.name}`);for(const Ct of Tt.input){const Dt=ft.get(Ct);if(Dt===void 0){if(Ct===""&&Tt.input.length===3&&Tt.opType==="Resize")continue;throw new Error(`unrecognized input '${Ct}' for node: ${Tt.name}`)}wt.inputs.push(Dt),this._allData[Dt]._to.push(bt)}}return!0}buildGraphFromOrtFormat(ht){var ft,mt,yt;const bt=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const wt=new Map,Tt=[];for(let Ct=0;Ct<ht.inputsLength();Ct++){const Dt=ht.inputs(Ct);if(bt.has(Dt))throw new Error(`duplicated input name: ${Dt}`);for(let Ot=0;Ot<ht.nodeArgsLength();Ot++)if(((ft=ht.nodeArgs(Ot))===null||ft===void 0?void 0:ft.name())===Dt){const $t=new ut;if(((yt=(mt=ht.nodeArgs(Ot))===null||mt===void 0?void 0:mt.type())===null||yt===void 0?void 0:yt.valueType())!==st.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const Ft=ht.nodeArgs(Ot).type().value(new st.TensorTypeAndShape),kt=it.ProtoUtil.tensorDataTypeFromProto(Ft.elemType()),Vt=Ft.shape(),Ht=[];for(let Xt=0;Xt<Vt.dimLength();Xt++)Ht.push(it.LongUtil.longToNumber(Vt.dim(Xt).value().dimValue()));$t.type={shape:{dims:Ht},tensorType:kt};const Qt=this._allData.push($t)-1;bt.set(Dt,Qt),Tt.push(Dt)}}for(let Ct=0;Ct<ht.initializersLength();Ct++){const Dt=ht.initializers(Ct);let Ot=bt.get(Dt.name());if(Ot===void 0){const $t=new ut,Ft=it.ProtoUtil.tensorDimsFromORTFormat(Dt),kt=it.ProtoUtil.tensorDataTypeFromProto(Dt.dataType());$t.type={shape:{dims:Ft},tensorType:kt},Ot=this._allData.push($t)-1,bt.set(Dt.name(),Ot)}this._allData[Ot]._from=-1,this._allData[Ot].tensor=nt.Tensor.fromOrtTensor(Dt)}for(let Ct=0;Ct<this._allData.length;Ct++)this._allData[Ct].tensor||(this._allInputIndices.push(Ct),this._allInputNames.push(Tt[Ct]));for(let Ct=0;Ct<ht.outputsLength();Ct++){const Dt=ht.outputs(Ct);if(bt.has(Dt))throw new Error(`duplicated output name: ${Dt}`);const Ot=this._allData.push(new ut)-1;bt.set(Dt,Ot),this._allOutputIndices.push(Ot),this._allOutputNames.push(Dt)}if(!ht.nodes)throw new Error("missing information in graph: node");for(let Ct=0;Ct<ht.nodesLength();Ct++){const Dt=ht.nodes(Ct);let Ot=Dt.name();if(!Ot)for(let Ft=0;Ot=`unnamed_${Dt.opType()}_${Ft}`,wt.has(Ot);Ft++);if(wt.has(Ot))throw new Error(`duplicated node name: ${Ot}`);const $t=this._nodes.push(new ct(Dt,Ot))-1;wt.set(Ot,$t)}for(let Ct=0;Ct<this._nodes.length;Ct++){const Dt=this._nodes[Ct],Ot=ht.nodes(Ct);if(Ot==null)throw new Error(`No node exists at index ${Ct}`);if(Ot?.outputsLength()===0)throw new Error(`missing output for node: ${Ot.name}`);for(let $t=0;$t<Ot?.outputsLength();$t++){const Ft=Ot?.outputs($t);let kt=bt.get(Ft);if(kt===void 0&&(kt=this._allData.push(new ut)-1,bt.set(Ft,kt)),Dt.outputs.push(kt),this._allData[kt]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${kt}`);if(this._allData[kt]._from=Ct,Ot.opType()==="Constant"){if(Ot.attributesLength()!==1||!Ot.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(Ot.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");Dt.outputs.pop(),Dt.executeNode=!1,this._allData[kt]._from=-1,this._allData[kt].tensor=nt.Tensor.fromOrtTensor(Ot.attributes(0).t())}}}for(let Ct=0;Ct<this._nodes.length;Ct++){const Dt=this._nodes[Ct],Ot=ht.nodes(Ct);if(Ot.inputsLength()===0)throw new Error(`missing input for node: ${Ot.name}`);for(let $t=0;$t<Ot.inputsLength();$t++){const Ft=Ot.inputs($t),kt=bt.get(Ft);if(kt===void 0)throw new Error(`unrecognized input '${Ft}' for node: ${Ot.name()}`);Dt.inputs.push(kt),this._allData[kt]._to.push(Ct)}}}checkIsAcyclic(){const ht=new Set;this._allInputIndices.forEach(yt=>{this._allData[yt]._to.forEach(bt=>{ht.add(bt)})});const ft=Array.from(ht),mt=new Array(this._nodes.length).fill("white");for(;ft.length>0;){const yt=ft.pop();mt[yt]==="gray"?mt[yt]="black":(ft.push(yt),mt[yt]="gray",this._nodes[yt].outputs.forEach(bt=>{const wt=this._allData[bt];if(wt.tensor!==void 0)throw new Error("node outputs should not be initialized");if(wt._from!==yt)throw new Error("from property of the Value object doesn't match index of Node being processed");wt._to.forEach(Tt=>{if(mt[Tt]==="gray")throw new Error("model graph is cyclic");mt[Tt]==="white"&&ft.push(Tt)})}))}}transformGraph(ht){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),ht&&ht.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let ht=0;for(let ft=0;ft<this._nodes.length;ft++)this._nodes[ft].executeNode?ht>0&&(this._nodes[ft].inputs.forEach(mt=>{const yt=this._allData[mt]._to.indexOf(ft+ht);yt!==-1&&(this._allData[mt]._to[yt]=ft)}),this._nodes[ft].outputs.forEach(mt=>{this._allData[mt]._from&&this._allData[mt]._from===ft+ht&&(this._allData[mt]._from=ft)})):(ht++,this._nodes[ft].outputs.forEach(mt=>{this._allData[mt]._from=-2}),this._nodes.splice(ft,1),ft--);ht=0;for(let ft=0;ft<this._allData.length;ft++)if(this._allData[ft].from!==-2||this._allOutputIndices.indexOf(ft+ht)!==-1){if(ht>0){let mt=-1;this._allData[ft].from!==void 0&&this._allData[ft].from!==-1?(mt=this._nodes[this._allData[ft].from].outputs.indexOf(ft+ht),mt!==-1&&(this._nodes[this._allData[ft].from].outputs[mt]=ft)):(mt=this._allInputIndices.indexOf(ft+ht),mt!==-1&&(this._allInputIndices[mt]=ft)),this._allData[ft].to.forEach(yt=>{mt=this._nodes[yt].inputs.indexOf(ft+ht),mt!==-1&&(this._nodes[yt].inputs[mt]=ft)}),this._allData[ft].to.length===0&&(mt=this._allOutputIndices.indexOf(ft+ht),mt!==-1&&(this._allOutputIndices[mt]=ft))}}else ht++,this._allData.splice(ft,1),ft--}deleteNode(ht){const ft=this._nodes[ht];if(ft.outputs.length>1){for(let Ct=1;Ct<ft.outputs.length;Ct++)if(this._allData[ft.outputs[Ct]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}ft.executeNode=!1;const mt=ft.inputs[0],yt=ft.outputs[0],bt=this._allData[yt].to,wt=this._allData[mt].to.indexOf(ht);if(wt===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[mt].to.splice(wt,1),this._allData[yt]._to=[];const Tt=this._allOutputIndices.indexOf(yt);if(Tt!==-1&&(this._allOutputIndices[Tt]=mt),bt&&bt.length>0)for(const Ct of bt){const Dt=this._nodes[Ct].inputs.indexOf(yt);if(Dt===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[Ct].inputs[Dt]=mt,this._allData[mt].to.push(Ct)}}removeAllDropoutNodes(){let ht=0;for(const ft of this._nodes){if(ft.opType==="Dropout"){if(ft.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(ft.outputs.length!==1&&ft.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(ft.outputs.length===2&&this._allData[ft.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(ht)}ht++}}removeAllIdentityNodes(){let ht=0;for(const ft of this._nodes)ft.opType==="Identity"&&this.deleteNode(ht),ht++}isActivation(ht){switch(ht.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const ht of this._nodes)if(ht.opType==="Conv"){const ft=this._allData[ht.outputs[0]]._to;if(ft.length===1&&this.isActivation(this._nodes[ft[0]])){const mt=this._nodes[ft[0]];if(mt.opType==="Clip")if(mt.inputs.length===1)try{ht.attributes.set("activation_params","floats",[mt.attributes.getFloat("min"),mt.attributes.getFloat("max")])}catch{ht.attributes.set("activation_params","floats",[it.MIN_CLIP,it.MAX_CLIP])}else{if(!(mt.inputs.length>=3&&this._allData[mt.inputs[1]].tensor!==void 0&&this._allData[mt.inputs[2]].tensor!==void 0))continue;ht.attributes.set("activation_params","floats",[this._allData[mt.inputs[1]].tensor.floatData[0],this._allData[mt.inputs[2]].tensor.floatData[0]])}ht.attributes.set("activation","string",mt.opType),this.deleteNode(ft[0])}}}}},6231:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.now=a.Profiler=a.Logger=void 0;const o={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},c={none:new class{log(ct,ot,at){}},console:new class{log(ct,ot,at){console.log(`${this.color(ct)} ${at?"\x1B[35m"+at+"\x1B[0m ":""}${ot}`)}color(ct){switch(ct){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${ct}`)}}}},d={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let tt={"":d};function nt(ct,ot,at,ht){if(ot===void 0)return ft=ct,{verbose:nt.verbose.bind(null,ft),info:nt.info.bind(null,ft),warning:nt.warning.bind(null,ft),error:nt.error.bind(null,ft),fatal:nt.fatal.bind(null,ft)};if(at===void 0)it(ct,ot);else if(typeof at=="number"&&ht===void 0)it(ct,ot);else if(typeof at=="string"&&ht===void 0)it(ct,at,0,ot);else{if(typeof at!="string"||typeof ht!="number")throw new TypeError("input is valid");it(ct,at,0,ot)}var ft}function it(ct,ot,at,ht){const ft=tt[ht||""]||tt[""];o[ct]<o[ft.minimalSeverity]||(ft.logDateTime&&(ot=`${new Date().toISOString()}|${ot}`),ft.logSourceLocation,c[ft.provider].log(ct,ot,ht))}(function(ct){function ot(ht){tt={},at("",ht||{})}function at(ht,ft){if(ht==="*")ot(ft);else{const mt=tt[ht]||d;tt[ht]={provider:ft.provider||mt.provider,minimalSeverity:ft.minimalSeverity||mt.minimalSeverity,logDateTime:ft.logDateTime===void 0?mt.logDateTime:ft.logDateTime,logSourceLocation:ft.logSourceLocation===void 0?mt.logSourceLocation:ft.logSourceLocation}}}ct.verbose=function(ht,ft){ct("verbose",ht,ft)},ct.info=function(ht,ft){ct("info",ht,ft)},ct.warning=function(ht,ft){ct("warning",ht,ft)},ct.error=function(ht,ft){ct("error",ht,ft)},ct.fatal=function(ht,ft){ct("fatal",ht,ft)},ct.reset=ot,ct.set=at,ct.setWithEnv=function(ht){const ft={};ht.logLevel&&(ft.minimalSeverity=ht.logLevel),at("",ft)}})(nt||(nt={})),a.Logger=nt;class st{constructor(ot,at,ht,ft,mt,yt){this.category=ot,this.name=at,this.startTime=ht,this.endCallback=ft,this.timer=mt,this.ctx=yt}end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class ut{constructor(ot,at,ht,ft){this.category=ot,this.name=at,this.startTime=ht,this.endTime=ft}}a.Profiler=class{static create(ct){return ct===void 0?new this:new this(ct.maxNumberEvents,ct.flushBatchSize,ct.flushIntervalInMilliseconds)}constructor(ct,ot,at){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=ct===void 0?1e4:ct,this._flushBatchSize=ot===void 0?10:ot,this._flushIntervalInMilliseconds=at===void 0?5e3:at}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,a.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(ct,ot,at,ht){const ft=this._started?this.begin(ct,ot,ht):void 0;let mt=!1;const yt=at();if(yt&&typeof yt.then=="function")return mt=!0,new Promise((bt,wt)=>{yt.then(async Tt=>{ft&&await ft.end(),bt(Tt)},async Tt=>{ft&&await ft.end(),wt(Tt)})});if(!mt&&ft){const bt=ft.end();if(bt&&typeof bt.then=="function")return new Promise((wt,Tt)=>{bt.then(()=>{wt(yt)},Ct=>{Tt(Ct)})})}return yt}begin(ct,ot,at){if(!this._started)throw new Error("profiler is not started yet");if(at===void 0){const ht=(0,a.now)();return this.flush(ht),new st(ct,ot,ht,ft=>this.endSync(ft))}{const ht=at.beginTimer();return new st(ct,ot,0,async ft=>this.end(ft),ht,at)}}async end(ct){const ot=await ct.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new ut(ct.category,ct.name,ct.startTime,ot)),this.flush(ot))}endSync(ct){const ot=(0,a.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new ut(ct.category,ct.name,ct.startTime,ot)),this.flush(ot))}logOneEvent(ct){a.Logger.verbose(`Profiler.${ct.category}`,`${(ct.endTime-ct.startTime).toFixed(2)}ms on event '${ct.name}' at ${ct.endTime.toFixed(2)}`)}flush(ct){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||ct-this._flushTime>=this._flushIntervalInMilliseconds){for(const ot=this._flushPointer;this._flushPointer<ot+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,a.now)()}}get started(){return this._started}},a.now=typeof performance<"u"&&performance.now?()=>performance.now():Date.now},2644:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Model=void 0;const c=o(5686),d=o(1446),tt=o(7070),nt=o(9395),it=o(2517);var st=nt.onnxruntime.experimental.fbs;a.Model=class{constructor(){}load(ut,ct,ot){if(!ot)try{return void this.loadFromOnnxFormat(ut,ct)}catch(at){if(ot!==void 0)throw at}this.loadFromOrtFormat(ut,ct)}loadFromOnnxFormat(ut,ct){const ot=d.onnx.ModelProto.decode(ut);if(it.LongUtil.longToNumber(ot.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=ot.opsetImport.map(at=>({domain:at.domain,version:it.LongUtil.longToNumber(at.version)})),this._graph=tt.Graph.from(ot.graph,ct)}loadFromOrtFormat(ut,ct){const ot=new c.flatbuffers.ByteBuffer(ut),at=st.InferenceSession.getRootAsInferenceSession(ot).model();if(it.LongUtil.longToNumber(at.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let ht=0;ht<at.opsetImportLength();ht++){const ft=at.opsetImport(ht);this._opsets.push({domain:ft?.domain(),version:it.LongUtil.longToNumber(ft.version())})}this._graph=tt.Graph.from(at.graph(),ct)}get graph(){return this._graph}get opsets(){return this._opsets}}},782:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FLOAT_TYPES=a.INT_TYPES=a.NUMBER_TYPES=void 0,a.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],a.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],a.FLOAT_TYPES=["float32","float64"]},1047:(s,a)=>{function o(c,d){if(d.endsWith("+")){const tt=Number.parseInt(d.substring(0,d.length-1),10);return!isNaN(tt)&&tt<=c}if(d.split("-").length===2){const tt=d.split("-"),nt=Number.parseInt(tt[0],10),it=Number.parseInt(tt[1],10);return!isNaN(nt)&&!isNaN(it)&&nt<=c&&c<=it}return Number.parseInt(d,10)===c}Object.defineProperty(a,"__esModule",{value:!0}),a.resolveOperator=void 0,a.resolveOperator=function(c,d,tt){for(const nt of tt){const it=nt[0],st=nt[1],ut=nt[2],ct=nt[3],ot=nt[4];if(c.opType===it){for(const at of d)if((at.domain===st||at.domain==="ai.onnx"&&st==="")&&o(at.version,ut))return{opImpl:ct,opInit:ot}}}throw new TypeError(`cannot resolve operator '${c.opType}' with opsets: ${d.map(nt=>`${nt.domain||"ai.onnx"} v${nt.version}`).join(", ")}`)}},9395:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.onnxruntime=void 0;const c=o(5686);var d,tt;d=a.onnxruntime||(a.onnxruntime={}),function(nt){(function(it){it[it.UNDEFINED=0]="UNDEFINED",it[it.FLOAT=1]="FLOAT",it[it.INT=2]="INT",it[it.STRING=3]="STRING",it[it.TENSOR=4]="TENSOR",it[it.GRAPH=5]="GRAPH",it[it.FLOATS=6]="FLOATS",it[it.INTS=7]="INTS",it[it.STRINGS=8]="STRINGS",it[it.TENSORS=9]="TENSORS",it[it.GRAPHS=10]="GRAPHS",it[it.SPARSE_TENSOR=11]="SPARSE_TENSOR",it[it.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(nt.AttributeType||(nt.AttributeType={}))}((tt=d.experimental||(d.experimental={})).fbs||(tt.fbs={})),function(nt){(function(it){(function(st){(function(ut){ut[ut.UNKNOWN=0]="UNKNOWN",ut[ut.VALUE=1]="VALUE",ut[ut.PARAM=2]="PARAM"})(st.DimensionValueType||(st.DimensionValueType={}))})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){(function(ut){ut[ut.UNDEFINED=0]="UNDEFINED",ut[ut.FLOAT=1]="FLOAT",ut[ut.UINT8=2]="UINT8",ut[ut.INT8=3]="INT8",ut[ut.UINT16=4]="UINT16",ut[ut.INT16=5]="INT16",ut[ut.INT32=6]="INT32",ut[ut.INT64=7]="INT64",ut[ut.STRING=8]="STRING",ut[ut.BOOL=9]="BOOL",ut[ut.FLOAT16=10]="FLOAT16",ut[ut.DOUBLE=11]="DOUBLE",ut[ut.UINT32=12]="UINT32",ut[ut.UINT64=13]="UINT64",ut[ut.COMPLEX64=14]="COMPLEX64",ut[ut.COMPLEX128=15]="COMPLEX128",ut[ut.BFLOAT16=16]="BFLOAT16"})(st.TensorDataType||(st.TensorDataType={}))})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){(function(ut){ut[ut.Primitive=0]="Primitive",ut[ut.Fused=1]="Fused"})(st.NodeType||(st.NodeType={}))})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){(function(ut){ut[ut.NONE=0]="NONE",ut[ut.tensor_type=1]="tensor_type",ut[ut.sequence_type=2]="sequence_type",ut[ut.map_type=3]="map_type"})(st.TypeInfoValue||(st.TypeInfoValue={}))})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsShape(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsShape(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}dim(ot,at){let ht=this.bb.__offset(this.bb_pos,4);return ht?(at||new nt.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}dimLength(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startShape(ot){ot.startObject(1)}static addDim(ot,at){ot.addFieldOffset(0,at,0)}static createDimVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startDimVector(ot,at){ot.startVector(4,at,4)}static endShape(ot){return ot.endObject()}static createShape(ot,at){return ut.startShape(ot),ut.addDim(ot,at),ut.endShape(ot)}}st.Shape=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsDimension(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsDimension(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}value(ot){let at=this.bb.__offset(this.bb_pos,4);return at?(ot||new nt.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}denotation(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__string(this.bb_pos+at,ot):null}static startDimension(ot){ot.startObject(2)}static addValue(ot,at){ot.addFieldOffset(0,at,0)}static addDenotation(ot,at){ot.addFieldOffset(1,at,0)}static endDimension(ot){return ot.endObject()}static createDimension(ot,at,ht){return ut.startDimension(ot),ut.addValue(ot,at),ut.addDenotation(ot,ht),ut.endDimension(ot)}}st.Dimension=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsDimensionValue(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsDimensionValue(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}dimType(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.readInt8(this.bb_pos+ot):nt.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.readInt64(this.bb_pos+ot):this.bb.createLong(0,0)}dimParam(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__string(this.bb_pos+at,ot):null}static startDimensionValue(ot){ot.startObject(3)}static addDimType(ot,at){ot.addFieldInt8(0,at,nt.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(ot,at){ot.addFieldInt64(1,at,ot.createLong(0,0))}static addDimParam(ot,at){ot.addFieldOffset(2,at,0)}static endDimensionValue(ot){return ot.endObject()}static createDimensionValue(ot,at,ht,ft){return ut.startDimensionValue(ot),ut.addDimType(ot,at),ut.addDimValue(ot,ht),ut.addDimParam(ot,ft),ut.endDimensionValue(ot)}}st.DimensionValue=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsTensorTypeAndShape(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsTensorTypeAndShape(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}elemType(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.readInt32(this.bb_pos+ot):nt.experimental.fbs.TensorDataType.UNDEFINED}shape(ot){let at=this.bb.__offset(this.bb_pos,6);return at?(ot||new nt.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startTensorTypeAndShape(ot){ot.startObject(2)}static addElemType(ot,at){ot.addFieldInt32(0,at,nt.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(ot,at){ot.addFieldOffset(1,at,0)}static endTensorTypeAndShape(ot){return ot.endObject()}static createTensorTypeAndShape(ot,at,ht){return ut.startTensorTypeAndShape(ot),ut.addElemType(ot,at),ut.addShape(ot,ht),ut.endTensorTypeAndShape(ot)}}st.TensorTypeAndShape=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsMapType(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsMapType(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}keyType(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.readInt32(this.bb_pos+ot):nt.experimental.fbs.TensorDataType.UNDEFINED}valueType(ot){let at=this.bb.__offset(this.bb_pos,6);return at?(ot||new nt.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startMapType(ot){ot.startObject(2)}static addKeyType(ot,at){ot.addFieldInt32(0,at,nt.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(ot,at){ot.addFieldOffset(1,at,0)}static endMapType(ot){return ot.endObject()}static createMapType(ot,at,ht){return ut.startMapType(ot),ut.addKeyType(ot,at),ut.addValueType(ot,ht),ut.endMapType(ot)}}st.MapType=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsSequenceType(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsSequenceType(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}elemType(ot){let at=this.bb.__offset(this.bb_pos,4);return at?(ot||new nt.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startSequenceType(ot){ot.startObject(1)}static addElemType(ot,at){ot.addFieldOffset(0,at,0)}static endSequenceType(ot){return ot.endObject()}static createSequenceType(ot,at){return ut.startSequenceType(ot),ut.addElemType(ot,at),ut.endSequenceType(ot)}}st.SequenceType=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(it.fbs||(it.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(st,ut){return this.bb_pos=st,this.bb=ut,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(st,ut,ct,ot){return st.prep(4,12),st.writeInt32(ot),st.writeInt32(ct),st.writeInt32(ut),st.offset()}}})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsNodeEdge(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsNodeEdge(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}nodeIndex(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.readUint32(this.bb_pos+ot):0}inputEdges(ot,at){let ht=this.bb.__offset(this.bb_pos,6);return ht?(at||new nt.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+ht)+12*ot,this.bb):null}inputEdgesLength(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.__vector_len(this.bb_pos+ot):0}outputEdges(ot,at){let ht=this.bb.__offset(this.bb_pos,8);return ht?(at||new nt.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+ht)+12*ot,this.bb):null}outputEdgesLength(){let ot=this.bb.__offset(this.bb_pos,8);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startNodeEdge(ot){ot.startObject(3)}static addNodeIndex(ot,at){ot.addFieldInt32(0,at,0)}static addInputEdges(ot,at){ot.addFieldOffset(1,at,0)}static startInputEdgesVector(ot,at){ot.startVector(12,at,4)}static addOutputEdges(ot,at){ot.addFieldOffset(2,at,0)}static startOutputEdgesVector(ot,at){ot.startVector(12,at,4)}static endNodeEdge(ot){return ot.endObject()}static createNodeEdge(ot,at,ht,ft){return ut.startNodeEdge(ot),ut.addNodeIndex(ot,at),ut.addInputEdges(ot,ht),ut.addOutputEdges(ot,ft),ut.endNodeEdge(ot)}}st.NodeEdge=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsNode(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsNode(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}name(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}docString(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__string(this.bb_pos+at,ot):null}domain(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__string(this.bb_pos+at,ot):null}sinceVersion(){let ot=this.bb.__offset(this.bb_pos,10);return ot?this.bb.readInt32(this.bb_pos+ot):0}index(){let ot=this.bb.__offset(this.bb_pos,12);return ot?this.bb.readUint32(this.bb_pos+ot):0}opType(ot){let at=this.bb.__offset(this.bb_pos,14);return at?this.bb.__string(this.bb_pos+at,ot):null}type(){let ot=this.bb.__offset(this.bb_pos,16);return ot?this.bb.readInt32(this.bb_pos+ot):nt.experimental.fbs.NodeType.Primitive}executionProviderType(ot){let at=this.bb.__offset(this.bb_pos,18);return at?this.bb.__string(this.bb_pos+at,ot):null}inputs(ot,at){let ht=this.bb.__offset(this.bb_pos,20);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}inputsLength(){let ot=this.bb.__offset(this.bb_pos,20);return ot?this.bb.__vector_len(this.bb_pos+ot):0}outputs(ot,at){let ht=this.bb.__offset(this.bb_pos,22);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}outputsLength(){let ot=this.bb.__offset(this.bb_pos,22);return ot?this.bb.__vector_len(this.bb_pos+ot):0}attributes(ot,at){let ht=this.bb.__offset(this.bb_pos,24);return ht?(at||new nt.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}attributesLength(){let ot=this.bb.__offset(this.bb_pos,24);return ot?this.bb.__vector_len(this.bb_pos+ot):0}inputArgCounts(ot){let at=this.bb.__offset(this.bb_pos,26);return at?this.bb.readInt32(this.bb.__vector(this.bb_pos+at)+4*ot):0}inputArgCountsLength(){let ot=this.bb.__offset(this.bb_pos,26);return ot?this.bb.__vector_len(this.bb_pos+ot):0}inputArgCountsArray(){let ot=this.bb.__offset(this.bb_pos,26);return ot?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+ot),this.bb.__vector_len(this.bb_pos+ot)):null}implicitInputs(ot,at){let ht=this.bb.__offset(this.bb_pos,28);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}implicitInputsLength(){let ot=this.bb.__offset(this.bb_pos,28);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startNode(ot){ot.startObject(13)}static addName(ot,at){ot.addFieldOffset(0,at,0)}static addDocString(ot,at){ot.addFieldOffset(1,at,0)}static addDomain(ot,at){ot.addFieldOffset(2,at,0)}static addSinceVersion(ot,at){ot.addFieldInt32(3,at,0)}static addIndex(ot,at){ot.addFieldInt32(4,at,0)}static addOpType(ot,at){ot.addFieldOffset(5,at,0)}static addType(ot,at){ot.addFieldInt32(6,at,nt.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(ot,at){ot.addFieldOffset(7,at,0)}static addInputs(ot,at){ot.addFieldOffset(8,at,0)}static createInputsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startInputsVector(ot,at){ot.startVector(4,at,4)}static addOutputs(ot,at){ot.addFieldOffset(9,at,0)}static createOutputsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startOutputsVector(ot,at){ot.startVector(4,at,4)}static addAttributes(ot,at){ot.addFieldOffset(10,at,0)}static createAttributesVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startAttributesVector(ot,at){ot.startVector(4,at,4)}static addInputArgCounts(ot,at){ot.addFieldOffset(11,at,0)}static createInputArgCountsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addInt32(at[ht]);return ot.endVector()}static startInputArgCountsVector(ot,at){ot.startVector(4,at,4)}static addImplicitInputs(ot,at){ot.addFieldOffset(12,at,0)}static createImplicitInputsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startImplicitInputsVector(ot,at){ot.startVector(4,at,4)}static endNode(ot){return ot.endObject()}static createNode(ot,at,ht,ft,mt,yt,bt,wt,Tt,Ct,Dt,Ot,$t,Ft){return ut.startNode(ot),ut.addName(ot,at),ut.addDocString(ot,ht),ut.addDomain(ot,ft),ut.addSinceVersion(ot,mt),ut.addIndex(ot,yt),ut.addOpType(ot,bt),ut.addType(ot,wt),ut.addExecutionProviderType(ot,Tt),ut.addInputs(ot,Ct),ut.addOutputs(ot,Dt),ut.addAttributes(ot,Ot),ut.addInputArgCounts(ot,$t),ut.addImplicitInputs(ot,Ft),ut.endNode(ot)}}st.Node=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsValueInfo(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsValueInfo(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}name(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}docString(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__string(this.bb_pos+at,ot):null}type(ot){let at=this.bb.__offset(this.bb_pos,8);return at?(ot||new nt.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startValueInfo(ot){ot.startObject(3)}static addName(ot,at){ot.addFieldOffset(0,at,0)}static addDocString(ot,at){ot.addFieldOffset(1,at,0)}static addType(ot,at){ot.addFieldOffset(2,at,0)}static endValueInfo(ot){return ot.endObject()}static createValueInfo(ot,at,ht,ft){return ut.startValueInfo(ot),ut.addName(ot,at),ut.addDocString(ot,ht),ut.addType(ot,ft),ut.endValueInfo(ot)}}st.ValueInfo=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsTypeInfo(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsTypeInfo(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}denotation(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}valueType(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.readUint8(this.bb_pos+ot):nt.experimental.fbs.TypeInfoValue.NONE}value(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__union(ot,this.bb_pos+at):null}static startTypeInfo(ot){ot.startObject(3)}static addDenotation(ot,at){ot.addFieldOffset(0,at,0)}static addValueType(ot,at){ot.addFieldInt8(1,at,nt.experimental.fbs.TypeInfoValue.NONE)}static addValue(ot,at){ot.addFieldOffset(2,at,0)}static endTypeInfo(ot){return ot.endObject()}static createTypeInfo(ot,at,ht,ft){return ut.startTypeInfo(ot),ut.addDenotation(ot,at),ut.addValueType(ot,ht),ut.addValue(ot,ft),ut.endTypeInfo(ot)}}st.TypeInfo=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsOperatorSetId(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsOperatorSetId(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}domain(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}version(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.readInt64(this.bb_pos+ot):this.bb.createLong(0,0)}static startOperatorSetId(ot){ot.startObject(2)}static addDomain(ot,at){ot.addFieldOffset(0,at,0)}static addVersion(ot,at){ot.addFieldInt64(1,at,ot.createLong(0,0))}static endOperatorSetId(ot){return ot.endObject()}static createOperatorSetId(ot,at,ht){return ut.startOperatorSetId(ot),ut.addDomain(ot,at),ut.addVersion(ot,ht),ut.endOperatorSetId(ot)}}st.OperatorSetId=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsTensor(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsTensor(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}name(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}docString(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__string(this.bb_pos+at,ot):null}dims(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.readInt64(this.bb.__vector(this.bb_pos+at)+8*ot):this.bb.createLong(0,0)}dimsLength(){let ot=this.bb.__offset(this.bb_pos,8);return ot?this.bb.__vector_len(this.bb_pos+ot):0}dataType(){let ot=this.bb.__offset(this.bb_pos,10);return ot?this.bb.readInt32(this.bb_pos+ot):nt.experimental.fbs.TensorDataType.UNDEFINED}rawData(ot){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.readUint8(this.bb.__vector(this.bb_pos+at)+ot):0}rawDataLength(){let ot=this.bb.__offset(this.bb_pos,12);return ot?this.bb.__vector_len(this.bb_pos+ot):0}rawDataArray(){let ot=this.bb.__offset(this.bb_pos,12);return ot?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+ot),this.bb.__vector_len(this.bb_pos+ot)):null}stringData(ot,at){let ht=this.bb.__offset(this.bb_pos,14);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}stringDataLength(){let ot=this.bb.__offset(this.bb_pos,14);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startTensor(ot){ot.startObject(6)}static addName(ot,at){ot.addFieldOffset(0,at,0)}static addDocString(ot,at){ot.addFieldOffset(1,at,0)}static addDims(ot,at){ot.addFieldOffset(2,at,0)}static createDimsVector(ot,at){ot.startVector(8,at.length,8);for(let ht=at.length-1;ht>=0;ht--)ot.addInt64(at[ht]);return ot.endVector()}static startDimsVector(ot,at){ot.startVector(8,at,8)}static addDataType(ot,at){ot.addFieldInt32(3,at,nt.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(ot,at){ot.addFieldOffset(4,at,0)}static createRawDataVector(ot,at){ot.startVector(1,at.length,1);for(let ht=at.length-1;ht>=0;ht--)ot.addInt8(at[ht]);return ot.endVector()}static startRawDataVector(ot,at){ot.startVector(1,at,1)}static addStringData(ot,at){ot.addFieldOffset(5,at,0)}static createStringDataVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startStringDataVector(ot,at){ot.startVector(4,at,4)}static endTensor(ot){return ot.endObject()}static createTensor(ot,at,ht,ft,mt,yt,bt){return ut.startTensor(ot),ut.addName(ot,at),ut.addDocString(ot,ht),ut.addDims(ot,ft),ut.addDataType(ot,mt),ut.addRawData(ot,yt),ut.addStringData(ot,bt),ut.endTensor(ot)}}st.Tensor=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsSparseTensor(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsSparseTensor(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}values(ot){let at=this.bb.__offset(this.bb_pos,4);return at?(ot||new nt.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}indices(ot){let at=this.bb.__offset(this.bb_pos,6);return at?(ot||new nt.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}dims(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.readInt64(this.bb.__vector(this.bb_pos+at)+8*ot):this.bb.createLong(0,0)}dimsLength(){let ot=this.bb.__offset(this.bb_pos,8);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startSparseTensor(ot){ot.startObject(3)}static addValues(ot,at){ot.addFieldOffset(0,at,0)}static addIndices(ot,at){ot.addFieldOffset(1,at,0)}static addDims(ot,at){ot.addFieldOffset(2,at,0)}static createDimsVector(ot,at){ot.startVector(8,at.length,8);for(let ht=at.length-1;ht>=0;ht--)ot.addInt64(at[ht]);return ot.endVector()}static startDimsVector(ot,at){ot.startVector(8,at,8)}static endSparseTensor(ot){return ot.endObject()}static createSparseTensor(ot,at,ht,ft){return ut.startSparseTensor(ot),ut.addValues(ot,at),ut.addIndices(ot,ht),ut.addDims(ot,ft),ut.endSparseTensor(ot)}}st.SparseTensor=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsAttribute(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsAttribute(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}name(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}docString(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__string(this.bb_pos+at,ot):null}type(){let ot=this.bb.__offset(this.bb_pos,8);return ot?this.bb.readInt32(this.bb_pos+ot):nt.experimental.fbs.AttributeType.UNDEFINED}f(){let ot=this.bb.__offset(this.bb_pos,10);return ot?this.bb.readFloat32(this.bb_pos+ot):0}i(){let ot=this.bb.__offset(this.bb_pos,12);return ot?this.bb.readInt64(this.bb_pos+ot):this.bb.createLong(0,0)}s(ot){let at=this.bb.__offset(this.bb_pos,14);return at?this.bb.__string(this.bb_pos+at,ot):null}t(ot){let at=this.bb.__offset(this.bb_pos,16);return at?(ot||new nt.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}g(ot){let at=this.bb.__offset(this.bb_pos,18);return at?(ot||new nt.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}floats(ot){let at=this.bb.__offset(this.bb_pos,20);return at?this.bb.readFloat32(this.bb.__vector(this.bb_pos+at)+4*ot):0}floatsLength(){let ot=this.bb.__offset(this.bb_pos,20);return ot?this.bb.__vector_len(this.bb_pos+ot):0}floatsArray(){let ot=this.bb.__offset(this.bb_pos,20);return ot?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+ot),this.bb.__vector_len(this.bb_pos+ot)):null}ints(ot){let at=this.bb.__offset(this.bb_pos,22);return at?this.bb.readInt64(this.bb.__vector(this.bb_pos+at)+8*ot):this.bb.createLong(0,0)}intsLength(){let ot=this.bb.__offset(this.bb_pos,22);return ot?this.bb.__vector_len(this.bb_pos+ot):0}strings(ot,at){let ht=this.bb.__offset(this.bb_pos,24);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}stringsLength(){let ot=this.bb.__offset(this.bb_pos,24);return ot?this.bb.__vector_len(this.bb_pos+ot):0}tensors(ot,at){let ht=this.bb.__offset(this.bb_pos,26);return ht?(at||new nt.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}tensorsLength(){let ot=this.bb.__offset(this.bb_pos,26);return ot?this.bb.__vector_len(this.bb_pos+ot):0}graphs(ot,at){let ht=this.bb.__offset(this.bb_pos,28);return ht?(at||new nt.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}graphsLength(){let ot=this.bb.__offset(this.bb_pos,28);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startAttribute(ot){ot.startObject(13)}static addName(ot,at){ot.addFieldOffset(0,at,0)}static addDocString(ot,at){ot.addFieldOffset(1,at,0)}static addType(ot,at){ot.addFieldInt32(2,at,nt.experimental.fbs.AttributeType.UNDEFINED)}static addF(ot,at){ot.addFieldFloat32(3,at,0)}static addI(ot,at){ot.addFieldInt64(4,at,ot.createLong(0,0))}static addS(ot,at){ot.addFieldOffset(5,at,0)}static addT(ot,at){ot.addFieldOffset(6,at,0)}static addG(ot,at){ot.addFieldOffset(7,at,0)}static addFloats(ot,at){ot.addFieldOffset(8,at,0)}static createFloatsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addFloat32(at[ht]);return ot.endVector()}static startFloatsVector(ot,at){ot.startVector(4,at,4)}static addInts(ot,at){ot.addFieldOffset(9,at,0)}static createIntsVector(ot,at){ot.startVector(8,at.length,8);for(let ht=at.length-1;ht>=0;ht--)ot.addInt64(at[ht]);return ot.endVector()}static startIntsVector(ot,at){ot.startVector(8,at,8)}static addStrings(ot,at){ot.addFieldOffset(10,at,0)}static createStringsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startStringsVector(ot,at){ot.startVector(4,at,4)}static addTensors(ot,at){ot.addFieldOffset(11,at,0)}static createTensorsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startTensorsVector(ot,at){ot.startVector(4,at,4)}static addGraphs(ot,at){ot.addFieldOffset(12,at,0)}static createGraphsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startGraphsVector(ot,at){ot.startVector(4,at,4)}static endAttribute(ot){return ot.endObject()}static createAttribute(ot,at,ht,ft,mt,yt,bt,wt,Tt,Ct,Dt,Ot,$t,Ft){return ut.startAttribute(ot),ut.addName(ot,at),ut.addDocString(ot,ht),ut.addType(ot,ft),ut.addF(ot,mt),ut.addI(ot,yt),ut.addS(ot,bt),ut.addT(ot,wt),ut.addG(ot,Tt),ut.addFloats(ot,Ct),ut.addInts(ot,Dt),ut.addStrings(ot,Ot),ut.addTensors(ot,$t),ut.addGraphs(ot,Ft),ut.endAttribute(ot)}}st.Attribute=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsGraph(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsGraph(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}initializers(ot,at){let ht=this.bb.__offset(this.bb_pos,4);return ht?(at||new nt.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}initializersLength(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.__vector_len(this.bb_pos+ot):0}nodeArgs(ot,at){let ht=this.bb.__offset(this.bb_pos,6);return ht?(at||new nt.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}nodeArgsLength(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.__vector_len(this.bb_pos+ot):0}nodes(ot,at){let ht=this.bb.__offset(this.bb_pos,8);return ht?(at||new nt.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}nodesLength(){let ot=this.bb.__offset(this.bb_pos,8);return ot?this.bb.__vector_len(this.bb_pos+ot):0}maxNodeIndex(){let ot=this.bb.__offset(this.bb_pos,10);return ot?this.bb.readUint32(this.bb_pos+ot):0}nodeEdges(ot,at){let ht=this.bb.__offset(this.bb_pos,12);return ht?(at||new nt.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}nodeEdgesLength(){let ot=this.bb.__offset(this.bb_pos,12);return ot?this.bb.__vector_len(this.bb_pos+ot):0}inputs(ot,at){let ht=this.bb.__offset(this.bb_pos,14);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}inputsLength(){let ot=this.bb.__offset(this.bb_pos,14);return ot?this.bb.__vector_len(this.bb_pos+ot):0}outputs(ot,at){let ht=this.bb.__offset(this.bb_pos,16);return ht?this.bb.__string(this.bb.__vector(this.bb_pos+ht)+4*ot,at):null}outputsLength(){let ot=this.bb.__offset(this.bb_pos,16);return ot?this.bb.__vector_len(this.bb_pos+ot):0}sparseInitializers(ot,at){let ht=this.bb.__offset(this.bb_pos,18);return ht?(at||new nt.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}sparseInitializersLength(){let ot=this.bb.__offset(this.bb_pos,18);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startGraph(ot){ot.startObject(8)}static addInitializers(ot,at){ot.addFieldOffset(0,at,0)}static createInitializersVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startInitializersVector(ot,at){ot.startVector(4,at,4)}static addNodeArgs(ot,at){ot.addFieldOffset(1,at,0)}static createNodeArgsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startNodeArgsVector(ot,at){ot.startVector(4,at,4)}static addNodes(ot,at){ot.addFieldOffset(2,at,0)}static createNodesVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startNodesVector(ot,at){ot.startVector(4,at,4)}static addMaxNodeIndex(ot,at){ot.addFieldInt32(3,at,0)}static addNodeEdges(ot,at){ot.addFieldOffset(4,at,0)}static createNodeEdgesVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startNodeEdgesVector(ot,at){ot.startVector(4,at,4)}static addInputs(ot,at){ot.addFieldOffset(5,at,0)}static createInputsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startInputsVector(ot,at){ot.startVector(4,at,4)}static addOutputs(ot,at){ot.addFieldOffset(6,at,0)}static createOutputsVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startOutputsVector(ot,at){ot.startVector(4,at,4)}static addSparseInitializers(ot,at){ot.addFieldOffset(7,at,0)}static createSparseInitializersVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startSparseInitializersVector(ot,at){ot.startVector(4,at,4)}static endGraph(ot){return ot.endObject()}static createGraph(ot,at,ht,ft,mt,yt,bt,wt,Tt){return ut.startGraph(ot),ut.addInitializers(ot,at),ut.addNodeArgs(ot,ht),ut.addNodes(ot,ft),ut.addMaxNodeIndex(ot,mt),ut.addNodeEdges(ot,yt),ut.addInputs(ot,bt),ut.addOutputs(ot,wt),ut.addSparseInitializers(ot,Tt),ut.endGraph(ot)}}st.Graph=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsModel(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsModel(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}irVersion(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.readInt64(this.bb_pos+ot):this.bb.createLong(0,0)}opsetImport(ot,at){let ht=this.bb.__offset(this.bb_pos,6);return ht?(at||new nt.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}opsetImportLength(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.__vector_len(this.bb_pos+ot):0}producerName(ot){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__string(this.bb_pos+at,ot):null}producerVersion(ot){let at=this.bb.__offset(this.bb_pos,10);return at?this.bb.__string(this.bb_pos+at,ot):null}domain(ot){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.__string(this.bb_pos+at,ot):null}modelVersion(){let ot=this.bb.__offset(this.bb_pos,14);return ot?this.bb.readInt64(this.bb_pos+ot):this.bb.createLong(0,0)}docString(ot){let at=this.bb.__offset(this.bb_pos,16);return at?this.bb.__string(this.bb_pos+at,ot):null}graph(ot){let at=this.bb.__offset(this.bb_pos,18);return at?(ot||new nt.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}graphDocString(ot){let at=this.bb.__offset(this.bb_pos,20);return at?this.bb.__string(this.bb_pos+at,ot):null}static startModel(ot){ot.startObject(9)}static addIrVersion(ot,at){ot.addFieldInt64(0,at,ot.createLong(0,0))}static addOpsetImport(ot,at){ot.addFieldOffset(1,at,0)}static createOpsetImportVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startOpsetImportVector(ot,at){ot.startVector(4,at,4)}static addProducerName(ot,at){ot.addFieldOffset(2,at,0)}static addProducerVersion(ot,at){ot.addFieldOffset(3,at,0)}static addDomain(ot,at){ot.addFieldOffset(4,at,0)}static addModelVersion(ot,at){ot.addFieldInt64(5,at,ot.createLong(0,0))}static addDocString(ot,at){ot.addFieldOffset(6,at,0)}static addGraph(ot,at){ot.addFieldOffset(7,at,0)}static addGraphDocString(ot,at){ot.addFieldOffset(8,at,0)}static endModel(ot){return ot.endObject()}static createModel(ot,at,ht,ft,mt,yt,bt,wt,Tt,Ct){return ut.startModel(ot),ut.addIrVersion(ot,at),ut.addOpsetImport(ot,ht),ut.addProducerName(ot,ft),ut.addProducerVersion(ot,mt),ut.addDomain(ot,yt),ut.addModelVersion(ot,bt),ut.addDocString(ot,wt),ut.addGraph(ot,Tt),ut.addGraphDocString(ot,Ct),ut.endModel(ot)}}st.Model=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsKernelCreateInfos(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsKernelCreateInfos(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}nodeIndices(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readUint32(this.bb.__vector(this.bb_pos+at)+4*ot):0}nodeIndicesLength(){let ot=this.bb.__offset(this.bb_pos,4);return ot?this.bb.__vector_len(this.bb_pos+ot):0}nodeIndicesArray(){let ot=this.bb.__offset(this.bb_pos,4);return ot?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+ot),this.bb.__vector_len(this.bb_pos+ot)):null}kernelDefHashes(ot){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.readUint64(this.bb.__vector(this.bb_pos+at)+8*ot):this.bb.createLong(0,0)}kernelDefHashesLength(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startKernelCreateInfos(ot){ot.startObject(2)}static addNodeIndices(ot,at){ot.addFieldOffset(0,at,0)}static createNodeIndicesVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addInt32(at[ht]);return ot.endVector()}static startNodeIndicesVector(ot,at){ot.startVector(4,at,4)}static addKernelDefHashes(ot,at){ot.addFieldOffset(1,at,0)}static createKernelDefHashesVector(ot,at){ot.startVector(8,at.length,8);for(let ht=at.length-1;ht>=0;ht--)ot.addInt64(at[ht]);return ot.endVector()}static startKernelDefHashesVector(ot,at){ot.startVector(8,at,8)}static endKernelCreateInfos(ot){return ot.endObject()}static createKernelCreateInfos(ot,at,ht){return ut.startKernelCreateInfos(ot),ut.addNodeIndices(ot,at),ut.addKernelDefHashes(ot,ht),ut.endKernelCreateInfos(ot)}}st.KernelCreateInfos=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsSubGraphSessionState(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsSubGraphSessionState(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}graphId(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}sessionState(ot){let at=this.bb.__offset(this.bb_pos,6);return at?(ot||new nt.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startSubGraphSessionState(ot){ot.startObject(2)}static addGraphId(ot,at){ot.addFieldOffset(0,at,0)}static addSessionState(ot,at){ot.addFieldOffset(1,at,0)}static endSubGraphSessionState(ot){let at=ot.endObject();return ot.requiredField(at,4),at}static createSubGraphSessionState(ot,at,ht){return ut.startSubGraphSessionState(ot),ut.addGraphId(ot,at),ut.addSessionState(ot,ht),ut.endSubGraphSessionState(ot)}}st.SubGraphSessionState=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsSessionState(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsSessionState(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}kernels(ot){let at=this.bb.__offset(this.bb_pos,4);return at?(ot||new nt.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}subGraphSessionStates(ot,at){let ht=this.bb.__offset(this.bb_pos,6);return ht?(at||new nt.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+ht)+4*ot),this.bb):null}subGraphSessionStatesLength(){let ot=this.bb.__offset(this.bb_pos,6);return ot?this.bb.__vector_len(this.bb_pos+ot):0}static startSessionState(ot){ot.startObject(2)}static addKernels(ot,at){ot.addFieldOffset(0,at,0)}static addSubGraphSessionStates(ot,at){ot.addFieldOffset(1,at,0)}static createSubGraphSessionStatesVector(ot,at){ot.startVector(4,at.length,4);for(let ht=at.length-1;ht>=0;ht--)ot.addOffset(at[ht]);return ot.endVector()}static startSubGraphSessionStatesVector(ot,at){ot.startVector(4,at,4)}static endSessionState(ot){return ot.endObject()}static createSessionState(ot,at,ht){return ut.startSessionState(ot),ut.addKernels(ot,at),ut.addSubGraphSessionStates(ot,ht),ut.endSessionState(ot)}}st.SessionState=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={})),function(nt){(function(it){(function(st){class ut{constructor(){this.bb=null,this.bb_pos=0}__init(ot,at){return this.bb_pos=ot,this.bb=at,this}static getRootAsInferenceSession(ot,at){return(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static getSizePrefixedRootAsInferenceSession(ot,at){return ot.setPosition(ot.position()+c.flatbuffers.SIZE_PREFIX_LENGTH),(at||new ut).__init(ot.readInt32(ot.position())+ot.position(),ot)}static bufferHasIdentifier(ot){return ot.__has_identifier("ORTM")}ortVersion(ot){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__string(this.bb_pos+at,ot):null}model(ot){let at=this.bb.__offset(this.bb_pos,6);return at?(ot||new nt.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}sessionState(ot){let at=this.bb.__offset(this.bb_pos,8);return at?(ot||new nt.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+at),this.bb):null}static startInferenceSession(ot){ot.startObject(3)}static addOrtVersion(ot,at){ot.addFieldOffset(0,at,0)}static addModel(ot,at){ot.addFieldOffset(1,at,0)}static addSessionState(ot,at){ot.addFieldOffset(2,at,0)}static endInferenceSession(ot){return ot.endObject()}static finishInferenceSessionBuffer(ot,at){ot.finish(at,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(ot,at){ot.finish(at,"ORTM",!0)}static createInferenceSession(ot,at,ht,ft){return ut.startInferenceSession(ot),ut.addOrtVersion(ot,at),ut.addModel(ot,ht),ut.addSessionState(ot,ft),ut.endInferenceSession(ot)}}st.InferenceSession=ut})(it.fbs||(it.fbs={}))})(nt.experimental||(nt.experimental={}))}(a.onnxruntime||(a.onnxruntime={}))},7448:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OnnxjsSessionHandler=void 0;const c=o(1670),d=o(9162);a.OnnxjsSessionHandler=class{constructor(tt){this.session=tt,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(tt,nt,it){const st=new Map;for(const ot in tt)if(Object.hasOwnProperty.call(tt,ot)){const at=tt[ot];st.set(ot,new d.Tensor(at.dims,at.type,void 0,void 0,at.data))}const ut=await this.session.run(st),ct={};return ut.forEach((ot,at)=>{ct[at]=new c.Tensor(ot.type,ot.data,ot.dims)}),ct}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6919:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Session=void 0;const c=o(7067),d=o(1296),tt=o(7091),nt=o(1036),it=o(6231),st=o(2644);a.Session=class{constructor(ut={}){this._initialized=!1,this.backendHint=ut.backendHint,this.profiler=it.Profiler.create(ut.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(ut,ct,ot){await this.profiler.event("session","Session.loadModel",async()=>{const at=await(0,tt.resolveBackend)(this.backendHint);if(this.sessionHandler=at.createSessionHandler(this.context),this._model=new st.Model,typeof ut=="string"){const ht=ut.endsWith(".ort");if(typeof fetch>"u"){const ft=await(0,d.promisify)(c.readFile)(ut);this.initialize(ft,ht)}else{const ft=await fetch(ut),mt=await ft.arrayBuffer();this.initialize(new Uint8Array(mt),ht)}}else if(ArrayBuffer.isView(ut))this.initialize(ut);else{const ht=new Uint8Array(ut,ct||0,ot||ut.byteLength);this.initialize(ht)}})}initialize(ut,ct){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{const ot=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(ut,ot,ct),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new nt.ExecutionPlan(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(ut){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{const ct=this.normalizeAndValidateInputs(ut),ot=await this._executionPlan.execute(this.sessionHandler,ct);return this.createOutput(ot)})}normalizeAndValidateInputs(ut){const ct=this._model.graph.getInputNames();if(Array.isArray(ut)){if(ut.length!==ct.length)throw new Error(`incorrect input array length: expected ${ct.length} but got ${ut.length}`)}else{if(ut.size!==ct.length)throw new Error(`incorrect input map size: expected ${ct.length} but got ${ut.size}`);const ot=new Array(ut.size);let at=0;for(let ht=0;ht<ct.length;++ht){const ft=ut.get(ct[ht]);if(!ft)throw new Error(`missing input tensor for: '${name}'`);ot[at++]=ft}ut=ot}if(this.context.graphInputTypes&&this.context.graphInputTypes.length!==0&&this.context.graphInputDims&&this.context.graphInputDims.length!==0)this.validateInputTensorDims(this.context.graphInputDims,ut,!1);else{const ot=this._model.graph.getInputIndices(),at=this._model.graph.getValues(),ht=new Array(ot.length);for(let ft=0;ft<ot.length;++ft){const mt=at[ot[ft]];ht[ft]=mt.type.shape.dims,this.context.graphInputTypes.push(mt.type.tensorType),this.context.graphInputDims.push(ut[ft].dims)}this.validateInputTensorDims(ht,ut,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,ut),ut}validateInputTensorTypes(ut,ct){for(let ot=0;ot<ct.length;ot++){const at=ut[ot],ht=ct[ot].type;if(at!==ht)throw new Error(`input tensor[${ot}] check failed: expected type '${at}' but got ${ht}`)}}validateInputTensorDims(ut,ct,ot){for(let at=0;at<ct.length;at++){const ht=ut[at],ft=ct[at].dims;if(!this.compareTensorDims(ht,ft,ot))throw new Error(`input tensor[${at}] check failed: expected shape '[${ht.join(",")}]' but got [${ft.join(",")}]`)}}compareTensorDims(ut,ct,ot){if(ut.length!==ct.length)return!1;for(let at=0;at<ut.length;++at)if(ut[at]!==ct[at]&&(!ot||ut[at]!==0))return!1;return!0}createOutput(ut){const ct=this._model.graph.getOutputNames();if(ut.length!==ct.length)throw new Error("expected number of outputs do not match number of generated outputs");const ot=new Map;for(let at=0;at<ct.length;++at)ot.set(ct[at],ut[at]);return ot}initializeOps(ut){const ct=ut.getNodes();this._ops=new Array(ct.length);for(let ot=0;ot<ct.length;ot++)this._ops[ot]=this.sessionHandler.resolve(ct[ot],this._model.opsets,ut)}}},9162:function(s,a,o){var c=this&&this.__importDefault||function(mt){return mt&&mt.__esModule?mt:{default:mt}};Object.defineProperty(a,"__esModule",{value:!0}),a.Tensor=void 0;const d=o(3442),tt=c(o(3720)),nt=o(1446),it=o(9395),st=o(2517);var ut=it.onnxruntime.experimental.fbs;class ct{get data(){if(this.cache===void 0){const yt=this.dataProvider(this.dataId);if(yt.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=yt}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(yt){return this.data[st.ShapeUtil.indicesToOffset(yt,this.strides)]}set(yt,bt){this.data[st.ShapeUtil.indicesToOffset(yt,this.strides)]=bt}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=st.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(yt,bt,wt,Tt,Ct,Dt=d.Guid.create()){this.dims=yt,this.type=bt,this.dataProvider=wt,this.asyncDataProvider=Tt,this.cache=Ct,this.dataId=Dt,this.size=st.ShapeUtil.validateDimsAndCalcSize(yt);const Ot=this.size,$t=wt===void 0&&Tt===void 0&&Ct===void 0;if(Ct!==void 0&&Ct.length!==Ot)throw new RangeError("Input dims doesn't match data length.");if(bt==="string"){if(!(Ct===void 0||Array.isArray(Ct)&&Ct.every(Ft=>typeof Ft=="string")))throw new TypeError("cache should be a string array");$t&&(this.cache=new Array(Ot))}else{if(Ct!==void 0){const Ft=at(bt);if(!(Ct instanceof Ft))throw new TypeError(`cache should be type ${Ft.name}`)}if($t){const Ft=new ArrayBuffer(Ot*function(kt){switch(kt){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${kt}`)}}(bt));this.cache=function(kt,Vt){return new(at(Vt))(kt)}(Ft,bt)}}}static fromProto(yt){if(!yt)throw new Error("cannot construct Value from an empty tensor");const bt=st.ProtoUtil.tensorDataTypeFromProto(yt.dataType),wt=st.ProtoUtil.tensorDimsFromProto(yt.dims),Tt=new ct(wt,bt);if(bt==="string")yt.stringData.forEach((Ct,Dt)=>{Tt.data[Dt]=(0,st.decodeUtf8String)(Ct)});else if(yt.rawData&&typeof yt.rawData.byteLength=="number"&&yt.rawData.byteLength>0){const Ct=Tt.data,Dt=new DataView(yt.rawData.buffer,yt.rawData.byteOffset,yt.rawData.byteLength),Ot=ot(yt.dataType),$t=yt.rawData.byteLength/Ot;if(yt.rawData.byteLength%Ot!=0)throw new Error("invalid buffer length");if(Ct.length!==$t)throw new Error("buffer length mismatch");for(let Ft=0;Ft<$t;Ft++){const kt=ft(Dt,yt.dataType,Ft*Ot);Ct[Ft]=kt}}else{let Ct;switch(yt.dataType){case nt.onnx.TensorProto.DataType.FLOAT:Ct=yt.floatData;break;case nt.onnx.TensorProto.DataType.INT32:case nt.onnx.TensorProto.DataType.INT16:case nt.onnx.TensorProto.DataType.UINT16:case nt.onnx.TensorProto.DataType.INT8:case nt.onnx.TensorProto.DataType.UINT8:case nt.onnx.TensorProto.DataType.BOOL:Ct=yt.int32Data;break;case nt.onnx.TensorProto.DataType.INT64:Ct=yt.int64Data;break;case nt.onnx.TensorProto.DataType.DOUBLE:Ct=yt.doubleData;break;case nt.onnx.TensorProto.DataType.UINT32:case nt.onnx.TensorProto.DataType.UINT64:Ct=yt.uint64Data;break;default:throw new Error("unspecific error")}if(Ct==null)throw new Error("failed to populate data from a tensorproto value");const Dt=Tt.data;if(Dt.length!==Ct.length)throw new Error("array length mismatch");for(let Ot=0;Ot<Ct.length;Ot++){const $t=Ct[Ot];tt.default.isLong($t)?Dt[Ot]=ht($t,yt.dataType):Dt[Ot]=$t}}return Tt}static fromData(yt,bt,wt){return new ct(bt,wt,void 0,void 0,yt)}static fromOrtTensor(yt){if(!yt)throw new Error("cannot construct Value from an empty tensor");const bt=st.ProtoUtil.tensorDimsFromORTFormat(yt),wt=st.ProtoUtil.tensorDataTypeFromProto(yt.dataType()),Tt=new ct(bt,wt);if(wt==="string")for(let Ct=0;Ct<yt.stringDataLength();Ct++)Tt.data[Ct]=yt.stringData(Ct);else if(yt.rawDataArray()&&typeof yt.rawDataLength()=="number"&&yt.rawDataLength()>0){const Ct=Tt.data,Dt=new DataView(yt.rawDataArray().buffer,yt.rawDataArray().byteOffset,yt.rawDataLength()),Ot=ot(yt.dataType()),$t=yt.rawDataLength()/Ot;if(yt.rawDataLength()%Ot!=0)throw new Error("invalid buffer length");if(Ct.length!==$t)throw new Error("buffer length mismatch");for(let Ft=0;Ft<$t;Ft++){const kt=ft(Dt,yt.dataType(),Ft*Ot);Ct[Ft]=kt}}return Tt}}function ot(mt){switch(mt){case nt.onnx.TensorProto.DataType.UINT8:case nt.onnx.TensorProto.DataType.INT8:case nt.onnx.TensorProto.DataType.BOOL:return 1;case nt.onnx.TensorProto.DataType.UINT16:case nt.onnx.TensorProto.DataType.INT16:return 2;case nt.onnx.TensorProto.DataType.FLOAT:case nt.onnx.TensorProto.DataType.INT32:case nt.onnx.TensorProto.DataType.UINT32:return 4;case nt.onnx.TensorProto.DataType.INT64:case nt.onnx.TensorProto.DataType.DOUBLE:case nt.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${nt.onnx.TensorProto.DataType[mt]}`)}}function at(mt){switch(mt){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function ht(mt,yt){if(yt===nt.onnx.TensorProto.DataType.INT64||yt===ut.TensorDataType.INT64){if(mt.greaterThanOrEqual(2147483648)||mt.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(yt!==nt.onnx.TensorProto.DataType.UINT32&&yt!==ut.TensorDataType.UINT32&&yt!==nt.onnx.TensorProto.DataType.UINT64&&yt!==ut.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${nt.onnx.TensorProto.DataType[yt]}`);if(mt.greaterThanOrEqual(4294967296)||mt.lessThan(0))throw new TypeError("uint64 is not supported")}return mt.toNumber()}function ft(mt,yt,bt){switch(yt){case nt.onnx.TensorProto.DataType.BOOL:case nt.onnx.TensorProto.DataType.UINT8:return mt.getUint8(bt);case nt.onnx.TensorProto.DataType.INT8:return mt.getInt8(bt);case nt.onnx.TensorProto.DataType.UINT16:return mt.getUint16(bt,!0);case nt.onnx.TensorProto.DataType.INT16:return mt.getInt16(bt,!0);case nt.onnx.TensorProto.DataType.FLOAT:return mt.getFloat32(bt,!0);case nt.onnx.TensorProto.DataType.INT32:return mt.getInt32(bt,!0);case nt.onnx.TensorProto.DataType.UINT32:return mt.getUint32(bt,!0);case nt.onnx.TensorProto.DataType.INT64:return ht(tt.default.fromBits(mt.getUint32(bt,!0),mt.getUint32(bt+4,!0),!1),yt);case nt.onnx.TensorProto.DataType.DOUBLE:return mt.getFloat64(bt,!0);case nt.onnx.TensorProto.DataType.UINT64:return ht(tt.default.fromBits(mt.getUint32(bt,!0),mt.getUint32(bt+4,!0),!0),yt);default:throw new Error(`cannot read from DataView for type ${nt.onnx.TensorProto.DataType[yt]}`)}}a.Tensor=ct},2517:function(s,a,o){var c=this&&this.__importDefault||function(yt){return yt&&yt.__esModule?yt:{default:yt}};Object.defineProperty(a,"__esModule",{value:!0}),a.decodeUtf8String=a.MAX_CLIP=a.MIN_CLIP=a.PoolConvUtil=a.ReduceUtil=a.SplitUtil=a.MathUtil=a.ShapeUtil=a.LongUtil=a.ProtoUtil=a.GemmUtil=a.arrayCopyHelper=a.BroadcastUtil=a.MatMulUtil=a.ArrayUtil=a.assert=a.checkInputsShape=void 0;const d=o(5686),tt=c(o(3720)),nt=o(1446),it=o(9162);a.checkInputsShape=function(yt,...bt){if(!yt||yt.length!==bt.length)return!1;for(let wt=0;wt<yt.length;wt++)if(!yt[wt].dims||yt[wt].dims.length!==bt[wt])return!1;return!0},a.assert=function(yt,bt){if(!yt)throw new Error(typeof bt=="string"?bt:bt())},a.ArrayUtil=class{static arraysEqual(yt,bt){if(yt.length!==bt.length)return!1;for(let wt=0;wt<yt.length;wt++)if(yt[wt]!==bt[wt])return!1;return!0}};class st{static preprocessInputShapes(bt,wt){return[bt.length===1?[1,bt[0]]:bt,wt.length===1?[wt[0],1]:wt]}static postprocessOutputShape(bt,wt,Tt){wt===1&&bt.splice(bt.length-2,1),Tt===1&&bt.pop()}static calcMatMulShape(bt,wt){return bt[1]!==wt[0]?void 0:[bt[0],wt[1]]}}a.MatMulUtil=st;class ut{static calcShape(bt,wt,Tt=!1){const Ct=bt.length,Dt=wt.length;if(Ct===0)return wt;if(Dt===0)return bt;const Ot=Math.max(bt.length,wt.length),$t=new Array(Ot);if(Tt){if(Ct<2||Dt<2)return;const Ft=st.calcMatMulShape([bt[Ct-2],bt[Ct-1]],[wt[Dt-2],wt[Dt-1]]);if(Ft===void 0)return;[$t[Ot-2],$t[Ot-1]]=Ft}for(let Ft=Tt?3:1;Ft<=Ot;Ft++){const kt=Ct-Ft<0?1:bt[Ct-Ft],Vt=Dt-Ft<0?1:wt[Dt-Ft];if(kt!==Vt&&kt>1&&Vt>1)return;$t[Ot-Ft]=Math.max(kt,Vt)}return $t}static index(bt,wt){const Tt=new Array(wt.length);return ut.fillIndex(bt,wt,Tt),Tt}static fillIndex(bt,wt,Tt){const Ct=bt.length-wt.length;for(let Dt=0;Dt<wt.length;Dt++)Tt[Dt]=bt[Ct+Dt]%wt[Dt]}static calc(bt,wt,Tt,Ct,Dt){const Ot=ut.calcShape(bt.dims,wt.dims);if(Ot){if(Ct&&!at.areEqual(Ot,bt.dims))return;const $t=at.size(Ot),Ft=Ct?bt:new it.Tensor(Ot,Dt||bt.type);if(Ot.length===0)Ft.set([],Tt(bt.get([]),wt.get([])));else{const kt=new Array(Ot.length),Vt=new Array(bt.dims.length),Ht=new Array(wt.dims.length);let Qt,Xt=0,Zt=0,ar=!1,nr=!1;bt.dims.length===0&&(Xt=bt.get([]),ar=!0),wt.dims.length===0&&(Zt=wt.get([]),nr=!0);for(let cr=0;cr<$t;cr++){Qt=cr;for(let dr=Ot.length-1;dr>=0;dr--)kt[dr]=Qt%Ot[dr],Qt=Math.floor(Qt/Ot[dr]);ar||(ut.fillIndex(kt,bt.dims,Vt),Xt=bt.get(Vt)),nr||(ut.fillIndex(kt,wt.dims,Ht),Zt=wt.get(Ht)),Ft.set(kt,Tt(Xt,Zt))}}return Ft}}static isValidBroadcast(bt,wt){const Tt=bt.length,Ct=wt.length;if(Tt>Ct)return!1;for(let Dt=1;Dt<=Tt;Dt++)if(bt[Tt-Dt]!==1&&bt[Tt-Dt]!==wt[Ct-Dt])return!1;return!0}static getBroadcastDims(bt,wt){const Tt=bt.length,Ct=[];for(let Dt=0;Dt<Tt;Dt++){const Ot=Tt-1-Dt,$t=bt[Ot]||1;(wt[wt.length-1-Dt]||1)>1&&$t===1&&Ct.unshift(Ot)}return Ct}}a.BroadcastUtil=ut,a.arrayCopyHelper=function(yt,bt,wt,Tt,Ct){if(Tt<0||Tt>=bt.length)throw new Error("sourceIndex out of bounds");if(wt<0||wt>=yt.length)throw new Error("targetIndex out of bounds");if(Tt+Ct>bt.length)throw new Error("source indices to be copied are outside bounds");if(wt+Ct>yt.length)throw new Error("target array is too small to hold result");for(let Dt=0;Dt<Ct;Dt++)yt[wt+Dt]=bt[Tt+Dt]},a.GemmUtil=class{static getShapeOfGemmResult(yt,bt,wt,Tt,Ct){if(yt.length!==2||wt.length!==2)throw new Error("shape need to be of size 2");let Dt,Ot,$t;bt?(Dt=yt[1],Ot=yt[0]):(Dt=yt[0],Ot=yt[1]);let Ft=-1;if(Tt?($t=wt[0],Ft=1):($t=wt[1],Ft=0),wt[Ft]!==Ot)throw new Error("dimension mismatch");if(Dt<=0||$t<=0||Ot<=0)throw new Error("invalid shape specified");if(Ct&&!ut.isValidBroadcast(Ct,[Dt,$t]))throw new Error("gemm: invalid bias shape for broadcast");return[Dt,$t,Ot]}};class ct{static tensorDataTypeFromProto(bt){switch(bt){case nt.onnx.TensorProto.DataType.INT8:return"int8";case nt.onnx.TensorProto.DataType.UINT8:return"uint8";case nt.onnx.TensorProto.DataType.BOOL:return"bool";case nt.onnx.TensorProto.DataType.INT16:return"int16";case nt.onnx.TensorProto.DataType.UINT16:return"uint16";case nt.onnx.TensorProto.DataType.INT32:return"int32";case nt.onnx.TensorProto.DataType.UINT32:return"uint32";case nt.onnx.TensorProto.DataType.FLOAT:return"float32";case nt.onnx.TensorProto.DataType.DOUBLE:return"float64";case nt.onnx.TensorProto.DataType.STRING:return"string";case nt.onnx.TensorProto.DataType.INT64:return"int32";case nt.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${nt.onnx.TensorProto.DataType[bt]}`)}}static tensorDataTypeStringToEnum(bt){switch(bt){case"int8":return nt.onnx.TensorProto.DataType.INT8;case"uint8":return nt.onnx.TensorProto.DataType.UINT8;case"bool":return nt.onnx.TensorProto.DataType.BOOL;case"int16":return nt.onnx.TensorProto.DataType.INT16;case"uint16":return nt.onnx.TensorProto.DataType.UINT16;case"int32":return nt.onnx.TensorProto.DataType.INT32;case"uint32":return nt.onnx.TensorProto.DataType.UINT32;case"float32":return nt.onnx.TensorProto.DataType.FLOAT;case"float64":return nt.onnx.TensorProto.DataType.DOUBLE;case"string":return nt.onnx.TensorProto.DataType.STRING;case"int64":return nt.onnx.TensorProto.DataType.INT64;case"uint64":return nt.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${bt}`)}}static tensorDimsFromProto(bt){return bt.map(wt=>tt.default.isLong(wt)?wt.toNumber():wt)}static tensorValueTypeFromProto(bt){return{tensorType:ct.tensorDataTypeFromProto(bt.elemType),shape:{dims:ct.tensorDimsFromProto(bt.shape.dim.map(wt=>wt.dimValue))}}}static tensorDimsFromORTFormat(bt){const wt=[];for(let Tt=0;Tt<bt.dimsLength();Tt++)wt.push(ot.longToNumber(bt.dims(Tt)));return wt}static tensorAttributesFromORTFormat(bt){const wt=[];for(let Tt=0;Tt<bt.attributesLength();Tt++)wt.push(bt.attributes(Tt));return wt}}a.ProtoUtil=ct;class ot{static longToNumber(bt,wt){return tt.default.isLong(bt)?bt.toNumber():bt instanceof d.flatbuffers.Long?tt.default.fromValue({low:bt.low,high:bt.high,unsigned:wt!=null&&wt}).toNumber():bt}static isLong(bt){return tt.default.isLong(bt)||bt instanceof d.flatbuffers.Long}}a.LongUtil=ot;class at{static size(bt){return at.getSizeFromDimensionRange(bt,0,bt.length)}static sizeFromDimension(bt,wt){if(wt<0||wt>bt.length)throw new Error(`invalid dimension of ${wt} for sizeFromDimension as Tensor has ${bt.length} dimensions.`);return at.getSizeFromDimensionRange(bt,wt,bt.length)}static sizeToDimension(bt,wt){if(wt<0||wt>bt.length)throw new Error(`invalid dimension of ${wt} for sizeToDimension as Tensor has ${bt.length} dimensions.`);return at.getSizeFromDimensionRange(bt,0,wt)}static getSizeFromDimensionRange(bt,wt,Tt){let Ct=1;for(let Dt=wt;Dt<Tt;Dt++){if(bt[Dt]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");Ct*=bt[Dt]}return Ct}static computeStrides(bt){const wt=bt.length;if(wt===0)return[];if(wt===1)return[1];const Tt=new Array(wt);Tt[wt-1]=1,Tt[wt-2]=bt[wt-1];for(let Ct=wt-3;Ct>=0;--Ct)Tt[Ct]=Tt[Ct+1]*bt[Ct+1];return Tt}static transpose(bt){return bt.slice().reverse()}static indicesToOffset(bt,wt,Tt){Tt===void 0&&(Tt=bt.length);let Ct=0;for(let Dt=0;Dt<Tt;++Dt)Ct+=wt[Dt]*bt[Dt];return Ct}static offsetToIndices(bt,wt){const Tt=wt.length;if(Tt===0)return[];if(Tt===1)return[bt*wt[0]];const Ct=new Array(wt.length);for(let Dt=0;Dt<Ct.length-1;++Dt)Ct[Dt]=Math.floor(bt/wt[Dt]),bt-=Ct[Dt]*wt[Dt];return Ct[Ct.length-1]=bt,Ct}static normalizeAxis(bt,wt){if(bt<-wt&&bt>=wt)throw new Error("unsupported axis for this operation.");return bt<0?bt+wt:bt}static normalizeAxes(bt,wt){return bt.map(Tt=>this.normalizeAxis(Tt,wt))}static incrementIndex(bt,wt,Tt){if(wt.length===0||bt.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(Tt===void 0)Tt=wt.length;else if(Tt<=0||Tt>wt.length)throw new Error("Incorrect axis to increment on");for(let Ct=Tt-1;Ct>=0&&(bt[Ct]++,!(bt[Ct]<wt[Ct]));--Ct)bt[Ct]=0}static calculateReshapedDims(bt,wt){if(wt.length===0){if(bt.length===0||at.size(bt)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}const Tt=wt.length,Ct=new Array(Tt);let Dt=-1,Ot=1;for(let Ft=0;Ft<Tt;Ft++){if(wt[Ft]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(wt[Ft]===-1){if(Dt!==-1)throw new Error("at most one dimension in shape hints can be -1");Dt=Ft}else{if(wt[Ft]===0){if(Ft>=bt.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");Ct[Ft]=bt[Ft]}else Ct[Ft]=wt[Ft];Ot*=Ct[Ft]}}const $t=at.size(bt);if(Dt!==-1){if($t%Ot!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${bt}] Output shape: [${wt}]`);Ct[Dt]=$t/Ot}else if(Ot!==$t)throw new Error("reshapedDims and originalDims don't have matching sizes");return Ct}static sortBasedOnPerm(bt,wt){return wt?wt.map(Tt=>bt[Tt]):bt.slice().reverse()}static padShape(bt,wt){const Tt=bt.length;return bt.map((Ct,Dt)=>Ct+wt[Dt]+wt[Dt+Tt])}static areEqual(bt,wt){return bt.length===wt.length&&bt.every((Tt,Ct)=>Tt===wt[Ct])}static validateDimsAndCalcSize(bt){if(bt.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let wt=1;for(const Tt of bt){if(!Number.isInteger(Tt))throw new TypeError(`Invalid shape: ${Tt} is not an integer`);if(Tt<0||Tt>2147483647)throw new TypeError(`Invalid shape: length ${Tt} is not allowed`);wt*=Tt}return wt}static flattenShape(bt,wt){wt<0&&(wt+=bt.length);const Tt=bt.reduce((Dt,Ot)=>Dt*Ot,1),Ct=bt.slice(wt).reduce((Dt,Ot)=>Dt*Ot,1);return[Tt/Ct,Ct]}static squeezeShape(bt,wt){const Tt=new Array;wt=at.normalizeAxes(wt,bt.length);for(let Ct=0;Ct<bt.length;Ct++){const Dt=wt.indexOf(Ct)>=0;if(Dt&&bt[Ct]!==1)throw new Error("squeeze an axis of size different than 1");(wt.length===0&&bt[Ct]>1||wt.length>0&&!Dt)&&Tt.push(bt[Ct])}return Tt}static unsqueezeShape(bt,wt){const Tt=new Array(bt.length+wt.length);Tt.fill(0);for(let Dt=0;Dt<wt.length;Dt++){const Ot=at.normalizeAxis(wt[Dt],Tt.length);if(Ot>=Tt.length)throw new Error("'axes' has an out of range axis");if(Tt[Ot]!==0)throw new Error("'axes' has a duplicate axis");Tt[Ot]=1}let Ct=0;for(let Dt=0;Dt<Tt.length;Dt++)Tt[Dt]===0&&(Tt[Dt]=bt[Ct++]);if(Ct!==bt.length)throw new Error("the unsqueezed dimension could not be established");return Tt}}a.ShapeUtil=at,a.MathUtil=class{static sqr(yt,bt,wt,Tt,Ct){if(Tt<0||Tt>=bt.length)throw new Error("sourceIndex out of bounds");if(wt<0||wt>=yt.length)throw new Error("targetIndex out of bounds");if(Tt+Ct>bt.length)throw new Error("source indices to be copied are outside bounds");if(wt+Ct>yt.length)throw new Error("target array is too small to hold result");for(let Dt=0;Dt<Ct;Dt++)yt[wt+Dt]+=Math.pow(bt[Tt+Dt],2)}static axpy(yt,bt,wt,Tt,Ct,Dt){if(Tt<0||Tt>=bt.length)throw new Error("sourceIndex out of bounds");if(wt<0||wt>=yt.length)throw new Error("targetIndex out of bounds");if(Tt+Ct>bt.length)throw new Error("source indices to be copied are outside bounds");if(wt+Ct>yt.length)throw new Error("target array is too small to hold result");for(let Ot=0;Ot<Ct;Ot++)yt[wt+Ot]+=Dt*bt[Tt+Ot]}static powx(yt,bt,wt,Tt,Ct,Dt){if(Tt<0||Tt>=bt.length)throw new Error("sourceIndex out of bounds");if(wt<0||wt>=yt.length)throw new Error("targetIndex out of bounds");if(Tt+Ct>bt.length)throw new Error("source indices to be copied are outside bounds");if(wt+Ct>yt.length)throw new Error("target array is too small to hold result");for(let Ot=0;Ot<Ct;Ot++)yt[wt+Ot]=Math.pow(bt[Tt+Ot],Dt)}static mul(yt,bt,wt,Tt,Ct){if(Tt<0||Tt>=bt.length)throw new Error("sourceIndex out of bounds");if(wt<0||wt>=yt.length)throw new Error("targetIndex out of bounds");if(Tt+Ct>bt.length)throw new Error("source indices to be copied are outside bounds");if(wt+Ct>yt.length)throw new Error("target array is too small to hold result");for(let Dt=0;Dt<Ct;Dt++)yt[wt+Dt]=bt[Tt+Dt]*yt[wt+Dt]}};class ht{static splitShape(bt,wt,Tt,Ct){if(Tt.length===0){if(!Ct)throw new Error("need to know number of outputs when the 'split' attribute is not specified");ht.determineSplit(bt[wt],Ct,Tt)}const Dt=[],Ot=[0];for(let $t=0;$t<Tt.length;++$t){$t!==0&&Ot.push(Ot[$t-1]+Tt[$t-1]);const Ft=bt.slice();Ft[wt]=Tt[$t],Dt.push(Ft)}return[Dt,Ot]}static determineSplit(bt,wt,Tt){if(bt%wt!=0)throw new Error("cannot split tensor to equal sized parts");for(let Ct=0;Ct<wt;++Ct)Tt.push(bt/wt)}}a.SplitUtil=ht;class ft{static calcReduce(bt,wt,Tt,Ct,Dt){const Ot=bt.dims.slice(0);wt.length===0&&Ot.forEach((Xt,Zt)=>wt.push(Zt));const $t=ft.calcReduceShape(Ot,wt,!0),Ft=at.size($t),kt=new it.Tensor($t,bt.type),Vt=at.computeStrides($t),Ht=at.computeStrides(Ot),Qt=new Array(Ot.length);for(let Xt=0;Xt<Ft;Xt++){const Zt=at.offsetToIndices(Xt,Vt);ut.fillIndex(Zt,Ot,Qt),kt.set(Zt,ft.calcReduceByAxis(bt.numberData,wt,Ot,0,at.indicesToOffset(Qt,Ht),Ct,Dt))}return Tt?kt:new it.Tensor(ft.calcReduceShape(Ot,wt,Tt),kt.type,void 0,void 0,kt.data,kt.dataId)}static calcReduceByAxis(bt,wt,Tt,Ct,Dt,Ot,$t){let Ft=0;if(Ct>=wt.length)return Ot(bt[Dt]);const kt=wt[Ct],Vt=kt>=Tt.length?1:at.size(Tt.slice(kt+1));for(let Ht=0;Ht<Tt[kt];Ht++)Ft=Ht===0?ft.calcReduceByAxis(bt,wt,Tt,Ct+1,Dt,Ot,$t):$t(Ft,ft.calcReduceByAxis(bt,wt,Tt,Ct+1,Dt,Ot,$t)),Dt+=Vt;return Ft}static calcReduceShape(bt,wt,Tt){const Ct=bt.slice();for(let Dt=0;Dt<wt.length;Dt++)Ct[wt[Dt]]=Tt?1:0;return Ct.filter(Dt=>Dt!==0)}}a.ReduceUtil=ft;class mt{static adjustPoolAttributes(bt,wt,Tt,Ct,Dt,Ot){if(!bt&&Tt.length!==wt.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(bt)for(let $t=0;$t<wt.length-2;$t++)$t>=Tt.length?Tt.push(wt[$t+2]):Tt[$t]=wt[$t+2];for(let $t=0;$t<Tt.length;$t++)if($t<Ct.length){if(Ct[$t]<0)throw new Error("strides should be greater than or equal to 1")}else Ct.push(1);for(let $t=0;$t<Tt.length;$t++)if($t<Dt.length){if(Dt[$t]<0)throw new Error("dilations should be greater than or equal to 1")}else Dt.push(1);for(let $t=0;$t<2*Tt.length;$t++)if($t<Ot.length){if(Ot[$t]<0)throw new Error("pad should be greater than or equal to 1")}else Ot.push(0);for(let $t=0;$t<Tt.length;$t++){if(Tt[$t]<=0)throw new Error("kernel shapes need to be greater than 0");if(Ot[$t]>=Tt[$t]||Ot[$t+Tt.length]>=Tt[$t])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(bt,wt,Tt,Ct,Dt,Ot){if(Ot){if(Dt.length!==2*(bt.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(wt.length!==bt.length-2)throw new Error("length of strides should be the length of data dimensions");if(Ct.length!==bt.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let $t=0;$t<bt.length-2;$t++)mt.adjustPadAndReturnShape(bt[$t+2],wt[$t],Tt[$t],Ct[$t],Dt,$t,$t+bt.length-2,Ot)}}static computePoolOutputShape(bt,wt,Tt,Ct,Dt,Ot,$t){if(wt.length<=0)throw new Error("input shape must be of size greater than 0");const Ft=[wt[0],wt[1]];return mt.computeShapeHelper(bt,wt,Ft,Tt,Ct,Dt,Ot,$t),Ft}static computeConvOutputShape(bt,wt,Tt,Ct,Dt,Ot,$t){if(bt.length<=0||wt.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const Ft=[bt[0],wt[0]];return mt.computeShapeHelper(!1,bt,Ft,Tt,Ct,Dt,Ot,$t),Ft}static computeShapeHelper(bt,wt,Tt,Ct,Dt,Ot,$t,Ft){if(bt)for(let kt=0;kt<wt.length-2;kt++)Tt.push(1);else for(let kt=0;kt<wt.length-2;kt++)Tt.push(mt.adjustPadAndReturnShape(wt[kt+2],Ct[kt],Dt[kt],Ot[kt],$t,kt,kt+wt.length-2,Ft))}static adjustPadAndReturnShape(bt,wt,Tt,Ct,Dt,Ot,$t,Ft){const kt=Tt*(Ct-1)+1;if(!Ft||Ft==="NOTSET")return Math.floor((bt+Dt[Ot]+Dt[$t]-kt)/wt+1);switch(Ft){case"VALID":return Dt[Ot]=0,Dt[$t]=0,Math.floor((bt-kt)/wt+1);case"SAME_LOWER":case"SAME_UPPER":if(Tt!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const Vt=((bt+wt-1)/wt-1)*wt+Ct-bt;return Dt[Ot]=Math.floor(Ft==="SAME_LOWER"?(Vt+1)/2:Vt/2),Dt[$t]=Vt-Dt[Ot],Math.floor((bt+Vt-Ct)/wt+1)}default:throw new Error("Unsupported AutoPad type")}}}a.PoolConvUtil=mt,a.MIN_CLIP=-34028234663852886e22,a.MAX_CLIP=34028234663852886e22,a.decodeUtf8String=function(yt){return new TextDecoder().decode(yt)}},7967:(s,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.iterateExtraOptions=void 0,a.iterateExtraOptions=(o,c,d,tt)=>{if(typeof o=="object"&&o!==null){if(d.has(o))throw new Error("Circular reference in options");d.add(o)}Object.entries(o).forEach(([nt,it])=>{const st=c?c+nt:nt;if(typeof it=="object")(0,a.iterateExtraOptions)(it,st+".",d,tt);else if(typeof it=="string"||typeof it=="number")tt(st,it.toString());else{if(typeof it!="boolean")throw new Error("Can't handle extra config type: "+typeof it);tt(st,it?"1":"0")}})}},2157:function(s,a,o){var c,d=this&&this.__createBinding||(Object.create?function(Vt,Ht,Qt,Xt){Xt===void 0&&(Xt=Qt);var Zt=Object.getOwnPropertyDescriptor(Ht,Qt);Zt&&!("get"in Zt?!Ht.__esModule:Zt.writable||Zt.configurable)||(Zt={enumerable:!0,get:function(){return Ht[Qt]}}),Object.defineProperty(Vt,Xt,Zt)}:function(Vt,Ht,Qt,Xt){Xt===void 0&&(Xt=Qt),Vt[Xt]=Ht[Qt]}),tt=this&&this.__setModuleDefault||(Object.create?function(Vt,Ht){Object.defineProperty(Vt,"default",{enumerable:!0,value:Ht})}:function(Vt,Ht){Vt.default=Ht}),nt=this&&this.__importStar||function(Vt){if(Vt&&Vt.__esModule)return Vt;var Ht={};if(Vt!=null)for(var Qt in Vt)Qt!=="default"&&Object.prototype.hasOwnProperty.call(Vt,Qt)&&d(Ht,Vt,Qt);return tt(Ht,Vt),Ht};Object.defineProperty(a,"__esModule",{value:!0}),a.endProfiling=a.run=a.releaseSession=a.createSession=a.createSessionFinalize=a.createSessionAllocate=a.initOrt=a.initWasm=void 0;const it=o(1670),st=nt(o(349)),ut=o(6361),ct=()=>!!it.env.wasm.proxy&&typeof document<"u";let ot,at,ht,ft=!1,mt=!1,yt=!1;const bt=[],wt=[],Tt=[],Ct=[],Dt=[],Ot=[],$t=()=>{if(ft||!mt||yt||!ot)throw new Error("worker not ready")},Ft=Vt=>{switch(Vt.data.type){case"init-wasm":ft=!1,Vt.data.err?(yt=!0,at[1](Vt.data.err)):(mt=!0,at[0]());break;case"init-ort":Vt.data.err?ht[1](Vt.data.err):ht[0]();break;case"create_allocate":Vt.data.err?bt.shift()[1](Vt.data.err):bt.shift()[0](Vt.data.out);break;case"create_finalize":Vt.data.err?wt.shift()[1](Vt.data.err):wt.shift()[0](Vt.data.out);break;case"create":Vt.data.err?Tt.shift()[1](Vt.data.err):Tt.shift()[0](Vt.data.out);break;case"release":Vt.data.err?Ct.shift()[1](Vt.data.err):Ct.shift()[0]();break;case"run":Vt.data.err?Dt.shift()[1](Vt.data.err):Dt.shift()[0](Vt.data.out);break;case"end-profiling":Vt.data.err?Ot.shift()[1](Vt.data.err):Ot.shift()[0]()}},kt=typeof document<"u"?(c=document?.currentScript)===null||c===void 0?void 0:c.src:void 0;a.initWasm=async()=>{if(ct()){if(mt)return;if(ft)throw new Error("multiple calls to 'initWasm()' detected.");if(yt)throw new Error("previous call to 'initWasm()' failed.");return ft=!0,it.env.wasm.wasmPaths===void 0&&kt&&kt.indexOf("blob:")!==0&&(it.env.wasm.wasmPaths=kt.substr(0,+kt.lastIndexOf("/")+1)),new Promise((Vt,Ht)=>{ot?.terminate(),ot=o(9710).Z(),ot.onmessage=Ft,at=[Vt,Ht];const Qt={type:"init-wasm",in:it.env.wasm};ot.postMessage(Qt)})}return(0,ut.initializeWebAssembly)(it.env.wasm)},a.initOrt=async(Vt,Ht)=>{if(ct())return $t(),new Promise((Qt,Xt)=>{ht=[Qt,Xt];const Zt={type:"init-ort",in:{numThreads:Vt,loggingLevel:Ht}};ot.postMessage(Zt)});st.initOrt(Vt,Ht)},a.createSessionAllocate=async Vt=>ct()?($t(),new Promise((Ht,Qt)=>{bt.push([Ht,Qt]);const Xt={type:"create_allocate",in:{model:Vt}};ot.postMessage(Xt,[Vt.buffer])})):st.createSessionAllocate(Vt),a.createSessionFinalize=async(Vt,Ht)=>ct()?($t(),new Promise((Qt,Xt)=>{wt.push([Qt,Xt]);const Zt={type:"create_finalize",in:{modeldata:Vt,options:Ht}};ot.postMessage(Zt)})):st.createSessionFinalize(Vt,Ht),a.createSession=async(Vt,Ht)=>ct()?($t(),new Promise((Qt,Xt)=>{Tt.push([Qt,Xt]);const Zt={type:"create",in:{model:Vt,options:Ht}};ot.postMessage(Zt,[Vt.buffer])})):st.createSession(Vt,Ht),a.releaseSession=async Vt=>{if(ct())return $t(),new Promise((Ht,Qt)=>{Ct.push([Ht,Qt]);const Xt={type:"release",in:Vt};ot.postMessage(Xt)});st.releaseSession(Vt)},a.run=async(Vt,Ht,Qt,Xt,Zt)=>ct()?($t(),new Promise((ar,nr)=>{Dt.push([ar,nr]);const cr={type:"run",in:{sessionId:Vt,inputIndices:Ht,inputs:Qt,outputIndices:Xt,options:Zt}};ot.postMessage(cr,st.extractTransferableBuffers(Qt))})):st.run(Vt,Ht,Qt,Xt,Zt),a.endProfiling=async Vt=>{if(ct())return $t(),new Promise((Ht,Qt)=>{Ot.push([Ht,Qt]);const Xt={type:"end-profiling",in:Vt};ot.postMessage(Xt)});st.endProfiling(Vt)}},586:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.setRunOptions=void 0;const c=o(7967),d=o(4983),tt=o(6361);a.setRunOptions=nt=>{const it=(0,tt.getInstance)();let st=0;const ut=[],ct=nt||{};try{if(nt?.logSeverityLevel===void 0)ct.logSeverityLevel=2;else if(typeof nt.logSeverityLevel!="number"||!Number.isInteger(nt.logSeverityLevel)||nt.logSeverityLevel<0||nt.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${nt.logSeverityLevel}`);if(nt?.logVerbosityLevel===void 0)ct.logVerbosityLevel=0;else if(typeof nt.logVerbosityLevel!="number"||!Number.isInteger(nt.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${nt.logVerbosityLevel}`);nt?.terminate===void 0&&(ct.terminate=!1);let ot=0;if(nt?.tag!==void 0&&(ot=(0,d.allocWasmString)(nt.tag,ut)),st=it._OrtCreateRunOptions(ct.logSeverityLevel,ct.logVerbosityLevel,!!ct.terminate,ot),st===0)throw new Error("Can't create run options");return nt?.extra!==void 0&&(0,c.iterateExtraOptions)(nt.extra,"",new WeakSet,(at,ht)=>{const ft=(0,d.allocWasmString)(at,ut),mt=(0,d.allocWasmString)(ht,ut);if(it._OrtAddRunConfigEntry(st,ft,mt)!==0)throw new Error(`Can't set a run config entry: ${at} - ${ht}`)}),[st,ut]}catch(ot){throw st!==0&&it._OrtReleaseRunOptions(st),ut.forEach(it._free),ot}}},2306:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OnnxruntimeWebAssemblySessionHandler=void 0;const c=o(2806),d=o(1670),tt=o(2850),nt=o(2157);let it;a.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(st){const ut=await fetch(st),ct=await ut.arrayBuffer();return(0,nt.createSessionAllocate)(new Uint8Array(ct))}async loadModel(st,ut){if(it||(await(0,nt.initOrt)(d.env.wasm.numThreads,(ct=>{switch(ct){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${ct}`)}})(d.env.logLevel)),it=!0),typeof st=="string")if(typeof fetch>"u"){const ct=await(0,tt.promisify)(c.readFile)(st);[this.sessionId,this.inputNames,this.outputNames]=await(0,nt.createSession)(ct,ut)}else{const ct=await this.createSessionAllocate(st);[this.sessionId,this.inputNames,this.outputNames]=await(0,nt.createSessionFinalize)(ct,ut)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,nt.createSession)(st,ut)}async dispose(){return(0,nt.releaseSession)(this.sessionId)}async run(st,ut,ct){const ot=[],at=[];Object.entries(st).forEach(yt=>{const bt=yt[0],wt=yt[1],Tt=this.inputNames.indexOf(bt);if(Tt===-1)throw new Error(`invalid input '${bt}'`);ot.push(wt),at.push(Tt)});const ht=[];Object.entries(ut).forEach(yt=>{const bt=yt[0],wt=this.outputNames.indexOf(bt);if(wt===-1)throw new Error(`invalid output '${bt}'`);ht.push(wt)});const ft=await(0,nt.run)(this.sessionId,at,ot.map(yt=>[yt.type,yt.dims,yt.data]),ht,ct),mt={};for(let yt=0;yt<ft.length;yt++)mt[this.outputNames[ht[yt]]]=new d.Tensor(ft[yt][0],ft[yt][2],ft[yt][1]);return mt}startProfiling(){}endProfiling(){(0,nt.endProfiling)(this.sessionId)}}},4919:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.setSessionOptions=void 0;const c=o(7967),d=o(4983),tt=o(6361);a.setSessionOptions=nt=>{const it=(0,tt.getInstance)();let st=0;const ut=[],ct=nt||{};(ot=>{ot.extra||(ot.extra={}),ot.extra.session||(ot.extra.session={});const at=ot.extra.session;at.use_ort_model_bytes_directly||(at.use_ort_model_bytes_directly="1")})(ct);try{nt?.graphOptimizationLevel===void 0&&(ct.graphOptimizationLevel="all");const ot=(ft=>{switch(ft){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${ft}`)}})(ct.graphOptimizationLevel);nt?.enableCpuMemArena===void 0&&(ct.enableCpuMemArena=!0),nt?.enableMemPattern===void 0&&(ct.enableMemPattern=!0),nt?.executionMode===void 0&&(ct.executionMode="sequential");const at=(ft=>{switch(ft){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${ft}`)}})(ct.executionMode);let ht=0;if(nt?.logId!==void 0&&(ht=(0,d.allocWasmString)(nt.logId,ut)),nt?.logSeverityLevel===void 0)ct.logSeverityLevel=2;else if(typeof nt.logSeverityLevel!="number"||!Number.isInteger(nt.logSeverityLevel)||nt.logSeverityLevel<0||nt.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${nt.logSeverityLevel}`);if(nt?.logVerbosityLevel===void 0)ct.logVerbosityLevel=0;else if(typeof nt.logVerbosityLevel!="number"||!Number.isInteger(nt.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${nt.logVerbosityLevel}`);if(nt?.enableProfiling===void 0&&(ct.enableProfiling=!1),st=it._OrtCreateSessionOptions(ot,!!ct.enableCpuMemArena,!!ct.enableMemPattern,at,!!ct.enableProfiling,0,ht,ct.logSeverityLevel,ct.logVerbosityLevel),st===0)throw new Error("Can't create session options");return nt?.executionProviders&&((ft,mt,yt)=>{for(const bt of mt){let wt=typeof bt=="string"?bt:bt.name;switch(wt){case"xnnpack":wt="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${wt}`)}const Tt=(0,d.allocWasmString)(wt,yt);if((0,tt.getInstance)()._OrtAppendExecutionProvider(ft,Tt)!==0)throw new Error(`Can't append execution provider: ${wt}`)}})(st,nt.executionProviders,ut),nt?.extra!==void 0&&(0,c.iterateExtraOptions)(nt.extra,"",new WeakSet,(ft,mt)=>{const yt=(0,d.allocWasmString)(ft,ut),bt=(0,d.allocWasmString)(mt,ut);if(it._OrtAddSessionConfigEntry(st,yt,bt)!==0)throw new Error(`Can't set a session config entry: ${ft} - ${mt}`)}),[st,ut]}catch(ot){throw st!==0&&it._OrtReleaseSessionOptions(st),ut.forEach(it._free),ot}}},4983:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.allocWasmString=void 0;const c=o(6361);a.allocWasmString=(d,tt)=>{const nt=(0,c.getInstance)(),it=nt.lengthBytesUTF8(d)+1,st=nt._malloc(it);return nt.stringToUTF8(d,st,it),tt.push(st),st}},349:(s,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.extractTransferableBuffers=a.endProfiling=a.run=a.releaseSession=a.createSession=a.createSessionFinalize=a.createSessionAllocate=a.initOrt=void 0;const c=o(586),d=o(4919),tt=o(4983),nt=o(6361);a.initOrt=(ot,at)=>{const ht=(0,nt.getInstance)()._OrtInit(ot,at);if(ht!==0)throw new Error(`Can't initialize onnxruntime. error code = ${ht}`)};const it=new Map;a.createSessionAllocate=ot=>{const at=(0,nt.getInstance)(),ht=at._malloc(ot.byteLength);return at.HEAPU8.set(ot,ht),[ht,ot.byteLength]},a.createSessionFinalize=(ot,at)=>{const ht=(0,nt.getInstance)();let ft=0,mt=0,yt=[];try{if([mt,yt]=(0,d.setSessionOptions)(at),ft=ht._OrtCreateSession(ot[0],ot[1],mt),ft===0)throw new Error("Can't create a session")}finally{ht._free(ot[0]),ht._OrtReleaseSessionOptions(mt),yt.forEach(ht._free)}const bt=ht._OrtGetInputCount(ft),wt=ht._OrtGetOutputCount(ft),Tt=[],Ct=[],Dt=[],Ot=[];for(let $t=0;$t<bt;$t++){const Ft=ht._OrtGetInputName(ft,$t);if(Ft===0)throw new Error("Can't get an input name");Ct.push(Ft),Tt.push(ht.UTF8ToString(Ft))}for(let $t=0;$t<wt;$t++){const Ft=ht._OrtGetOutputName(ft,$t);if(Ft===0)throw new Error("Can't get an output name");Ot.push(Ft),Dt.push(ht.UTF8ToString(Ft))}return it.set(ft,[ft,Ct,Ot]),[ft,Tt,Dt]},a.createSession=(ot,at)=>{const ht=(0,a.createSessionAllocate)(ot);return(0,a.createSessionFinalize)(ht,at)},a.releaseSession=ot=>{const at=(0,nt.getInstance)(),ht=it.get(ot);if(!ht)throw new Error("invalid session id");const ft=ht[0],mt=ht[1],yt=ht[2];mt.forEach(at._OrtFree),yt.forEach(at._OrtFree),at._OrtReleaseSession(ft),it.delete(ot)};const st=ot=>{switch(ot){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${ot}`)}},ut=ot=>{switch(ot){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${ot}`)}},ct=ot=>{switch(ot){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${ot}`)}};a.run=(ot,at,ht,ft,mt)=>{const yt=(0,nt.getInstance)(),bt=it.get(ot);if(!bt)throw new Error("invalid session id");const wt=bt[0],Tt=bt[1],Ct=bt[2],Dt=at.length,Ot=ft.length;let $t=0,Ft=[];const kt=[],Vt=[];try{[$t,Ft]=(0,c.setRunOptions)(mt);for(let nr=0;nr<Dt;nr++){const cr=ht[nr][0],dr=ht[nr][1],mr=ht[nr][2];let Dr,kr;if(Array.isArray(mr)){kr=4*mr.length,Dr=yt._malloc(kr),Vt.push(Dr);let Jr=Dr/4;for(let an=0;an<mr.length;an++){if(typeof mr[an]!="string")throw new TypeError(`tensor data at index ${an} is not a string`);yt.HEAPU32[Jr++]=(0,tt.allocWasmString)(mr[an],Vt)}}else kr=mr.byteLength,Dr=yt._malloc(kr),Vt.push(Dr),yt.HEAPU8.set(new Uint8Array(mr.buffer,mr.byteOffset,kr),Dr);const Yr=yt.stackSave(),Mr=yt.stackAlloc(4*dr.length);try{let Jr=Mr/4;dr.forEach(xn=>yt.HEAP32[Jr++]=xn);const an=yt._OrtCreateTensor(st(cr),Dr,kr,Mr,dr.length);if(an===0)throw new Error("Can't create a tensor");kt.push(an)}finally{yt.stackRestore(Yr)}}const Ht=yt.stackSave(),Qt=yt.stackAlloc(4*Dt),Xt=yt.stackAlloc(4*Dt),Zt=yt.stackAlloc(4*Ot),ar=yt.stackAlloc(4*Ot);try{let nr=Qt/4,cr=Xt/4,dr=Zt/4,mr=ar/4;for(let Yr=0;Yr<Dt;Yr++)yt.HEAPU32[nr++]=kt[Yr],yt.HEAPU32[cr++]=Tt[at[Yr]];for(let Yr=0;Yr<Ot;Yr++)yt.HEAPU32[dr++]=0,yt.HEAPU32[mr++]=Ct[ft[Yr]];let Dr=yt._OrtRun(wt,Xt,Qt,Dt,ar,Ot,Zt,$t);const kr=[];if(Dr===0)for(let Yr=0;Yr<Ot;Yr++){const Mr=yt.HEAPU32[Zt/4+Yr],Jr=yt.stackSave(),an=yt.stackAlloc(16);let xn,Rn=0;try{if(Dr=yt._OrtGetTensorData(Mr,an,an+4,an+8,an+12),Dr!==0)throw new Error(`Can't access output tensor data. error code = ${Dr}`);let hn=an/4;const pn=yt.HEAPU32[hn++];Rn=yt.HEAPU32[hn++];const yn=yt.HEAPU32[hn++],un=yt.HEAPU32[hn++],fn=[];for(let Dn=0;Dn<un;Dn++)fn.push(yt.HEAPU32[yn/4+Dn]);yt._OrtFree(yn);const Bn=fn.length===0?1:fn.reduce((Dn,Qn)=>Dn*Qn);if(xn=ut(pn),xn==="string"){const Dn=[];let Qn=Rn/4;for(let zr=0;zr<Bn;zr++){const ao=yt.HEAPU32[Qn++],oo=zr===Bn-1?void 0:yt.HEAPU32[Qn]-ao;Dn.push(yt.UTF8ToString(ao,oo))}kr.push([xn,fn,Dn])}else{const Dn=new(ct(xn))(Bn);new Uint8Array(Dn.buffer,Dn.byteOffset,Dn.byteLength).set(yt.HEAPU8.subarray(Rn,Rn+Dn.byteLength)),kr.push([xn,fn,Dn])}}finally{yt.stackRestore(Jr),xn==="string"&&Rn&&yt._free(Rn),yt._OrtReleaseTensor(Mr)}}if(Dr===0)return kr;throw new Error(`failed to call OrtRun(). error code = ${Dr}.`)}finally{yt.stackRestore(Ht)}}finally{kt.forEach(yt._OrtReleaseTensor),Vt.forEach(yt._free),yt._OrtReleaseRunOptions($t),Ft.forEach(yt._free)}},a.endProfiling=ot=>{const at=(0,nt.getInstance)(),ht=it.get(ot);if(!ht)throw new Error("invalid session id");const ft=ht[0],mt=at._OrtEndProfiling(ft);if(mt===0)throw new Error("Can't get an profile file name");at._OrtFree(mt)},a.extractTransferableBuffers=ot=>{const at=[];for(const ht of ot){const ft=ht[2];!Array.isArray(ft)&&ft.buffer&&at.push(ft.buffer)}return at}},6361:function(s,a,o){var c=this&&this.__createBinding||(Object.create?function(mt,yt,bt,wt){wt===void 0&&(wt=bt);var Tt=Object.getOwnPropertyDescriptor(yt,bt);Tt&&!("get"in Tt?!yt.__esModule:Tt.writable||Tt.configurable)||(Tt={enumerable:!0,get:function(){return yt[bt]}}),Object.defineProperty(mt,wt,Tt)}:function(mt,yt,bt,wt){wt===void 0&&(wt=bt),mt[wt]=yt[bt]}),d=this&&this.__setModuleDefault||(Object.create?function(mt,yt){Object.defineProperty(mt,"default",{enumerable:!0,value:yt})}:function(mt,yt){mt.default=yt}),tt=this&&this.__importStar||function(mt){if(mt&&mt.__esModule)return mt;var yt={};if(mt!=null)for(var bt in mt)bt!=="default"&&Object.prototype.hasOwnProperty.call(mt,bt)&&c(yt,mt,bt);return d(yt,mt),yt},nt=this&&this.__importDefault||function(mt){return mt&&mt.__esModule?mt:{default:mt}};Object.defineProperty(a,"__esModule",{value:!0}),a.dispose=a.getInstance=a.initializeWebAssembly=void 0;const it=tt(o(6449)),st=nt(o(932)),ut=o(3474);let ct,ot=!1,at=!1,ht=!1;const ft=(mt,yt)=>yt?mt?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":mt?"ort-wasm-simd.wasm":"ort-wasm.wasm";a.initializeWebAssembly=async mt=>{if(ot)return Promise.resolve();if(at)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(ht)throw new Error("previous call to 'initializeWebAssembly()' failed.");at=!0;const yt=mt.initTimeout,bt=mt.numThreads,wt=mt.simd,Tt=bt>1&&(()=>{try{return typeof SharedArrayBuffer<"u"&&(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}})(),Ct=wt&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})(),Dt=typeof mt.wasmPaths=="string"?mt.wasmPaths:void 0,Ot=ft(!1,Tt),$t=ft(Ct,Tt),Ft=typeof mt.wasmPaths=="object"?mt.wasmPaths[$t]:void 0;let kt=!1;const Vt=[];if(yt>0&&Vt.push(new Promise(Ht=>{setTimeout(()=>{kt=!0,Ht()},yt)})),Vt.push(new Promise((Ht,Qt)=>{const Xt=Tt?ut:st.default,Zt={locateFile:(ar,nr)=>Tt&&ar.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([o(4154)],{type:"text/javascript"})):ar===Ot?Ft??(Dt??nr)+$t:nr+ar};if(Tt)if(typeof Blob>"u")Zt.mainScriptUrlOrBlob=it.join("/","ort-wasm-threaded.js");else{const ar=`var ortWasmThreaded=(function(){var _scriptDir;return ${Xt.toString()}})();`;Zt.mainScriptUrlOrBlob=new Blob([ar],{type:"text/javascript"})}Xt(Zt).then(ar=>{at=!1,ot=!0,ct=ar,Ht()},ar=>{at=!1,ht=!0,Qt(ar)})})),await Promise.race(Vt),kt)throw new Error(`WebAssembly backend initializing failed due to timeout: ${yt}ms`)},a.getInstance=()=>{if(ot&&ct)return ct;throw new Error("WebAssembly is not initialized yet.")},a.dispose=()=>{var mt;!ot||at||ht||(at=!0,(mt=ct.PThread)===null||mt===void 0||mt.terminateAllThreads(),ct=void 0,at=!1,ot=!1,ht=!0)}},9710:(s,a,o)=>{o.d(a,{Z:()=>tt});var c=o(477),d=o.n(c);function tt(){return d()('/*!\n* ONNX Runtime Web v1.14.0\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var t={474:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){function e(){return j.buffer!=D&&N(j.buffer),P}function r(){return j.buffer!=D&&N(j.buffer),U}function a(){return j.buffer!=D&&N(j.buffer),F}function i(){return j.buffer!=D&&N(j.buffer),I}function o(){return j.buffer!=D&&N(j.buffer),W}var u,c,s;t=t||{},u||(u=void 0!==t?t:{}),u.ready=new Promise((function(t,e){c=t,s=e}));var l,f,p,h,d,y,b=Object.assign({},u),m="./this.program",g=(t,e)=>{throw e},v="object"==typeof window,w="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O=u.ENVIRONMENT_IS_PTHREAD||!1,A="";function S(t){return u.locateFile?u.locateFile(t,A):A+t}if(_){let e;A=w?n(908).dirname(A)+"/":"//",y=()=>{d||(h=n(384),d=n(908))},l=function(t,e){return y(),t=d.normalize(t),h.readFileSync(t,e?void 0:"utf8")},p=t=>((t=l(t,!0)).buffer||(t=new Uint8Array(t)),t),f=(t,e,n)=>{y(),t=d.normalize(t),h.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(m=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof ct))throw t})),process.on("unhandledRejection",(function(t){throw t})),g=(t,e)=>{if(Q())throw process.exitCode=t,e;e instanceof ct||x("exiting due to exception: "+e),process.exit(t)},u.inspect=function(){return"[Emscripten Module object]"};try{e=n(925)}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}n.g.Worker=e.Worker}else(v||w)&&(w?A=self.location.href:"undefined"!=typeof document&&document.currentScript&&(A=document.currentScript.src),_scriptDir&&(A=_scriptDir),A=0!==A.indexOf("blob:")?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"",_||(l=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},w&&(p=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),f=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)}));_&&"undefined"==typeof performance&&(n.g.performance=n(953).performance);var T=console.log.bind(console),E=console.warn.bind(console);_&&(y(),T=t=>h.writeSync(1,t+"\\n"),E=t=>h.writeSync(2,t+"\\n"));var M,C=u.print||T,x=u.printErr||E;Object.assign(u,b),b=null,u.thisProgram&&(m=u.thisProgram),u.quit&&(g=u.quit),u.wasmBinary&&(M=u.wasmBinary);var R=u.noExitRuntime||!1;"object"!=typeof WebAssembly&&at("no native wasm support detected");var j,k,D,P,U,F,I,W,H=!1,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function z(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&L)return L.decode(t.buffer instanceof SharedArrayBuffer?t.slice(e,n):t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function Y(t,e){return(t>>>=0)?z(r(),t,e):""}function B(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function G(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function N(t){D=t,u.HEAP8=P=new Int8Array(t),u.HEAP16=new Int16Array(t),u.HEAP32=F=new Int32Array(t),u.HEAPU8=U=new Uint8Array(t),u.HEAPU16=new Uint16Array(t),u.HEAPU32=I=new Uint32Array(t),u.HEAPF32=new Float32Array(t),u.HEAPF64=W=new Float64Array(t)}O&&(D=u.buffer);var V=u.INITIAL_MEMORY||16777216;if(O)j=u.wasmMemory,D=u.buffer;else if(u.wasmMemory)j=u.wasmMemory;else if(!((j=new WebAssembly.Memory({initial:V/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw x("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),_&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");j&&(D=j.buffer),V=D.byteLength,N(D);var $,q=[],X=[],J=[],Z=[];function Q(){return R||!1}function K(){var t=u.preRun.shift();q.unshift(t)}var tt,et=0,nt=null,rt=null;function at(t){throw O?postMessage({cmd:"onAbort",arg:t}):u.onAbort&&u.onAbort(t),x(t="Aborted("+t+")"),H=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),s(t),t}function it(){return tt.startsWith("data:application/octet-stream;base64,")}function ot(){var t=tt;try{if(t==tt&&M)return new Uint8Array(M);if(p)return p(t);throw"both async and sync fetching of the wasm failed"}catch(t){at(t)}}tt="ort-wasm-threaded.wasm",it()||(tt=S(tt));var ut={};function ct(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function st(t){(t=ht.Vb[t])||at(),ht.mc(t)}function lt(t){var e=ht.Cc();if(!e)return 6;ht.ac.push(e),ht.Vb[t.Ub]=e,e.Ub=t.Ub;var n={cmd:"run",start_routine:t.Ic,arg:t.zc,pthread_ptr:t.Ub};return e.$b=()=>{n.time=performance.now(),e.postMessage(n,t.Nc)},e.loaded&&(e.$b(),delete e.$b),0}function ft(t){if(O)return $t(1,1,t);Q()||(ht.oc(),u.onExit&&u.onExit(t),H=!0),g(t,new ct(t))}function pt(t,e){if(!e&&O)throw bt(t),"unwind";Q()||O||(me(),dt(J),be(0),re[1].length&&ae(1,10),re[2].length&&ae(2,10),ht.oc()),ft(t)}var ht={Yb:[],ac:[],qc:[],Vb:{},fc:function(){O&&ht.Ec()},Pc:function(){},Ec:function(){ht.receiveObjectTransfer=ht.Gc,ht.threadInitTLS=ht.pc,ht.setExitStatus=ht.nc,R=!1},nc:function(){},oc:function(){for(var t of Object.values(ht.Vb))ht.mc(t);for(t of ht.Yb)t.terminate();ht.Yb=[]},mc:function(t){var e=t.Ub;delete ht.Vb[e],ht.Yb.push(t),ht.ac.splice(ht.ac.indexOf(t),1),t.Ub=0,Oe(e)},Gc:function(){},pc:function(){ht.qc.forEach((t=>t()))},Fc:function(t,e){t.onmessage=n=>{var r=(n=n.data).cmd;if(t.Ub&&(ht.Bc=t.Ub),n.targetThread&&n.targetThread!=he()){var a=ht.Vb[n.Qc];a?a.postMessage(n,n.transferList):x(\'Internal error! Worker sent a message "\'+r+\'" to target pthread \'+n.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===r?zt(n.queue):"spawnThread"===r?lt(n):"cleanupThread"===r?st(n.thread):"killThread"===r?(n=n.thread,r=ht.Vb[n],delete ht.Vb[n],r.terminate(),Oe(n),ht.ac.splice(ht.ac.indexOf(r),1),r.Ub=0):"cancelThread"===r?ht.Vb[n.thread].postMessage({cmd:"cancel"}):"loaded"===r?(t.loaded=!0,e&&e(t),t.$b&&(t.$b(),delete t.$b)):"print"===r?C("Thread "+n.threadId+": "+n.text):"printErr"===r?x("Thread "+n.threadId+": "+n.text):"alert"===r?alert("Thread "+n.threadId+": "+n.text):"setimmediate"===n.target?t.postMessage(n):"onAbort"===r?u.onAbort&&u.onAbort(n.arg):r&&x("worker sent an unknown command "+r);ht.Bc=void 0},t.onerror=t=>{throw x("worker sent an error! "+t.filename+":"+t.lineno+": "+t.message),t},_&&(t.on("message",(function(e){t.onmessage({data:e})})),t.on("error",(function(e){t.onerror(e)})),t.on("detachedExit",(function(){}))),t.postMessage({cmd:"load",urlOrBlob:u.mainScriptUrlOrBlob||_scriptDir,wasmMemory:j,wasmModule:k})},yc:function(){var t=S("ort-wasm-threaded.worker.js");ht.Yb.push(new Worker(t))},Cc:function(){return 0==ht.Yb.length&&(ht.yc(),ht.Fc(ht.Yb[0])),ht.Yb.pop()}};function dt(t){for(;0<t.length;)t.shift()(u)}function yt(t){var e=Ee();return t=t(),Me(e),t}function bt(t){if(O)return $t(2,0,t);try{pt(t)}catch(t){t instanceof ct||"unwind"==t||g(1,t)}}u.PThread=ht,u.establishStackSpace=function(){var t=he(),e=a()[t+44>>2>>>0];t=a()[t+48>>2>>>0],Te(e,e-t),Me(e)};var mt=[];function gt(t){var e=mt[t];return e||(t>=mt.length&&(mt.length=t+1),mt[t]=e=$.get(t)),e}u.invokeEntryPoint=function(t,e){t=gt(t)(e),Q()?ht.nc(t):Ae(t)};var vt,wt,_t=[],Ot=0,At=0;function St(t){this.Zb=t,this.Sb=t-24,this.xc=function(t){i()[this.Sb+4>>2>>>0]=t},this.bc=function(){return i()[this.Sb+4>>2>>>0]},this.wc=function(t){i()[this.Sb+8>>2>>>0]=t},this.Dc=function(){return i()[this.Sb+8>>2>>>0]},this.rc=function(){a()[this.Sb>>2>>>0]=0},this.hc=function(t){t=t?1:0,e()[this.Sb+12>>0>>>0]=t},this.uc=function(){return 0!=e()[this.Sb+12>>0>>>0]},this.ic=function(t){t=t?1:0,e()[this.Sb+13>>0>>>0]=t},this.kc=function(){return 0!=e()[this.Sb+13>>0>>>0]},this.fc=function(t,e){this.cc(0),this.xc(t),this.wc(e),this.rc(),this.hc(!1),this.ic(!1)},this.sc=function(){Atomics.add(a(),this.Sb>>2,1)},this.Hc=function(){return 1===Atomics.sub(a(),this.Sb>>2,1)},this.cc=function(t){i()[this.Sb+16>>2>>>0]=t},this.tc=function(){return i()[this.Sb+16>>2>>>0]},this.vc=function(){if(Re(this.bc()))return i()[this.Zb>>2>>>0];var t=this.tc();return 0!==t?t:this.Zb}}function Tt(t){return ye(new St(t).Sb)}function Et(t,e,n,r){return O?$t(3,1,t,e,n,r):Mt(t,e,n,r)}function Mt(t,e,n,r){if("undefined"==typeof SharedArrayBuffer)return x("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return O&&0===a.length?Et(t,e,n,r):(t={Ic:n,Ub:t,zc:r,Nc:a},O?(t.Oc="spawnThread",postMessage(t,a),0):lt(t))}function Ct(t,e,n){return O?$t(4,1,t,e,n):0}function xt(t,e){if(O)return $t(5,1,t,e)}function Rt(t,e){if(O)return $t(6,1,t,e)}function jt(t,e,n){if(O)return $t(7,1,t,e,n)}function kt(t,e,n){return O?$t(8,1,t,e,n):0}function Dt(t,e){if(O)return $t(9,1,t,e)}function Pt(t,e,n){if(O)return $t(10,1,t,e,n)}function Ut(t,e,n,r){if(O)return $t(11,1,t,e,n,r)}function Ft(t,e,n,r){if(O)return $t(12,1,t,e,n,r)}function It(t,e,n,r){if(O)return $t(13,1,t,e,n,r)}function Wt(t){if(O)return $t(14,1,t)}function Ht(t,e){if(O)return $t(15,1,t,e)}function Lt(t,e,n){if(O)return $t(16,1,t,e,n)}function zt(t){Atomics.store(a(),t>>2,1),he()&&_e(t),Atomics.compareExchange(a(),t>>2,1,0)}function Yt(t){return i()[t>>>2]+4294967296*a()[t+4>>>2]}function Bt(t,e,n,r,a,i){return O?$t(17,1,t,e,n,r,a,i):-52}function Gt(t,e,n,r,a,i){if(O)return $t(18,1,t,e,n,r,a,i)}function Nt(t){var n=G(t)+1,r=de(n);return r&&B(t,e(),r,n),r}function Vt(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}if(O)return $t(19,1,t,e,n);var o=(new Date).getFullYear(),u=new Date(o,0,1),c=new Date(o,6,1);o=u.getTimezoneOffset();var s=c.getTimezoneOffset(),l=Math.max(o,s);a()[t>>2>>>0]=60*l,a()[e>>2>>>0]=Number(o!=s),t=r(u),e=r(c),t=Nt(t),e=Nt(e),s<o?(i()[n>>2>>>0]=t,i()[n+4>>2>>>0]=e):(i()[n>>2>>>0]=e,i()[n+4>>2>>>0]=t)}function $t(t,e){var n=arguments.length-2,r=arguments;return yt((()=>{for(var a=Ce(8*n),i=a>>3,u=0;u<n;u++){var c=r[2+u];o()[i+u>>>0]=c}return we(t,n,a,e)}))}u.executeNotifiedProxyingQueue=zt,wt=_?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:O?()=>performance.now()-u.__performance_now_clock_drift:()=>performance.now();var qt,Xt=[],Jt={};function Zt(){if(!qt){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:m||"./this.program"};for(t in Jt)void 0===Jt[t]?delete e[t]:e[t]=Jt[t];var n=[];for(t in e)n.push(t+"="+e[t]);qt=n}return qt}function Qt(t,n){if(O)return $t(20,1,t,n);var r=0;return Zt().forEach((function(a,o){var u=n+r;for(o=i()[t+4*o>>2>>>0]=u,u=0;u<a.length;++u)e()[o++>>0>>>0]=a.charCodeAt(u);e()[o>>0>>>0]=0,r+=a.length+1})),0}function Kt(t,e){if(O)return $t(21,1,t,e);var n=Zt();i()[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),i()[e>>2>>>0]=r,0}function te(t){return O?$t(22,1,t):52}function ee(t,e,n,r){return O?$t(23,1,t,e,n,r):52}function ne(t,e,n,r,a){return O?$t(24,1,t,e,n,r,a):70}var re=[null,[],[]];function ae(t,e){var n=re[t];0===e||10===e?((1===t?C:x)(z(n,0)),n.length=0):n.push(e)}function ie(t,e,n,a){if(O)return $t(25,1,t,e,n,a);for(var o=0,u=0;u<n;u++){var c=i()[e>>2>>>0],s=i()[e+4>>2>>>0];e+=8;for(var l=0;l<s;l++)ae(t,r()[c+l>>>0]);o+=s}return i()[a>>2>>>0]=o,0}var oe=0;function ue(t){return 0==t%4&&(0!=t%100||0==t%400)}var ce=[31,29,31,30,31,30,31,31,30,31,30,31],se=[31,28,31,30,31,30,31,31,30,31,30,31];function le(t,n,r,i){function o(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function u(t,e){return o(t,e,"0")}function c(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function s(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function l(t){var e=t.Wb;for(t=new Date(new Date(t.Xb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(ue(t.getFullYear())?ce:se)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=s(new Date(t.getFullYear(),0,4)),n=s(n),0>=c(e,t)?0>=c(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f=a()[i+40>>2>>>0];for(var p in i={Lc:a()[i>>2>>>0],Kc:a()[i+4>>2>>>0],dc:a()[i+8>>2>>>0],jc:a()[i+12>>2>>>0],ec:a()[i+16>>2>>>0],Xb:a()[i+20>>2>>>0],Tb:a()[i+24>>2>>>0],Wb:a()[i+28>>2>>>0],Rc:a()[i+32>>2>>>0],Jc:a()[i+36>>2>>>0],Mc:f?Y(f):""},r=Y(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(p,"g"),f[p]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(p in f={"%a":function(t){return h[t.Tb].substring(0,3)},"%A":function(t){return h[t.Tb]},"%b":function(t){return d[t.ec].substring(0,3)},"%B":function(t){return d[t.ec]},"%C":function(t){return u((t.Xb+1900)/100|0,2)},"%d":function(t){return u(t.jc,2)},"%e":function(t){return o(t.jc,2," ")},"%g":function(t){return l(t).toString().substring(2)},"%G":function(t){return l(t)},"%H":function(t){return u(t.dc,2)},"%I":function(t){return 0==(t=t.dc)?t=12:12<t&&(t-=12),u(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.ec-1;e+=(ue(t.Xb+1900)?ce:se)[n++]);return u(t.jc+e,3)},"%m":function(t){return u(t.ec+1,2)},"%M":function(t){return u(t.Kc,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.dc&&12>t.dc?"AM":"PM"},"%S":function(t){return u(t.Lc,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Tb||7},"%U":function(t){return u(Math.floor((t.Wb+7-t.Tb)/7),2)},"%V":function(t){var e=Math.floor((t.Wb+7-(t.Tb+6)%7)/7);if(2>=(t.Tb+371-t.Wb-2)%7&&e++,e)53==e&&(4==(n=(t.Tb+371-t.Wb)%7)||3==n&&ue(t.Xb)||(e=1));else{e=52;var n=(t.Tb+7-t.Wb-1)%7;(4==n||5==n&&ue(t.Xb%400-1))&&e++}return u(e,2)},"%w":function(t){return t.Tb},"%W":function(t){return u(Math.floor((t.Wb+7-(t.Tb+6)%7)/7),2)},"%y":function(t){return(t.Xb+1900).toString().substring(2)},"%Y":function(t){return t.Xb+1900},"%z":function(t){var e=0<=(t=t.Jc);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.Mc},"%%":function(){return"%"}},r=r.replace(/%%/g,"\\0\\0"),f)r.includes(p)&&(r=r.replace(new RegExp(p,"g"),f[p](i)));return p=function(t){var e=Array(G(t)+1);return B(t,e,0,e.length),e}(r=r.replace(/\\0\\0/g,"%")),p.length>n?0:(function(t,n){e().set(t,n>>>0)}(p,t),p.length-1)}ht.fc();var fe=[null,ft,bt,Et,Ct,xt,Rt,jt,kt,Dt,Pt,Ut,Ft,It,Wt,Ht,Lt,Bt,Gt,Vt,Qt,Kt,te,ee,ne,ie],pe={b:function(t){return de(t+24)+24},n:function(t){return(t=new St(t)).uc()||(t.hc(!0),Ot--),t.ic(!1),_t.push(t),t.sc(),t.vc()},ma:function(t){throw x("Unexpected exception thrown, this is not properly supported - aborting"),H=!0,t},x:function(){Se(0);var t=_t.pop();if(t.Hc()&&!t.kc()){var e=t.Dc();e&&gt(e)(t.Zb),Tt(t.Zb)}At=0},e:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},l:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},h:function(){var t=At;if(!t)return oe=0;var e=new St(t);e.cc(t);var n=e.bc();if(!n)return oe=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(xe(i,n,e.Sb+16))return oe=i,t}return oe=n,t},t:Tt,M:function(){var t=_t.pop();t||at("no exception to throw");var e=t.Zb;throw t.kc()||(_t.push(t),t.ic(!0),t.hc(!1),Ot++),At=e,e},c:function(t,e,n){throw new St(t).fc(e,n),At=t,Ot++,t},pa:function(){return Ot},Fa:function(t){ge(t,!w,1,!v),ht.pc()},T:function(t){O?postMessage({cmd:"cleanupThread",thread:t}):st(t)},xa:Mt,j:function(t){throw At||(At=t),t},H:Ct,Ma:xt,ua:Rt,wa:jt,oa:kt,Ka:Dt,Ca:Pt,Ja:Ut,V:Ft,va:It,sa:Wt,La:Ht,ta:Lt,Ta:function(){},X:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ua:function(){at("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},W:function(){return Date.now()},ya:function(){return 2097152},Oa:function(){return!0},za:function(t,e,n,r){if(t==e)setTimeout((()=>zt(r)));else if(O)postMessage({targetThread:t,cmd:"processProxyingQueue",queue:r});else{if(!(t=ht.Vb[t]))return;t.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},Ea:function(){return-1},Pa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getUTCSeconds(),a()[e+4>>2>>>0]=t.getUTCMinutes(),a()[e+8>>2>>>0]=t.getUTCHours(),a()[e+12>>2>>>0]=t.getUTCDate(),a()[e+16>>2>>>0]=t.getUTCMonth(),a()[e+20>>2>>>0]=t.getUTCFullYear()-1900,a()[e+24>>2>>>0]=t.getUTCDay(),t=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[e+28>>2>>>0]=t},Qa:function(t,e){t=new Date(1e3*Yt(t)),a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),a()[e+20>>2>>>0]=t.getFullYear()-1900,a()[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1),r=(t.getTime()-n.getTime())/864e5|0;a()[e+28>>2>>>0]=r,a()[e+36>>2>>>0]=-60*t.getTimezoneOffset(),r=new Date(t.getFullYear(),6,1).getTimezoneOffset(),t=0|(r!=(n=n.getTimezoneOffset())&&t.getTimezoneOffset()==Math.min(n,r)),a()[e+32>>2>>>0]=t},Ra:function(t){var e=new Date(a()[t+20>>2>>>0]+1900,a()[t+16>>2>>>0],a()[t+12>>2>>>0],a()[t+8>>2>>>0],a()[t+4>>2>>>0],a()[t>>2>>>0],0),n=a()[t+32>>2>>>0],r=e.getTimezoneOffset(),i=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),6,1).getTimezoneOffset(),u=i.getTimezoneOffset(),c=Math.min(u,o);return 0>n?a()[t+32>>2>>>0]=Number(o!=u&&c==r):0<n!=(c==r)&&(o=Math.max(u,o),e.setTime(e.getTime()+6e4*((0<n?c:o)-r))),a()[t+24>>2>>>0]=e.getDay(),n=(e.getTime()-i.getTime())/864e5|0,a()[t+28>>2>>>0]=n,a()[t>>2>>>0]=e.getSeconds(),a()[t+4>>2>>>0]=e.getMinutes(),a()[t+8>>2>>>0]=e.getHours(),a()[t+12>>2>>>0]=e.getDate(),a()[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},Aa:Bt,Ba:Gt,Sa:function t(e,n,r){t.Ac||(t.Ac=!0,Vt(e,n,r))},y:function(){at("")},U:function(){if(!_&&!w){var t="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";vt||(vt={}),vt[t]||(vt[t]=1,_&&(t="warning: "+t),x(t))}},ra:function(){return 4294901760},B:wt,Ia:function(t,e,n){r().copyWithin(t>>>0,e>>>0,e+n>>>0)},F:function(){return _?n(993).cpus().length:navigator.hardwareConcurrency},Da:function(t,e,n){Xt.length=e,n>>=3;for(var r=0;r<e;r++)Xt[r]=o()[n+r>>>0];return(0>t?ut[-t-1]:fe[t]).apply(null,Xt)},qa:function(t){var e=r().length;if((t>>>=0)<=e||4294901760<t)return!1;for(var n=1;4>=n;n*=2){var a=e*(1+.2/n);a=Math.min(a,t+100663296);var i=Math;a=Math.max(t,a),i=i.min.call(i,4294901760,a+(65536-a%65536)%65536);t:{try{j.grow(i-D.byteLength+65535>>>16),N(j.buffer);var o=1;break t}catch(t){}o=void 0}if(o)return!0}return!1},Na:function(){throw"unwind"},Ga:Qt,Ha:Kt,J:pt,I:te,S:ee,ga:ne,R:ie,d:function(){return oe},na:function t(r,a){t.lc||(t.lc=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(_)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>at("randomDevice")}());for(var i=0;i<a;i++)e()[r+i>>0>>>0]=t.lc();return 0},ia:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ja:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},K:function(t){var e=Ee();try{return gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},f:function(t,e){var n=Ee();try{return gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},P:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},Q:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},k:function(t,e,n){var r=Ee();try{return gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},p:function(t,e,n,r){var a=Ee();try{return gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},q:function(t,e,n,r,a){var i=Ee();try{return gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},N:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},s:function(t,e,n,r,a,i){var o=Ee();try{return gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},w:function(t,e,n,r,a,i,o){var u=Ee();try{return gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},L:function(t,e,n,r,a,i,o,u){var c=Ee();try{return gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},E:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{return gt(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=Ee();try{return He(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},_:function(t,e,n,r,a,i,o){var u=Ee();try{return ke(t,e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},Z:function(t,e,n,r,a){var i=Ee();try{return Le(t,e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},ca:function(t,e,n,r){var a=Ee();try{return Ie(t,e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},$:function(t){var e=Ee();try{return je(t)}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},ba:function(t,e){var n=Ee();try{return We(t,e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},Y:function(t,e,n){var r=Ee();try{return De(t,e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},g:function(t){var e=Ee();try{gt(t)()}catch(t){if(Me(e),t!==t+0)throw t;Se(1,0)}},r:function(t,e){var n=Ee();try{gt(t)(e)}catch(t){if(Me(n),t!==t+0)throw t;Se(1,0)}},i:function(t,e,n){var r=Ee();try{gt(t)(e,n)}catch(t){if(Me(r),t!==t+0)throw t;Se(1,0)}},ha:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},m:function(t,e,n,r){var a=Ee();try{gt(t)(e,n,r)}catch(t){if(Me(a),t!==t+0)throw t;Se(1,0)}},v:function(t,e,n,r,a){var i=Ee();try{gt(t)(e,n,r,a)}catch(t){if(Me(i),t!==t+0)throw t;Se(1,0)}},u:function(t,e,n,r,a,i){var o=Ee();try{gt(t)(e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},O:function(t,e,n,r,a,i,o){var u=Ee();try{gt(t)(e,n,r,a,i,o)}catch(t){if(Me(u),t!==t+0)throw t;Se(1,0)}},A:function(t,e,n,r,a,i,o,u){var c=Ee();try{gt(t)(e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},ka:function(t,e,n,r,a,i,o,u,c){var s=Ee();try{gt(t)(e,n,r,a,i,o,u,c)}catch(t){if(Me(s),t!==t+0)throw t;Se(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l){var f=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(Me(f),t!==t+0)throw t;Se(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=Ee();try{gt(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(Me(b),t!==t+0)throw t;Se(1,0)}},fa:function(t,e,n,r,a,i,o,u){var c=Ee();try{Pe(t,e,n,r,a,i,o,u)}catch(t){if(Me(c),t!==t+0)throw t;Se(1,0)}},da:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=Ee();try{Fe(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(Me(p),t!==t+0)throw t;Se(1,0)}},ea:function(t,e,n,r,a,i){var o=Ee();try{Ue(t,e,n,r,a,i)}catch(t){if(Me(o),t!==t+0)throw t;Se(1,0)}},o:function(t){return t},a:j||u.wasmMemory,G:function(t){oe=t},la:le,z:function(t,e,n,r){return le(t,e,n,r)}};!function(){function t(t,e){u.asm=t.exports,ht.qc.push(u.asm.sb),$=u.asm.ub,X.unshift(u.asm.Va),k=e,O||(et--,u.monitorRunDependencies&&u.monitorRunDependencies(et),0==et&&(null!==nt&&(clearInterval(nt),nt=null),rt&&(t=rt,rt=null,t())))}function e(e){t(e.instance,e.module)}function n(t){return function(){if(!M&&(v||w)){if("function"==typeof fetch&&!tt.startsWith("file://"))return fetch(tt,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+tt+"\'";return t.arrayBuffer()})).catch((function(){return ot()}));if(f)return new Promise((function(t,e){f(tt,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return ot()}))}().then((function(t){return WebAssembly.instantiate(t,r)})).then((function(t){return t})).then(t,(function(t){x("failed to asynchronously prepare wasm: "+t),at(t)}))}var r={a:pe};if(O||(et++,u.monitorRunDependencies&&u.monitorRunDependencies(et)),u.instantiateWasm)try{return u.instantiateWasm(r,t)}catch(t){return x("Module.instantiateWasm callback failed with error: "+t),!1}(M||"function"!=typeof WebAssembly.instantiateStreaming||it()||tt.startsWith("file://")||_||"function"!=typeof fetch?n(e):fetch(tt,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,r).then(e,(function(t){return x("wasm streaming compile failed: "+t),x("falling back to ArrayBuffer instantiation"),n(e)}))}))).catch(s)}(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.Va).apply(null,arguments)},u._OrtInit=function(){return(u._OrtInit=u.asm.Wa).apply(null,arguments)},u._OrtCreateSessionOptions=function(){return(u._OrtCreateSessionOptions=u.asm.Xa).apply(null,arguments)},u._OrtAppendExecutionProvider=function(){return(u._OrtAppendExecutionProvider=u.asm.Ya).apply(null,arguments)},u._OrtAddSessionConfigEntry=function(){return(u._OrtAddSessionConfigEntry=u.asm.Za).apply(null,arguments)},u._OrtReleaseSessionOptions=function(){return(u._OrtReleaseSessionOptions=u.asm._a).apply(null,arguments)},u._OrtCreateSession=function(){return(u._OrtCreateSession=u.asm.$a).apply(null,arguments)},u._OrtReleaseSession=function(){return(u._OrtReleaseSession=u.asm.ab).apply(null,arguments)},u._OrtGetInputCount=function(){return(u._OrtGetInputCount=u.asm.bb).apply(null,arguments)},u._OrtGetOutputCount=function(){return(u._OrtGetOutputCount=u.asm.cb).apply(null,arguments)},u._OrtGetInputName=function(){return(u._OrtGetInputName=u.asm.db).apply(null,arguments)},u._OrtGetOutputName=function(){return(u._OrtGetOutputName=u.asm.eb).apply(null,arguments)},u._OrtFree=function(){return(u._OrtFree=u.asm.fb).apply(null,arguments)},u._OrtCreateTensor=function(){return(u._OrtCreateTensor=u.asm.gb).apply(null,arguments)},u._OrtGetTensorData=function(){return(u._OrtGetTensorData=u.asm.hb).apply(null,arguments)},u._OrtReleaseTensor=function(){return(u._OrtReleaseTensor=u.asm.ib).apply(null,arguments)},u._OrtCreateRunOptions=function(){return(u._OrtCreateRunOptions=u.asm.jb).apply(null,arguments)},u._OrtAddRunConfigEntry=function(){return(u._OrtAddRunConfigEntry=u.asm.kb).apply(null,arguments)},u._OrtReleaseRunOptions=function(){return(u._OrtReleaseRunOptions=u.asm.lb).apply(null,arguments)},u._OrtRun=function(){return(u._OrtRun=u.asm.mb).apply(null,arguments)},u._OrtEndProfiling=function(){return(u._OrtEndProfiling=u.asm.nb).apply(null,arguments)};var he=u._pthread_self=function(){return(he=u._pthread_self=u.asm.ob).apply(null,arguments)},de=u._malloc=function(){return(de=u._malloc=u.asm.pb).apply(null,arguments)},ye=u._free=function(){return(ye=u._free=u.asm.qb).apply(null,arguments)},be=u._fflush=function(){return(be=u._fflush=u.asm.rb).apply(null,arguments)};u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm.sb).apply(null,arguments)};var me=u.___funcs_on_exit=function(){return(me=u.___funcs_on_exit=u.asm.tb).apply(null,arguments)},ge=u.__emscripten_thread_init=function(){return(ge=u.__emscripten_thread_init=u.asm.vb).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm.wb).apply(null,arguments)};var ve,we=u._emscripten_run_in_main_runtime_thread_js=function(){return(we=u._emscripten_run_in_main_runtime_thread_js=u.asm.xb).apply(null,arguments)},_e=u.__emscripten_proxy_execute_task_queue=function(){return(_e=u.__emscripten_proxy_execute_task_queue=u.asm.yb).apply(null,arguments)},Oe=u.__emscripten_thread_free_data=function(){return(Oe=u.__emscripten_thread_free_data=u.asm.zb).apply(null,arguments)},Ae=u.__emscripten_thread_exit=function(){return(Ae=u.__emscripten_thread_exit=u.asm.Ab).apply(null,arguments)},Se=u._setThrew=function(){return(Se=u._setThrew=u.asm.Bb).apply(null,arguments)},Te=u._emscripten_stack_set_limits=function(){return(Te=u._emscripten_stack_set_limits=u.asm.Cb).apply(null,arguments)},Ee=u.stackSave=function(){return(Ee=u.stackSave=u.asm.Db).apply(null,arguments)},Me=u.stackRestore=function(){return(Me=u.stackRestore=u.asm.Eb).apply(null,arguments)},Ce=u.stackAlloc=function(){return(Ce=u.stackAlloc=u.asm.Fb).apply(null,arguments)},xe=u.___cxa_can_catch=function(){return(xe=u.___cxa_can_catch=u.asm.Gb).apply(null,arguments)},Re=u.___cxa_is_pointer_type=function(){return(Re=u.___cxa_is_pointer_type=u.asm.Hb).apply(null,arguments)},je=u.dynCall_j=function(){return(je=u.dynCall_j=u.asm.Ib).apply(null,arguments)},ke=u.dynCall_iiiiij=function(){return(ke=u.dynCall_iiiiij=u.asm.Jb).apply(null,arguments)},De=u.dynCall_jii=function(){return(De=u.dynCall_jii=u.asm.Kb).apply(null,arguments)},Pe=u.dynCall_viiiiij=function(){return(Pe=u.dynCall_viiiiij=u.asm.Lb).apply(null,arguments)},Ue=u.dynCall_vjji=function(){return(Ue=u.dynCall_vjji=u.asm.Mb).apply(null,arguments)},Fe=u.dynCall_viiijjjii=function(){return(Fe=u.dynCall_viiijjjii=u.asm.Nb).apply(null,arguments)},Ie=u.dynCall_iij=function(){return(Ie=u.dynCall_iij=u.asm.Ob).apply(null,arguments)},We=u.dynCall_ji=function(){return(We=u.dynCall_ji=u.asm.Pb).apply(null,arguments)},He=u.dynCall_iiiiiij=function(){return(He=u.dynCall_iiiiiij=u.asm.Qb).apply(null,arguments)},Le=u.dynCall_iiij=function(){return(Le=u.dynCall_iiij=u.asm.Rb).apply(null,arguments)};function ze(){function t(){if(!ve&&(ve=!0,u.calledRun=!0,!H)&&(O||dt(X),c(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),!O)){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;){var t=u.postRun.shift();Z.unshift(t)}dt(Z)}}if(!(0<et))if(O)c(u),O||dt(X),postMessage({cmd:"loaded"});else{if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)K();dt(q),0<et||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),t()}),1)):t())}}if(u.UTF8ToString=Y,u.stringToUTF8=function(t,e,n){return B(t,r(),e,n)},u.lengthBytesUTF8=G,u.keepRuntimeAlive=Q,u.wasmMemory=j,u.stackSave=Ee,u.stackRestore=Me,u.stackAlloc=Ce,u.ExitStatus=ct,u.PThread=ht,rt=function t(){ve||ze(),ve||(rt=t)},u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);0<u.preInit.length;)u.preInit.pop()();return ze(),t.ready});t.exports=r},932:(t,e,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(t){var e,r,a;t=t||{},e||(e=void 0!==t?t:{}),e.ready=new Promise((function(t,e){r=t,a=e}));var i,o,u,c,s,l,f=Object.assign({},e),p="./this.program",h=(t,e)=>{throw e},d="object"==typeof window,y="function"==typeof importScripts,b="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,m="";b?(m=y?n(908).dirname(m)+"/":"//",l=()=>{s||(c=n(384),s=n(908))},i=function(t,e){return l(),t=s.normalize(t),c.readFileSync(t,e?void 0:"utf8")},u=t=>((t=i(t,!0)).buffer||(t=new Uint8Array(t)),t),o=(t,e,n)=>{l(),t=s.normalize(t),c.readFile(t,(function(t,r){t?n(t):e(r.buffer)}))},1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof J))throw t})),process.on("unhandledRejection",(function(t){throw t})),h=(t,e)=>{if(_||0<L)throw process.exitCode=t,e;e instanceof J||w("exiting due to exception: "+e),process.exit(t)},e.inspect=function(){return"[Emscripten Module object]"}):(d||y)&&(y?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),_scriptDir&&(m=_scriptDir),m=0!==m.indexOf("blob:")?m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):"",i=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},y&&(u=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),o=(t,e,n)=>{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?e(r.response):n()},r.onerror=n,r.send(null)});var g,v=e.print||console.log.bind(console),w=e.printErr||console.warn.bind(console);Object.assign(e,f),f=null,e.thisProgram&&(p=e.thisProgram),e.quit&&(h=e.quit),e.wasmBinary&&(g=e.wasmBinary);var _=e.noExitRuntime||!1;"object"!=typeof WebAssembly&&V("no native wasm support detected");var O,A,S,T,E,M,C=!1,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(t,e,n){var r=(e>>>=0)+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.buffer&&x)return x.decode(t.subarray(e,n));for(r="";e<n;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function j(t,e){return(t>>>=0)?R(T,t,e):""}function k(t,e,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var i=0;i<t.length;++i){var o=t.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++i)),127>=o){if(n>=r)break;e[n++>>>0]=o}else{if(2047>=o){if(n+1>=r)break;e[n++>>>0]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;e[n++>>>0]=224|o>>12}else{if(n+3>=r)break;e[n++>>>0]=240|o>>18,e[n++>>>0]=128|o>>12&63}e[n++>>>0]=128|o>>6&63}e[n++>>>0]=128|63&o}}return e[n>>>0]=0,n-a}function D(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);127>=r?e++:2047>=r?e+=2:55296<=r&&57343>=r?(e+=4,++n):e+=3}return e}function P(){var t=O.buffer;A=t,e.HEAP8=S=new Int8Array(t),e.HEAP16=new Int16Array(t),e.HEAP32=E=new Int32Array(t),e.HEAPU8=T=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=M=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var U,F=[],I=[],W=[],H=[],L=0;function z(){var t=e.preRun.shift();F.unshift(t)}var Y,B=0,G=null,N=null;function V(t){throw e.onAbort&&e.onAbort(t),w(t="Aborted("+t+")"),C=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),a(t),t}function $(){return Y.startsWith("data:application/octet-stream;base64,")}if(Y="ort-wasm.wasm",!$()){var q=Y;Y=e.locateFile?e.locateFile(q,m):m+q}function X(){var t=Y;try{if(t==Y&&g)return new Uint8Array(g);if(u)return u(t);throw"both async and sync fetching of the wasm failed"}catch(t){V(t)}}function J(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Z(t){for(;0<t.length;)t.shift()(e)}var Q=[],K=0,tt=0;function et(t){this.Db=t,this.zb=t-24,this.Ub=function(t){M[this.zb+4>>2>>>0]=t},this.Eb=function(){return M[this.zb+4>>2>>>0]},this.Sb=function(t){M[this.zb+8>>2>>>0]=t},this.Wb=function(){return M[this.zb+8>>2>>>0]},this.Tb=function(){E[this.zb>>2>>>0]=0},this.Ib=function(t){S[this.zb+12>>0>>>0]=t?1:0},this.Pb=function(){return 0!=S[this.zb+12>>0>>>0]},this.Jb=function(t){S[this.zb+13>>0>>>0]=t?1:0},this.Lb=function(){return 0!=S[this.zb+13>>0>>>0]},this.Rb=function(t,e){this.Fb(0),this.Ub(t),this.Sb(e),this.Tb(),this.Ib(!1),this.Jb(!1)},this.Nb=function(){E[this.zb>>2>>>0]+=1},this.Xb=function(){var t=E[this.zb>>2>>>0];return E[this.zb>>2>>>0]=t-1,1===t},this.Fb=function(t){M[this.zb+16>>2>>>0]=t},this.Ob=function(){return M[this.zb+16>>2>>>0]},this.Qb=function(){if(Mt(this.Eb()))return M[this.Db>>2>>>0];var t=this.Ob();return 0!==t?t:this.Db}}function nt(t){return vt(new et(t).zb)}var rt=[];function at(t){var e=rt[t];return e||(t>=rt.length&&(rt.length=t+1),rt[t]=e=U.get(t)),e}function it(t){var e=D(t)+1,n=gt(e);return n&&k(t,S,n,e),n}var ot={};function ut(){if(!ct){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(t in ot)void 0===ot[t]?delete e[t]:e[t]=ot[t];var n=[];for(t in e)n.push(t+"="+e[t]);ct=n}return ct}var ct,st=[null,[],[]];function lt(t,e){var n=st[t];0===e||10===e?((1===t?v:w)(R(n,0)),n.length=0):n.push(e)}var ft=0;function pt(t){return 0==t%4&&(0!=t%100||0==t%400)}var ht=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function yt(t,e,n,r){function a(t,e,n){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=n[0]+t;return t}function i(t,e){return a(t,e,"0")}function o(t,e){function n(t){return 0>t?-1:0<t?1:0}var r;return 0===(r=n(t.getFullYear()-e.getFullYear()))&&0===(r=n(t.getMonth()-e.getMonth()))&&(r=n(t.getDate()-e.getDate())),r}function u(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function c(t){var e=t.Bb;for(t=new Date(new Date(t.Cb+1900,0,1).getTime());0<e;){var n=t.getMonth(),r=(pt(t.getFullYear())?ht:dt)[n];if(!(e>r-t.getDate())){t.setDate(t.getDate()+e);break}e-=r-t.getDate()+1,t.setDate(1),11>n?t.setMonth(n+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return n=new Date(t.getFullYear()+1,0,4),e=u(new Date(t.getFullYear(),0,4)),n=u(n),0>=o(e,t)?0>=o(n,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var s=E[r+40>>2>>>0];for(var l in r={$b:E[r>>2>>>0],Zb:E[r+4>>2>>>0],Gb:E[r+8>>2>>>0],Kb:E[r+12>>2>>>0],Hb:E[r+16>>2>>>0],Cb:E[r+20>>2>>>0],Ab:E[r+24>>2>>>0],Bb:E[r+28>>2>>>0],bc:E[r+32>>2>>>0],Yb:E[r+36>>2>>>0],ac:s?j(s):""},n=j(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),s[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in s={"%a":function(t){return f[t.Ab].substring(0,3)},"%A":function(t){return f[t.Ab]},"%b":function(t){return p[t.Hb].substring(0,3)},"%B":function(t){return p[t.Hb]},"%C":function(t){return i((t.Cb+1900)/100|0,2)},"%d":function(t){return i(t.Kb,2)},"%e":function(t){return a(t.Kb,2," ")},"%g":function(t){return c(t).toString().substring(2)},"%G":function(t){return c(t)},"%H":function(t){return i(t.Gb,2)},"%I":function(t){return 0==(t=t.Gb)?t=12:12<t&&(t-=12),i(t,2)},"%j":function(t){for(var e=0,n=0;n<=t.Hb-1;e+=(pt(t.Cb+1900)?ht:dt)[n++]);return i(t.Kb+e,3)},"%m":function(t){return i(t.Hb+1,2)},"%M":function(t){return i(t.Zb,2)},"%n":function(){return"\\n"},"%p":function(t){return 0<=t.Gb&&12>t.Gb?"AM":"PM"},"%S":function(t){return i(t.$b,2)},"%t":function(){return"\\t"},"%u":function(t){return t.Ab||7},"%U":function(t){return i(Math.floor((t.Bb+7-t.Ab)/7),2)},"%V":function(t){var e=Math.floor((t.Bb+7-(t.Ab+6)%7)/7);if(2>=(t.Ab+371-t.Bb-2)%7&&e++,e)53==e&&(4==(n=(t.Ab+371-t.Bb)%7)||3==n&&pt(t.Cb)||(e=1));else{e=52;var n=(t.Ab+7-t.Bb-1)%7;(4==n||5==n&&pt(t.Cb%400-1))&&e++}return i(e,2)},"%w":function(t){return t.Ab},"%W":function(t){return i(Math.floor((t.Bb+7-(t.Ab+6)%7)/7),2)},"%y":function(t){return(t.Cb+1900).toString().substring(2)},"%Y":function(t){return t.Cb+1900},"%z":function(t){var e=0<=(t=t.Yb);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.ac},"%%":function(){return"%"}},n=n.replace(/%%/g,"\\0\\0"),s)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),s[l](r)));return l=function(t){var e=Array(D(t)+1);return k(t,e,0,e.length),e}(n=n.replace(/\\0\\0/g,"%")),l.length>e?0:(S.set(l,t>>>0),l.length-1)}var bt={a:function(t){return gt(t+24)+24},m:function(t){return(t=new et(t)).Pb()||(t.Ib(!0),K--),t.Jb(!1),Q.push(t),t.Nb(),t.Qb()},ia:function(t){throw w("Unexpected exception thrown, this is not properly supported - aborting"),C=!0,t},w:function(){Ot(0);var t=Q.pop();if(t.Xb()&&!t.Lb()){var e=t.Wb();e&&at(e)(t.Db),nt(t.Db)}tt=0},d:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},k:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},g:function(){var t=tt;if(!t)return ft=0;var e=new et(t);e.Fb(t);var n=e.Eb();if(!n)return ft=0,t;for(var r=Array.prototype.slice.call(arguments),a=0;a<r.length;a++){var i=r[a];if(0===i||i===n)break;if(Et(i,n,e.zb+16))return ft=i,t}return ft=n,t},s:nt,L:function(){var t=Q.pop();t||V("no exception to throw");var e=t.Db;throw t.Lb()||(Q.push(t),t.Jb(!0),t.Ib(!1),K++),tt=e,e},b:function(t,e,n){throw new et(t).Rb(e,n),tt=t,K++,t},la:function(){return K},i:function(t){throw tt||(tt=t),t},H:function(){return 0},Ba:function(){},pa:function(){},ra:function(){},ka:function(){return 0},za:function(){},ua:function(){},ya:function(){},R:function(){},qa:function(){},na:function(){},Aa:function(){},oa:function(){},Ha:function(){},Ja:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},Ia:function(){V("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},S:function(){return Date.now()},Ca:function(){return!0},Da:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getUTCSeconds(),E[e+4>>2>>>0]=t.getUTCMinutes(),E[e+8>>2>>>0]=t.getUTCHours(),E[e+12>>2>>>0]=t.getUTCDate(),E[e+16>>2>>>0]=t.getUTCMonth(),E[e+20>>2>>>0]=t.getUTCFullYear()-1900,E[e+24>>2>>>0]=t.getUTCDay(),E[e+28>>2>>>0]=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},Ea:function(t,e){t=new Date(1e3*(M[t>>>2]+4294967296*E[t+4>>>2])),E[e>>2>>>0]=t.getSeconds(),E[e+4>>2>>>0]=t.getMinutes(),E[e+8>>2>>>0]=t.getHours(),E[e+12>>2>>>0]=t.getDate(),E[e+16>>2>>>0]=t.getMonth(),E[e+20>>2>>>0]=t.getFullYear()-1900,E[e+24>>2>>>0]=t.getDay();var n=new Date(t.getFullYear(),0,1);E[e+28>>2>>>0]=(t.getTime()-n.getTime())/864e5|0,E[e+36>>2>>>0]=-60*t.getTimezoneOffset();var r=new Date(t.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),E[e+32>>2>>>0]=0|(r!=n&&t.getTimezoneOffset()==Math.min(n,r))},Fa:function(t){var e=new Date(E[t+20>>2>>>0]+1900,E[t+16>>2>>>0],E[t+12>>2>>>0],E[t+8>>2>>>0],E[t+4>>2>>>0],E[t>>2>>>0],0),n=E[t+32>>2>>>0],r=e.getTimezoneOffset(),a=new Date(e.getFullYear(),0,1),i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),o=a.getTimezoneOffset(),u=Math.min(o,i);return 0>n?E[t+32>>2>>>0]=Number(i!=o&&u==r):0<n!=(u==r)&&(i=Math.max(o,i),e.setTime(e.getTime()+6e4*((0<n?u:i)-r))),E[t+24>>2>>>0]=e.getDay(),E[t+28>>2>>>0]=(e.getTime()-a.getTime())/864e5|0,E[t>>2>>>0]=e.getSeconds(),E[t+4>>2>>>0]=e.getMinutes(),E[t+8>>2>>>0]=e.getHours(),E[t+12>>2>>>0]=e.getDate(),E[t+16>>2>>>0]=e.getMonth(),e.getTime()/1e3|0},sa:function(){return-52},ta:function(){},Ga:function t(e,n,r){t.Vb||(t.Vb=!0,function(t,e,n){function r(t){return(t=t.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?t[1]:"GMT"}var a=(new Date).getFullYear(),i=new Date(a,0,1),o=new Date(a,6,1);a=i.getTimezoneOffset();var u=o.getTimezoneOffset();E[t>>2>>>0]=60*Math.max(a,u),E[e>>2>>>0]=Number(a!=u),t=r(i),e=r(o),t=it(t),e=it(e),u<a?(M[n>>2>>>0]=t,M[n+4>>2>>>0]=e):(M[n>>2>>>0]=e,M[n+4>>2>>>0]=t)}(e,n,r))},B:function(){V("")},ma:function(){return 4294901760},I:b?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now(),xa:function(t,e,n){T.copyWithin(t>>>0,e>>>0,e+n>>>0)},G:function(t){var e=T.length;if(4294901760<(t>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=e*(1+.2/n);r=Math.min(r,t+100663296);var a=Math;r=Math.max(t,r),a=a.min.call(a,4294901760,r+(65536-r%65536)%65536);t:{try{O.grow(a-A.byteLength+65535>>>16),P();var i=1;break t}catch(t){}i=void 0}if(i)return!0}return!1},va:function(t,e){var n=0;return ut().forEach((function(r,a){var i=e+n;for(a=M[t+4*a>>2>>>0]=i,i=0;i<r.length;++i)S[a++>>0>>>0]=r.charCodeAt(i);S[a>>0>>>0]=0,n+=r.length+1})),0},wa:function(t,e){var n=ut();M[t>>2>>>0]=n.length;var r=0;return n.forEach((function(t){r+=t.length+1})),M[e>>2>>>0]=r,0},ba:function(t){_||0<L||(_t(),Z(W),wt(0),st[1].length&&lt(1,10),st[2].length&&lt(2,10)),_||0<L||(e.onExit&&e.onExit(t),C=!0),h(t,new J(t))},E:function(){return 52},Q:function(){return 52},ca:function(){return 70},P:function(t,e,n,r){for(var a=0,i=0;i<n;i++){var o=M[e>>2>>>0],u=M[e+4>>2>>>0];e+=8;for(var c=0;c<u;c++)lt(t,T[o+c>>>0]);a+=u}return M[r>>2>>>0]=a,0},c:function(){return ft},ja:function t(e,r){t.Mb||(t.Mb=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>(crypto.getRandomValues(t),t[0])}if(b)try{var e=n(Object(function(){var t=new Error("Cannot find module \'crypto\'");throw t.code="MODULE_NOT_FOUND",t}()));return()=>e.randomBytes(1)[0]}catch(t){}return()=>V("randomDevice")}());for(var a=0;a<r;a++)S[e+a>>0>>>0]=t.Mb();return 0},ea:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},fa:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},J:function(t){var e=At();try{return at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},e:function(t,e){var n=At();try{return at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},N:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},O:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},j:function(t,e,n){var r=At();try{return at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},o:function(t,e,n,r){var a=At();try{return at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},p:function(t,e,n,r,a){var i=At();try{return at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},M:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},r:function(t,e,n,r,a,i){var o=At();try{return at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},v:function(t,e,n,r,a,i,o){var u=At();try{return at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},K:function(t,e,n,r,a,i,o,u){var c=At();try{return at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},D:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{return at(t)(e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},X:function(t,e,n,r,a,i,o,u){var c=At();try{return Ft(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},V:function(t,e,n,r,a,i,o){var u=At();try{return xt(t,e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},U:function(t,e,n,r,a){var i=At();try{return It(t,e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},Z:function(t,e,n,r){var a=At();try{return Pt(t,e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},W:function(t){var e=At();try{return Ct(t)}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},Y:function(t,e){var n=At();try{return Ut(t,e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},T:function(t,e,n){var r=At();try{return Rt(t,e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},f:function(t){var e=At();try{at(t)()}catch(t){if(St(e),t!==t+0)throw t;Ot(1,0)}},q:function(t,e){var n=At();try{at(t)(e)}catch(t){if(St(n),t!==t+0)throw t;Ot(1,0)}},h:function(t,e,n){var r=At();try{at(t)(e,n)}catch(t){if(St(r),t!==t+0)throw t;Ot(1,0)}},da:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},l:function(t,e,n,r){var a=At();try{at(t)(e,n,r)}catch(t){if(St(a),t!==t+0)throw t;Ot(1,0)}},t:function(t,e,n,r,a){var i=At();try{at(t)(e,n,r,a)}catch(t){if(St(i),t!==t+0)throw t;Ot(1,0)}},u:function(t,e,n,r,a,i){var o=At();try{at(t)(e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},x:function(t,e,n,r,a,i,o){var u=At();try{at(t)(e,n,r,a,i,o)}catch(t){if(St(u),t!==t+0)throw t;Ot(1,0)}},z:function(t,e,n,r,a,i,o,u){var c=At();try{at(t)(e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},ga:function(t,e,n,r,a,i,o,u,c){var s=At();try{at(t)(e,n,r,a,i,o,u,c)}catch(t){if(St(s),t!==t+0)throw t;Ot(1,0)}},A:function(t,e,n,r,a,i,o,u,c,s,l){var f=At();try{at(t)(e,n,r,a,i,o,u,c,s,l)}catch(t){if(St(f),t!==t+0)throw t;Ot(1,0)}},C:function(t,e,n,r,a,i,o,u,c,s,l,f,p,h,d,y){var b=At();try{at(t)(e,n,r,a,i,o,u,c,s,l,f,p,h,d,y)}catch(t){if(St(b),t!==t+0)throw t;Ot(1,0)}},aa:function(t,e,n,r,a,i,o,u){var c=At();try{jt(t,e,n,r,a,i,o,u)}catch(t){if(St(c),t!==t+0)throw t;Ot(1,0)}},_:function(t,e,n,r,a,i,o,u,c,s,l,f){var p=At();try{Dt(t,e,n,r,a,i,o,u,c,s,l,f)}catch(t){if(St(p),t!==t+0)throw t;Ot(1,0)}},$:function(t,e,n,r,a,i){var o=At();try{kt(t,e,n,r,a,i)}catch(t){if(St(o),t!==t+0)throw t;Ot(1,0)}},n:function(t){return t},F:function(t){ft=t},ha:yt,y:function(t,e,n,r){return yt(t,e,n,r)}};!function(){function t(t){e.asm=t.exports,O=e.asm.Ka,P(),U=e.asm.ib,I.unshift(e.asm.La),B--,e.monitorRunDependencies&&e.monitorRunDependencies(B),0==B&&(null!==G&&(clearInterval(G),G=null),N&&(t=N,N=null,t()))}function n(e){t(e.instance)}function r(t){return function(){if(!g&&(d||y)){if("function"==typeof fetch&&!Y.startsWith("file://"))return fetch(Y,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at \'"+Y+"\'";return t.arrayBuffer()})).catch((function(){return X()}));if(o)return new Promise((function(t,e){o(Y,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return X()}))}().then((function(t){return WebAssembly.instantiate(t,i)})).then((function(t){return t})).then(t,(function(t){w("failed to asynchronously prepare wasm: "+t),V(t)}))}var i={a:bt};if(B++,e.monitorRunDependencies&&e.monitorRunDependencies(B),e.instantiateWasm)try{return e.instantiateWasm(i,t)}catch(t){return w("Module.instantiateWasm callback failed with error: "+t),!1}(g||"function"!=typeof WebAssembly.instantiateStreaming||$()||Y.startsWith("file://")||b||"function"!=typeof fetch?r(n):fetch(Y,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,i).then(n,(function(t){return w("wasm streaming compile failed: "+t),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.La).apply(null,arguments)},e._OrtInit=function(){return(e._OrtInit=e.asm.Ma).apply(null,arguments)},e._OrtCreateSessionOptions=function(){return(e._OrtCreateSessionOptions=e.asm.Na).apply(null,arguments)},e._OrtAppendExecutionProvider=function(){return(e._OrtAppendExecutionProvider=e.asm.Oa).apply(null,arguments)},e._OrtAddSessionConfigEntry=function(){return(e._OrtAddSessionConfigEntry=e.asm.Pa).apply(null,arguments)},e._OrtReleaseSessionOptions=function(){return(e._OrtReleaseSessionOptions=e.asm.Qa).apply(null,arguments)},e._OrtCreateSession=function(){return(e._OrtCreateSession=e.asm.Ra).apply(null,arguments)},e._OrtReleaseSession=function(){return(e._OrtReleaseSession=e.asm.Sa).apply(null,arguments)},e._OrtGetInputCount=function(){return(e._OrtGetInputCount=e.asm.Ta).apply(null,arguments)},e._OrtGetOutputCount=function(){return(e._OrtGetOutputCount=e.asm.Ua).apply(null,arguments)},e._OrtGetInputName=function(){return(e._OrtGetInputName=e.asm.Va).apply(null,arguments)},e._OrtGetOutputName=function(){return(e._OrtGetOutputName=e.asm.Wa).apply(null,arguments)},e._OrtFree=function(){return(e._OrtFree=e.asm.Xa).apply(null,arguments)},e._OrtCreateTensor=function(){return(e._OrtCreateTensor=e.asm.Ya).apply(null,arguments)},e._OrtGetTensorData=function(){return(e._OrtGetTensorData=e.asm.Za).apply(null,arguments)},e._OrtReleaseTensor=function(){return(e._OrtReleaseTensor=e.asm._a).apply(null,arguments)},e._OrtCreateRunOptions=function(){return(e._OrtCreateRunOptions=e.asm.$a).apply(null,arguments)},e._OrtAddRunConfigEntry=function(){return(e._OrtAddRunConfigEntry=e.asm.ab).apply(null,arguments)},e._OrtReleaseRunOptions=function(){return(e._OrtReleaseRunOptions=e.asm.bb).apply(null,arguments)},e._OrtRun=function(){return(e._OrtRun=e.asm.cb).apply(null,arguments)},e._OrtEndProfiling=function(){return(e._OrtEndProfiling=e.asm.db).apply(null,arguments)};var mt,gt=e._malloc=function(){return(gt=e._malloc=e.asm.eb).apply(null,arguments)},vt=e._free=function(){return(vt=e._free=e.asm.fb).apply(null,arguments)},wt=e._fflush=function(){return(wt=e._fflush=e.asm.gb).apply(null,arguments)},_t=e.___funcs_on_exit=function(){return(_t=e.___funcs_on_exit=e.asm.hb).apply(null,arguments)},Ot=e._setThrew=function(){return(Ot=e._setThrew=e.asm.jb).apply(null,arguments)},At=e.stackSave=function(){return(At=e.stackSave=e.asm.kb).apply(null,arguments)},St=e.stackRestore=function(){return(St=e.stackRestore=e.asm.lb).apply(null,arguments)},Tt=e.stackAlloc=function(){return(Tt=e.stackAlloc=e.asm.mb).apply(null,arguments)},Et=e.___cxa_can_catch=function(){return(Et=e.___cxa_can_catch=e.asm.nb).apply(null,arguments)},Mt=e.___cxa_is_pointer_type=function(){return(Mt=e.___cxa_is_pointer_type=e.asm.ob).apply(null,arguments)},Ct=e.dynCall_j=function(){return(Ct=e.dynCall_j=e.asm.pb).apply(null,arguments)},xt=e.dynCall_iiiiij=function(){return(xt=e.dynCall_iiiiij=e.asm.qb).apply(null,arguments)},Rt=e.dynCall_jii=function(){return(Rt=e.dynCall_jii=e.asm.rb).apply(null,arguments)},jt=e.dynCall_viiiiij=function(){return(jt=e.dynCall_viiiiij=e.asm.sb).apply(null,arguments)},kt=e.dynCall_vjji=function(){return(kt=e.dynCall_vjji=e.asm.tb).apply(null,arguments)},Dt=e.dynCall_viiijjjii=function(){return(Dt=e.dynCall_viiijjjii=e.asm.ub).apply(null,arguments)},Pt=e.dynCall_iij=function(){return(Pt=e.dynCall_iij=e.asm.vb).apply(null,arguments)},Ut=e.dynCall_ji=function(){return(Ut=e.dynCall_ji=e.asm.wb).apply(null,arguments)},Ft=e.dynCall_iiiiiij=function(){return(Ft=e.dynCall_iiiiiij=e.asm.xb).apply(null,arguments)},It=e.dynCall_iiij=function(){return(It=e.dynCall_iiij=e.asm.yb).apply(null,arguments)};function Wt(){function t(){if(!mt&&(mt=!0,e.calledRun=!0,!C)){if(Z(I),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();H.unshift(t)}Z(H)}}if(!(0<B)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)z();Z(F),0<B||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.UTF8ToString=j,e.stringToUTF8=function(t,e,n){return k(t,T,e,n)},e.lengthBytesUTF8=D,e.stackSave=At,e.stackRestore=St,e.stackAlloc=Tt,N=function t(){mt||Wt(),mt||(N=t)},e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Wt(),t.ready});t.exports=r},967:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.iterateExtraOptions=void 0,e.iterateExtraOptions=(t,n,r,a)=>{if("object"==typeof t&&null!==t){if(r.has(t))throw new Error("Circular reference in options");r.add(t)}Object.entries(t).forEach((([t,i])=>{const o=n?n+t:t;if("object"==typeof i)(0,e.iterateExtraOptions)(i,o+".",r,a);else if("string"==typeof i||"number"==typeof i)a(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can\'t handle extra config type: "+typeof i);a(o,i?"1":"0")}}))}},586:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setRunOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setRunOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};try{if(void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);void 0===(null==t?void 0:t.terminate)&&(u.terminate=!1);let i=0;if(void 0!==(null==t?void 0:t.tag)&&(i=(0,a.allocWasmString)(t.tag,o)),n=e._OrtCreateRunOptions(u.logSeverityLevel,u.logVerbosityLevel,!!u.terminate,i),0===n)throw new Error("Can\'t create run options");return void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddRunConfigEntry(n,i,u))throw new Error(`Can\'t set a run config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseRunOptions(n),o.forEach(e._free),t}}},919:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setSessionOptions=void 0;const r=n(967),a=n(983),i=n(361);e.setSessionOptions=t=>{const e=(0,i.getInstance)();let n=0;const o=[],u=t||{};(t=>{t.extra||(t.extra={}),t.extra.session||(t.extra.session={});const e=t.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1")})(u);try{void 0===(null==t?void 0:t.graphOptimizationLevel)&&(u.graphOptimizationLevel="all");const c=(t=>{switch(t){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${t}`)}})(u.graphOptimizationLevel);void 0===(null==t?void 0:t.enableCpuMemArena)&&(u.enableCpuMemArena=!0),void 0===(null==t?void 0:t.enableMemPattern)&&(u.enableMemPattern=!0),void 0===(null==t?void 0:t.executionMode)&&(u.executionMode="sequential");const s=(t=>{switch(t){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${t}`)}})(u.executionMode);let l=0;if(void 0!==(null==t?void 0:t.logId)&&(l=(0,a.allocWasmString)(t.logId,o)),void 0===(null==t?void 0:t.logSeverityLevel))u.logSeverityLevel=2;else if("number"!=typeof t.logSeverityLevel||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if(void 0===(null==t?void 0:t.logVerbosityLevel))u.logVerbosityLevel=0;else if("number"!=typeof t.logVerbosityLevel||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);if(void 0===(null==t?void 0:t.enableProfiling)&&(u.enableProfiling=!1),n=e._OrtCreateSessionOptions(c,!!u.enableCpuMemArena,!!u.enableMemPattern,s,!!u.enableProfiling,0,l,u.logSeverityLevel,u.logVerbosityLevel),0===n)throw new Error("Can\'t create session options");return(null==t?void 0:t.executionProviders)&&((t,e,n)=>{for(const r of e){let e="string"==typeof r?r:r.name;switch(e){case"xnnpack":e="XNNPACK";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${e}`)}const o=(0,a.allocWasmString)(e,n);if(0!==(0,i.getInstance)()._OrtAppendExecutionProvider(t,o))throw new Error(`Can\'t append execution provider: ${e}`)}})(n,t.executionProviders,o),void 0!==(null==t?void 0:t.extra)&&(0,r.iterateExtraOptions)(t.extra,"",new WeakSet,((t,r)=>{const i=(0,a.allocWasmString)(t,o),u=(0,a.allocWasmString)(r,o);if(0!==e._OrtAddSessionConfigEntry(n,i,u))throw new Error(`Can\'t set a session config entry: ${t} - ${r}`)})),[n,o]}catch(t){throw 0!==n&&e._OrtReleaseSessionOptions(n),o.forEach(e._free),t}}},983:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.allocWasmString=void 0;const r=n(361);e.allocWasmString=(t,e)=>{const n=(0,r.getInstance)(),a=n.lengthBytesUTF8(t)+1,i=n._malloc(a);return n.stringToUTF8(t,i,a),e.push(i),i}},349:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractTransferableBuffers=e.endProfiling=e.run=e.releaseSession=e.createSession=e.createSessionFinalize=e.createSessionAllocate=e.initOrt=void 0;const r=n(586),a=n(919),i=n(983),o=n(361);e.initOrt=(t,e)=>{const n=(0,o.getInstance)()._OrtInit(t,e);if(0!==n)throw new Error(`Can\'t initialize onnxruntime. error code = ${n}`)};const u=new Map;e.createSessionAllocate=t=>{const e=(0,o.getInstance)(),n=e._malloc(t.byteLength);return e.HEAPU8.set(t,n),[n,t.byteLength]},e.createSessionFinalize=(t,e)=>{const n=(0,o.getInstance)();let r=0,i=0,c=[];try{if([i,c]=(0,a.setSessionOptions)(e),r=n._OrtCreateSession(t[0],t[1],i),0===r)throw new Error("Can\'t create a session")}finally{n._free(t[0]),n._OrtReleaseSessionOptions(i),c.forEach(n._free)}const s=n._OrtGetInputCount(r),l=n._OrtGetOutputCount(r),f=[],p=[],h=[],d=[];for(let t=0;t<s;t++){const e=n._OrtGetInputName(r,t);if(0===e)throw new Error("Can\'t get an input name");p.push(e),f.push(n.UTF8ToString(e))}for(let t=0;t<l;t++){const e=n._OrtGetOutputName(r,t);if(0===e)throw new Error("Can\'t get an output name");d.push(e),h.push(n.UTF8ToString(e))}return u.set(r,[r,p,d]),[r,f,h]},e.createSession=(t,n)=>{const r=(0,e.createSessionAllocate)(t);return(0,e.createSessionFinalize)(r,n)},e.releaseSession=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=n[1],i=n[2];a.forEach(e._OrtFree),i.forEach(e._OrtFree),e._OrtReleaseSession(r),u.delete(t)};const c=t=>{switch(t){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${t}`)}},s=t=>{switch(t){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${t}`)}},l=t=>{switch(t){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${t}`)}};e.run=(t,e,n,a,f)=>{const p=(0,o.getInstance)(),h=u.get(t);if(!h)throw new Error("invalid session id");const d=h[0],y=h[1],b=h[2],m=e.length,g=a.length;let v=0,w=[];const _=[],O=[];try{[v,w]=(0,r.setRunOptions)(f);for(let t=0;t<m;t++){const e=n[t][0],r=n[t][1],a=n[t][2];let o,u;if(Array.isArray(a)){u=4*a.length,o=p._malloc(u),O.push(o);let t=o/4;for(let e=0;e<a.length;e++){if("string"!=typeof a[e])throw new TypeError(`tensor data at index ${e} is not a string`);p.HEAPU32[t++]=(0,i.allocWasmString)(a[e],O)}}else u=a.byteLength,o=p._malloc(u),O.push(o),p.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),o);const s=p.stackSave(),l=p.stackAlloc(4*r.length);try{let t=l/4;r.forEach((e=>p.HEAP32[t++]=e));const n=p._OrtCreateTensor(c(e),o,u,l,r.length);if(0===n)throw new Error("Can\'t create a tensor");_.push(n)}finally{p.stackRestore(s)}}const t=p.stackSave(),o=p.stackAlloc(4*m),u=p.stackAlloc(4*m),h=p.stackAlloc(4*g),A=p.stackAlloc(4*g);try{let n=o/4,r=u/4,i=h/4,c=A/4;for(let t=0;t<m;t++)p.HEAPU32[n++]=_[t],p.HEAPU32[r++]=y[e[t]];for(let t=0;t<g;t++)p.HEAPU32[i++]=0,p.HEAPU32[c++]=b[a[t]];let f=p._OrtRun(d,u,o,m,A,g,h,v);const w=[];if(0===f)for(let t=0;t<g;t++){const e=p.HEAPU32[h/4+t],n=p.stackSave(),r=p.stackAlloc(16);let a,i=0;try{if(f=p._OrtGetTensorData(e,r,r+4,r+8,r+12),0!==f)throw new Error(`Can\'t access output tensor data. error code = ${f}`);let t=r/4;const o=p.HEAPU32[t++];i=p.HEAPU32[t++];const u=p.HEAPU32[t++],c=p.HEAPU32[t++],h=[];for(let t=0;t<c;t++)h.push(p.HEAPU32[u/4+t]);p._OrtFree(u);const d=0===h.length?1:h.reduce(((t,e)=>t*e));if(a=s(o),"string"===a){const t=[];let e=i/4;for(let n=0;n<d;n++){const r=p.HEAPU32[e++],a=n===d-1?void 0:p.HEAPU32[e]-r;t.push(p.UTF8ToString(r,a))}w.push([a,h,t])}else{const t=new(l(a))(d);new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(p.HEAPU8.subarray(i,i+t.byteLength)),w.push([a,h,t])}}finally{p.stackRestore(n),"string"===a&&i&&p._free(i),p._OrtReleaseTensor(e)}}if(0===f)return w;throw new Error(`failed to call OrtRun(). error code = ${f}.`)}finally{p.stackRestore(t)}}finally{_.forEach(p._OrtReleaseTensor),O.forEach(p._free),p._OrtReleaseRunOptions(v),w.forEach(p._free)}},e.endProfiling=t=>{const e=(0,o.getInstance)(),n=u.get(t);if(!n)throw new Error("invalid session id");const r=n[0],a=e._OrtEndProfiling(r);if(0===a)throw new Error("Can\'t get an profile file name");e._OrtFree(a)},e.extractTransferableBuffers=t=>{const e=[];for(const n of t){const t=n[2];!Array.isArray(t)&&t.buffer&&e.push(t.buffer)}return e}},361:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,a)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return a(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.dispose=e.getInstance=e.initializeWebAssembly=void 0;const u=i(n(449)),c=o(n(932)),s=n(474);let l,f=!1,p=!1,h=!1;const d=(t,e)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":t?"ort-wasm-simd.wasm":"ort-wasm.wasm";e.initializeWebAssembly=async t=>{if(f)return Promise.resolve();if(p)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(h)throw new Error("previous call to \'initializeWebAssembly()\' failed.");p=!0;const e=t.initTimeout,r=t.numThreads,a=t.simd,i=r>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(t){return!1}})(),o=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(t){return!1}})(),y="string"==typeof t.wasmPaths?t.wasmPaths:void 0,b=d(!1,i),m=d(o,i),g="object"==typeof t.wasmPaths?t.wasmPaths[m]:void 0;let v=!1;const w=[];if(e>0&&w.push(new Promise((t=>{setTimeout((()=>{v=!0,t()}),e)}))),w.push(new Promise(((t,e)=>{const r=i?s:c.default,a={locateFile:(t,e)=>i&&t.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([n(154)],{type:"text/javascript"})):t===b?null!=g?g:(null!=y?y:e)+m:e+t};if(i)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=u.join("/","ort-wasm-threaded.js");else{const t=`var ortWasmThreaded=(function(){var _scriptDir;return ${r.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([t],{type:"text/javascript"})}r(a).then((e=>{p=!1,f=!0,l=e,t()}),(t=>{p=!1,h=!0,e(t)}))}))),await Promise.race(w),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},e.getInstance=()=>{if(f&&l)return l;throw new Error("WebAssembly is not initialized yet.")},e.dispose=()=>{var t;!f||p||h||(p=!0,null===(t=l.PThread)||void 0===t||t.terminateAllThreads(),l=void 0,p=!1,f=!1,h=!0)}},154:t=>{"use strict";t.exports=\'"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\\n\'},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";const t=n(349),e=n(361);self.onmessage=n=>{switch(n.data.type){case"init-wasm":(0,e.initializeWebAssembly)(n.data.in).then((()=>postMessage({type:"init-wasm"})),(t=>postMessage({type:"init-wasm",err:t})));break;case"init-ort":try{const{numThreads:e,loggingLevel:r}=n.data.in;(0,t.initOrt)(e,r),postMessage({type:"init-ort"})}catch(t){postMessage({type:"init-ort",err:t})}break;case"create_allocate":try{const{model:e}=n.data.in,r=(0,t.createSessionAllocate)(e);postMessage({type:"create_allocate",out:r})}catch(t){postMessage({type:"create_allocate",err:t})}break;case"create_finalize":try{const{modeldata:e,options:r}=n.data.in,a=(0,t.createSessionFinalize)(e,r);postMessage({type:"create_finalize",out:a})}catch(t){postMessage({type:"create_finalize",err:t})}break;case"create":try{const{model:e,options:r}=n.data.in,a=(0,t.createSession)(e,r);postMessage({type:"create",out:a})}catch(t){postMessage({type:"create",err:t})}break;case"release":try{const e=n.data.in;(0,t.releaseSession)(e),postMessage({type:"release"})}catch(t){postMessage({type:"release",err:t})}break;case"run":try{const{sessionId:e,inputIndices:r,inputs:a,outputIndices:i,options:o}=n.data.in,u=(0,t.run)(e,r,a,i,o);postMessage({type:"run",out:u},(0,t.extractTransferableBuffers)(u))}catch(t){postMessage({type:"run",err:t})}break;case"end-profiling":try{const e=n.data.in;(0,t.endProfiling)(e),postMessage({type:"end-profiling"})}catch(t){postMessage({type:"end-profiling",err:t})}}}})()})();\n',"Worker",void 0,void 0)}},477:s=>{s.exports=function(a,o,c,d){var tt=self||window;try{try{var nt;try{nt=new tt.Blob([a])}catch{(nt=new(tt.BlobBuilder||tt.WebKitBlobBuilder||tt.MozBlobBuilder||tt.MSBlobBuilder)).append(a),nt=nt.getBlob()}var it=tt.URL||tt.webkitURL,st=it.createObjectURL(nt),ut=new tt[o](st,c);return it.revokeObjectURL(st),ut}catch{return new tt[o]("data:application/javascript,".concat(encodeURIComponent(a)),c)}}catch{if(!d)throw Error("Inline worker is not supported");return new tt[o](d,c)}}},4154:s=>{s.exports=`"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};
`},1670:s=>{s.exports=__WEBPACK_EXTERNAL_MODULE__1670__},7067:()=>{},1296:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},5686:(s,a,o)=>{o.r(a),o.d(a,{flatbuffers:()=>c});var c={};c.Offset,c.Table,c.SIZEOF_SHORT=2,c.SIZEOF_INT=4,c.FILE_IDENTIFIER_LENGTH=4,c.SIZE_PREFIX_LENGTH=4,c.Encoding={UTF8_BYTES:1,UTF16_STRING:2},c.int32=new Int32Array(2),c.float32=new Float32Array(c.int32.buffer),c.float64=new Float64Array(c.int32.buffer),c.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,c.Long=function(d,tt){this.low=0|d,this.high=0|tt},c.Long.create=function(d,tt){return d==0&&tt==0?c.Long.ZERO:new c.Long(d,tt)},c.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},c.Long.prototype.equals=function(d){return this.low==d.low&&this.high==d.high},c.Long.ZERO=new c.Long(0,0),c.Builder=function(d){if(d)tt=d;else var tt=1024;this.bb=c.ByteBuffer.allocate(tt),this.space=tt,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},c.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},c.Builder.prototype.forceDefaults=function(d){this.force_defaults=d},c.Builder.prototype.dataBuffer=function(){return this.bb},c.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},c.Builder.prototype.prep=function(d,tt){d>this.minalign&&(this.minalign=d);for(var nt=1+~(this.bb.capacity()-this.space+tt)&d-1;this.space<nt+d+tt;){var it=this.bb.capacity();this.bb=c.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-it}this.pad(nt)},c.Builder.prototype.pad=function(d){for(var tt=0;tt<d;tt++)this.bb.writeInt8(--this.space,0)},c.Builder.prototype.writeInt8=function(d){this.bb.writeInt8(this.space-=1,d)},c.Builder.prototype.writeInt16=function(d){this.bb.writeInt16(this.space-=2,d)},c.Builder.prototype.writeInt32=function(d){this.bb.writeInt32(this.space-=4,d)},c.Builder.prototype.writeInt64=function(d){this.bb.writeInt64(this.space-=8,d)},c.Builder.prototype.writeFloat32=function(d){this.bb.writeFloat32(this.space-=4,d)},c.Builder.prototype.writeFloat64=function(d){this.bb.writeFloat64(this.space-=8,d)},c.Builder.prototype.addInt8=function(d){this.prep(1,0),this.writeInt8(d)},c.Builder.prototype.addInt16=function(d){this.prep(2,0),this.writeInt16(d)},c.Builder.prototype.addInt32=function(d){this.prep(4,0),this.writeInt32(d)},c.Builder.prototype.addInt64=function(d){this.prep(8,0),this.writeInt64(d)},c.Builder.prototype.addFloat32=function(d){this.prep(4,0),this.writeFloat32(d)},c.Builder.prototype.addFloat64=function(d){this.prep(8,0),this.writeFloat64(d)},c.Builder.prototype.addFieldInt8=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addInt8(tt),this.slot(d))},c.Builder.prototype.addFieldInt16=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addInt16(tt),this.slot(d))},c.Builder.prototype.addFieldInt32=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addInt32(tt),this.slot(d))},c.Builder.prototype.addFieldInt64=function(d,tt,nt){!this.force_defaults&&tt.equals(nt)||(this.addInt64(tt),this.slot(d))},c.Builder.prototype.addFieldFloat32=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addFloat32(tt),this.slot(d))},c.Builder.prototype.addFieldFloat64=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addFloat64(tt),this.slot(d))},c.Builder.prototype.addFieldOffset=function(d,tt,nt){(this.force_defaults||tt!=nt)&&(this.addOffset(tt),this.slot(d))},c.Builder.prototype.addFieldStruct=function(d,tt,nt){tt!=nt&&(this.nested(tt),this.slot(d))},c.Builder.prototype.nested=function(d){if(d!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},c.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},c.Builder.prototype.slot=function(d){this.vtable[d]=this.offset()},c.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},c.Builder.growByteBuffer=function(d){var tt=d.capacity();if(3221225472&tt)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var nt=tt<<1,it=c.ByteBuffer.allocate(nt);return it.setPosition(nt-tt),it.bytes().set(d.bytes(),nt-tt),it},c.Builder.prototype.addOffset=function(d){this.prep(c.SIZEOF_INT,0),this.writeInt32(this.offset()-d+c.SIZEOF_INT)},c.Builder.prototype.startObject=function(d){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=d;for(var tt=0;tt<d;tt++)this.vtable[tt]=0;this.isNested=!0,this.object_start=this.offset()},c.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var d=this.offset(),tt=this.vtable_in_use-1;tt>=0&&this.vtable[tt]==0;tt--);for(var nt=tt+1;tt>=0;tt--)this.addInt16(this.vtable[tt]!=0?d-this.vtable[tt]:0);this.addInt16(d-this.object_start);var it=(nt+2)*c.SIZEOF_SHORT;this.addInt16(it);var st=0,ut=this.space;e:for(tt=0;tt<this.vtables.length;tt++){var ct=this.bb.capacity()-this.vtables[tt];if(it==this.bb.readInt16(ct)){for(var ot=c.SIZEOF_SHORT;ot<it;ot+=c.SIZEOF_SHORT)if(this.bb.readInt16(ut+ot)!=this.bb.readInt16(ct+ot))continue e;st=this.vtables[tt];break}}return st?(this.space=this.bb.capacity()-d,this.bb.writeInt32(this.space,st-d)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-d,this.offset()-d)),this.isNested=!1,d},c.Builder.prototype.finish=function(d,tt,nt){var it=nt?c.SIZE_PREFIX_LENGTH:0;if(tt){var st=tt;if(this.prep(this.minalign,c.SIZEOF_INT+c.FILE_IDENTIFIER_LENGTH+it),st.length!=c.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+c.FILE_IDENTIFIER_LENGTH);for(var ut=c.FILE_IDENTIFIER_LENGTH-1;ut>=0;ut--)this.writeInt8(st.charCodeAt(ut))}this.prep(this.minalign,c.SIZEOF_INT+it),this.addOffset(d),it&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},c.Builder.prototype.finishSizePrefixed=function(d,tt){this.finish(d,tt,!0)},c.Builder.prototype.requiredField=function(d,tt){var nt=this.bb.capacity()-d,it=nt-this.bb.readInt32(nt);if(this.bb.readInt16(it+tt)==0)throw new Error("FlatBuffers: field "+tt+" must be set")},c.Builder.prototype.startVector=function(d,tt,nt){this.notNested(),this.vector_num_elems=tt,this.prep(c.SIZEOF_INT,d*tt),this.prep(nt,d*tt)},c.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},c.Builder.prototype.createString=function(d){if(d instanceof Uint8Array)var tt=d;else{tt=[];for(var nt=0;nt<d.length;){var it,st=d.charCodeAt(nt++);(it=st<55296||st>=56320?st:(st<<10)+d.charCodeAt(nt++)+-56613888)<128?tt.push(it):(it<2048?tt.push(it>>6&31|192):(it<65536?tt.push(it>>12&15|224):tt.push(it>>18&7|240,it>>12&63|128),tt.push(it>>6&63|128)),tt.push(63&it|128))}}this.addInt8(0),this.startVector(1,tt.length,1),this.bb.setPosition(this.space-=tt.length),nt=0;for(var ut=this.space,ct=this.bb.bytes();nt<tt.length;nt++)ct[ut++]=tt[nt];return this.endVector()},c.Builder.prototype.createLong=function(d,tt){return c.Long.create(d,tt)},c.ByteBuffer=function(d){this.bytes_=d,this.position_=0},c.ByteBuffer.allocate=function(d){return new c.ByteBuffer(new Uint8Array(d))},c.ByteBuffer.prototype.clear=function(){this.position_=0},c.ByteBuffer.prototype.bytes=function(){return this.bytes_},c.ByteBuffer.prototype.position=function(){return this.position_},c.ByteBuffer.prototype.setPosition=function(d){this.position_=d},c.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},c.ByteBuffer.prototype.readInt8=function(d){return this.readUint8(d)<<24>>24},c.ByteBuffer.prototype.readUint8=function(d){return this.bytes_[d]},c.ByteBuffer.prototype.readInt16=function(d){return this.readUint16(d)<<16>>16},c.ByteBuffer.prototype.readUint16=function(d){return this.bytes_[d]|this.bytes_[d+1]<<8},c.ByteBuffer.prototype.readInt32=function(d){return this.bytes_[d]|this.bytes_[d+1]<<8|this.bytes_[d+2]<<16|this.bytes_[d+3]<<24},c.ByteBuffer.prototype.readUint32=function(d){return this.readInt32(d)>>>0},c.ByteBuffer.prototype.readInt64=function(d){return new c.Long(this.readInt32(d),this.readInt32(d+4))},c.ByteBuffer.prototype.readUint64=function(d){return new c.Long(this.readUint32(d),this.readUint32(d+4))},c.ByteBuffer.prototype.readFloat32=function(d){return c.int32[0]=this.readInt32(d),c.float32[0]},c.ByteBuffer.prototype.readFloat64=function(d){return c.int32[c.isLittleEndian?0:1]=this.readInt32(d),c.int32[c.isLittleEndian?1:0]=this.readInt32(d+4),c.float64[0]},c.ByteBuffer.prototype.writeInt8=function(d,tt){this.bytes_[d]=tt},c.ByteBuffer.prototype.writeUint8=function(d,tt){this.bytes_[d]=tt},c.ByteBuffer.prototype.writeInt16=function(d,tt){this.bytes_[d]=tt,this.bytes_[d+1]=tt>>8},c.ByteBuffer.prototype.writeUint16=function(d,tt){this.bytes_[d]=tt,this.bytes_[d+1]=tt>>8},c.ByteBuffer.prototype.writeInt32=function(d,tt){this.bytes_[d]=tt,this.bytes_[d+1]=tt>>8,this.bytes_[d+2]=tt>>16,this.bytes_[d+3]=tt>>24},c.ByteBuffer.prototype.writeUint32=function(d,tt){this.bytes_[d]=tt,this.bytes_[d+1]=tt>>8,this.bytes_[d+2]=tt>>16,this.bytes_[d+3]=tt>>24},c.ByteBuffer.prototype.writeInt64=function(d,tt){this.writeInt32(d,tt.low),this.writeInt32(d+4,tt.high)},c.ByteBuffer.prototype.writeUint64=function(d,tt){this.writeUint32(d,tt.low),this.writeUint32(d+4,tt.high)},c.ByteBuffer.prototype.writeFloat32=function(d,tt){c.float32[0]=tt,this.writeInt32(d,c.int32[0])},c.ByteBuffer.prototype.writeFloat64=function(d,tt){c.float64[0]=tt,this.writeInt32(d,c.int32[c.isLittleEndian?0:1]),this.writeInt32(d+4,c.int32[c.isLittleEndian?1:0])},c.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+c.SIZEOF_INT+c.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var d="",tt=0;tt<c.FILE_IDENTIFIER_LENGTH;tt++)d+=String.fromCharCode(this.readInt8(this.position_+c.SIZEOF_INT+tt));return d},c.ByteBuffer.prototype.__offset=function(d,tt){var nt=d-this.readInt32(d);return tt<this.readInt16(nt)?this.readInt16(nt+tt):0},c.ByteBuffer.prototype.__union=function(d,tt){return d.bb_pos=tt+this.readInt32(tt),d.bb=this,d},c.ByteBuffer.prototype.__string=function(d,tt){d+=this.readInt32(d);var nt=this.readInt32(d),it="",st=0;if(d+=c.SIZEOF_INT,tt===c.Encoding.UTF8_BYTES)return this.bytes_.subarray(d,d+nt);for(;st<nt;){var ut,ct=this.readUint8(d+st++);if(ct<192)ut=ct;else{var ot=this.readUint8(d+st++);if(ct<224)ut=(31&ct)<<6|63&ot;else{var at=this.readUint8(d+st++);ut=ct<240?(15&ct)<<12|(63&ot)<<6|63&at:(7&ct)<<18|(63&ot)<<12|(63&at)<<6|63&this.readUint8(d+st++)}}ut<65536?it+=String.fromCharCode(ut):(ut-=65536,it+=String.fromCharCode(55296+(ut>>10),56320+(1023&ut)))}return it},c.ByteBuffer.prototype.__indirect=function(d){return d+this.readInt32(d)},c.ByteBuffer.prototype.__vector=function(d){return d+this.readInt32(d)+c.SIZEOF_INT},c.ByteBuffer.prototype.__vector_len=function(d){return this.readInt32(d+this.readInt32(d))},c.ByteBuffer.prototype.__has_identifier=function(d){if(d.length!=c.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+c.FILE_IDENTIFIER_LENGTH);for(var tt=0;tt<c.FILE_IDENTIFIER_LENGTH;tt++)if(d.charCodeAt(tt)!=this.readInt8(this.position_+c.SIZEOF_INT+tt))return!1;return!0},c.ByteBuffer.prototype.createLong=function(d,tt){return c.Long.create(d,tt)}}},__webpack_module_cache__={};function __webpack_require__(s){var a=__webpack_module_cache__[s];if(a!==void 0)return a.exports;var o=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=s=>{var a=s&&s.__esModule?()=>s.default:()=>s;return __webpack_require__.d(a,{a}),a},__webpack_require__.d=(s,a)=>{for(var o in a)__webpack_require__.o(a,o)&&!__webpack_require__.o(s,o)&&Object.defineProperty(s,o,{enumerable:!0,get:a[o]})},__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(s,a)=>Object.prototype.hasOwnProperty.call(s,a),__webpack_require__.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(6018);return __webpack_exports__})())})(ortWeb_min);var ortWeb_minExports=ortWeb_min.exports;const asset=s=>{const a="/traffic_collisions/".replace(/\/+$/,"/"),o=String(s).replace(/^\/+/,"");return a+o};function Landing(){const s=d=>{const tt=d.currentTarget,nt=tt.dataset.variant;tt.style.transform="translateY(-1px)",nt==="primary"?(tt.style.backgroundColor=palette$1.redBright,tt.style.borderColor=palette$1.redBright,tt.style.color=palette$1.white):(tt.style.backgroundColor=palette$1.charcoal,tt.style.borderColor=palette$1.charcoal,tt.style.color=palette$1.white)},a=d=>{const tt=d.currentTarget,nt=tt.dataset.variant;tt.style.transform="translateY(0)",nt==="primary"?(tt.style.backgroundColor=palette$1.redDeep,tt.style.borderColor=palette$1.redDeep,tt.style.color=palette$1.white):(tt.style.backgroundColor="transparent",tt.style.borderColor=palette$1.grey,tt.style.color=palette$1.grey)},o=d=>{d.currentTarget.style.transform="translateY(0)"},c=d=>{d.currentTarget.style.transform="translateY(-1px)"};return jsxRuntimeExports.jsxs("div",{style:container,children:[jsxRuntimeExports.jsxs("main",{style:main,children:[jsxRuntimeExports.jsxs("h1",{style:title,children:[jsxRuntimeExports.jsx("span",{style:mainSpan,children:"Montreal traffic collision data spatial analysis"})," ",jsxRuntimeExports.jsx("span",{style:yearSpan,children:"(2012–2021)"})]}),jsxRuntimeExports.jsxs("div",{style:buttonsRow,children:[jsxRuntimeExports.jsx(Link,{to:"/dashboard",style:{...btnBase,...btnPrimary},"aria-label":"Go to Dashboard","data-variant":"primary",onMouseEnter:s,onMouseLeave:a,onMouseDown:o,onMouseUp:c,children:"Dashboard"}),jsxRuntimeExports.jsx(Link,{to:"/model",style:{...btnBase,...btnGhost},"aria-label":"Go to Collision model","data-variant":"ghost",onMouseEnter:s,onMouseLeave:a,onMouseDown:o,onMouseUp:c,children:"Collision model"})]}),jsxRuntimeExports.jsx("div",{style:byline,children:"by Wukai Jiang"})]}),jsxRuntimeExports.jsx("footer",{style:footer,children:"data credit: Société de l'assurance automobile du Québec (SAAQ), Ville de Montréal"})]})}const palette$1={black:"#090909",charcoal:"#262626",redDeep:"#8E1616",redBright:"#D84040",grey:"#808080",white:"#FFFFFF"},container={fontFamily:"Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji",backgroundColor:palette$1.black,color:palette$1.white,minHeight:"100vh",display:"flex",flexDirection:"column"},main={flex:1,maxWidth:940,margin:"0 auto",padding:"64px 24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",gap:28},title={fontWeight:800,lineHeight:1.1,letterSpacing:"-0.02em",margin:0,fontSize:"clamp(28px, 4.2vw, 48px)",textTransform:"uppercase"},mainSpan={color:palette$1.redBright},yearSpan={fontWeight:700,color:palette$1.white},buttonsRow={display:"flex",gap:16,flexWrap:"wrap",alignItems:"center",justifyContent:"center"},btnBase={display:"inline-block",textDecoration:"none",padding:"14px 22px",borderRadius:12,fontSize:"1rem",fontWeight:700,letterSpacing:"0.02em",textTransform:"none",border:`1px solid ${palette$1.charcoal}`,transition:"transform 160ms ease, background-color 160ms ease, border-color 160ms ease, color 160ms ease",willChange:"transform"},btnPrimary={backgroundColor:palette$1.redDeep,borderColor:palette$1.redDeep,color:palette$1.white,boxShadow:"0 8px 24px rgba(216,64,64,0.20)",cursor:"pointer"},btnGhost={backgroundColor:"transparent",color:palette$1.grey,borderColor:palette$1.grey,cursor:"pointer"},byline={color:palette$1.grey,fontSize:"0.95rem",marginTop:8},footer={marginTop:"auto",textAlign:"center",padding:"20px 16px 28px",color:palette$1.grey,fontSize:"0.9rem",borderTop:`1px solid ${palette$1.charcoal}`},__vite_import_meta_env__$1={},createStoreImpl=s=>{let a;const o=new Set,c=(ct,ot)=>{const at=typeof ct=="function"?ct(a):ct;if(!Object.is(at,a)){const ht=a;a=ot??(typeof at!="object"||at===null)?at:Object.assign({},a,at),o.forEach(ft=>ft(a,ht))}},d=()=>a,st={setState:c,getState:d,getInitialState:()=>ut,subscribe:ct=>(o.add(ct),()=>o.delete(ct)),destroy:()=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},ut=a=s(c,d,st);return st},createStore=s=>s?createStoreImpl(s):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(s,a){var o=a(),c=useState({inst:{value:o,getSnapshot:a}}),d=c[0].inst,tt=c[1];return useLayoutEffect(function(){d.value=o,d.getSnapshot=a,checkIfSnapshotChanged(d)&&tt({inst:d})},[s,o,a]),useEffect$1(function(){return checkIfSnapshotChanged(d)&&tt({inst:d}),s(function(){checkIfSnapshotChanged(d)&&tt({inst:d})})},[s]),useDebugValue$2(o),o}function checkIfSnapshotChanged(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!objectIs$1(s,o)}catch{return!0}}function useSyncExternalStore$1(s,a){return a()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(s,a,o,c,d){var tt=useRef(null);if(tt.current===null){var nt={hasValue:!1,value:null};tt.current=nt}else nt=tt.current;tt=useMemo(function(){function st(ht){if(!ut){if(ut=!0,ct=ht,ht=c(ht),d!==void 0&&nt.hasValue){var ft=nt.value;if(d(ft,ht))return ot=ft}return ot=ht}if(ft=ot,objectIs(ct,ht))return ft;var mt=c(ht);return d!==void 0&&d(ft,mt)?(ct=ht,ft):(ct=ht,ot=mt)}var ut=!1,ct,ot,at=o===void 0?null:o;return[function(){return st(a())},at===null?void 0:function(){return st(at())}]},[a,o,c,d]);var it=useSyncExternalStore(s,tt[0],tt[1]);return useEffect(function(){nt.hasValue=!0,nt.value=it},[it]),useDebugValue$1(it),it};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity$1=s=>s;function useStore(s,a=identity$1,o){(__vite_import_meta_env__?"production":void 0)!=="production"&&o&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const c=useSyncExternalStoreWithSelector(s.subscribe,s.getState,s.getServerState||s.getInitialState,a,o);return useDebugValue(c),c}const createImpl=s=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof s=="function"?createStore(s):s,o=(c,d)=>useStore(a,c,d);return Object.assign(o,a),o},create$3=s=>s?createImpl(s):createImpl;function normalize$4(s){const a={};return Object.keys(s).forEach(o=>{const c=s[o];if(c==null){a[o]=void 0;return}Array.isArray(c)?a[o]=c.length?c.slice():void 0:a[o]=c}),a}const useFilters=create$3((s,a)=>({filters:{years:void 0,quarters:void 0,months:void 0,dows:void 0,severities:void 0,quartiers:void 0,arrs:void 0},setFilters:o=>s(c=>({filters:{...c.filters,...normalize$4(o)}})),clearKey:o=>s(c=>({filters:{...c.filters,[o]:void 0}})),clearAll:()=>s({filters:{}})}));var extendStatics$2=function(s,a){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},extendStatics$2(s,a)};function __extends$2(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");extendStatics$2(s,a);function o(){this.constructor=s}s.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}var __assign=function(){return __assign=Object.assign||function(a){for(var o,c=1,d=arguments.length;c<d;c++){o=arguments[c];for(var tt in o)Object.prototype.hasOwnProperty.call(o,tt)&&(a[tt]=o[tt])}return a},__assign.apply(this,arguments)};function __awaiter(s,a,o,c){function d(tt){return tt instanceof o?tt:new o(function(nt){nt(tt)})}return new(o||(o=Promise))(function(tt,nt){function it(ct){try{ut(c.next(ct))}catch(ot){nt(ot)}}function st(ct){try{ut(c.throw(ct))}catch(ot){nt(ot)}}function ut(ct){ct.done?tt(ct.value):d(ct.value).then(it,st)}ut((c=c.apply(s,a||[])).next())})}function __values(s){var a=typeof Symbol=="function"&&Symbol.iterator,o=a&&s[a],c=0;if(o)return o.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&c>=s.length&&(s=void 0),{value:s&&s[c++],done:!s}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function __await(s){return this instanceof __await?(this.v=s,this):new __await(s)}function __asyncGenerator(s,a,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=o.apply(s,a||[]),d,tt=[];return d=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),it("next"),it("throw"),it("return",nt),d[Symbol.asyncIterator]=function(){return this},d;function nt(ht){return function(ft){return Promise.resolve(ft).then(ht,ot)}}function it(ht,ft){c[ht]&&(d[ht]=function(mt){return new Promise(function(yt,bt){tt.push([ht,mt,yt,bt])>1||st(ht,mt)})},ft&&(d[ht]=ft(d[ht])))}function st(ht,ft){try{ut(c[ht](ft))}catch(mt){at(tt[0][3],mt)}}function ut(ht){ht.value instanceof __await?Promise.resolve(ht.value.v).then(ct,ot):at(tt[0][2],ht)}function ct(ht){st("next",ht)}function ot(ht){st("throw",ht)}function at(ht,ft){ht(ft),tt.shift(),tt.length&&st(tt[0][0],tt[0][1])}}function __asyncDelegator(s){var a,o;return a={},c("next"),c("throw",function(d){throw d}),c("return"),a[Symbol.iterator]=function(){return this},a;function c(d,tt){a[d]=s[d]?function(nt){return(o=!o)?{value:__await(s[d](nt)),done:!1}:tt?tt(nt):nt}:tt}}function __asyncValues(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=s[Symbol.asyncIterator],o;return a?a.call(s):(s=typeof __values=="function"?__values(s):s[Symbol.iterator](),o={},c("next"),c("throw"),c("return"),o[Symbol.asyncIterator]=function(){return this},o);function c(tt){o[tt]=s[tt]&&function(nt){return new Promise(function(it,st){nt=s[tt](nt),d(it,st,nt.done,nt.value)})}}function d(tt,nt,it,st){Promise.resolve(st).then(function(ut){tt({value:ut,done:it})},nt)}}typeof SuppressedError=="function"&&SuppressedError;const decoder=new TextDecoder("utf-8"),decodeUtf8=s=>decoder.decode(s),encoder=new TextEncoder,encodeUtf8=s=>encoder.encode(s),isNumber$1=s=>typeof s=="number",isBoolean=s=>typeof s=="boolean",isFunction$2=s=>typeof s=="function",isObject$4=s=>s!=null&&Object(s)===s,isPromise=s=>isObject$4(s)&&isFunction$2(s.then),isIterable=s=>isObject$4(s)&&isFunction$2(s[Symbol.iterator]),isAsyncIterable=s=>isObject$4(s)&&isFunction$2(s[Symbol.asyncIterator]),isArrowJSON=s=>isObject$4(s)&&isObject$4(s.schema),isIteratorResult=s=>isObject$4(s)&&"done"in s&&"value"in s,isFileHandle=s=>isObject$4(s)&&isFunction$2(s.stat)&&isNumber$1(s.fd),isFetchResponse=s=>isObject$4(s)&&isReadableDOMStream(s.body),isReadableInterop=s=>"_getDOMStream"in s&&"_getNodeStream"in s,isWritableDOMStream=s=>isObject$4(s)&&isFunction$2(s.abort)&&isFunction$2(s.getWriter)&&!isReadableInterop(s),isReadableDOMStream=s=>isObject$4(s)&&isFunction$2(s.cancel)&&isFunction$2(s.getReader)&&!isReadableInterop(s),isWritableNodeStream=s=>isObject$4(s)&&isFunction$2(s.end)&&isFunction$2(s.write)&&isBoolean(s.writable)&&!isReadableInterop(s),isReadableNodeStream=s=>isObject$4(s)&&isFunction$2(s.read)&&isFunction$2(s.pipe)&&isBoolean(s.readable)&&!isReadableInterop(s),isFlatbuffersByteBuffer=s=>isObject$4(s)&&isFunction$2(s.clear)&&isFunction$2(s.bytes)&&isFunction$2(s.position)&&isFunction$2(s.setPosition)&&isFunction$2(s.capacity)&&isFunction$2(s.getBufferIdentifier)&&isFunction$2(s.createLong),SharedArrayBuf=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function collapseContiguousByteRanges(s){const a=s[0]?[s[0]]:[];let o,c,d,tt;for(let nt,it,st=0,ut=0,ct=s.length;++st<ct;){if(nt=a[ut],it=s[st],!nt||!it||nt.buffer!==it.buffer||it.byteOffset<nt.byteOffset){it&&(a[++ut]=it);continue}if({byteOffset:o,byteLength:d}=nt,{byteOffset:c,byteLength:tt}=it,o+d<c||c+tt<o){it&&(a[++ut]=it);continue}a[ut]=new Uint8Array(nt.buffer,o,c-o+tt)}return a}function memcpy(s,a,o=0,c=a.byteLength){const d=s.byteLength,tt=new Uint8Array(s.buffer,s.byteOffset,d),nt=new Uint8Array(a.buffer,a.byteOffset,Math.min(c,d));return tt.set(nt,o),s}function joinUint8Arrays(s,a){const o=collapseContiguousByteRanges(s),c=o.reduce((ct,ot)=>ct+ot.byteLength,0);let d,tt,nt,it=0,st=-1;const ut=Math.min(a||Number.POSITIVE_INFINITY,c);for(const ct=o.length;++st<ct;){if(d=o[st],tt=d.subarray(0,Math.min(d.length,ut-it)),ut<=it+tt.length){tt.length<d.length?o[st]=d.subarray(tt.length):tt.length===d.length&&st++,nt?memcpy(nt,tt,it):nt=tt;break}memcpy(nt||(nt=new Uint8Array(ut)),tt,it),it+=tt.length}return[nt||new Uint8Array(0),o.slice(st),c-(nt?nt.byteLength:0)]}function toArrayBufferView(s,a){let o=isIteratorResult(a)?a.value:a;return o instanceof s?s===Uint8Array?new s(o.buffer,o.byteOffset,o.byteLength):o:o?(typeof o=="string"&&(o=encodeUtf8(o)),o instanceof ArrayBuffer?new s(o):o instanceof SharedArrayBuf?new s(o):isFlatbuffersByteBuffer(o)?toArrayBufferView(s,o.bytes()):ArrayBuffer.isView(o)?o.byteLength<=0?new s(0):new s(o.buffer,o.byteOffset,o.byteLength/s.BYTES_PER_ELEMENT):s.from(o)):new s(0)}const toInt32Array=s=>toArrayBufferView(Int32Array,s),toBigInt64Array=s=>toArrayBufferView(BigInt64Array,s),toUint8Array=s=>toArrayBufferView(Uint8Array,s),pump$1=s=>(s.next(),s);function*toArrayBufferViewIterator(s,a){const o=function*(d){yield d},c=typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof SharedArrayBuf?o(a):isIterable(a)?a:o(a);return yield*pump$1(function*(d){let tt=null;do tt=d.next(yield toArrayBufferView(s,tt));while(!tt.done)}(c[Symbol.iterator]())),new s}const toUint8ArrayIterator=s=>toArrayBufferViewIterator(Uint8Array,s);function toArrayBufferViewAsyncIterator(s,a){return __asyncGenerator(this,arguments,function*(){if(isPromise(a))return yield __await(yield __await(yield*__asyncDelegator(__asyncValues(toArrayBufferViewAsyncIterator(s,yield __await(a))))));const c=function(nt){return __asyncGenerator(this,arguments,function*(){yield yield __await(yield __await(nt))})},d=function(nt){return __asyncGenerator(this,arguments,function*(){yield __await(yield*__asyncDelegator(__asyncValues(pump$1(function*(it){let st=null;do st=it.next(yield st?.value);while(!st.done)}(nt[Symbol.iterator]())))))})},tt=typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof SharedArrayBuf?c(a):isIterable(a)?d(a):isAsyncIterable(a)?a:c(a);return yield __await(yield*__asyncDelegator(__asyncValues(pump$1(function(nt){return __asyncGenerator(this,arguments,function*(){let it=null;do it=yield __await(nt.next(yield yield __await(toArrayBufferView(s,it))));while(!it.done)})}(tt[Symbol.asyncIterator]()))))),yield __await(new s)})}const toUint8ArrayAsyncIterator=s=>toArrayBufferViewAsyncIterator(Uint8Array,s);function rebaseValueOffsets(s,a,o){if(s!==0){o=o.slice(0,a);for(let c=-1,d=o.length;++c<d;)o[c]+=s}return o.subarray(0,a)}function compareArrayLike(s,a){let o=0;const c=s.length;if(c!==a.length)return!1;if(c>0)do if(s[o]!==a[o])return!1;while(++o<c);return!0}const streamAdapters={fromIterable(s){return pump(fromIterable(s))},fromAsyncIterable(s){return pump(fromAsyncIterable(s))},fromDOMStream(s){return pump(fromDOMStream(s))},fromNodeStream(s){return pump(fromNodeStream(s))},toDOMStream(s,a){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(s,a){throw new Error('"toNodeStream" not available in this environment')}},pump=s=>(s.next(),s);function*fromIterable(s){let a,o=!1,c=[],d,tt,nt,it=0;function st(){return tt==="peek"?joinUint8Arrays(c,nt)[0]:([d,c,it]=joinUint8Arrays(c,nt),d)}({cmd:tt,size:nt}=(yield null)||{cmd:"read",size:0});const ut=toUint8ArrayIterator(s)[Symbol.iterator]();try{do if({done:a,value:d}=Number.isNaN(nt-it)?ut.next():ut.next(nt-it),!a&&d.byteLength>0&&(c.push(d),it+=d.byteLength),a||nt<=it)do({cmd:tt,size:nt}=yield st());while(nt<it);while(!a)}catch(ct){(o=!0)&&typeof ut.throw=="function"&&ut.throw(ct)}finally{o===!1&&typeof ut.return=="function"&&ut.return(null)}return null}function fromAsyncIterable(s){return __asyncGenerator(this,arguments,function*(){let o,c=!1,d=[],tt,nt,it,st=0;function ut(){return nt==="peek"?joinUint8Arrays(d,it)[0]:([tt,d,st]=joinUint8Arrays(d,it),tt)}({cmd:nt,size:it}=(yield yield __await(null))||{cmd:"read",size:0});const ct=toUint8ArrayAsyncIterator(s)[Symbol.asyncIterator]();try{do if({done:o,value:tt}=Number.isNaN(it-st)?yield __await(ct.next()):yield __await(ct.next(it-st)),!o&&tt.byteLength>0&&(d.push(tt),st+=tt.byteLength),o||it<=st)do({cmd:nt,size:it}=yield yield __await(ut()));while(it<st);while(!o)}catch(ot){(c=!0)&&typeof ct.throw=="function"&&(yield __await(ct.throw(ot)))}finally{c===!1&&typeof ct.return=="function"&&(yield __await(ct.return(new Uint8Array(0))))}return yield __await(null)})}function fromDOMStream(s){return __asyncGenerator(this,arguments,function*(){let o=!1,c=!1,d=[],tt,nt,it,st=0;function ut(){return nt==="peek"?joinUint8Arrays(d,it)[0]:([tt,d,st]=joinUint8Arrays(d,it),tt)}({cmd:nt,size:it}=(yield yield __await(null))||{cmd:"read",size:0});const ct=new AdaptiveByteReader(s);try{do if({done:o,value:tt}=Number.isNaN(it-st)?yield __await(ct.read()):yield __await(ct.read(it-st)),!o&&tt.byteLength>0&&(d.push(toUint8Array(tt)),st+=tt.byteLength),o||it<=st)do({cmd:nt,size:it}=yield yield __await(ut()));while(it<st);while(!o)}catch(ot){(c=!0)&&(yield __await(ct.cancel(ot)))}finally{c===!1?yield __await(ct.cancel()):s.locked&&ct.releaseLock()}return yield __await(null)})}class AdaptiveByteReader{constructor(a){this.source=a,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(a){return __awaiter(this,void 0,void 0,function*(){const{reader:o,source:c}=this;o&&(yield o.cancel(a).catch(()=>{})),c&&c.locked&&this.releaseLock()})}read(a){return __awaiter(this,void 0,void 0,function*(){if(a===0)return{done:this.reader==null,value:new Uint8Array(0)};const o=yield this.reader.read();return!o.done&&(o.value=toUint8Array(o)),o})}}const onEvent=(s,a)=>{const o=d=>c([a,d]);let c;return[a,o,new Promise(d=>(c=d)&&s.once(a,o))]};function fromNodeStream(s){return __asyncGenerator(this,arguments,function*(){const o=[];let c="error",d=!1,tt=null,nt,it,st=0,ut=[],ct;function ot(){return nt==="peek"?joinUint8Arrays(ut,it)[0]:([ct,ut,st]=joinUint8Arrays(ut,it),ct)}if({cmd:nt,size:it}=(yield yield __await(null))||{cmd:"read",size:0},s.isTTY)return yield yield __await(new Uint8Array(0)),yield __await(null);try{o[0]=onEvent(s,"end"),o[1]=onEvent(s,"error");do{if(o[2]=onEvent(s,"readable"),[c,tt]=yield __await(Promise.race(o.map(ht=>ht[2]))),c==="error")break;if((d=c==="end")||(Number.isFinite(it-st)?(ct=toUint8Array(s.read(it-st)),ct.byteLength<it-st&&(ct=toUint8Array(s.read()))):ct=toUint8Array(s.read()),ct.byteLength>0&&(ut.push(ct),st+=ct.byteLength)),d||it<=st)do({cmd:nt,size:it}=yield yield __await(ot()));while(it<st)}while(!d)}finally{yield __await(at(o,c==="error"?tt:null))}return yield __await(null);function at(ht,ft){return ct=ut=null,new Promise((mt,yt)=>{for(const[bt,wt]of ht)s.off(bt,wt);try{const bt=s.destroy;bt&&bt.call(s,ft),ft=void 0}catch(bt){ft=bt||ft}finally{ft!=null?yt(ft):mt()}})}})}var MetadataVersion;(function(s){s[s.V1=0]="V1",s[s.V2=1]="V2",s[s.V3=2]="V3",s[s.V4=3]="V4",s[s.V5=4]="V5"})(MetadataVersion||(MetadataVersion={}));var UnionMode;(function(s){s[s.Sparse=0]="Sparse",s[s.Dense=1]="Dense"})(UnionMode||(UnionMode={}));var Precision;(function(s){s[s.HALF=0]="HALF",s[s.SINGLE=1]="SINGLE",s[s.DOUBLE=2]="DOUBLE"})(Precision||(Precision={}));var DateUnit;(function(s){s[s.DAY=0]="DAY",s[s.MILLISECOND=1]="MILLISECOND"})(DateUnit||(DateUnit={}));var TimeUnit;(function(s){s[s.SECOND=0]="SECOND",s[s.MILLISECOND=1]="MILLISECOND",s[s.MICROSECOND=2]="MICROSECOND",s[s.NANOSECOND=3]="NANOSECOND"})(TimeUnit||(TimeUnit={}));var IntervalUnit;(function(s){s[s.YEAR_MONTH=0]="YEAR_MONTH",s[s.DAY_TIME=1]="DAY_TIME",s[s.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(IntervalUnit||(IntervalUnit={}));const SIZEOF_SHORT=2,SIZEOF_INT=4,FILE_IDENTIFIER_LENGTH=4,SIZE_PREFIX_LENGTH=4,int32=new Int32Array(2),float32=new Float32Array(int32.buffer),float64=new Float64Array(int32.buffer),isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Encoding;(function(s){s[s.UTF8_BYTES=1]="UTF8_BYTES",s[s.UTF16_STRING=2]="UTF16_STRING"})(Encoding||(Encoding={}));let ByteBuffer$2=class C1{constructor(a){this.bytes_=a,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(a){return new C1(new Uint8Array(a))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(a){this.position_=a}capacity(){return this.bytes_.length}readInt8(a){return this.readUint8(a)<<24>>24}readUint8(a){return this.bytes_[a]}readInt16(a){return this.readUint16(a)<<16>>16}readUint16(a){return this.bytes_[a]|this.bytes_[a+1]<<8}readInt32(a){return this.bytes_[a]|this.bytes_[a+1]<<8|this.bytes_[a+2]<<16|this.bytes_[a+3]<<24}readUint32(a){return this.readInt32(a)>>>0}readInt64(a){return BigInt.asIntN(64,BigInt(this.readUint32(a))+(BigInt(this.readUint32(a+4))<<BigInt(32)))}readUint64(a){return BigInt.asUintN(64,BigInt(this.readUint32(a))+(BigInt(this.readUint32(a+4))<<BigInt(32)))}readFloat32(a){return int32[0]=this.readInt32(a),float32[0]}readFloat64(a){return int32[isLittleEndian?0:1]=this.readInt32(a),int32[isLittleEndian?1:0]=this.readInt32(a+4),float64[0]}writeInt8(a,o){this.bytes_[a]=o}writeUint8(a,o){this.bytes_[a]=o}writeInt16(a,o){this.bytes_[a]=o,this.bytes_[a+1]=o>>8}writeUint16(a,o){this.bytes_[a]=o,this.bytes_[a+1]=o>>8}writeInt32(a,o){this.bytes_[a]=o,this.bytes_[a+1]=o>>8,this.bytes_[a+2]=o>>16,this.bytes_[a+3]=o>>24}writeUint32(a,o){this.bytes_[a]=o,this.bytes_[a+1]=o>>8,this.bytes_[a+2]=o>>16,this.bytes_[a+3]=o>>24}writeInt64(a,o){this.writeInt32(a,Number(BigInt.asIntN(32,o))),this.writeInt32(a+4,Number(BigInt.asIntN(32,o>>BigInt(32))))}writeUint64(a,o){this.writeUint32(a,Number(BigInt.asUintN(32,o))),this.writeUint32(a+4,Number(BigInt.asUintN(32,o>>BigInt(32))))}writeFloat32(a,o){float32[0]=o,this.writeInt32(a,int32[0])}writeFloat64(a,o){float64[0]=o,this.writeInt32(a,int32[isLittleEndian?0:1]),this.writeInt32(a+4,int32[isLittleEndian?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+SIZEOF_INT+FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let a="";for(let o=0;o<FILE_IDENTIFIER_LENGTH;o++)a+=String.fromCharCode(this.readInt8(this.position_+SIZEOF_INT+o));return a}__offset(a,o){const c=a-this.readInt32(a);return o<this.readInt16(c)?this.readInt16(c+o):0}__union(a,o){return a.bb_pos=o+this.readInt32(o),a.bb=this,a}__string(a,o){a+=this.readInt32(a);const c=this.readInt32(a);a+=SIZEOF_INT;const d=this.bytes_.subarray(a,a+c);return o===Encoding.UTF8_BYTES?d:this.text_decoder_.decode(d)}__union_with_string(a,o){return typeof a=="string"?this.__string(o):this.__union(a,o)}__indirect(a){return a+this.readInt32(a)}__vector(a){return a+this.readInt32(a)+SIZEOF_INT}__vector_len(a){return this.readInt32(a+this.readInt32(a))}__has_identifier(a){if(a.length!=FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+FILE_IDENTIFIER_LENGTH);for(let o=0;o<FILE_IDENTIFIER_LENGTH;o++)if(a.charCodeAt(o)!=this.readInt8(this.position()+SIZEOF_INT+o))return!1;return!0}createScalarList(a,o){const c=[];for(let d=0;d<o;++d){const tt=a(d);tt!==null&&c.push(tt)}return c}createObjList(a,o){const c=[];for(let d=0;d<o;++d){const tt=a(d);tt!==null&&c.push(tt.unpack())}return c}},Builder$2=class D1{constructor(a){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let o;a?o=a:o=1024,this.bb=ByteBuffer$2.allocate(o),this.space=o}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(a){this.force_defaults=a}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(a,o){a>this.minalign&&(this.minalign=a);const c=~(this.bb.capacity()-this.space+o)+1&a-1;for(;this.space<c+a+o;){const d=this.bb.capacity();this.bb=D1.growByteBuffer(this.bb),this.space+=this.bb.capacity()-d}this.pad(c)}pad(a){for(let o=0;o<a;o++)this.bb.writeInt8(--this.space,0)}writeInt8(a){this.bb.writeInt8(this.space-=1,a)}writeInt16(a){this.bb.writeInt16(this.space-=2,a)}writeInt32(a){this.bb.writeInt32(this.space-=4,a)}writeInt64(a){this.bb.writeInt64(this.space-=8,a)}writeFloat32(a){this.bb.writeFloat32(this.space-=4,a)}writeFloat64(a){this.bb.writeFloat64(this.space-=8,a)}addInt8(a){this.prep(1,0),this.writeInt8(a)}addInt16(a){this.prep(2,0),this.writeInt16(a)}addInt32(a){this.prep(4,0),this.writeInt32(a)}addInt64(a){this.prep(8,0),this.writeInt64(a)}addFloat32(a){this.prep(4,0),this.writeFloat32(a)}addFloat64(a){this.prep(8,0),this.writeFloat64(a)}addFieldInt8(a,o,c){(this.force_defaults||o!=c)&&(this.addInt8(o),this.slot(a))}addFieldInt16(a,o,c){(this.force_defaults||o!=c)&&(this.addInt16(o),this.slot(a))}addFieldInt32(a,o,c){(this.force_defaults||o!=c)&&(this.addInt32(o),this.slot(a))}addFieldInt64(a,o,c){(this.force_defaults||o!==c)&&(this.addInt64(o),this.slot(a))}addFieldFloat32(a,o,c){(this.force_defaults||o!=c)&&(this.addFloat32(o),this.slot(a))}addFieldFloat64(a,o,c){(this.force_defaults||o!=c)&&(this.addFloat64(o),this.slot(a))}addFieldOffset(a,o,c){(this.force_defaults||o!=c)&&(this.addOffset(o),this.slot(a))}addFieldStruct(a,o,c){o!=c&&(this.nested(o),this.slot(a))}nested(a){if(a!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(a){this.vtable!==null&&(this.vtable[a]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(a){const o=a.capacity();if(o&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const c=o<<1,d=ByteBuffer$2.allocate(c);return d.setPosition(c-o),d.bytes().set(a.bytes(),c-o),d}addOffset(a){this.prep(SIZEOF_INT,0),this.writeInt32(this.offset()-a+SIZEOF_INT)}startObject(a){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=a;for(let o=0;o<a;o++)this.vtable[o]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const a=this.offset();let o=this.vtable_in_use-1;for(;o>=0&&this.vtable[o]==0;o--);const c=o+1;for(;o>=0;o--)this.addInt16(this.vtable[o]!=0?a-this.vtable[o]:0);const d=2;this.addInt16(a-this.object_start);const tt=(c+d)*SIZEOF_SHORT;this.addInt16(tt);let nt=0;const it=this.space;e:for(o=0;o<this.vtables.length;o++){const st=this.bb.capacity()-this.vtables[o];if(tt==this.bb.readInt16(st)){for(let ut=SIZEOF_SHORT;ut<tt;ut+=SIZEOF_SHORT)if(this.bb.readInt16(it+ut)!=this.bb.readInt16(st+ut))continue e;nt=this.vtables[o];break}}return nt?(this.space=this.bb.capacity()-a,this.bb.writeInt32(this.space,nt-a)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-a,this.offset()-a)),this.isNested=!1,a}finish(a,o,c){const d=c?SIZE_PREFIX_LENGTH:0;if(o){const tt=o;if(this.prep(this.minalign,SIZEOF_INT+FILE_IDENTIFIER_LENGTH+d),tt.length!=FILE_IDENTIFIER_LENGTH)throw new TypeError("FlatBuffers: file identifier must be length "+FILE_IDENTIFIER_LENGTH);for(let nt=FILE_IDENTIFIER_LENGTH-1;nt>=0;nt--)this.writeInt8(tt.charCodeAt(nt))}this.prep(this.minalign,SIZEOF_INT+d),this.addOffset(a),d&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(a,o){this.finish(a,o,!0)}requiredField(a,o){const c=this.bb.capacity()-a,d=c-this.bb.readInt32(c);if(!(o<this.bb.readInt16(d)&&this.bb.readInt16(d+o)!=0))throw new TypeError("FlatBuffers: field "+o+" must be set")}startVector(a,o,c){this.notNested(),this.vector_num_elems=o,this.prep(SIZEOF_INT,a*o),this.prep(c,a*o)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(a){if(!a)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(a))return this.string_maps.get(a);const o=this.createString(a);return this.string_maps.set(a,o),o}createString(a){if(a==null)return 0;let o;return a instanceof Uint8Array?o=a:o=this.text_encoder.encode(a),this.addInt8(0),this.startVector(1,o.length,1),this.bb.setPosition(this.space-=o.length),this.bb.bytes().set(o,this.space),this.endVector()}createByteVector(a){return a==null?0:(this.startVector(1,a.length,1),this.bb.setPosition(this.space-=a.length),this.bb.bytes().set(a,this.space),this.endVector())}createObjectOffset(a){return a===null?0:typeof a=="string"?this.createString(a):a.pack(this)}createObjectOffsetList(a){const o=[];for(let c=0;c<a.length;++c){const d=a[c];if(d!==null)o.push(this.createObjectOffset(d));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return o}createStructOffsetList(a,o){return o(this,a.length),this.createObjectOffsetList(a.slice().reverse()),this.endVector()}};var BodyCompressionMethod;(function(s){s[s.BUFFER=0]="BUFFER"})(BodyCompressionMethod||(BodyCompressionMethod={}));var CompressionType;(function(s){s[s.LZ4_FRAME=0]="LZ4_FRAME",s[s.ZSTD=1]="ZSTD"})(CompressionType||(CompressionType={}));class BodyCompression{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsBodyCompression(a,o){return(o||new BodyCompression).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsBodyCompression(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new BodyCompression).__init(a.readInt32(a.position())+a.position(),a)}codec(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt8(this.bb_pos+a):CompressionType.LZ4_FRAME}method(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readInt8(this.bb_pos+a):BodyCompressionMethod.BUFFER}static startBodyCompression(a){a.startObject(2)}static addCodec(a,o){a.addFieldInt8(0,o,CompressionType.LZ4_FRAME)}static addMethod(a,o){a.addFieldInt8(1,o,BodyCompressionMethod.BUFFER)}static endBodyCompression(a){return a.endObject()}static createBodyCompression(a,o,c){return BodyCompression.startBodyCompression(a),BodyCompression.addCodec(a,o),BodyCompression.addMethod(a,c),BodyCompression.endBodyCompression(a)}}let Buffer$1=class{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(a,o,c){return a.prep(8,16),a.writeInt64(BigInt(c??0)),a.writeInt64(BigInt(o??0)),a.offset()}},FieldNode$1=class{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(a,o,c){return a.prep(8,16),a.writeInt64(BigInt(c??0)),a.writeInt64(BigInt(o??0)),a.offset()}},RecordBatch$2=class V_{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsRecordBatch(a,o){return(o||new V_).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsRecordBatch(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new V_).__init(a.readInt32(a.position())+a.position(),a)}length(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt64(this.bb_pos+a):BigInt("0")}nodes(a,o){const c=this.bb.__offset(this.bb_pos,6);return c?(o||new FieldNode$1).__init(this.bb.__vector(this.bb_pos+c)+a*16,this.bb):null}nodesLength(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}buffers(a,o){const c=this.bb.__offset(this.bb_pos,8);return c?(o||new Buffer$1).__init(this.bb.__vector(this.bb_pos+c)+a*16,this.bb):null}buffersLength(){const a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}compression(a){const o=this.bb.__offset(this.bb_pos,10);return o?(a||new BodyCompression).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}static startRecordBatch(a){a.startObject(4)}static addLength(a,o){a.addFieldInt64(0,o,BigInt("0"))}static addNodes(a,o){a.addFieldOffset(1,o,0)}static startNodesVector(a,o){a.startVector(16,o,8)}static addBuffers(a,o){a.addFieldOffset(2,o,0)}static startBuffersVector(a,o){a.startVector(16,o,8)}static addCompression(a,o){a.addFieldOffset(3,o,0)}static endRecordBatch(a){return a.endObject()}},DictionaryBatch$1=class U_{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsDictionaryBatch(a,o){return(o||new U_).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDictionaryBatch(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new U_).__init(a.readInt32(a.position())+a.position(),a)}id(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt64(this.bb_pos+a):BigInt("0")}data(a){const o=this.bb.__offset(this.bb_pos,6);return o?(a||new RecordBatch$2).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}isDelta(){const a=this.bb.__offset(this.bb_pos,8);return a?!!this.bb.readInt8(this.bb_pos+a):!1}static startDictionaryBatch(a){a.startObject(3)}static addId(a,o){a.addFieldInt64(0,o,BigInt("0"))}static addData(a,o){a.addFieldOffset(1,o,0)}static addIsDelta(a,o){a.addFieldInt8(2,+o,0)}static endDictionaryBatch(a){return a.endObject()}};var Endianness;(function(s){s[s.Little=0]="Little",s[s.Big=1]="Big"})(Endianness||(Endianness={}));var DictionaryKind;(function(s){s[s.DenseArray=0]="DenseArray"})(DictionaryKind||(DictionaryKind={}));class Int{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsInt(a,o){return(o||new Int).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsInt(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Int).__init(a.readInt32(a.position())+a.position(),a)}bitWidth(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}isSigned(){const a=this.bb.__offset(this.bb_pos,6);return a?!!this.bb.readInt8(this.bb_pos+a):!1}static startInt(a){a.startObject(2)}static addBitWidth(a,o){a.addFieldInt32(0,o,0)}static addIsSigned(a,o){a.addFieldInt8(1,+o,0)}static endInt(a){return a.endObject()}static createInt(a,o,c){return Int.startInt(a),Int.addBitWidth(a,o),Int.addIsSigned(a,c),Int.endInt(a)}}class DictionaryEncoding{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsDictionaryEncoding(a,o){return(o||new DictionaryEncoding).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDictionaryEncoding(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new DictionaryEncoding).__init(a.readInt32(a.position())+a.position(),a)}id(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt64(this.bb_pos+a):BigInt("0")}indexType(a){const o=this.bb.__offset(this.bb_pos,6);return o?(a||new Int).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}isOrdered(){const a=this.bb.__offset(this.bb_pos,8);return a?!!this.bb.readInt8(this.bb_pos+a):!1}dictionaryKind(){const a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readInt16(this.bb_pos+a):DictionaryKind.DenseArray}static startDictionaryEncoding(a){a.startObject(4)}static addId(a,o){a.addFieldInt64(0,o,BigInt("0"))}static addIndexType(a,o){a.addFieldOffset(1,o,0)}static addIsOrdered(a,o){a.addFieldInt8(2,+o,0)}static addDictionaryKind(a,o){a.addFieldInt16(3,o,DictionaryKind.DenseArray)}static endDictionaryEncoding(a){return a.endObject()}}class KeyValue{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsKeyValue(a,o){return(o||new KeyValue).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsKeyValue(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new KeyValue).__init(a.readInt32(a.position())+a.position(),a)}key(a){const o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__string(this.bb_pos+o,a):null}value(a){const o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__string(this.bb_pos+o,a):null}static startKeyValue(a){a.startObject(2)}static addKey(a,o){a.addFieldOffset(0,o,0)}static addValue(a,o){a.addFieldOffset(1,o,0)}static endKeyValue(a){return a.endObject()}static createKeyValue(a,o,c){return KeyValue.startKeyValue(a),KeyValue.addKey(a,o),KeyValue.addValue(a,c),KeyValue.endKeyValue(a)}}let Binary$1=class Pv{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsBinary(a,o){return(o||new Pv).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsBinary(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Pv).__init(a.readInt32(a.position())+a.position(),a)}static startBinary(a){a.startObject(0)}static endBinary(a){return a.endObject()}static createBinary(a){return Pv.startBinary(a),Pv.endBinary(a)}},Bool$1=class Mv{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsBool(a,o){return(o||new Mv).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsBool(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Mv).__init(a.readInt32(a.position())+a.position(),a)}static startBool(a){a.startObject(0)}static endBool(a){return a.endObject()}static createBool(a){return Mv.startBool(a),Mv.endBool(a)}},Date$1=class Im{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsDate(a,o){return(o||new Im).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDate(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Im).__init(a.readInt32(a.position())+a.position(),a)}unit(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):DateUnit.MILLISECOND}static startDate(a){a.startObject(1)}static addUnit(a,o){a.addFieldInt16(0,o,DateUnit.MILLISECOND)}static endDate(a){return a.endObject()}static createDate(a,o){return Im.startDate(a),Im.addUnit(a,o),Im.endDate(a)}},Decimal$1=class sp{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsDecimal(a,o){return(o||new sp).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDecimal(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new sp).__init(a.readInt32(a.position())+a.position(),a)}precision(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}scale(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readInt32(this.bb_pos+a):0}bitWidth(){const a=this.bb.__offset(this.bb_pos,8);return a?this.bb.readInt32(this.bb_pos+a):128}static startDecimal(a){a.startObject(3)}static addPrecision(a,o){a.addFieldInt32(0,o,0)}static addScale(a,o){a.addFieldInt32(1,o,0)}static addBitWidth(a,o){a.addFieldInt32(2,o,128)}static endDecimal(a){return a.endObject()}static createDecimal(a,o,c,d){return sp.startDecimal(a),sp.addPrecision(a,o),sp.addScale(a,c),sp.addBitWidth(a,d),sp.endDecimal(a)}},Duration$1=class Em{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsDuration(a,o){return(o||new Em).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsDuration(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Em).__init(a.readInt32(a.position())+a.position(),a)}unit(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):TimeUnit.MILLISECOND}static startDuration(a){a.startObject(1)}static addUnit(a,o){a.addFieldInt16(0,o,TimeUnit.MILLISECOND)}static endDuration(a){return a.endObject()}static createDuration(a,o){return Em.startDuration(a),Em.addUnit(a,o),Em.endDuration(a)}},FixedSizeBinary$1=class Cm{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsFixedSizeBinary(a,o){return(o||new Cm).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsFixedSizeBinary(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Cm).__init(a.readInt32(a.position())+a.position(),a)}byteWidth(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}static startFixedSizeBinary(a){a.startObject(1)}static addByteWidth(a,o){a.addFieldInt32(0,o,0)}static endFixedSizeBinary(a){return a.endObject()}static createFixedSizeBinary(a,o){return Cm.startFixedSizeBinary(a),Cm.addByteWidth(a,o),Cm.endFixedSizeBinary(a)}},FixedSizeList$1=class Dm{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsFixedSizeList(a,o){return(o||new Dm).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsFixedSizeList(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Dm).__init(a.readInt32(a.position())+a.position(),a)}listSize(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt32(this.bb_pos+a):0}static startFixedSizeList(a){a.startObject(1)}static addListSize(a,o){a.addFieldInt32(0,o,0)}static endFixedSizeList(a){return a.endObject()}static createFixedSizeList(a,o){return Dm.startFixedSizeList(a),Dm.addListSize(a,o),Dm.endFixedSizeList(a)}};class FloatingPoint{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsFloatingPoint(a,o){return(o||new FloatingPoint).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsFloatingPoint(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new FloatingPoint).__init(a.readInt32(a.position())+a.position(),a)}precision(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):Precision.HALF}static startFloatingPoint(a){a.startObject(1)}static addPrecision(a,o){a.addFieldInt16(0,o,Precision.HALF)}static endFloatingPoint(a){return a.endObject()}static createFloatingPoint(a,o){return FloatingPoint.startFloatingPoint(a),FloatingPoint.addPrecision(a,o),FloatingPoint.endFloatingPoint(a)}}class Interval{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsInterval(a,o){return(o||new Interval).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsInterval(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Interval).__init(a.readInt32(a.position())+a.position(),a)}unit(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):IntervalUnit.YEAR_MONTH}static startInterval(a){a.startObject(1)}static addUnit(a,o){a.addFieldInt16(0,o,IntervalUnit.YEAR_MONTH)}static endInterval(a){return a.endObject()}static createInterval(a,o){return Interval.startInterval(a),Interval.addUnit(a,o),Interval.endInterval(a)}}let LargeBinary$1=class Rv{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsLargeBinary(a,o){return(o||new Rv).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsLargeBinary(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Rv).__init(a.readInt32(a.position())+a.position(),a)}static startLargeBinary(a){a.startObject(0)}static endLargeBinary(a){return a.endObject()}static createLargeBinary(a){return Rv.startLargeBinary(a),Rv.endLargeBinary(a)}},LargeUtf8$1=class Lv{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsLargeUtf8(a,o){return(o||new Lv).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsLargeUtf8(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Lv).__init(a.readInt32(a.position())+a.position(),a)}static startLargeUtf8(a){a.startObject(0)}static endLargeUtf8(a){return a.endObject()}static createLargeUtf8(a){return Lv.startLargeUtf8(a),Lv.endLargeUtf8(a)}},List$1=class Ov{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsList(a,o){return(o||new Ov).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsList(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Ov).__init(a.readInt32(a.position())+a.position(),a)}static startList(a){a.startObject(0)}static endList(a){return a.endObject()}static createList(a){return Ov.startList(a),Ov.endList(a)}},Map$1=class Pm{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsMap(a,o){return(o||new Pm).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsMap(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Pm).__init(a.readInt32(a.position())+a.position(),a)}keysSorted(){const a=this.bb.__offset(this.bb_pos,4);return a?!!this.bb.readInt8(this.bb_pos+a):!1}static startMap(a){a.startObject(1)}static addKeysSorted(a,o){a.addFieldInt8(0,+o,0)}static endMap(a){return a.endObject()}static createMap(a,o){return Pm.startMap(a),Pm.addKeysSorted(a,o),Pm.endMap(a)}},Null$1=class $v{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsNull(a,o){return(o||new $v).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsNull(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new $v).__init(a.readInt32(a.position())+a.position(),a)}static startNull(a){a.startObject(0)}static endNull(a){return a.endObject()}static createNull(a){return $v.startNull(a),$v.endNull(a)}};class Struct_{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsStruct_(a,o){return(o||new Struct_).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsStruct_(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Struct_).__init(a.readInt32(a.position())+a.position(),a)}static startStruct_(a){a.startObject(0)}static endStruct_(a){return a.endObject()}static createStruct_(a){return Struct_.startStruct_(a),Struct_.endStruct_(a)}}class Time{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsTime(a,o){return(o||new Time).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsTime(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Time).__init(a.readInt32(a.position())+a.position(),a)}unit(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):TimeUnit.MILLISECOND}bitWidth(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readInt32(this.bb_pos+a):32}static startTime(a){a.startObject(2)}static addUnit(a,o){a.addFieldInt16(0,o,TimeUnit.MILLISECOND)}static addBitWidth(a,o){a.addFieldInt32(1,o,32)}static endTime(a){return a.endObject()}static createTime(a,o,c){return Time.startTime(a),Time.addUnit(a,o),Time.addBitWidth(a,c),Time.endTime(a)}}class Timestamp{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsTimestamp(a,o){return(o||new Timestamp).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsTimestamp(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Timestamp).__init(a.readInt32(a.position())+a.position(),a)}unit(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):TimeUnit.SECOND}timezone(a){const o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__string(this.bb_pos+o,a):null}static startTimestamp(a){a.startObject(2)}static addUnit(a,o){a.addFieldInt16(0,o,TimeUnit.SECOND)}static addTimezone(a,o){a.addFieldOffset(1,o,0)}static endTimestamp(a){return a.endObject()}static createTimestamp(a,o,c){return Timestamp.startTimestamp(a),Timestamp.addUnit(a,o),Timestamp.addTimezone(a,c),Timestamp.endTimestamp(a)}}class Union{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsUnion(a,o){return(o||new Union).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsUnion(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Union).__init(a.readInt32(a.position())+a.position(),a)}mode(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):UnionMode.Sparse}typeIds(a){const o=this.bb.__offset(this.bb_pos,6);return o?this.bb.readInt32(this.bb.__vector(this.bb_pos+o)+a*4):0}typeIdsLength(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}typeIdsArray(){const a=this.bb.__offset(this.bb_pos,6);return a?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+a),this.bb.__vector_len(this.bb_pos+a)):null}static startUnion(a){a.startObject(2)}static addMode(a,o){a.addFieldInt16(0,o,UnionMode.Sparse)}static addTypeIds(a,o){a.addFieldOffset(1,o,0)}static createTypeIdsVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addInt32(o[c]);return a.endVector()}static startTypeIdsVector(a,o){a.startVector(4,o,4)}static endUnion(a){return a.endObject()}static createUnion(a,o,c){return Union.startUnion(a),Union.addMode(a,o),Union.addTypeIds(a,c),Union.endUnion(a)}}let Utf8$1=class kv{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsUtf8(a,o){return(o||new kv).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsUtf8(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new kv).__init(a.readInt32(a.position())+a.position(),a)}static startUtf8(a){a.startObject(0)}static endUtf8(a){return a.endObject()}static createUtf8(a){return kv.startUtf8(a),kv.endUtf8(a)}};var Type$1;(function(s){s[s.NONE=0]="NONE",s[s.Null=1]="Null",s[s.Int=2]="Int",s[s.FloatingPoint=3]="FloatingPoint",s[s.Binary=4]="Binary",s[s.Utf8=5]="Utf8",s[s.Bool=6]="Bool",s[s.Decimal=7]="Decimal",s[s.Date=8]="Date",s[s.Time=9]="Time",s[s.Timestamp=10]="Timestamp",s[s.Interval=11]="Interval",s[s.List=12]="List",s[s.Struct_=13]="Struct_",s[s.Union=14]="Union",s[s.FixedSizeBinary=15]="FixedSizeBinary",s[s.FixedSizeList=16]="FixedSizeList",s[s.Map=17]="Map",s[s.Duration=18]="Duration",s[s.LargeBinary=19]="LargeBinary",s[s.LargeUtf8=20]="LargeUtf8",s[s.LargeList=21]="LargeList",s[s.RunEndEncoded=22]="RunEndEncoded"})(Type$1||(Type$1={}));let Field$1=class Oy{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsField(a,o){return(o||new Oy).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsField(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Oy).__init(a.readInt32(a.position())+a.position(),a)}name(a){const o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__string(this.bb_pos+o,a):null}nullable(){const a=this.bb.__offset(this.bb_pos,6);return a?!!this.bb.readInt8(this.bb_pos+a):!1}typeType(){const a=this.bb.__offset(this.bb_pos,8);return a?this.bb.readUint8(this.bb_pos+a):Type$1.NONE}type(a){const o=this.bb.__offset(this.bb_pos,10);return o?this.bb.__union(a,this.bb_pos+o):null}dictionary(a){const o=this.bb.__offset(this.bb_pos,12);return o?(a||new DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}children(a,o){const c=this.bb.__offset(this.bb_pos,14);return c?(o||new Oy).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}childrenLength(){const a=this.bb.__offset(this.bb_pos,14);return a?this.bb.__vector_len(this.bb_pos+a):0}customMetadata(a,o){const c=this.bb.__offset(this.bb_pos,16);return c?(o||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}customMetadataLength(){const a=this.bb.__offset(this.bb_pos,16);return a?this.bb.__vector_len(this.bb_pos+a):0}static startField(a){a.startObject(7)}static addName(a,o){a.addFieldOffset(0,o,0)}static addNullable(a,o){a.addFieldInt8(1,+o,0)}static addTypeType(a,o){a.addFieldInt8(2,o,Type$1.NONE)}static addType(a,o){a.addFieldOffset(3,o,0)}static addDictionary(a,o){a.addFieldOffset(4,o,0)}static addChildren(a,o){a.addFieldOffset(5,o,0)}static createChildrenVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startChildrenVector(a,o){a.startVector(4,o,4)}static addCustomMetadata(a,o){a.addFieldOffset(6,o,0)}static createCustomMetadataVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startCustomMetadataVector(a,o){a.startVector(4,o,4)}static endField(a){return a.endObject()}},Schema$1=class Ru{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsSchema(a,o){return(o||new Ru).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsSchema(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Ru).__init(a.readInt32(a.position())+a.position(),a)}endianness(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):Endianness.Little}fields(a,o){const c=this.bb.__offset(this.bb_pos,6);return c?(o||new Field$1).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}fieldsLength(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.__vector_len(this.bb_pos+a):0}customMetadata(a,o){const c=this.bb.__offset(this.bb_pos,8);return c?(o||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}customMetadataLength(){const a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}features(a){const o=this.bb.__offset(this.bb_pos,10);return o?this.bb.readInt64(this.bb.__vector(this.bb_pos+o)+a*8):BigInt(0)}featuresLength(){const a=this.bb.__offset(this.bb_pos,10);return a?this.bb.__vector_len(this.bb_pos+a):0}static startSchema(a){a.startObject(4)}static addEndianness(a,o){a.addFieldInt16(0,o,Endianness.Little)}static addFields(a,o){a.addFieldOffset(1,o,0)}static createFieldsVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startFieldsVector(a,o){a.startVector(4,o,4)}static addCustomMetadata(a,o){a.addFieldOffset(2,o,0)}static createCustomMetadataVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startCustomMetadataVector(a,o){a.startVector(4,o,4)}static addFeatures(a,o){a.addFieldOffset(3,o,0)}static createFeaturesVector(a,o){a.startVector(8,o.length,8);for(let c=o.length-1;c>=0;c--)a.addInt64(o[c]);return a.endVector()}static startFeaturesVector(a,o){a.startVector(8,o,8)}static endSchema(a){return a.endObject()}static finishSchemaBuffer(a,o){a.finish(o)}static finishSizePrefixedSchemaBuffer(a,o){a.finish(o,void 0,!0)}static createSchema(a,o,c,d,tt){return Ru.startSchema(a),Ru.addEndianness(a,o),Ru.addFields(a,c),Ru.addCustomMetadata(a,d),Ru.addFeatures(a,tt),Ru.endSchema(a)}};var MessageHeader;(function(s){s[s.NONE=0]="NONE",s[s.Schema=1]="Schema",s[s.DictionaryBatch=2]="DictionaryBatch",s[s.RecordBatch=3]="RecordBatch",s[s.Tensor=4]="Tensor",s[s.SparseTensor=5]="SparseTensor"})(MessageHeader||(MessageHeader={}));var Type;(function(s){s[s.NONE=0]="NONE",s[s.Null=1]="Null",s[s.Int=2]="Int",s[s.Float=3]="Float",s[s.Binary=4]="Binary",s[s.Utf8=5]="Utf8",s[s.Bool=6]="Bool",s[s.Decimal=7]="Decimal",s[s.Date=8]="Date",s[s.Time=9]="Time",s[s.Timestamp=10]="Timestamp",s[s.Interval=11]="Interval",s[s.List=12]="List",s[s.Struct=13]="Struct",s[s.Union=14]="Union",s[s.FixedSizeBinary=15]="FixedSizeBinary",s[s.FixedSizeList=16]="FixedSizeList",s[s.Map=17]="Map",s[s.Duration=18]="Duration",s[s.LargeBinary=19]="LargeBinary",s[s.LargeUtf8=20]="LargeUtf8",s[s.Dictionary=-1]="Dictionary",s[s.Int8=-2]="Int8",s[s.Int16=-3]="Int16",s[s.Int32=-4]="Int32",s[s.Int64=-5]="Int64",s[s.Uint8=-6]="Uint8",s[s.Uint16=-7]="Uint16",s[s.Uint32=-8]="Uint32",s[s.Uint64=-9]="Uint64",s[s.Float16=-10]="Float16",s[s.Float32=-11]="Float32",s[s.Float64=-12]="Float64",s[s.DateDay=-13]="DateDay",s[s.DateMillisecond=-14]="DateMillisecond",s[s.TimestampSecond=-15]="TimestampSecond",s[s.TimestampMillisecond=-16]="TimestampMillisecond",s[s.TimestampMicrosecond=-17]="TimestampMicrosecond",s[s.TimestampNanosecond=-18]="TimestampNanosecond",s[s.TimeSecond=-19]="TimeSecond",s[s.TimeMillisecond=-20]="TimeMillisecond",s[s.TimeMicrosecond=-21]="TimeMicrosecond",s[s.TimeNanosecond=-22]="TimeNanosecond",s[s.DenseUnion=-23]="DenseUnion",s[s.SparseUnion=-24]="SparseUnion",s[s.IntervalDayTime=-25]="IntervalDayTime",s[s.IntervalYearMonth=-26]="IntervalYearMonth",s[s.DurationSecond=-27]="DurationSecond",s[s.DurationMillisecond=-28]="DurationMillisecond",s[s.DurationMicrosecond=-29]="DurationMicrosecond",s[s.DurationNanosecond=-30]="DurationNanosecond"})(Type||(Type={}));var BufferType;(function(s){s[s.OFFSET=0]="OFFSET",s[s.DATA=1]="DATA",s[s.VALIDITY=2]="VALIDITY",s[s.TYPE=3]="TYPE"})(BufferType||(BufferType={}));const undf=void 0;function valueToString(s){if(s===null)return"null";if(s===undf)return"undefined";switch(typeof s){case"number":return`${s}`;case"bigint":return`${s}`;case"string":return`"${s}"`}return typeof s[Symbol.toPrimitive]=="function"?s[Symbol.toPrimitive]("string"):ArrayBuffer.isView(s)?s instanceof BigInt64Array||s instanceof BigUint64Array?`[${[...s].map(a=>valueToString(a))}]`:`[${s}]`:ArrayBuffer.isView(s)?`[${s}]`:JSON.stringify(s,(a,o)=>typeof o=="bigint"?`${o}`:o)}function bigIntToNumber(s){if(typeof s=="bigint"&&(s<Number.MIN_SAFE_INTEGER||s>Number.MAX_SAFE_INTEGER))throw new TypeError(`${s} is not safe to convert to a number.`);return Number(s)}function divideBigInts(s,a){return bigIntToNumber(s/a)+bigIntToNumber(s%a)/bigIntToNumber(a)}const isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function BigNum(s,...a){return a.length===0?Object.setPrototypeOf(toArrayBufferView(this.TypedArray,s),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(s,...a),this.constructor.prototype)}BigNum.prototype[isArrowBigNumSymbol]=!0;BigNum.prototype.toJSON=function(){return`"${bigNumToString(this)}"`};BigNum.prototype.valueOf=function(s){return bigNumToNumber(this,s)};BigNum.prototype.toString=function(){return bigNumToString(this)};BigNum.prototype[Symbol.toPrimitive]=function(s="default"){switch(s){case"number":return bigNumToNumber(this);case"string":return bigNumToString(this);case"default":return bigNumToBigInt(this)}return bigNumToString(this)};function SignedBigNum(...s){return BigNum.apply(this,s)}function UnsignedBigNum(...s){return BigNum.apply(this,s)}function DecimalBigNum(...s){return BigNum.apply(this,s)}Object.setPrototypeOf(SignedBigNum.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(UnsignedBigNum.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(DecimalBigNum.prototype,Object.create(Uint32Array.prototype));Object.assign(SignedBigNum.prototype,BigNum.prototype,{constructor:SignedBigNum,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(UnsignedBigNum.prototype,BigNum.prototype,{constructor:UnsignedBigNum,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(DecimalBigNum.prototype,BigNum.prototype,{constructor:DecimalBigNum,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const TWO_TO_THE_64=BigInt(4294967296)*BigInt(4294967296),TWO_TO_THE_64_MINUS_1=TWO_TO_THE_64-BigInt(1);function bigNumToNumber(s,a){const{buffer:o,byteOffset:c,byteLength:d,signed:tt}=s,nt=new BigUint64Array(o,c,d/8),it=tt&&nt.at(-1)&BigInt(1)<<BigInt(63);let st=BigInt(0),ut=0;if(it){for(const ct of nt)st|=(ct^TWO_TO_THE_64_MINUS_1)*(BigInt(1)<<BigInt(64*ut++));st*=BigInt(-1),st-=BigInt(1)}else for(const ct of nt)st|=ct*(BigInt(1)<<BigInt(64*ut++));if(typeof a=="number"){const ct=BigInt(Math.pow(10,a)),ot=st/ct,at=st%ct;return bigIntToNumber(ot)+bigIntToNumber(at)/bigIntToNumber(ct)}return bigIntToNumber(st)}function bigNumToString(s){if(s.byteLength===8)return`${new s.BigIntArray(s.buffer,s.byteOffset,1)[0]}`;if(!s.signed)return unsignedBigNumToString(s);let a=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2);if(new Int16Array([a.at(-1)])[0]>=0)return unsignedBigNumToString(s);a=a.slice();let c=1;for(let tt=0;tt<a.length;tt++){const nt=a[tt],it=~nt+c;a[tt]=it,c&=nt===0?1:0}return`-${unsignedBigNumToString(a)}`}function bigNumToBigInt(s){return s.byteLength===8?new s.BigIntArray(s.buffer,s.byteOffset,1)[0]:bigNumToString(s)}function unsignedBigNumToString(s){let a="";const o=new Uint32Array(2);let c=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2);const d=new Uint32Array((c=new Uint16Array(c).reverse()).buffer);let tt=-1;const nt=c.length-1;do{for(o[0]=c[tt=0];tt<nt;)c[tt++]=o[1]=o[0]/10,o[0]=(o[0]-o[1]*10<<16)+c[tt];c[tt]=o[1]=o[0]/10,o[0]=o[0]-o[1]*10,a=`${o[0]}${a}`}while(d[0]||d[1]||d[2]||d[3]);return a??"0"}class BN{static new(a,o){switch(o){case!0:return new SignedBigNum(a);case!1:return new UnsignedBigNum(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new SignedBigNum(a)}return a.byteLength===16?new DecimalBigNum(a):new UnsignedBigNum(a)}static signed(a){return new SignedBigNum(a)}static unsigned(a){return new UnsignedBigNum(a)}static decimal(a){return new DecimalBigNum(a)}constructor(a,o){return BN.new(a,o)}}var _a$5,_b$2,_c$1,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x;class DataType{static isNull(a){return a?.typeId===Type.Null}static isInt(a){return a?.typeId===Type.Int}static isFloat(a){return a?.typeId===Type.Float}static isBinary(a){return a?.typeId===Type.Binary}static isLargeBinary(a){return a?.typeId===Type.LargeBinary}static isUtf8(a){return a?.typeId===Type.Utf8}static isLargeUtf8(a){return a?.typeId===Type.LargeUtf8}static isBool(a){return a?.typeId===Type.Bool}static isDecimal(a){return a?.typeId===Type.Decimal}static isDate(a){return a?.typeId===Type.Date}static isTime(a){return a?.typeId===Type.Time}static isTimestamp(a){return a?.typeId===Type.Timestamp}static isInterval(a){return a?.typeId===Type.Interval}static isDuration(a){return a?.typeId===Type.Duration}static isList(a){return a?.typeId===Type.List}static isStruct(a){return a?.typeId===Type.Struct}static isUnion(a){return a?.typeId===Type.Union}static isFixedSizeBinary(a){return a?.typeId===Type.FixedSizeBinary}static isFixedSizeList(a){return a?.typeId===Type.FixedSizeList}static isMap(a){return a?.typeId===Type.Map}static isDictionary(a){return a?.typeId===Type.Dictionary}static isDenseUnion(a){return DataType.isUnion(a)&&a.mode===UnionMode.Dense}static isSparseUnion(a){return DataType.isUnion(a)&&a.mode===UnionMode.Sparse}constructor(a){this.typeId=a}}_a$5=Symbol.toStringTag;DataType[_a$5]=(s=>(s.children=null,s.ArrayType=Array,s.OffsetArrayType=Int32Array,s[Symbol.toStringTag]="DataType"))(DataType.prototype);class Null extends DataType{constructor(){super(Type.Null)}toString(){return"Null"}}_b$2=Symbol.toStringTag;Null[_b$2]=(s=>s[Symbol.toStringTag]="Null")(Null.prototype);class Int_ extends DataType{constructor(a,o){super(Type.Int),this.isSigned=a,this.bitWidth=o}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}_c$1=Symbol.toStringTag;Int_[_c$1]=(s=>(s.isSigned=null,s.bitWidth=null,s[Symbol.toStringTag]="Int"))(Int_.prototype);class Int32 extends Int_{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(Int32.prototype,"ArrayType",{value:Int32Array});class Float extends DataType{constructor(a){super(Type.Float),this.precision=a}get ArrayType(){switch(this.precision){case Precision.HALF:return Uint16Array;case Precision.SINGLE:return Float32Array;case Precision.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}_d=Symbol.toStringTag;Float[_d]=(s=>(s.precision=null,s[Symbol.toStringTag]="Float"))(Float.prototype);class Binary extends DataType{constructor(){super(Type.Binary)}toString(){return"Binary"}}_e=Symbol.toStringTag;Binary[_e]=(s=>(s.ArrayType=Uint8Array,s[Symbol.toStringTag]="Binary"))(Binary.prototype);class LargeBinary extends DataType{constructor(){super(Type.LargeBinary)}toString(){return"LargeBinary"}}_f=Symbol.toStringTag;LargeBinary[_f]=(s=>(s.ArrayType=Uint8Array,s.OffsetArrayType=BigInt64Array,s[Symbol.toStringTag]="LargeBinary"))(LargeBinary.prototype);class Utf8 extends DataType{constructor(){super(Type.Utf8)}toString(){return"Utf8"}}_g=Symbol.toStringTag;Utf8[_g]=(s=>(s.ArrayType=Uint8Array,s[Symbol.toStringTag]="Utf8"))(Utf8.prototype);class LargeUtf8 extends DataType{constructor(){super(Type.LargeUtf8)}toString(){return"LargeUtf8"}}_h=Symbol.toStringTag;LargeUtf8[_h]=(s=>(s.ArrayType=Uint8Array,s.OffsetArrayType=BigInt64Array,s[Symbol.toStringTag]="LargeUtf8"))(LargeUtf8.prototype);class Bool extends DataType{constructor(){super(Type.Bool)}toString(){return"Bool"}}_j=Symbol.toStringTag;Bool[_j]=(s=>(s.ArrayType=Uint8Array,s[Symbol.toStringTag]="Bool"))(Bool.prototype);class Decimal extends DataType{constructor(a,o,c=128){super(Type.Decimal),this.scale=a,this.precision=o,this.bitWidth=c}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}_k=Symbol.toStringTag;Decimal[_k]=(s=>(s.scale=null,s.precision=null,s.ArrayType=Uint32Array,s[Symbol.toStringTag]="Decimal"))(Decimal.prototype);class Date_ extends DataType{constructor(a){super(Type.Date),this.unit=a}toString(){return`Date${(this.unit+1)*32}<${DateUnit[this.unit]}>`}get ArrayType(){return this.unit===DateUnit.DAY?Int32Array:BigInt64Array}}_l=Symbol.toStringTag;Date_[_l]=(s=>(s.unit=null,s[Symbol.toStringTag]="Date"))(Date_.prototype);class Time_ extends DataType{constructor(a,o){super(Type.Time),this.unit=a,this.bitWidth=o}toString(){return`Time${this.bitWidth}<${TimeUnit[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}_m=Symbol.toStringTag;Time_[_m]=(s=>(s.unit=null,s.bitWidth=null,s[Symbol.toStringTag]="Time"))(Time_.prototype);class Timestamp_ extends DataType{constructor(a,o){super(Type.Timestamp),this.unit=a,this.timezone=o}toString(){return`Timestamp<${TimeUnit[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}_o=Symbol.toStringTag;Timestamp_[_o]=(s=>(s.unit=null,s.timezone=null,s.ArrayType=BigInt64Array,s[Symbol.toStringTag]="Timestamp"))(Timestamp_.prototype);class Interval_ extends DataType{constructor(a){super(Type.Interval),this.unit=a}toString(){return`Interval<${IntervalUnit[this.unit]}>`}}_p=Symbol.toStringTag;Interval_[_p]=(s=>(s.unit=null,s.ArrayType=Int32Array,s[Symbol.toStringTag]="Interval"))(Interval_.prototype);class Duration extends DataType{constructor(a){super(Type.Duration),this.unit=a}toString(){return`Duration<${TimeUnit[this.unit]}>`}}_q=Symbol.toStringTag;Duration[_q]=(s=>(s.unit=null,s.ArrayType=BigInt64Array,s[Symbol.toStringTag]="Duration"))(Duration.prototype);class List extends DataType{constructor(a){super(Type.List),this.children=[a]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}_r=Symbol.toStringTag;List[_r]=(s=>(s.children=null,s[Symbol.toStringTag]="List"))(List.prototype);class Struct extends DataType{constructor(a){super(Type.Struct),this.children=a}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}_s=Symbol.toStringTag;Struct[_s]=(s=>(s.children=null,s[Symbol.toStringTag]="Struct"))(Struct.prototype);class Union_ extends DataType{constructor(a,o,c){super(Type.Union),this.mode=a,this.children=c,this.typeIds=o=Int32Array.from(o),this.typeIdToChildIndex=o.reduce((d,tt,nt)=>(d[tt]=nt)&&d||d,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}_t=Symbol.toStringTag;Union_[_t]=(s=>(s.mode=null,s.typeIds=null,s.children=null,s.typeIdToChildIndex=null,s.ArrayType=Int8Array,s[Symbol.toStringTag]="Union"))(Union_.prototype);class FixedSizeBinary extends DataType{constructor(a){super(Type.FixedSizeBinary),this.byteWidth=a}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}_u=Symbol.toStringTag;FixedSizeBinary[_u]=(s=>(s.byteWidth=null,s.ArrayType=Uint8Array,s[Symbol.toStringTag]="FixedSizeBinary"))(FixedSizeBinary.prototype);class FixedSizeList extends DataType{constructor(a,o){super(Type.FixedSizeList),this.listSize=a,this.children=[o]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}_v=Symbol.toStringTag;FixedSizeList[_v]=(s=>(s.children=null,s.listSize=null,s[Symbol.toStringTag]="FixedSizeList"))(FixedSizeList.prototype);class Map_ extends DataType{constructor(a,o=!1){var c,d,tt;if(super(Type.Map),this.children=[a],this.keysSorted=o,a&&(a.name="entries",!((c=a?.type)===null||c===void 0)&&c.children)){const nt=(d=a?.type)===null||d===void 0?void 0:d.children[0];nt&&(nt.name="key");const it=(tt=a?.type)===null||tt===void 0?void 0:tt.children[1];it&&(it.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}_w=Symbol.toStringTag;Map_[_w]=(s=>(s.children=null,s.keysSorted=null,s[Symbol.toStringTag]="Map_"))(Map_.prototype);const getId$1=(s=>()=>++s)(-1);class Dictionary extends DataType{constructor(a,o,c,d){super(Type.Dictionary),this.indices=o,this.dictionary=a,this.isOrdered=d||!1,this.id=c==null?getId$1():bigIntToNumber(c)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}_x=Symbol.toStringTag;Dictionary[_x]=(s=>(s.id=null,s.indices=null,s.isOrdered=null,s.dictionary=null,s[Symbol.toStringTag]="Dictionary"))(Dictionary.prototype);function strideForType(s){const a=s;switch(s.typeId){case Type.Decimal:return s.bitWidth/32;case Type.Interval:return 1+a.unit;case Type.FixedSizeList:return a.listSize;case Type.FixedSizeBinary:return a.byteWidth;default:return 1}}class Visitor{visitMany(a,...o){return a.map((c,d)=>this.visit(c,...o.map(tt=>tt[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,o=!0){return getVisitFn(this,a,o)}getVisitFnByTypeId(a,o=!0){return getVisitFnByTypeId(this,a,o)}visitNull(a,...o){return null}visitBool(a,...o){return null}visitInt(a,...o){return null}visitFloat(a,...o){return null}visitUtf8(a,...o){return null}visitLargeUtf8(a,...o){return null}visitBinary(a,...o){return null}visitLargeBinary(a,...o){return null}visitFixedSizeBinary(a,...o){return null}visitDate(a,...o){return null}visitTimestamp(a,...o){return null}visitTime(a,...o){return null}visitDecimal(a,...o){return null}visitList(a,...o){return null}visitStruct(a,...o){return null}visitUnion(a,...o){return null}visitDictionary(a,...o){return null}visitInterval(a,...o){return null}visitDuration(a,...o){return null}visitFixedSizeList(a,...o){return null}visitMap(a,...o){return null}}function getVisitFn(s,a,o=!0){return typeof a=="number"?getVisitFnByTypeId(s,a,o):typeof a=="string"&&a in Type?getVisitFnByTypeId(s,Type[a],o):a&&a instanceof DataType?getVisitFnByTypeId(s,inferDType(a),o):a?.type&&a.type instanceof DataType?getVisitFnByTypeId(s,inferDType(a.type),o):getVisitFnByTypeId(s,Type.NONE,o)}function getVisitFnByTypeId(s,a,o=!0){let c=null;switch(a){case Type.Null:c=s.visitNull;break;case Type.Bool:c=s.visitBool;break;case Type.Int:c=s.visitInt;break;case Type.Int8:c=s.visitInt8||s.visitInt;break;case Type.Int16:c=s.visitInt16||s.visitInt;break;case Type.Int32:c=s.visitInt32||s.visitInt;break;case Type.Int64:c=s.visitInt64||s.visitInt;break;case Type.Uint8:c=s.visitUint8||s.visitInt;break;case Type.Uint16:c=s.visitUint16||s.visitInt;break;case Type.Uint32:c=s.visitUint32||s.visitInt;break;case Type.Uint64:c=s.visitUint64||s.visitInt;break;case Type.Float:c=s.visitFloat;break;case Type.Float16:c=s.visitFloat16||s.visitFloat;break;case Type.Float32:c=s.visitFloat32||s.visitFloat;break;case Type.Float64:c=s.visitFloat64||s.visitFloat;break;case Type.Utf8:c=s.visitUtf8;break;case Type.LargeUtf8:c=s.visitLargeUtf8;break;case Type.Binary:c=s.visitBinary;break;case Type.LargeBinary:c=s.visitLargeBinary;break;case Type.FixedSizeBinary:c=s.visitFixedSizeBinary;break;case Type.Date:c=s.visitDate;break;case Type.DateDay:c=s.visitDateDay||s.visitDate;break;case Type.DateMillisecond:c=s.visitDateMillisecond||s.visitDate;break;case Type.Timestamp:c=s.visitTimestamp;break;case Type.TimestampSecond:c=s.visitTimestampSecond||s.visitTimestamp;break;case Type.TimestampMillisecond:c=s.visitTimestampMillisecond||s.visitTimestamp;break;case Type.TimestampMicrosecond:c=s.visitTimestampMicrosecond||s.visitTimestamp;break;case Type.TimestampNanosecond:c=s.visitTimestampNanosecond||s.visitTimestamp;break;case Type.Time:c=s.visitTime;break;case Type.TimeSecond:c=s.visitTimeSecond||s.visitTime;break;case Type.TimeMillisecond:c=s.visitTimeMillisecond||s.visitTime;break;case Type.TimeMicrosecond:c=s.visitTimeMicrosecond||s.visitTime;break;case Type.TimeNanosecond:c=s.visitTimeNanosecond||s.visitTime;break;case Type.Decimal:c=s.visitDecimal;break;case Type.List:c=s.visitList;break;case Type.Struct:c=s.visitStruct;break;case Type.Union:c=s.visitUnion;break;case Type.DenseUnion:c=s.visitDenseUnion||s.visitUnion;break;case Type.SparseUnion:c=s.visitSparseUnion||s.visitUnion;break;case Type.Dictionary:c=s.visitDictionary;break;case Type.Interval:c=s.visitInterval;break;case Type.IntervalDayTime:c=s.visitIntervalDayTime||s.visitInterval;break;case Type.IntervalYearMonth:c=s.visitIntervalYearMonth||s.visitInterval;break;case Type.Duration:c=s.visitDuration;break;case Type.DurationSecond:c=s.visitDurationSecond||s.visitDuration;break;case Type.DurationMillisecond:c=s.visitDurationMillisecond||s.visitDuration;break;case Type.DurationMicrosecond:c=s.visitDurationMicrosecond||s.visitDuration;break;case Type.DurationNanosecond:c=s.visitDurationNanosecond||s.visitDuration;break;case Type.FixedSizeList:c=s.visitFixedSizeList;break;case Type.Map:c=s.visitMap;break}if(typeof c=="function")return c;if(!o)return()=>null;throw new Error(`Unrecognized type '${Type[a]}'`)}function inferDType(s){switch(s.typeId){case Type.Null:return Type.Null;case Type.Int:{const{bitWidth:a,isSigned:o}=s;switch(a){case 8:return o?Type.Int8:Type.Uint8;case 16:return o?Type.Int16:Type.Uint16;case 32:return o?Type.Int32:Type.Uint32;case 64:return o?Type.Int64:Type.Uint64}return Type.Int}case Type.Float:switch(s.precision){case Precision.HALF:return Type.Float16;case Precision.SINGLE:return Type.Float32;case Precision.DOUBLE:return Type.Float64}return Type.Float;case Type.Binary:return Type.Binary;case Type.LargeBinary:return Type.LargeBinary;case Type.Utf8:return Type.Utf8;case Type.LargeUtf8:return Type.LargeUtf8;case Type.Bool:return Type.Bool;case Type.Decimal:return Type.Decimal;case Type.Time:switch(s.unit){case TimeUnit.SECOND:return Type.TimeSecond;case TimeUnit.MILLISECOND:return Type.TimeMillisecond;case TimeUnit.MICROSECOND:return Type.TimeMicrosecond;case TimeUnit.NANOSECOND:return Type.TimeNanosecond}return Type.Time;case Type.Timestamp:switch(s.unit){case TimeUnit.SECOND:return Type.TimestampSecond;case TimeUnit.MILLISECOND:return Type.TimestampMillisecond;case TimeUnit.MICROSECOND:return Type.TimestampMicrosecond;case TimeUnit.NANOSECOND:return Type.TimestampNanosecond}return Type.Timestamp;case Type.Date:switch(s.unit){case DateUnit.DAY:return Type.DateDay;case DateUnit.MILLISECOND:return Type.DateMillisecond}return Type.Date;case Type.Interval:switch(s.unit){case IntervalUnit.DAY_TIME:return Type.IntervalDayTime;case IntervalUnit.YEAR_MONTH:return Type.IntervalYearMonth}return Type.Interval;case Type.Duration:switch(s.unit){case TimeUnit.SECOND:return Type.DurationSecond;case TimeUnit.MILLISECOND:return Type.DurationMillisecond;case TimeUnit.MICROSECOND:return Type.DurationMicrosecond;case TimeUnit.NANOSECOND:return Type.DurationNanosecond}return Type.Duration;case Type.Map:return Type.Map;case Type.List:return Type.List;case Type.Struct:return Type.Struct;case Type.Union:switch(s.mode){case UnionMode.Dense:return Type.DenseUnion;case UnionMode.Sparse:return Type.SparseUnion}return Type.Union;case Type.FixedSizeBinary:return Type.FixedSizeBinary;case Type.FixedSizeList:return Type.FixedSizeList;case Type.Dictionary:return Type.Dictionary}throw new Error(`Unrecognized type '${Type[s.typeId]}'`)}Visitor.prototype.visitInt8=null;Visitor.prototype.visitInt16=null;Visitor.prototype.visitInt32=null;Visitor.prototype.visitInt64=null;Visitor.prototype.visitUint8=null;Visitor.prototype.visitUint16=null;Visitor.prototype.visitUint32=null;Visitor.prototype.visitUint64=null;Visitor.prototype.visitFloat16=null;Visitor.prototype.visitFloat32=null;Visitor.prototype.visitFloat64=null;Visitor.prototype.visitDateDay=null;Visitor.prototype.visitDateMillisecond=null;Visitor.prototype.visitTimestampSecond=null;Visitor.prototype.visitTimestampMillisecond=null;Visitor.prototype.visitTimestampMicrosecond=null;Visitor.prototype.visitTimestampNanosecond=null;Visitor.prototype.visitTimeSecond=null;Visitor.prototype.visitTimeMillisecond=null;Visitor.prototype.visitTimeMicrosecond=null;Visitor.prototype.visitTimeNanosecond=null;Visitor.prototype.visitDenseUnion=null;Visitor.prototype.visitSparseUnion=null;Visitor.prototype.visitIntervalDayTime=null;Visitor.prototype.visitIntervalYearMonth=null;Visitor.prototype.visitDuration=null;Visitor.prototype.visitDurationSecond=null;Visitor.prototype.visitDurationMillisecond=null;Visitor.prototype.visitDurationMicrosecond=null;Visitor.prototype.visitDurationNanosecond=null;const f64=new Float64Array(1),u32=new Uint32Array(f64.buffer);function uint16ToFloat64(s){const a=(s&31744)>>10,o=(s&1023)/1024,c=Math.pow(-1,(s&32768)>>15);switch(a){case 31:return c*(o?Number.NaN:1/0);case 0:return c*(o?6103515625e-14*o:0)}return c*Math.pow(2,a-15)*(1+o)}function float64ToUint16(s){if(s!==s)return 32256;f64[0]=s;const a=(u32[1]&2147483648)>>16&65535;let o=u32[1]&2146435072,c=0;return o>=1089470464?u32[0]>0?o=31744:(o=(o&2080374784)>>16,c=(u32[1]&1048575)>>10):o<=1056964608?(c=1048576+(u32[1]&1048575),c=1048576+(c<<(o>>20)-998)>>21,o=0):(o=o-1056964608>>10,c=(u32[1]&1048575)+512>>10),a|o|c&65535}class SetVisitor extends Visitor{}function wrapSet(s){return(a,o,c)=>{if(a.setValid(o,c!=null))return s(a,o,c)}}const setEpochMsToDays=(s,a,o)=>{s[a]=Math.floor(o/864e5)},setVariableWidthBytes=(s,a,o,c)=>{if(o+1<a.length){const d=bigIntToNumber(a[o]),tt=bigIntToNumber(a[o+1]);s.set(c.subarray(0,tt-d),d)}},setBool=({offset:s,values:a},o,c)=>{const d=s+o;c?a[d>>3]|=1<<d%8:a[d>>3]&=~(1<<d%8)},setInt=({values:s},a,o)=>{s[a]=o},setFloat=({values:s},a,o)=>{s[a]=o},setFloat16=({values:s},a,o)=>{s[a]=float64ToUint16(o)},setAnyFloat=(s,a,o)=>{switch(s.type.precision){case Precision.HALF:return setFloat16(s,a,o);case Precision.SINGLE:case Precision.DOUBLE:return setFloat(s,a,o)}},setDateDay=({values:s},a,o)=>{setEpochMsToDays(s,a,o.valueOf())},setDateMillisecond=({values:s},a,o)=>{s[a]=BigInt(o)},setFixedSizeBinary=({stride:s,values:a},o,c)=>{a.set(c.subarray(0,s),s*o)},setBinary=({values:s,valueOffsets:a},o,c)=>setVariableWidthBytes(s,a,o,c),setUtf8=({values:s,valueOffsets:a},o,c)=>setVariableWidthBytes(s,a,o,encodeUtf8(c)),setDate=(s,a,o)=>{s.type.unit===DateUnit.DAY?setDateDay(s,a,o):setDateMillisecond(s,a,o)},setTimestampSecond=({values:s},a,o)=>{s[a]=BigInt(o/1e3)},setTimestampMillisecond=({values:s},a,o)=>{s[a]=BigInt(o)},setTimestampMicrosecond=({values:s},a,o)=>{s[a]=BigInt(o*1e3)},setTimestampNanosecond=({values:s},a,o)=>{s[a]=BigInt(o*1e6)},setTimestamp=(s,a,o)=>{switch(s.type.unit){case TimeUnit.SECOND:return setTimestampSecond(s,a,o);case TimeUnit.MILLISECOND:return setTimestampMillisecond(s,a,o);case TimeUnit.MICROSECOND:return setTimestampMicrosecond(s,a,o);case TimeUnit.NANOSECOND:return setTimestampNanosecond(s,a,o)}},setTimeSecond=({values:s},a,o)=>{s[a]=o},setTimeMillisecond=({values:s},a,o)=>{s[a]=o},setTimeMicrosecond=({values:s},a,o)=>{s[a]=o},setTimeNanosecond=({values:s},a,o)=>{s[a]=o},setTime=(s,a,o)=>{switch(s.type.unit){case TimeUnit.SECOND:return setTimeSecond(s,a,o);case TimeUnit.MILLISECOND:return setTimeMillisecond(s,a,o);case TimeUnit.MICROSECOND:return setTimeMicrosecond(s,a,o);case TimeUnit.NANOSECOND:return setTimeNanosecond(s,a,o)}},setDecimal=({values:s,stride:a},o,c)=>{s.set(c.subarray(0,a),a*o)},setList=(s,a,o)=>{const c=s.children[0],d=s.valueOffsets,tt=instance$5.getVisitFn(c);if(Array.isArray(o))for(let nt=-1,it=d[a],st=d[a+1];it<st;)tt(c,it++,o[++nt]);else for(let nt=-1,it=d[a],st=d[a+1];it<st;)tt(c,it++,o.get(++nt))},setMap=(s,a,o)=>{const c=s.children[0],{valueOffsets:d}=s,tt=instance$5.getVisitFn(c);let{[a]:nt,[a+1]:it}=d;const st=o instanceof Map?o.entries():Object.entries(o);for(const ut of st)if(tt(c,nt,ut),++nt>=it)break},_setStructArrayValue=(s,a)=>(o,c,d,tt)=>c&&o(c,s,a[tt]),_setStructVectorValue=(s,a)=>(o,c,d,tt)=>c&&o(c,s,a.get(tt)),_setStructMapValue=(s,a)=>(o,c,d,tt)=>c&&o(c,s,a.get(d.name)),_setStructObjectValue=(s,a)=>(o,c,d,tt)=>c&&o(c,s,a[d.name]),setStruct=(s,a,o)=>{const c=s.type.children.map(tt=>instance$5.getVisitFn(tt.type)),d=o instanceof Map?_setStructMapValue(a,o):o instanceof Vector?_setStructVectorValue(a,o):Array.isArray(o)?_setStructArrayValue(a,o):_setStructObjectValue(a,o);s.type.children.forEach((tt,nt)=>d(c[nt],s.children[nt],tt,nt))},setUnion=(s,a,o)=>{s.type.mode===UnionMode.Dense?setDenseUnion(s,a,o):setSparseUnion(s,a,o)},setDenseUnion=(s,a,o)=>{const c=s.type.typeIdToChildIndex[s.typeIds[a]],d=s.children[c];instance$5.visit(d,s.valueOffsets[a],o)},setSparseUnion=(s,a,o)=>{const c=s.type.typeIdToChildIndex[s.typeIds[a]],d=s.children[c];instance$5.visit(d,a,o)},setDictionary=(s,a,o)=>{var c;(c=s.dictionary)===null||c===void 0||c.set(s.values[a],o)},setIntervalValue=(s,a,o)=>{s.type.unit===IntervalUnit.DAY_TIME?setIntervalDayTime(s,a,o):setIntervalYearMonth(s,a,o)},setIntervalDayTime=({values:s},a,o)=>{s.set(o.subarray(0,2),2*a)},setIntervalYearMonth=({values:s},a,o)=>{s[a]=o[0]*12+o[1]%12},setDurationSecond=({values:s},a,o)=>{s[a]=o},setDurationMillisecond=({values:s},a,o)=>{s[a]=o},setDurationMicrosecond=({values:s},a,o)=>{s[a]=o},setDurationNanosecond=({values:s},a,o)=>{s[a]=o},setDuration=(s,a,o)=>{switch(s.type.unit){case TimeUnit.SECOND:return setDurationSecond(s,a,o);case TimeUnit.MILLISECOND:return setDurationMillisecond(s,a,o);case TimeUnit.MICROSECOND:return setDurationMicrosecond(s,a,o);case TimeUnit.NANOSECOND:return setDurationNanosecond(s,a,o)}},setFixedSizeList=(s,a,o)=>{const{stride:c}=s,d=s.children[0],tt=instance$5.getVisitFn(d);if(Array.isArray(o))for(let nt=-1,it=a*c;++nt<c;)tt(d,it+nt,o[nt]);else for(let nt=-1,it=a*c;++nt<c;)tt(d,it+nt,o.get(nt))};SetVisitor.prototype.visitBool=wrapSet(setBool);SetVisitor.prototype.visitInt=wrapSet(setInt);SetVisitor.prototype.visitInt8=wrapSet(setInt);SetVisitor.prototype.visitInt16=wrapSet(setInt);SetVisitor.prototype.visitInt32=wrapSet(setInt);SetVisitor.prototype.visitInt64=wrapSet(setInt);SetVisitor.prototype.visitUint8=wrapSet(setInt);SetVisitor.prototype.visitUint16=wrapSet(setInt);SetVisitor.prototype.visitUint32=wrapSet(setInt);SetVisitor.prototype.visitUint64=wrapSet(setInt);SetVisitor.prototype.visitFloat=wrapSet(setAnyFloat);SetVisitor.prototype.visitFloat16=wrapSet(setFloat16);SetVisitor.prototype.visitFloat32=wrapSet(setFloat);SetVisitor.prototype.visitFloat64=wrapSet(setFloat);SetVisitor.prototype.visitUtf8=wrapSet(setUtf8);SetVisitor.prototype.visitLargeUtf8=wrapSet(setUtf8);SetVisitor.prototype.visitBinary=wrapSet(setBinary);SetVisitor.prototype.visitLargeBinary=wrapSet(setBinary);SetVisitor.prototype.visitFixedSizeBinary=wrapSet(setFixedSizeBinary);SetVisitor.prototype.visitDate=wrapSet(setDate);SetVisitor.prototype.visitDateDay=wrapSet(setDateDay);SetVisitor.prototype.visitDateMillisecond=wrapSet(setDateMillisecond);SetVisitor.prototype.visitTimestamp=wrapSet(setTimestamp);SetVisitor.prototype.visitTimestampSecond=wrapSet(setTimestampSecond);SetVisitor.prototype.visitTimestampMillisecond=wrapSet(setTimestampMillisecond);SetVisitor.prototype.visitTimestampMicrosecond=wrapSet(setTimestampMicrosecond);SetVisitor.prototype.visitTimestampNanosecond=wrapSet(setTimestampNanosecond);SetVisitor.prototype.visitTime=wrapSet(setTime);SetVisitor.prototype.visitTimeSecond=wrapSet(setTimeSecond);SetVisitor.prototype.visitTimeMillisecond=wrapSet(setTimeMillisecond);SetVisitor.prototype.visitTimeMicrosecond=wrapSet(setTimeMicrosecond);SetVisitor.prototype.visitTimeNanosecond=wrapSet(setTimeNanosecond);SetVisitor.prototype.visitDecimal=wrapSet(setDecimal);SetVisitor.prototype.visitList=wrapSet(setList);SetVisitor.prototype.visitStruct=wrapSet(setStruct);SetVisitor.prototype.visitUnion=wrapSet(setUnion);SetVisitor.prototype.visitDenseUnion=wrapSet(setDenseUnion);SetVisitor.prototype.visitSparseUnion=wrapSet(setSparseUnion);SetVisitor.prototype.visitDictionary=wrapSet(setDictionary);SetVisitor.prototype.visitInterval=wrapSet(setIntervalValue);SetVisitor.prototype.visitIntervalDayTime=wrapSet(setIntervalDayTime);SetVisitor.prototype.visitIntervalYearMonth=wrapSet(setIntervalYearMonth);SetVisitor.prototype.visitDuration=wrapSet(setDuration);SetVisitor.prototype.visitDurationSecond=wrapSet(setDurationSecond);SetVisitor.prototype.visitDurationMillisecond=wrapSet(setDurationMillisecond);SetVisitor.prototype.visitDurationMicrosecond=wrapSet(setDurationMicrosecond);SetVisitor.prototype.visitDurationNanosecond=wrapSet(setDurationNanosecond);SetVisitor.prototype.visitFixedSizeList=wrapSet(setFixedSizeList);SetVisitor.prototype.visitMap=wrapSet(setMap);const instance$5=new SetVisitor,kParent=Symbol.for("parent"),kRowIndex=Symbol.for("rowIndex");class StructRow{constructor(a,o){return this[kParent]=a,this[kRowIndex]=o,new Proxy(this,new StructRowProxyHandler)}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[kRowIndex],o=this[kParent],c=o.type.children,d={};for(let tt=-1,nt=c.length;++tt<nt;)d[c[tt].name]=instance$4.visit(o.children[tt],a);return d}toString(){return`{${[...this].map(([a,o])=>`${valueToString(a)}: ${valueToString(o)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new StructRowIterator(this[kParent],this[kRowIndex])}}class StructRowIterator{constructor(a,o){this.childIndex=0,this.children=a.children,this.rowIndex=o,this.childFields=a.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const a=this.childIndex;return a<this.numChildren?(this.childIndex=a+1,{done:!1,value:[this.childFields[a].name,instance$4.visit(this.children[a],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(StructRow.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[kParent]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kRowIndex]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class StructRowProxyHandler{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[kParent].type.children.map(o=>o.name)}has(a,o){return a[kParent].type.children.findIndex(c=>c.name===o)!==-1}getOwnPropertyDescriptor(a,o){if(a[kParent].type.children.findIndex(c=>c.name===o)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(a,o){if(Reflect.has(a,o))return a[o];const c=a[kParent].type.children.findIndex(d=>d.name===o);if(c!==-1){const d=instance$4.visit(a[kParent].children[c],a[kRowIndex]);return Reflect.set(a,o,d),d}}set(a,o,c){const d=a[kParent].type.children.findIndex(tt=>tt.name===o);return d!==-1?(instance$5.visit(a[kParent].children[d],a[kRowIndex],c),Reflect.set(a,o,c)):Reflect.has(a,o)||typeof o=="symbol"?Reflect.set(a,o,c):!1}}class GetVisitor extends Visitor{}function wrapGet(s){return(a,o)=>a.getValid(o)?s(a,o):null}const epochDaysToMs=(s,a)=>864e5*s[a],getNull=(s,a)=>null,getVariableWidthBytes=(s,a,o)=>{if(o+1>=a.length)return null;const c=bigIntToNumber(a[o]),d=bigIntToNumber(a[o+1]);return s.subarray(c,d)},getBool$1=({offset:s,values:a},o)=>{const c=s+o;return(a[c>>3]&1<<c%8)!==0},getDateDay=({values:s},a)=>epochDaysToMs(s,a),getDateMillisecond=({values:s},a)=>bigIntToNumber(s[a]),getNumeric=({stride:s,values:a},o)=>a[s*o],getFloat16=({stride:s,values:a},o)=>uint16ToFloat64(a[s*o]),getBigInts=({values:s},a)=>s[a],getFixedSizeBinary=({stride:s,values:a},o)=>a.subarray(s*o,s*(o+1)),getBinary=({values:s,valueOffsets:a},o)=>getVariableWidthBytes(s,a,o),getUtf8=({values:s,valueOffsets:a},o)=>{const c=getVariableWidthBytes(s,a,o);return c!==null?decodeUtf8(c):null},getInt=({values:s},a)=>s[a],getFloat=({type:s,values:a},o)=>s.precision!==Precision.HALF?a[o]:uint16ToFloat64(a[o]),getDate=(s,a)=>s.type.unit===DateUnit.DAY?getDateDay(s,a):getDateMillisecond(s,a),getTimestampSecond=({values:s},a)=>1e3*bigIntToNumber(s[a]),getTimestampMillisecond=({values:s},a)=>bigIntToNumber(s[a]),getTimestampMicrosecond=({values:s},a)=>divideBigInts(s[a],BigInt(1e3)),getTimestampNanosecond=({values:s},a)=>divideBigInts(s[a],BigInt(1e6)),getTimestamp=(s,a)=>{switch(s.type.unit){case TimeUnit.SECOND:return getTimestampSecond(s,a);case TimeUnit.MILLISECOND:return getTimestampMillisecond(s,a);case TimeUnit.MICROSECOND:return getTimestampMicrosecond(s,a);case TimeUnit.NANOSECOND:return getTimestampNanosecond(s,a)}},getTimeSecond=({values:s},a)=>s[a],getTimeMillisecond=({values:s},a)=>s[a],getTimeMicrosecond=({values:s},a)=>s[a],getTimeNanosecond=({values:s},a)=>s[a],getTime$1=(s,a)=>{switch(s.type.unit){case TimeUnit.SECOND:return getTimeSecond(s,a);case TimeUnit.MILLISECOND:return getTimeMillisecond(s,a);case TimeUnit.MICROSECOND:return getTimeMicrosecond(s,a);case TimeUnit.NANOSECOND:return getTimeNanosecond(s,a)}},getDecimal=({values:s,stride:a},o)=>BN.decimal(s.subarray(a*o,a*(o+1))),getList=(s,a)=>{const{valueOffsets:o,stride:c,children:d}=s,{[a*c]:tt,[a*c+1]:nt}=o,st=d[0].slice(tt,nt-tt);return new Vector([st])},getMap$1=(s,a)=>{const{valueOffsets:o,children:c}=s,{[a]:d,[a+1]:tt}=o,nt=c[0];return new MapRow(nt.slice(d,tt-d))},getStruct=(s,a)=>new StructRow(s,a),getUnion=(s,a)=>s.type.mode===UnionMode.Dense?getDenseUnion(s,a):getSparseUnion(s,a),getDenseUnion=(s,a)=>{const o=s.type.typeIdToChildIndex[s.typeIds[a]],c=s.children[o];return instance$4.visit(c,s.valueOffsets[a])},getSparseUnion=(s,a)=>{const o=s.type.typeIdToChildIndex[s.typeIds[a]],c=s.children[o];return instance$4.visit(c,a)},getDictionary=(s,a)=>{var o;return(o=s.dictionary)===null||o===void 0?void 0:o.get(s.values[a])},getInterval=(s,a)=>s.type.unit===IntervalUnit.DAY_TIME?getIntervalDayTime(s,a):getIntervalYearMonth(s,a),getIntervalDayTime=({values:s},a)=>s.subarray(2*a,2*(a+1)),getIntervalYearMonth=({values:s},a)=>{const o=s[a],c=new Int32Array(2);return c[0]=Math.trunc(o/12),c[1]=Math.trunc(o%12),c},getDurationSecond=({values:s},a)=>s[a],getDurationMillisecond=({values:s},a)=>s[a],getDurationMicrosecond=({values:s},a)=>s[a],getDurationNanosecond=({values:s},a)=>s[a],getDuration=(s,a)=>{switch(s.type.unit){case TimeUnit.SECOND:return getDurationSecond(s,a);case TimeUnit.MILLISECOND:return getDurationMillisecond(s,a);case TimeUnit.MICROSECOND:return getDurationMicrosecond(s,a);case TimeUnit.NANOSECOND:return getDurationNanosecond(s,a)}},getFixedSizeList=(s,a)=>{const{stride:o,children:c}=s,tt=c[0].slice(a*o,o);return new Vector([tt])};GetVisitor.prototype.visitNull=wrapGet(getNull);GetVisitor.prototype.visitBool=wrapGet(getBool$1);GetVisitor.prototype.visitInt=wrapGet(getInt);GetVisitor.prototype.visitInt8=wrapGet(getNumeric);GetVisitor.prototype.visitInt16=wrapGet(getNumeric);GetVisitor.prototype.visitInt32=wrapGet(getNumeric);GetVisitor.prototype.visitInt64=wrapGet(getBigInts);GetVisitor.prototype.visitUint8=wrapGet(getNumeric);GetVisitor.prototype.visitUint16=wrapGet(getNumeric);GetVisitor.prototype.visitUint32=wrapGet(getNumeric);GetVisitor.prototype.visitUint64=wrapGet(getBigInts);GetVisitor.prototype.visitFloat=wrapGet(getFloat);GetVisitor.prototype.visitFloat16=wrapGet(getFloat16);GetVisitor.prototype.visitFloat32=wrapGet(getNumeric);GetVisitor.prototype.visitFloat64=wrapGet(getNumeric);GetVisitor.prototype.visitUtf8=wrapGet(getUtf8);GetVisitor.prototype.visitLargeUtf8=wrapGet(getUtf8);GetVisitor.prototype.visitBinary=wrapGet(getBinary);GetVisitor.prototype.visitLargeBinary=wrapGet(getBinary);GetVisitor.prototype.visitFixedSizeBinary=wrapGet(getFixedSizeBinary);GetVisitor.prototype.visitDate=wrapGet(getDate);GetVisitor.prototype.visitDateDay=wrapGet(getDateDay);GetVisitor.prototype.visitDateMillisecond=wrapGet(getDateMillisecond);GetVisitor.prototype.visitTimestamp=wrapGet(getTimestamp);GetVisitor.prototype.visitTimestampSecond=wrapGet(getTimestampSecond);GetVisitor.prototype.visitTimestampMillisecond=wrapGet(getTimestampMillisecond);GetVisitor.prototype.visitTimestampMicrosecond=wrapGet(getTimestampMicrosecond);GetVisitor.prototype.visitTimestampNanosecond=wrapGet(getTimestampNanosecond);GetVisitor.prototype.visitTime=wrapGet(getTime$1);GetVisitor.prototype.visitTimeSecond=wrapGet(getTimeSecond);GetVisitor.prototype.visitTimeMillisecond=wrapGet(getTimeMillisecond);GetVisitor.prototype.visitTimeMicrosecond=wrapGet(getTimeMicrosecond);GetVisitor.prototype.visitTimeNanosecond=wrapGet(getTimeNanosecond);GetVisitor.prototype.visitDecimal=wrapGet(getDecimal);GetVisitor.prototype.visitList=wrapGet(getList);GetVisitor.prototype.visitStruct=wrapGet(getStruct);GetVisitor.prototype.visitUnion=wrapGet(getUnion);GetVisitor.prototype.visitDenseUnion=wrapGet(getDenseUnion);GetVisitor.prototype.visitSparseUnion=wrapGet(getSparseUnion);GetVisitor.prototype.visitDictionary=wrapGet(getDictionary);GetVisitor.prototype.visitInterval=wrapGet(getInterval);GetVisitor.prototype.visitIntervalDayTime=wrapGet(getIntervalDayTime);GetVisitor.prototype.visitIntervalYearMonth=wrapGet(getIntervalYearMonth);GetVisitor.prototype.visitDuration=wrapGet(getDuration);GetVisitor.prototype.visitDurationSecond=wrapGet(getDurationSecond);GetVisitor.prototype.visitDurationMillisecond=wrapGet(getDurationMillisecond);GetVisitor.prototype.visitDurationMicrosecond=wrapGet(getDurationMicrosecond);GetVisitor.prototype.visitDurationNanosecond=wrapGet(getDurationNanosecond);GetVisitor.prototype.visitFixedSizeList=wrapGet(getFixedSizeList);GetVisitor.prototype.visitMap=wrapGet(getMap$1);const instance$4=new GetVisitor,kKeys=Symbol.for("keys"),kVals=Symbol.for("vals"),kKeysAsStrings=Symbol.for("kKeysAsStrings"),_kKeysAsStrings=Symbol.for("_kKeysAsStrings");class MapRow{constructor(a){return this[kKeys]=new Vector([a.children[0]]).memoize(),this[kVals]=a.children[1],new Proxy(this,new MapRowProxyHandler)}get[kKeysAsStrings](){return this[_kKeysAsStrings]||(this[_kKeysAsStrings]=Array.from(this[kKeys].toArray(),String))}[Symbol.iterator](){return new MapRowIterator(this[kKeys],this[kVals])}get size(){return this[kKeys].length}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[kKeys],o=this[kVals],c={};for(let d=-1,tt=a.length;++d<tt;)c[a.get(d)]=instance$4.visit(o,d);return c}toString(){return`{${[...this].map(([a,o])=>`${valueToString(a)}: ${valueToString(o)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class MapRowIterator{constructor(a,o){this.keys=a,this.vals=o,this.keyIndex=0,this.numKeys=a.length}[Symbol.iterator](){return this}next(){const a=this.keyIndex;return a===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(a),instance$4.visit(this.vals,a)]})}}class MapRowProxyHandler{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[kKeysAsStrings]}has(a,o){return a[kKeysAsStrings].includes(o)}getOwnPropertyDescriptor(a,o){if(a[kKeysAsStrings].indexOf(o)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(a,o){if(Reflect.has(a,o))return a[o];const c=a[kKeysAsStrings].indexOf(o);if(c!==-1){const d=instance$4.visit(Reflect.get(a,kVals),c);return Reflect.set(a,o,d),d}}set(a,o,c){const d=a[kKeysAsStrings].indexOf(o);return d!==-1?(instance$5.visit(Reflect.get(a,kVals),d,c),Reflect.set(a,o,c)):Reflect.has(a,o)?Reflect.set(a,o,c):!1}}Object.defineProperties(MapRow.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[kKeys]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kVals]:{writable:!0,enumerable:!1,configurable:!1,value:null},[_kKeysAsStrings]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let tmp;function clampRange(s,a,o,c){const{length:d=0}=s;let tt=typeof a!="number"?0:a,nt=typeof o!="number"?d:o;return tt<0&&(tt=(tt%d+d)%d),nt<0&&(nt=(nt%d+d)%d),nt<tt&&(tmp=tt,tt=nt,nt=tmp),nt>d&&(nt=d),c?c(s,tt,nt):[tt,nt]}const wrapIndex=(s,a)=>s<0?a+s:s,isNaNFast=s=>s!==s;function createElementComparator(s){if(typeof s!=="object"||s===null)return isNaNFast(s)?isNaNFast:o=>o===s;if(s instanceof Date){const o=s.valueOf();return c=>c instanceof Date?c.valueOf()===o:!1}return ArrayBuffer.isView(s)?o=>o?compareArrayLike(s,o):!1:s instanceof Map?createMapComparator(s):Array.isArray(s)?createArrayLikeComparator(s):s instanceof Vector?createVectorComparator(s):createObjectComparator(s,!0)}function createArrayLikeComparator(s){const a=[];for(let o=-1,c=s.length;++o<c;)a[o]=createElementComparator(s[o]);return createSubElementsComparator(a)}function createMapComparator(s){let a=-1;const o=[];for(const c of s.values())o[++a]=createElementComparator(c);return createSubElementsComparator(o)}function createVectorComparator(s){const a=[];for(let o=-1,c=s.length;++o<c;)a[o]=createElementComparator(s.get(o));return createSubElementsComparator(a)}function createObjectComparator(s,a=!1){const o=Object.keys(s);if(!a&&o.length===0)return()=>!1;const c=[];for(let d=-1,tt=o.length;++d<tt;)c[d]=createElementComparator(s[o[d]]);return createSubElementsComparator(c,o)}function createSubElementsComparator(s,a){return o=>{if(!o||typeof o!="object")return!1;switch(o.constructor){case Array:return compareArray(s,o);case Map:return compareObject(s,o,o.keys());case MapRow:case StructRow:case Object:case void 0:return compareObject(s,o,a||Object.keys(o))}return o instanceof Vector?compareVector(s,o):!1}}function compareArray(s,a){const o=s.length;if(a.length!==o)return!1;for(let c=-1;++c<o;)if(!s[c](a[c]))return!1;return!0}function compareVector(s,a){const o=s.length;if(a.length!==o)return!1;for(let c=-1;++c<o;)if(!s[c](a.get(c)))return!1;return!0}function compareObject(s,a,o){const c=o[Symbol.iterator](),d=a instanceof Map?a.keys():Object.keys(a)[Symbol.iterator](),tt=a instanceof Map?a.values():Object.values(a)[Symbol.iterator]();let nt=0;const it=s.length;let st=tt.next(),ut=c.next(),ct=d.next();for(;nt<it&&!ut.done&&!ct.done&&!st.done&&!(ut.value!==ct.value||!s[nt](st.value));++nt,ut=c.next(),ct=d.next(),st=tt.next());return nt===it&&ut.done&&ct.done&&st.done?!0:(c.return&&c.return(),d.return&&d.return(),tt.return&&tt.return(),!1)}function getBool(s,a,o,c){return(o&1<<c)!==0}function getBit(s,a,o,c){return(o&1<<c)>>c}function truncateBitmap(s,a,o){const c=o.byteLength+7&-8;if(s>0||o.byteLength<c){const d=new Uint8Array(c);return d.set(s%8===0?o.subarray(s>>3):packBools(new BitIterator(o,s,a,null,getBool)).subarray(0,c)),d}return o}function packBools(s){const a=[];let o=0,c=0,d=0;for(const nt of s)nt&&(d|=1<<c),++c===8&&(a[o++]=d,d=c=0);(o===0||c>0)&&(a[o++]=d);const tt=new Uint8Array(a.length+7&-8);return tt.set(a),tt}class BitIterator{constructor(a,o,c,d,tt){this.bytes=a,this.length=c,this.context=d,this.get=tt,this.bit=o%8,this.byteIndex=o>>3,this.byte=a[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function popcnt_bit_range(s,a,o){if(o-a<=0)return 0;if(o-a<8){let tt=0;for(const nt of new BitIterator(s,a,o-a,s,getBit))tt+=nt;return tt}const c=o>>3<<3,d=a+(a%8===0?0:8-a%8);return popcnt_bit_range(s,a,d)+popcnt_bit_range(s,c,o)+popcnt_array(s,d>>3,c-d>>3)}function popcnt_array(s,a,o){let c=0,d=Math.trunc(a);const tt=new DataView(s.buffer,s.byteOffset,s.byteLength),nt=o===void 0?s.byteLength:d+o;for(;nt-d>=4;)c+=popcnt_uint32(tt.getUint32(d)),d+=4;for(;nt-d>=2;)c+=popcnt_uint32(tt.getUint16(d)),d+=2;for(;nt-d>=1;)c+=popcnt_uint32(tt.getUint8(d)),d+=1;return c}function popcnt_uint32(s){let a=Math.trunc(s);return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),(a+(a>>>4)&252645135)*16843009>>>24}const kUnknownNullCount=-1;class Data{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:a}=this;return DataType.isSparseUnion(a)?this.children.some(o=>o.nullable):DataType.isDenseUnion(a)?this.children.some(o=>o.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let a=0;const{valueOffsets:o,values:c,nullBitmap:d,typeIds:tt}=this;return o&&(a+=o.byteLength),c&&(a+=c.byteLength),d&&(a+=d.byteLength),tt&&(a+=tt.byteLength),this.children.reduce((nt,it)=>nt+it.byteLength,a)}get nullCount(){if(DataType.isUnion(this.type))return this.children.reduce((c,d)=>c+d.nullCount,0);let a=this._nullCount,o;return a<=kUnknownNullCount&&(o=this.nullBitmap)&&(this._nullCount=a=o.length===0?0:this.length-popcnt_bit_range(o,this.offset,this.offset+this.length)),a}constructor(a,o,c,d,tt,nt=[],it){this.type=a,this.children=nt,this.dictionary=it,this.offset=Math.floor(Math.max(o||0,0)),this.length=Math.floor(Math.max(c||0,0)),this._nullCount=Math.floor(Math.max(d||0,-1));let st;tt instanceof Data?(this.stride=tt.stride,this.values=tt.values,this.typeIds=tt.typeIds,this.nullBitmap=tt.nullBitmap,this.valueOffsets=tt.valueOffsets):(this.stride=strideForType(a),tt&&((st=tt[0])&&(this.valueOffsets=st),(st=tt[1])&&(this.values=st),(st=tt[2])&&(this.nullBitmap=st),(st=tt[3])&&(this.typeIds=st)))}getValid(a){const{type:o}=this;if(DataType.isUnion(o)){const c=o,d=this.children[c.typeIdToChildIndex[this.typeIds[a]]],tt=c.mode===UnionMode.Dense?this.valueOffsets[a]:a;return d.getValid(tt)}if(this.nullable&&this.nullCount>0){const c=this.offset+a;return(this.nullBitmap[c>>3]&1<<c%8)!==0}return!0}setValid(a,o){let c;const{type:d}=this;if(DataType.isUnion(d)){const tt=d,nt=this.children[tt.typeIdToChildIndex[this.typeIds[a]]],it=tt.mode===UnionMode.Dense?this.valueOffsets[a]:a;c=nt.getValid(it),nt.setValid(it,o)}else{let{nullBitmap:tt}=this;const{offset:nt,length:it}=this,st=nt+a,ut=1<<st%8,ct=st>>3;(!tt||tt.byteLength<=ct)&&(tt=new Uint8Array((nt+it+63&-64)>>3).fill(255),this.nullCount>0?(tt.set(truncateBitmap(nt,it,this.nullBitmap),0),Object.assign(this,{nullBitmap:tt})):Object.assign(this,{nullBitmap:tt,_nullCount:0}));const ot=tt[ct];c=(ot&ut)!==0,tt[ct]=o?ot|ut:ot&~ut}return c!==!!o&&(this._nullCount=this.nullCount+(o?-1:1)),o}clone(a=this.type,o=this.offset,c=this.length,d=this._nullCount,tt=this,nt=this.children){return new Data(a,o,c,d,tt,nt,this.dictionary)}slice(a,o){const{stride:c,typeId:d,children:tt}=this,nt=+(this._nullCount===0)-1,it=d===16?c:1,st=this._sliceBuffers(a,o,c,d);return this.clone(this.type,this.offset+a,o,nt,st,tt.length===0||this.valueOffsets?tt:this._sliceChildren(tt,it*a,it*o))}_changeLengthAndBackfillNullBitmap(a){if(this.typeId===Type.Null)return this.clone(this.type,0,a,0);const{length:o,nullCount:c}=this,d=new Uint8Array((a+63&-64)>>3).fill(255,0,o>>3);d[o>>3]=(1<<o-(o&-8))-1,c>0&&d.set(truncateBitmap(this.offset,o,this.nullBitmap),0);const tt=this.buffers;return tt[BufferType.VALIDITY]=d,this.clone(this.type,0,a,c+(a-o),tt)}_sliceBuffers(a,o,c,d){let tt;const{buffers:nt}=this;return(tt=nt[BufferType.TYPE])&&(nt[BufferType.TYPE]=tt.subarray(a,a+o)),(tt=nt[BufferType.OFFSET])&&(nt[BufferType.OFFSET]=tt.subarray(a,a+o+1))||(tt=nt[BufferType.DATA])&&(nt[BufferType.DATA]=d===6?tt:tt.subarray(c*a,c*(a+o))),nt}_sliceChildren(a,o,c){return a.map(d=>d.slice(o,c))}}Data.prototype.children=Object.freeze([]);class MakeDataVisitor extends Visitor{visit(a){return this.getVisitFn(a.type).call(this,a)}visitNull(a){const{["type"]:o,["offset"]:c=0,["length"]:d=0}=a;return new Data(o,c,d,d)}visitBool(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length>>3,["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitInt(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length,["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitFloat(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length,["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitUtf8(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.data),tt=toUint8Array(a.nullBitmap),nt=toInt32Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,d,tt])}visitLargeUtf8(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.data),tt=toUint8Array(a.nullBitmap),nt=toBigInt64Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,d,tt])}visitBinary(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.data),tt=toUint8Array(a.nullBitmap),nt=toInt32Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,d,tt])}visitLargeBinary(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.data),tt=toUint8Array(a.nullBitmap),nt=toBigInt64Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,d,tt])}visitFixedSizeBinary(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitDate(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitTimestamp(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitTime(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitDecimal(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitList(a){const{["type"]:o,["offset"]:c=0,["child"]:d}=a,tt=toUint8Array(a.nullBitmap),nt=toInt32Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,void 0,tt],[d])}visitStruct(a){const{["type"]:o,["offset"]:c=0,["children"]:d=[]}=a,tt=toUint8Array(a.nullBitmap),{length:nt=d.reduce((st,{length:ut})=>Math.max(st,ut),0),nullCount:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,void 0,tt],d)}visitUnion(a){const{["type"]:o,["offset"]:c=0,["children"]:d=[]}=a,tt=toArrayBufferView(o.ArrayType,a.typeIds),{["length"]:nt=tt.length,["nullCount"]:it=-1}=a;if(DataType.isSparseUnion(o))return new Data(o,c,nt,it,[void 0,void 0,void 0,tt],d);const st=toInt32Array(a.valueOffsets);return new Data(o,c,nt,it,[st,void 0,void 0,tt],d)}visitDictionary(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.indices.ArrayType,a.data),{["dictionary"]:nt=new Vector([new MakeDataVisitor().visit({type:o.dictionary})])}=a,{["length"]:it=tt.length,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[void 0,tt,d],[],nt)}visitInterval(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitDuration(a){const{["type"]:o,["offset"]:c=0}=a,d=toUint8Array(a.nullBitmap),tt=toArrayBufferView(o.ArrayType,a.data),{["length"]:nt=tt.length,["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,tt,d])}visitFixedSizeList(a){const{["type"]:o,["offset"]:c=0,["child"]:d=new MakeDataVisitor().visit({type:o.valueType})}=a,tt=toUint8Array(a.nullBitmap),{["length"]:nt=d.length/strideForType(o),["nullCount"]:it=a.nullBitmap?-1:0}=a;return new Data(o,c,nt,it,[void 0,void 0,tt],[d])}visitMap(a){const{["type"]:o,["offset"]:c=0,["child"]:d=new MakeDataVisitor().visit({type:o.childType})}=a,tt=toUint8Array(a.nullBitmap),nt=toInt32Array(a.valueOffsets),{["length"]:it=nt.length-1,["nullCount"]:st=a.nullBitmap?-1:0}=a;return new Data(o,c,it,st,[nt,void 0,tt],[d])}}const makeDataVisitor=new MakeDataVisitor;function makeData(s){return makeDataVisitor.visit(s)}class ChunkedIterator{constructor(a=0,o){this.numChunks=a,this.getChunkIterator=o,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const a=this.chunkIterator.next();if(!a.done)return a;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function computeChunkNullable(s){return s.some(a=>a.nullable)}function computeChunkNullCounts(s){return s.reduce((a,o)=>a+o.nullCount,0)}function computeChunkOffsets(s){return s.reduce((a,o,c)=>(a[c+1]=a[c]+o.length,a),new Uint32Array(s.length+1))}function sliceChunks(s,a,o,c){const d=[];for(let tt=-1,nt=s.length;++tt<nt;){const it=s[tt],st=a[tt],{length:ut}=it;if(st>=c)break;if(o>=st+ut)continue;if(st>=o&&st+ut<=c){d.push(it);continue}const ct=Math.max(0,o-st),ot=Math.min(c-st,ut);d.push(it.slice(ct,ot-ct))}return d.length===0&&d.push(s[0].slice(0,0)),d}function binarySearch(s,a,o,c){let d=0,tt=0,nt=a.length-1;do{if(d>=nt-1)return o<a[nt]?c(s,d,o-a[d]):null;tt=d+Math.trunc((nt-d)*.5),o<a[tt]?nt=tt:d=tt}while(d<nt)}function isChunkedValid(s,a){return s.getValid(a)}function wrapChunkedCall1(s){function a(o,c,d){return s(o[c],d)}return function(o){const c=this.data;return binarySearch(c,this._offsets,o,a)}}function wrapChunkedCall2(s){let a;function o(c,d,tt){return s(c[d],tt,a)}return function(c,d){const tt=this.data;a=d;const nt=binarySearch(tt,this._offsets,c,o);return a=void 0,nt}}function wrapChunkedIndexOf(s){let a;function o(c,d,tt){let nt=tt,it=0,st=0;for(let ut=d-1,ct=c.length;++ut<ct;){const ot=c[ut];if(~(it=s(ot,a,nt)))return st+it;nt=0,st+=ot.length}return-1}return function(c,d){a=c;const tt=this.data,nt=typeof d!="number"?o(tt,0,0):binarySearch(tt,this._offsets,d,o);return a=void 0,nt}}class IndexOfVisitor extends Visitor{}function nullIndexOf(s,a){return a===null&&s.length>0?0:-1}function indexOfNull(s,a){const{nullBitmap:o}=s;if(!o||s.nullCount<=0)return-1;let c=0;for(const d of new BitIterator(o,s.offset+(a||0),s.length,o,getBool)){if(!d)return c;++c}return-1}function indexOfValue(s,a,o){if(a===void 0)return-1;if(a===null)switch(s.typeId){case Type.Union:break;case Type.Dictionary:break;default:return indexOfNull(s,o)}const c=instance$4.getVisitFn(s),d=createElementComparator(a);for(let tt=(o||0)-1,nt=s.length;++tt<nt;)if(d(c(s,tt)))return tt;return-1}function indexOfUnion(s,a,o){const c=instance$4.getVisitFn(s),d=createElementComparator(a);for(let tt=(o||0)-1,nt=s.length;++tt<nt;)if(d(c(s,tt)))return tt;return-1}IndexOfVisitor.prototype.visitNull=nullIndexOf;IndexOfVisitor.prototype.visitBool=indexOfValue;IndexOfVisitor.prototype.visitInt=indexOfValue;IndexOfVisitor.prototype.visitInt8=indexOfValue;IndexOfVisitor.prototype.visitInt16=indexOfValue;IndexOfVisitor.prototype.visitInt32=indexOfValue;IndexOfVisitor.prototype.visitInt64=indexOfValue;IndexOfVisitor.prototype.visitUint8=indexOfValue;IndexOfVisitor.prototype.visitUint16=indexOfValue;IndexOfVisitor.prototype.visitUint32=indexOfValue;IndexOfVisitor.prototype.visitUint64=indexOfValue;IndexOfVisitor.prototype.visitFloat=indexOfValue;IndexOfVisitor.prototype.visitFloat16=indexOfValue;IndexOfVisitor.prototype.visitFloat32=indexOfValue;IndexOfVisitor.prototype.visitFloat64=indexOfValue;IndexOfVisitor.prototype.visitUtf8=indexOfValue;IndexOfVisitor.prototype.visitLargeUtf8=indexOfValue;IndexOfVisitor.prototype.visitBinary=indexOfValue;IndexOfVisitor.prototype.visitLargeBinary=indexOfValue;IndexOfVisitor.prototype.visitFixedSizeBinary=indexOfValue;IndexOfVisitor.prototype.visitDate=indexOfValue;IndexOfVisitor.prototype.visitDateDay=indexOfValue;IndexOfVisitor.prototype.visitDateMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimestamp=indexOfValue;IndexOfVisitor.prototype.visitTimestampSecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampNanosecond=indexOfValue;IndexOfVisitor.prototype.visitTime=indexOfValue;IndexOfVisitor.prototype.visitTimeSecond=indexOfValue;IndexOfVisitor.prototype.visitTimeMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimeMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitTimeNanosecond=indexOfValue;IndexOfVisitor.prototype.visitDecimal=indexOfValue;IndexOfVisitor.prototype.visitList=indexOfValue;IndexOfVisitor.prototype.visitStruct=indexOfValue;IndexOfVisitor.prototype.visitUnion=indexOfValue;IndexOfVisitor.prototype.visitDenseUnion=indexOfUnion;IndexOfVisitor.prototype.visitSparseUnion=indexOfUnion;IndexOfVisitor.prototype.visitDictionary=indexOfValue;IndexOfVisitor.prototype.visitInterval=indexOfValue;IndexOfVisitor.prototype.visitIntervalDayTime=indexOfValue;IndexOfVisitor.prototype.visitIntervalYearMonth=indexOfValue;IndexOfVisitor.prototype.visitDuration=indexOfValue;IndexOfVisitor.prototype.visitDurationSecond=indexOfValue;IndexOfVisitor.prototype.visitDurationMillisecond=indexOfValue;IndexOfVisitor.prototype.visitDurationMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitDurationNanosecond=indexOfValue;IndexOfVisitor.prototype.visitFixedSizeList=indexOfValue;IndexOfVisitor.prototype.visitMap=indexOfValue;const instance$3=new IndexOfVisitor;class IteratorVisitor extends Visitor{}function vectorIterator(s){const{type:a}=s;if(s.nullCount===0&&s.stride===1&&(DataType.isInt(a)&&a.bitWidth!==64||DataType.isTime(a)&&a.bitWidth!==64||DataType.isFloat(a)&&a.precision!==Precision.HALF))return new ChunkedIterator(s.data.length,c=>{const d=s.data[c];return d.values.subarray(0,d.length)[Symbol.iterator]()});let o=0;return new ChunkedIterator(s.data.length,c=>{const tt=s.data[c].length,nt=s.slice(o,o+tt);return o+=tt,new VectorIterator(nt)})}class VectorIterator{constructor(a){this.vector=a,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}IteratorVisitor.prototype.visitNull=vectorIterator;IteratorVisitor.prototype.visitBool=vectorIterator;IteratorVisitor.prototype.visitInt=vectorIterator;IteratorVisitor.prototype.visitInt8=vectorIterator;IteratorVisitor.prototype.visitInt16=vectorIterator;IteratorVisitor.prototype.visitInt32=vectorIterator;IteratorVisitor.prototype.visitInt64=vectorIterator;IteratorVisitor.prototype.visitUint8=vectorIterator;IteratorVisitor.prototype.visitUint16=vectorIterator;IteratorVisitor.prototype.visitUint32=vectorIterator;IteratorVisitor.prototype.visitUint64=vectorIterator;IteratorVisitor.prototype.visitFloat=vectorIterator;IteratorVisitor.prototype.visitFloat16=vectorIterator;IteratorVisitor.prototype.visitFloat32=vectorIterator;IteratorVisitor.prototype.visitFloat64=vectorIterator;IteratorVisitor.prototype.visitUtf8=vectorIterator;IteratorVisitor.prototype.visitLargeUtf8=vectorIterator;IteratorVisitor.prototype.visitBinary=vectorIterator;IteratorVisitor.prototype.visitLargeBinary=vectorIterator;IteratorVisitor.prototype.visitFixedSizeBinary=vectorIterator;IteratorVisitor.prototype.visitDate=vectorIterator;IteratorVisitor.prototype.visitDateDay=vectorIterator;IteratorVisitor.prototype.visitDateMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimestamp=vectorIterator;IteratorVisitor.prototype.visitTimestampSecond=vectorIterator;IteratorVisitor.prototype.visitTimestampMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimestampMicrosecond=vectorIterator;IteratorVisitor.prototype.visitTimestampNanosecond=vectorIterator;IteratorVisitor.prototype.visitTime=vectorIterator;IteratorVisitor.prototype.visitTimeSecond=vectorIterator;IteratorVisitor.prototype.visitTimeMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimeMicrosecond=vectorIterator;IteratorVisitor.prototype.visitTimeNanosecond=vectorIterator;IteratorVisitor.prototype.visitDecimal=vectorIterator;IteratorVisitor.prototype.visitList=vectorIterator;IteratorVisitor.prototype.visitStruct=vectorIterator;IteratorVisitor.prototype.visitUnion=vectorIterator;IteratorVisitor.prototype.visitDenseUnion=vectorIterator;IteratorVisitor.prototype.visitSparseUnion=vectorIterator;IteratorVisitor.prototype.visitDictionary=vectorIterator;IteratorVisitor.prototype.visitInterval=vectorIterator;IteratorVisitor.prototype.visitIntervalDayTime=vectorIterator;IteratorVisitor.prototype.visitIntervalYearMonth=vectorIterator;IteratorVisitor.prototype.visitDuration=vectorIterator;IteratorVisitor.prototype.visitDurationSecond=vectorIterator;IteratorVisitor.prototype.visitDurationMillisecond=vectorIterator;IteratorVisitor.prototype.visitDurationMicrosecond=vectorIterator;IteratorVisitor.prototype.visitDurationNanosecond=vectorIterator;IteratorVisitor.prototype.visitFixedSizeList=vectorIterator;IteratorVisitor.prototype.visitMap=vectorIterator;const instance$2=new IteratorVisitor;var _a$4;const visitorsByTypeId={},vectorPrototypesByTypeId={};class Vector{constructor(a){var o,c,d;const tt=a[0]instanceof Vector?a.flatMap(it=>it.data):a;if(tt.length===0||tt.some(it=>!(it instanceof Data)))throw new TypeError("Vector constructor expects an Array of Data instances.");const nt=(o=tt[0])===null||o===void 0?void 0:o.type;switch(tt.length){case 0:this._offsets=[0];break;case 1:{const{get:it,set:st,indexOf:ut}=visitorsByTypeId[nt.typeId],ct=tt[0];this.isValid=ot=>isChunkedValid(ct,ot),this.get=ot=>it(ct,ot),this.set=(ot,at)=>st(ct,ot,at),this.indexOf=ot=>ut(ct,ot),this._offsets=[0,ct.length];break}default:Object.setPrototypeOf(this,vectorPrototypesByTypeId[nt.typeId]),this._offsets=computeChunkOffsets(tt);break}this.data=tt,this.type=nt,this.stride=strideForType(nt),this.numChildren=(d=(c=nt.children)===null||c===void 0?void 0:c.length)!==null&&d!==void 0?d:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((a,o)=>a+o.byteLength,0)}get nullable(){return computeChunkNullable(this.data)}get nullCount(){return computeChunkNullCounts(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Type[this.type.typeId]}Vector`}isValid(a){return!1}get(a){return null}at(a){return this.get(wrapIndex(a,this.length))}set(a,o){}indexOf(a,o){return-1}includes(a,o){return this.indexOf(a,o)>-1}[Symbol.iterator](){return instance$2.visit(this)}concat(...a){return new Vector(this.data.concat(a.flatMap(o=>o.data).flat(Number.POSITIVE_INFINITY)))}slice(a,o){return new Vector(clampRange(this,a,o,({data:c,_offsets:d},tt,nt)=>sliceChunks(c,d,tt,nt)))}toJSON(){return[...this]}toArray(){const{type:a,data:o,length:c,stride:d,ArrayType:tt}=this;switch(a.typeId){case Type.Int:case Type.Float:case Type.Decimal:case Type.Time:case Type.Timestamp:switch(o.length){case 0:return new tt;case 1:return o[0].values.subarray(0,c*d);default:return o.reduce((nt,{values:it,length:st})=>(nt.array.set(it.subarray(0,st*d),nt.offset),nt.offset+=st*d,nt),{array:new tt(c*d),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(a){var o;return this.getChildAt((o=this.type.children)===null||o===void 0?void 0:o.findIndex(c=>c.name===a))}getChildAt(a){return a>-1&&a<this.numChildren?new Vector(this.data.map(({children:o})=>o[a])):null}get isMemoized(){return DataType.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(DataType.isDictionary(this.type)){const a=new MemoizedVector(this.data[0].dictionary),o=this.data.map(c=>{const d=c.clone();return d.dictionary=a,d});return new Vector(o)}return new MemoizedVector(this)}unmemoize(){if(DataType.isDictionary(this.type)&&this.isMemoized){const a=this.data[0].dictionary.unmemoize(),o=this.data.map(c=>{const d=c.clone();return d.dictionary=a,d});return new Vector(o)}return this}}_a$4=Symbol.toStringTag;Vector[_a$4]=(s=>{s.type=DataType.prototype,s.data=[],s.length=0,s.stride=1,s.numChildren=0,s._offsets=new Uint32Array([0]),s[Symbol.isConcatSpreadable]=!0;const a=Object.keys(Type).map(o=>Type[o]).filter(o=>typeof o=="number"&&o!==Type.NONE);for(const o of a){const c=instance$4.getVisitFnByTypeId(o),d=instance$5.getVisitFnByTypeId(o),tt=instance$3.getVisitFnByTypeId(o);visitorsByTypeId[o]={get:c,set:d,indexOf:tt},vectorPrototypesByTypeId[o]=Object.create(s,{isValid:{value:wrapChunkedCall1(isChunkedValid)},get:{value:wrapChunkedCall1(instance$4.getVisitFnByTypeId(o))},set:{value:wrapChunkedCall2(instance$5.getVisitFnByTypeId(o))},indexOf:{value:wrapChunkedIndexOf(instance$3.getVisitFnByTypeId(o))}})}return"Vector"})(Vector.prototype);class MemoizedVector extends Vector{constructor(a){super(a.data);const o=this.get,c=this.set,d=this.slice,tt=new Array(this.length);Object.defineProperty(this,"get",{value(nt){const it=tt[nt];if(it!==void 0)return it;const st=o.call(this,nt);return tt[nt]=st,st}}),Object.defineProperty(this,"set",{value(nt,it){c.call(this,nt,it),tt[nt]=it}}),Object.defineProperty(this,"slice",{value:(nt,it)=>new MemoizedVector(d.call(this,nt,it))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Vector(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Block{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(a,o,c,d){return a.prep(8,24),a.writeInt64(BigInt(d??0)),a.pad(4),a.writeInt32(c),a.writeInt64(BigInt(o??0)),a.offset()}}class Footer{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsFooter(a,o){return(o||new Footer).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsFooter(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new Footer).__init(a.readInt32(a.position())+a.position(),a)}version(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):MetadataVersion.V1}schema(a){const o=this.bb.__offset(this.bb_pos,6);return o?(a||new Schema$1).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}dictionaries(a,o){const c=this.bb.__offset(this.bb_pos,8);return c?(o||new Block).__init(this.bb.__vector(this.bb_pos+c)+a*24,this.bb):null}dictionariesLength(){const a=this.bb.__offset(this.bb_pos,8);return a?this.bb.__vector_len(this.bb_pos+a):0}recordBatches(a,o){const c=this.bb.__offset(this.bb_pos,10);return c?(o||new Block).__init(this.bb.__vector(this.bb_pos+c)+a*24,this.bb):null}recordBatchesLength(){const a=this.bb.__offset(this.bb_pos,10);return a?this.bb.__vector_len(this.bb_pos+a):0}customMetadata(a,o){const c=this.bb.__offset(this.bb_pos,12);return c?(o||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}customMetadataLength(){const a=this.bb.__offset(this.bb_pos,12);return a?this.bb.__vector_len(this.bb_pos+a):0}static startFooter(a){a.startObject(5)}static addVersion(a,o){a.addFieldInt16(0,o,MetadataVersion.V1)}static addSchema(a,o){a.addFieldOffset(1,o,0)}static addDictionaries(a,o){a.addFieldOffset(2,o,0)}static startDictionariesVector(a,o){a.startVector(24,o,8)}static addRecordBatches(a,o){a.addFieldOffset(3,o,0)}static startRecordBatchesVector(a,o){a.startVector(24,o,8)}static addCustomMetadata(a,o){a.addFieldOffset(4,o,0)}static createCustomMetadataVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startCustomMetadataVector(a,o){a.startVector(4,o,4)}static endFooter(a){return a.endObject()}static finishFooterBuffer(a,o){a.finish(o)}static finishSizePrefixedFooterBuffer(a,o){a.finish(o,void 0,!0)}}class Schema{constructor(a=[],o,c,d=MetadataVersion.V5){this.fields=a||[],this.metadata=o||new Map,c||(c=generateDictionaryMap(this.fields)),this.dictionaries=c,this.metadataVersion=d}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(a=>a.name)}toString(){return`Schema<{ ${this.fields.map((a,o)=>`${o}: ${a}`).join(", ")} }>`}select(a){const o=new Set(a),c=this.fields.filter(d=>o.has(d.name));return new Schema(c,this.metadata)}selectAt(a){const o=a.map(c=>this.fields[c]).filter(Boolean);return new Schema(o,this.metadata)}assign(...a){const o=a[0]instanceof Schema?a[0]:Array.isArray(a[0])?new Schema(a[0]):new Schema(a),c=[...this.fields],d=mergeMaps(mergeMaps(new Map,this.metadata),o.metadata),tt=o.fields.filter(it=>{const st=c.findIndex(ut=>ut.name===it.name);return~st?(c[st]=it.clone({metadata:mergeMaps(mergeMaps(new Map,c[st].metadata),it.metadata)}))&&!1:!0}),nt=generateDictionaryMap(tt,new Map);return new Schema([...c,...tt],d,new Map([...this.dictionaries,...nt]))}}Schema.prototype.fields=null;Schema.prototype.metadata=null;Schema.prototype.dictionaries=null;class Field{static new(...a){let[o,c,d,tt]=a;return a[0]&&typeof a[0]=="object"&&({name:o}=a[0],c===void 0&&(c=a[0].type),d===void 0&&(d=a[0].nullable),tt===void 0&&(tt=a[0].metadata)),new Field(`${o}`,c,d,tt)}constructor(a,o,c=!1,d){this.name=a,this.type=o,this.nullable=c,this.metadata=d||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let[o,c,d,tt]=a;return!a[0]||typeof a[0]!="object"?[o=this.name,c=this.type,d=this.nullable,tt=this.metadata]=a:{name:o=this.name,type:c=this.type,nullable:d=this.nullable,metadata:tt=this.metadata}=a[0],Field.new(o,c,d,tt)}}Field.prototype.type=null;Field.prototype.name=null;Field.prototype.nullable=null;Field.prototype.metadata=null;function mergeMaps(s,a){return new Map([...s||new Map,...a||new Map])}function generateDictionaryMap(s,a=new Map){for(let o=-1,c=s.length;++o<c;){const tt=s[o].type;if(DataType.isDictionary(tt)){if(!a.has(tt.id))a.set(tt.id,tt.dictionary);else if(a.get(tt.id)!==tt.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}tt.children&&tt.children.length>0&&generateDictionaryMap(tt.children,a)}return a}var Builder$1=Builder$2,ByteBuffer$1=ByteBuffer$2;class Footer_{static decode(a){a=new ByteBuffer$1(toUint8Array(a));const o=Footer.getRootAsFooter(a),c=Schema.decode(o.schema(),new Map,o.version());return new OffHeapFooter(c,o)}static encode(a){const o=new Builder$1,c=Schema.encode(o,a.schema);Footer.startRecordBatchesVector(o,a.numRecordBatches);for(const nt of[...a.recordBatches()].slice().reverse())FileBlock.encode(o,nt);const d=o.endVector();Footer.startDictionariesVector(o,a.numDictionaries);for(const nt of[...a.dictionaryBatches()].slice().reverse())FileBlock.encode(o,nt);const tt=o.endVector();return Footer.startFooter(o),Footer.addSchema(o,c),Footer.addVersion(o,MetadataVersion.V5),Footer.addRecordBatches(o,d),Footer.addDictionaries(o,tt),Footer.finishFooterBuffer(o,Footer.endFooter(o)),o.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(a,o=MetadataVersion.V5,c,d){this.schema=a,this.version=o,c&&(this._recordBatches=c),d&&(this._dictionaryBatches=d)}*recordBatches(){for(let a,o=-1,c=this.numRecordBatches;++o<c;)(a=this.getRecordBatch(o))&&(yield a)}*dictionaryBatches(){for(let a,o=-1,c=this.numDictionaries;++o<c;)(a=this.getDictionaryBatch(o))&&(yield a)}getRecordBatch(a){return a>=0&&a<this.numRecordBatches&&this._recordBatches[a]||null}getDictionaryBatch(a){return a>=0&&a<this.numDictionaries&&this._dictionaryBatches[a]||null}}class OffHeapFooter extends Footer_{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(a,o){super(a,o.version()),this._footer=o}getRecordBatch(a){if(a>=0&&a<this.numRecordBatches){const o=this._footer.recordBatches(a);if(o)return FileBlock.decode(o)}return null}getDictionaryBatch(a){if(a>=0&&a<this.numDictionaries){const o=this._footer.dictionaries(a);if(o)return FileBlock.decode(o)}return null}}class FileBlock{static decode(a){return new FileBlock(a.metaDataLength(),a.bodyLength(),a.offset())}static encode(a,o){const{metaDataLength:c}=o,d=BigInt(o.offset),tt=BigInt(o.bodyLength);return Block.createBlock(a,d,c,tt)}constructor(a,o,c){this.metaDataLength=a,this.offset=bigIntToNumber(c),this.bodyLength=bigIntToNumber(o)}}const ITERATOR_DONE=Object.freeze({done:!0,value:void 0});class ArrowJSON{constructor(a){this._json=a}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class ReadableInterop{tee(){return this._getDOMStream().tee()}pipe(a,o){return this._getNodeStream().pipe(a,o)}pipeTo(a,o){return this._getDOMStream().pipeTo(a,o)}pipeThrough(a,o){return this._getDOMStream().pipeThrough(a,o)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class AsyncQueue extends ReadableInterop{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(a=>this._closedPromiseResolve=a)}get closed(){return this._closedPromise}cancel(a){return __awaiter(this,void 0,void 0,function*(){yield this.return(a)})}write(a){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(a):this.resolvers.shift().resolve({done:!1,value:a}))}abort(a){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:a}:this.resolvers.shift().reject({done:!0,value:a}))}close(){if(this._closedPromiseResolve){const{resolvers:a}=this;for(;a.length>0;)a.shift().resolve(ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return streamAdapters.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,a)}toNodeStream(a){return streamAdapters.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,a)}throw(a){return __awaiter(this,void 0,void 0,function*(){return yield this.abort(a),ITERATOR_DONE})}return(a){return __awaiter(this,void 0,void 0,function*(){return yield this.close(),ITERATOR_DONE})}read(a){return __awaiter(this,void 0,void 0,function*(){return(yield this.next(a,"read")).value})}peek(a){return __awaiter(this,void 0,void 0,function*(){return(yield this.next(a,"peek")).value})}next(...a){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((o,c)=>{this.resolvers.push({resolve:o,reject:c})}):Promise.resolve(ITERATOR_DONE)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class AsyncByteQueue extends AsyncQueue{write(a){if((a=toUint8Array(a)).byteLength>0)return super.write(a)}toString(a=!1){return a?decodeUtf8(this.toUint8Array(!0)):this.toUint8Array(!1).then(decodeUtf8)}toUint8Array(a=!1){return a?joinUint8Arrays(this._values)[0]:__awaiter(this,void 0,void 0,function*(){var o,c,d,tt;const nt=[];let it=0;try{for(var st=!0,ut=__asyncValues(this),ct;ct=yield ut.next(),o=ct.done,!o;st=!0){tt=ct.value,st=!1;const ot=tt;nt.push(ot),it+=ot.byteLength}}catch(ot){c={error:ot}}finally{try{!st&&!o&&(d=ut.return)&&(yield d.call(ut))}finally{if(c)throw c.error}}return joinUint8Arrays(nt,it)[0]})}}class ByteStream{constructor(a){a&&(this.source=new ByteStreamSource(streamAdapters.fromIterable(a)))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}class AsyncByteStream{constructor(a){a instanceof AsyncByteStream?this.source=a.source:a instanceof AsyncByteQueue?this.source=new AsyncByteStreamSource(streamAdapters.fromAsyncIterable(a)):isReadableNodeStream(a)?this.source=new AsyncByteStreamSource(streamAdapters.fromNodeStream(a)):isReadableDOMStream(a)?this.source=new AsyncByteStreamSource(streamAdapters.fromDOMStream(a)):isFetchResponse(a)?this.source=new AsyncByteStreamSource(streamAdapters.fromDOMStream(a.body)):isIterable(a)?this.source=new AsyncByteStreamSource(streamAdapters.fromIterable(a)):isPromise(a)?this.source=new AsyncByteStreamSource(streamAdapters.fromAsyncIterable(a)):isAsyncIterable(a)&&(this.source=new AsyncByteStreamSource(streamAdapters.fromAsyncIterable(a)))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}class ByteStreamSource{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,o="read"){return this.source.next({cmd:o,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||ITERATOR_DONE)}return(a){return Object.create(this.source.return&&this.source.return(a)||ITERATOR_DONE)}}class AsyncByteStreamSource{constructor(a){this.source=a,this._closedPromise=new Promise(o=>this._closedPromiseResolve=o)}cancel(a){return __awaiter(this,void 0,void 0,function*(){yield this.return(a)})}get closed(){return this._closedPromise}read(a){return __awaiter(this,void 0,void 0,function*(){return(yield this.next(a,"read")).value})}peek(a){return __awaiter(this,void 0,void 0,function*(){return(yield this.next(a,"peek")).value})}next(a){return __awaiter(this,arguments,void 0,function*(o,c="read"){return yield this.source.next({cmd:c,size:o})})}throw(a){return __awaiter(this,void 0,void 0,function*(){const o=this.source.throw&&(yield this.source.throw(a))||ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(o)})}return(a){return __awaiter(this,void 0,void 0,function*(){const o=this.source.return&&(yield this.source.return(a))||ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(o)})}}class RandomAccessFile extends ByteStream{constructor(a,o){super(),this.position=0,this.buffer=toUint8Array(a),this.size=o===void 0?this.buffer.byteLength:o}readInt32(a){const{buffer:o,byteOffset:c}=this.readAt(a,4);return new DataView(o,c).getInt32(0,!0)}seek(a){return this.position=Math.min(a,this.size),a<this.size}read(a){const{buffer:o,size:c,position:d}=this;return o&&d<c?(typeof a!="number"&&(a=Number.POSITIVE_INFINITY),this.position=Math.min(c,d+Math.min(c-d,a)),o.subarray(d,this.position)):null}readAt(a,o){const c=this.buffer,d=Math.min(this.size,a+o);return c?c.subarray(a,d):new Uint8Array(o)}close(){this.buffer&&(this.buffer=null)}throw(a){return this.close(),{done:!0,value:a}}return(a){return this.close(),{done:!0,value:a}}}class AsyncRandomAccessFile extends AsyncByteStream{constructor(a,o){super(),this.position=0,this._handle=a,typeof o=="number"?this.size=o:this._pending=__awaiter(this,void 0,void 0,function*(){this.size=(yield a.stat()).size,delete this._pending})}readInt32(a){return __awaiter(this,void 0,void 0,function*(){const{buffer:o,byteOffset:c}=yield this.readAt(a,4);return new DataView(o,c).getInt32(0,!0)})}seek(a){return __awaiter(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(a,this.size),a<this.size})}read(a){return __awaiter(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:o,size:c,position:d}=this;if(o&&d<c){typeof a!="number"&&(a=Number.POSITIVE_INFINITY);let tt=d,nt=0,it=0;const st=Math.min(c,tt+Math.min(c-tt,a)),ut=new Uint8Array(Math.max(0,(this.position=st)-tt));for(;(tt+=it)<st&&(nt+=it)<ut.byteLength;)({bytesRead:it}=yield o.read(ut,nt,ut.byteLength-nt,tt));return ut}return null})}readAt(a,o){return __awaiter(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:c,size:d}=this;if(c&&a+o<d){const tt=Math.min(d,a+o),nt=new Uint8Array(tt-a);return(yield c.read(nt,0,o,a)).buffer}return new Uint8Array(o)})}close(){return __awaiter(this,void 0,void 0,function*(){const a=this._handle;this._handle=null,a&&(yield a.close())})}throw(a){return __awaiter(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:a}})}return(a){return __awaiter(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:a}})}}const carryBit16=65536;function intAsHex(s){return s<0&&(s=4294967295+s+1),`0x${s.toString(16)}`}const kInt32DecimalDigits=8,kPowersOfTen=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class BaseInt64{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(a){const o=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);let d=o[3]*c[3];this.buffer[0]=d&65535;let tt=d>>>16;return d=o[2]*c[3],tt+=d,d=o[3]*c[2]>>>0,tt+=d,this.buffer[0]+=tt<<16,this.buffer[1]=tt>>>0<d?carryBit16:0,this.buffer[1]+=tt>>>16,this.buffer[1]+=o[1]*c[3]+o[2]*c[2]+o[3]*c[1],this.buffer[1]+=o[0]*c[3]+o[1]*c[2]+o[2]*c[1]+o[3]*c[0]<<16,this}_plus(a){const o=this.buffer[0]+a.buffer[0]>>>0;this.buffer[1]+=a.buffer[1],o<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=o}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${intAsHex(this.buffer[1])} ${intAsHex(this.buffer[0])}`}}class Uint64 extends BaseInt64{times(a){return this._times(a),this}plus(a){return this._plus(a),this}static from(a,o=new Uint32Array(2)){return Uint64.fromString(typeof a=="string"?a:a.toString(),o)}static fromNumber(a,o=new Uint32Array(2)){return Uint64.fromString(a.toString(),o)}static fromString(a,o=new Uint32Array(2)){const c=a.length,d=new Uint64(o);for(let tt=0;tt<c;){const nt=kInt32DecimalDigits<c-tt?kInt32DecimalDigits:c-tt,it=new Uint64(new Uint32Array([Number.parseInt(a.slice(tt,tt+nt),10),0])),st=new Uint64(new Uint32Array([kPowersOfTen[nt],0]));d.times(st),d.plus(it),tt+=nt}return d}static convertArray(a){const o=new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)Uint64.from(a[c],new Uint32Array(o.buffer,o.byteOffset+2*c*4,2));return o}static multiply(a,o){return new Uint64(new Uint32Array(a.buffer)).times(o)}static add(a,o){return new Uint64(new Uint32Array(a.buffer)).plus(o)}}class Int64 extends BaseInt64{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(a){return this._times(a),this}plus(a){return this._plus(a),this}lessThan(a){const o=this.buffer[1]<<0,c=a.buffer[1]<<0;return o<c||o===c&&this.buffer[0]<a.buffer[0]}static from(a,o=new Uint32Array(2)){return Int64.fromString(typeof a=="string"?a:a.toString(),o)}static fromNumber(a,o=new Uint32Array(2)){return Int64.fromString(a.toString(),o)}static fromString(a,o=new Uint32Array(2)){const c=a.startsWith("-"),d=a.length,tt=new Int64(o);for(let nt=c?1:0;nt<d;){const it=kInt32DecimalDigits<d-nt?kInt32DecimalDigits:d-nt,st=new Int64(new Uint32Array([Number.parseInt(a.slice(nt,nt+it),10),0])),ut=new Int64(new Uint32Array([kPowersOfTen[it],0]));tt.times(ut),tt.plus(st),nt+=it}return c?tt.negate():tt}static convertArray(a){const o=new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)Int64.from(a[c],new Uint32Array(o.buffer,o.byteOffset+2*c*4,2));return o}static multiply(a,o){return new Int64(new Uint32Array(a.buffer)).times(o)}static add(a,o){return new Int64(new Uint32Array(a.buffer)).plus(o)}}class Int128{constructor(a){this.buffer=a}high(){return new Int64(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Int64(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(a){const o=new Uint64(new Uint32Array([this.buffer[3],0])),c=new Uint64(new Uint32Array([this.buffer[2],0])),d=new Uint64(new Uint32Array([this.buffer[1],0])),tt=new Uint64(new Uint32Array([this.buffer[0],0])),nt=new Uint64(new Uint32Array([a.buffer[3],0])),it=new Uint64(new Uint32Array([a.buffer[2],0])),st=new Uint64(new Uint32Array([a.buffer[1],0])),ut=new Uint64(new Uint32Array([a.buffer[0],0]));let ct=Uint64.multiply(tt,ut);this.buffer[0]=ct.low();const ot=new Uint64(new Uint32Array([ct.high(),0]));return ct=Uint64.multiply(d,ut),ot.plus(ct),ct=Uint64.multiply(tt,st),ot.plus(ct),this.buffer[1]=ot.low(),this.buffer[3]=ot.lessThan(ct)?1:0,this.buffer[2]=ot.high(),new Uint64(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Uint64.multiply(c,ut)).plus(Uint64.multiply(d,st)).plus(Uint64.multiply(tt,it)),this.buffer[3]+=Uint64.multiply(o,ut).plus(Uint64.multiply(c,st)).plus(Uint64.multiply(d,it)).plus(Uint64.multiply(tt,nt)).low(),this}plus(a){const o=new Uint32Array(4);return o[3]=this.buffer[3]+a.buffer[3]>>>0,o[2]=this.buffer[2]+a.buffer[2]>>>0,o[1]=this.buffer[1]+a.buffer[1]>>>0,o[0]=this.buffer[0]+a.buffer[0]>>>0,o[0]<this.buffer[0]>>>0&&++o[1],o[1]<this.buffer[1]>>>0&&++o[2],o[2]<this.buffer[2]>>>0&&++o[3],this.buffer[3]=o[3],this.buffer[2]=o[2],this.buffer[1]=o[1],this.buffer[0]=o[0],this}hex(){return`${intAsHex(this.buffer[3])} ${intAsHex(this.buffer[2])} ${intAsHex(this.buffer[1])} ${intAsHex(this.buffer[0])}`}static multiply(a,o){return new Int128(new Uint32Array(a.buffer)).times(o)}static add(a,o){return new Int128(new Uint32Array(a.buffer)).plus(o)}static from(a,o=new Uint32Array(4)){return Int128.fromString(typeof a=="string"?a:a.toString(),o)}static fromNumber(a,o=new Uint32Array(4)){return Int128.fromString(a.toString(),o)}static fromString(a,o=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length,tt=new Int128(o);for(let nt=c?1:0;nt<d;){const it=kInt32DecimalDigits<d-nt?kInt32DecimalDigits:d-nt,st=new Int128(new Uint32Array([Number.parseInt(a.slice(nt,nt+it),10),0,0,0])),ut=new Int128(new Uint32Array([kPowersOfTen[it],0,0,0]));tt.times(ut),tt.plus(st),nt+=it}return c?tt.negate():tt}static convertArray(a){const o=new Uint32Array(a.length*4);for(let c=-1,d=a.length;++c<d;)Int128.from(a[c],new Uint32Array(o.buffer,o.byteOffset+4*4*c,4));return o}}class VectorLoader extends Visitor{constructor(a,o,c,d,tt=MetadataVersion.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=a,this.nodes=o,this.buffers=c,this.dictionaries=d,this.metadataVersion=tt}visit(a){return super.visit(a instanceof Field?a.type:a)}visitNull(a,{length:o}=this.nextFieldNode()){return makeData({type:a,length:o})}visitBool(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitInt(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitFloat(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitUtf8(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),data:this.readData(a)})}visitLargeUtf8(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),data:this.readData(a)})}visitBinary(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),data:this.readData(a)})}visitLargeBinary(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),data:this.readData(a)})}visitFixedSizeBinary(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitDate(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitTimestamp(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitTime(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitDecimal(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitList(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),child:this.visit(a.children[0])})}visitStruct(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),children:this.visitMany(a.children)})}visitUnion(a,{length:o,nullCount:c}=this.nextFieldNode()){return this.metadataVersion<MetadataVersion.V5&&this.readNullBitmap(a,c),a.mode===UnionMode.Sparse?this.visitSparseUnion(a,{length:o,nullCount:c}):this.visitDenseUnion(a,{length:o,nullCount:c})}visitDenseUnion(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,typeIds:this.readTypeIds(a),valueOffsets:this.readOffsets(a),children:this.visitMany(a.children)})}visitSparseUnion(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,typeIds:this.readTypeIds(a),children:this.visitMany(a.children)})}visitDictionary(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a.indices),dictionary:this.readDictionary(a)})}visitInterval(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitDuration(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),data:this.readData(a)})}visitFixedSizeList(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),child:this.visit(a.children[0])})}visitMap(a,{length:o,nullCount:c}=this.nextFieldNode()){return makeData({type:a,length:o,nullCount:c,nullBitmap:this.readNullBitmap(a,c),valueOffsets:this.readOffsets(a),child:this.visit(a.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(a,o,c=this.nextBufferRange()){return o>0&&this.readData(a,c)||new Uint8Array(0)}readOffsets(a,o){return this.readData(a,o)}readTypeIds(a,o){return this.readData(a,o)}readData(a,{length:o,offset:c}=this.nextBufferRange()){return this.bytes.subarray(c,c+o)}readDictionary(a){return this.dictionaries.get(a.id)}}class JSONVectorLoader extends VectorLoader{constructor(a,o,c,d,tt){super(new Uint8Array(0),o,c,d,tt),this.sources=a}readNullBitmap(a,o,{offset:c}=this.nextBufferRange()){return o<=0?new Uint8Array(0):packBools(this.sources[c])}readOffsets(a,{offset:o}=this.nextBufferRange()){return toArrayBufferView(Uint8Array,toArrayBufferView(a.OffsetArrayType,this.sources[o]))}readTypeIds(a,{offset:o}=this.nextBufferRange()){return toArrayBufferView(Uint8Array,toArrayBufferView(a.ArrayType,this.sources[o]))}readData(a,{offset:o}=this.nextBufferRange()){const{sources:c}=this;return DataType.isTimestamp(a)||(DataType.isInt(a)||DataType.isTime(a))&&a.bitWidth===64||DataType.isDuration(a)||DataType.isDate(a)&&a.unit===DateUnit.MILLISECOND?toArrayBufferView(Uint8Array,Int64.convertArray(c[o])):DataType.isDecimal(a)?toArrayBufferView(Uint8Array,Int128.convertArray(c[o])):DataType.isBinary(a)||DataType.isLargeBinary(a)||DataType.isFixedSizeBinary(a)?binaryDataFromJSON(c[o]):DataType.isBool(a)?packBools(c[o]):DataType.isUtf8(a)||DataType.isLargeUtf8(a)?encodeUtf8(c[o].join("")):toArrayBufferView(Uint8Array,toArrayBufferView(a.ArrayType,c[o].map(d=>+d)))}}function binaryDataFromJSON(s){const a=s.join(""),o=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)o[c>>1]=Number.parseInt(a.slice(c,c+2),16);return o}class TypeComparator extends Visitor{compareSchemas(a,o){return a===o||o instanceof a.constructor&&this.compareManyFields(a.fields,o.fields)}compareManyFields(a,o){return a===o||Array.isArray(a)&&Array.isArray(o)&&a.length===o.length&&a.every((c,d)=>this.compareFields(c,o[d]))}compareFields(a,o){return a===o||o instanceof a.constructor&&a.name===o.name&&a.nullable===o.nullable&&this.visit(a.type,o.type)}}function compareConstructor(s,a){return a instanceof s.constructor}function compareAny(s,a){return s===a||compareConstructor(s,a)}function compareInt(s,a){return s===a||compareConstructor(s,a)&&s.bitWidth===a.bitWidth&&s.isSigned===a.isSigned}function compareFloat(s,a){return s===a||compareConstructor(s,a)&&s.precision===a.precision}function compareFixedSizeBinary(s,a){return s===a||compareConstructor(s,a)&&s.byteWidth===a.byteWidth}function compareDate(s,a){return s===a||compareConstructor(s,a)&&s.unit===a.unit}function compareTimestamp(s,a){return s===a||compareConstructor(s,a)&&s.unit===a.unit&&s.timezone===a.timezone}function compareTime(s,a){return s===a||compareConstructor(s,a)&&s.unit===a.unit&&s.bitWidth===a.bitWidth}function compareList(s,a){return s===a||compareConstructor(s,a)&&s.children.length===a.children.length&&instance$1.compareManyFields(s.children,a.children)}function compareStruct(s,a){return s===a||compareConstructor(s,a)&&s.children.length===a.children.length&&instance$1.compareManyFields(s.children,a.children)}function compareUnion(s,a){return s===a||compareConstructor(s,a)&&s.mode===a.mode&&s.typeIds.every((o,c)=>o===a.typeIds[c])&&instance$1.compareManyFields(s.children,a.children)}function compareDictionary(s,a){return s===a||compareConstructor(s,a)&&s.id===a.id&&s.isOrdered===a.isOrdered&&instance$1.visit(s.indices,a.indices)&&instance$1.visit(s.dictionary,a.dictionary)}function compareInterval(s,a){return s===a||compareConstructor(s,a)&&s.unit===a.unit}function compareDuration(s,a){return s===a||compareConstructor(s,a)&&s.unit===a.unit}function compareFixedSizeList(s,a){return s===a||compareConstructor(s,a)&&s.listSize===a.listSize&&s.children.length===a.children.length&&instance$1.compareManyFields(s.children,a.children)}function compareMap(s,a){return s===a||compareConstructor(s,a)&&s.keysSorted===a.keysSorted&&s.children.length===a.children.length&&instance$1.compareManyFields(s.children,a.children)}TypeComparator.prototype.visitNull=compareAny;TypeComparator.prototype.visitBool=compareAny;TypeComparator.prototype.visitInt=compareInt;TypeComparator.prototype.visitInt8=compareInt;TypeComparator.prototype.visitInt16=compareInt;TypeComparator.prototype.visitInt32=compareInt;TypeComparator.prototype.visitInt64=compareInt;TypeComparator.prototype.visitUint8=compareInt;TypeComparator.prototype.visitUint16=compareInt;TypeComparator.prototype.visitUint32=compareInt;TypeComparator.prototype.visitUint64=compareInt;TypeComparator.prototype.visitFloat=compareFloat;TypeComparator.prototype.visitFloat16=compareFloat;TypeComparator.prototype.visitFloat32=compareFloat;TypeComparator.prototype.visitFloat64=compareFloat;TypeComparator.prototype.visitUtf8=compareAny;TypeComparator.prototype.visitLargeUtf8=compareAny;TypeComparator.prototype.visitBinary=compareAny;TypeComparator.prototype.visitLargeBinary=compareAny;TypeComparator.prototype.visitFixedSizeBinary=compareFixedSizeBinary;TypeComparator.prototype.visitDate=compareDate;TypeComparator.prototype.visitDateDay=compareDate;TypeComparator.prototype.visitDateMillisecond=compareDate;TypeComparator.prototype.visitTimestamp=compareTimestamp;TypeComparator.prototype.visitTimestampSecond=compareTimestamp;TypeComparator.prototype.visitTimestampMillisecond=compareTimestamp;TypeComparator.prototype.visitTimestampMicrosecond=compareTimestamp;TypeComparator.prototype.visitTimestampNanosecond=compareTimestamp;TypeComparator.prototype.visitTime=compareTime;TypeComparator.prototype.visitTimeSecond=compareTime;TypeComparator.prototype.visitTimeMillisecond=compareTime;TypeComparator.prototype.visitTimeMicrosecond=compareTime;TypeComparator.prototype.visitTimeNanosecond=compareTime;TypeComparator.prototype.visitDecimal=compareAny;TypeComparator.prototype.visitList=compareList;TypeComparator.prototype.visitStruct=compareStruct;TypeComparator.prototype.visitUnion=compareUnion;TypeComparator.prototype.visitDenseUnion=compareUnion;TypeComparator.prototype.visitSparseUnion=compareUnion;TypeComparator.prototype.visitDictionary=compareDictionary;TypeComparator.prototype.visitInterval=compareInterval;TypeComparator.prototype.visitIntervalDayTime=compareInterval;TypeComparator.prototype.visitIntervalYearMonth=compareInterval;TypeComparator.prototype.visitDuration=compareDuration;TypeComparator.prototype.visitDurationSecond=compareDuration;TypeComparator.prototype.visitDurationMillisecond=compareDuration;TypeComparator.prototype.visitDurationMicrosecond=compareDuration;TypeComparator.prototype.visitDurationNanosecond=compareDuration;TypeComparator.prototype.visitFixedSizeList=compareFixedSizeList;TypeComparator.prototype.visitMap=compareMap;const instance$1=new TypeComparator;function compareSchemas(s,a){return instance$1.compareSchemas(s,a)}function distributeVectorsIntoRecordBatches(s,a){return uniformlyDistributeChunksAcrossRecordBatches(s,a.map(o=>o.data.concat()))}function uniformlyDistributeChunksAcrossRecordBatches(s,a){const o=[...s.fields],c=[],d={numBatches:a.reduce((ot,at)=>Math.max(ot,at.length),0)};let tt=0,nt=0,it=-1;const st=a.length;let ut,ct=[];for(;d.numBatches-- >0;){for(nt=Number.POSITIVE_INFINITY,it=-1;++it<st;)ct[it]=ut=a[it].shift(),nt=Math.min(nt,ut?ut.length:nt);Number.isFinite(nt)&&(ct=distributeChildren(o,nt,ct,a,d),nt>0&&(c[tt++]=makeData({type:new Struct(o),length:nt,nullCount:0,children:ct.slice()})))}return[s=s.assign(o),c.map(ot=>new RecordBatch$1(s,ot))]}function distributeChildren(s,a,o,c,d){var tt;const nt=(a+63&-64)>>3;for(let it=-1,st=c.length;++it<st;){const ut=o[it],ct=ut?.length;if(ct>=a)ct===a?o[it]=ut:(o[it]=ut.slice(0,a),d.numBatches=Math.max(d.numBatches,c[it].unshift(ut.slice(a,ct-a))));else{const ot=s[it];s[it]=ot.clone({nullable:!0}),o[it]=(tt=ut?._changeLengthAndBackfillNullBitmap(a))!==null&&tt!==void 0?tt:makeData({type:ot.type,length:a,nullCount:a,nullBitmap:new Uint8Array(nt)})}}return o}var _a$3;class Table{constructor(...a){var o,c;if(a.length===0)return this.batches=[],this.schema=new Schema([]),this._offsets=[0],this;let d,tt;a[0]instanceof Schema&&(d=a.shift()),a.at(-1)instanceof Uint32Array&&(tt=a.pop());const nt=st=>{if(st){if(st instanceof RecordBatch$1)return[st];if(st instanceof Table)return st.batches;if(st instanceof Data){if(st.type instanceof Struct)return[new RecordBatch$1(new Schema(st.type.children),st)]}else{if(Array.isArray(st))return st.flatMap(ut=>nt(ut));if(typeof st[Symbol.iterator]=="function")return[...st].flatMap(ut=>nt(ut));if(typeof st=="object"){const ut=Object.keys(st),ct=ut.map(ht=>new Vector([st[ht]])),ot=d??new Schema(ut.map((ht,ft)=>new Field(String(ht),ct[ft].type,ct[ft].nullable))),[,at]=distributeVectorsIntoRecordBatches(ot,ct);return at.length===0?[new RecordBatch$1(st)]:at}}}return[]},it=a.flatMap(st=>nt(st));if(d=(c=d??((o=it[0])===null||o===void 0?void 0:o.schema))!==null&&c!==void 0?c:new Schema([]),!(d instanceof Schema))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const st of it){if(!(st instanceof RecordBatch$1))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!compareSchemas(d,st.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=d,this.batches=it,this._offsets=tt??computeChunkOffsets(this.data)}get data(){return this.batches.map(({data:a})=>a)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((a,o)=>a+o.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=computeChunkNullCounts(this.data)),this._nullCount}isValid(a){return!1}get(a){return null}at(a){return this.get(wrapIndex(a,this.numRows))}set(a,o){}indexOf(a,o){return-1}[Symbol.iterator](){return this.batches.length>0?instance$2.visit(new Vector(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...a){const o=this.schema,c=this.data.concat(a.flatMap(({data:d})=>d));return new Table(o,c.map(d=>new RecordBatch$1(o,d)))}slice(a,o){const c=this.schema;[a,o]=clampRange({length:this.numRows},a,o);const d=sliceChunks(this.data,this._offsets,a,o);return new Table(c,d.map(tt=>new RecordBatch$1(c,tt)))}getChild(a){return this.getChildAt(this.schema.fields.findIndex(o=>o.name===a))}getChildAt(a){if(a>-1&&a<this.schema.fields.length){const o=this.data.map(c=>c.children[a]);if(o.length===0){const{type:c}=this.schema.fields[a],d=makeData({type:c,length:0,nullCount:0});o.push(d._changeLengthAndBackfillNullBitmap(this.numRows))}return new Vector(o)}return null}setChild(a,o){var c;return this.setChildAt((c=this.schema.fields)===null||c===void 0?void 0:c.findIndex(d=>d.name===a),o)}setChildAt(a,o){let c=this.schema,d=[...this.batches];if(a>-1&&a<this.numCols){o||(o=new Vector([makeData({type:new Null,length:this.numRows})]));const tt=c.fields.slice(),nt=tt[a].clone({type:o.type}),it=this.schema.fields.map((st,ut)=>this.getChildAt(ut));[tt[a],it[a]]=[nt,o],[c,d]=distributeVectorsIntoRecordBatches(c,it)}return new Table(c,d)}select(a){const o=this.schema.fields.reduce((c,d,tt)=>c.set(d.name,tt),new Map);return this.selectAt(a.map(c=>o.get(c)).filter(c=>c>-1))}selectAt(a){const o=this.schema.selectAt(a),c=this.batches.map(d=>d.selectAt(a));return new Table(o,c)}assign(a){const o=this.schema.fields,[c,d]=a.schema.fields.reduce((it,st,ut)=>{const[ct,ot]=it,at=o.findIndex(ht=>ht.name===st.name);return~at?ot[at]=ut:ct.push(ut),it},[[],[]]),tt=this.schema.assign(a.schema),nt=[...o.map((it,st)=>[st,d[st]]).map(([it,st])=>st===void 0?this.getChildAt(it):a.getChildAt(st)),...c.map(it=>a.getChildAt(it))].filter(Boolean);return new Table(...distributeVectorsIntoRecordBatches(tt,nt))}}_a$3=Symbol.toStringTag;Table[_a$3]=(s=>(s.schema=null,s.batches=[],s._offsets=new Uint32Array([0]),s._nullCount=-1,s[Symbol.isConcatSpreadable]=!0,s.isValid=wrapChunkedCall1(isChunkedValid),s.get=wrapChunkedCall1(instance$4.getVisitFn(Type.Struct)),s.set=wrapChunkedCall2(instance$5.getVisitFn(Type.Struct)),s.indexOf=wrapChunkedIndexOf(instance$3.getVisitFn(Type.Struct)),"Table"))(Table.prototype);var _a$2;let RecordBatch$1=class Nv{constructor(...a){switch(a.length){case 2:{if([this.schema]=a,!(this.schema instanceof Schema))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=makeData({nullCount:0,type:new Struct(this.schema.fields),children:this.schema.fields.map(o=>makeData({type:o.type,nullCount:0}))})]=a,!(this.data instanceof Data))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=ensureSameLengthData(this.schema,this.data.children);break}case 1:{const[o]=a,{fields:c,children:d,length:tt}=Object.keys(o).reduce((st,ut,ct)=>(st.children[ct]=o[ut],st.length=Math.max(st.length,o[ut].length),st.fields[ct]=Field.new({name:ut,type:o[ut].type,nullable:!0}),st),{length:0,fields:new Array,children:new Array}),nt=new Schema(c),it=makeData({type:new Struct(c),length:tt,children:d,nullCount:0});[this.schema,this.data]=ensureSameLengthData(nt,it.children,tt);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=collectDictionaries(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(a){return this.data.getValid(a)}get(a){return instance$4.visit(this.data,a)}at(a){return this.get(wrapIndex(a,this.numRows))}set(a,o){return instance$5.visit(this.data,a,o)}indexOf(a,o){return instance$3.visit(this.data,a,o)}[Symbol.iterator](){return instance$2.visit(new Vector([this.data]))}toArray(){return[...this]}concat(...a){return new Table(this.schema,[this,...a])}slice(a,o){const[c]=new Vector([this.data]).slice(a,o).data;return new Nv(this.schema,c)}getChild(a){var o;return this.getChildAt((o=this.schema.fields)===null||o===void 0?void 0:o.findIndex(c=>c.name===a))}getChildAt(a){return a>-1&&a<this.schema.fields.length?new Vector([this.data.children[a]]):null}setChild(a,o){var c;return this.setChildAt((c=this.schema.fields)===null||c===void 0?void 0:c.findIndex(d=>d.name===a),o)}setChildAt(a,o){let c=this.schema,d=this.data;if(a>-1&&a<this.numCols){o||(o=new Vector([makeData({type:new Null,length:this.numRows})]));const tt=c.fields.slice(),nt=d.children.slice(),it=tt[a].clone({type:o.type});[tt[a],nt[a]]=[it,o.data[0]],c=new Schema(tt,new Map(this.schema.metadata)),d=makeData({type:new Struct(tt),children:nt})}return new Nv(c,d)}select(a){const o=this.schema.select(a),c=new Struct(o.fields),d=[];for(const tt of a){const nt=this.schema.fields.findIndex(it=>it.name===tt);~nt&&(d[nt]=this.data.children[nt])}return new Nv(o,makeData({type:c,length:this.numRows,children:d}))}selectAt(a){const o=this.schema.selectAt(a),c=a.map(tt=>this.data.children[tt]).filter(Boolean),d=makeData({type:new Struct(o.fields),length:this.numRows,children:c});return new Nv(o,d)}};_a$2=Symbol.toStringTag;RecordBatch$1[_a$2]=(s=>(s._nullCount=-1,s[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(RecordBatch$1.prototype);function ensureSameLengthData(s,a,o=a.reduce((c,d)=>Math.max(c,d.length),0)){var c;const d=[...s.fields],tt=[...a],nt=(o+63&-64)>>3;for(const[it,st]of s.fields.entries()){const ut=a[it];(!ut||ut.length!==o)&&(d[it]=st.clone({nullable:!0}),tt[it]=(c=ut?._changeLengthAndBackfillNullBitmap(o))!==null&&c!==void 0?c:makeData({type:st.type,length:o,nullCount:o,nullBitmap:new Uint8Array(nt)}))}return[s.assign(d),makeData({type:new Struct(d),length:o,children:tt})]}function collectDictionaries(s,a,o=new Map){var c,d;if(((c=s?.length)!==null&&c!==void 0?c:0)>0&&s?.length===a?.length)for(let tt=-1,nt=s.length;++tt<nt;){const{type:it}=s[tt],st=a[tt];for(const ut of[st,...((d=st?.dictionary)===null||d===void 0?void 0:d.data)||[]])collectDictionaries(it.children,ut?.children,o);if(DataType.isDictionary(it)){const{id:ut}=it;if(!o.has(ut))st?.dictionary&&o.set(ut,st.dictionary);else if(o.get(ut)!==st.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return o}class _InternalEmptyPlaceholderRecordBatch extends RecordBatch$1{constructor(a){const o=a.fields.map(d=>makeData({type:d.type})),c=makeData({type:new Struct(a.fields),nullCount:0,children:o});super(a,c)}}let Message$1=class lu{constructor(){this.bb=null,this.bb_pos=0}__init(a,o){return this.bb_pos=a,this.bb=o,this}static getRootAsMessage(a,o){return(o||new lu).__init(a.readInt32(a.position())+a.position(),a)}static getSizePrefixedRootAsMessage(a,o){return a.setPosition(a.position()+SIZE_PREFIX_LENGTH),(o||new lu).__init(a.readInt32(a.position())+a.position(),a)}version(){const a=this.bb.__offset(this.bb_pos,4);return a?this.bb.readInt16(this.bb_pos+a):MetadataVersion.V1}headerType(){const a=this.bb.__offset(this.bb_pos,6);return a?this.bb.readUint8(this.bb_pos+a):MessageHeader.NONE}header(a){const o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__union(a,this.bb_pos+o):null}bodyLength(){const a=this.bb.__offset(this.bb_pos,10);return a?this.bb.readInt64(this.bb_pos+a):BigInt("0")}customMetadata(a,o){const c=this.bb.__offset(this.bb_pos,12);return c?(o||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+a*4),this.bb):null}customMetadataLength(){const a=this.bb.__offset(this.bb_pos,12);return a?this.bb.__vector_len(this.bb_pos+a):0}static startMessage(a){a.startObject(5)}static addVersion(a,o){a.addFieldInt16(0,o,MetadataVersion.V1)}static addHeaderType(a,o){a.addFieldInt8(1,o,MessageHeader.NONE)}static addHeader(a,o){a.addFieldOffset(2,o,0)}static addBodyLength(a,o){a.addFieldInt64(3,o,BigInt("0"))}static addCustomMetadata(a,o){a.addFieldOffset(4,o,0)}static createCustomMetadataVector(a,o){a.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)a.addOffset(o[c]);return a.endVector()}static startCustomMetadataVector(a,o){a.startVector(4,o,4)}static endMessage(a){return a.endObject()}static finishMessageBuffer(a,o){a.finish(o)}static finishSizePrefixedMessageBuffer(a,o){a.finish(o,void 0,!0)}static createMessage(a,o,c,d,tt,nt){return lu.startMessage(a),lu.addVersion(a,o),lu.addHeaderType(a,c),lu.addHeader(a,d),lu.addBodyLength(a,tt),lu.addCustomMetadata(a,nt),lu.endMessage(a)}};class TypeAssembler extends Visitor{visit(a,o){return a==null||o==null?void 0:super.visit(a,o)}visitNull(a,o){return Null$1.startNull(o),Null$1.endNull(o)}visitInt(a,o){return Int.startInt(o),Int.addBitWidth(o,a.bitWidth),Int.addIsSigned(o,a.isSigned),Int.endInt(o)}visitFloat(a,o){return FloatingPoint.startFloatingPoint(o),FloatingPoint.addPrecision(o,a.precision),FloatingPoint.endFloatingPoint(o)}visitBinary(a,o){return Binary$1.startBinary(o),Binary$1.endBinary(o)}visitLargeBinary(a,o){return LargeBinary$1.startLargeBinary(o),LargeBinary$1.endLargeBinary(o)}visitBool(a,o){return Bool$1.startBool(o),Bool$1.endBool(o)}visitUtf8(a,o){return Utf8$1.startUtf8(o),Utf8$1.endUtf8(o)}visitLargeUtf8(a,o){return LargeUtf8$1.startLargeUtf8(o),LargeUtf8$1.endLargeUtf8(o)}visitDecimal(a,o){return Decimal$1.startDecimal(o),Decimal$1.addScale(o,a.scale),Decimal$1.addPrecision(o,a.precision),Decimal$1.addBitWidth(o,a.bitWidth),Decimal$1.endDecimal(o)}visitDate(a,o){return Date$1.startDate(o),Date$1.addUnit(o,a.unit),Date$1.endDate(o)}visitTime(a,o){return Time.startTime(o),Time.addUnit(o,a.unit),Time.addBitWidth(o,a.bitWidth),Time.endTime(o)}visitTimestamp(a,o){const c=a.timezone&&o.createString(a.timezone)||void 0;return Timestamp.startTimestamp(o),Timestamp.addUnit(o,a.unit),c!==void 0&&Timestamp.addTimezone(o,c),Timestamp.endTimestamp(o)}visitInterval(a,o){return Interval.startInterval(o),Interval.addUnit(o,a.unit),Interval.endInterval(o)}visitDuration(a,o){return Duration$1.startDuration(o),Duration$1.addUnit(o,a.unit),Duration$1.endDuration(o)}visitList(a,o){return List$1.startList(o),List$1.endList(o)}visitStruct(a,o){return Struct_.startStruct_(o),Struct_.endStruct_(o)}visitUnion(a,o){Union.startTypeIdsVector(o,a.typeIds.length);const c=Union.createTypeIdsVector(o,a.typeIds);return Union.startUnion(o),Union.addMode(o,a.mode),Union.addTypeIds(o,c),Union.endUnion(o)}visitDictionary(a,o){const c=this.visit(a.indices,o);return DictionaryEncoding.startDictionaryEncoding(o),DictionaryEncoding.addId(o,BigInt(a.id)),DictionaryEncoding.addIsOrdered(o,a.isOrdered),c!==void 0&&DictionaryEncoding.addIndexType(o,c),DictionaryEncoding.endDictionaryEncoding(o)}visitFixedSizeBinary(a,o){return FixedSizeBinary$1.startFixedSizeBinary(o),FixedSizeBinary$1.addByteWidth(o,a.byteWidth),FixedSizeBinary$1.endFixedSizeBinary(o)}visitFixedSizeList(a,o){return FixedSizeList$1.startFixedSizeList(o),FixedSizeList$1.addListSize(o,a.listSize),FixedSizeList$1.endFixedSizeList(o)}visitMap(a,o){return Map$1.startMap(o),Map$1.addKeysSorted(o,a.keysSorted),Map$1.endMap(o)}}const instance=new TypeAssembler;function schemaFromJSON(s,a=new Map){return new Schema(schemaFieldsFromJSON(s,a),customMetadataFromJSON(s.metadata),a)}function recordBatchFromJSON(s){return new RecordBatch(s.count,fieldNodesFromJSON(s.columns),buffersFromJSON(s.columns))}function dictionaryBatchFromJSON(s){return new DictionaryBatch(recordBatchFromJSON(s.data),s.id,s.isDelta)}function schemaFieldsFromJSON(s,a){return(s.fields||[]).filter(Boolean).map(o=>Field.fromJSON(o,a))}function fieldChildrenFromJSON(s,a){return(s.children||[]).filter(Boolean).map(o=>Field.fromJSON(o,a))}function fieldNodesFromJSON(s){return(s||[]).reduce((a,o)=>[...a,new FieldNode(o.count,nullCountFromJSON(o.VALIDITY)),...fieldNodesFromJSON(o.children)],[])}function buffersFromJSON(s,a=[]){for(let o=-1,c=(s||[]).length;++o<c;){const d=s[o];d.VALIDITY&&a.push(new BufferRegion(a.length,d.VALIDITY.length)),d.TYPE_ID&&a.push(new BufferRegion(a.length,d.TYPE_ID.length)),d.OFFSET&&a.push(new BufferRegion(a.length,d.OFFSET.length)),d.DATA&&a.push(new BufferRegion(a.length,d.DATA.length)),a=buffersFromJSON(d.children,a)}return a}function nullCountFromJSON(s){return(s||[]).reduce((a,o)=>a+ +(o===0),0)}function fieldFromJSON(s,a){let o,c,d,tt,nt,it;return!a||!(tt=s.dictionary)?(nt=typeFromJSON(s,fieldChildrenFromJSON(s,a)),d=new Field(s.name,nt,s.nullable,customMetadataFromJSON(s.metadata))):a.has(o=tt.id)?(c=(c=tt.indexType)?indexTypeFromJSON(c):new Int32,it=new Dictionary(a.get(o),c,o,tt.isOrdered),d=new Field(s.name,it,s.nullable,customMetadataFromJSON(s.metadata))):(c=(c=tt.indexType)?indexTypeFromJSON(c):new Int32,a.set(o,nt=typeFromJSON(s,fieldChildrenFromJSON(s,a))),it=new Dictionary(nt,c,o,tt.isOrdered),d=new Field(s.name,it,s.nullable,customMetadataFromJSON(s.metadata))),d||null}function customMetadataFromJSON(s=[]){return new Map(s.map(({key:a,value:o})=>[a,o]))}function indexTypeFromJSON(s){return new Int_(s.isSigned,s.bitWidth)}function typeFromJSON(s,a){const o=s.type.name;switch(o){case"NONE":return new Null;case"null":return new Null;case"binary":return new Binary;case"largebinary":return new LargeBinary;case"utf8":return new Utf8;case"largeutf8":return new LargeUtf8;case"bool":return new Bool;case"list":return new List((a||[])[0]);case"struct":return new Struct(a||[]);case"struct_":return new Struct(a||[])}switch(o){case"int":{const c=s.type;return new Int_(c.isSigned,c.bitWidth)}case"floatingpoint":{const c=s.type;return new Float(Precision[c.precision])}case"decimal":{const c=s.type;return new Decimal(c.scale,c.precision,c.bitWidth)}case"date":{const c=s.type;return new Date_(DateUnit[c.unit])}case"time":{const c=s.type;return new Time_(TimeUnit[c.unit],c.bitWidth)}case"timestamp":{const c=s.type;return new Timestamp_(TimeUnit[c.unit],c.timezone)}case"interval":{const c=s.type;return new Interval_(IntervalUnit[c.unit])}case"duration":{const c=s.type;return new Duration(TimeUnit[c.unit])}case"union":{const c=s.type,[d,...tt]=(c.mode+"").toLowerCase(),nt=d.toUpperCase()+tt.join("");return new Union_(UnionMode[nt],c.typeIds||[],a||[])}case"fixedsizebinary":{const c=s.type;return new FixedSizeBinary(c.byteWidth)}case"fixedsizelist":{const c=s.type;return new FixedSizeList(c.listSize,(a||[])[0])}case"map":{const c=s.type;return new Map_((a||[])[0],c.keysSorted)}}throw new Error(`Unrecognized type: "${o}"`)}var Builder=Builder$2,ByteBuffer=ByteBuffer$2;class Message{static fromJSON(a,o){const c=new Message(0,MetadataVersion.V5,o);return c._createHeader=messageHeaderFromJSON(a,o),c}static decode(a){a=new ByteBuffer(toUint8Array(a));const o=Message$1.getRootAsMessage(a),c=o.bodyLength(),d=o.version(),tt=o.headerType(),nt=new Message(c,d,tt);return nt._createHeader=decodeMessageHeader(o,tt),nt}static encode(a){const o=new Builder;let c=-1;return a.isSchema()?c=Schema.encode(o,a.header()):a.isRecordBatch()?c=RecordBatch.encode(o,a.header()):a.isDictionaryBatch()&&(c=DictionaryBatch.encode(o,a.header())),Message$1.startMessage(o),Message$1.addVersion(o,MetadataVersion.V5),Message$1.addHeader(o,c),Message$1.addHeaderType(o,a.headerType),Message$1.addBodyLength(o,BigInt(a.bodyLength)),Message$1.finishMessageBuffer(o,Message$1.endMessage(o)),o.asUint8Array()}static from(a,o=0){if(a instanceof Schema)return new Message(0,MetadataVersion.V5,MessageHeader.Schema,a);if(a instanceof RecordBatch)return new Message(o,MetadataVersion.V5,MessageHeader.RecordBatch,a);if(a instanceof DictionaryBatch)return new Message(o,MetadataVersion.V5,MessageHeader.DictionaryBatch,a);throw new Error(`Unrecognized Message header: ${a}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===MessageHeader.Schema}isRecordBatch(){return this.headerType===MessageHeader.RecordBatch}isDictionaryBatch(){return this.headerType===MessageHeader.DictionaryBatch}constructor(a,o,c,d){this._version=o,this._headerType=c,this.body=new Uint8Array(0),d&&(this._createHeader=()=>d),this._bodyLength=bigIntToNumber(a)}}class RecordBatch{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(a,o,c){this._nodes=o,this._buffers=c,this._length=bigIntToNumber(a)}}class DictionaryBatch{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(a,o,c=!1){this._data=a,this._isDelta=c,this._id=bigIntToNumber(o)}}class BufferRegion{constructor(a,o){this.offset=bigIntToNumber(a),this.length=bigIntToNumber(o)}}class FieldNode{constructor(a,o){this.length=bigIntToNumber(a),this.nullCount=bigIntToNumber(o)}}function messageHeaderFromJSON(s,a){return()=>{switch(a){case MessageHeader.Schema:return Schema.fromJSON(s);case MessageHeader.RecordBatch:return RecordBatch.fromJSON(s);case MessageHeader.DictionaryBatch:return DictionaryBatch.fromJSON(s)}throw new Error(`Unrecognized Message type: { name: ${MessageHeader[a]}, type: ${a} }`)}}function decodeMessageHeader(s,a){return()=>{switch(a){case MessageHeader.Schema:return Schema.decode(s.header(new Schema$1),new Map,s.version());case MessageHeader.RecordBatch:return RecordBatch.decode(s.header(new RecordBatch$2),s.version());case MessageHeader.DictionaryBatch:return DictionaryBatch.decode(s.header(new DictionaryBatch$1),s.version())}throw new Error(`Unrecognized Message type: { name: ${MessageHeader[a]}, type: ${a} }`)}}Field.encode=encodeField;Field.decode=decodeField;Field.fromJSON=fieldFromJSON;Schema.encode=encodeSchema;Schema.decode=decodeSchema;Schema.fromJSON=schemaFromJSON;RecordBatch.encode=encodeRecordBatch;RecordBatch.decode=decodeRecordBatch;RecordBatch.fromJSON=recordBatchFromJSON;DictionaryBatch.encode=encodeDictionaryBatch;DictionaryBatch.decode=decodeDictionaryBatch;DictionaryBatch.fromJSON=dictionaryBatchFromJSON;FieldNode.encode=encodeFieldNode;FieldNode.decode=decodeFieldNode;BufferRegion.encode=encodeBufferRegion;BufferRegion.decode=decodeBufferRegion;function decodeSchema(s,a=new Map,o=MetadataVersion.V5){const c=decodeSchemaFields(s,a);return new Schema(c,decodeCustomMetadata(s),a,o)}function decodeRecordBatch(s,a=MetadataVersion.V5){if(s.compression()!==null)throw new Error("Record batch compression not implemented");return new RecordBatch(s.length(),decodeFieldNodes(s),decodeBuffers(s,a))}function decodeDictionaryBatch(s,a=MetadataVersion.V5){return new DictionaryBatch(RecordBatch.decode(s.data(),a),s.id(),s.isDelta())}function decodeBufferRegion(s){return new BufferRegion(s.offset(),s.length())}function decodeFieldNode(s){return new FieldNode(s.length(),s.nullCount())}function decodeFieldNodes(s){const a=[];for(let o,c=-1,d=-1,tt=s.nodesLength();++c<tt;)(o=s.nodes(c))&&(a[++d]=FieldNode.decode(o));return a}function decodeBuffers(s,a){const o=[];for(let c,d=-1,tt=-1,nt=s.buffersLength();++d<nt;)(c=s.buffers(d))&&(a<MetadataVersion.V4&&(c.bb_pos+=8*(d+1)),o[++tt]=BufferRegion.decode(c));return o}function decodeSchemaFields(s,a){const o=[];for(let c,d=-1,tt=-1,nt=s.fieldsLength();++d<nt;)(c=s.fields(d))&&(o[++tt]=Field.decode(c,a));return o}function decodeFieldChildren(s,a){const o=[];for(let c,d=-1,tt=-1,nt=s.childrenLength();++d<nt;)(c=s.children(d))&&(o[++tt]=Field.decode(c,a));return o}function decodeField(s,a){let o,c,d,tt,nt,it;return!a||!(it=s.dictionary())?(d=decodeFieldType(s,decodeFieldChildren(s,a)),c=new Field(s.name(),d,s.nullable(),decodeCustomMetadata(s))):a.has(o=bigIntToNumber(it.id()))?(tt=(tt=it.indexType())?decodeIndexType(tt):new Int32,nt=new Dictionary(a.get(o),tt,o,it.isOrdered()),c=new Field(s.name(),nt,s.nullable(),decodeCustomMetadata(s))):(tt=(tt=it.indexType())?decodeIndexType(tt):new Int32,a.set(o,d=decodeFieldType(s,decodeFieldChildren(s,a))),nt=new Dictionary(d,tt,o,it.isOrdered()),c=new Field(s.name(),nt,s.nullable(),decodeCustomMetadata(s))),c||null}function decodeCustomMetadata(s){const a=new Map;if(s)for(let o,c,d=-1,tt=Math.trunc(s.customMetadataLength());++d<tt;)(o=s.customMetadata(d))&&(c=o.key())!=null&&a.set(c,o.value());return a}function decodeIndexType(s){return new Int_(s.isSigned(),s.bitWidth())}function decodeFieldType(s,a){const o=s.typeType();switch(o){case Type$1.NONE:return new Null;case Type$1.Null:return new Null;case Type$1.Binary:return new Binary;case Type$1.LargeBinary:return new LargeBinary;case Type$1.Utf8:return new Utf8;case Type$1.LargeUtf8:return new LargeUtf8;case Type$1.Bool:return new Bool;case Type$1.List:return new List((a||[])[0]);case Type$1.Struct_:return new Struct(a||[])}switch(o){case Type$1.Int:{const c=s.type(new Int);return new Int_(c.isSigned(),c.bitWidth())}case Type$1.FloatingPoint:{const c=s.type(new FloatingPoint);return new Float(c.precision())}case Type$1.Decimal:{const c=s.type(new Decimal$1);return new Decimal(c.scale(),c.precision(),c.bitWidth())}case Type$1.Date:{const c=s.type(new Date$1);return new Date_(c.unit())}case Type$1.Time:{const c=s.type(new Time);return new Time_(c.unit(),c.bitWidth())}case Type$1.Timestamp:{const c=s.type(new Timestamp);return new Timestamp_(c.unit(),c.timezone())}case Type$1.Interval:{const c=s.type(new Interval);return new Interval_(c.unit())}case Type$1.Duration:{const c=s.type(new Duration$1);return new Duration(c.unit())}case Type$1.Union:{const c=s.type(new Union);return new Union_(c.mode(),c.typeIdsArray()||[],a||[])}case Type$1.FixedSizeBinary:{const c=s.type(new FixedSizeBinary$1);return new FixedSizeBinary(c.byteWidth())}case Type$1.FixedSizeList:{const c=s.type(new FixedSizeList$1);return new FixedSizeList(c.listSize(),(a||[])[0])}case Type$1.Map:{const c=s.type(new Map$1);return new Map_((a||[])[0],c.keysSorted())}}throw new Error(`Unrecognized type: "${Type$1[o]}" (${o})`)}function encodeSchema(s,a){const o=a.fields.map(tt=>Field.encode(s,tt));Schema$1.startFieldsVector(s,o.length);const c=Schema$1.createFieldsVector(s,o),d=a.metadata&&a.metadata.size>0?Schema$1.createCustomMetadataVector(s,[...a.metadata].map(([tt,nt])=>{const it=s.createString(`${tt}`),st=s.createString(`${nt}`);return KeyValue.startKeyValue(s),KeyValue.addKey(s,it),KeyValue.addValue(s,st),KeyValue.endKeyValue(s)})):-1;return Schema$1.startSchema(s),Schema$1.addFields(s,c),Schema$1.addEndianness(s,platformIsLittleEndian?Endianness.Little:Endianness.Big),d!==-1&&Schema$1.addCustomMetadata(s,d),Schema$1.endSchema(s)}function encodeField(s,a){let o=-1,c=-1,d=-1;const tt=a.type;let nt=a.typeId;DataType.isDictionary(tt)?(nt=tt.dictionary.typeId,d=instance.visit(tt,s),c=instance.visit(tt.dictionary,s)):c=instance.visit(tt,s);const it=(tt.children||[]).map(ct=>Field.encode(s,ct)),st=Field$1.createChildrenVector(s,it),ut=a.metadata&&a.metadata.size>0?Field$1.createCustomMetadataVector(s,[...a.metadata].map(([ct,ot])=>{const at=s.createString(`${ct}`),ht=s.createString(`${ot}`);return KeyValue.startKeyValue(s),KeyValue.addKey(s,at),KeyValue.addValue(s,ht),KeyValue.endKeyValue(s)})):-1;return a.name&&(o=s.createString(a.name)),Field$1.startField(s),Field$1.addType(s,c),Field$1.addTypeType(s,nt),Field$1.addChildren(s,st),Field$1.addNullable(s,!!a.nullable),o!==-1&&Field$1.addName(s,o),d!==-1&&Field$1.addDictionary(s,d),ut!==-1&&Field$1.addCustomMetadata(s,ut),Field$1.endField(s)}function encodeRecordBatch(s,a){const o=a.nodes||[],c=a.buffers||[];RecordBatch$2.startNodesVector(s,o.length);for(const nt of o.slice().reverse())FieldNode.encode(s,nt);const d=s.endVector();RecordBatch$2.startBuffersVector(s,c.length);for(const nt of c.slice().reverse())BufferRegion.encode(s,nt);const tt=s.endVector();return RecordBatch$2.startRecordBatch(s),RecordBatch$2.addLength(s,BigInt(a.length)),RecordBatch$2.addNodes(s,d),RecordBatch$2.addBuffers(s,tt),RecordBatch$2.endRecordBatch(s)}function encodeDictionaryBatch(s,a){const o=RecordBatch.encode(s,a.data);return DictionaryBatch$1.startDictionaryBatch(s),DictionaryBatch$1.addId(s,BigInt(a.id)),DictionaryBatch$1.addIsDelta(s,a.isDelta),DictionaryBatch$1.addData(s,o),DictionaryBatch$1.endDictionaryBatch(s)}function encodeFieldNode(s,a){return FieldNode$1.createFieldNode(s,BigInt(a.length),BigInt(a.nullCount))}function encodeBufferRegion(s,a){return Buffer$1.createBuffer(s,BigInt(a.offset),BigInt(a.length))}const platformIsLittleEndian=(()=>{const s=new ArrayBuffer(2);return new DataView(s).setInt16(0,256,!0),new Int16Array(s)[0]===256})(),invalidMessageType=s=>`Expected ${MessageHeader[s]} Message in stream, but was null or length 0.`,nullMessage=s=>`Header pointer of flatbuffer-encoded ${MessageHeader[s]} Message is null or length 0.`,invalidMessageMetadata=(s,a)=>`Expected to read ${s} metadata bytes, but only read ${a}.`,invalidMessageBodyLength=(s,a)=>`Expected to read ${s} bytes for message body, but only read ${a}.`;class MessageReader{constructor(a){this.source=a instanceof ByteStream?a:new ByteStream(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||a.value===-1&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?ITERATOR_DONE:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let o;if((o=this.next()).done)return null;if(a!=null&&o.value.headerType!==a)throw new Error(invalidMessageType(a));return o.value}readMessageBody(a){if(a<=0)return new Uint8Array(0);const o=toUint8Array(this.source.read(a));if(o.byteLength<a)throw new Error(invalidMessageBodyLength(a,o.byteLength));return o.byteOffset%8===0&&o.byteOffset+o.byteLength<=o.buffer.byteLength?o:o.slice()}readSchema(a=!1){const o=MessageHeader.Schema,c=this.readMessage(o),d=c?.header();if(a&&!d)throw new Error(nullMessage(o));return d}readMetadataLength(){const a=this.source.read(PADDING),o=a&&new ByteBuffer$2(a),c=o?.readInt32(0)||0;return{done:c===0,value:c}}readMetadata(a){const o=this.source.read(a);if(!o)return ITERATOR_DONE;if(o.byteLength<a)throw new Error(invalidMessageMetadata(a,o.byteLength));return{done:!1,value:Message.decode(o)}}}class AsyncMessageReader{constructor(a,o){this.source=a instanceof AsyncByteStream?a:isFileHandle(a)?new AsyncRandomAccessFile(a,o):new AsyncByteStream(a)}[Symbol.asyncIterator](){return this}next(){return __awaiter(this,void 0,void 0,function*(){let a;return(a=yield this.readMetadataLength()).done||a.value===-1&&(a=yield this.readMetadataLength()).done||(a=yield this.readMetadata(a.value)).done?ITERATOR_DONE:a})}throw(a){return __awaiter(this,void 0,void 0,function*(){return yield this.source.throw(a)})}return(a){return __awaiter(this,void 0,void 0,function*(){return yield this.source.return(a)})}readMessage(a){return __awaiter(this,void 0,void 0,function*(){let o;if((o=yield this.next()).done)return null;if(a!=null&&o.value.headerType!==a)throw new Error(invalidMessageType(a));return o.value})}readMessageBody(a){return __awaiter(this,void 0,void 0,function*(){if(a<=0)return new Uint8Array(0);const o=toUint8Array(yield this.source.read(a));if(o.byteLength<a)throw new Error(invalidMessageBodyLength(a,o.byteLength));return o.byteOffset%8===0&&o.byteOffset+o.byteLength<=o.buffer.byteLength?o:o.slice()})}readSchema(){return __awaiter(this,arguments,void 0,function*(a=!1){const o=MessageHeader.Schema,c=yield this.readMessage(o),d=c?.header();if(a&&!d)throw new Error(nullMessage(o));return d})}readMetadataLength(){return __awaiter(this,void 0,void 0,function*(){const a=yield this.source.read(PADDING),o=a&&new ByteBuffer$2(a),c=o?.readInt32(0)||0;return{done:c===0,value:c}})}readMetadata(a){return __awaiter(this,void 0,void 0,function*(){const o=yield this.source.read(a);if(!o)return ITERATOR_DONE;if(o.byteLength<a)throw new Error(invalidMessageMetadata(a,o.byteLength));return{done:!1,value:Message.decode(o)}})}}class JSONMessageReader extends MessageReader{constructor(a){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=a instanceof ArrowJSON?a:new ArrowJSON(a)}next(){const{_json:a}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Message.fromJSON(a.schema,MessageHeader.Schema)};if(this._dictionaryIndex<a.dictionaries.length){const o=a.dictionaries[this._dictionaryIndex++];return this._body=o.data.columns,{done:!1,value:Message.fromJSON(o,MessageHeader.DictionaryBatch)}}if(this._batchIndex<a.batches.length){const o=a.batches[this._batchIndex++];return this._body=o.columns,{done:!1,value:Message.fromJSON(o,MessageHeader.RecordBatch)}}return this._body=[],ITERATOR_DONE}readMessageBody(a){return o(this._body);function o(c){return(c||[]).reduce((d,tt)=>[...d,...tt.VALIDITY&&[tt.VALIDITY]||[],...tt.TYPE_ID&&[tt.TYPE_ID]||[],...tt.OFFSET&&[tt.OFFSET]||[],...tt.DATA&&[tt.DATA]||[],...o(tt.children)],[])}}readMessage(a){let o;if((o=this.next()).done)return null;if(a!=null&&o.value.headerType!==a)throw new Error(invalidMessageType(a));return o.value}readSchema(){const a=MessageHeader.Schema,o=this.readMessage(a),c=o?.header();if(!o||!c)throw new Error(nullMessage(a));return c}}const PADDING=4,MAGIC_STR="ARROW1",MAGIC=new Uint8Array(MAGIC_STR.length);for(let s=0;s<MAGIC_STR.length;s+=1)MAGIC[s]=MAGIC_STR.codePointAt(s);function checkForMagicArrowString(s,a=0){for(let o=-1,c=MAGIC.length;++o<c;)if(MAGIC[o]!==s[a+o])return!1;return!0}const magicLength=MAGIC.length,magicAndPadding=magicLength+PADDING,magicX2AndPadding=magicLength*2+PADDING;class RecordBatchReader extends ReadableInterop{constructor(a){super(),this._impl=a}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(a){return this._impl.throw(a)}return(a){return this._impl.return(a)}cancel(){return this._impl.cancel()}reset(a){return this._impl.reset(a),this._DOMStream=void 0,this._nodeStream=void 0,this}open(a){const o=this._impl.open(a);return isPromise(o)?o.then(()=>this):this}readRecordBatch(a){return this._impl.isFile()?this._impl.readRecordBatch(a):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return streamAdapters.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return streamAdapters.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(a){throw new Error('"throughNode" not available in this environment')}static throughDOM(a,o){throw new Error('"throughDOM" not available in this environment')}static from(a){return a instanceof RecordBatchReader?a:isArrowJSON(a)?fromArrowJSON(a):isFileHandle(a)?fromFileHandle(a):isPromise(a)?__awaiter(this,void 0,void 0,function*(){return yield RecordBatchReader.from(yield a)}):isFetchResponse(a)||isReadableDOMStream(a)||isReadableNodeStream(a)||isAsyncIterable(a)?fromAsyncByteStream(new AsyncByteStream(a)):fromByteStream(new ByteStream(a))}static readAll(a){return a instanceof RecordBatchReader?a.isSync()?readAllSync(a):readAllAsync(a):isArrowJSON(a)||ArrayBuffer.isView(a)||isIterable(a)||isIteratorResult(a)?readAllSync(a):readAllAsync(a)}}class RecordBatchStreamReader extends RecordBatchReader{constructor(a){super(a),this._impl=a}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return __asyncGenerator(this,arguments,function*(){yield __await(yield*__asyncDelegator(__asyncValues(this[Symbol.iterator]())))})}}class AsyncRecordBatchStreamReader extends RecordBatchReader{constructor(a){super(a),this._impl=a}readAll(){return __awaiter(this,void 0,void 0,function*(){var a,o,c,d;const tt=new Array;try{for(var nt=!0,it=__asyncValues(this),st;st=yield it.next(),a=st.done,!a;nt=!0){d=st.value,nt=!1;const ut=d;tt.push(ut)}}catch(ut){o={error:ut}}finally{try{!nt&&!a&&(c=it.return)&&(yield c.call(it))}finally{if(o)throw o.error}}return tt})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class RecordBatchFileReader extends RecordBatchStreamReader{constructor(a){super(a),this._impl=a}}class AsyncRecordBatchFileReader extends AsyncRecordBatchStreamReader{constructor(a){super(a),this._impl=a}}class RecordBatchReaderImpl{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(a=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=a}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=a,this.dictionaries=new Map,this}_loadRecordBatch(a,o){const c=this._loadVectors(a,o,this.schema.fields),d=makeData({type:new Struct(this.schema.fields),length:a.length,children:c});return new RecordBatch$1(this.schema,d)}_loadDictionaryBatch(a,o){const{id:c,isDelta:d}=a,{dictionaries:tt,schema:nt}=this,it=tt.get(c),st=nt.dictionaries.get(c),ut=this._loadVectors(a.data,o,[st]);return(it&&d?it.concat(new Vector(ut)):new Vector(ut)).memoize()}_loadVectors(a,o,c){return new VectorLoader(o,a.nodes,a.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(c)}}class RecordBatchStreamReaderImpl extends RecordBatchReaderImpl{constructor(a,o){super(o),this._reader=isArrowJSON(a)?new JSONMessageReader(this._handle=a):new MessageReader(this._handle=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(a){return this.closed||(this.autoDestroy=shouldAutoDestroy(this,a),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(a):ITERATOR_DONE}return(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(a):ITERATOR_DONE}next(){if(this.closed)return ITERATOR_DONE;let a;const{_reader:o}=this;for(;a=this._readNextMessageAndValidate();)if(a.isSchema())this.reset(a.header());else if(a.isRecordBatch()){this._recordBatchIndex++;const c=a.header(),d=o.readMessageBody(a.bodyLength);return{done:!1,value:this._loadRecordBatch(c,d)}}else if(a.isDictionaryBatch()){this._dictionaryIndex++;const c=a.header(),d=o.readMessageBody(a.bodyLength),tt=this._loadDictionaryBatch(c,d);this.dictionaries.set(c.id,tt)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new _InternalEmptyPlaceholderRecordBatch(this.schema)}):this.return()}_readNextMessageAndValidate(a){return this._reader.readMessage(a)}}class AsyncRecordBatchStreamReaderImpl extends RecordBatchReaderImpl{constructor(a,o){super(o),this._reader=new AsyncMessageReader(this._handle=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return __awaiter(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(a){return __awaiter(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=shouldAutoDestroy(this,a),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(a){return __awaiter(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(a):ITERATOR_DONE})}return(a){return __awaiter(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(a):ITERATOR_DONE})}next(){return __awaiter(this,void 0,void 0,function*(){if(this.closed)return ITERATOR_DONE;let a;const{_reader:o}=this;for(;a=yield this._readNextMessageAndValidate();)if(a.isSchema())yield this.reset(a.header());else if(a.isRecordBatch()){this._recordBatchIndex++;const c=a.header(),d=yield o.readMessageBody(a.bodyLength);return{done:!1,value:this._loadRecordBatch(c,d)}}else if(a.isDictionaryBatch()){this._dictionaryIndex++;const c=a.header(),d=yield o.readMessageBody(a.bodyLength),tt=this._loadDictionaryBatch(c,d);this.dictionaries.set(c.id,tt)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new _InternalEmptyPlaceholderRecordBatch(this.schema)}):yield this.return()})}_readNextMessageAndValidate(a){return __awaiter(this,void 0,void 0,function*(){return yield this._reader.readMessage(a)})}}class RecordBatchFileReaderImpl extends RecordBatchStreamReaderImpl{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(a,o){super(a instanceof RandomAccessFile?a:new RandomAccessFile(a),o)}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const o of this._footer.dictionaryBatches())o&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(a)}readRecordBatch(a){var o;if(this.closed)return null;this._footer||this.open();const c=(o=this._footer)===null||o===void 0?void 0:o.getRecordBatch(a);if(c&&this._handle.seek(c.offset)){const d=this._reader.readMessage(MessageHeader.RecordBatch);if(d?.isRecordBatch()){const tt=d.header(),nt=this._reader.readMessageBody(d.bodyLength);return this._loadRecordBatch(tt,nt)}}return null}_readDictionaryBatch(a){var o;const c=(o=this._footer)===null||o===void 0?void 0:o.getDictionaryBatch(a);if(c&&this._handle.seek(c.offset)){const d=this._reader.readMessage(MessageHeader.DictionaryBatch);if(d?.isDictionaryBatch()){const tt=d.header(),nt=this._reader.readMessageBody(d.bodyLength),it=this._loadDictionaryBatch(tt,nt);this.dictionaries.set(tt.id,it)}}}_readFooter(){const{_handle:a}=this,o=a.size-magicAndPadding,c=a.readInt32(o),d=a.readAt(o-c,c);return Footer_.decode(d)}_readNextMessageAndValidate(a){var o;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const c=(o=this._footer)===null||o===void 0?void 0:o.getRecordBatch(this._recordBatchIndex);if(c&&this._handle.seek(c.offset))return this._reader.readMessage(a)}return null}}class AsyncRecordBatchFileReaderImpl extends AsyncRecordBatchStreamReaderImpl{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(a,...o){const c=typeof o[0]!="number"?o.shift():void 0,d=o[0]instanceof Map?o.shift():void 0;super(a instanceof AsyncRandomAccessFile?a:new AsyncRandomAccessFile(a,c),d)}isFile(){return!0}isAsync(){return!0}open(a){const o=Object.create(null,{open:{get:()=>super.open}});return __awaiter(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const c of this._footer.dictionaryBatches())c&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield o.open.call(this,a)})}readRecordBatch(a){return __awaiter(this,void 0,void 0,function*(){var o;if(this.closed)return null;this._footer||(yield this.open());const c=(o=this._footer)===null||o===void 0?void 0:o.getRecordBatch(a);if(c&&(yield this._handle.seek(c.offset))){const d=yield this._reader.readMessage(MessageHeader.RecordBatch);if(d?.isRecordBatch()){const tt=d.header(),nt=yield this._reader.readMessageBody(d.bodyLength);return this._loadRecordBatch(tt,nt)}}return null})}_readDictionaryBatch(a){return __awaiter(this,void 0,void 0,function*(){var o;const c=(o=this._footer)===null||o===void 0?void 0:o.getDictionaryBatch(a);if(c&&(yield this._handle.seek(c.offset))){const d=yield this._reader.readMessage(MessageHeader.DictionaryBatch);if(d?.isDictionaryBatch()){const tt=d.header(),nt=yield this._reader.readMessageBody(d.bodyLength),it=this._loadDictionaryBatch(tt,nt);this.dictionaries.set(tt.id,it)}}})}_readFooter(){return __awaiter(this,void 0,void 0,function*(){const{_handle:a}=this;a._pending&&(yield a._pending);const o=a.size-magicAndPadding,c=yield a.readInt32(o),d=yield a.readAt(o-c,c);return Footer_.decode(d)})}_readNextMessageAndValidate(a){return __awaiter(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const o=this._footer.getRecordBatch(this._recordBatchIndex);if(o&&(yield this._handle.seek(o.offset)))return yield this._reader.readMessage(a)}return null})}}class RecordBatchJSONReaderImpl extends RecordBatchStreamReaderImpl{constructor(a,o){super(a,o)}_loadVectors(a,o,c){return new JSONVectorLoader(o,a.nodes,a.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(c)}}function shouldAutoDestroy(s,a){return a&&typeof a.autoDestroy=="boolean"?a.autoDestroy:s.autoDestroy}function*readAllSync(s){const a=RecordBatchReader.from(s);try{if(!a.open({autoDestroy:!1}).closed)do yield a;while(!a.reset().open().closed)}finally{a.cancel()}}function readAllAsync(s){return __asyncGenerator(this,arguments,function*(){const o=yield __await(RecordBatchReader.from(s));try{if(!(yield __await(o.open({autoDestroy:!1}))).closed)do yield yield __await(o);while(!(yield __await(o.reset().open())).closed)}finally{yield __await(o.cancel())}})}function fromArrowJSON(s){return new RecordBatchStreamReader(new RecordBatchJSONReaderImpl(s))}function fromByteStream(s){const a=s.peek(magicLength+7&-8);return a&&a.byteLength>=4?checkForMagicArrowString(a)?new RecordBatchFileReader(new RecordBatchFileReaderImpl(s.read())):new RecordBatchStreamReader(new RecordBatchStreamReaderImpl(s)):new RecordBatchStreamReader(new RecordBatchStreamReaderImpl(function*(){}()))}function fromAsyncByteStream(s){return __awaiter(this,void 0,void 0,function*(){const a=yield s.peek(magicLength+7&-8);return a&&a.byteLength>=4?checkForMagicArrowString(a)?new RecordBatchFileReader(new RecordBatchFileReaderImpl(yield s.read())):new AsyncRecordBatchStreamReader(new AsyncRecordBatchStreamReaderImpl(s)):new AsyncRecordBatchStreamReader(new AsyncRecordBatchStreamReaderImpl(function(){return __asyncGenerator(this,arguments,function*(){})}()))})}function fromFileHandle(s){return __awaiter(this,void 0,void 0,function*(){const{size:a}=yield s.stat(),o=new AsyncRandomAccessFile(s,a);return a>=magicX2AndPadding&&checkForMagicArrowString(yield o.readAt(0,magicLength+7&-8))?new AsyncRecordBatchFileReader(new AsyncRecordBatchFileReaderImpl(o)):new AsyncRecordBatchStreamReader(new AsyncRecordBatchStreamReaderImpl(o))})}class VectorAssembler extends Visitor{static assemble(...a){const o=d=>d.flatMap(tt=>Array.isArray(tt)?o(tt):tt instanceof RecordBatch$1?tt.data.children:tt.data),c=new VectorAssembler;return c.visitMany(o(a)),c}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(a){if(a instanceof Vector)return this.visitMany(a.data),this;const{type:o}=a;if(!DataType.isDictionary(o)){const{length:c}=a;if(c>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(DataType.isUnion(o))this.nodes.push(new FieldNode(c,0));else{const{nullCount:d}=a;DataType.isNull(o)||addBuffer.call(this,d<=0?new Uint8Array(0):truncateBitmap(a.offset,c,a.nullBitmap)),this.nodes.push(new FieldNode(c,d))}}return super.visit(a)}visitNull(a){return this}visitDictionary(a){return this.visit(a.clone(a.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function addBuffer(s){const a=s.byteLength+7&-8;return this.buffers.push(s),this.bufferRegions.push(new BufferRegion(this._byteLength,a)),this._byteLength+=a,this}function assembleUnion(s){var a;const{type:o,length:c,typeIds:d,valueOffsets:tt}=s;if(addBuffer.call(this,d),o.mode===UnionMode.Sparse)return assembleNestedVector.call(this,s);if(o.mode===UnionMode.Dense){if(s.offset<=0)return addBuffer.call(this,tt),assembleNestedVector.call(this,s);{const nt=new Int32Array(c),it=Object.create(null),st=Object.create(null);for(let ut,ct,ot=-1;++ot<c;)(ut=d[ot])!==void 0&&((ct=it[ut])===void 0&&(ct=it[ut]=tt[ot]),nt[ot]=tt[ot]-ct,st[ut]=((a=st[ut])!==null&&a!==void 0?a:0)+1);addBuffer.call(this,nt),this.visitMany(s.children.map((ut,ct)=>{const ot=o.typeIds[ct],at=it[ot],ht=st[ot];return ut.slice(at,Math.min(c,ht))}))}}return this}function assembleBoolVector(s){let a;return s.nullCount>=s.length?addBuffer.call(this,new Uint8Array(0)):(a=s.values)instanceof Uint8Array?addBuffer.call(this,truncateBitmap(s.offset,s.length,a)):addBuffer.call(this,packBools(s.values))}function assembleFlatVector(s){return addBuffer.call(this,s.values.subarray(0,s.length*s.stride))}function assembleFlatListVector(s){const{length:a,values:o,valueOffsets:c}=s,d=bigIntToNumber(c[0]),tt=bigIntToNumber(c[a]),nt=Math.min(tt-d,o.byteLength-d);return addBuffer.call(this,rebaseValueOffsets(-d,a+1,c)),addBuffer.call(this,o.subarray(d,d+nt)),this}function assembleListVector(s){const{length:a,valueOffsets:o}=s;if(o){const{[0]:c,[a]:d}=o;return addBuffer.call(this,rebaseValueOffsets(-c,a+1,o)),this.visit(s.children[0].slice(c,d-c))}return this.visit(s.children[0])}function assembleNestedVector(s){return this.visitMany(s.type.children.map((a,o)=>s.children[o]).filter(Boolean))[0]}VectorAssembler.prototype.visitBool=assembleBoolVector;VectorAssembler.prototype.visitInt=assembleFlatVector;VectorAssembler.prototype.visitFloat=assembleFlatVector;VectorAssembler.prototype.visitUtf8=assembleFlatListVector;VectorAssembler.prototype.visitLargeUtf8=assembleFlatListVector;VectorAssembler.prototype.visitBinary=assembleFlatListVector;VectorAssembler.prototype.visitLargeBinary=assembleFlatListVector;VectorAssembler.prototype.visitFixedSizeBinary=assembleFlatVector;VectorAssembler.prototype.visitDate=assembleFlatVector;VectorAssembler.prototype.visitTimestamp=assembleFlatVector;VectorAssembler.prototype.visitTime=assembleFlatVector;VectorAssembler.prototype.visitDecimal=assembleFlatVector;VectorAssembler.prototype.visitList=assembleListVector;VectorAssembler.prototype.visitStruct=assembleNestedVector;VectorAssembler.prototype.visitUnion=assembleUnion;VectorAssembler.prototype.visitInterval=assembleFlatVector;VectorAssembler.prototype.visitDuration=assembleFlatVector;VectorAssembler.prototype.visitFixedSizeList=assembleListVector;VectorAssembler.prototype.visitMap=assembleListVector;class RecordBatchWriter extends ReadableInterop{static throughNode(a){throw new Error('"throughNode" not available in this environment')}static throughDOM(a,o){throw new Error('"throughDOM" not available in this environment')}constructor(a){super(),this._position=0,this._started=!1,this._sink=new AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,isObject$4(a)||(a={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof a.autoDestroy=="boolean"?a.autoDestroy:!0,this._writeLegacyIpcFormat=typeof a.writeLegacyIpcFormat=="boolean"?a.writeLegacyIpcFormat:!1}toString(a=!1){return this._sink.toString(a)}toUint8Array(a=!1){return this._sink.toUint8Array(a)}writeAll(a){return isPromise(a)?a.then(o=>this.writeAll(o)):isAsyncIterable(a)?writeAllAsync(this,a):writeAll(this,a)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(a){return this._sink.toDOMStream(a)}toNodeStream(a){return this._sink.toNodeStream(a)}close(){return this.reset()._sink.close()}abort(a){return this.reset()._sink.abort(a)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(a=this._sink,o=null){return a===this._sink||a instanceof AsyncByteQueue?this._sink=a:(this._sink=new AsyncByteQueue,a&&isWritableDOMStream(a)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&isWritableNodeStream(a)&&this.toNodeStream({objectMode:!1}).pipe(a)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,(!o||!compareSchemas(o,this._schema))&&(o==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=o,this._writeSchema(o))),this}write(a){let o=null;if(this._sink){if(a==null)return this.finish()&&void 0;if(a instanceof Table&&!(o=a.schema))return this.finish()&&void 0;if(a instanceof RecordBatch$1&&!(o=a.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(o&&!compareSchemas(o,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,o)}a instanceof RecordBatch$1?a instanceof _InternalEmptyPlaceholderRecordBatch||this._writeRecordBatch(a):a instanceof Table?this.writeAll(a.batches):isIterable(a)&&this.writeAll(a)}_writeMessage(a,o=8){const c=o-1,d=Message.encode(a),tt=d.byteLength,nt=this._writeLegacyIpcFormat?4:8,it=tt+nt+c&~c,st=it-tt-nt;return a.headerType===MessageHeader.RecordBatch?this._recordBatchBlocks.push(new FileBlock(it,a.bodyLength,this._position)):a.headerType===MessageHeader.DictionaryBatch&&this._dictionaryBlocks.push(new FileBlock(it,a.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(it-nt)),tt>0&&this._write(d),this._writePadding(st)}_write(a){if(this._started){const o=toUint8Array(a);o&&o.byteLength>0&&(this._sink.write(o),this._position+=o.byteLength)}return this}_writeSchema(a){return this._writeMessage(Message.from(a))}_writeFooter(a){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(MAGIC)}_writePadding(a){return a>0?this._write(new Uint8Array(a)):this}_writeRecordBatch(a){const{byteLength:o,nodes:c,bufferRegions:d,buffers:tt}=VectorAssembler.assemble(a),nt=new RecordBatch(a.numRows,c,d),it=Message.from(nt,o);return this._writeDictionaries(a)._writeMessage(it)._writeBodyBuffers(tt)}_writeDictionaryBatch(a,o,c=!1){const{byteLength:d,nodes:tt,bufferRegions:nt,buffers:it}=VectorAssembler.assemble(new Vector([a])),st=new RecordBatch(a.length,tt,nt),ut=new DictionaryBatch(st,o,c),ct=Message.from(ut,d);return this._writeMessage(ct)._writeBodyBuffers(it)}_writeBodyBuffers(a){let o,c,d;for(let tt=-1,nt=a.length;++tt<nt;)(o=a[tt])&&(c=o.byteLength)>0&&(this._write(o),(d=(c+7&-8)-c)>0&&this._writePadding(d));return this}_writeDictionaries(a){var o,c;for(const[d,tt]of a.dictionaries){const nt=(o=tt?.data)!==null&&o!==void 0?o:[],it=this._seenDictionaries.get(d),st=(c=this._dictionaryDeltaOffsets.get(d))!==null&&c!==void 0?c:0;if(!it||it.data[0]!==nt[0])for(const[ut,ct]of nt.entries())this._writeDictionaryBatch(ct,d,ut>0);else if(st<nt.length)for(const ut of nt.slice(st))this._writeDictionaryBatch(ut,d,!0);this._seenDictionaries.set(d,tt),this._dictionaryDeltaOffsets.set(d,nt.length)}return this}}class RecordBatchStreamWriter extends RecordBatchWriter{static writeAll(a,o){const c=new RecordBatchStreamWriter(o);return isPromise(a)?a.then(d=>c.writeAll(d)):isAsyncIterable(a)?writeAllAsync(c,a):writeAll(c,a)}}class RecordBatchFileWriter extends RecordBatchWriter{static writeAll(a){const o=new RecordBatchFileWriter;return isPromise(a)?a.then(c=>o.writeAll(c)):isAsyncIterable(a)?writeAllAsync(o,a):writeAll(o,a)}constructor(){super(),this._autoDestroy=!0}_writeSchema(a){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(a,o,c=!1){if(!c&&this._seenDictionaries.has(o))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(a,o,c)}_writeFooter(a){const o=Footer_.encode(new Footer_(a,MetadataVersion.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(a)._write(o)._write(Int32Array.of(o.byteLength))._writeMagic()}}function writeAll(s,a){let o=a;a instanceof Table&&(o=a.batches,s.reset(void 0,a.schema));for(const c of o)s.write(c);return s.finish()}function writeAllAsync(s,a){return __awaiter(this,void 0,void 0,function*(){var o,c,d,tt,nt,it,st;try{for(o=!0,c=__asyncValues(a);d=yield c.next(),tt=d.done,!tt;o=!0){st=d.value,o=!1;const ut=st;s.write(ut)}}catch(ut){nt={error:ut}}finally{try{!o&&!tt&&(it=c.return)&&(yield it.call(c))}finally{if(nt)throw nt.error}}return s.finish()})}function tableToIPC(s,a="stream"){return(a==="stream"?RecordBatchStreamWriter:RecordBatchFileWriter).writeAll(s).toUint8Array(!0)}var q=Object.create,h=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,K=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty,z=(s,a)=>()=>(a||s((a={exports:{}}).exports,a),a.exports),J=(s,a,o,c)=>{if(a&&typeof a=="object"||typeof a=="function")for(let d of j(a))!V.call(s,d)&&d!==o&&h(s,d,{get:()=>a[d],enumerable:!(c=Y(a,d))||c.enumerable});return s},X=(s,a,o)=>(o=s!=null?q(K(s)):{},J(!s||!s.__esModule?h(o,"default",{value:s,enumerable:!0}):o,s)),H=z((s,a)=>{a.exports=Worker}),$=(s=>(s[s.UNDEFINED=0]="UNDEFINED",s[s.AUTOMATIC=1]="AUTOMATIC",s[s.READ_ONLY=2]="READ_ONLY",s[s.READ_WRITE=3]="READ_WRITE",s))($||{}),Z=(s=>(s[s.IDENTIFIER=0]="IDENTIFIER",s[s.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",s[s.STRING_CONSTANT=2]="STRING_CONSTANT",s[s.OPERATOR=3]="OPERATOR",s[s.KEYWORD=4]="KEYWORD",s[s.COMMENT=5]="COMMENT",s))(Z||{}),ee=(s=>(s[s.NONE=0]="NONE",s[s.DEBUG=1]="DEBUG",s[s.INFO=2]="INFO",s[s.WARNING=3]="WARNING",s[s.ERROR=4]="ERROR",s))(ee||{}),re=(s=>(s[s.NONE=0]="NONE",s[s.CONNECT=1]="CONNECT",s[s.DISCONNECT=2]="DISCONNECT",s[s.OPEN=3]="OPEN",s[s.QUERY=4]="QUERY",s[s.INSTANTIATE=5]="INSTANTIATE",s))(re||{}),te=(s=>(s[s.NONE=0]="NONE",s[s.OK=1]="OK",s[s.ERROR=2]="ERROR",s[s.START=3]="START",s[s.RUN=4]="RUN",s[s.CAPTURE=5]="CAPTURE",s))(te||{}),se=(s=>(s[s.NONE=0]="NONE",s[s.WEB_WORKER=1]="WEB_WORKER",s[s.NODE_WORKER=2]="NODE_WORKER",s[s.BINDINGS=3]="BINDINGS",s[s.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",s))(se||{}),P=class{constructor(s=2){this.level=s}log(s){s.level>=this.level&&console.log(s)}},ne=(s=>(s[s.SUCCESS=0]="SUCCESS",s[s.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",s[s.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",s))(ne||{}),E=class{constructor(s,a){this._bindings=s,this._conn=a}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(s){return s(this._bindings,this._conn)}async query(s){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:s});let a=await this._bindings.runQuery(this._conn,s),o=RecordBatchReader.from(a);return console.assert(o.isSync(),"Reader is not sync"),console.assert(o.isFile(),"Reader is not file"),new Table(o)}async send(s,a=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:s});let o=await this._bindings.startPendingQuery(this._conn,s,a);for(;o==null;)o=await this._bindings.pollPendingQuery(this._conn);let c=new p(this._bindings,this._conn,o),d=await RecordBatchReader.from(c);return console.assert(d.isAsync()),console.assert(d.isStream()),d}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(s){return await this._bindings.getTableNames(this._conn,s)}async prepare(s){let a=await this._bindings.createPrepared(this._conn,s);return new I(this._bindings,this._conn,a)}async insertArrowTable(s,a){let o=tableToIPC(s,"stream");await this.insertArrowFromIPCStream(o,a)}async insertArrowFromIPCStream(s,a){await this._bindings.insertArrowFromIPCStream(this._conn,s,a)}async insertCSVFromPath(s,a){await this._bindings.insertCSVFromPath(this._conn,s,a)}async insertJSONFromPath(s,a){await this._bindings.insertJSONFromPath(this._conn,s,a)}},p=class{constructor(s,a,o){this.db=s,this.conn=a,this.header=o,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let s=null;for(this._inFlight!=null&&(s=await this._inFlight,this._inFlight=null);s==null;)s=await this.db.fetchQueryResults(this.conn);return this._depleted=s.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:s}}[Symbol.asyncIterator](){return this}},I=class{constructor(s,a,o){this.bindings=s,this.connectionId=a,this.statementId=o}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...s){let a=await this.bindings.runPrepared(this.connectionId,this.statementId,s),o=RecordBatchReader.from(a);return console.assert(o.isSync()),console.assert(o.isFile()),new Table(o)}async send(...s){let a=await this.bindings.sendPrepared(this.connectionId,this.statementId,s),o=new p(this.bindings,this.connectionId,a),c=await RecordBatchReader.from(o);return console.assert(c.isAsync()),console.assert(c.isStream()),c}},D=(s=>(s.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",s.CLOSE_PREPARED="CLOSE_PREPARED",s.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",s.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",s.CONNECT="CONNECT",s.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",s.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",s.CREATE_PREPARED="CREATE_PREPARED",s.DISCONNECT="DISCONNECT",s.DROP_FILE="DROP_FILE",s.DROP_FILES="DROP_FILES",s.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",s.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",s.FLUSH_FILES="FLUSH_FILES",s.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",s.GET_TABLE_NAMES="GET_TABLE_NAMES",s.GET_VERSION="GET_VERSION",s.GLOB_FILE_INFOS="GLOB_FILE_INFOS",s.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",s.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",s.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",s.INSTANTIATE="INSTANTIATE",s.OPEN="OPEN",s.PING="PING",s.POLL_PENDING_QUERY="POLL_PENDING_QUERY",s.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",s.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",s.REGISTER_FILE_URL="REGISTER_FILE_URL",s.RESET="RESET",s.RUN_PREPARED="RUN_PREPARED",s.RUN_QUERY="RUN_QUERY",s.SEND_PREPARED="SEND_PREPARED",s.START_PENDING_QUERY="START_PENDING_QUERY",s.TOKENIZE="TOKENIZE",s))(D||{}),L=(s=>(s.CONNECTION_INFO="CONNECTION_INFO",s.ERROR="ERROR",s.FEATURE_FLAGS="FEATURE_FLAGS",s.FILE_BUFFER="FILE_BUFFER",s.FILE_INFOS="FILE_INFOS",s.FILE_SIZE="FILE_SIZE",s.FILE_STATISTICS="FILE_STATISTICS",s.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",s.LOG="LOG",s.PROGRESS_UPDATE="PROGRESS_UPDATE",s.OK="OK",s.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",s.QUERY_PLAN="QUERY_PLAN",s.QUERY_RESULT="QUERY_RESULT",s.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",s.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",s.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",s.REGISTERED_FILE="REGISTERED_FILE",s.SCRIPT_TOKENS="SCRIPT_TOKENS",s.SUCCESS="SUCCESS",s.TABLE_NAMES="TABLE_NAMES",s.VERSION_STRING="VERSION_STRING",s))(L||{}),i$2=class{constructor(a,o){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=a,this.data=o,this.promise=new Promise((c,d)=>{this.promiseResolver=c,this.promiseRejecter=d})}};function _(s){switch(s.typeId){case Type.Binary:return{sqlType:"binary"};case Type.Bool:return{sqlType:"bool"};case Type.Date:return{sqlType:"date"};case Type.DateDay:return{sqlType:"date32[d]"};case Type.DateMillisecond:return{sqlType:"date64[ms]"};case Type.Decimal:{let a=s;return{sqlType:"decimal",precision:a.precision,scale:a.scale}}case Type.Float:return{sqlType:"float"};case Type.Float16:return{sqlType:"float16"};case Type.Float32:return{sqlType:"float32"};case Type.Float64:return{sqlType:"float64"};case Type.Int:return{sqlType:"int32"};case Type.Int16:return{sqlType:"int16"};case Type.Int32:return{sqlType:"int32"};case Type.Int64:return{sqlType:"int64"};case Type.Uint16:return{sqlType:"uint16"};case Type.Uint32:return{sqlType:"uint32"};case Type.Uint64:return{sqlType:"uint64"};case Type.Uint8:return{sqlType:"uint8"};case Type.IntervalDayTime:return{sqlType:"interval[dt]"};case Type.IntervalYearMonth:return{sqlType:"interval[m]"};case Type.List:return{sqlType:"list",valueType:_(s.valueType)};case Type.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:s.byteWidth};case Type.Null:return{sqlType:"null"};case Type.Utf8:return{sqlType:"utf8"};case Type.Struct:return{sqlType:"struct",fields:s.children.map(a=>R(a.name,a.type))};case Type.Map:{let a=s;return{sqlType:"map",keyType:_(a.keyType),valueType:_(a.valueType)}}case Type.Time:return{sqlType:"time[s]"};case Type.TimeMicrosecond:return{sqlType:"time[us]"};case Type.TimeMillisecond:return{sqlType:"time[ms]"};case Type.TimeNanosecond:return{sqlType:"time[ns]"};case Type.TimeSecond:return{sqlType:"time[s]"};case Type.Timestamp:return{sqlType:"timestamp",timezone:s.timezone||void 0};case Type.TimestampSecond:return{sqlType:"timestamp[s]",timezone:s.timezone||void 0};case Type.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:s.timezone||void 0};case Type.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:s.timezone||void 0};case Type.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:s.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(s.toString()))}function R(s,a){let o=_(a);return o.name=s,o}var oe=new TextEncoder,O=class{constructor(s,a=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=s,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),a!=null&&this.attach(a)}get logger(){return this._logger}attach(s){this._worker=s,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((a,o)=>{this._workerShutdownResolver=a})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(s,a=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let o=this._nextMessageId++;return this._pendingRequests.set(o,s),this._worker.postMessage({messageId:o,type:s.type,data:s.data},a),await s.promise}onMessage(s){var a;let o=s.data;switch(o.type){case"PROGRESS_UPDATE":{for(let d of this._onExecutionProgress)d(o.data);return}case"LOG":{this._logger.log(o.data);return}case"INSTANTIATE_PROGRESS":{for(let d of this._onInstantiationProgress)d(o.data);return}}let c=this._pendingRequests.get(o.requestId);if(!c){console.warn("unassociated response: [".concat(o.requestId,", ").concat(o.type.toString(),"]"));return}if(this._pendingRequests.delete(o.requestId),o.type=="ERROR"){let d=new Error(o.data.message);d.name=o.data.name,(a=Object.getOwnPropertyDescriptor(d,"stack"))!=null&&a.writable&&(d.stack=o.data.stack),c.promiseRejecter(d);return}switch(c.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(o.type=="OK"){c.promiseResolver(o.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],o.type=="OK"){c.promiseResolver(o.data);return}break;case"GLOB_FILE_INFOS":if(o.type=="FILE_INFOS"){c.promiseResolver(o.data);return}break;case"GET_VERSION":if(o.type=="VERSION_STRING"){c.promiseResolver(o.data);return}break;case"GET_FEATURE_FLAGS":if(o.type=="FEATURE_FLAGS"){c.promiseResolver(o.data);return}break;case"GET_TABLE_NAMES":if(o.type=="TABLE_NAMES"){c.promiseResolver(o.data);return}break;case"TOKENIZE":if(o.type=="SCRIPT_TOKENS"){c.promiseResolver(o.data);return}break;case"COPY_FILE_TO_BUFFER":if(o.type=="FILE_BUFFER"){c.promiseResolver(o.data);return}break;case"EXPORT_FILE_STATISTICS":if(o.type=="FILE_STATISTICS"){c.promiseResolver(o.data);return}break;case"CONNECT":if(o.type=="CONNECTION_INFO"){c.promiseResolver(o.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(o.type=="QUERY_RESULT"){c.promiseResolver(o.data);return}break;case"SEND_PREPARED":if(o.type=="QUERY_RESULT_HEADER"){c.promiseResolver(o.data);return}break;case"START_PENDING_QUERY":if(o.type=="QUERY_RESULT_HEADER_OR_NULL"){c.promiseResolver(o.data);return}break;case"POLL_PENDING_QUERY":if(o.type=="QUERY_RESULT_HEADER_OR_NULL"){c.promiseResolver(o.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],o.type=="SUCCESS"){c.promiseResolver(o.data);return}break;case"FETCH_QUERY_RESULTS":if(o.type=="QUERY_RESULT_CHUNK"){c.promiseResolver(o.data);return}break;case"CREATE_PREPARED":if(o.type=="PREPARED_STATEMENT_ID"){c.promiseResolver(o.data);return}break}c.promiseRejecter(new Error("unexpected response type: ".concat(o.type.toString())))}onError(s){console.error(s),console.error("error in duckdb worker: ".concat(s.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}async reset(){let s=new i$2("RESET",null);return await this.postTask(s)}async ping(){let s=new i$2("PING",null);await this.postTask(s)}async dropFile(s){let a=new i$2("DROP_FILE",s);return await this.postTask(a)}async dropFiles(){let s=new i$2("DROP_FILES",null);return await this.postTask(s)}async flushFiles(){let s=new i$2("FLUSH_FILES",null);return await this.postTask(s)}async instantiate(s,a=null,o=c=>{}){this._onInstantiationProgress.push(o);let c=new i$2("INSTANTIATE",[s,a]);return await this.postTask(c)}async getVersion(){let s=new i$2("GET_VERSION",null);return await this.postTask(s)}async getFeatureFlags(){let s=new i$2("GET_FEATURE_FLAGS",null);return await this.postTask(s)}async open(s){let a=new i$2("OPEN",s);await this.postTask(a)}async tokenize(s){let a=new i$2("TOKENIZE",s);return await this.postTask(a)}async connectInternal(){let s=new i$2("CONNECT",null);return await this.postTask(s)}async connect(){let s=await this.connectInternal();return new E(this,s)}async disconnect(s){let a=new i$2("DISCONNECT",s);await this.postTask(a)}async runQuery(s,a){let o=new i$2("RUN_QUERY",[s,a]);return await this.postTask(o)}async startPendingQuery(s,a,o=!1){let c=new i$2("START_PENDING_QUERY",[s,a,o]);return await this.postTask(c)}async pollPendingQuery(s){let a=new i$2("POLL_PENDING_QUERY",s);return await this.postTask(a)}async cancelPendingQuery(s){let a=new i$2("CANCEL_PENDING_QUERY",s);return await this.postTask(a)}async fetchQueryResults(s){let a=new i$2("FETCH_QUERY_RESULTS",s);return await this.postTask(a)}async getTableNames(s,a){let o=new i$2("GET_TABLE_NAMES",[s,a]);return await this.postTask(o)}async createPrepared(s,a){let o=new i$2("CREATE_PREPARED",[s,a]);return await this.postTask(o)}async closePrepared(s,a){let o=new i$2("CLOSE_PREPARED",[s,a]);await this.postTask(o)}async runPrepared(s,a,o){let c=new i$2("RUN_PREPARED",[s,a,o]);return await this.postTask(c)}async sendPrepared(s,a,o){let c=new i$2("SEND_PREPARED",[s,a,o]);return await this.postTask(c)}async globFiles(s){let a=new i$2("GLOB_FILE_INFOS",s);return await this.postTask(a)}async registerFileText(s,a){let o=oe.encode(a);await this.registerFileBuffer(s,o)}async registerFileURL(s,a,o,c){a===void 0&&(a=s);let d=new i$2("REGISTER_FILE_URL",[s,a,o,c]);await this.postTask(d)}async registerEmptyFileBuffer(s){}async registerFileBuffer(s,a){let o=new i$2("REGISTER_FILE_BUFFER",[s,a]);await this.postTask(o,[a.buffer])}async registerFileHandle(s,a,o,c){let d=new i$2("REGISTER_FILE_HANDLE",[s,a,o,c]);await this.postTask(d,[])}async registerOPFSFileName(s){let a=new i$2("REGISTER_OPFS_FILE_NAME",[s]);await this.postTask(a,[])}async collectFileStatistics(s,a){let o=new i$2("COLLECT_FILE_STATISTICS",[s,a]);await this.postTask(o,[])}async exportFileStatistics(s){let a=new i$2("EXPORT_FILE_STATISTICS",s);return await this.postTask(a,[])}async copyFileToBuffer(s){let a=new i$2("COPY_FILE_TO_BUFFER",s);return await this.postTask(a)}async copyFileToPath(s,a){let o=new i$2("COPY_FILE_TO_PATH",[s,a]);await this.postTask(o)}async insertArrowFromIPCStream(s,a,o){if(a.length==0)return;let c=new i$2("INSERT_ARROW_FROM_IPC_STREAM",[s,a,o]);await this.postTask(c,[a.buffer])}async insertCSVFromPath(s,a,o){if(o.columns!==void 0){let d=[];for(let tt in o.columns){let nt=o.columns[tt];d.push(R(tt,nt))}o.columnsFlat=d,delete o.columns}let c=new i$2("IMPORT_CSV_FROM_PATH",[s,a,o]);await this.postTask(c)}async insertJSONFromPath(s,a,o){if(o.columns!==void 0){let d=[];for(let tt in o.columns){let nt=o.columns[tt];d.push(R(tt,nt))}o.columnsFlat=d,delete o.columns}let c=new i$2("IMPORT_JSON_FROM_PATH",[s,a,o]);await this.postTask(c)}};function ae(){let s=new TextDecoder;return a=>(typeof SharedArrayBuffer<"u"&&a.buffer instanceof SharedArrayBuffer&&(a=new Uint8Array(a)),s.decode(a))}ae();var F=(s=>(s[s.BUFFER=0]="BUFFER",s[s.NODE_FS=1]="NODE_FS",s[s.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",s[s.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",s[s.HTTP=4]="HTTP",s[s.S3=5]="S3",s))(F||{}),f=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),C=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),U=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),W=()=>(async s=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(s)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),m$1={version:"1.30.0"},b=m$1.version.split(".");b[0];b[1];b[2];var B=()=>typeof navigator>"u",k$1=null,y=null,g=null,S=null,N=null;async function ce(){return k$1==null&&(k$1=typeof BigInt64Array<"u"),y==null&&(y=await C()),g==null&&(g=await W()),S==null&&(S=await U()),N==null&&(N=await f()),{bigInt64Array:k$1,crossOriginIsolated:B()||globalThis.crossOriginIsolated||!1,wasmExceptions:y,wasmSIMD:S,wasmThreads:g,wasmBulkMemory:N}}async function Ye(s){let a=await ce();if(a.wasmExceptions){if(a.wasmSIMD&&a.wasmThreads&&a.crossOriginIsolated&&s.coi)return{mainModule:s.coi.mainModule,mainWorker:s.coi.mainWorker,pthreadWorker:s.coi.pthreadWorker};if(s.eh)return{mainModule:s.eh.mainModule,mainWorker:s.eh.mainWorker,pthreadWorker:null}}return{mainModule:s.mvp.mainModule,mainWorker:s.mvp.mainWorker,pthreadWorker:null}}X(H());const bundles={mvp:{mainModule:asset("duckdb/duckdb-mvp.wasm"),mainWorker:asset("duckdb/duckdb-browser-mvp.worker.js")},eh:{mainModule:asset("duckdb/duckdb-eh.wasm"),mainWorker:asset("duckdb/duckdb-browser-eh.worker.js")}};let dbPromise=null,connPromise=null,httpfsReady=!1;async function getDuckDB(){return dbPromise||(dbPromise=(async()=>{const s=new P,a=await Ye(bundles),o=a.mainWorker,c=new Worker(o),d=new O(s,c);return await d.instantiate(a.mainModule),d})()),dbPromise}async function getConn(){return connPromise||(connPromise=(async()=>{const a=await(await getDuckDB()).connect();return httpfsReady||(await a.query("INSTALL httpfs; LOAD httpfs;"),httpfsReady=!0),a})()),connPromise}async function parquetQuery(s){return(await(await getConn()).query(s)).toArray()}const bust=`?v=${Date.now()}`,http=s=>`${location.origin}${asset(s)}`,PMTILES={incidents:`pmtiles://${asset("data/pmtiles/incidents.pmtiles")}${bust}`,lisa:`pmtiles://${asset("data/pmtiles/lisa_occurrence.pmtiles")}${bust}`},PARQUET={seriesMonthly:http("data/parquet/series_monthly.parquet"),seriesYearly:http("data/parquet/series_yearly.parquet"),matrixDowHour:http("data/parquet/matrix_dow_hour.parquet"),matrixDowMonth:http("data/parquet/matrix_dow_month.parquet"),incidentVars:http("data/parquet/incident_vars.parquet")};asset("data/basemap/MTL_quartier.geojson");const DOW_CODES=["DI","LU","MA","ME","JE","VE","SA"],DOW_EN_SHORT={DI:"Sun",LU:"Mon",MA:"Tue",ME:"Wed",JE:"Thu",VE:"Fri",SA:"Sat"},SEV_FR_TO_EN$1={"Dommages matériels inférieurs au seuil de rapportage":"Below reporting threshold","Dommages matériels seulement":"Property damage only",Léger:"Minor injury",Grave:"Serious injury",Mortel:"Fatal"},SEV_ORDER_FR=["Dommages matériels inférieurs au seuil de rapportage","Dommages matériels seulement","Léger","Grave","Mortel"],SEV_RED=["#E9A1A1","#E07B7B","#D84040","#B93535","#8E1616"],Chip=({active:s,label:a,onClick:o,bg:c,bgActive:d,borderActive:tt="#EDEDED"})=>{const nt=c??"#2a2a2a",it=d??"#3a3a3a";return jsxRuntimeExports.jsx("button",{onClick:o,style:{background:s?it:nt,color:"#EDEDED",border:`1px solid ${s?tt:"#262626"}`,borderRadius:8,padding:"6px 10px",fontSize:13,fontWeight:700,boxShadow:s?`0 0 0 2px ${tt} inset`:"none",cursor:"pointer",whiteSpace:"nowrap"},children:a})};function TopBar(){const{filters:s,setFilters:a,clearKey:o}=useFilters(),[c,d]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[it,st]=reactExports.useState([]),[ut,ct]=reactExports.useState([]),ot=ht=>Array.isArray(ht)?ht:[],at=(ht,ft)=>{const mt=ot(s[ht]),bt=mt.includes(ft)?mt.filter(wt=>wt!==ft):[...mt,ft];a({[ht]:bt})};return reactExports.useEffect(()=>{(async()=>{const ht=await parquetQuery(`SELECT DISTINCT CAST(AN AS INT) AS y
         FROM read_parquet('${PARQUET.incidentVars}')
         WHERE AN IS NOT NULL ORDER BY y`);d(ht.map(wt=>wt.y));const ft=await parquetQuery(`SELECT DISTINCT CAST(GRAVITE AS VARCHAR) AS s
         FROM read_parquet('${PARQUET.incidentVars}')
         WHERE GRAVITE IS NOT NULL`),mt=SEV_ORDER_FR.filter(wt=>ft.find(Tt=>Tt.s===wt));nt(mt.length?mt:SEV_ORDER_FR);const yt=await parquetQuery(`SELECT DISTINCT CAST(no_qr AS INT) AS id, CAST(nom_qr AS VARCHAR) AS name
         FROM read_parquet('${PARQUET.incidentVars}')
         WHERE no_qr IS NOT NULL AND nom_qr IS NOT NULL ORDER BY name`);st(yt);const bt=await parquetQuery(`SELECT DISTINCT CAST(no_arr AS INT) AS id, CAST(nom_arr AS VARCHAR) AS name
         FROM read_parquet('${PARQUET.incidentVars}')
         WHERE no_arr IS NOT NULL AND nom_arr IS NOT NULL ORDER BY name`);ct(bt)})()},[]),jsxRuntimeExports.jsx("div",{className:"card",style:{margin:12,position:"relative",zIndex:1e3},children:jsxRuntimeExports.jsxs("div",{className:"card-body",style:{display:"grid",gap:12},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:24,alignItems:"center",flexWrap:"wrap"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Year"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:c.map(ht=>jsxRuntimeExports.jsx(Chip,{active:ot(s.years).includes(ht),label:ht,onClick:()=>at("years",ht)},ht))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("years"),children:"Clear"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Quarter"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4].map(ht=>jsxRuntimeExports.jsx(Chip,{active:ot(s.quarters).includes(ht),label:`Q${ht}`,onClick:()=>at("quarters",ht)},ht))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("quarters"),children:"Clear"})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:24,alignItems:"center",flexWrap:"nowrap",overflowX:"auto"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"0 0 auto"},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Month"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:Array.from({length:12},(ht,ft)=>ft+1).map(ht=>jsxRuntimeExports.jsx(Chip,{active:ot(s.months).includes(ht),label:ht,onClick:()=>at("months",ht)},ht))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("months"),children:"Clear"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"0 0 auto"},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"DoW"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:DOW_CODES.map(ht=>jsxRuntimeExports.jsx(Chip,{active:ot(s.dows).includes(ht),label:DOW_EN_SHORT[ht],onClick:()=>at("dows",ht)},ht))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("dows"),children:"Clear"})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:24,alignItems:"flex-start",flexWrap:"nowrap",overflowX:"auto"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flex:"1 1 auto"},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Severity"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:tt.map((ht,ft)=>jsxRuntimeExports.jsx(Chip,{active:ot(s.severities).includes(ht),label:SEV_FR_TO_EN$1[ht]??ht,onClick:()=>at("severities",ht),bg:SEV_RED[ft]||"#D84040",bgActive:SEV_RED[ft]||"#D84040",borderActive:"#090909"},ht))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("severities"),children:"Clear"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:12,flex:"0 0 720px",alignItems:"flex-start"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Quartier"}),jsxRuntimeExports.jsx("select",{className:"select-cool",multiple:!0,size:5,value:ot(s.quartiers).map(String),onChange:ht=>{const ft=Array.from(ht.target.selectedOptions).map(mt=>Number(mt.value));a({quartiers:ft})},children:it.map(ht=>jsxRuntimeExports.jsx("option",{value:String(ht.id),children:ht.name},ht.id))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("quartiers"),children:"Clear"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[jsxRuntimeExports.jsx("span",{className:"label",children:"Arrondissement"}),jsxRuntimeExports.jsx("select",{className:"select-cool",multiple:!0,size:5,value:ot(s.arrs).map(String),onChange:ht=>{const ft=Array.from(ht.target.selectedOptions).map(mt=>Number(mt.value));a({arrs:ft})},children:ut.map(ht=>jsxRuntimeExports.jsx("option",{value:String(ht.id),children:ht.name},ht.id))}),jsxRuntimeExports.jsx("button",{onClick:()=>o("arrs"),children:"Clear"})]})]})]})]})})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics$1=function(s,a){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},extendStatics$1(s,a)};function __extends$1(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");extendStatics$1(s,a);function o(){this.constructor=s}s.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}var Browser=function(){function s(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return s}(),Env=function(){function s(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return s}(),env=new Env;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(env.wxa=!0,env.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?env.worker=!0:!env.hasGlobalWindow||"Deno"in window?(env.node=!0,env.svgSupported=!0):detect(navigator.userAgent,env);function detect(s,a){var o=a.browser,c=s.match(/Firefox\/([\d.]+)/),d=s.match(/MSIE\s([\d.]+)/)||s.match(/Trident\/.+?rv:(([\d.]+))/),tt=s.match(/Edge?\/([\d.]+)/),nt=/micromessenger/i.test(s);c&&(o.firefox=!0,o.version=c[1]),d&&(o.ie=!0,o.version=d[1]),tt&&(o.edge=!0,o.version=tt[1],o.newEdge=+tt[1].split(".")[0]>18),nt&&(o.weChat=!0),a.svgSupported=typeof SVGRect<"u",a.touchEventsSupported="ontouchstart"in window&&!o.ie&&!o.edge,a.pointerEventsSupported="onpointerdown"in window&&(o.edge||o.ie&&+o.version>=11),a.domSupported=typeof document<"u";var it=document.documentElement.style;a.transform3dSupported=(o.ie&&"transition"in it||o.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in it)&&!("OTransition"in it),a.transformSupported=a.transform3dSupported||o.ie&&+o.version>=9}var DEFAULT_FONT_SIZE=12,DEFAULT_FONT_FAMILY="sans-serif",DEFAULT_FONT=DEFAULT_FONT_SIZE+"px "+DEFAULT_FONT_FAMILY,OFFSET=20,SCALE=100,defaultWidthMapStr="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function getTextWidthMap(s){var a={};if(typeof JSON>"u")return a;for(var o=0;o<s.length;o++){var c=String.fromCharCode(o+32),d=(s.charCodeAt(o)-OFFSET)/SCALE;a[c]=d}return a}var DEFAULT_TEXT_WIDTH_MAP=getTextWidthMap(defaultWidthMapStr),platformApi={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var s,a;return function(o,c){if(!s){var d=platformApi.createCanvas();s=d&&d.getContext("2d")}if(s)return a!==c&&(a=s.font=c||DEFAULT_FONT),s.measureText(o);o=o||"",c=c||DEFAULT_FONT;var tt=/((?:\d+)?\.?\d*)px/.exec(c),nt=tt&&+tt[1]||DEFAULT_FONT_SIZE,it=0;if(c.indexOf("mono")>=0)it=nt*o.length;else for(var st=0;st<o.length;st++){var ut=DEFAULT_TEXT_WIDTH_MAP[o[st]];it+=ut==null?nt:ut*nt}return{width:it}}}(),loadImage:function(s,a,o){var c=new Image;return c.onload=a,c.onerror=o,c.src=s,c}};function setPlatformAPI(s){for(var a in platformApi)s[a]&&(platformApi[a]=s[a])}var BUILTIN_OBJECT=reduce(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(s,a){return s["[object "+a+"]"]=!0,s},{}),TYPED_ARRAY=reduce(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(s,a){return s["[object "+a+"Array]"]=!0,s},{}),objToString=Object.prototype.toString,arrayProto=Array.prototype,nativeForEach=arrayProto.forEach,nativeFilter=arrayProto.filter,nativeSlice=arrayProto.slice,nativeMap=arrayProto.map,ctorFunction=function(){}.constructor,protoFunction=ctorFunction?ctorFunction.prototype:null,protoKey="__proto__",idStart=2311;function guid(){return idStart++}function logError(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];typeof console<"u"&&console.error.apply(console,s)}function clone$4(s){if(s==null||typeof s!="object")return s;var a=s,o=objToString.call(s);if(o==="[object Array]"){if(!isPrimitive(s)){a=[];for(var c=0,d=s.length;c<d;c++)a[c]=clone$4(s[c])}}else if(TYPED_ARRAY[o]){if(!isPrimitive(s)){var tt=s.constructor;if(tt.from)a=tt.from(s);else{a=new tt(s.length);for(var c=0,d=s.length;c<d;c++)a[c]=s[c]}}}else if(!BUILTIN_OBJECT[o]&&!isPrimitive(s)&&!isDom(s)){a={};for(var nt in s)s.hasOwnProperty(nt)&&nt!==protoKey&&(a[nt]=clone$4(s[nt]))}return a}function merge(s,a,o){if(!isObject$3(a)||!isObject$3(s))return o?clone$4(a):s;for(var c in a)if(a.hasOwnProperty(c)&&c!==protoKey){var d=s[c],tt=a[c];isObject$3(tt)&&isObject$3(d)&&!isArray$1(tt)&&!isArray$1(d)&&!isDom(tt)&&!isDom(d)&&!isBuiltInObject(tt)&&!isBuiltInObject(d)&&!isPrimitive(tt)&&!isPrimitive(d)?merge(d,tt,o):(o||!(c in s))&&(s[c]=clone$4(a[c]))}return s}function mergeAll(s,a){for(var o=s[0],c=1,d=s.length;c<d;c++)o=merge(o,s[c],a);return o}function extend(s,a){if(Object.assign)Object.assign(s,a);else for(var o in a)a.hasOwnProperty(o)&&o!==protoKey&&(s[o]=a[o]);return s}function defaults(s,a,o){for(var c=keys(a),d=0,tt=c.length;d<tt;d++){var nt=c[d];(o?a[nt]!=null:s[nt]==null)&&(s[nt]=a[nt])}return s}var createCanvas=platformApi.createCanvas;function indexOf(s,a){if(s){if(s.indexOf)return s.indexOf(a);for(var o=0,c=s.length;o<c;o++)if(s[o]===a)return o}return-1}function inherits(s,a){var o=s.prototype;function c(){}c.prototype=a.prototype,s.prototype=new c;for(var d in o)o.hasOwnProperty(d)&&(s.prototype[d]=o[d]);s.prototype.constructor=s,s.superClass=a}function mixin(s,a,o){if(s="prototype"in s?s.prototype:s,a="prototype"in a?a.prototype:a,Object.getOwnPropertyNames)for(var c=Object.getOwnPropertyNames(a),d=0;d<c.length;d++){var tt=c[d];tt!=="constructor"&&(o?a[tt]!=null:s[tt]==null)&&(s[tt]=a[tt])}else defaults(s,a,o)}function isArrayLike(s){return!s||typeof s=="string"?!1:typeof s.length=="number"}function each$f(s,a,o){if(s&&a)if(s.forEach&&s.forEach===nativeForEach)s.forEach(a,o);else if(s.length===+s.length)for(var c=0,d=s.length;c<d;c++)a.call(o,s[c],c,s);else for(var tt in s)s.hasOwnProperty(tt)&&a.call(o,s[tt],tt,s)}function map$1(s,a,o){if(!s)return[];if(!a)return slice(s);if(s.map&&s.map===nativeMap)return s.map(a,o);for(var c=[],d=0,tt=s.length;d<tt;d++)c.push(a.call(o,s[d],d,s));return c}function reduce(s,a,o,c){if(s&&a){for(var d=0,tt=s.length;d<tt;d++)o=a.call(c,o,s[d],d,s);return o}}function filter(s,a,o){if(!s)return[];if(!a)return slice(s);if(s.filter&&s.filter===nativeFilter)return s.filter(a,o);for(var c=[],d=0,tt=s.length;d<tt;d++)a.call(o,s[d],d,s)&&c.push(s[d]);return c}function find(s,a,o){if(s&&a){for(var c=0,d=s.length;c<d;c++)if(a.call(o,s[c],c,s))return s[c]}}function keys(s){if(!s)return[];if(Object.keys)return Object.keys(s);var a=[];for(var o in s)s.hasOwnProperty(o)&&a.push(o);return a}function bindPolyfill(s,a){for(var o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];return function(){return s.apply(a,o.concat(nativeSlice.call(arguments)))}}var bind$2=protoFunction&&isFunction$1(protoFunction.bind)?protoFunction.call.bind(protoFunction.bind):bindPolyfill;function curry$1(s){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];return function(){return s.apply(this,a.concat(nativeSlice.call(arguments)))}}function isArray$1(s){return Array.isArray?Array.isArray(s):objToString.call(s)==="[object Array]"}function isFunction$1(s){return typeof s=="function"}function isString$1(s){return typeof s=="string"}function isStringSafe(s){return objToString.call(s)==="[object String]"}function isNumber(s){return typeof s=="number"}function isObject$3(s){var a=typeof s;return a==="function"||!!s&&a==="object"}function isBuiltInObject(s){return!!BUILTIN_OBJECT[objToString.call(s)]}function isTypedArray(s){return!!TYPED_ARRAY[objToString.call(s)]}function isDom(s){return typeof s=="object"&&typeof s.nodeType=="number"&&typeof s.ownerDocument=="object"}function isGradientObject(s){return s.colorStops!=null}function isImagePatternObject(s){return s.image!=null}function isRegExp(s){return objToString.call(s)==="[object RegExp]"}function eqNaN(s){return s!==s}function retrieve(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];for(var o=0,c=s.length;o<c;o++)if(s[o]!=null)return s[o]}function retrieve2(s,a){return s??a}function retrieve3(s,a,o){return s??a??o}function slice(s){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];return nativeSlice.apply(s,a)}function normalizeCssArray$1(s){if(typeof s=="number")return[s,s,s,s];var a=s.length;return a===2?[s[0],s[1],s[0],s[1]]:a===3?[s[0],s[1],s[2],s[1]]:s}function assert(s,a){if(!s)throw new Error(a)}function trim$1(s){return s==null?null:typeof s.trim=="function"?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var primitiveKey="__ec_primitive__";function setAsPrimitive(s){s[primitiveKey]=!0}function isPrimitive(s){return s[primitiveKey]}var MapPolyfill=function(){function s(){this.data={}}return s.prototype.delete=function(a){var o=this.has(a);return o&&delete this.data[a],o},s.prototype.has=function(a){return this.data.hasOwnProperty(a)},s.prototype.get=function(a){return this.data[a]},s.prototype.set=function(a,o){return this.data[a]=o,this},s.prototype.keys=function(){return keys(this.data)},s.prototype.forEach=function(a){var o=this.data;for(var c in o)o.hasOwnProperty(c)&&a(o[c],c)},s}(),isNativeMapSupported=typeof Map=="function";function maybeNativeMap(){return isNativeMapSupported?new Map:new MapPolyfill}var HashMap=function(){function s(a){var o=isArray$1(a);this.data=maybeNativeMap();var c=this;a instanceof s?a.each(d):a&&each$f(a,d);function d(tt,nt){o?c.set(tt,nt):c.set(nt,tt)}}return s.prototype.hasKey=function(a){return this.data.has(a)},s.prototype.get=function(a){return this.data.get(a)},s.prototype.set=function(a,o){return this.data.set(a,o),o},s.prototype.each=function(a,o){this.data.forEach(function(c,d){a.call(o,c,d)})},s.prototype.keys=function(){var a=this.data.keys();return isNativeMapSupported?Array.from(a):a},s.prototype.removeKey=function(a){this.data.delete(a)},s}();function createHashMap(s){return new HashMap(s)}function concatArray(s,a){for(var o=new s.constructor(s.length+a.length),c=0;c<s.length;c++)o[c]=s[c];for(var d=s.length,c=0;c<a.length;c++)o[c+d]=a[c];return o}function createObject(s,a){var o;if(Object.create)o=Object.create(s);else{var c=function(){};c.prototype=s,o=new c}return a&&extend(o,a),o}function disableUserSelect(s){var a=s.style;a.webkitUserSelect="none",a.userSelect="none",a.webkitTapHighlightColor="rgba(0,0,0,0)",a["-webkit-touch-callout"]="none"}function hasOwn(s,a){return s.hasOwnProperty(a)}function noop(){}var RADIAN_TO_DEGREE=180/Math.PI;const util$1=Object.freeze(Object.defineProperty({__proto__:null,HashMap,RADIAN_TO_DEGREE,assert,bind:bind$2,clone:clone$4,concatArray,createCanvas,createHashMap,createObject,curry:curry$1,defaults,disableUserSelect,each:each$f,eqNaN,extend,filter,find,guid,hasOwn,indexOf,inherits,isArray:isArray$1,isArrayLike,isBuiltInObject,isDom,isFunction:isFunction$1,isGradientObject,isImagePatternObject,isNumber,isObject:isObject$3,isPrimitive,isRegExp,isString:isString$1,isStringSafe,isTypedArray,keys,logError,map:map$1,merge,mergeAll,mixin,noop,normalizeCssArray:normalizeCssArray$1,reduce,retrieve,retrieve2,retrieve3,setAsPrimitive,slice,trim:trim$1},Symbol.toStringTag,{value:"Module"}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(s,a){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},extendStatics(s,a)};function __extends(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");extendStatics(s,a);function o(){this.constructor=s}s.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}function create$2(s,a){return s==null&&(s=0),a==null&&(a=0),[s,a]}function copy$1(s,a){return s[0]=a[0],s[1]=a[1],s}function clone$3(s){return[s[0],s[1]]}function set$1(s,a,o){return s[0]=a,s[1]=o,s}function add(s,a,o){return s[0]=a[0]+o[0],s[1]=a[1]+o[1],s}function scaleAndAdd$1(s,a,o,c){return s[0]=a[0]+o[0]*c,s[1]=a[1]+o[1]*c,s}function sub(s,a,o){return s[0]=a[0]-o[0],s[1]=a[1]-o[1],s}function len(s){return Math.sqrt(lenSquare(s))}var length=len;function lenSquare(s){return s[0]*s[0]+s[1]*s[1]}var lengthSquare=lenSquare;function mul$1(s,a,o){return s[0]=a[0]*o[0],s[1]=a[1]*o[1],s}function div(s,a,o){return s[0]=a[0]/o[0],s[1]=a[1]/o[1],s}function dot(s,a){return s[0]*a[0]+s[1]*a[1]}function scale$2(s,a,o){return s[0]=a[0]*o,s[1]=a[1]*o,s}function normalize$3(s,a){var o=len(a);return o===0?(s[0]=0,s[1]=0):(s[0]=a[0]/o,s[1]=a[1]/o),s}function distance(s,a){return Math.sqrt((s[0]-a[0])*(s[0]-a[0])+(s[1]-a[1])*(s[1]-a[1]))}var dist$1=distance;function distanceSquare(s,a){return(s[0]-a[0])*(s[0]-a[0])+(s[1]-a[1])*(s[1]-a[1])}var distSquare=distanceSquare;function negate(s,a){return s[0]=-a[0],s[1]=-a[1],s}function lerp$1(s,a,o,c){return s[0]=a[0]+c*(o[0]-a[0]),s[1]=a[1]+c*(o[1]-a[1]),s}function applyTransform$1(s,a,o){var c=a[0],d=a[1];return s[0]=o[0]*c+o[2]*d+o[4],s[1]=o[1]*c+o[3]*d+o[5],s}function min$1(s,a,o){return s[0]=Math.min(a[0],o[0]),s[1]=Math.min(a[1],o[1]),s}function max$2(s,a,o){return s[0]=Math.max(a[0],o[0]),s[1]=Math.max(a[1],o[1]),s}const vector=Object.freeze(Object.defineProperty({__proto__:null,add,applyTransform:applyTransform$1,clone:clone$3,copy:copy$1,create:create$2,dist:dist$1,distSquare,distance,distanceSquare,div,dot,len,lenSquare,length,lengthSquare,lerp:lerp$1,max:max$2,min:min$1,mul:mul$1,negate,normalize:normalize$3,scale:scale$2,scaleAndAdd:scaleAndAdd$1,set:set$1,sub},Symbol.toStringTag,{value:"Module"}));var Param=function(){function s(a,o){this.target=a,this.topTarget=o&&o.topTarget}return s}(),Draggable=function(){function s(a){this.handler=a,a.on("mousedown",this._dragStart,this),a.on("mousemove",this._drag,this),a.on("mouseup",this._dragEnd,this)}return s.prototype._dragStart=function(a){for(var o=a.target;o&&!o.draggable;)o=o.parent||o.__hostTarget;o&&(this._draggingTarget=o,o.dragging=!0,this._x=a.offsetX,this._y=a.offsetY,this.handler.dispatchToElement(new Param(o,a),"dragstart",a.event))},s.prototype._drag=function(a){var o=this._draggingTarget;if(o){var c=a.offsetX,d=a.offsetY,tt=c-this._x,nt=d-this._y;this._x=c,this._y=d,o.drift(tt,nt,a),this.handler.dispatchToElement(new Param(o,a),"drag",a.event);var it=this.handler.findHover(c,d,o).target,st=this._dropTarget;this._dropTarget=it,o!==it&&(st&&it!==st&&this.handler.dispatchToElement(new Param(st,a),"dragleave",a.event),it&&it!==st&&this.handler.dispatchToElement(new Param(it,a),"dragenter",a.event))}},s.prototype._dragEnd=function(a){var o=this._draggingTarget;o&&(o.dragging=!1),this.handler.dispatchToElement(new Param(o,a),"dragend",a.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,a),"drop",a.event),this._draggingTarget=null,this._dropTarget=null},s}(),Eventful=function(){function s(a){a&&(this._$eventProcessor=a)}return s.prototype.on=function(a,o,c,d){this._$handlers||(this._$handlers={});var tt=this._$handlers;if(typeof o=="function"&&(d=c,c=o,o=null),!c||!a)return this;var nt=this._$eventProcessor;o!=null&&nt&&nt.normalizeQuery&&(o=nt.normalizeQuery(o)),tt[a]||(tt[a]=[]);for(var it=0;it<tt[a].length;it++)if(tt[a][it].h===c)return this;var st={h:c,query:o,ctx:d||this,callAtLast:c.zrEventfulCallAtLast},ut=tt[a].length-1,ct=tt[a][ut];return ct&&ct.callAtLast?tt[a].splice(ut,0,st):tt[a].push(st),this},s.prototype.isSilent=function(a){var o=this._$handlers;return!o||!o[a]||!o[a].length},s.prototype.off=function(a,o){var c=this._$handlers;if(!c)return this;if(!a)return this._$handlers={},this;if(o){if(c[a]){for(var d=[],tt=0,nt=c[a].length;tt<nt;tt++)c[a][tt].h!==o&&d.push(c[a][tt]);c[a]=d}c[a]&&c[a].length===0&&delete c[a]}else delete c[a];return this},s.prototype.trigger=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];if(!this._$handlers)return this;var d=this._$handlers[a],tt=this._$eventProcessor;if(d)for(var nt=o.length,it=d.length,st=0;st<it;st++){var ut=d[st];if(!(tt&&tt.filter&&ut.query!=null&&!tt.filter(a,ut.query)))switch(nt){case 0:ut.h.call(ut.ctx);break;case 1:ut.h.call(ut.ctx,o[0]);break;case 2:ut.h.call(ut.ctx,o[0],o[1]);break;default:ut.h.apply(ut.ctx,o);break}}return tt&&tt.afterTrigger&&tt.afterTrigger(a),this},s.prototype.triggerWithContext=function(a){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];if(!this._$handlers)return this;var d=this._$handlers[a],tt=this._$eventProcessor;if(d)for(var nt=o.length,it=o[nt-1],st=d.length,ut=0;ut<st;ut++){var ct=d[ut];if(!(tt&&tt.filter&&ct.query!=null&&!tt.filter(a,ct.query)))switch(nt){case 0:ct.h.call(it);break;case 1:ct.h.call(it,o[0]);break;case 2:ct.h.call(it,o[0],o[1]);break;default:ct.h.apply(it,o.slice(1,nt-1));break}}return tt&&tt.afterTrigger&&tt.afterTrigger(a),this},s}(),LN2=Math.log(2);function determinant(s,a,o,c,d,tt){var nt=c+"-"+d,it=s.length;if(tt.hasOwnProperty(nt))return tt[nt];if(a===1){var st=Math.round(Math.log((1<<it)-1&~d)/LN2);return s[o][st]}for(var ut=c|1<<o,ct=o+1;c&1<<ct;)ct++;for(var ot=0,at=0,ht=0;at<it;at++){var ft=1<<at;ft&d||(ot+=(ht%2?-1:1)*s[o][at]*determinant(s,a-1,ct,ut,d|ft,tt),ht++)}return tt[nt]=ot,ot}function buildTransformer(s,a){var o=[[s[0],s[1],1,0,0,0,-a[0]*s[0],-a[0]*s[1]],[0,0,0,s[0],s[1],1,-a[1]*s[0],-a[1]*s[1]],[s[2],s[3],1,0,0,0,-a[2]*s[2],-a[2]*s[3]],[0,0,0,s[2],s[3],1,-a[3]*s[2],-a[3]*s[3]],[s[4],s[5],1,0,0,0,-a[4]*s[4],-a[4]*s[5]],[0,0,0,s[4],s[5],1,-a[5]*s[4],-a[5]*s[5]],[s[6],s[7],1,0,0,0,-a[6]*s[6],-a[6]*s[7]],[0,0,0,s[6],s[7],1,-a[7]*s[6],-a[7]*s[7]]],c={},d=determinant(o,8,0,0,0,c);if(d!==0){for(var tt=[],nt=0;nt<8;nt++)for(var it=0;it<8;it++)tt[it]==null&&(tt[it]=0),tt[it]+=((nt+it)%2?-1:1)*determinant(o,7,nt===0?1:0,1<<nt,1<<it,c)/d*a[nt];return function(st,ut,ct){var ot=ut*tt[6]+ct*tt[7]+1;st[0]=(ut*tt[0]+ct*tt[1]+tt[2])/ot,st[1]=(ut*tt[3]+ct*tt[4]+tt[5])/ot}}}var EVENT_SAVED_PROP="___zrEVENTSAVED",_calcOut$1=[];function transformLocalCoord(s,a,o,c,d){return transformCoordWithViewport(_calcOut$1,a,c,d,!0)&&transformCoordWithViewport(s,o,_calcOut$1[0],_calcOut$1[1])}function transformCoordWithViewport(s,a,o,c,d){if(a.getBoundingClientRect&&env.domSupported&&!isCanvasEl(a)){var tt=a[EVENT_SAVED_PROP]||(a[EVENT_SAVED_PROP]={}),nt=prepareCoordMarkers(a,tt),it=preparePointerTransformer(nt,tt,d);if(it)return it(s,o,c),!0}return!1}function prepareCoordMarkers(s,a){var o=a.markers;if(o)return o;o=a.markers=[];for(var c=["left","right"],d=["top","bottom"],tt=0;tt<4;tt++){var nt=document.createElement("div"),it=nt.style,st=tt%2,ut=(tt>>1)%2;it.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",c[st]+":0",d[ut]+":0",c[1-st]+":auto",d[1-ut]+":auto",""].join("!important;"),s.appendChild(nt),o.push(nt)}return o}function preparePointerTransformer(s,a,o){for(var c=o?"invTrans":"trans",d=a[c],tt=a.srcCoords,nt=[],it=[],st=!0,ut=0;ut<4;ut++){var ct=s[ut].getBoundingClientRect(),ot=2*ut,at=ct.left,ht=ct.top;nt.push(at,ht),st=st&&tt&&at===tt[ot]&&ht===tt[ot+1],it.push(s[ut].offsetLeft,s[ut].offsetTop)}return st&&d?d:(a.srcCoords=nt,a[c]=o?buildTransformer(it,nt):buildTransformer(nt,it))}function isCanvasEl(s){return s.nodeName.toUpperCase()==="CANVAS"}var replaceReg=/([&<>"'])/g,replaceMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function encodeHTML(s){return s==null?"":(s+"").replace(replaceReg,function(a,o){return replaceMap[o]})}var MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env.browser.firefox&&+env.browser.version.split(".")[0]<39;function clientToLocal(s,a,o,c){return o=o||{},c?calculateZrXY(s,a,o):firefoxNotSupportOffsetXY&&a.layerX!=null&&a.layerX!==a.offsetX?(o.zrX=a.layerX,o.zrY=a.layerY):a.offsetX!=null?(o.zrX=a.offsetX,o.zrY=a.offsetY):calculateZrXY(s,a,o),o}function calculateZrXY(s,a,o){if(env.domSupported&&s.getBoundingClientRect){var c=a.clientX,d=a.clientY;if(isCanvasEl(s)){var tt=s.getBoundingClientRect();o.zrX=c-tt.left,o.zrY=d-tt.top;return}else if(transformCoordWithViewport(_calcOut,s,c,d)){o.zrX=_calcOut[0],o.zrY=_calcOut[1];return}}o.zrX=o.zrY=0}function getNativeEvent(s){return s||window.event}function normalizeEvent(s,a,o){if(a=getNativeEvent(a),a.zrX!=null)return a;var c=a.type,d=c&&c.indexOf("touch")>=0;if(d){var nt=c!=="touchend"?a.targetTouches[0]:a.changedTouches[0];nt&&clientToLocal(s,nt,a,o)}else{clientToLocal(s,a,a,o);var tt=getWheelDeltaMayPolyfill(a);a.zrDelta=tt?tt/120:-(a.detail||0)/3}var it=a.button;return a.which==null&&it!==void 0&&MOUSE_EVENT_REG.test(a.type)&&(a.which=it&1?1:it&2?3:it&4?2:0),a}function getWheelDeltaMayPolyfill(s){var a=s.wheelDelta;if(a)return a;var o=s.deltaX,c=s.deltaY;if(o==null||c==null)return a;var d=Math.abs(c!==0?c:o),tt=c>0?-1:c<0?1:o>0?-1:1;return 3*d*tt}function addEventListener$1(s,a,o,c){s.addEventListener(a,o,c)}function removeEventListener$1(s,a,o,c){s.removeEventListener(a,o,c)}var stop=function(s){s.preventDefault(),s.stopPropagation(),s.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(s){return s.which===2||s.which===3}var GestureMgr=function(){function s(){this._track=[]}return s.prototype.recognize=function(a,o,c){return this._doTrack(a,o,c),this._recognize(a)},s.prototype.clear=function(){return this._track.length=0,this},s.prototype._doTrack=function(a,o,c){var d=a.touches;if(d){for(var tt={points:[],touches:[],target:o,event:a},nt=0,it=d.length;nt<it;nt++){var st=d[nt],ut=clientToLocal(c,st,{});tt.points.push([ut.zrX,ut.zrY]),tt.touches.push(st)}this._track.push(tt)}},s.prototype._recognize=function(a){for(var o in recognizers)if(recognizers.hasOwnProperty(o)){var c=recognizers[o](this._track,a);if(c)return c}},s}();function dist(s){var a=s[1][0]-s[0][0],o=s[1][1]-s[0][1];return Math.sqrt(a*a+o*o)}function center$1(s){return[(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2]}var recognizers={pinch:function(s,a){var o=s.length;if(o){var c=(s[o-1]||{}).points,d=(s[o-2]||{}).points||c;if(d&&d.length>1&&c&&c.length>1){var tt=dist(c)/dist(d);!isFinite(tt)&&(tt=1),a.pinchScale=tt;var nt=center$1(c);return a.pinchX=nt[0],a.pinchY=nt[1],{type:"pinch",target:s[0].target,event:a}}}}};function create$1(){return[1,0,0,1,0,0]}function identity(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=1,s[4]=0,s[5]=0,s}function copy(s,a){return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s}function mul(s,a,o){var c=a[0]*o[0]+a[2]*o[1],d=a[1]*o[0]+a[3]*o[1],tt=a[0]*o[2]+a[2]*o[3],nt=a[1]*o[2]+a[3]*o[3],it=a[0]*o[4]+a[2]*o[5]+a[4],st=a[1]*o[4]+a[3]*o[5]+a[5];return s[0]=c,s[1]=d,s[2]=tt,s[3]=nt,s[4]=it,s[5]=st,s}function translate(s,a,o){return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4]+o[0],s[5]=a[5]+o[1],s}function rotate$1(s,a,o,c){c===void 0&&(c=[0,0]);var d=a[0],tt=a[2],nt=a[4],it=a[1],st=a[3],ut=a[5],ct=Math.sin(o),ot=Math.cos(o);return s[0]=d*ot+it*ct,s[1]=-d*ct+it*ot,s[2]=tt*ot+st*ct,s[3]=-tt*ct+ot*st,s[4]=ot*(nt-c[0])+ct*(ut-c[1])+c[0],s[5]=ot*(ut-c[1])-ct*(nt-c[0])+c[1],s}function scale$1(s,a,o){var c=o[0],d=o[1];return s[0]=a[0]*c,s[1]=a[1]*d,s[2]=a[2]*c,s[3]=a[3]*d,s[4]=a[4]*c,s[5]=a[5]*d,s}function invert(s,a){var o=a[0],c=a[2],d=a[4],tt=a[1],nt=a[3],it=a[5],st=o*nt-tt*c;return st?(st=1/st,s[0]=nt*st,s[1]=-tt*st,s[2]=-c*st,s[3]=o*st,s[4]=(c*it-nt*d)*st,s[5]=(tt*d-o*it)*st,s):null}function clone$2(s){var a=create$1();return copy(a,s),a}const matrix=Object.freeze(Object.defineProperty({__proto__:null,clone:clone$2,copy,create:create$1,identity,invert,mul,rotate:rotate$1,scale:scale$1,translate},Symbol.toStringTag,{value:"Module"}));var Point=function(){function s(a,o){this.x=a||0,this.y=o||0}return s.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},s.prototype.clone=function(){return new s(this.x,this.y)},s.prototype.set=function(a,o){return this.x=a,this.y=o,this},s.prototype.equal=function(a){return a.x===this.x&&a.y===this.y},s.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},s.prototype.scale=function(a){this.x*=a,this.y*=a},s.prototype.scaleAndAdd=function(a,o){this.x+=a.x*o,this.y+=a.y*o},s.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},s.prototype.dot=function(a){return this.x*a.x+this.y*a.y},s.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},s.prototype.normalize=function(){var a=this.len();return this.x/=a,this.y/=a,this},s.prototype.distance=function(a){var o=this.x-a.x,c=this.y-a.y;return Math.sqrt(o*o+c*c)},s.prototype.distanceSquare=function(a){var o=this.x-a.x,c=this.y-a.y;return o*o+c*c},s.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},s.prototype.transform=function(a){if(a){var o=this.x,c=this.y;return this.x=a[0]*o+a[2]*c+a[4],this.y=a[1]*o+a[3]*c+a[5],this}},s.prototype.toArray=function(a){return a[0]=this.x,a[1]=this.y,a},s.prototype.fromArray=function(a){this.x=a[0],this.y=a[1]},s.set=function(a,o,c){a.x=o,a.y=c},s.copy=function(a,o){a.x=o.x,a.y=o.y},s.len=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},s.lenSquare=function(a){return a.x*a.x+a.y*a.y},s.dot=function(a,o){return a.x*o.x+a.y*o.y},s.add=function(a,o,c){a.x=o.x+c.x,a.y=o.y+c.y},s.sub=function(a,o,c){a.x=o.x-c.x,a.y=o.y-c.y},s.scale=function(a,o,c){a.x=o.x*c,a.y=o.y*c},s.scaleAndAdd=function(a,o,c,d){a.x=o.x+c.x*d,a.y=o.y+c.y*d},s.lerp=function(a,o,c,d){var tt=1-d;a.x=tt*o.x+d*c.x,a.y=tt*o.y+d*c.y},s}(),mathMin$a=Math.min,mathMax$a=Math.max,lt=new Point,rb=new Point,lb=new Point,rt=new Point,minTv$1=new Point,maxTv$1=new Point,BoundingRect=function(){function s(a,o,c,d){c<0&&(a=a+c,c=-c),d<0&&(o=o+d,d=-d),this.x=a,this.y=o,this.width=c,this.height=d}return s.prototype.union=function(a){var o=mathMin$a(a.x,this.x),c=mathMin$a(a.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax$a(a.x+a.width,this.x+this.width)-o:this.width=a.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax$a(a.y+a.height,this.y+this.height)-c:this.height=a.height,this.x=o,this.y=c},s.prototype.applyTransform=function(a){s.applyTransform(this,this,a)},s.prototype.calculateTransform=function(a){var o=this,c=a.width/o.width,d=a.height/o.height,tt=create$1();return translate(tt,tt,[-o.x,-o.y]),scale$1(tt,tt,[c,d]),translate(tt,tt,[a.x,a.y]),tt},s.prototype.intersect=function(a,o){if(!a)return!1;a instanceof s||(a=s.create(a));var c=this,d=c.x,tt=c.x+c.width,nt=c.y,it=c.y+c.height,st=a.x,ut=a.x+a.width,ct=a.y,ot=a.y+a.height,at=!(tt<st||ut<d||it<ct||ot<nt);if(o){var ht=1/0,ft=0,mt=Math.abs(tt-st),yt=Math.abs(ut-d),bt=Math.abs(it-ct),wt=Math.abs(ot-nt),Tt=Math.min(mt,yt),Ct=Math.min(bt,wt);tt<st||ut<d?Tt>ft&&(ft=Tt,mt<yt?Point.set(maxTv$1,-mt,0):Point.set(maxTv$1,yt,0)):Tt<ht&&(ht=Tt,mt<yt?Point.set(minTv$1,mt,0):Point.set(minTv$1,-yt,0)),it<ct||ot<nt?Ct>ft&&(ft=Ct,bt<wt?Point.set(maxTv$1,0,-bt):Point.set(maxTv$1,0,wt)):Tt<ht&&(ht=Tt,bt<wt?Point.set(minTv$1,0,bt):Point.set(minTv$1,0,-wt))}return o&&Point.copy(o,at?minTv$1:maxTv$1),at},s.prototype.contain=function(a,o){var c=this;return a>=c.x&&a<=c.x+c.width&&o>=c.y&&o<=c.y+c.height},s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height)},s.prototype.copy=function(a){s.copy(this,a)},s.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},s.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},s.prototype.isZero=function(){return this.width===0||this.height===0},s.create=function(a){return new s(a.x,a.y,a.width,a.height)},s.copy=function(a,o){a.x=o.x,a.y=o.y,a.width=o.width,a.height=o.height},s.applyTransform=function(a,o,c){if(!c){a!==o&&s.copy(a,o);return}if(c[1]<1e-5&&c[1]>-1e-5&&c[2]<1e-5&&c[2]>-1e-5){var d=c[0],tt=c[3],nt=c[4],it=c[5];a.x=o.x*d+nt,a.y=o.y*tt+it,a.width=o.width*d,a.height=o.height*tt,a.width<0&&(a.x+=a.width,a.width=-a.width),a.height<0&&(a.y+=a.height,a.height=-a.height);return}lt.x=lb.x=o.x,lt.y=rt.y=o.y,rb.x=rt.x=o.x+o.width,rb.y=lb.y=o.y+o.height,lt.transform(c),rt.transform(c),rb.transform(c),lb.transform(c),a.x=mathMin$a(lt.x,rb.x,lb.x,rt.x),a.y=mathMin$a(lt.y,rb.y,lb.y,rt.y);var st=mathMax$a(lt.x,rb.x,lb.x,rt.x),ut=mathMax$a(lt.y,rb.y,lb.y,rt.y);a.width=st-a.x,a.height=ut-a.y},s}(),SILENT="silent";function makeEventPacket(s,a,o){return{type:s,event:o,target:a.target,topTarget:a.topTarget,cancelBubble:!1,offsetX:o.zrX,offsetY:o.zrY,gestureEvent:o.gestureEvent,pinchX:o.pinchX,pinchY:o.pinchY,pinchScale:o.pinchScale,wheelDelta:o.zrDelta,zrByTouch:o.zrByTouch,which:o.which,stop:stopEvent}}function stopEvent(){stop(this.event)}var EmptyProxy=function(s){__extends(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.handler=null,o}return a.prototype.dispose=function(){},a.prototype.setCursor=function(){},a}(Eventful),HoveredResult=function(){function s(a,o){this.x=a,this.y=o}return s}(),handlerNames=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],tmpRect$1=new BoundingRect(0,0,0,0),Handler=function(s){__extends(a,s);function a(o,c,d,tt,nt){var it=s.call(this)||this;return it._hovered=new HoveredResult(0,0),it.storage=o,it.painter=c,it.painterRoot=tt,it._pointerSize=nt,d=d||new EmptyProxy,it.proxy=null,it.setHandlerProxy(d),it._draggingMgr=new Draggable(it),it}return a.prototype.setHandlerProxy=function(o){this.proxy&&this.proxy.dispose(),o&&(each$f(handlerNames,function(c){o.on&&o.on(c,this[c],this)},this),o.handler=this),this.proxy=o},a.prototype.mousemove=function(o){var c=o.zrX,d=o.zrY,tt=isOutsideBoundary(this,c,d),nt=this._hovered,it=nt.target;it&&!it.__zr&&(nt=this.findHover(nt.x,nt.y),it=nt.target);var st=this._hovered=tt?new HoveredResult(c,d):this.findHover(c,d),ut=st.target,ct=this.proxy;ct.setCursor&&ct.setCursor(ut?ut.cursor:"default"),it&&ut!==it&&this.dispatchToElement(nt,"mouseout",o),this.dispatchToElement(st,"mousemove",o),ut&&ut!==it&&this.dispatchToElement(st,"mouseover",o)},a.prototype.mouseout=function(o){var c=o.zrEventControl;c!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",o),c!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:o})},a.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},a.prototype.dispatch=function(o,c){var d=this[o];d&&d.call(this,c)},a.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},a.prototype.setCursorStyle=function(o){var c=this.proxy;c.setCursor&&c.setCursor(o)},a.prototype.dispatchToElement=function(o,c,d){o=o||{};var tt=o.target;if(!(tt&&tt.silent)){for(var nt="on"+c,it=makeEventPacket(c,o,d);tt&&(tt[nt]&&(it.cancelBubble=!!tt[nt].call(tt,it)),tt.trigger(c,it),tt=tt.__hostTarget?tt.__hostTarget:tt.parent,!it.cancelBubble););it.cancelBubble||(this.trigger(c,it),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(st){typeof st[nt]=="function"&&st[nt].call(st,it),st.trigger&&st.trigger(c,it)}))}},a.prototype.findHover=function(o,c,d){var tt=this.storage.getDisplayList(),nt=new HoveredResult(o,c);if(setHoverTarget(tt,nt,o,c,d),this._pointerSize&&!nt.target){for(var it=[],st=this._pointerSize,ut=st/2,ct=new BoundingRect(o-ut,c-ut,st,st),ot=tt.length-1;ot>=0;ot--){var at=tt[ot];at!==d&&!at.ignore&&!at.ignoreCoarsePointer&&(!at.parent||!at.parent.ignoreCoarsePointer)&&(tmpRect$1.copy(at.getBoundingRect()),at.transform&&tmpRect$1.applyTransform(at.transform),tmpRect$1.intersect(ct)&&it.push(at))}if(it.length)for(var ht=4,ft=Math.PI/12,mt=Math.PI*2,yt=0;yt<ut;yt+=ht)for(var bt=0;bt<mt;bt+=ft){var wt=o+yt*Math.cos(bt),Tt=c+yt*Math.sin(bt);if(setHoverTarget(it,nt,wt,Tt,d),nt.target)return nt}}return nt},a.prototype.processGesture=function(o,c){this._gestureMgr||(this._gestureMgr=new GestureMgr);var d=this._gestureMgr;c==="start"&&d.clear();var tt=d.recognize(o,this.findHover(o.zrX,o.zrY,null).target,this.proxy.dom);if(c==="end"&&d.clear(),tt){var nt=tt.type;o.gestureEvent=nt;var it=new HoveredResult;it.target=tt.target,this.dispatchToElement(it,nt,tt.event)}},a}(Eventful);each$f(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(s){Handler.prototype[s]=function(a){var o=a.zrX,c=a.zrY,d=isOutsideBoundary(this,o,c),tt,nt;if((s!=="mouseup"||!d)&&(tt=this.findHover(o,c),nt=tt.target),s==="mousedown")this._downEl=nt,this._downPoint=[a.zrX,a.zrY],this._upEl=nt;else if(s==="mouseup")this._upEl=nt;else if(s==="click"){if(this._downEl!==this._upEl||!this._downPoint||dist$1(this._downPoint,[a.zrX,a.zrY])>4)return;this._downPoint=null}this.dispatchToElement(tt,s,a)}});function isHover(s,a,o){if(s[s.rectHover?"rectContain":"contain"](a,o)){for(var c=s,d=void 0,tt=!1;c;){if(c.ignoreClip&&(tt=!0),!tt){var nt=c.getClipPath();if(nt&&!nt.contain(a,o))return!1}c.silent&&(d=!0);var it=c.__hostTarget;c=it||c.parent}return d?SILENT:!0}return!1}function setHoverTarget(s,a,o,c,d){for(var tt=s.length-1;tt>=0;tt--){var nt=s[tt],it=void 0;if(nt!==d&&!nt.ignore&&(it=isHover(nt,o,c))&&(!a.topTarget&&(a.topTarget=nt),it!==SILENT)){a.target=nt;break}}}function isOutsideBoundary(s,a,o){var c=s.painter;return a<0||a>c.getWidth()||o<0||o>c.getHeight()}var DEFAULT_MIN_MERGE=32,DEFAULT_MIN_GALLOPING=7;function minRunLength(s){for(var a=0;s>=DEFAULT_MIN_MERGE;)a|=s&1,s>>=1;return s+a}function makeAscendingRun(s,a,o,c){var d=a+1;if(d===o)return 1;if(c(s[d++],s[a])<0){for(;d<o&&c(s[d],s[d-1])<0;)d++;reverseRun(s,a,d)}else for(;d<o&&c(s[d],s[d-1])>=0;)d++;return d-a}function reverseRun(s,a,o){for(o--;a<o;){var c=s[a];s[a++]=s[o],s[o--]=c}}function binaryInsertionSort(s,a,o,c,d){for(c===a&&c++;c<o;c++){for(var tt=s[c],nt=a,it=c,st;nt<it;)st=nt+it>>>1,d(tt,s[st])<0?it=st:nt=st+1;var ut=c-nt;switch(ut){case 3:s[nt+3]=s[nt+2];case 2:s[nt+2]=s[nt+1];case 1:s[nt+1]=s[nt];break;default:for(;ut>0;)s[nt+ut]=s[nt+ut-1],ut--}s[nt]=tt}}function gallopLeft(s,a,o,c,d,tt){var nt=0,it=0,st=1;if(tt(s,a[o+d])>0){for(it=c-d;st<it&&tt(s,a[o+d+st])>0;)nt=st,st=(st<<1)+1,st<=0&&(st=it);st>it&&(st=it),nt+=d,st+=d}else{for(it=d+1;st<it&&tt(s,a[o+d-st])<=0;)nt=st,st=(st<<1)+1,st<=0&&(st=it);st>it&&(st=it);var ut=nt;nt=d-st,st=d-ut}for(nt++;nt<st;){var ct=nt+(st-nt>>>1);tt(s,a[o+ct])>0?nt=ct+1:st=ct}return st}function gallopRight(s,a,o,c,d,tt){var nt=0,it=0,st=1;if(tt(s,a[o+d])<0){for(it=d+1;st<it&&tt(s,a[o+d-st])<0;)nt=st,st=(st<<1)+1,st<=0&&(st=it);st>it&&(st=it);var ut=nt;nt=d-st,st=d-ut}else{for(it=c-d;st<it&&tt(s,a[o+d+st])>=0;)nt=st,st=(st<<1)+1,st<=0&&(st=it);st>it&&(st=it),nt+=d,st+=d}for(nt++;nt<st;){var ct=nt+(st-nt>>>1);tt(s,a[o+ct])<0?st=ct:nt=ct+1}return st}function TimSort(s,a){var o=DEFAULT_MIN_GALLOPING,c,d,tt=0,nt=[];c=[],d=[];function it(ht,ft){c[tt]=ht,d[tt]=ft,tt+=1}function st(){for(;tt>1;){var ht=tt-2;if(ht>=1&&d[ht-1]<=d[ht]+d[ht+1]||ht>=2&&d[ht-2]<=d[ht]+d[ht-1])d[ht-1]<d[ht+1]&&ht--;else if(d[ht]>d[ht+1])break;ct(ht)}}function ut(){for(;tt>1;){var ht=tt-2;ht>0&&d[ht-1]<d[ht+1]&&ht--,ct(ht)}}function ct(ht){var ft=c[ht],mt=d[ht],yt=c[ht+1],bt=d[ht+1];d[ht]=mt+bt,ht===tt-3&&(c[ht+1]=c[ht+2],d[ht+1]=d[ht+2]),tt--;var wt=gallopRight(s[yt],s,ft,mt,0,a);ft+=wt,mt-=wt,mt!==0&&(bt=gallopLeft(s[ft+mt-1],s,yt,bt,bt-1,a),bt!==0&&(mt<=bt?ot(ft,mt,yt,bt):at(ft,mt,yt,bt)))}function ot(ht,ft,mt,yt){var bt=0;for(bt=0;bt<ft;bt++)nt[bt]=s[ht+bt];var wt=0,Tt=mt,Ct=ht;if(s[Ct++]=s[Tt++],--yt===0){for(bt=0;bt<ft;bt++)s[Ct+bt]=nt[wt+bt];return}if(ft===1){for(bt=0;bt<yt;bt++)s[Ct+bt]=s[Tt+bt];s[Ct+yt]=nt[wt];return}for(var Dt=o,Ot,$t,Ft;;){Ot=0,$t=0,Ft=!1;do if(a(s[Tt],nt[wt])<0){if(s[Ct++]=s[Tt++],$t++,Ot=0,--yt===0){Ft=!0;break}}else if(s[Ct++]=nt[wt++],Ot++,$t=0,--ft===1){Ft=!0;break}while((Ot|$t)<Dt);if(Ft)break;do{if(Ot=gallopRight(s[Tt],nt,wt,ft,0,a),Ot!==0){for(bt=0;bt<Ot;bt++)s[Ct+bt]=nt[wt+bt];if(Ct+=Ot,wt+=Ot,ft-=Ot,ft<=1){Ft=!0;break}}if(s[Ct++]=s[Tt++],--yt===0){Ft=!0;break}if($t=gallopLeft(nt[wt],s,Tt,yt,0,a),$t!==0){for(bt=0;bt<$t;bt++)s[Ct+bt]=s[Tt+bt];if(Ct+=$t,Tt+=$t,yt-=$t,yt===0){Ft=!0;break}}if(s[Ct++]=nt[wt++],--ft===1){Ft=!0;break}Dt--}while(Ot>=DEFAULT_MIN_GALLOPING||$t>=DEFAULT_MIN_GALLOPING);if(Ft)break;Dt<0&&(Dt=0),Dt+=2}if(o=Dt,o<1&&(o=1),ft===1){for(bt=0;bt<yt;bt++)s[Ct+bt]=s[Tt+bt];s[Ct+yt]=nt[wt]}else{if(ft===0)throw new Error;for(bt=0;bt<ft;bt++)s[Ct+bt]=nt[wt+bt]}}function at(ht,ft,mt,yt){var bt=0;for(bt=0;bt<yt;bt++)nt[bt]=s[mt+bt];var wt=ht+ft-1,Tt=yt-1,Ct=mt+yt-1,Dt=0,Ot=0;if(s[Ct--]=s[wt--],--ft===0){for(Dt=Ct-(yt-1),bt=0;bt<yt;bt++)s[Dt+bt]=nt[bt];return}if(yt===1){for(Ct-=ft,wt-=ft,Ot=Ct+1,Dt=wt+1,bt=ft-1;bt>=0;bt--)s[Ot+bt]=s[Dt+bt];s[Ct]=nt[Tt];return}for(var $t=o;;){var Ft=0,kt=0,Vt=!1;do if(a(nt[Tt],s[wt])<0){if(s[Ct--]=s[wt--],Ft++,kt=0,--ft===0){Vt=!0;break}}else if(s[Ct--]=nt[Tt--],kt++,Ft=0,--yt===1){Vt=!0;break}while((Ft|kt)<$t);if(Vt)break;do{if(Ft=ft-gallopRight(nt[Tt],s,ht,ft,ft-1,a),Ft!==0){for(Ct-=Ft,wt-=Ft,ft-=Ft,Ot=Ct+1,Dt=wt+1,bt=Ft-1;bt>=0;bt--)s[Ot+bt]=s[Dt+bt];if(ft===0){Vt=!0;break}}if(s[Ct--]=nt[Tt--],--yt===1){Vt=!0;break}if(kt=yt-gallopLeft(s[wt],nt,0,yt,yt-1,a),kt!==0){for(Ct-=kt,Tt-=kt,yt-=kt,Ot=Ct+1,Dt=Tt+1,bt=0;bt<kt;bt++)s[Ot+bt]=nt[Dt+bt];if(yt<=1){Vt=!0;break}}if(s[Ct--]=s[wt--],--ft===0){Vt=!0;break}$t--}while(Ft>=DEFAULT_MIN_GALLOPING||kt>=DEFAULT_MIN_GALLOPING);if(Vt)break;$t<0&&($t=0),$t+=2}if(o=$t,o<1&&(o=1),yt===1){for(Ct-=ft,wt-=ft,Ot=Ct+1,Dt=wt+1,bt=ft-1;bt>=0;bt--)s[Ot+bt]=s[Dt+bt];s[Ct]=nt[Tt]}else{if(yt===0)throw new Error;for(Dt=Ct-(yt-1),bt=0;bt<yt;bt++)s[Dt+bt]=nt[bt]}}return{mergeRuns:st,forceMergeRuns:ut,pushRun:it}}function sort$2(s,a,o,c){o||(o=0),c||(c=s.length);var d=c-o;if(!(d<2)){var tt=0;if(d<DEFAULT_MIN_MERGE){tt=makeAscendingRun(s,o,c,a),binaryInsertionSort(s,o,c,o+tt,a);return}var nt=TimSort(s,a),it=minRunLength(d);do{if(tt=makeAscendingRun(s,o,c,a),tt<it){var st=d;st>it&&(st=it),binaryInsertionSort(s,o,o+st,o+tt,a),tt=st}nt.pushRun(o,tt),nt.mergeRuns(),d-=tt,o+=tt}while(d!==0);nt.forceMergeRuns()}}var REDRAW_BIT=1,STYLE_CHANGED_BIT=2,SHAPE_CHANGED_BIT=4,invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function shapeCompareFunc(s,a){return s.zlevel===a.zlevel?s.z===a.z?s.z2-a.z2:s.z-a.z:s.zlevel-a.zlevel}var Storage=function(){function s(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return s.prototype.traverse=function(a,o){for(var c=0;c<this._roots.length;c++)this._roots[c].traverse(a,o)},s.prototype.getDisplayList=function(a,o){o=o||!1;var c=this._displayList;return(a||!c.length)&&this.updateDisplayList(o),c},s.prototype.updateDisplayList=function(a){this._displayListLen=0;for(var o=this._roots,c=this._displayList,d=0,tt=o.length;d<tt;d++)this._updateAndAddDisplayable(o[d],null,a);c.length=this._displayListLen,sort$2(c,shapeCompareFunc)},s.prototype._updateAndAddDisplayable=function(a,o,c){if(!(a.ignore&&!c)){a.beforeUpdate(),a.update(),a.afterUpdate();var d=a.getClipPath();if(a.ignoreClip)o=null;else if(d){o?o=o.slice():o=[];for(var tt=d,nt=a;tt;)tt.parent=nt,tt.updateTransform(),o.push(tt),nt=tt,tt=tt.getClipPath()}if(a.childrenRef){for(var it=a.childrenRef(),st=0;st<it.length;st++){var ut=it[st];a.__dirty&&(ut.__dirty|=REDRAW_BIT),this._updateAndAddDisplayable(ut,o,c)}a.__dirty=0}else{var ct=a;o&&o.length?ct.__clipPaths=o:ct.__clipPaths&&ct.__clipPaths.length>0&&(ct.__clipPaths=[]),isNaN(ct.z)&&(logInvalidZError(),ct.z=0),isNaN(ct.z2)&&(logInvalidZError(),ct.z2=0),isNaN(ct.zlevel)&&(logInvalidZError(),ct.zlevel=0),this._displayList[this._displayListLen++]=ct}var ot=a.getDecalElement&&a.getDecalElement();ot&&this._updateAndAddDisplayable(ot,o,c);var at=a.getTextGuideLine();at&&this._updateAndAddDisplayable(at,o,c);var ht=a.getTextContent();ht&&this._updateAndAddDisplayable(ht,o,c)}},s.prototype.addRoot=function(a){a.__zr&&a.__zr.storage===this||this._roots.push(a)},s.prototype.delRoot=function(a){if(a instanceof Array){for(var o=0,c=a.length;o<c;o++)this.delRoot(a[o]);return}var d=indexOf(this._roots,a);d>=0&&this._roots.splice(d,1)},s.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},s.prototype.getRoots=function(){return this._roots},s.prototype.dispose=function(){this._displayList=null,this._roots=null},s}(),requestAnimationFrame$1;requestAnimationFrame$1=env.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(s){return setTimeout(s,16)};var easingFuncs={linear:function(s){return s},quadraticIn:function(s){return s*s},quadraticOut:function(s){return s*(2-s)},quadraticInOut:function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)},cubicIn:function(s){return s*s*s},cubicOut:function(s){return--s*s*s+1},cubicInOut:function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)},quarticIn:function(s){return s*s*s*s},quarticOut:function(s){return 1- --s*s*s*s},quarticInOut:function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)},quinticIn:function(s){return s*s*s*s*s},quinticOut:function(s){return--s*s*s*s*s+1},quinticInOut:function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)},sinusoidalIn:function(s){return 1-Math.cos(s*Math.PI/2)},sinusoidalOut:function(s){return Math.sin(s*Math.PI/2)},sinusoidalInOut:function(s){return .5*(1-Math.cos(Math.PI*s))},exponentialIn:function(s){return s===0?0:Math.pow(1024,s-1)},exponentialOut:function(s){return s===1?1:1-Math.pow(2,-10*s)},exponentialInOut:function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)},circularIn:function(s){return 1-Math.sqrt(1-s*s)},circularOut:function(s){return Math.sqrt(1- --s*s)},circularInOut:function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)},elasticIn:function(s){var a,o=.1,c=.4;return s===0?0:s===1?1:(!o||o<1?(o=1,a=c/4):a=c*Math.asin(1/o)/(2*Math.PI),-(o*Math.pow(2,10*(s-=1))*Math.sin((s-a)*(2*Math.PI)/c)))},elasticOut:function(s){var a,o=.1,c=.4;return s===0?0:s===1?1:(!o||o<1?(o=1,a=c/4):a=c*Math.asin(1/o)/(2*Math.PI),o*Math.pow(2,-10*s)*Math.sin((s-a)*(2*Math.PI)/c)+1)},elasticInOut:function(s){var a,o=.1,c=.4;return s===0?0:s===1?1:(!o||o<1?(o=1,a=c/4):a=c*Math.asin(1/o)/(2*Math.PI),(s*=2)<1?-.5*(o*Math.pow(2,10*(s-=1))*Math.sin((s-a)*(2*Math.PI)/c)):o*Math.pow(2,-10*(s-=1))*Math.sin((s-a)*(2*Math.PI)/c)*.5+1)},backIn:function(s){var a=1.70158;return s*s*((a+1)*s-a)},backOut:function(s){var a=1.70158;return--s*s*((a+1)*s+a)+1},backInOut:function(s){var a=2.5949095;return(s*=2)<1?.5*(s*s*((a+1)*s-a)):.5*((s-=2)*s*((a+1)*s+a)+2)},bounceIn:function(s){return 1-easingFuncs.bounceOut(1-s)},bounceOut:function(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},bounceInOut:function(s){return s<.5?easingFuncs.bounceIn(s*2)*.5:easingFuncs.bounceOut(s*2-1)*.5+.5}},mathPow$2=Math.pow,mathSqrt$3=Math.sqrt,EPSILON$4=1e-8,EPSILON_NUMERIC=1e-4,THREE_SQRT=mathSqrt$3(3),ONE_THIRD=1/3,_v0=create$2(),_v1=create$2(),_v2=create$2();function isAroundZero$1(s){return s>-EPSILON$4&&s<EPSILON$4}function isNotAroundZero$1(s){return s>EPSILON$4||s<-EPSILON$4}function cubicAt(s,a,o,c,d){var tt=1-d;return tt*tt*(tt*s+3*d*a)+d*d*(d*c+3*tt*o)}function cubicDerivativeAt(s,a,o,c,d){var tt=1-d;return 3*(((a-s)*tt+2*(o-a)*d)*tt+(c-o)*d*d)}function cubicRootAt(s,a,o,c,d,tt){var nt=c+3*(a-o)-s,it=3*(o-a*2+s),st=3*(a-s),ut=s-d,ct=it*it-3*nt*st,ot=it*st-9*nt*ut,at=st*st-3*it*ut,ht=0;if(isAroundZero$1(ct)&&isAroundZero$1(ot))if(isAroundZero$1(it))tt[0]=0;else{var ft=-st/it;ft>=0&&ft<=1&&(tt[ht++]=ft)}else{var mt=ot*ot-4*ct*at;if(isAroundZero$1(mt)){var yt=ot/ct,ft=-it/nt+yt,bt=-yt/2;ft>=0&&ft<=1&&(tt[ht++]=ft),bt>=0&&bt<=1&&(tt[ht++]=bt)}else if(mt>0){var wt=mathSqrt$3(mt),Tt=ct*it+1.5*nt*(-ot+wt),Ct=ct*it+1.5*nt*(-ot-wt);Tt<0?Tt=-mathPow$2(-Tt,ONE_THIRD):Tt=mathPow$2(Tt,ONE_THIRD),Ct<0?Ct=-mathPow$2(-Ct,ONE_THIRD):Ct=mathPow$2(Ct,ONE_THIRD);var ft=(-it-(Tt+Ct))/(3*nt);ft>=0&&ft<=1&&(tt[ht++]=ft)}else{var Dt=(2*ct*it-3*nt*ot)/(2*mathSqrt$3(ct*ct*ct)),Ot=Math.acos(Dt)/3,$t=mathSqrt$3(ct),Ft=Math.cos(Ot),ft=(-it-2*$t*Ft)/(3*nt),bt=(-it+$t*(Ft+THREE_SQRT*Math.sin(Ot)))/(3*nt),kt=(-it+$t*(Ft-THREE_SQRT*Math.sin(Ot)))/(3*nt);ft>=0&&ft<=1&&(tt[ht++]=ft),bt>=0&&bt<=1&&(tt[ht++]=bt),kt>=0&&kt<=1&&(tt[ht++]=kt)}}return ht}function cubicExtrema(s,a,o,c,d){var tt=6*o-12*a+6*s,nt=9*a+3*c-3*s-9*o,it=3*a-3*s,st=0;if(isAroundZero$1(nt)){if(isNotAroundZero$1(tt)){var ut=-it/tt;ut>=0&&ut<=1&&(d[st++]=ut)}}else{var ct=tt*tt-4*nt*it;if(isAroundZero$1(ct))d[0]=-tt/(2*nt);else if(ct>0){var ot=mathSqrt$3(ct),ut=(-tt+ot)/(2*nt),at=(-tt-ot)/(2*nt);ut>=0&&ut<=1&&(d[st++]=ut),at>=0&&at<=1&&(d[st++]=at)}}return st}function cubicSubdivide(s,a,o,c,d,tt){var nt=(a-s)*d+s,it=(o-a)*d+a,st=(c-o)*d+o,ut=(it-nt)*d+nt,ct=(st-it)*d+it,ot=(ct-ut)*d+ut;tt[0]=s,tt[1]=nt,tt[2]=ut,tt[3]=ot,tt[4]=ot,tt[5]=ct,tt[6]=st,tt[7]=c}function cubicProjectPoint(s,a,o,c,d,tt,nt,it,st,ut,ct){var ot,at=.005,ht=1/0,ft,mt,yt,bt;_v0[0]=st,_v0[1]=ut;for(var wt=0;wt<1;wt+=.05)_v1[0]=cubicAt(s,o,d,nt,wt),_v1[1]=cubicAt(a,c,tt,it,wt),yt=distSquare(_v0,_v1),yt<ht&&(ot=wt,ht=yt);ht=1/0;for(var Tt=0;Tt<32&&!(at<EPSILON_NUMERIC);Tt++)ft=ot-at,mt=ot+at,_v1[0]=cubicAt(s,o,d,nt,ft),_v1[1]=cubicAt(a,c,tt,it,ft),yt=distSquare(_v1,_v0),ft>=0&&yt<ht?(ot=ft,ht=yt):(_v2[0]=cubicAt(s,o,d,nt,mt),_v2[1]=cubicAt(a,c,tt,it,mt),bt=distSquare(_v2,_v0),mt<=1&&bt<ht?(ot=mt,ht=bt):at*=.5);return ct&&(ct[0]=cubicAt(s,o,d,nt,ot),ct[1]=cubicAt(a,c,tt,it,ot)),mathSqrt$3(ht)}function cubicLength(s,a,o,c,d,tt,nt,it,st){for(var ut=s,ct=a,ot=0,at=1/st,ht=1;ht<=st;ht++){var ft=ht*at,mt=cubicAt(s,o,d,nt,ft),yt=cubicAt(a,c,tt,it,ft),bt=mt-ut,wt=yt-ct;ot+=Math.sqrt(bt*bt+wt*wt),ut=mt,ct=yt}return ot}function quadraticAt$1(s,a,o,c){var d=1-c;return d*(d*s+2*c*a)+c*c*o}function quadraticDerivativeAt(s,a,o,c){return 2*((1-c)*(a-s)+c*(o-a))}function quadraticRootAt(s,a,o,c,d){var tt=s-2*a+o,nt=2*(a-s),it=s-c,st=0;if(isAroundZero$1(tt)){if(isNotAroundZero$1(nt)){var ut=-it/nt;ut>=0&&ut<=1&&(d[st++]=ut)}}else{var ct=nt*nt-4*tt*it;if(isAroundZero$1(ct)){var ut=-nt/(2*tt);ut>=0&&ut<=1&&(d[st++]=ut)}else if(ct>0){var ot=mathSqrt$3(ct),ut=(-nt+ot)/(2*tt),at=(-nt-ot)/(2*tt);ut>=0&&ut<=1&&(d[st++]=ut),at>=0&&at<=1&&(d[st++]=at)}}return st}function quadraticExtremum(s,a,o){var c=s+o-2*a;return c===0?.5:(s-a)/c}function quadraticSubdivide(s,a,o,c,d){var tt=(a-s)*c+s,nt=(o-a)*c+a,it=(nt-tt)*c+tt;d[0]=s,d[1]=tt,d[2]=it,d[3]=it,d[4]=nt,d[5]=o}function quadraticProjectPoint(s,a,o,c,d,tt,nt,it,st){var ut,ct=.005,ot=1/0;_v0[0]=nt,_v0[1]=it;for(var at=0;at<1;at+=.05){_v1[0]=quadraticAt$1(s,o,d,at),_v1[1]=quadraticAt$1(a,c,tt,at);var ht=distSquare(_v0,_v1);ht<ot&&(ut=at,ot=ht)}ot=1/0;for(var ft=0;ft<32&&!(ct<EPSILON_NUMERIC);ft++){var mt=ut-ct,yt=ut+ct;_v1[0]=quadraticAt$1(s,o,d,mt),_v1[1]=quadraticAt$1(a,c,tt,mt);var ht=distSquare(_v1,_v0);if(mt>=0&&ht<ot)ut=mt,ot=ht;else{_v2[0]=quadraticAt$1(s,o,d,yt),_v2[1]=quadraticAt$1(a,c,tt,yt);var bt=distSquare(_v2,_v0);yt<=1&&bt<ot?(ut=yt,ot=bt):ct*=.5}}return st&&(st[0]=quadraticAt$1(s,o,d,ut),st[1]=quadraticAt$1(a,c,tt,ut)),mathSqrt$3(ot)}function quadraticLength(s,a,o,c,d,tt,nt){for(var it=s,st=a,ut=0,ct=1/nt,ot=1;ot<=nt;ot++){var at=ot*ct,ht=quadraticAt$1(s,o,d,at),ft=quadraticAt$1(a,c,tt,at),mt=ht-it,yt=ft-st;ut+=Math.sqrt(mt*mt+yt*yt),it=ht,st=ft}return ut}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(s){var a=s&&regexp.exec(s);if(a){var o=a[1].split(","),c=+trim$1(o[0]),d=+trim$1(o[1]),tt=+trim$1(o[2]),nt=+trim$1(o[3]);if(isNaN(c+d+tt+nt))return;var it=[];return function(st){return st<=0?0:st>=1?1:cubicRootAt(0,c,tt,1,st,it)&&cubicAt(0,d,nt,1,it[0])}}}var Clip=function(){function s(a){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=a.life||1e3,this._delay=a.delay||0,this.loop=a.loop||!1,this.onframe=a.onframe||noop,this.ondestroy=a.ondestroy||noop,this.onrestart=a.onrestart||noop,a.easing&&this.setEasing(a.easing)}return s.prototype.step=function(a,o){if(this._inited||(this._startTime=a+this._delay,this._inited=!0),this._paused){this._pausedTime+=o;return}var c=this._life,d=a-this._startTime-this._pausedTime,tt=d/c;tt<0&&(tt=0),tt=Math.min(tt,1);var nt=this.easingFunc,it=nt?nt(tt):tt;if(this.onframe(it),tt===1)if(this.loop){var st=d%c;this._startTime=a-st,this._pausedTime=0,this.onrestart()}else return!0;return!1},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){this._paused=!1},s.prototype.setEasing=function(a){this.easing=a,this.easingFunc=isFunction$1(a)?a:easingFuncs[a]||createCubicEasingFunc(a)},s}(),Entry=function(){function s(a){this.value=a}return s}(),LinkedList=function(){function s(){this._len=0}return s.prototype.insert=function(a){var o=new Entry(a);return this.insertEntry(o),o},s.prototype.insertEntry=function(a){this.head?(this.tail.next=a,a.prev=this.tail,a.next=null,this.tail=a):this.head=this.tail=a,this._len++},s.prototype.remove=function(a){var o=a.prev,c=a.next;o?o.next=c:this.head=c,c?c.prev=o:this.tail=o,a.next=a.prev=null,this._len--},s.prototype.len=function(){return this._len},s.prototype.clear=function(){this.head=this.tail=null,this._len=0},s}(),LRU=function(){function s(a){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=a}return s.prototype.put=function(a,o){var c=this._list,d=this._map,tt=null;if(d[a]==null){var nt=c.len(),it=this._lastRemovedEntry;if(nt>=this._maxSize&&nt>0){var st=c.head;c.remove(st),delete d[st.key],tt=st.value,this._lastRemovedEntry=st}it?it.value=o:it=new Entry(o),it.key=a,c.insertEntry(it),d[a]=it}return tt},s.prototype.get=function(a){var o=this._map[a],c=this._list;if(o!=null)return o!==c.tail&&(c.remove(o),c.insertEntry(o)),o.value},s.prototype.clear=function(){this._list.clear(),this._map={}},s.prototype.len=function(){return this._list.len()},s}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(s){return s=Math.round(s),s<0?0:s>255?255:s}function clampCssAngle(s){return s=Math.round(s),s<0?0:s>360?360:s}function clampCssFloat(s){return s<0?0:s>1?1:s}function parseCssInt(s){var a=s;return a.length&&a.charAt(a.length-1)==="%"?clampCssByte(parseFloat(a)/100*255):clampCssByte(parseInt(a,10))}function parseCssFloat(s){var a=s;return a.length&&a.charAt(a.length-1)==="%"?clampCssFloat(parseFloat(a)/100):clampCssFloat(parseFloat(a))}function cssHueToRgb(s,a,o){return o<0?o+=1:o>1&&(o-=1),o*6<1?s+(a-s)*o*6:o*2<1?a:o*3<2?s+(a-s)*(2/3-o)*6:s}function lerpNumber(s,a,o){return s+(a-s)*o}function setRgba(s,a,o,c,d){return s[0]=a,s[1]=o,s[2]=c,s[3]=d,s}function copyRgba(s,a){return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s}var colorCache=new LRU(20),lastRemovedArr=null;function putToCache(s,a){lastRemovedArr&&copyRgba(lastRemovedArr,a),lastRemovedArr=colorCache.put(s,lastRemovedArr||a.slice())}function parse(s,a){if(s){a=a||[];var o=colorCache.get(s);if(o)return copyRgba(a,o);s=s+"";var c=s.replace(/ /g,"").toLowerCase();if(c in kCSSColorTable)return copyRgba(a,kCSSColorTable[c]),putToCache(s,a),a;var d=c.length;if(c.charAt(0)==="#"){if(d===4||d===5){var tt=parseInt(c.slice(1,4),16);if(!(tt>=0&&tt<=4095)){setRgba(a,0,0,0,1);return}return setRgba(a,(tt&3840)>>4|(tt&3840)>>8,tt&240|(tt&240)>>4,tt&15|(tt&15)<<4,d===5?parseInt(c.slice(4),16)/15:1),putToCache(s,a),a}else if(d===7||d===9){var tt=parseInt(c.slice(1,7),16);if(!(tt>=0&&tt<=16777215)){setRgba(a,0,0,0,1);return}return setRgba(a,(tt&16711680)>>16,(tt&65280)>>8,tt&255,d===9?parseInt(c.slice(7),16)/255:1),putToCache(s,a),a}return}var nt=c.indexOf("("),it=c.indexOf(")");if(nt!==-1&&it+1===d){var st=c.substr(0,nt),ut=c.substr(nt+1,it-(nt+1)).split(","),ct=1;switch(st){case"rgba":if(ut.length!==4)return ut.length===3?setRgba(a,+ut[0],+ut[1],+ut[2],1):setRgba(a,0,0,0,1);ct=parseCssFloat(ut.pop());case"rgb":if(ut.length>=3)return setRgba(a,parseCssInt(ut[0]),parseCssInt(ut[1]),parseCssInt(ut[2]),ut.length===3?ct:parseCssFloat(ut[3])),putToCache(s,a),a;setRgba(a,0,0,0,1);return;case"hsla":if(ut.length!==4){setRgba(a,0,0,0,1);return}return ut[3]=parseCssFloat(ut[3]),hsla2rgba(ut,a),putToCache(s,a),a;case"hsl":if(ut.length!==3){setRgba(a,0,0,0,1);return}return hsla2rgba(ut,a),putToCache(s,a),a;default:return}}setRgba(a,0,0,0,1)}}function hsla2rgba(s,a){var o=(parseFloat(s[0])%360+360)%360/360,c=parseCssFloat(s[1]),d=parseCssFloat(s[2]),tt=d<=.5?d*(c+1):d+c-d*c,nt=d*2-tt;return a=a||[],setRgba(a,clampCssByte(cssHueToRgb(nt,tt,o+1/3)*255),clampCssByte(cssHueToRgb(nt,tt,o)*255),clampCssByte(cssHueToRgb(nt,tt,o-1/3)*255),1),s.length===4&&(a[3]=s[3]),a}function rgba2hsla(s){if(s){var a=s[0]/255,o=s[1]/255,c=s[2]/255,d=Math.min(a,o,c),tt=Math.max(a,o,c),nt=tt-d,it=(tt+d)/2,st,ut;if(nt===0)st=0,ut=0;else{it<.5?ut=nt/(tt+d):ut=nt/(2-tt-d);var ct=((tt-a)/6+nt/2)/nt,ot=((tt-o)/6+nt/2)/nt,at=((tt-c)/6+nt/2)/nt;a===tt?st=at-ot:o===tt?st=1/3+ct-at:c===tt&&(st=2/3+ot-ct),st<0&&(st+=1),st>1&&(st-=1)}var ht=[st*360,ut,it];return s[3]!=null&&ht.push(s[3]),ht}}function lift(s,a){var o=parse(s);if(o){for(var c=0;c<3;c++)a<0?o[c]=o[c]*(1-a)|0:o[c]=(255-o[c])*a+o[c]|0,o[c]>255?o[c]=255:o[c]<0&&(o[c]=0);return stringify(o,o.length===4?"rgba":"rgb")}}function toHex(s){var a=parse(s);if(a)return((1<<24)+(a[0]<<16)+(a[1]<<8)+ +a[2]).toString(16).slice(1)}function fastLerp(s,a,o){if(!(!(a&&a.length)||!(s>=0&&s<=1))){o=o||[];var c=s*(a.length-1),d=Math.floor(c),tt=Math.ceil(c),nt=a[d],it=a[tt],st=c-d;return o[0]=clampCssByte(lerpNumber(nt[0],it[0],st)),o[1]=clampCssByte(lerpNumber(nt[1],it[1],st)),o[2]=clampCssByte(lerpNumber(nt[2],it[2],st)),o[3]=clampCssFloat(lerpNumber(nt[3],it[3],st)),o}}var fastMapToColor=fastLerp;function lerp(s,a,o){if(!(!(a&&a.length)||!(s>=0&&s<=1))){var c=s*(a.length-1),d=Math.floor(c),tt=Math.ceil(c),nt=parse(a[d]),it=parse(a[tt]),st=c-d,ut=stringify([clampCssByte(lerpNumber(nt[0],it[0],st)),clampCssByte(lerpNumber(nt[1],it[1],st)),clampCssByte(lerpNumber(nt[2],it[2],st)),clampCssFloat(lerpNumber(nt[3],it[3],st))],"rgba");return o?{color:ut,leftIndex:d,rightIndex:tt,value:c}:ut}}var mapToColor=lerp;function modifyHSL(s,a,o,c){var d=parse(s);if(s)return d=rgba2hsla(d),a!=null&&(d[0]=clampCssAngle(a)),o!=null&&(d[1]=parseCssFloat(o)),c!=null&&(d[2]=parseCssFloat(c)),stringify(hsla2rgba(d),"rgba")}function modifyAlpha(s,a){var o=parse(s);if(o&&a!=null)return o[3]=clampCssFloat(a),stringify(o,"rgba")}function stringify(s,a){if(!(!s||!s.length)){var o=s[0]+","+s[1]+","+s[2];return(a==="rgba"||a==="hsva"||a==="hsla")&&(o+=","+s[3]),a+"("+o+")"}}function lum(s,a){var o=parse(s);return o?(.299*o[0]+.587*o[1]+.114*o[2])*o[3]/255+(1-o[3])*a:0}function random(){return stringify([Math.round(Math.random()*255),Math.round(Math.random()*255),Math.round(Math.random()*255)],"rgb")}var liftedColorCache=new LRU(100);function liftColor(s){if(isString$1(s)){var a=liftedColorCache.get(s);return a||(a=lift(s,-.1),liftedColorCache.put(s,a)),a}else if(isGradientObject(s)){var o=extend({},s);return o.colorStops=map$1(s.colorStops,function(c){return{offset:c.offset,color:lift(c.color,-.1)}}),o}return s}const color=Object.freeze(Object.defineProperty({__proto__:null,fastLerp,fastMapToColor,lerp,lift,liftColor,lum,mapToColor,modifyAlpha,modifyHSL,parse,random,stringify,toHex},Symbol.toStringTag,{value:"Module"}));var mathRound$1=Math.round;function normalizeColor(s){var a;if(!s||s==="transparent")s="none";else if(typeof s=="string"&&s.indexOf("rgba")>-1){var o=parse(s);o&&(s="rgb("+o[0]+","+o[1]+","+o[2]+")",a=o[3])}return{color:s,opacity:a??1}}var EPSILON$3=1e-4;function isAroundZero(s){return s<EPSILON$3&&s>-EPSILON$3}function round3(s){return mathRound$1(s*1e3)/1e3}function round4(s){return mathRound$1(s*1e4)/1e4}function getMatrixStr(s){return"matrix("+round3(s[0])+","+round3(s[1])+","+round3(s[2])+","+round3(s[3])+","+round4(s[4])+","+round4(s[5])+")"}var TEXT_ALIGN_TO_ANCHOR={left:"start",right:"end",center:"middle",middle:"middle"};function adjustTextY$1(s,a,o){return o==="top"?s+=a/2:o==="bottom"&&(s-=a/2),s}function hasShadow(s){return s&&(s.shadowBlur||s.shadowOffsetX||s.shadowOffsetY)}function getShadowKey(s){var a=s.style,o=s.getGlobalScale();return[a.shadowColor,(a.shadowBlur||0).toFixed(2),(a.shadowOffsetX||0).toFixed(2),(a.shadowOffsetY||0).toFixed(2),o[0],o[1]].join(",")}function isImagePattern(s){return s&&!!s.image}function isSVGPattern(s){return s&&!!s.svgElement}function isPattern(s){return isImagePattern(s)||isSVGPattern(s)}function isLinearGradient(s){return s.type==="linear"}function isRadialGradient(s){return s.type==="radial"}function isGradient(s){return s&&(s.type==="linear"||s.type==="radial")}function getIdURL(s){return"url(#"+s+")"}function getPathPrecision(s){var a=s.getGlobalScale(),o=Math.max(a[0],a[1]);return Math.max(Math.ceil(Math.log(o)/Math.log(10)),1)}function getSRTTransformString(s){var a=s.x||0,o=s.y||0,c=(s.rotation||0)*RADIAN_TO_DEGREE,d=retrieve2(s.scaleX,1),tt=retrieve2(s.scaleY,1),nt=s.skewX||0,it=s.skewY||0,st=[];return(a||o)&&st.push("translate("+a+"px,"+o+"px)"),c&&st.push("rotate("+c+")"),(d!==1||tt!==1)&&st.push("scale("+d+","+tt+")"),(nt||it)&&st.push("skew("+mathRound$1(nt*RADIAN_TO_DEGREE)+"deg, "+mathRound$1(it*RADIAN_TO_DEGREE)+"deg)"),st.join(" ")}var encodeBase64=function(){return env.hasGlobalWindow&&isFunction$1(window.btoa)?function(s){return window.btoa(unescape(encodeURIComponent(s)))}:typeof Buffer<"u"?function(s){return Buffer.from(s).toString("base64")}:function(s){return null}}(),arraySlice=Array.prototype.slice;function interpolateNumber$1(s,a,o){return(a-s)*o+s}function interpolate1DArray(s,a,o,c){for(var d=a.length,tt=0;tt<d;tt++)s[tt]=interpolateNumber$1(a[tt],o[tt],c);return s}function interpolate2DArray(s,a,o,c){for(var d=a.length,tt=d&&a[0].length,nt=0;nt<d;nt++){s[nt]||(s[nt]=[]);for(var it=0;it<tt;it++)s[nt][it]=interpolateNumber$1(a[nt][it],o[nt][it],c)}return s}function add1DArray(s,a,o,c){for(var d=a.length,tt=0;tt<d;tt++)s[tt]=a[tt]+o[tt]*c;return s}function add2DArray(s,a,o,c){for(var d=a.length,tt=d&&a[0].length,nt=0;nt<d;nt++){s[nt]||(s[nt]=[]);for(var it=0;it<tt;it++)s[nt][it]=a[nt][it]+o[nt][it]*c}return s}function fillColorStops(s,a){for(var o=s.length,c=a.length,d=o>c?a:s,tt=Math.min(o,c),nt=d[tt-1]||{color:[0,0,0,0],offset:0},it=tt;it<Math.max(o,c);it++)d.push({offset:nt.offset,color:nt.color.slice()})}function fillArray(s,a,o){var c=s,d=a;if(!(!c.push||!d.push)){var tt=c.length,nt=d.length;if(tt!==nt){var it=tt>nt;if(it)c.length=nt;else for(var st=tt;st<nt;st++)c.push(o===1?d[st]:arraySlice.call(d[st]))}for(var ut=c[0]&&c[0].length,st=0;st<c.length;st++)if(o===1)isNaN(c[st])&&(c[st]=d[st]);else for(var ct=0;ct<ut;ct++)isNaN(c[st][ct])&&(c[st][ct]=d[st][ct])}}function cloneValue(s){if(isArrayLike(s)){var a=s.length;if(isArrayLike(s[0])){for(var o=[],c=0;c<a;c++)o.push(arraySlice.call(s[c]));return o}return arraySlice.call(s)}return s}function rgba2String(s){return s[0]=Math.floor(s[0])||0,s[1]=Math.floor(s[1])||0,s[2]=Math.floor(s[2])||0,s[3]=s[3]==null?1:s[3],"rgba("+s.join(",")+")"}function guessArrayDim(s){return isArrayLike(s&&s[0])?2:1}var VALUE_TYPE_NUMBER=0,VALUE_TYPE_1D_ARRAY=1,VALUE_TYPE_2D_ARRAY=2,VALUE_TYPE_COLOR=3,VALUE_TYPE_LINEAR_GRADIENT=4,VALUE_TYPE_RADIAL_GRADIENT=5,VALUE_TYPE_UNKOWN=6;function isGradientValueType(s){return s===VALUE_TYPE_LINEAR_GRADIENT||s===VALUE_TYPE_RADIAL_GRADIENT}function isArrayValueType(s){return s===VALUE_TYPE_1D_ARRAY||s===VALUE_TYPE_2D_ARRAY}var tmpRgba=[0,0,0,0],Track=function(){function s(a){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=a}return s.prototype.isFinished=function(){return this._finished},s.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},s.prototype.needsAnimate=function(){return this.keyframes.length>=1},s.prototype.getAdditiveTrack=function(){return this._additiveTrack},s.prototype.addKeyframe=function(a,o,c){this._needsSort=!0;var d=this.keyframes,tt=d.length,nt=!1,it=VALUE_TYPE_UNKOWN,st=o;if(isArrayLike(o)){var ut=guessArrayDim(o);it=ut,(ut===1&&!isNumber(o[0])||ut===2&&!isNumber(o[0][0]))&&(nt=!0)}else if(isNumber(o)&&!eqNaN(o))it=VALUE_TYPE_NUMBER;else if(isString$1(o))if(!isNaN(+o))it=VALUE_TYPE_NUMBER;else{var ct=parse(o);ct&&(st=ct,it=VALUE_TYPE_COLOR)}else if(isGradientObject(o)){var ot=extend({},st);ot.colorStops=map$1(o.colorStops,function(ht){return{offset:ht.offset,color:parse(ht.color)}}),isLinearGradient(o)?it=VALUE_TYPE_LINEAR_GRADIENT:isRadialGradient(o)&&(it=VALUE_TYPE_RADIAL_GRADIENT),st=ot}tt===0?this.valType=it:(it!==this.valType||it===VALUE_TYPE_UNKOWN)&&(nt=!0),this.discrete=this.discrete||nt;var at={time:a,value:st,rawValue:o,percent:0};return c&&(at.easing=c,at.easingFunc=isFunction$1(c)?c:easingFuncs[c]||createCubicEasingFunc(c)),d.push(at),at},s.prototype.prepare=function(a,o){var c=this.keyframes;this._needsSort&&c.sort(function(mt,yt){return mt.time-yt.time});for(var d=this.valType,tt=c.length,nt=c[tt-1],it=this.discrete,st=isArrayValueType(d),ut=isGradientValueType(d),ct=0;ct<tt;ct++){var ot=c[ct],at=ot.value,ht=nt.value;ot.percent=ot.time/a,it||(st&&ct!==tt-1?fillArray(at,ht,d):ut&&fillColorStops(at.colorStops,ht.colorStops))}if(!it&&d!==VALUE_TYPE_RADIAL_GRADIENT&&o&&this.needsAnimate()&&o.needsAnimate()&&d===o.valType&&!o._finished){this._additiveTrack=o;for(var ft=c[0].value,ct=0;ct<tt;ct++)d===VALUE_TYPE_NUMBER?c[ct].additiveValue=c[ct].value-ft:d===VALUE_TYPE_COLOR?c[ct].additiveValue=add1DArray([],c[ct].value,ft,-1):isArrayValueType(d)&&(c[ct].additiveValue=d===VALUE_TYPE_1D_ARRAY?add1DArray([],c[ct].value,ft,-1):add2DArray([],c[ct].value,ft,-1))}},s.prototype.step=function(a,o){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var c=this._additiveTrack!=null,d=c?"additiveValue":"value",tt=this.valType,nt=this.keyframes,it=nt.length,st=this.propName,ut=tt===VALUE_TYPE_COLOR,ct,ot=this._lastFr,at=Math.min,ht,ft;if(it===1)ht=ft=nt[0];else{if(o<0)ct=0;else if(o<this._lastFrP){var mt=at(ot+1,it-1);for(ct=mt;ct>=0&&!(nt[ct].percent<=o);ct--);ct=at(ct,it-2)}else{for(ct=ot;ct<it&&!(nt[ct].percent>o);ct++);ct=at(ct-1,it-2)}ft=nt[ct+1],ht=nt[ct]}if(ht&&ft){this._lastFr=ct,this._lastFrP=o;var yt=ft.percent-ht.percent,bt=yt===0?1:at((o-ht.percent)/yt,1);ft.easingFunc&&(bt=ft.easingFunc(bt));var wt=c?this._additiveValue:ut?tmpRgba:a[st];if((isArrayValueType(tt)||ut)&&!wt&&(wt=this._additiveValue=[]),this.discrete)a[st]=bt<1?ht.rawValue:ft.rawValue;else if(isArrayValueType(tt))tt===VALUE_TYPE_1D_ARRAY?interpolate1DArray(wt,ht[d],ft[d],bt):interpolate2DArray(wt,ht[d],ft[d],bt);else if(isGradientValueType(tt)){var Tt=ht[d],Ct=ft[d],Dt=tt===VALUE_TYPE_LINEAR_GRADIENT;a[st]={type:Dt?"linear":"radial",x:interpolateNumber$1(Tt.x,Ct.x,bt),y:interpolateNumber$1(Tt.y,Ct.y,bt),colorStops:map$1(Tt.colorStops,function($t,Ft){var kt=Ct.colorStops[Ft];return{offset:interpolateNumber$1($t.offset,kt.offset,bt),color:rgba2String(interpolate1DArray([],$t.color,kt.color,bt))}}),global:Ct.global},Dt?(a[st].x2=interpolateNumber$1(Tt.x2,Ct.x2,bt),a[st].y2=interpolateNumber$1(Tt.y2,Ct.y2,bt)):a[st].r=interpolateNumber$1(Tt.r,Ct.r,bt)}else if(ut)interpolate1DArray(wt,ht[d],ft[d],bt),c||(a[st]=rgba2String(wt));else{var Ot=interpolateNumber$1(ht[d],ft[d],bt);c?this._additiveValue=Ot:a[st]=Ot}c&&this._addToTarget(a)}}},s.prototype._addToTarget=function(a){var o=this.valType,c=this.propName,d=this._additiveValue;o===VALUE_TYPE_NUMBER?a[c]=a[c]+d:o===VALUE_TYPE_COLOR?(parse(a[c],tmpRgba),add1DArray(tmpRgba,tmpRgba,d,1),a[c]=rgba2String(tmpRgba)):o===VALUE_TYPE_1D_ARRAY?add1DArray(a[c],a[c],d,1):o===VALUE_TYPE_2D_ARRAY&&add2DArray(a[c],a[c],d,1)},s}(),Animator=function(){function s(a,o,c,d){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=a,this._loop=o,o&&d){logError("Can' use additive animation on looped animation.");return}this._additiveAnimators=d,this._allowDiscrete=c}return s.prototype.getMaxTime=function(){return this._maxTime},s.prototype.getDelay=function(){return this._delay},s.prototype.getLoop=function(){return this._loop},s.prototype.getTarget=function(){return this._target},s.prototype.changeTarget=function(a){this._target=a},s.prototype.when=function(a,o,c){return this.whenWithKeys(a,o,keys(o),c)},s.prototype.whenWithKeys=function(a,o,c,d){for(var tt=this._tracks,nt=0;nt<c.length;nt++){var it=c[nt],st=tt[it];if(!st){st=tt[it]=new Track(it);var ut=void 0,ct=this._getAdditiveTrack(it);if(ct){var ot=ct.keyframes,at=ot[ot.length-1];ut=at&&at.value,ct.valType===VALUE_TYPE_COLOR&&ut&&(ut=rgba2String(ut))}else ut=this._target[it];if(ut==null)continue;a>0&&st.addKeyframe(0,cloneValue(ut),d),this._trackKeys.push(it)}st.addKeyframe(a,cloneValue(o[it]),d)}return this._maxTime=Math.max(this._maxTime,a),this},s.prototype.pause=function(){this._clip.pause(),this._paused=!0},s.prototype.resume=function(){this._clip.resume(),this._paused=!1},s.prototype.isPaused=function(){return!!this._paused},s.prototype.duration=function(a){return this._maxTime=a,this._force=!0,this},s.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var a=this._doneCbs;if(a)for(var o=a.length,c=0;c<o;c++)a[c].call(this)},s.prototype._abortedCallback=function(){this._setTracksFinished();var a=this.animation,o=this._abortedCbs;if(a&&a.removeClip(this._clip),this._clip=null,o)for(var c=0;c<o.length;c++)o[c].call(this)},s.prototype._setTracksFinished=function(){for(var a=this._tracks,o=this._trackKeys,c=0;c<o.length;c++)a[o[c]].setFinished()},s.prototype._getAdditiveTrack=function(a){var o,c=this._additiveAnimators;if(c)for(var d=0;d<c.length;d++){var tt=c[d].getTrack(a);tt&&(o=tt)}return o},s.prototype.start=function(a){if(!(this._started>0)){this._started=1;for(var o=this,c=[],d=this._maxTime||0,tt=0;tt<this._trackKeys.length;tt++){var nt=this._trackKeys[tt],it=this._tracks[nt],st=this._getAdditiveTrack(nt),ut=it.keyframes,ct=ut.length;if(it.prepare(d,st),it.needsAnimate())if(!this._allowDiscrete&&it.discrete){var ot=ut[ct-1];ot&&(o._target[it.propName]=ot.rawValue),it.setFinished()}else c.push(it)}if(c.length||this._force){var at=new Clip({life:d,loop:this._loop,delay:this._delay||0,onframe:function(ht){o._started=2;var ft=o._additiveAnimators;if(ft){for(var mt=!1,yt=0;yt<ft.length;yt++)if(ft[yt]._clip){mt=!0;break}mt||(o._additiveAnimators=null)}for(var yt=0;yt<c.length;yt++)c[yt].step(o._target,ht);var bt=o._onframeCbs;if(bt)for(var yt=0;yt<bt.length;yt++)bt[yt](o._target,ht)},ondestroy:function(){o._doneCallback()}});this._clip=at,this.animation&&this.animation.addClip(at),a&&at.setEasing(a)}else this._doneCallback();return this}},s.prototype.stop=function(a){if(this._clip){var o=this._clip;a&&o.onframe(1),this._abortedCallback()}},s.prototype.delay=function(a){return this._delay=a,this},s.prototype.during=function(a){return a&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(a)),this},s.prototype.done=function(a){return a&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(a)),this},s.prototype.aborted=function(a){return a&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(a)),this},s.prototype.getClip=function(){return this._clip},s.prototype.getTrack=function(a){return this._tracks[a]},s.prototype.getTracks=function(){var a=this;return map$1(this._trackKeys,function(o){return a._tracks[o]})},s.prototype.stopTracks=function(a,o){if(!a.length||!this._clip)return!0;for(var c=this._tracks,d=this._trackKeys,tt=0;tt<a.length;tt++){var nt=c[a[tt]];nt&&!nt.isFinished()&&(o?nt.step(this._target,1):this._started===1&&nt.step(this._target,0),nt.setFinished())}for(var it=!0,tt=0;tt<d.length;tt++)if(!c[d[tt]].isFinished()){it=!1;break}return it&&this._abortedCallback(),it},s.prototype.saveTo=function(a,o,c){if(a){o=o||this._trackKeys;for(var d=0;d<o.length;d++){var tt=o[d],nt=this._tracks[tt];if(!(!nt||nt.isFinished())){var it=nt.keyframes,st=it[c?0:it.length-1];st&&(a[tt]=cloneValue(st.rawValue))}}}},s.prototype.__changeFinalValue=function(a,o){o=o||keys(a);for(var c=0;c<o.length;c++){var d=o[c],tt=this._tracks[d];if(tt){var nt=tt.keyframes;if(nt.length>1){var it=nt.pop();tt.addKeyframe(it.time,a[d]),tt.prepare(this._maxTime,tt.getAdditiveTrack())}}}},s}();function getTime(){return new Date().getTime()}var Animation=function(s){__extends(a,s);function a(o){var c=s.call(this)||this;return c._running=!1,c._time=0,c._pausedTime=0,c._pauseStart=0,c._paused=!1,o=o||{},c.stage=o.stage||{},c}return a.prototype.addClip=function(o){o.animation&&this.removeClip(o),this._head?(this._tail.next=o,o.prev=this._tail,o.next=null,this._tail=o):this._head=this._tail=o,o.animation=this},a.prototype.addAnimator=function(o){o.animation=this;var c=o.getClip();c&&this.addClip(c)},a.prototype.removeClip=function(o){if(o.animation){var c=o.prev,d=o.next;c?c.next=d:this._head=d,d?d.prev=c:this._tail=c,o.next=o.prev=o.animation=null}},a.prototype.removeAnimator=function(o){var c=o.getClip();c&&this.removeClip(c),o.animation=null},a.prototype.update=function(o){for(var c=getTime()-this._pausedTime,d=c-this._time,tt=this._head;tt;){var nt=tt.next,it=tt.step(c,d);it&&(tt.ondestroy(),this.removeClip(tt)),tt=nt}this._time=c,o||(this.trigger("frame",d),this.stage.update&&this.stage.update())},a.prototype._startLoop=function(){var o=this;this._running=!0;function c(){o._running&&(requestAnimationFrame$1(c),!o._paused&&o.update())}requestAnimationFrame$1(c)},a.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},a.prototype.stop=function(){this._running=!1},a.prototype.pause=function(){this._paused||(this._pauseStart=getTime(),this._paused=!0)},a.prototype.resume=function(){this._paused&&(this._pausedTime+=getTime()-this._pauseStart,this._paused=!1)},a.prototype.clear=function(){for(var o=this._head;o;){var c=o.next;o.prev=o.next=o.animation=null,o=c}this._head=this._tail=null},a.prototype.isFinished=function(){return this._head==null},a.prototype.animate=function(o,c){c=c||{},this.start();var d=new Animator(o,c.loop);return this.addAnimator(d),d},a}(Eventful),TOUCH_CLICK_DELAY=300,globalEventSupported=env.domSupported,localNativeListenerNames=function(){var s=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],a=["touchstart","touchend","touchmove"],o={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},c=map$1(s,function(d){var tt=d.replace("mouse","pointer");return o.hasOwnProperty(tt)?tt:d});return{mouse:s,touch:a,pointer:c}}(),globalNativeListenerNames={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},wheelEventSupported=!1;function isPointerFromTouch(s){var a=s.pointerType;return a==="pen"||a==="touch"}function setTouchTimer(s){s.touching=!0,s.touchTimer!=null&&(clearTimeout(s.touchTimer),s.touchTimer=null),s.touchTimer=setTimeout(function(){s.touching=!1,s.touchTimer=null},700)}function markTouch(s){s&&(s.zrByTouch=!0)}function normalizeGlobalEvent(s,a){return normalizeEvent(s.dom,new FakeGlobalEvent(s,a),!0)}function isLocalEl(s,a){for(var o=a,c=!1;o&&o.nodeType!==9&&!(c=o.domBelongToZr||o!==a&&o===s.painterRoot);)o=o.parentNode;return c}var FakeGlobalEvent=function(){function s(a,o){this.stopPropagation=noop,this.stopImmediatePropagation=noop,this.preventDefault=noop,this.type=o.type,this.target=this.currentTarget=a.dom,this.pointerType=o.pointerType,this.clientX=o.clientX,this.clientY=o.clientY}return s}(),localDOMHandlers={mousedown:function(s){s=normalizeEvent(this.dom,s),this.__mayPointerCapture=[s.zrX,s.zrY],this.trigger("mousedown",s)},mousemove:function(s){s=normalizeEvent(this.dom,s);var a=this.__mayPointerCapture;a&&(s.zrX!==a[0]||s.zrY!==a[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",s)},mouseup:function(s){s=normalizeEvent(this.dom,s),this.__togglePointerCapture(!1),this.trigger("mouseup",s)},mouseout:function(s){s=normalizeEvent(this.dom,s);var a=s.toElement||s.relatedTarget;isLocalEl(this,a)||(this.__pointerCapturing&&(s.zrEventControl="no_globalout"),this.trigger("mouseout",s))},wheel:function(s){wheelEventSupported=!0,s=normalizeEvent(this.dom,s),this.trigger("mousewheel",s)},mousewheel:function(s){wheelEventSupported||(s=normalizeEvent(this.dom,s),this.trigger("mousewheel",s))},touchstart:function(s){s=normalizeEvent(this.dom,s),markTouch(s),this.__lastTouchMoment=new Date,this.handler.processGesture(s,"start"),localDOMHandlers.mousemove.call(this,s),localDOMHandlers.mousedown.call(this,s)},touchmove:function(s){s=normalizeEvent(this.dom,s),markTouch(s),this.handler.processGesture(s,"change"),localDOMHandlers.mousemove.call(this,s)},touchend:function(s){s=normalizeEvent(this.dom,s),markTouch(s),this.handler.processGesture(s,"end"),localDOMHandlers.mouseup.call(this,s),+new Date-+this.__lastTouchMoment<TOUCH_CLICK_DELAY&&localDOMHandlers.click.call(this,s)},pointerdown:function(s){localDOMHandlers.mousedown.call(this,s)},pointermove:function(s){isPointerFromTouch(s)||localDOMHandlers.mousemove.call(this,s)},pointerup:function(s){localDOMHandlers.mouseup.call(this,s)},pointerout:function(s){isPointerFromTouch(s)||localDOMHandlers.mouseout.call(this,s)}};each$f(["click","dblclick","contextmenu"],function(s){localDOMHandlers[s]=function(a){a=normalizeEvent(this.dom,a),this.trigger(s,a)}});var globalDOMHandlers={pointermove:function(s){isPointerFromTouch(s)||globalDOMHandlers.mousemove.call(this,s)},pointerup:function(s){globalDOMHandlers.mouseup.call(this,s)},mousemove:function(s){this.trigger("mousemove",s)},mouseup:function(s){var a=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",s),a&&(s.zrEventControl="only_globalout",this.trigger("mouseout",s))}};function mountLocalDOMEventListeners(s,a){var o=a.domHandlers;env.pointerEventsSupported?each$f(localNativeListenerNames.pointer,function(c){mountSingleDOMEventListener(a,c,function(d){o[c].call(s,d)})}):(env.touchEventsSupported&&each$f(localNativeListenerNames.touch,function(c){mountSingleDOMEventListener(a,c,function(d){o[c].call(s,d),setTouchTimer(a)})}),each$f(localNativeListenerNames.mouse,function(c){mountSingleDOMEventListener(a,c,function(d){d=getNativeEvent(d),a.touching||o[c].call(s,d)})}))}function mountGlobalDOMEventListeners(s,a){env.pointerEventsSupported?each$f(globalNativeListenerNames.pointer,o):env.touchEventsSupported||each$f(globalNativeListenerNames.mouse,o);function o(c){function d(tt){tt=getNativeEvent(tt),isLocalEl(s,tt.target)||(tt=normalizeGlobalEvent(s,tt),a.domHandlers[c].call(s,tt))}mountSingleDOMEventListener(a,c,d,{capture:!0})}}function mountSingleDOMEventListener(s,a,o,c){s.mounted[a]=o,s.listenerOpts[a]=c,addEventListener$1(s.domTarget,a,o,c)}function unmountDOMEventListeners(s){var a=s.mounted;for(var o in a)a.hasOwnProperty(o)&&removeEventListener$1(s.domTarget,o,a[o],s.listenerOpts[o]);s.mounted={}}var DOMHandlerScope=function(){function s(a,o){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=a,this.domHandlers=o}return s}(),HandlerDomProxy=function(s){__extends(a,s);function a(o,c){var d=s.call(this)||this;return d.__pointerCapturing=!1,d.dom=o,d.painterRoot=c,d._localHandlerScope=new DOMHandlerScope(o,localDOMHandlers),globalEventSupported&&(d._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(d,d._localHandlerScope),d}return a.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},a.prototype.setCursor=function(o){this.dom.style&&(this.dom.style.cursor=o||"default")},a.prototype.__togglePointerCapture=function(o){if(this.__mayPointerCapture=null,globalEventSupported&&+this.__pointerCapturing^+o){this.__pointerCapturing=o;var c=this._globalHandlerScope;o?mountGlobalDOMEventListeners(this,c):unmountDOMEventListeners(c)}},a}(Eventful),dpr=1;env.hasGlobalWindow&&(dpr=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var devicePixelRatio$1=dpr,DARK_MODE_THRESHOLD=.4,DARK_LABEL_COLOR="#333",LIGHT_LABEL_COLOR="#ccc",LIGHTER_LABEL_COLOR="#eee",mIdentity=identity,EPSILON$2=5e-5;function isNotAroundZero(s){return s>EPSILON$2||s<-EPSILON$2}var scaleTmp=[],tmpTransform=[],originTransform=create$1(),abs=Math.abs,Transformable=function(){function s(){}return s.prototype.getLocalTransform=function(a){return s.getLocalTransform(this,a)},s.prototype.setPosition=function(a){this.x=a[0],this.y=a[1]},s.prototype.setScale=function(a){this.scaleX=a[0],this.scaleY=a[1]},s.prototype.setSkew=function(a){this.skewX=a[0],this.skewY=a[1]},s.prototype.setOrigin=function(a){this.originX=a[0],this.originY=a[1]},s.prototype.needLocalTransform=function(){return isNotAroundZero(this.rotation)||isNotAroundZero(this.x)||isNotAroundZero(this.y)||isNotAroundZero(this.scaleX-1)||isNotAroundZero(this.scaleY-1)||isNotAroundZero(this.skewX)||isNotAroundZero(this.skewY)},s.prototype.updateTransform=function(){var a=this.parent&&this.parent.transform,o=this.needLocalTransform(),c=this.transform;if(!(o||a)){c&&(mIdentity(c),this.invTransform=null);return}c=c||create$1(),o?this.getLocalTransform(c):mIdentity(c),a&&(o?mul(c,a,c):copy(c,a)),this.transform=c,this._resolveGlobalScaleRatio(c)},s.prototype._resolveGlobalScaleRatio=function(a){var o=this.globalScaleRatio;if(o!=null&&o!==1){this.getGlobalScale(scaleTmp);var c=scaleTmp[0]<0?-1:1,d=scaleTmp[1]<0?-1:1,tt=((scaleTmp[0]-c)*o+c)/scaleTmp[0]||0,nt=((scaleTmp[1]-d)*o+d)/scaleTmp[1]||0;a[0]*=tt,a[1]*=tt,a[2]*=nt,a[3]*=nt}this.invTransform=this.invTransform||create$1(),invert(this.invTransform,a)},s.prototype.getComputedTransform=function(){for(var a=this,o=[];a;)o.push(a),a=a.parent;for(;a=o.pop();)a.updateTransform();return this.transform},s.prototype.setLocalTransform=function(a){if(a){var o=a[0]*a[0]+a[1]*a[1],c=a[2]*a[2]+a[3]*a[3],d=Math.atan2(a[1],a[0]),tt=Math.PI/2+d-Math.atan2(a[3],a[2]);c=Math.sqrt(c)*Math.cos(tt),o=Math.sqrt(o),this.skewX=tt,this.skewY=0,this.rotation=-d,this.x=+a[4],this.y=+a[5],this.scaleX=o,this.scaleY=c,this.originX=0,this.originY=0}},s.prototype.decomposeTransform=function(){if(this.transform){var a=this.parent,o=this.transform;a&&a.transform&&(a.invTransform=a.invTransform||create$1(),mul(tmpTransform,a.invTransform,o),o=tmpTransform);var c=this.originX,d=this.originY;(c||d)&&(originTransform[4]=c,originTransform[5]=d,mul(tmpTransform,o,originTransform),tmpTransform[4]-=c,tmpTransform[5]-=d,o=tmpTransform),this.setLocalTransform(o)}},s.prototype.getGlobalScale=function(a){var o=this.transform;return a=a||[],o?(a[0]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),a[1]=Math.sqrt(o[2]*o[2]+o[3]*o[3]),o[0]<0&&(a[0]=-a[0]),o[3]<0&&(a[1]=-a[1]),a):(a[0]=1,a[1]=1,a)},s.prototype.transformCoordToLocal=function(a,o){var c=[a,o],d=this.invTransform;return d&&applyTransform$1(c,c,d),c},s.prototype.transformCoordToGlobal=function(a,o){var c=[a,o],d=this.transform;return d&&applyTransform$1(c,c,d),c},s.prototype.getLineScale=function(){var a=this.transform;return a&&abs(a[0]-1)>1e-10&&abs(a[3]-1)>1e-10?Math.sqrt(abs(a[0]*a[3]-a[2]*a[1])):1},s.prototype.copyTransform=function(a){copyTransform(this,a)},s.getLocalTransform=function(a,o){o=o||[];var c=a.originX||0,d=a.originY||0,tt=a.scaleX,nt=a.scaleY,it=a.anchorX,st=a.anchorY,ut=a.rotation||0,ct=a.x,ot=a.y,at=a.skewX?Math.tan(a.skewX):0,ht=a.skewY?Math.tan(-a.skewY):0;if(c||d||it||st){var ft=c+it,mt=d+st;o[4]=-ft*tt-at*mt*nt,o[5]=-mt*nt-ht*ft*tt}else o[4]=o[5]=0;return o[0]=tt,o[3]=nt,o[1]=ht*tt,o[2]=at*nt,ut&&rotate$1(o,o,ut),o[4]+=c+ct,o[5]+=d+ot,o},s.initDefaultProps=function(){var a=s.prototype;a.scaleX=a.scaleY=a.globalScaleRatio=1,a.x=a.y=a.originX=a.originY=a.skewX=a.skewY=a.rotation=a.anchorX=a.anchorY=0}(),s}(),TRANSFORMABLE_PROPS=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function copyTransform(s,a){for(var o=0;o<TRANSFORMABLE_PROPS.length;o++){var c=TRANSFORMABLE_PROPS[o];s[c]=a[c]}}var textWidthCache={};function getWidth(s,a){a=a||DEFAULT_FONT;var o=textWidthCache[a];o||(o=textWidthCache[a]=new LRU(500));var c=o.get(s);return c==null&&(c=platformApi.measureText(s,a).width,o.put(s,c)),c}function innerGetBoundingRect(s,a,o,c){var d=getWidth(s,a),tt=getLineHeight(a),nt=adjustTextX(0,d,o),it=adjustTextY(0,tt,c),st=new BoundingRect(nt,it,d,tt);return st}function getBoundingRect(s,a,o,c){var d=((s||"")+"").split(`
`),tt=d.length;if(tt===1)return innerGetBoundingRect(d[0],a,o,c);for(var nt=new BoundingRect(0,0,0,0),it=0;it<d.length;it++){var st=innerGetBoundingRect(d[it],a,o,c);it===0?nt.copy(st):nt.union(st)}return nt}function adjustTextX(s,a,o){return o==="right"?s-=a:o==="center"&&(s-=a/2),s}function adjustTextY(s,a,o){return o==="middle"?s-=a/2:o==="bottom"&&(s-=a),s}function getLineHeight(s){return getWidth("国",s)}function parsePercent$1(s,a){return typeof s=="string"?s.lastIndexOf("%")>=0?parseFloat(s)/100*a:parseFloat(s):s}function calculateTextPosition(s,a,o){var c=a.position||"inside",d=a.distance!=null?a.distance:5,tt=o.height,nt=o.width,it=tt/2,st=o.x,ut=o.y,ct="left",ot="top";if(c instanceof Array)st+=parsePercent$1(c[0],o.width),ut+=parsePercent$1(c[1],o.height),ct=null,ot=null;else switch(c){case"left":st-=d,ut+=it,ct="right",ot="middle";break;case"right":st+=d+nt,ut+=it,ot="middle";break;case"top":st+=nt/2,ut-=d,ct="center",ot="bottom";break;case"bottom":st+=nt/2,ut+=tt+d,ct="center";break;case"inside":st+=nt/2,ut+=it,ct="center",ot="middle";break;case"insideLeft":st+=d,ut+=it,ot="middle";break;case"insideRight":st+=nt-d,ut+=it,ct="right",ot="middle";break;case"insideTop":st+=nt/2,ut+=d,ct="center";break;case"insideBottom":st+=nt/2,ut+=tt-d,ct="center",ot="bottom";break;case"insideTopLeft":st+=d,ut+=d;break;case"insideTopRight":st+=nt-d,ut+=d,ct="right";break;case"insideBottomLeft":st+=d,ut+=tt-d,ot="bottom";break;case"insideBottomRight":st+=nt-d,ut+=tt-d,ct="right",ot="bottom";break}return s=s||{},s.x=st,s.y=ut,s.align=ct,s.verticalAlign=ot,s}var PRESERVED_NORMAL_STATE="__zr_normal__",PRIMARY_STATES_KEYS$1=TRANSFORMABLE_PROPS.concat(["ignore"]),DEFAULT_ANIMATABLE_MAP=reduce(TRANSFORMABLE_PROPS,function(s,a){return s[a]=!0,s},{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect(0,0,0,0),Element=function(){function s(a){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(a)}return s.prototype._init=function(a){this.attr(a)},s.prototype.drift=function(a,o,c){switch(this.draggable){case"horizontal":o=0;break;case"vertical":a=0;break}var d=this.transform;d||(d=this.transform=[1,0,0,1,0,0]),d[4]+=a,d[5]+=o,this.decomposeTransform(),this.markRedraw()},s.prototype.beforeUpdate=function(){},s.prototype.afterUpdate=function(){},s.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},s.prototype.updateInnerText=function(a){var o=this._textContent;if(o&&(!o.ignore||a)){this.textConfig||(this.textConfig={});var c=this.textConfig,d=c.local,tt=o.innerTransformable,nt=void 0,it=void 0,st=!1;tt.parent=d?this:null;var ut=!1;if(tt.copyTransform(o),c.position!=null){var ct=tmpBoundingRect;c.layoutRect?ct.copy(c.layoutRect):ct.copy(this.getBoundingRect()),d||ct.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,c,ct):calculateTextPosition(tmpTextPosCalcRes,c,ct),tt.x=tmpTextPosCalcRes.x,tt.y=tmpTextPosCalcRes.y,nt=tmpTextPosCalcRes.align,it=tmpTextPosCalcRes.verticalAlign;var ot=c.origin;if(ot&&c.rotation!=null){var at=void 0,ht=void 0;ot==="center"?(at=ct.width*.5,ht=ct.height*.5):(at=parsePercent$1(ot[0],ct.width),ht=parsePercent$1(ot[1],ct.height)),ut=!0,tt.originX=-tt.x+at+(d?0:ct.x),tt.originY=-tt.y+ht+(d?0:ct.y)}}c.rotation!=null&&(tt.rotation=c.rotation);var ft=c.offset;ft&&(tt.x+=ft[0],tt.y+=ft[1],ut||(tt.originX=-ft[0],tt.originY=-ft[1]));var mt=c.inside==null?typeof c.position=="string"&&c.position.indexOf("inside")>=0:c.inside,yt=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),bt=void 0,wt=void 0,Tt=void 0;mt&&this.canBeInsideText()?(bt=c.insideFill,wt=c.insideStroke,(bt==null||bt==="auto")&&(bt=this.getInsideTextFill()),(wt==null||wt==="auto")&&(wt=this.getInsideTextStroke(bt),Tt=!0)):(bt=c.outsideFill,wt=c.outsideStroke,(bt==null||bt==="auto")&&(bt=this.getOutsideFill()),(wt==null||wt==="auto")&&(wt=this.getOutsideStroke(bt),Tt=!0)),bt=bt||"#000",(bt!==yt.fill||wt!==yt.stroke||Tt!==yt.autoStroke||nt!==yt.align||it!==yt.verticalAlign)&&(st=!0,yt.fill=bt,yt.stroke=wt,yt.autoStroke=Tt,yt.align=nt,yt.verticalAlign=it,o.setDefaultTextStyle(yt)),o.__dirty|=REDRAW_BIT,st&&o.dirtyStyle(!0)}},s.prototype.canBeInsideText=function(){return!0},s.prototype.getInsideTextFill=function(){return"#fff"},s.prototype.getInsideTextStroke=function(a){return"#000"},s.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?LIGHT_LABEL_COLOR:DARK_LABEL_COLOR},s.prototype.getOutsideStroke=function(a){var o=this.__zr&&this.__zr.getBackgroundColor(),c=typeof o=="string"&&parse(o);c||(c=[255,255,255,1]);for(var d=c[3],tt=this.__zr.isDarkMode(),nt=0;nt<3;nt++)c[nt]=c[nt]*d+(tt?0:255)*(1-d);return c[3]=1,stringify(c,"rgba")},s.prototype.traverse=function(a,o){},s.prototype.attrKV=function(a,o){a==="textConfig"?this.setTextConfig(o):a==="textContent"?this.setTextContent(o):a==="clipPath"?this.setClipPath(o):a==="extra"?(this.extra=this.extra||{},extend(this.extra,o)):this[a]=o},s.prototype.hide=function(){this.ignore=!0,this.markRedraw()},s.prototype.show=function(){this.ignore=!1,this.markRedraw()},s.prototype.attr=function(a,o){if(typeof a=="string")this.attrKV(a,o);else if(isObject$3(a))for(var c=a,d=keys(c),tt=0;tt<d.length;tt++){var nt=d[tt];this.attrKV(nt,a[nt])}return this.markRedraw(),this},s.prototype.saveCurrentToNormalState=function(a){this._innerSaveToNormal(a);for(var o=this._normalState,c=0;c<this.animators.length;c++){var d=this.animators[c],tt=d.__fromStateTransition;if(!(d.getLoop()||tt&&tt!==PRESERVED_NORMAL_STATE)){var nt=d.targetName,it=nt?o[nt]:o;d.saveTo(it)}}},s.prototype._innerSaveToNormal=function(a){var o=this._normalState;o||(o=this._normalState={}),a.textConfig&&!o.textConfig&&(o.textConfig=this.textConfig),this._savePrimaryToNormal(a,o,PRIMARY_STATES_KEYS$1)},s.prototype._savePrimaryToNormal=function(a,o,c){for(var d=0;d<c.length;d++){var tt=c[d];a[tt]!=null&&!(tt in o)&&(o[tt]=this[tt])}},s.prototype.hasState=function(){return this.currentStates.length>0},s.prototype.getState=function(a){return this.states[a]},s.prototype.ensureState=function(a){var o=this.states;return o[a]||(o[a]={}),o[a]},s.prototype.clearStates=function(a){this.useState(PRESERVED_NORMAL_STATE,!1,a)},s.prototype.useState=function(a,o,c,d){var tt=a===PRESERVED_NORMAL_STATE,nt=this.hasState();if(!(!nt&&tt)){var it=this.currentStates,st=this.stateTransition;if(!(indexOf(it,a)>=0&&(o||it.length===1))){var ut;if(this.stateProxy&&!tt&&(ut=this.stateProxy(a)),ut||(ut=this.states&&this.states[a]),!ut&&!tt){logError("State "+a+" not exists.");return}tt||this.saveCurrentToNormalState(ut);var ct=!!(ut&&ut.hoverLayer||d);ct&&this._toggleHoverLayerFlag(!0),this._applyStateObj(a,ut,this._normalState,o,!c&&!this.__inHover&&st&&st.duration>0,st);var ot=this._textContent,at=this._textGuide;return ot&&ot.useState(a,o,c,ct),at&&at.useState(a,o,c,ct),tt?(this.currentStates=[],this._normalState={}):o?this.currentStates.push(a):this.currentStates=[a],this._updateAnimationTargets(),this.markRedraw(),!ct&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT),ut}}},s.prototype.useStates=function(a,o,c){if(!a.length)this.clearStates();else{var d=[],tt=this.currentStates,nt=a.length,it=nt===tt.length;if(it){for(var st=0;st<nt;st++)if(a[st]!==tt[st]){it=!1;break}}if(it)return;for(var st=0;st<nt;st++){var ut=a[st],ct=void 0;this.stateProxy&&(ct=this.stateProxy(ut,a)),ct||(ct=this.states[ut]),ct&&d.push(ct)}var ot=d[nt-1],at=!!(ot&&ot.hoverLayer||c);at&&this._toggleHoverLayerFlag(!0);var ht=this._mergeStates(d),ft=this.stateTransition;this.saveCurrentToNormalState(ht),this._applyStateObj(a.join(","),ht,this._normalState,!1,!o&&!this.__inHover&&ft&&ft.duration>0,ft);var mt=this._textContent,yt=this._textGuide;mt&&mt.useStates(a,o,at),yt&&yt.useStates(a,o,at),this._updateAnimationTargets(),this.currentStates=a.slice(),this.markRedraw(),!at&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT)}},s.prototype.isSilent=function(){for(var a=this.silent,o=this.parent;!a&&o;){if(o.silent){a=!0;break}o=o.parent}return a},s.prototype._updateAnimationTargets=function(){for(var a=0;a<this.animators.length;a++){var o=this.animators[a];o.targetName&&o.changeTarget(this[o.targetName])}},s.prototype.removeState=function(a){var o=indexOf(this.currentStates,a);if(o>=0){var c=this.currentStates.slice();c.splice(o,1),this.useStates(c)}},s.prototype.replaceState=function(a,o,c){var d=this.currentStates.slice(),tt=indexOf(d,a),nt=indexOf(d,o)>=0;tt>=0?nt?d.splice(tt,1):d[tt]=o:c&&!nt&&d.push(o),this.useStates(d)},s.prototype.toggleState=function(a,o){o?this.useState(a,!0):this.removeState(a)},s.prototype._mergeStates=function(a){for(var o={},c,d=0;d<a.length;d++){var tt=a[d];extend(o,tt),tt.textConfig&&(c=c||{},extend(c,tt.textConfig))}return c&&(o.textConfig=c),o},s.prototype._applyStateObj=function(a,o,c,d,tt,nt){var it=!(o&&d);o&&o.textConfig?(this.textConfig=extend({},d?this.textConfig:c.textConfig),extend(this.textConfig,o.textConfig)):it&&c.textConfig&&(this.textConfig=c.textConfig);for(var st={},ut=!1,ct=0;ct<PRIMARY_STATES_KEYS$1.length;ct++){var ot=PRIMARY_STATES_KEYS$1[ct],at=tt&&DEFAULT_ANIMATABLE_MAP[ot];o&&o[ot]!=null?at?(ut=!0,st[ot]=o[ot]):this[ot]=o[ot]:it&&c[ot]!=null&&(at?(ut=!0,st[ot]=c[ot]):this[ot]=c[ot])}if(!tt)for(var ct=0;ct<this.animators.length;ct++){var ht=this.animators[ct],ft=ht.targetName;ht.getLoop()||ht.__changeFinalValue(ft?(o||c)[ft]:o||c)}ut&&this._transitionState(a,st,nt)},s.prototype._attachComponent=function(a){if(!(a.__zr&&!a.__hostTarget)&&a!==this){var o=this.__zr;o&&a.addSelfToZr(o),a.__zr=o,a.__hostTarget=this}},s.prototype._detachComponent=function(a){a.__zr&&a.removeSelfFromZr(a.__zr),a.__zr=null,a.__hostTarget=null},s.prototype.getClipPath=function(){return this._clipPath},s.prototype.setClipPath=function(a){this._clipPath&&this._clipPath!==a&&this.removeClipPath(),this._attachComponent(a),this._clipPath=a,this.markRedraw()},s.prototype.removeClipPath=function(){var a=this._clipPath;a&&(this._detachComponent(a),this._clipPath=null,this.markRedraw())},s.prototype.getTextContent=function(){return this._textContent},s.prototype.setTextContent=function(a){var o=this._textContent;o!==a&&(o&&o!==a&&this.removeTextContent(),a.innerTransformable=new Transformable,this._attachComponent(a),this._textContent=a,this.markRedraw())},s.prototype.setTextConfig=function(a){this.textConfig||(this.textConfig={}),extend(this.textConfig,a),this.markRedraw()},s.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},s.prototype.removeTextContent=function(){var a=this._textContent;a&&(a.innerTransformable=null,this._detachComponent(a),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},s.prototype.getTextGuideLine=function(){return this._textGuide},s.prototype.setTextGuideLine=function(a){this._textGuide&&this._textGuide!==a&&this.removeTextGuideLine(),this._attachComponent(a),this._textGuide=a,this.markRedraw()},s.prototype.removeTextGuideLine=function(){var a=this._textGuide;a&&(this._detachComponent(a),this._textGuide=null,this.markRedraw())},s.prototype.markRedraw=function(){this.__dirty|=REDRAW_BIT;var a=this.__zr;a&&(this.__inHover?a.refreshHover():a.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},s.prototype.dirty=function(){this.markRedraw()},s.prototype._toggleHoverLayerFlag=function(a){this.__inHover=a;var o=this._textContent,c=this._textGuide;o&&(o.__inHover=a),c&&(c.__inHover=a)},s.prototype.addSelfToZr=function(a){if(this.__zr!==a){this.__zr=a;var o=this.animators;if(o)for(var c=0;c<o.length;c++)a.animation.addAnimator(o[c]);this._clipPath&&this._clipPath.addSelfToZr(a),this._textContent&&this._textContent.addSelfToZr(a),this._textGuide&&this._textGuide.addSelfToZr(a)}},s.prototype.removeSelfFromZr=function(a){if(this.__zr){this.__zr=null;var o=this.animators;if(o)for(var c=0;c<o.length;c++)a.animation.removeAnimator(o[c]);this._clipPath&&this._clipPath.removeSelfFromZr(a),this._textContent&&this._textContent.removeSelfFromZr(a),this._textGuide&&this._textGuide.removeSelfFromZr(a)}},s.prototype.animate=function(a,o,c){var d=a?this[a]:this,tt=new Animator(d,o,c);return a&&(tt.targetName=a),this.addAnimator(tt,a),tt},s.prototype.addAnimator=function(a,o){var c=this.__zr,d=this;a.during(function(){d.updateDuringAnimation(o)}).done(function(){var tt=d.animators,nt=indexOf(tt,a);nt>=0&&tt.splice(nt,1)}),this.animators.push(a),c&&c.animation.addAnimator(a),c&&c.wakeUp()},s.prototype.updateDuringAnimation=function(a){this.markRedraw()},s.prototype.stopAnimation=function(a,o){for(var c=this.animators,d=c.length,tt=[],nt=0;nt<d;nt++){var it=c[nt];!a||a===it.scope?it.stop(o):tt.push(it)}return this.animators=tt,this},s.prototype.animateTo=function(a,o,c){animateTo(this,a,o,c)},s.prototype.animateFrom=function(a,o,c){animateTo(this,a,o,c,!0)},s.prototype._transitionState=function(a,o,c,d){for(var tt=animateTo(this,o,c,d),nt=0;nt<tt.length;nt++)tt[nt].__fromStateTransition=a},s.prototype.getBoundingRect=function(){return null},s.prototype.getPaintRect=function(){return null},s.initDefaultProps=function(){var a=s.prototype;a.type="element",a.name="",a.ignore=a.silent=a.isGroup=a.draggable=a.dragging=a.ignoreClip=a.__inHover=!1,a.__dirty=REDRAW_BIT;function o(c,d,tt,nt){Object.defineProperty(a,c,{get:function(){if(!this[d]){var st=this[d]=[];it(this,st)}return this[d]},set:function(st){this[tt]=st[0],this[nt]=st[1],this[d]=st,it(this,st)}});function it(st,ut){Object.defineProperty(ut,0,{get:function(){return st[tt]},set:function(ct){st[tt]=ct}}),Object.defineProperty(ut,1,{get:function(){return st[nt]},set:function(ct){st[nt]=ct}})}}Object.defineProperty&&(o("position","_legacyPos","x","y"),o("scale","_legacyScale","scaleX","scaleY"),o("origin","_legacyOrigin","originX","originY"))}(),s}();mixin(Element,Eventful);mixin(Element,Transformable);function animateTo(s,a,o,c,d){o=o||{};var tt=[];animateToShallow(s,"",s,a,o,c,tt,d);var nt=tt.length,it=!1,st=o.done,ut=o.aborted,ct=function(){it=!0,nt--,nt<=0&&(it?st&&st():ut&&ut())},ot=function(){nt--,nt<=0&&(it?st&&st():ut&&ut())};nt||st&&st(),tt.length>0&&o.during&&tt[0].during(function(ft,mt){o.during(mt)});for(var at=0;at<tt.length;at++){var ht=tt[at];ct&&ht.done(ct),ot&&ht.aborted(ot),o.force&&ht.duration(o.duration),ht.start(o.easing)}return tt}function copyArrShallow(s,a,o){for(var c=0;c<o;c++)s[c]=a[c]}function is2DArray(s){return isArrayLike(s[0])}function copyValue(s,a,o){if(isArrayLike(a[o]))if(isArrayLike(s[o])||(s[o]=[]),isTypedArray(a[o])){var c=a[o].length;s[o].length!==c&&(s[o]=new a[o].constructor(c),copyArrShallow(s[o],a[o],c))}else{var d=a[o],tt=s[o],nt=d.length;if(is2DArray(d))for(var it=d[0].length,st=0;st<nt;st++)tt[st]?copyArrShallow(tt[st],d[st],it):tt[st]=Array.prototype.slice.call(d[st]);else copyArrShallow(tt,d,nt);tt.length=d.length}else s[o]=a[o]}function isValueSame(s,a){return s===a||isArrayLike(s)&&isArrayLike(a)&&is1DArraySame(s,a)}function is1DArraySame(s,a){var o=s.length;if(o!==a.length)return!1;for(var c=0;c<o;c++)if(s[c]!==a[c])return!1;return!0}function animateToShallow(s,a,o,c,d,tt,nt,it){for(var st=keys(c),ut=d.duration,ct=d.delay,ot=d.additive,at=d.setToFinal,ht=!isObject$3(tt),ft=s.animators,mt=[],yt=0;yt<st.length;yt++){var bt=st[yt],wt=c[bt];if(wt!=null&&o[bt]!=null&&(ht||tt[bt]))if(isObject$3(wt)&&!isArrayLike(wt)&&!isGradientObject(wt)){if(a){it||(o[bt]=wt,s.updateDuringAnimation(a));continue}animateToShallow(s,bt,o[bt],wt,d,tt&&tt[bt],nt,it)}else mt.push(bt);else it||(o[bt]=wt,s.updateDuringAnimation(a),mt.push(bt))}var Tt=mt.length;if(!ot&&Tt)for(var Ct=0;Ct<ft.length;Ct++){var Dt=ft[Ct];if(Dt.targetName===a){var Ot=Dt.stopTracks(mt);if(Ot){var $t=indexOf(ft,Dt);ft.splice($t,1)}}}if(d.force||(mt=filter(mt,function(Ht){return!isValueSame(c[Ht],o[Ht])}),Tt=mt.length),Tt>0||d.force&&!nt.length){var Ft=void 0,kt=void 0,Vt=void 0;if(it){kt={},at&&(Ft={});for(var Ct=0;Ct<Tt;Ct++){var bt=mt[Ct];kt[bt]=o[bt],at?Ft[bt]=c[bt]:o[bt]=c[bt]}}else if(at){Vt={};for(var Ct=0;Ct<Tt;Ct++){var bt=mt[Ct];Vt[bt]=cloneValue(o[bt]),copyValue(o,c,bt)}}var Dt=new Animator(o,!1,!1,ot?filter(ft,function(Qt){return Qt.targetName===a}):null);Dt.targetName=a,d.scope&&(Dt.scope=d.scope),at&&Ft&&Dt.whenWithKeys(0,Ft,mt),Vt&&Dt.whenWithKeys(0,Vt,mt),Dt.whenWithKeys(ut??500,it?kt:c,mt).delay(ct||0),s.addAnimator(Dt,a),nt.push(Dt)}}var Group$3=function(s){__extends(a,s);function a(o){var c=s.call(this)||this;return c.isGroup=!0,c._children=[],c.attr(o),c}return a.prototype.childrenRef=function(){return this._children},a.prototype.children=function(){return this._children.slice()},a.prototype.childAt=function(o){return this._children[o]},a.prototype.childOfName=function(o){for(var c=this._children,d=0;d<c.length;d++)if(c[d].name===o)return c[d]},a.prototype.childCount=function(){return this._children.length},a.prototype.add=function(o){return o&&o!==this&&o.parent!==this&&(this._children.push(o),this._doAdd(o)),this},a.prototype.addBefore=function(o,c){if(o&&o!==this&&o.parent!==this&&c&&c.parent===this){var d=this._children,tt=d.indexOf(c);tt>=0&&(d.splice(tt,0,o),this._doAdd(o))}return this},a.prototype.replace=function(o,c){var d=indexOf(this._children,o);return d>=0&&this.replaceAt(c,d),this},a.prototype.replaceAt=function(o,c){var d=this._children,tt=d[c];if(o&&o!==this&&o.parent!==this&&o!==tt){d[c]=o,tt.parent=null;var nt=this.__zr;nt&&tt.removeSelfFromZr(nt),this._doAdd(o)}return this},a.prototype._doAdd=function(o){o.parent&&o.parent.remove(o),o.parent=this;var c=this.__zr;c&&c!==o.__zr&&o.addSelfToZr(c),c&&c.refresh()},a.prototype.remove=function(o){var c=this.__zr,d=this._children,tt=indexOf(d,o);return tt<0?this:(d.splice(tt,1),o.parent=null,c&&o.removeSelfFromZr(c),c&&c.refresh(),this)},a.prototype.removeAll=function(){for(var o=this._children,c=this.__zr,d=0;d<o.length;d++){var tt=o[d];c&&tt.removeSelfFromZr(c),tt.parent=null}return o.length=0,this},a.prototype.eachChild=function(o,c){for(var d=this._children,tt=0;tt<d.length;tt++){var nt=d[tt];o.call(c,nt,tt)}return this},a.prototype.traverse=function(o,c){for(var d=0;d<this._children.length;d++){var tt=this._children[d],nt=o.call(c,tt);tt.isGroup&&!nt&&tt.traverse(o,c)}return this},a.prototype.addSelfToZr=function(o){s.prototype.addSelfToZr.call(this,o);for(var c=0;c<this._children.length;c++){var d=this._children[c];d.addSelfToZr(o)}},a.prototype.removeSelfFromZr=function(o){s.prototype.removeSelfFromZr.call(this,o);for(var c=0;c<this._children.length;c++){var d=this._children[c];d.removeSelfFromZr(o)}},a.prototype.getBoundingRect=function(o){for(var c=new BoundingRect(0,0,0,0),d=o||this._children,tt=[],nt=null,it=0;it<d.length;it++){var st=d[it];if(!(st.ignore||st.invisible)){var ut=st.getBoundingRect(),ct=st.getLocalTransform(tt);ct?(BoundingRect.applyTransform(c,ut,ct),nt=nt||c.clone(),nt.union(c)):(nt=nt||ut.clone(),nt.union(ut))}}return nt||c},a}(Element);Group$3.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var painterCtors={},instances$1={};function delInstance(s){delete instances$1[s]}function isDarkMode(s){if(!s)return!1;if(typeof s=="string")return lum(s,1)<DARK_MODE_THRESHOLD;if(s.colorStops){for(var a=s.colorStops,o=0,c=a.length,d=0;d<c;d++)o+=lum(a[d].color,1);return o/=c,o<DARK_MODE_THRESHOLD}return!1}var ZRender=function(){function s(a,o,c){var d=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,c=c||{},this.dom=o,this.id=a;var tt=new Storage,nt=c.renderer||"canvas";painterCtors[nt]||(nt=keys(painterCtors)[0]),c.useDirtyRect=c.useDirtyRect==null?!1:c.useDirtyRect;var it=new painterCtors[nt](o,tt,c,a),st=c.ssr||it.ssrOnly;this.storage=tt,this.painter=it;var ut=!env.node&&!env.worker&&!st?new HandlerDomProxy(it.getViewportRoot(),it.root):null,ct=c.useCoarsePointer,ot=ct==null||ct==="auto"?env.touchEventsSupported:!!ct,at=44,ht;ot&&(ht=retrieve2(c.pointerSize,at)),this.handler=new Handler(tt,it,ut,it.root,ht),this.animation=new Animation({stage:{update:st?null:function(){return d._flush(!0)}}}),st||this.animation.start()}return s.prototype.add=function(a){this._disposed||!a||(this.storage.addRoot(a),a.addSelfToZr(this),this.refresh())},s.prototype.remove=function(a){this._disposed||!a||(this.storage.delRoot(a),a.removeSelfFromZr(this),this.refresh())},s.prototype.configLayer=function(a,o){this._disposed||(this.painter.configLayer&&this.painter.configLayer(a,o),this.refresh())},s.prototype.setBackgroundColor=function(a){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(a),this.refresh(),this._backgroundColor=a,this._darkMode=isDarkMode(a))},s.prototype.getBackgroundColor=function(){return this._backgroundColor},s.prototype.setDarkMode=function(a){this._darkMode=a},s.prototype.isDarkMode=function(){return this._darkMode},s.prototype.refreshImmediately=function(a){this._disposed||(a||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},s.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},s.prototype.flush=function(){this._disposed||this._flush(!1)},s.prototype._flush=function(a){var o,c=getTime();this._needsRefresh&&(o=!0,this.refreshImmediately(a)),this._needsRefreshHover&&(o=!0,this.refreshHoverImmediately());var d=getTime();o?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:d-c})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},s.prototype.setSleepAfterStill=function(a){this._sleepAfterStill=a},s.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},s.prototype.refreshHover=function(){this._needsRefreshHover=!0},s.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},s.prototype.resize=function(a){this._disposed||(a=a||{},this.painter.resize(a.width,a.height),this.handler.resize())},s.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},s.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},s.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},s.prototype.setCursorStyle=function(a){this._disposed||this.handler.setCursorStyle(a)},s.prototype.findHover=function(a,o){if(!this._disposed)return this.handler.findHover(a,o)},s.prototype.on=function(a,o,c){return this._disposed||this.handler.on(a,o,c),this},s.prototype.off=function(a,o){this._disposed||this.handler.off(a,o)},s.prototype.trigger=function(a,o){this._disposed||this.handler.trigger(a,o)},s.prototype.clear=function(){if(!this._disposed){for(var a=this.storage.getRoots(),o=0;o<a.length;o++)a[o]instanceof Group$3&&a[o].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},s.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,delInstance(this.id))},s}();function init$2(s,a){var o=new ZRender(guid(),s,a);return instances$1[o.id]=o,o}function dispose$1(s){s.dispose()}function disposeAll(){for(var s in instances$1)instances$1.hasOwnProperty(s)&&instances$1[s].dispose();instances$1={}}function getInstance(s){return instances$1[s]}function registerPainter(s,a){painterCtors[s]=a}var ssrDataGetter;function getElementSSRData(s){if(typeof ssrDataGetter=="function")return ssrDataGetter(s)}function registerSSRDataGetter(s){ssrDataGetter=s}var version$1="5.6.1";const zrender=Object.freeze(Object.defineProperty({__proto__:null,dispose:dispose$1,disposeAll,getElementSSRData,getInstance,init:init$2,registerPainter,registerSSRDataGetter,version:version$1},Symbol.toStringTag,{value:"Module"}));var RADIAN_EPSILON=1e-4,ROUND_SUPPORTED_PRECISION_MAX=20;function _trim(s){return s.replace(/^\s+|\s+$/g,"")}function linearMap$2(s,a,o,c){var d=a[0],tt=a[1],nt=o[0],it=o[1],st=tt-d,ut=it-nt;if(st===0)return ut===0?nt:(nt+it)/2;if(c)if(st>0){if(s<=d)return nt;if(s>=tt)return it}else{if(s>=d)return nt;if(s<=tt)return it}else{if(s===d)return nt;if(s===tt)return it}return(s-d)/st*ut+nt}function parsePercent(s,a){switch(s){case"center":case"middle":s="50%";break;case"left":case"top":s="0%";break;case"right":case"bottom":s="100%";break}return isString$1(s)?_trim(s).match(/%$/)?parseFloat(s)/100*a:parseFloat(s):s==null?NaN:+s}function round$3(s,a,o){return a==null&&(a=10),a=Math.min(Math.max(0,a),ROUND_SUPPORTED_PRECISION_MAX),s=(+s).toFixed(a),o?s:+s}function asc$2(s){return s.sort(function(a,o){return a-o}),s}function getPrecision(s){if(s=+s,isNaN(s))return 0;if(s>1e-14){for(var a=1,o=0;o<15;o++,a*=10)if(Math.round(s*a)/a===s)return o}return getPrecisionSafe(s)}function getPrecisionSafe(s){var a=s.toString().toLowerCase(),o=a.indexOf("e"),c=o>0?+a.slice(o+1):0,d=o>0?o:a.length,tt=a.indexOf("."),nt=tt<0?0:d-1-tt;return Math.max(0,nt-c)}function getPixelPrecision(s,a){var o=Math.log,c=Math.LN10,d=Math.floor(o(s[1]-s[0])/c),tt=Math.round(o(Math.abs(a[1]-a[0]))/c),nt=Math.min(Math.max(-d+tt,0),20);return isFinite(nt)?nt:20}function getPercentWithPrecision(s,a,o){if(!s[a])return 0;var c=getPercentSeats(s,o);return c[a]||0}function getPercentSeats(s,a){var o=reduce(s,function(ht,ft){return ht+(isNaN(ft)?0:ft)},0);if(o===0)return[];for(var c=Math.pow(10,a),d=map$1(s,function(ht){return(isNaN(ht)?0:ht)/o*c*100}),tt=c*100,nt=map$1(d,function(ht){return Math.floor(ht)}),it=reduce(nt,function(ht,ft){return ht+ft},0),st=map$1(d,function(ht,ft){return ht-nt[ft]});it<tt;){for(var ut=Number.NEGATIVE_INFINITY,ct=null,ot=0,at=st.length;ot<at;++ot)st[ot]>ut&&(ut=st[ot],ct=ot);++nt[ct],st[ct]=0,++it}return map$1(nt,function(ht){return ht/c})}function addSafe(s,a){var o=Math.max(getPrecision(s),getPrecision(a)),c=s+a;return o>ROUND_SUPPORTED_PRECISION_MAX?c:round$3(c,o)}var MAX_SAFE_INTEGER=9007199254740991;function remRadian(s){var a=Math.PI*2;return(s%a+a)%a}function isRadianAroundZero(s){return s>-RADIAN_EPSILON&&s<RADIAN_EPSILON}var TIME_REG=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function parseDate(s){if(s instanceof Date)return s;if(isString$1(s)){var a=TIME_REG.exec(s);if(!a)return new Date(NaN);if(a[8]){var o=+a[4]||0;return a[8].toUpperCase()!=="Z"&&(o-=+a[8].slice(0,3)),new Date(Date.UTC(+a[1],+(a[2]||1)-1,+a[3]||1,o,+(a[5]||0),+a[6]||0,a[7]?+a[7].substring(0,3):0))}else return new Date(+a[1],+(a[2]||1)-1,+a[3]||1,+a[4]||0,+(a[5]||0),+a[6]||0,a[7]?+a[7].substring(0,3):0)}else if(s==null)return new Date(NaN);return new Date(Math.round(s))}function quantity(s){return Math.pow(10,quantityExponent(s))}function quantityExponent(s){if(s===0)return 0;var a=Math.floor(Math.log(s)/Math.LN10);return s/Math.pow(10,a)>=10&&a++,a}function nice(s,a){var o=quantityExponent(s),c=Math.pow(10,o),d=s/c,tt;return a?d<1.5?tt=1:d<2.5?tt=2:d<4?tt=3:d<7?tt=5:tt=10:d<1?tt=1:d<2?tt=2:d<3?tt=3:d<5?tt=5:tt=10,s=tt*c,o>=-20?+s.toFixed(o<0?-o:0):s}function quantile(s,a){var o=(s.length-1)*a+1,c=Math.floor(o),d=+s[c-1],tt=o-c;return tt?d+tt*(s[c]-d):d}function reformIntervals(s){s.sort(function(st,ut){return it(st,ut,0)?-1:1});for(var a=-1/0,o=1,c=0;c<s.length;){for(var d=s[c].interval,tt=s[c].close,nt=0;nt<2;nt++)d[nt]<=a&&(d[nt]=a,tt[nt]=nt?1:1-o),a=d[nt],o=tt[nt];d[0]===d[1]&&tt[0]*tt[1]!==1?s.splice(c,1):c++}return s;function it(st,ut,ct){return st.interval[ct]<ut.interval[ct]||st.interval[ct]===ut.interval[ct]&&(st.close[ct]-ut.close[ct]===(ct?-1:1)||!ct&&it(st,ut,1))}}function numericToNumber(s){var a=parseFloat(s);return a==s&&(a!==0||!isString$1(s)||s.indexOf("x")<=0)?a:NaN}function isNumeric(s){return!isNaN(numericToNumber(s))}function getRandomIdBase(){return Math.round(Math.random()*9)}function getGreatestCommonDividor(s,a){return a===0?s:getGreatestCommonDividor(a,s%a)}function getLeastCommonMultiple(s,a){return s==null?a:a==null?s:s*a/getGreatestCommonDividor(s,a)}function throwError(s){throw new Error(s)}function interpolateNumber(s,a,o){return(a-s)*o+s}var DUMMY_COMPONENT_NAME_PREFIX="series\0",INTERNAL_COMPONENT_ID_PREFIX="\0_ec_\0";function normalizeToArray(s){return s instanceof Array?s:s==null?[]:[s]}function defaultEmphasis(s,a,o){if(s){s[a]=s[a]||{},s.emphasis=s.emphasis||{},s.emphasis[a]=s.emphasis[a]||{};for(var c=0,d=o.length;c<d;c++){var tt=o[c];!s.emphasis[a].hasOwnProperty(tt)&&s[a].hasOwnProperty(tt)&&(s.emphasis[a][tt]=s[a][tt])}}}var TEXT_STYLE_OPTIONS=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function getDataItemValue(s){return isObject$3(s)&&!isArray$1(s)&&!(s instanceof Date)?s.value:s}function isDataItemOption(s){return isObject$3(s)&&!(s instanceof Array)}function mappingToExists(s,a,o){var c=o==="normalMerge",d=o==="replaceMerge",tt=o==="replaceAll";s=s||[],a=(a||[]).slice();var nt=createHashMap();each$f(a,function(st,ut){if(!isObject$3(st)){a[ut]=null;return}});var it=prepareResult(s,nt,o);return(c||d)&&mappingById(it,s,nt,a),c&&mappingByName(it,a),c||d?mappingByIndex(it,a,d):tt&&mappingInReplaceAllMode(it,a),makeIdAndName(it),it}function prepareResult(s,a,o){var c=[];if(o==="replaceAll")return c;for(var d=0;d<s.length;d++){var tt=s[d];tt&&tt.id!=null&&a.set(tt.id,d),c.push({existing:o==="replaceMerge"||isComponentIdInternal(tt)?null:tt,newOption:null,keyInfo:null,brandNew:null})}return c}function mappingById(s,a,o,c){each$f(c,function(d,tt){if(!(!d||d.id==null)){var nt=makeComparableKey(d.id),it=o.get(nt);if(it!=null){var st=s[it];assert(!st.newOption,'Duplicated option on id "'+nt+'".'),st.newOption=d,st.existing=a[it],c[tt]=null}}})}function mappingByName(s,a){each$f(a,function(o,c){if(!(!o||o.name==null))for(var d=0;d<s.length;d++){var tt=s[d].existing;if(!s[d].newOption&&tt&&(tt.id==null||o.id==null)&&!isComponentIdInternal(o)&&!isComponentIdInternal(tt)&&keyExistAndEqual("name",tt,o)){s[d].newOption=o,a[c]=null;return}}})}function mappingByIndex(s,a,o){each$f(a,function(c){if(c){for(var d,tt=0;(d=s[tt])&&(d.newOption||isComponentIdInternal(d.existing)||d.existing&&c.id!=null&&!keyExistAndEqual("id",c,d.existing));)tt++;d?(d.newOption=c,d.brandNew=o):s.push({newOption:c,brandNew:o,existing:null,keyInfo:null}),tt++}})}function mappingInReplaceAllMode(s,a){each$f(a,function(o){s.push({newOption:o,brandNew:!0,existing:null,keyInfo:null})})}function makeIdAndName(s){var a=createHashMap();each$f(s,function(o){var c=o.existing;c&&a.set(c.id,o)}),each$f(s,function(o){var c=o.newOption;assert(!c||c.id==null||!a.get(c.id)||a.get(c.id)===o,"id duplicates: "+(c&&c.id)),c&&c.id!=null&&a.set(c.id,o),!o.keyInfo&&(o.keyInfo={})}),each$f(s,function(o,c){var d=o.existing,tt=o.newOption,nt=o.keyInfo;if(isObject$3(tt)){if(nt.name=tt.name!=null?makeComparableKey(tt.name):d?d.name:DUMMY_COMPONENT_NAME_PREFIX+c,d)nt.id=makeComparableKey(d.id);else if(tt.id!=null)nt.id=makeComparableKey(tt.id);else{var it=0;do nt.id="\0"+nt.name+"\0"+it++;while(a.get(nt.id))}a.set(nt.id,o)}})}function keyExistAndEqual(s,a,o){var c=convertOptionIdName(a[s],null),d=convertOptionIdName(o[s],null);return c!=null&&d!=null&&c===d}function makeComparableKey(s){return convertOptionIdName(s,"")}function convertOptionIdName(s,a){return s==null?a:isString$1(s)?s:isNumber(s)||isStringSafe(s)?s+"":a}function isNameSpecified(s){var a=s.name;return!!(a&&a.indexOf(DUMMY_COMPONENT_NAME_PREFIX))}function isComponentIdInternal(s){return s&&s.id!=null&&makeComparableKey(s.id).indexOf(INTERNAL_COMPONENT_ID_PREFIX)===0}function makeInternalComponentId(s){return INTERNAL_COMPONENT_ID_PREFIX+s}function setComponentTypeToKeyInfo(s,a,o){each$f(s,function(c){var d=c.newOption;isObject$3(d)&&(c.keyInfo.mainType=a,c.keyInfo.subType=determineSubType(a,d,c.existing,o))})}function determineSubType(s,a,o,c){var d=a.type?a.type:o?o.subType:c.determineSubType(s,a);return d}function compressBatches(s,a){var o={},c={};return d(s||[],o),d(a||[],c,o),[tt(o),tt(c)];function d(nt,it,st){for(var ut=0,ct=nt.length;ut<ct;ut++){var ot=convertOptionIdName(nt[ut].seriesId,null);if(ot==null)return;for(var at=normalizeToArray(nt[ut].dataIndex),ht=st&&st[ot],ft=0,mt=at.length;ft<mt;ft++){var yt=at[ft];ht&&ht[yt]?ht[yt]=null:(it[ot]||(it[ot]={}))[yt]=1}}}function tt(nt,it){var st=[];for(var ut in nt)if(nt.hasOwnProperty(ut)&&nt[ut]!=null)if(it)st.push(+ut);else{var ct=tt(nt[ut],!0);ct.length&&st.push({seriesId:ut,dataIndex:ct})}return st}}function queryDataIndex(s,a){if(a.dataIndexInside!=null)return a.dataIndexInside;if(a.dataIndex!=null)return isArray$1(a.dataIndex)?map$1(a.dataIndex,function(o){return s.indexOfRawIndex(o)}):s.indexOfRawIndex(a.dataIndex);if(a.name!=null)return isArray$1(a.name)?map$1(a.name,function(o){return s.indexOfName(o)}):s.indexOfName(a.name)}function makeInner(){var s="__ec_inner_"+innerUniqueIndex++;return function(a){return a[s]||(a[s]={})}}var innerUniqueIndex=getRandomIdBase();function parseFinder$1(s,a,o){var c=preParseFinder(a,o),d=c.mainTypeSpecified,tt=c.queryOptionMap,nt=c.others,it=nt,st=o?o.defaultMainType:null;return!d&&st&&tt.set(st,{}),tt.each(function(ut,ct){var ot=queryReferringComponents(s,ct,ut,{useDefault:st===ct,enableAll:o&&o.enableAll!=null?o.enableAll:!0,enableNone:o&&o.enableNone!=null?o.enableNone:!0});it[ct+"Models"]=ot.models,it[ct+"Model"]=ot.models[0]}),it}function preParseFinder(s,a){var o;if(isString$1(s)){var c={};c[s+"Index"]=0,o=c}else o=s;var d=createHashMap(),tt={},nt=!1;return each$f(o,function(it,st){if(st==="dataIndex"||st==="dataIndexInside"){tt[st]=it;return}var ut=st.match(/^(\w+)(Index|Id|Name)$/)||[],ct=ut[1],ot=(ut[2]||"").toLowerCase();if(!(!ct||!ot||a&&a.includeMainTypes&&indexOf(a.includeMainTypes,ct)<0)){nt=nt||!!ct;var at=d.get(ct)||d.set(ct,{});at[ot]=it}}),{mainTypeSpecified:nt,queryOptionMap:d,others:tt}}var SINGLE_REFERRING={useDefault:!0,enableAll:!1,enableNone:!1},MULTIPLE_REFERRING={useDefault:!1,enableAll:!0,enableNone:!0};function queryReferringComponents(s,a,o,c){c=c||SINGLE_REFERRING;var d=o.index,tt=o.id,nt=o.name,it={models:null,specified:d!=null||tt!=null||nt!=null};if(!it.specified){var st=void 0;return it.models=c.useDefault&&(st=s.getComponent(a))?[st]:[],it}return d==="none"||d===!1?(assert(c.enableNone,'`"none"` or `false` is not a valid value on index option.'),it.models=[],it):(d==="all"&&(assert(c.enableAll,'`"all"` is not a valid value on index option.'),d=tt=nt=null),it.models=s.queryComponents({mainType:a,index:d,id:tt,name:nt}),it)}function setAttribute(s,a,o){s.setAttribute?s.setAttribute(a,o):s[a]=o}function getAttribute(s,a){return s.getAttribute?s.getAttribute(a):s[a]}function getTooltipRenderMode(s){return s==="auto"?env.domSupported?"html":"richText":s||"html"}function groupData(s,a){var o=createHashMap(),c=[];return each$f(s,function(d){var tt=a(d);(o.get(tt)||(c.push(tt),o.set(tt,[]))).push(d)}),{keys:c,buckets:o}}function interpolateRawValues(s,a,o,c,d){var tt=a==null||a==="auto";if(c==null)return c;if(isNumber(c)){var nt=interpolateNumber(o||0,c,d);return round$3(nt,tt?Math.max(getPrecision(o||0),getPrecision(c)):a)}else{if(isString$1(c))return d<1?o:c;for(var it=[],st=o,ut=c,ct=Math.max(st?st.length:0,ut.length),ot=0;ot<ct;++ot){var at=s.getDimensionInfo(ot);if(at&&at.type==="ordinal")it[ot]=(d<1&&st?st:ut)[ot];else{var ht=st&&st[ot]?st[ot]:0,ft=ut[ot],nt=interpolateNumber(ht,ft,d);it[ot]=round$3(nt,tt?Math.max(getPrecision(ht),getPrecision(ft)):a)}}return it}}var TYPE_DELIMITER=".",IS_CONTAINER="___EC__COMPONENT__CONTAINER___",IS_EXTENDED_CLASS="___EC__EXTENDED_CLASS___";function parseClassType(s){var a={main:"",sub:""};if(s){var o=s.split(TYPE_DELIMITER);a.main=o[0]||"",a.sub=o[1]||""}return a}function checkClassType(s){assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(s),'componentType "'+s+'" illegal')}function isExtendedClass(s){return!!(s&&s[IS_EXTENDED_CLASS])}function enableClassExtend(s,a){s.$constructor=s,s.extend=function(o){var c=this,d;return isESClass(c)?d=function(tt){__extends$1(nt,tt);function nt(){return tt.apply(this,arguments)||this}return nt}(c):(d=function(){(o.$constructor||c).apply(this,arguments)},inherits(d,this)),extend(d.prototype,o),d[IS_EXTENDED_CLASS]=!0,d.extend=this.extend,d.superCall=superCall,d.superApply=superApply,d.superClass=c,d}}function isESClass(s){return isFunction$1(s)&&/^class\s/.test(Function.prototype.toString.call(s))}function mountExtend(s,a){s.extend=a.extend}var classBase=Math.round(Math.random()*10);function enableClassCheck(s){var a=["__\0is_clz",classBase++].join("_");s.prototype[a]=!0,s.isInstance=function(o){return!!(o&&o[a])}}function superCall(s,a){for(var o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];return this.superClass.prototype[a].apply(s,o)}function superApply(s,a,o){return this.superClass.prototype[a].apply(s,o)}function enableClassManagement(s){var a={};s.registerClass=function(c){var d=c.type||c.prototype.type;if(d){checkClassType(d),c.prototype.type=d;var tt=parseClassType(d);if(!tt.sub)a[tt.main]=c;else if(tt.sub!==IS_CONTAINER){var nt=o(tt);nt[tt.sub]=c}}return c},s.getClass=function(c,d,tt){var nt=a[c];if(nt&&nt[IS_CONTAINER]&&(nt=d?nt[d]:null),tt&&!nt)throw new Error(d?"Component "+c+"."+(d||"")+" is used but not imported.":c+".type should be specified.");return nt},s.getClassesByMainType=function(c){var d=parseClassType(c),tt=[],nt=a[d.main];return nt&&nt[IS_CONTAINER]?each$f(nt,function(it,st){st!==IS_CONTAINER&&tt.push(it)}):tt.push(nt),tt},s.hasClass=function(c){var d=parseClassType(c);return!!a[d.main]},s.getAllClassMainTypes=function(){var c=[];return each$f(a,function(d,tt){c.push(tt)}),c},s.hasSubTypes=function(c){var d=parseClassType(c),tt=a[d.main];return tt&&tt[IS_CONTAINER]};function o(c){var d=a[c.main];return(!d||!d[IS_CONTAINER])&&(d=a[c.main]={},d[IS_CONTAINER]=!0),d}}function makeStyleMapper(s,a){for(var o=0;o<s.length;o++)s[o][1]||(s[o][1]=s[o][0]);return a=a||!1,function(c,d,tt){for(var nt={},it=0;it<s.length;it++){var st=s[it][1];if(!(d&&indexOf(d,st)>=0||tt&&indexOf(tt,st)<0)){var ut=c.getShallow(st,a);ut!=null&&(nt[s[it][0]]=ut)}}return nt}}var AREA_STYLE_KEY_MAP=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],getAreaStyle=makeStyleMapper(AREA_STYLE_KEY_MAP),AreaStyleMixin=function(){function s(){}return s.prototype.getAreaStyle=function(a,o){return getAreaStyle(this,a,o)},s}(),globalImageCache=new LRU(50);function findExistImage(s){if(typeof s=="string"){var a=globalImageCache.get(s);return a&&a.image}else return s}function createOrUpdateImage(s,a,o,c,d){if(s)if(typeof s=="string"){if(a&&a.__zrImageSrc===s||!o)return a;var tt=globalImageCache.get(s),nt={hostEl:o,cb:c,cbPayload:d};return tt?(a=tt.image,!isImageReady(a)&&tt.pending.push(nt)):(a=platformApi.loadImage(s,imageOnLoad,imageOnLoad),a.__zrImageSrc=s,globalImageCache.put(s,a.__cachedImgObj={image:a,pending:[nt]})),a}else return s;else return a}function imageOnLoad(){var s=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var a=0;a<s.pending.length;a++){var o=s.pending[a],c=o.cb;c&&c(this,o.cbPayload),o.hostEl.dirty()}s.pending.length=0}function isImageReady(s){return s&&s.width&&s.height}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText(s,a,o,c,d){var tt={};return truncateText2(tt,s,a,o,c,d),tt.text}function truncateText2(s,a,o,c,d,tt){if(!o){s.text="",s.isTruncated=!1;return}var nt=(a+"").split(`
`);tt=prepareTruncateOptions(o,c,d,tt);for(var it=!1,st={},ut=0,ct=nt.length;ut<ct;ut++)truncateSingleLine(st,nt[ut],tt),nt[ut]=st.textLine,it=it||st.isTruncated;s.text=nt.join(`
`),s.isTruncated=it}function prepareTruncateOptions(s,a,o,c){c=c||{};var d=extend({},c);d.font=a,o=retrieve2(o,"..."),d.maxIterations=retrieve2(c.maxIterations,2);var tt=d.minChar=retrieve2(c.minChar,0);d.cnCharWidth=getWidth("国",a);var nt=d.ascCharWidth=getWidth("a",a);d.placeholder=retrieve2(c.placeholder,"");for(var it=s=Math.max(0,s-1),st=0;st<tt&&it>=nt;st++)it-=nt;var ut=getWidth(o,a);return ut>it&&(o="",ut=0),it=s-ut,d.ellipsis=o,d.ellipsisWidth=ut,d.contentWidth=it,d.containerWidth=s,d}function truncateSingleLine(s,a,o){var c=o.containerWidth,d=o.font,tt=o.contentWidth;if(!c){s.textLine="",s.isTruncated=!1;return}var nt=getWidth(a,d);if(nt<=c){s.textLine=a,s.isTruncated=!1;return}for(var it=0;;it++){if(nt<=tt||it>=o.maxIterations){a+=o.ellipsis;break}var st=it===0?estimateLength(a,tt,o.ascCharWidth,o.cnCharWidth):nt>0?Math.floor(a.length*tt/nt):0;a=a.substr(0,st),nt=getWidth(a,d)}a===""&&(a=o.placeholder),s.textLine=a,s.isTruncated=!0}function estimateLength(s,a,o,c){for(var d=0,tt=0,nt=s.length;tt<nt&&d<a;tt++){var it=s.charCodeAt(tt);d+=0<=it&&it<=127?o:c}return tt}function parsePlainText(s,a){s!=null&&(s+="");var o=a.overflow,c=a.padding,d=a.font,tt=o==="truncate",nt=getLineHeight(d),it=retrieve2(a.lineHeight,nt),st=!!a.backgroundColor,ut=a.lineOverflow==="truncate",ct=!1,ot=a.width,at;ot!=null&&(o==="break"||o==="breakAll")?at=s?wrapText(s,a.font,ot,o==="breakAll",0).lines:[]:at=s?s.split(`
`):[];var ht=at.length*it,ft=retrieve2(a.height,ht);if(ht>ft&&ut){var mt=Math.floor(ft/it);ct=ct||at.length>mt,at=at.slice(0,mt)}if(s&&tt&&ot!=null)for(var yt=prepareTruncateOptions(ot,d,a.ellipsis,{minChar:a.truncateMinChar,placeholder:a.placeholder}),bt={},wt=0;wt<at.length;wt++)truncateSingleLine(bt,at[wt],yt),at[wt]=bt.textLine,ct=ct||bt.isTruncated;for(var Tt=ft,Ct=0,wt=0;wt<at.length;wt++)Ct=Math.max(getWidth(at[wt],d),Ct);ot==null&&(ot=Ct);var Dt=Ct;return c&&(Tt+=c[0]+c[2],Dt+=c[1]+c[3],ot+=c[1]+c[3]),st&&(Dt=ot),{lines:at,height:ft,outerWidth:Dt,outerHeight:Tt,lineHeight:it,calculatedLineHeight:nt,contentWidth:Ct,contentHeight:ht,width:ot,isTruncated:ct}}var RichTextToken=function(){function s(){}return s}(),RichTextLine=function(){function s(a){this.tokens=[],a&&(this.tokens=a)}return s}(),RichTextContentBlock=function(){function s(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}return s}();function parseRichText(s,a){var o=new RichTextContentBlock;if(s!=null&&(s+=""),!s)return o;for(var c=a.width,d=a.height,tt=a.overflow,nt=(tt==="break"||tt==="breakAll")&&c!=null?{width:c,accumWidth:0,breakAll:tt==="breakAll"}:null,it=STYLE_REG.lastIndex=0,st;(st=STYLE_REG.exec(s))!=null;){var ut=st.index;ut>it&&pushTokens(o,s.substring(it,ut),a,nt),pushTokens(o,st[2],a,nt,st[1]),it=STYLE_REG.lastIndex}it<s.length&&pushTokens(o,s.substring(it,s.length),a,nt);var ct=[],ot=0,at=0,ht=a.padding,ft=tt==="truncate",mt=a.lineOverflow==="truncate",yt={};function bt(Dr,kr,Yr){Dr.width=kr,Dr.lineHeight=Yr,ot+=Yr,at=Math.max(at,kr)}e:for(var wt=0;wt<o.lines.length;wt++){for(var Tt=o.lines[wt],Ct=0,Dt=0,Ot=0;Ot<Tt.tokens.length;Ot++){var $t=Tt.tokens[Ot],Ft=$t.styleName&&a.rich[$t.styleName]||{},kt=$t.textPadding=Ft.padding,Vt=kt?kt[1]+kt[3]:0,Ht=$t.font=Ft.font||a.font;$t.contentHeight=getLineHeight(Ht);var Qt=retrieve2(Ft.height,$t.contentHeight);if($t.innerHeight=Qt,kt&&(Qt+=kt[0]+kt[2]),$t.height=Qt,$t.lineHeight=retrieve3(Ft.lineHeight,a.lineHeight,Qt),$t.align=Ft&&Ft.align||a.align,$t.verticalAlign=Ft&&Ft.verticalAlign||"middle",mt&&d!=null&&ot+$t.lineHeight>d){var Xt=o.lines.length;Ot>0?(Tt.tokens=Tt.tokens.slice(0,Ot),bt(Tt,Dt,Ct),o.lines=o.lines.slice(0,wt+1)):o.lines=o.lines.slice(0,wt),o.isTruncated=o.isTruncated||o.lines.length<Xt;break e}var Zt=Ft.width,ar=Zt==null||Zt==="auto";if(typeof Zt=="string"&&Zt.charAt(Zt.length-1)==="%")$t.percentWidth=Zt,ct.push($t),$t.contentWidth=getWidth($t.text,Ht);else{if(ar){var nr=Ft.backgroundColor,cr=nr&&nr.image;cr&&(cr=findExistImage(cr),isImageReady(cr)&&($t.width=Math.max($t.width,cr.width*Qt/cr.height)))}var dr=ft&&c!=null?c-Dt:null;dr!=null&&dr<$t.width?!ar||dr<Vt?($t.text="",$t.width=$t.contentWidth=0):(truncateText2(yt,$t.text,dr-Vt,Ht,a.ellipsis,{minChar:a.truncateMinChar}),$t.text=yt.text,o.isTruncated=o.isTruncated||yt.isTruncated,$t.width=$t.contentWidth=getWidth($t.text,Ht)):$t.contentWidth=getWidth($t.text,Ht)}$t.width+=Vt,Dt+=$t.width,Ft&&(Ct=Math.max(Ct,$t.lineHeight))}bt(Tt,Dt,Ct)}o.outerWidth=o.width=retrieve2(c,at),o.outerHeight=o.height=retrieve2(d,ot),o.contentHeight=ot,o.contentWidth=at,ht&&(o.outerWidth+=ht[1]+ht[3],o.outerHeight+=ht[0]+ht[2]);for(var wt=0;wt<ct.length;wt++){var $t=ct[wt],mr=$t.percentWidth;$t.width=parseInt(mr,10)/100*o.width}return o}function pushTokens(s,a,o,c,d){var tt=a==="",nt=d&&o.rich[d]||{},it=s.lines,st=nt.font||o.font,ut=!1,ct,ot;if(c){var at=nt.padding,ht=at?at[1]+at[3]:0;if(nt.width!=null&&nt.width!=="auto"){var ft=parsePercent$1(nt.width,c.width)+ht;it.length>0&&ft+c.accumWidth>c.width&&(ct=a.split(`
`),ut=!0),c.accumWidth=ft}else{var mt=wrapText(a,st,c.width,c.breakAll,c.accumWidth);c.accumWidth=mt.accumWidth+ht,ot=mt.linesWidths,ct=mt.lines}}else ct=a.split(`
`);for(var yt=0;yt<ct.length;yt++){var bt=ct[yt],wt=new RichTextToken;if(wt.styleName=d,wt.text=bt,wt.isLineHolder=!bt&&!tt,typeof nt.width=="number"?wt.width=nt.width:wt.width=ot?ot[yt]:getWidth(bt,st),!yt&&!ut){var Tt=(it[it.length-1]||(it[0]=new RichTextLine)).tokens,Ct=Tt.length;Ct===1&&Tt[0].isLineHolder?Tt[0]=wt:(bt||!Ct||tt)&&Tt.push(wt)}else it.push(new RichTextLine([wt]))}}function isAlphabeticLetter(s){var a=s.charCodeAt(0);return a>=32&&a<=591||a>=880&&a<=4351||a>=4608&&a<=5119||a>=7680&&a<=8303}var breakCharMap=reduce(",&?/;] ".split(""),function(s,a){return s[a]=!0,s},{});function isWordBreakChar(s){return isAlphabeticLetter(s)?!!breakCharMap[s]:!0}function wrapText(s,a,o,c,d){for(var tt=[],nt=[],it="",st="",ut=0,ct=0,ot=0;ot<s.length;ot++){var at=s.charAt(ot);if(at===`
`){st&&(it+=st,ct+=ut),tt.push(it),nt.push(ct),it="",st="",ut=0,ct=0;continue}var ht=getWidth(at,a),ft=c?!1:!isWordBreakChar(at);if(tt.length?ct+ht>o:d+ct+ht>o){ct?(it||st)&&(ft?(it||(it=st,st="",ut=0,ct=ut),tt.push(it),nt.push(ct-ut),st+=at,ut+=ht,it="",ct=ut):(st&&(it+=st,st="",ut=0),tt.push(it),nt.push(ct),it=at,ct=ht)):ft?(tt.push(st),nt.push(ut),st=at,ut=ht):(tt.push(at),nt.push(ht));continue}ct+=ht,ft?(st+=at,ut+=ht):(st&&(it+=st,st="",ut=0),it+=at)}return!tt.length&&!it&&(it=s,st="",ut=0),st&&(it+=st),it&&(tt.push(it),nt.push(ct)),tt.length===1&&(ct+=d),{accumWidth:ct,lines:tt,linesWidths:nt}}var STYLE_MAGIC_KEY="__zr_style_"+Math.round(Math.random()*10),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0;var PRIMARY_STATES_KEYS=["z","z2","invisible"],PRIMARY_STATES_KEYS_IN_HOVER_LAYER=["invisible"],Displayable=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype._init=function(o){for(var c=keys(o),d=0;d<c.length;d++){var tt=c[d];tt==="style"?this.useStyle(o[tt]):s.prototype.attrKV.call(this,tt,o[tt])}this.style||this.useStyle({})},a.prototype.beforeBrush=function(){},a.prototype.afterBrush=function(){},a.prototype.innerBeforeBrush=function(){},a.prototype.innerAfterBrush=function(){},a.prototype.shouldBePainted=function(o,c,d,tt){var nt=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&isDisplayableCulled(this,o,c)||nt&&!nt[0]&&!nt[3])return!1;if(d&&this.__clipPaths){for(var it=0;it<this.__clipPaths.length;++it)if(this.__clipPaths[it].isZeroArea())return!1}if(tt&&this.parent)for(var st=this.parent;st;){if(st.ignore)return!1;st=st.parent}return!0},a.prototype.contain=function(o,c){return this.rectContain(o,c)},a.prototype.traverse=function(o,c){o.call(c,this)},a.prototype.rectContain=function(o,c){var d=this.transformCoordToLocal(o,c),tt=this.getBoundingRect();return tt.contain(d[0],d[1])},a.prototype.getPaintRect=function(){var o=this._paintRect;if(!this._paintRect||this.__dirty){var c=this.transform,d=this.getBoundingRect(),tt=this.style,nt=tt.shadowBlur||0,it=tt.shadowOffsetX||0,st=tt.shadowOffsetY||0;o=this._paintRect||(this._paintRect=new BoundingRect(0,0,0,0)),c?BoundingRect.applyTransform(o,d,c):o.copy(d),(nt||it||st)&&(o.width+=nt*2+Math.abs(it),o.height+=nt*2+Math.abs(st),o.x=Math.min(o.x,o.x+it-nt),o.y=Math.min(o.y,o.y+st-nt));var ut=this.dirtyRectTolerance;o.isZero()||(o.x=Math.floor(o.x-ut),o.y=Math.floor(o.y-ut),o.width=Math.ceil(o.width+1+ut*2),o.height=Math.ceil(o.height+1+ut*2))}return o},a.prototype.setPrevPaintRect=function(o){o?(this._prevPaintRect=this._prevPaintRect||new BoundingRect(0,0,0,0),this._prevPaintRect.copy(o)):this._prevPaintRect=null},a.prototype.getPrevPaintRect=function(){return this._prevPaintRect},a.prototype.animateStyle=function(o){return this.animate("style",o)},a.prototype.updateDuringAnimation=function(o){o==="style"?this.dirtyStyle():this.markRedraw()},a.prototype.attrKV=function(o,c){o!=="style"?s.prototype.attrKV.call(this,o,c):this.style?this.setStyle(c):this.useStyle(c)},a.prototype.setStyle=function(o,c){return typeof o=="string"?this.style[o]=c:extend(this.style,o),this.dirtyStyle(),this},a.prototype.dirtyStyle=function(o){o||this.markRedraw(),this.__dirty|=STYLE_CHANGED_BIT,this._rect&&(this._rect=null)},a.prototype.dirty=function(){this.dirtyStyle()},a.prototype.styleChanged=function(){return!!(this.__dirty&STYLE_CHANGED_BIT)},a.prototype.styleUpdated=function(){this.__dirty&=~STYLE_CHANGED_BIT},a.prototype.createStyle=function(o){return createObject(DEFAULT_COMMON_STYLE,o)},a.prototype.useStyle=function(o){o[STYLE_MAGIC_KEY]||(o=this.createStyle(o)),this.__inHover?this.__hoverStyle=o:this.style=o,this.dirtyStyle()},a.prototype.isStyleObject=function(o){return o[STYLE_MAGIC_KEY]},a.prototype._innerSaveToNormal=function(o){s.prototype._innerSaveToNormal.call(this,o);var c=this._normalState;o.style&&!c.style&&(c.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(o,c,PRIMARY_STATES_KEYS)},a.prototype._applyStateObj=function(o,c,d,tt,nt,it){s.prototype._applyStateObj.call(this,o,c,d,tt,nt,it);var st=!(c&&tt),ut;if(c&&c.style?nt?tt?ut=c.style:(ut=this._mergeStyle(this.createStyle(),d.style),this._mergeStyle(ut,c.style)):(ut=this._mergeStyle(this.createStyle(),tt?this.style:d.style),this._mergeStyle(ut,c.style)):st&&(ut=d.style),ut)if(nt){var ct=this.style;if(this.style=this.createStyle(st?{}:ct),st)for(var ot=keys(ct),at=0;at<ot.length;at++){var ht=ot[at];ht in ut&&(ut[ht]=ut[ht],this.style[ht]=ct[ht])}for(var ft=keys(ut),at=0;at<ft.length;at++){var ht=ft[at];this.style[ht]=this.style[ht]}this._transitionState(o,{style:ut},it,this.getAnimationStyleProps())}else this.useStyle(ut);for(var mt=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS,at=0;at<mt.length;at++){var ht=mt[at];c&&c[ht]!=null?this[ht]=c[ht]:st&&d[ht]!=null&&(this[ht]=d[ht])}},a.prototype._mergeStates=function(o){for(var c=s.prototype._mergeStates.call(this,o),d,tt=0;tt<o.length;tt++){var nt=o[tt];nt.style&&(d=d||{},this._mergeStyle(d,nt.style))}return d&&(c.style=d),c},a.prototype._mergeStyle=function(o,c){return extend(o,c),o},a.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},a.initDefaultProps=function(){var o=a.prototype;o.type="displayable",o.invisible=!1,o.z=0,o.z2=0,o.zlevel=0,o.culling=!1,o.cursor="pointer",o.rectHover=!1,o.incremental=!1,o._rect=null,o.dirtyRectTolerance=0,o.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT}(),a}(Element),tmpRect=new BoundingRect(0,0,0,0),viewRect=new BoundingRect(0,0,0,0);function isDisplayableCulled(s,a,o){return tmpRect.copy(s.getBoundingRect()),s.transform&&tmpRect.applyTransform(s.transform),viewRect.width=a,viewRect.height=o,!tmpRect.intersect(viewRect)}var mathMin$9=Math.min,mathMax$9=Math.max,mathSin$4=Math.sin,mathCos$4=Math.cos,PI2$8=Math.PI*2,start=create$2(),end=create$2(),extremity=create$2();function fromPoints(s,a,o){if(s.length!==0){for(var c=s[0],d=c[0],tt=c[0],nt=c[1],it=c[1],st=1;st<s.length;st++)c=s[st],d=mathMin$9(d,c[0]),tt=mathMax$9(tt,c[0]),nt=mathMin$9(nt,c[1]),it=mathMax$9(it,c[1]);a[0]=d,a[1]=nt,o[0]=tt,o[1]=it}}function fromLine(s,a,o,c,d,tt){d[0]=mathMin$9(s,o),d[1]=mathMin$9(a,c),tt[0]=mathMax$9(s,o),tt[1]=mathMax$9(a,c)}var xDim=[],yDim=[];function fromCubic(s,a,o,c,d,tt,nt,it,st,ut){var ct=cubicExtrema,ot=cubicAt,at=ct(s,o,d,nt,xDim);st[0]=1/0,st[1]=1/0,ut[0]=-1/0,ut[1]=-1/0;for(var ht=0;ht<at;ht++){var ft=ot(s,o,d,nt,xDim[ht]);st[0]=mathMin$9(ft,st[0]),ut[0]=mathMax$9(ft,ut[0])}at=ct(a,c,tt,it,yDim);for(var ht=0;ht<at;ht++){var mt=ot(a,c,tt,it,yDim[ht]);st[1]=mathMin$9(mt,st[1]),ut[1]=mathMax$9(mt,ut[1])}st[0]=mathMin$9(s,st[0]),ut[0]=mathMax$9(s,ut[0]),st[0]=mathMin$9(nt,st[0]),ut[0]=mathMax$9(nt,ut[0]),st[1]=mathMin$9(a,st[1]),ut[1]=mathMax$9(a,ut[1]),st[1]=mathMin$9(it,st[1]),ut[1]=mathMax$9(it,ut[1])}function fromQuadratic(s,a,o,c,d,tt,nt,it){var st=quadraticExtremum,ut=quadraticAt$1,ct=mathMax$9(mathMin$9(st(s,o,d),1),0),ot=mathMax$9(mathMin$9(st(a,c,tt),1),0),at=ut(s,o,d,ct),ht=ut(a,c,tt,ot);nt[0]=mathMin$9(s,d,at),nt[1]=mathMin$9(a,tt,ht),it[0]=mathMax$9(s,d,at),it[1]=mathMax$9(a,tt,ht)}function fromArc(s,a,o,c,d,tt,nt,it,st){var ut=min$1,ct=max$2,ot=Math.abs(d-tt);if(ot%PI2$8<1e-4&&ot>1e-4){it[0]=s-o,it[1]=a-c,st[0]=s+o,st[1]=a+c;return}if(start[0]=mathCos$4(d)*o+s,start[1]=mathSin$4(d)*c+a,end[0]=mathCos$4(tt)*o+s,end[1]=mathSin$4(tt)*c+a,ut(it,start,end),ct(st,start,end),d=d%PI2$8,d<0&&(d=d+PI2$8),tt=tt%PI2$8,tt<0&&(tt=tt+PI2$8),d>tt&&!nt?tt+=PI2$8:d<tt&&nt&&(d+=PI2$8),nt){var at=tt;tt=d,d=at}for(var ht=0;ht<tt;ht+=Math.PI/2)ht>d&&(extremity[0]=mathCos$4(ht)*o+s,extremity[1]=mathSin$4(ht)*c+a,ut(it,extremity,it),ct(st,extremity,st))}var CMD$4={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min=[],max$1=[],min2=[],max2=[],mathMin$8=Math.min,mathMax$8=Math.max,mathCos$3=Math.cos,mathSin$3=Math.sin,mathAbs$2=Math.abs,PI$8=Math.PI,PI2$7=PI$8*2,hasTypedArray=typeof Float32Array<"u",tmpAngles=[];function modPI2(s){var a=Math.round(s/PI$8*1e8)/1e8;return a%2*PI$8}function normalizeArcAngles(s,a){var o=modPI2(s[0]);o<0&&(o+=PI2$7);var c=o-s[0],d=s[1];d+=c,!a&&d-o>=PI2$7?d=o+PI2$7:a&&o-d>=PI2$7?d=o-PI2$7:!a&&o>d?d=o+(PI2$7-modPI2(o-d)):a&&o<d&&(d=o-(PI2$7-modPI2(d-o))),s[0]=o,s[1]=d}var PathProxy=function(){function s(a){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,a&&(this._saveData=!1),this._saveData&&(this.data=[])}return s.prototype.increaseVersion=function(){this._version++},s.prototype.getVersion=function(){return this._version},s.prototype.setScale=function(a,o,c){c=c||0,c>0&&(this._ux=mathAbs$2(c/devicePixelRatio$1/a)||0,this._uy=mathAbs$2(c/devicePixelRatio$1/o)||0)},s.prototype.setDPR=function(a){this.dpr=a},s.prototype.setContext=function(a){this._ctx=a},s.prototype.getContext=function(){return this._ctx},s.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},s.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},s.prototype.moveTo=function(a,o){return this._drawPendingPt(),this.addData(CMD$4.M,a,o),this._ctx&&this._ctx.moveTo(a,o),this._x0=a,this._y0=o,this._xi=a,this._yi=o,this},s.prototype.lineTo=function(a,o){var c=mathAbs$2(a-this._xi),d=mathAbs$2(o-this._yi),tt=c>this._ux||d>this._uy;if(this.addData(CMD$4.L,a,o),this._ctx&&tt&&this._ctx.lineTo(a,o),tt)this._xi=a,this._yi=o,this._pendingPtDist=0;else{var nt=c*c+d*d;nt>this._pendingPtDist&&(this._pendingPtX=a,this._pendingPtY=o,this._pendingPtDist=nt)}return this},s.prototype.bezierCurveTo=function(a,o,c,d,tt,nt){return this._drawPendingPt(),this.addData(CMD$4.C,a,o,c,d,tt,nt),this._ctx&&this._ctx.bezierCurveTo(a,o,c,d,tt,nt),this._xi=tt,this._yi=nt,this},s.prototype.quadraticCurveTo=function(a,o,c,d){return this._drawPendingPt(),this.addData(CMD$4.Q,a,o,c,d),this._ctx&&this._ctx.quadraticCurveTo(a,o,c,d),this._xi=c,this._yi=d,this},s.prototype.arc=function(a,o,c,d,tt,nt){this._drawPendingPt(),tmpAngles[0]=d,tmpAngles[1]=tt,normalizeArcAngles(tmpAngles,nt),d=tmpAngles[0],tt=tmpAngles[1];var it=tt-d;return this.addData(CMD$4.A,a,o,c,c,d,it,0,nt?0:1),this._ctx&&this._ctx.arc(a,o,c,d,tt,nt),this._xi=mathCos$3(tt)*c+a,this._yi=mathSin$3(tt)*c+o,this},s.prototype.arcTo=function(a,o,c,d,tt){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(a,o,c,d,tt),this},s.prototype.rect=function(a,o,c,d){return this._drawPendingPt(),this._ctx&&this._ctx.rect(a,o,c,d),this.addData(CMD$4.R,a,o,c,d),this},s.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD$4.Z);var a=this._ctx,o=this._x0,c=this._y0;return a&&a.closePath(),this._xi=o,this._yi=c,this},s.prototype.fill=function(a){a&&a.fill(),this.toStatic()},s.prototype.stroke=function(a){a&&a.stroke(),this.toStatic()},s.prototype.len=function(){return this._len},s.prototype.setData=function(a){var o=a.length;!(this.data&&this.data.length===o)&&hasTypedArray&&(this.data=new Float32Array(o));for(var c=0;c<o;c++)this.data[c]=a[c];this._len=o},s.prototype.appendPath=function(a){a instanceof Array||(a=[a]);for(var o=a.length,c=0,d=this._len,tt=0;tt<o;tt++)c+=a[tt].len();hasTypedArray&&this.data instanceof Float32Array&&(this.data=new Float32Array(d+c));for(var tt=0;tt<o;tt++)for(var nt=a[tt].data,it=0;it<nt.length;it++)this.data[d++]=nt[it];this._len=d},s.prototype.addData=function(a,o,c,d,tt,nt,it,st,ut){if(this._saveData){var ct=this.data;this._len+arguments.length>ct.length&&(this._expandData(),ct=this.data);for(var ot=0;ot<arguments.length;ot++)ct[this._len++]=arguments[ot]}},s.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},s.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var a=[],o=0;o<this._len;o++)a[o]=this.data[o];this.data=a}},s.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var a=this.data;a instanceof Array&&(a.length=this._len,hasTypedArray&&this._len>11&&(this.data=new Float32Array(a)))}},s.prototype.getBoundingRect=function(){min[0]=min[1]=min2[0]=min2[1]=Number.MAX_VALUE,max$1[0]=max$1[1]=max2[0]=max2[1]=-Number.MAX_VALUE;var a=this.data,o=0,c=0,d=0,tt=0,nt;for(nt=0;nt<this._len;){var it=a[nt++],st=nt===1;switch(st&&(o=a[nt],c=a[nt+1],d=o,tt=c),it){case CMD$4.M:o=d=a[nt++],c=tt=a[nt++],min2[0]=d,min2[1]=tt,max2[0]=d,max2[1]=tt;break;case CMD$4.L:fromLine(o,c,a[nt],a[nt+1],min2,max2),o=a[nt++],c=a[nt++];break;case CMD$4.C:fromCubic(o,c,a[nt++],a[nt++],a[nt++],a[nt++],a[nt],a[nt+1],min2,max2),o=a[nt++],c=a[nt++];break;case CMD$4.Q:fromQuadratic(o,c,a[nt++],a[nt++],a[nt],a[nt+1],min2,max2),o=a[nt++],c=a[nt++];break;case CMD$4.A:var ut=a[nt++],ct=a[nt++],ot=a[nt++],at=a[nt++],ht=a[nt++],ft=a[nt++]+ht;nt+=1;var mt=!a[nt++];st&&(d=mathCos$3(ht)*ot+ut,tt=mathSin$3(ht)*at+ct),fromArc(ut,ct,ot,at,ht,ft,mt,min2,max2),o=mathCos$3(ft)*ot+ut,c=mathSin$3(ft)*at+ct;break;case CMD$4.R:d=o=a[nt++],tt=c=a[nt++];var yt=a[nt++],bt=a[nt++];fromLine(d,tt,d+yt,tt+bt,min2,max2);break;case CMD$4.Z:o=d,c=tt;break}min$1(min,min,min2),max$2(max$1,max$1,max2)}return nt===0&&(min[0]=min[1]=max$1[0]=max$1[1]=0),new BoundingRect(min[0],min[1],max$1[0]-min[0],max$1[1]-min[1])},s.prototype._calculateLength=function(){var a=this.data,o=this._len,c=this._ux,d=this._uy,tt=0,nt=0,it=0,st=0;this._pathSegLen||(this._pathSegLen=[]);for(var ut=this._pathSegLen,ct=0,ot=0,at=0;at<o;){var ht=a[at++],ft=at===1;ft&&(tt=a[at],nt=a[at+1],it=tt,st=nt);var mt=-1;switch(ht){case CMD$4.M:tt=it=a[at++],nt=st=a[at++];break;case CMD$4.L:{var yt=a[at++],bt=a[at++],wt=yt-tt,Tt=bt-nt;(mathAbs$2(wt)>c||mathAbs$2(Tt)>d||at===o-1)&&(mt=Math.sqrt(wt*wt+Tt*Tt),tt=yt,nt=bt);break}case CMD$4.C:{var Ct=a[at++],Dt=a[at++],yt=a[at++],bt=a[at++],Ot=a[at++],$t=a[at++];mt=cubicLength(tt,nt,Ct,Dt,yt,bt,Ot,$t,10),tt=Ot,nt=$t;break}case CMD$4.Q:{var Ct=a[at++],Dt=a[at++],yt=a[at++],bt=a[at++];mt=quadraticLength(tt,nt,Ct,Dt,yt,bt,10),tt=yt,nt=bt;break}case CMD$4.A:var Ft=a[at++],kt=a[at++],Vt=a[at++],Ht=a[at++],Qt=a[at++],Xt=a[at++],Zt=Xt+Qt;at+=1,ft&&(it=mathCos$3(Qt)*Vt+Ft,st=mathSin$3(Qt)*Ht+kt),mt=mathMax$8(Vt,Ht)*mathMin$8(PI2$7,Math.abs(Xt)),tt=mathCos$3(Zt)*Vt+Ft,nt=mathSin$3(Zt)*Ht+kt;break;case CMD$4.R:{it=tt=a[at++],st=nt=a[at++];var ar=a[at++],nr=a[at++];mt=ar*2+nr*2;break}case CMD$4.Z:{var wt=it-tt,Tt=st-nt;mt=Math.sqrt(wt*wt+Tt*Tt),tt=it,nt=st;break}}mt>=0&&(ut[ot++]=mt,ct+=mt)}return this._pathLen=ct,ct},s.prototype.rebuildPath=function(a,o){var c=this.data,d=this._ux,tt=this._uy,nt=this._len,it,st,ut,ct,ot,at,ht=o<1,ft,mt,yt=0,bt=0,wt,Tt=0,Ct,Dt;if(!(ht&&(this._pathSegLen||this._calculateLength(),ft=this._pathSegLen,mt=this._pathLen,wt=o*mt,!wt)))e:for(var Ot=0;Ot<nt;){var $t=c[Ot++],Ft=Ot===1;switch(Ft&&(ut=c[Ot],ct=c[Ot+1],it=ut,st=ct),$t!==CMD$4.L&&Tt>0&&(a.lineTo(Ct,Dt),Tt=0),$t){case CMD$4.M:it=ut=c[Ot++],st=ct=c[Ot++],a.moveTo(ut,ct);break;case CMD$4.L:{ot=c[Ot++],at=c[Ot++];var kt=mathAbs$2(ot-ut),Vt=mathAbs$2(at-ct);if(kt>d||Vt>tt){if(ht){var Ht=ft[bt++];if(yt+Ht>wt){var Qt=(wt-yt)/Ht;a.lineTo(ut*(1-Qt)+ot*Qt,ct*(1-Qt)+at*Qt);break e}yt+=Ht}a.lineTo(ot,at),ut=ot,ct=at,Tt=0}else{var Xt=kt*kt+Vt*Vt;Xt>Tt&&(Ct=ot,Dt=at,Tt=Xt)}break}case CMD$4.C:{var Zt=c[Ot++],ar=c[Ot++],nr=c[Ot++],cr=c[Ot++],dr=c[Ot++],mr=c[Ot++];if(ht){var Ht=ft[bt++];if(yt+Ht>wt){var Qt=(wt-yt)/Ht;cubicSubdivide(ut,Zt,nr,dr,Qt,tmpOutX),cubicSubdivide(ct,ar,cr,mr,Qt,tmpOutY),a.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break e}yt+=Ht}a.bezierCurveTo(Zt,ar,nr,cr,dr,mr),ut=dr,ct=mr;break}case CMD$4.Q:{var Zt=c[Ot++],ar=c[Ot++],nr=c[Ot++],cr=c[Ot++];if(ht){var Ht=ft[bt++];if(yt+Ht>wt){var Qt=(wt-yt)/Ht;quadraticSubdivide(ut,Zt,nr,Qt,tmpOutX),quadraticSubdivide(ct,ar,cr,Qt,tmpOutY),a.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break e}yt+=Ht}a.quadraticCurveTo(Zt,ar,nr,cr),ut=nr,ct=cr;break}case CMD$4.A:var Dr=c[Ot++],kr=c[Ot++],Yr=c[Ot++],Mr=c[Ot++],Jr=c[Ot++],an=c[Ot++],xn=c[Ot++],Rn=!c[Ot++],hn=Yr>Mr?Yr:Mr,pn=mathAbs$2(Yr-Mr)>.001,yn=Jr+an,un=!1;if(ht){var Ht=ft[bt++];yt+Ht>wt&&(yn=Jr+an*(wt-yt)/Ht,un=!0),yt+=Ht}if(pn&&a.ellipse?a.ellipse(Dr,kr,Yr,Mr,xn,Jr,yn,Rn):a.arc(Dr,kr,hn,Jr,yn,Rn),un)break e;Ft&&(it=mathCos$3(Jr)*Yr+Dr,st=mathSin$3(Jr)*Mr+kr),ut=mathCos$3(yn)*Yr+Dr,ct=mathSin$3(yn)*Mr+kr;break;case CMD$4.R:it=ut=c[Ot],st=ct=c[Ot+1],ot=c[Ot++],at=c[Ot++];var fn=c[Ot++],Bn=c[Ot++];if(ht){var Ht=ft[bt++];if(yt+Ht>wt){var Dn=wt-yt;a.moveTo(ot,at),a.lineTo(ot+mathMin$8(Dn,fn),at),Dn-=fn,Dn>0&&a.lineTo(ot+fn,at+mathMin$8(Dn,Bn)),Dn-=Bn,Dn>0&&a.lineTo(ot+mathMax$8(fn-Dn,0),at+Bn),Dn-=fn,Dn>0&&a.lineTo(ot,at+mathMax$8(Bn-Dn,0));break e}yt+=Ht}a.rect(ot,at,fn,Bn);break;case CMD$4.Z:if(ht){var Ht=ft[bt++];if(yt+Ht>wt){var Qt=(wt-yt)/Ht;a.lineTo(ut*(1-Qt)+it*Qt,ct*(1-Qt)+st*Qt);break e}yt+=Ht}a.closePath(),ut=it,ct=st}}},s.prototype.clone=function(){var a=new s,o=this.data;return a.data=o.slice?o.slice():Array.prototype.slice.call(o),a._len=this._len,a},s.CMD=CMD$4,s.initDefaultProps=function(){var a=s.prototype;a._saveData=!0,a._ux=0,a._uy=0,a._pendingPtDist=0,a._version=0}(),s}();function containStroke$4(s,a,o,c,d,tt,nt){if(d===0)return!1;var it=d,st=0,ut=s;if(nt>a+it&&nt>c+it||nt<a-it&&nt<c-it||tt>s+it&&tt>o+it||tt<s-it&&tt<o-it)return!1;if(s!==o)st=(a-c)/(s-o),ut=(s*c-o*a)/(s-o);else return Math.abs(tt-s)<=it/2;var ct=st*tt-nt+ut,ot=ct*ct/(st*st+1);return ot<=it/2*it/2}function containStroke$3(s,a,o,c,d,tt,nt,it,st,ut,ct){if(st===0)return!1;var ot=st;if(ct>a+ot&&ct>c+ot&&ct>tt+ot&&ct>it+ot||ct<a-ot&&ct<c-ot&&ct<tt-ot&&ct<it-ot||ut>s+ot&&ut>o+ot&&ut>d+ot&&ut>nt+ot||ut<s-ot&&ut<o-ot&&ut<d-ot&&ut<nt-ot)return!1;var at=cubicProjectPoint(s,a,o,c,d,tt,nt,it,ut,ct,null);return at<=ot/2}function containStroke$2(s,a,o,c,d,tt,nt,it,st){if(nt===0)return!1;var ut=nt;if(st>a+ut&&st>c+ut&&st>tt+ut||st<a-ut&&st<c-ut&&st<tt-ut||it>s+ut&&it>o+ut&&it>d+ut||it<s-ut&&it<o-ut&&it<d-ut)return!1;var ct=quadraticProjectPoint(s,a,o,c,d,tt,it,st,null);return ct<=ut/2}var PI2$6=Math.PI*2;function normalizeRadian(s){return s%=PI2$6,s<0&&(s+=PI2$6),s}var PI2$5=Math.PI*2;function containStroke$1(s,a,o,c,d,tt,nt,it,st){if(nt===0)return!1;var ut=nt;it-=s,st-=a;var ct=Math.sqrt(it*it+st*st);if(ct-ut>o||ct+ut<o)return!1;if(Math.abs(c-d)%PI2$5<1e-4)return!0;if(tt){var ot=c;c=normalizeRadian(d),d=normalizeRadian(ot)}else c=normalizeRadian(c),d=normalizeRadian(d);c>d&&(d+=PI2$5);var at=Math.atan2(st,it);return at<0&&(at+=PI2$5),at>=c&&at<=d||at+PI2$5>=c&&at+PI2$5<=d}function windingLine(s,a,o,c,d,tt){if(tt>a&&tt>c||tt<a&&tt<c||c===a)return 0;var nt=(tt-a)/(c-a),it=c<a?1:-1;(nt===1||nt===0)&&(it=c<a?.5:-.5);var st=nt*(o-s)+s;return st===d?1/0:st>d?it:0}var CMD$3=PathProxy.CMD,PI2$4=Math.PI*2,EPSILON$1=1e-4;function isAroundEqual$1(s,a){return Math.abs(s-a)<EPSILON$1}var roots=[-1,-1,-1],extrema=[-1,-1];function swapExtrema(){var s=extrema[0];extrema[0]=extrema[1],extrema[1]=s}function windingCubic(s,a,o,c,d,tt,nt,it,st,ut){if(ut>a&&ut>c&&ut>tt&&ut>it||ut<a&&ut<c&&ut<tt&&ut<it)return 0;var ct=cubicRootAt(a,c,tt,it,ut,roots);if(ct===0)return 0;for(var ot=0,at=-1,ht=void 0,ft=void 0,mt=0;mt<ct;mt++){var yt=roots[mt],bt=yt===0||yt===1?.5:1,wt=cubicAt(s,o,d,nt,yt);wt<st||(at<0&&(at=cubicExtrema(a,c,tt,it,extrema),extrema[1]<extrema[0]&&at>1&&swapExtrema(),ht=cubicAt(a,c,tt,it,extrema[0]),at>1&&(ft=cubicAt(a,c,tt,it,extrema[1]))),at===2?yt<extrema[0]?ot+=ht<a?bt:-bt:yt<extrema[1]?ot+=ft<ht?bt:-bt:ot+=it<ft?bt:-bt:yt<extrema[0]?ot+=ht<a?bt:-bt:ot+=it<ht?bt:-bt)}return ot}function windingQuadratic(s,a,o,c,d,tt,nt,it){if(it>a&&it>c&&it>tt||it<a&&it<c&&it<tt)return 0;var st=quadraticRootAt(a,c,tt,it,roots);if(st===0)return 0;var ut=quadraticExtremum(a,c,tt);if(ut>=0&&ut<=1){for(var ct=0,ot=quadraticAt$1(a,c,tt,ut),at=0;at<st;at++){var ht=roots[at]===0||roots[at]===1?.5:1,ft=quadraticAt$1(s,o,d,roots[at]);ft<nt||(roots[at]<ut?ct+=ot<a?ht:-ht:ct+=tt<ot?ht:-ht)}return ct}else{var ht=roots[0]===0||roots[0]===1?.5:1,ft=quadraticAt$1(s,o,d,roots[0]);return ft<nt?0:tt<a?ht:-ht}}function windingArc(s,a,o,c,d,tt,nt,it){if(it-=a,it>o||it<-o)return 0;var st=Math.sqrt(o*o-it*it);roots[0]=-st,roots[1]=st;var ut=Math.abs(c-d);if(ut<1e-4)return 0;if(ut>=PI2$4-1e-4){c=0,d=PI2$4;var ct=tt?1:-1;return nt>=roots[0]+s&&nt<=roots[1]+s?ct:0}if(c>d){var ot=c;c=d,d=ot}c<0&&(c+=PI2$4,d+=PI2$4);for(var at=0,ht=0;ht<2;ht++){var ft=roots[ht];if(ft+s>nt){var mt=Math.atan2(it,ft),ct=tt?1:-1;mt<0&&(mt=PI2$4+mt),(mt>=c&&mt<=d||mt+PI2$4>=c&&mt+PI2$4<=d)&&(mt>Math.PI/2&&mt<Math.PI*1.5&&(ct=-ct),at+=ct)}}return at}function containPath(s,a,o,c,d){for(var tt=s.data,nt=s.len(),it=0,st=0,ut=0,ct=0,ot=0,at,ht,ft=0;ft<nt;){var mt=tt[ft++],yt=ft===1;switch(mt===CMD$3.M&&ft>1&&(o||(it+=windingLine(st,ut,ct,ot,c,d))),yt&&(st=tt[ft],ut=tt[ft+1],ct=st,ot=ut),mt){case CMD$3.M:ct=tt[ft++],ot=tt[ft++],st=ct,ut=ot;break;case CMD$3.L:if(o){if(containStroke$4(st,ut,tt[ft],tt[ft+1],a,c,d))return!0}else it+=windingLine(st,ut,tt[ft],tt[ft+1],c,d)||0;st=tt[ft++],ut=tt[ft++];break;case CMD$3.C:if(o){if(containStroke$3(st,ut,tt[ft++],tt[ft++],tt[ft++],tt[ft++],tt[ft],tt[ft+1],a,c,d))return!0}else it+=windingCubic(st,ut,tt[ft++],tt[ft++],tt[ft++],tt[ft++],tt[ft],tt[ft+1],c,d)||0;st=tt[ft++],ut=tt[ft++];break;case CMD$3.Q:if(o){if(containStroke$2(st,ut,tt[ft++],tt[ft++],tt[ft],tt[ft+1],a,c,d))return!0}else it+=windingQuadratic(st,ut,tt[ft++],tt[ft++],tt[ft],tt[ft+1],c,d)||0;st=tt[ft++],ut=tt[ft++];break;case CMD$3.A:var bt=tt[ft++],wt=tt[ft++],Tt=tt[ft++],Ct=tt[ft++],Dt=tt[ft++],Ot=tt[ft++];ft+=1;var $t=!!(1-tt[ft++]);at=Math.cos(Dt)*Tt+bt,ht=Math.sin(Dt)*Ct+wt,yt?(ct=at,ot=ht):it+=windingLine(st,ut,at,ht,c,d);var Ft=(c-bt)*Ct/Tt+bt;if(o){if(containStroke$1(bt,wt,Ct,Dt,Dt+Ot,$t,a,Ft,d))return!0}else it+=windingArc(bt,wt,Ct,Dt,Dt+Ot,$t,Ft,d);st=Math.cos(Dt+Ot)*Tt+bt,ut=Math.sin(Dt+Ot)*Ct+wt;break;case CMD$3.R:ct=st=tt[ft++],ot=ut=tt[ft++];var kt=tt[ft++],Vt=tt[ft++];if(at=ct+kt,ht=ot+Vt,o){if(containStroke$4(ct,ot,at,ot,a,c,d)||containStroke$4(at,ot,at,ht,a,c,d)||containStroke$4(at,ht,ct,ht,a,c,d)||containStroke$4(ct,ht,ct,ot,a,c,d))return!0}else it+=windingLine(at,ot,at,ht,c,d),it+=windingLine(ct,ht,ct,ot,c,d);break;case CMD$3.Z:if(o){if(containStroke$4(st,ut,ct,ot,a,c,d))return!0}else it+=windingLine(st,ut,ct,ot,c,d);st=ct,ut=ot;break}}return!o&&!isAroundEqual$1(ut,ot)&&(it+=windingLine(st,ut,ct,ot,c,d)||0),it!==0}function contain$2(s,a,o){return containPath(s,0,!1,a,o)}function containStroke(s,a,o,c){return containPath(s,a,!0,o,c)}var DEFAULT_PATH_STYLE=defaults({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat(["invisible","culling","z","z2","zlevel","parent"]),Path=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.update=function(){var o=this;s.prototype.update.call(this);var c=this.style;if(c.decal){var d=this._decalEl=this._decalEl||new a;d.buildPath===a.prototype.buildPath&&(d.buildPath=function(st){o.buildPath(st,o.shape)}),d.silent=!0;var tt=d.style;for(var nt in c)tt[nt]!==c[nt]&&(tt[nt]=c[nt]);tt.fill=c.fill?c.decal:null,tt.decal=null,tt.shadowColor=null,c.strokeFirst&&(tt.stroke=null);for(var it=0;it<pathCopyParams.length;++it)d[pathCopyParams[it]]=this[pathCopyParams[it]];d.__dirty|=REDRAW_BIT}else this._decalEl&&(this._decalEl=null)},a.prototype.getDecalElement=function(){return this._decalEl},a.prototype._init=function(o){var c=keys(o);this.shape=this.getDefaultShape();var d=this.getDefaultStyle();d&&this.useStyle(d);for(var tt=0;tt<c.length;tt++){var nt=c[tt],it=o[nt];nt==="style"?this.style?extend(this.style,it):this.useStyle(it):nt==="shape"?extend(this.shape,it):s.prototype.attrKV.call(this,nt,it)}this.style||this.useStyle({})},a.prototype.getDefaultStyle=function(){return null},a.prototype.getDefaultShape=function(){return{}},a.prototype.canBeInsideText=function(){return this.hasFill()},a.prototype.getInsideTextFill=function(){var o=this.style.fill;if(o!=="none"){if(isString$1(o)){var c=lum(o,0);return c>.5?DARK_LABEL_COLOR:c>.2?LIGHTER_LABEL_COLOR:LIGHT_LABEL_COLOR}else if(o)return LIGHT_LABEL_COLOR}return DARK_LABEL_COLOR},a.prototype.getInsideTextStroke=function(o){var c=this.style.fill;if(isString$1(c)){var d=this.__zr,tt=!!(d&&d.isDarkMode()),nt=lum(o,0)<DARK_MODE_THRESHOLD;if(tt===nt)return c}},a.prototype.buildPath=function(o,c,d){},a.prototype.pathUpdated=function(){this.__dirty&=~SHAPE_CHANGED_BIT},a.prototype.getUpdatedPathProxy=function(o){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,o),this.path},a.prototype.createPathProxy=function(){this.path=new PathProxy(!1)},a.prototype.hasStroke=function(){var o=this.style,c=o.stroke;return!(c==null||c==="none"||!(o.lineWidth>0))},a.prototype.hasFill=function(){var o=this.style,c=o.fill;return c!=null&&c!=="none"},a.prototype.getBoundingRect=function(){var o=this._rect,c=this.style,d=!o;if(d){var tt=!1;this.path||(tt=!0,this.createPathProxy());var nt=this.path;(tt||this.__dirty&SHAPE_CHANGED_BIT)&&(nt.beginPath(),this.buildPath(nt,this.shape,!1),this.pathUpdated()),o=nt.getBoundingRect()}if(this._rect=o,this.hasStroke()&&this.path&&this.path.len()>0){var it=this._rectStroke||(this._rectStroke=o.clone());if(this.__dirty||d){it.copy(o);var st=c.strokeNoScale?this.getLineScale():1,ut=c.lineWidth;if(!this.hasFill()){var ct=this.strokeContainThreshold;ut=Math.max(ut,ct??4)}st>1e-10&&(it.width+=ut/st,it.height+=ut/st,it.x-=ut/st/2,it.y-=ut/st/2)}return it}return o},a.prototype.contain=function(o,c){var d=this.transformCoordToLocal(o,c),tt=this.getBoundingRect(),nt=this.style;if(o=d[0],c=d[1],tt.contain(o,c)){var it=this.path;if(this.hasStroke()){var st=nt.lineWidth,ut=nt.strokeNoScale?this.getLineScale():1;if(ut>1e-10&&(this.hasFill()||(st=Math.max(st,this.strokeContainThreshold)),containStroke(it,st/ut,o,c)))return!0}if(this.hasFill())return contain$2(it,o,c)}return!1},a.prototype.dirtyShape=function(){this.__dirty|=SHAPE_CHANGED_BIT,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},a.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},a.prototype.animateShape=function(o){return this.animate("shape",o)},a.prototype.updateDuringAnimation=function(o){o==="style"?this.dirtyStyle():o==="shape"?this.dirtyShape():this.markRedraw()},a.prototype.attrKV=function(o,c){o==="shape"?this.setShape(c):s.prototype.attrKV.call(this,o,c)},a.prototype.setShape=function(o,c){var d=this.shape;return d||(d=this.shape={}),typeof o=="string"?d[o]=c:extend(d,o),this.dirtyShape(),this},a.prototype.shapeChanged=function(){return!!(this.__dirty&SHAPE_CHANGED_BIT)},a.prototype.createStyle=function(o){return createObject(DEFAULT_PATH_STYLE,o)},a.prototype._innerSaveToNormal=function(o){s.prototype._innerSaveToNormal.call(this,o);var c=this._normalState;o.shape&&!c.shape&&(c.shape=extend({},this.shape))},a.prototype._applyStateObj=function(o,c,d,tt,nt,it){s.prototype._applyStateObj.call(this,o,c,d,tt,nt,it);var st=!(c&&tt),ut;if(c&&c.shape?nt?tt?ut=c.shape:(ut=extend({},d.shape),extend(ut,c.shape)):(ut=extend({},tt?this.shape:d.shape),extend(ut,c.shape)):st&&(ut=d.shape),ut)if(nt){this.shape=extend({},this.shape);for(var ct={},ot=keys(ut),at=0;at<ot.length;at++){var ht=ot[at];typeof ut[ht]=="object"?this.shape[ht]=ut[ht]:ct[ht]=ut[ht]}this._transitionState(o,{shape:ct},it)}else this.shape=ut,this.dirtyShape()},a.prototype._mergeStates=function(o){for(var c=s.prototype._mergeStates.call(this,o),d,tt=0;tt<o.length;tt++){var nt=o[tt];nt.shape&&(d=d||{},this._mergeStyle(d,nt.shape))}return d&&(c.shape=d),c},a.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},a.prototype.isZeroArea=function(){return!1},a.extend=function(o){var c=function(tt){__extends(nt,tt);function nt(it){var st=tt.call(this,it)||this;return o.init&&o.init.call(st,it),st}return nt.prototype.getDefaultStyle=function(){return clone$4(o.style)},nt.prototype.getDefaultShape=function(){return clone$4(o.shape)},nt}(a);for(var d in o)typeof o[d]=="function"&&(c.prototype[d]=o[d]);return c},a.initDefaultProps=function(){var o=a.prototype;o.type="path",o.strokeContainThreshold=5,o.segmentIgnoreThreshold=0,o.subPixelOptimize=!1,o.autoBatch=!1,o.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT|SHAPE_CHANGED_BIT}(),a}(Displayable),DEFAULT_TSPAN_STYLE=defaults({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(s){__extends(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.hasStroke=function(){var o=this.style,c=o.stroke;return c!=null&&c!=="none"&&o.lineWidth>0},a.prototype.hasFill=function(){var o=this.style,c=o.fill;return c!=null&&c!=="none"},a.prototype.createStyle=function(o){return createObject(DEFAULT_TSPAN_STYLE,o)},a.prototype.setBoundingRect=function(o){this._rect=o},a.prototype.getBoundingRect=function(){var o=this.style;if(!this._rect){var c=o.text;c!=null?c+="":c="";var d=getBoundingRect(c,o.font,o.textAlign,o.textBaseline);if(d.x+=o.x||0,d.y+=o.y||0,this.hasStroke()){var tt=o.lineWidth;d.x-=tt/2,d.y-=tt/2,d.width+=tt,d.height+=tt}this._rect=d}return this._rect},a.initDefaultProps=function(){var o=a.prototype;o.dirtyRectTolerance=10}(),a}(Displayable);TSpan.prototype.type="tspan";var DEFAULT_IMAGE_STYLE=defaults({x:0,y:0},DEFAULT_COMMON_STYLE),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};function isImageLike$1(s){return!!(s&&typeof s!="string"&&s.width&&s.height)}var ZRImage=function(s){__extends(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.createStyle=function(o){return createObject(DEFAULT_IMAGE_STYLE,o)},a.prototype._getSize=function(o){var c=this.style,d=c[o];if(d!=null)return d;var tt=isImageLike$1(c.image)?c.image:this.__image;if(!tt)return 0;var nt=o==="width"?"height":"width",it=c[nt];return it==null?tt[o]:tt[o]/tt[nt]*it},a.prototype.getWidth=function(){return this._getSize("width")},a.prototype.getHeight=function(){return this._getSize("height")},a.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},a.prototype.getBoundingRect=function(){var o=this.style;return this._rect||(this._rect=new BoundingRect(o.x||0,o.y||0,this.getWidth(),this.getHeight())),this._rect},a}(Displayable);ZRImage.prototype.type="image";function buildPath$2(s,a){var o=a.x,c=a.y,d=a.width,tt=a.height,nt=a.r,it,st,ut,ct;d<0&&(o=o+d,d=-d),tt<0&&(c=c+tt,tt=-tt),typeof nt=="number"?it=st=ut=ct=nt:nt instanceof Array?nt.length===1?it=st=ut=ct=nt[0]:nt.length===2?(it=ut=nt[0],st=ct=nt[1]):nt.length===3?(it=nt[0],st=ct=nt[1],ut=nt[2]):(it=nt[0],st=nt[1],ut=nt[2],ct=nt[3]):it=st=ut=ct=0;var ot;it+st>d&&(ot=it+st,it*=d/ot,st*=d/ot),ut+ct>d&&(ot=ut+ct,ut*=d/ot,ct*=d/ot),st+ut>tt&&(ot=st+ut,st*=tt/ot,ut*=tt/ot),it+ct>tt&&(ot=it+ct,it*=tt/ot,ct*=tt/ot),s.moveTo(o+it,c),s.lineTo(o+d-st,c),st!==0&&s.arc(o+d-st,c+st,st,-Math.PI/2,0),s.lineTo(o+d,c+tt-ut),ut!==0&&s.arc(o+d-ut,c+tt-ut,ut,0,Math.PI/2),s.lineTo(o+ct,c+tt),ct!==0&&s.arc(o+ct,c+tt-ct,ct,Math.PI/2,Math.PI),s.lineTo(o,c+it),it!==0&&s.arc(o+it,c+it,it,Math.PI,Math.PI*1.5)}var round$2=Math.round;function subPixelOptimizeLine$1(s,a,o){if(a){var c=a.x1,d=a.x2,tt=a.y1,nt=a.y2;s.x1=c,s.x2=d,s.y1=tt,s.y2=nt;var it=o&&o.lineWidth;return it&&(round$2(c*2)===round$2(d*2)&&(s.x1=s.x2=subPixelOptimize$1(c,it,!0)),round$2(tt*2)===round$2(nt*2)&&(s.y1=s.y2=subPixelOptimize$1(tt,it,!0))),s}}function subPixelOptimizeRect$1(s,a,o){if(a){var c=a.x,d=a.y,tt=a.width,nt=a.height;s.x=c,s.y=d,s.width=tt,s.height=nt;var it=o&&o.lineWidth;return it&&(s.x=subPixelOptimize$1(c,it,!0),s.y=subPixelOptimize$1(d,it,!0),s.width=Math.max(subPixelOptimize$1(c+tt,it,!1)-s.x,tt===0?0:1),s.height=Math.max(subPixelOptimize$1(d+nt,it,!1)-s.y,nt===0?0:1)),s}}function subPixelOptimize$1(s,a,o){if(!a)return s;var c=round$2(s*2);return(c+round$2(a))%2===0?c/2:(c+(o?1:-1))/2}var RectShape=function(){function s(){this.x=0,this.y=0,this.width=0,this.height=0}return s}(),subPixelOptimizeOutputShape$1={},Rect$2=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new RectShape},a.prototype.buildPath=function(o,c){var d,tt,nt,it;if(this.subPixelOptimize){var st=subPixelOptimizeRect$1(subPixelOptimizeOutputShape$1,c,this.style);d=st.x,tt=st.y,nt=st.width,it=st.height,st.r=c.r,c=st}else d=c.x,tt=c.y,nt=c.width,it=c.height;c.r?buildPath$2(o,c):o.rect(d,tt,nt,it)},a.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},a}(Path);Rect$2.prototype.type="rect";var DEFAULT_RICH_TEXT_COLOR={fill:"#000"},DEFAULT_STROKE_LINE_WIDTH=2,DEFAULT_TEXT_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(s){__extends(a,s);function a(o){var c=s.call(this)||this;return c.type="text",c._children=[],c._defaultStyle=DEFAULT_RICH_TEXT_COLOR,c.attr(o),c}return a.prototype.childrenRef=function(){return this._children},a.prototype.update=function(){s.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var o=0;o<this._children.length;o++){var c=this._children[o];c.zlevel=this.zlevel,c.z=this.z,c.z2=this.z2,c.culling=this.culling,c.cursor=this.cursor,c.invisible=this.invisible}},a.prototype.updateTransform=function(){var o=this.innerTransformable;o?(o.updateTransform(),o.transform&&(this.transform=o.transform)):s.prototype.updateTransform.call(this)},a.prototype.getLocalTransform=function(o){var c=this.innerTransformable;return c?c.getLocalTransform(o):s.prototype.getLocalTransform.call(this,o)},a.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),s.prototype.getComputedTransform.call(this)},a.prototype._updateSubTexts=function(){this._childCursor=0,normalizeTextStyle(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},a.prototype.addSelfToZr=function(o){s.prototype.addSelfToZr.call(this,o);for(var c=0;c<this._children.length;c++)this._children[c].__zr=o},a.prototype.removeSelfFromZr=function(o){s.prototype.removeSelfFromZr.call(this,o);for(var c=0;c<this._children.length;c++)this._children[c].__zr=null},a.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var o=new BoundingRect(0,0,0,0),c=this._children,d=[],tt=null,nt=0;nt<c.length;nt++){var it=c[nt],st=it.getBoundingRect(),ut=it.getLocalTransform(d);ut?(o.copy(st),o.applyTransform(ut),tt=tt||o.clone(),tt.union(o)):(tt=tt||st.clone(),tt.union(st))}this._rect=tt||o}return this._rect},a.prototype.setDefaultTextStyle=function(o){this._defaultStyle=o||DEFAULT_RICH_TEXT_COLOR},a.prototype.setTextContent=function(o){},a.prototype._mergeStyle=function(o,c){if(!c)return o;var d=c.rich,tt=o.rich||d&&{};return extend(o,c),d&&tt?(this._mergeRich(tt,d),o.rich=tt):tt&&(o.rich=tt),o},a.prototype._mergeRich=function(o,c){for(var d=keys(c),tt=0;tt<d.length;tt++){var nt=d[tt];o[nt]=o[nt]||{},extend(o[nt],c[nt])}},a.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},a.prototype._getOrCreateChild=function(o){var c=this._children[this._childCursor];return(!c||!(c instanceof o))&&(c=new o),this._children[this._childCursor++]=c,c.__zr=this.__zr,c.parent=this,c},a.prototype._updatePlainTexts=function(){var o=this.style,c=o.font||DEFAULT_FONT,d=o.padding,tt=getStyleText(o),nt=parsePlainText(tt,o),it=needDrawBackground(o),st=!!o.backgroundColor,ut=nt.outerHeight,ct=nt.outerWidth,ot=nt.contentWidth,at=nt.lines,ht=nt.lineHeight,ft=this._defaultStyle;this.isTruncated=!!nt.isTruncated;var mt=o.x||0,yt=o.y||0,bt=o.align||ft.align||"left",wt=o.verticalAlign||ft.verticalAlign||"top",Tt=mt,Ct=adjustTextY(yt,nt.contentHeight,wt);if(it||d){var Dt=adjustTextX(mt,ct,bt),Ot=adjustTextY(yt,ut,wt);it&&this._renderBackground(o,o,Dt,Ot,ct,ut)}Ct+=ht/2,d&&(Tt=getTextXForPadding(mt,bt,d),wt==="top"?Ct+=d[0]:wt==="bottom"&&(Ct-=d[2]));for(var $t=0,Ft=!1,kt=getFill("fill"in o?o.fill:(Ft=!0,ft.fill)),Vt=getStroke("stroke"in o?o.stroke:!st&&(!ft.autoStroke||Ft)?($t=DEFAULT_STROKE_LINE_WIDTH,ft.stroke):null),Ht=o.textShadowBlur>0,Qt=o.width!=null&&(o.overflow==="truncate"||o.overflow==="break"||o.overflow==="breakAll"),Xt=nt.calculatedLineHeight,Zt=0;Zt<at.length;Zt++){var ar=this._getOrCreateChild(TSpan),nr=ar.createStyle();ar.useStyle(nr),nr.text=at[Zt],nr.x=Tt,nr.y=Ct,nr.textAlign=bt,nr.textBaseline="middle",nr.opacity=o.opacity,nr.strokeFirst=!0,Ht&&(nr.shadowBlur=o.textShadowBlur||0,nr.shadowColor=o.textShadowColor||"transparent",nr.shadowOffsetX=o.textShadowOffsetX||0,nr.shadowOffsetY=o.textShadowOffsetY||0),nr.stroke=Vt,nr.fill=kt,Vt&&(nr.lineWidth=o.lineWidth||$t,nr.lineDash=o.lineDash,nr.lineDashOffset=o.lineDashOffset||0),nr.font=c,setSeparateFont(nr,o),Ct+=ht,Qt&&ar.setBoundingRect(new BoundingRect(adjustTextX(nr.x,ot,nr.textAlign),adjustTextY(nr.y,Xt,nr.textBaseline),ot,Xt))}},a.prototype._updateRichTexts=function(){var o=this.style,c=getStyleText(o),d=parseRichText(c,o),tt=d.width,nt=d.outerWidth,it=d.outerHeight,st=o.padding,ut=o.x||0,ct=o.y||0,ot=this._defaultStyle,at=o.align||ot.align,ht=o.verticalAlign||ot.verticalAlign;this.isTruncated=!!d.isTruncated;var ft=adjustTextX(ut,nt,at),mt=adjustTextY(ct,it,ht),yt=ft,bt=mt;st&&(yt+=st[3],bt+=st[0]);var wt=yt+tt;needDrawBackground(o)&&this._renderBackground(o,o,ft,mt,nt,it);for(var Tt=!!o.backgroundColor,Ct=0;Ct<d.lines.length;Ct++){for(var Dt=d.lines[Ct],Ot=Dt.tokens,$t=Ot.length,Ft=Dt.lineHeight,kt=Dt.width,Vt=0,Ht=yt,Qt=wt,Xt=$t-1,Zt=void 0;Vt<$t&&(Zt=Ot[Vt],!Zt.align||Zt.align==="left");)this._placeToken(Zt,o,Ft,bt,Ht,"left",Tt),kt-=Zt.width,Ht+=Zt.width,Vt++;for(;Xt>=0&&(Zt=Ot[Xt],Zt.align==="right");)this._placeToken(Zt,o,Ft,bt,Qt,"right",Tt),kt-=Zt.width,Qt-=Zt.width,Xt--;for(Ht+=(tt-(Ht-yt)-(wt-Qt)-kt)/2;Vt<=Xt;)Zt=Ot[Vt],this._placeToken(Zt,o,Ft,bt,Ht+Zt.width/2,"center",Tt),Ht+=Zt.width,Vt++;bt+=Ft}},a.prototype._placeToken=function(o,c,d,tt,nt,it,st){var ut=c.rich[o.styleName]||{};ut.text=o.text;var ct=o.verticalAlign,ot=tt+d/2;ct==="top"?ot=tt+o.height/2:ct==="bottom"&&(ot=tt+d-o.height/2);var at=!o.isLineHolder&&needDrawBackground(ut);at&&this._renderBackground(ut,c,it==="right"?nt-o.width:it==="center"?nt-o.width/2:nt,ot-o.height/2,o.width,o.height);var ht=!!ut.backgroundColor,ft=o.textPadding;ft&&(nt=getTextXForPadding(nt,it,ft),ot-=o.height/2-ft[0]-o.innerHeight/2);var mt=this._getOrCreateChild(TSpan),yt=mt.createStyle();mt.useStyle(yt);var bt=this._defaultStyle,wt=!1,Tt=0,Ct=getFill("fill"in ut?ut.fill:"fill"in c?c.fill:(wt=!0,bt.fill)),Dt=getStroke("stroke"in ut?ut.stroke:"stroke"in c?c.stroke:!ht&&!st&&(!bt.autoStroke||wt)?(Tt=DEFAULT_STROKE_LINE_WIDTH,bt.stroke):null),Ot=ut.textShadowBlur>0||c.textShadowBlur>0;yt.text=o.text,yt.x=nt,yt.y=ot,Ot&&(yt.shadowBlur=ut.textShadowBlur||c.textShadowBlur||0,yt.shadowColor=ut.textShadowColor||c.textShadowColor||"transparent",yt.shadowOffsetX=ut.textShadowOffsetX||c.textShadowOffsetX||0,yt.shadowOffsetY=ut.textShadowOffsetY||c.textShadowOffsetY||0),yt.textAlign=it,yt.textBaseline="middle",yt.font=o.font||DEFAULT_FONT,yt.opacity=retrieve3(ut.opacity,c.opacity,1),setSeparateFont(yt,ut),Dt&&(yt.lineWidth=retrieve3(ut.lineWidth,c.lineWidth,Tt),yt.lineDash=retrieve2(ut.lineDash,c.lineDash),yt.lineDashOffset=c.lineDashOffset||0,yt.stroke=Dt),Ct&&(yt.fill=Ct);var $t=o.contentWidth,Ft=o.contentHeight;mt.setBoundingRect(new BoundingRect(adjustTextX(yt.x,$t,yt.textAlign),adjustTextY(yt.y,Ft,yt.textBaseline),$t,Ft))},a.prototype._renderBackground=function(o,c,d,tt,nt,it){var st=o.backgroundColor,ut=o.borderWidth,ct=o.borderColor,ot=st&&st.image,at=st&&!ot,ht=o.borderRadius,ft=this,mt,yt;if(at||o.lineHeight||ut&&ct){mt=this._getOrCreateChild(Rect$2),mt.useStyle(mt.createStyle()),mt.style.fill=null;var bt=mt.shape;bt.x=d,bt.y=tt,bt.width=nt,bt.height=it,bt.r=ht,mt.dirtyShape()}if(at){var wt=mt.style;wt.fill=st||null,wt.fillOpacity=retrieve2(o.fillOpacity,1)}else if(ot){yt=this._getOrCreateChild(ZRImage),yt.onload=function(){ft.dirtyStyle()};var Tt=yt.style;Tt.image=st.image,Tt.x=d,Tt.y=tt,Tt.width=nt,Tt.height=it}if(ut&&ct){var wt=mt.style;wt.lineWidth=ut,wt.stroke=ct,wt.strokeOpacity=retrieve2(o.strokeOpacity,1),wt.lineDash=o.borderDash,wt.lineDashOffset=o.borderDashOffset||0,mt.strokeContainThreshold=0,mt.hasFill()&&mt.hasStroke()&&(wt.strokeFirst=!0,wt.lineWidth*=2)}var Ct=(mt||yt).style;Ct.shadowBlur=o.shadowBlur||0,Ct.shadowColor=o.shadowColor||"transparent",Ct.shadowOffsetX=o.shadowOffsetX||0,Ct.shadowOffsetY=o.shadowOffsetY||0,Ct.opacity=retrieve3(o.opacity,c.opacity,1)},a.makeFont=function(o){var c="";return hasSeparateFont(o)&&(c=[o.fontStyle,o.fontWeight,parseFontSize(o.fontSize),o.fontFamily||"sans-serif"].join(" ")),c&&trim$1(c)||o.textFont||o.font},a}(Displayable),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=["fontStyle","fontWeight","fontSize","fontFamily"];function parseFontSize(s){return typeof s=="string"&&(s.indexOf("px")!==-1||s.indexOf("rem")!==-1||s.indexOf("em")!==-1)?s:isNaN(+s)?DEFAULT_FONT_SIZE+"px":s+"px"}function setSeparateFont(s,a){for(var o=0;o<FONT_PARTS.length;o++){var c=FONT_PARTS[o],d=a[c];d!=null&&(s[c]=d)}}function hasSeparateFont(s){return s.fontSize!=null||s.fontFamily||s.fontWeight}function normalizeTextStyle(s){return normalizeStyle(s),each$f(s.rich,normalizeStyle),s}function normalizeStyle(s){if(s){s.font=ZRText.makeFont(s);var a=s.align;a==="middle"&&(a="center"),s.align=a==null||VALID_TEXT_ALIGN[a]?a:"left";var o=s.verticalAlign;o==="center"&&(o="middle"),s.verticalAlign=o==null||VALID_TEXT_VERTICAL_ALIGN[o]?o:"top";var c=s.padding;c&&(s.padding=normalizeCssArray$1(s.padding))}}function getStroke(s,a){return s==null||a<=0||s==="transparent"||s==="none"?null:s.image||s.colorStops?"#000":s}function getFill(s){return s==null||s==="none"?null:s.image||s.colorStops?"#000":s}function getTextXForPadding(s,a,o){return a==="right"?s-o[1]:a==="center"?s+o[3]/2-o[1]/2:s+o[3]}function getStyleText(s){var a=s.text;return a!=null&&(a+=""),a}function needDrawBackground(s){return!!(s.backgroundColor||s.lineHeight||s.borderWidth&&s.borderColor)}var getECData=makeInner(),setCommonECData=function(s,a,o,c){if(c){var d=getECData(c);d.dataIndex=o,d.dataType=a,d.seriesIndex=s,d.ssrType="chart",c.type==="group"&&c.traverse(function(tt){var nt=getECData(tt);nt.seriesIndex=s,nt.dataIndex=o,nt.dataType=a,nt.ssrType="chart"})}},_highlightNextDigit=1,_highlightKeyMap={},getSavedStates=makeInner(),getComponentStates=makeInner(),HOVER_STATE_NORMAL=0,HOVER_STATE_BLUR=1,HOVER_STATE_EMPHASIS=2,SPECIAL_STATES=["emphasis","blur","select"],DISPLAY_STATES=["normal","emphasis","blur","select"],Z2_EMPHASIS_LIFT=10,Z2_SELECT_LIFT=9,HIGHLIGHT_ACTION_TYPE="highlight",DOWNPLAY_ACTION_TYPE="downplay",SELECT_ACTION_TYPE="select",UNSELECT_ACTION_TYPE="unselect",TOGGLE_SELECT_ACTION_TYPE="toggleSelect";function hasFillOrStroke(s){return s!=null&&s!=="none"}function doChangeHoverState(s,a,o){s.onHoverStateChange&&(s.hoverState||0)!==o&&s.onHoverStateChange(a),s.hoverState=o}function singleEnterEmphasis(s){doChangeHoverState(s,"emphasis",HOVER_STATE_EMPHASIS)}function singleLeaveEmphasis(s){s.hoverState===HOVER_STATE_EMPHASIS&&doChangeHoverState(s,"normal",HOVER_STATE_NORMAL)}function singleEnterBlur(s){doChangeHoverState(s,"blur",HOVER_STATE_BLUR)}function singleLeaveBlur(s){s.hoverState===HOVER_STATE_BLUR&&doChangeHoverState(s,"normal",HOVER_STATE_NORMAL)}function singleEnterSelect(s){s.selected=!0}function singleLeaveSelect(s){s.selected=!1}function updateElementState(s,a,o){a(s,o)}function traverseUpdateState(s,a,o){updateElementState(s,a,o),s.isGroup&&s.traverse(function(c){updateElementState(c,a,o)})}function setStatesFlag(s,a){switch(a){case"emphasis":s.hoverState=HOVER_STATE_EMPHASIS;break;case"normal":s.hoverState=HOVER_STATE_NORMAL;break;case"blur":s.hoverState=HOVER_STATE_BLUR;break;case"select":s.selected=!0}}function getFromStateStyle(s,a,o,c){for(var d=s.style,tt={},nt=0;nt<a.length;nt++){var it=a[nt],st=d[it];tt[it]=st??(c&&c[it])}for(var nt=0;nt<s.animators.length;nt++){var ut=s.animators[nt];ut.__fromStateTransition&&ut.__fromStateTransition.indexOf(o)<0&&ut.targetName==="style"&&ut.saveTo(tt,a)}return tt}function createEmphasisDefaultState(s,a,o,c){var d=o&&indexOf(o,"select")>=0,tt=!1;if(s instanceof Path){var nt=getSavedStates(s),it=d&&nt.selectFill||nt.normalFill,st=d&&nt.selectStroke||nt.normalStroke;if(hasFillOrStroke(it)||hasFillOrStroke(st)){c=c||{};var ut=c.style||{};ut.fill==="inherit"?(tt=!0,c=extend({},c),ut=extend({},ut),ut.fill=it):!hasFillOrStroke(ut.fill)&&hasFillOrStroke(it)?(tt=!0,c=extend({},c),ut=extend({},ut),ut.fill=liftColor(it)):!hasFillOrStroke(ut.stroke)&&hasFillOrStroke(st)&&(tt||(c=extend({},c),ut=extend({},ut)),ut.stroke=liftColor(st)),c.style=ut}}if(c&&c.z2==null){tt||(c=extend({},c));var ct=s.z2EmphasisLift;c.z2=s.z2+(ct??Z2_EMPHASIS_LIFT)}return c}function createSelectDefaultState(s,a,o){if(o&&o.z2==null){o=extend({},o);var c=s.z2SelectLift;o.z2=s.z2+(c??Z2_SELECT_LIFT)}return o}function createBlurDefaultState(s,a,o){var c=indexOf(s.currentStates,a)>=0,d=s.style.opacity,tt=c?null:getFromStateStyle(s,["opacity"],a,{opacity:1});o=o||{};var nt=o.style||{};return nt.opacity==null&&(o=extend({},o),nt=extend({opacity:c?d:tt.opacity*.1},nt),o.style=nt),o}function elementStateProxy(s,a){var o=this.states[s];if(this.style){if(s==="emphasis")return createEmphasisDefaultState(this,s,a,o);if(s==="blur")return createBlurDefaultState(this,s,o);if(s==="select")return createSelectDefaultState(this,s,o)}return o}function setDefaultStateProxy(s){s.stateProxy=elementStateProxy;var a=s.getTextContent(),o=s.getTextGuideLine();a&&(a.stateProxy=elementStateProxy),o&&(o.stateProxy=elementStateProxy)}function enterEmphasisWhenMouseOver(s,a){!shouldSilent(s,a)&&!s.__highByOuter&&traverseUpdateState(s,singleEnterEmphasis)}function leaveEmphasisWhenMouseOut(s,a){!shouldSilent(s,a)&&!s.__highByOuter&&traverseUpdateState(s,singleLeaveEmphasis)}function enterEmphasis(s,a){s.__highByOuter|=1<<(a||0),traverseUpdateState(s,singleEnterEmphasis)}function leaveEmphasis(s,a){!(s.__highByOuter&=~(1<<(a||0)))&&traverseUpdateState(s,singleLeaveEmphasis)}function enterBlur(s){traverseUpdateState(s,singleEnterBlur)}function leaveBlur(s){traverseUpdateState(s,singleLeaveBlur)}function enterSelect(s){traverseUpdateState(s,singleEnterSelect)}function leaveSelect(s){traverseUpdateState(s,singleLeaveSelect)}function shouldSilent(s,a){return s.__highDownSilentOnTouch&&a.zrByTouch}function allLeaveBlur(s){var a=s.getModel(),o=[],c=[];a.eachComponent(function(d,tt){var nt=getComponentStates(tt),it=d==="series",st=it?s.getViewOfSeriesModel(tt):s.getViewOfComponentModel(tt);!it&&c.push(st),nt.isBlured&&(st.group.traverse(function(ut){singleLeaveBlur(ut)}),it&&o.push(tt)),nt.isBlured=!1}),each$f(c,function(d){d&&d.toggleBlurSeries&&d.toggleBlurSeries(o,!1,a)})}function blurSeries(s,a,o,c){var d=c.getModel();o=o||"coordinateSystem";function tt(ut,ct){for(var ot=0;ot<ct.length;ot++){var at=ut.getItemGraphicEl(ct[ot]);at&&leaveBlur(at)}}if(s!=null&&!(!a||a==="none")){var nt=d.getSeriesByIndex(s),it=nt.coordinateSystem;it&&it.master&&(it=it.master);var st=[];d.eachSeries(function(ut){var ct=nt===ut,ot=ut.coordinateSystem;ot&&ot.master&&(ot=ot.master);var at=ot&&it?ot===it:ct;if(!(o==="series"&&!ct||o==="coordinateSystem"&&!at||a==="series"&&ct)){var ht=c.getViewOfSeriesModel(ut);if(ht.group.traverse(function(yt){yt.__highByOuter&&ct&&a==="self"||singleEnterBlur(yt)}),isArrayLike(a))tt(ut.getData(),a);else if(isObject$3(a))for(var ft=keys(a),mt=0;mt<ft.length;mt++)tt(ut.getData(ft[mt]),a[ft[mt]]);st.push(ut),getComponentStates(ut).isBlured=!0}}),d.eachComponent(function(ut,ct){if(ut!=="series"){var ot=c.getViewOfComponentModel(ct);ot&&ot.toggleBlurSeries&&ot.toggleBlurSeries(st,!0,d)}})}}function blurComponent(s,a,o){if(!(s==null||a==null)){var c=o.getModel().getComponent(s,a);if(c){getComponentStates(c).isBlured=!0;var d=o.getViewOfComponentModel(c);!d||!d.focusBlurEnabled||d.group.traverse(function(tt){singleEnterBlur(tt)})}}}function blurSeriesFromHighlightPayload(s,a,o){var c=s.seriesIndex,d=s.getData(a.dataType);if(d){var tt=queryDataIndex(d,a);tt=(isArray$1(tt)?tt[0]:tt)||0;var nt=d.getItemGraphicEl(tt);if(!nt)for(var it=d.count(),st=0;!nt&&st<it;)nt=d.getItemGraphicEl(st++);if(nt){var ut=getECData(nt);blurSeries(c,ut.focus,ut.blurScope,o)}else{var ct=s.get(["emphasis","focus"]),ot=s.get(["emphasis","blurScope"]);ct!=null&&blurSeries(c,ct,ot,o)}}}function findComponentHighDownDispatchers(s,a,o,c){var d={focusSelf:!1,dispatchers:null};if(s==null||s==="series"||a==null||o==null)return d;var tt=c.getModel().getComponent(s,a);if(!tt)return d;var nt=c.getViewOfComponentModel(tt);if(!nt||!nt.findHighDownDispatchers)return d;for(var it=nt.findHighDownDispatchers(o),st,ut=0;ut<it.length;ut++)if(getECData(it[ut]).focus==="self"){st=!0;break}return{focusSelf:st,dispatchers:it}}function handleGlobalMouseOverForHighDown(s,a,o){var c=getECData(s),d=findComponentHighDownDispatchers(c.componentMainType,c.componentIndex,c.componentHighDownName,o),tt=d.dispatchers,nt=d.focusSelf;tt?(nt&&blurComponent(c.componentMainType,c.componentIndex,o),each$f(tt,function(it){return enterEmphasisWhenMouseOver(it,a)})):(blurSeries(c.seriesIndex,c.focus,c.blurScope,o),c.focus==="self"&&blurComponent(c.componentMainType,c.componentIndex,o),enterEmphasisWhenMouseOver(s,a))}function handleGlobalMouseOutForHighDown(s,a,o){allLeaveBlur(o);var c=getECData(s),d=findComponentHighDownDispatchers(c.componentMainType,c.componentIndex,c.componentHighDownName,o).dispatchers;d?each$f(d,function(tt){return leaveEmphasisWhenMouseOut(tt,a)}):leaveEmphasisWhenMouseOut(s,a)}function toggleSelectionFromPayload(s,a,o){if(isSelectChangePayload(a)){var c=a.dataType,d=s.getData(c),tt=queryDataIndex(d,a);isArray$1(tt)||(tt=[tt]),s[a.type===TOGGLE_SELECT_ACTION_TYPE?"toggleSelect":a.type===SELECT_ACTION_TYPE?"select":"unselect"](tt,c)}}function updateSeriesElementSelection(s){var a=s.getAllData();each$f(a,function(o){var c=o.data,d=o.type;c.eachItemGraphicEl(function(tt,nt){s.isSelected(nt,d)?enterSelect(tt):leaveSelect(tt)})})}function getAllSelectedIndices(s){var a=[];return s.eachSeries(function(o){var c=o.getAllData();each$f(c,function(d){d.data;var tt=d.type,nt=o.getSelectedDataIndices();if(nt.length>0){var it={dataIndex:nt,seriesIndex:o.seriesIndex};tt!=null&&(it.dataType=tt),a.push(it)}})}),a}function enableHoverEmphasis(s,a,o){setAsHighDownDispatcher(s,!0),traverseUpdateState(s,setDefaultStateProxy),enableHoverFocus(s,a,o)}function disableHoverEmphasis(s){setAsHighDownDispatcher(s,!1)}function toggleHoverEmphasis(s,a,o,c){c?disableHoverEmphasis(s):enableHoverEmphasis(s,a,o)}function enableHoverFocus(s,a,o){var c=getECData(s);a!=null?(c.focus=a,c.blurScope=o):c.focus&&(c.focus=null)}var OTHER_STATES=["emphasis","blur","select"],defaultStyleGetterMap={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function setStatesStylesFromModel(s,a,o,c){o=o||"itemStyle";for(var d=0;d<OTHER_STATES.length;d++){var tt=OTHER_STATES[d],nt=a.getModel([tt,o]),it=s.ensureState(tt);it.style=c?c(nt):nt[defaultStyleGetterMap[o]]()}}function setAsHighDownDispatcher(s,a){var o=a===!1,c=s;s.highDownSilentOnTouch&&(c.__highDownSilentOnTouch=s.highDownSilentOnTouch),(!o||c.__highDownDispatcher)&&(c.__highByOuter=c.__highByOuter||0,c.__highDownDispatcher=!o)}function isHighDownDispatcher(s){return!!(s&&s.__highDownDispatcher)}function enableComponentHighDownFeatures(s,a,o){var c=getECData(s);c.componentMainType=a.mainType,c.componentIndex=a.componentIndex,c.componentHighDownName=o}function getHighlightDigit(s){var a=_highlightKeyMap[s];return a==null&&_highlightNextDigit<=32&&(a=_highlightKeyMap[s]=_highlightNextDigit++),a}function isSelectChangePayload(s){var a=s.type;return a===SELECT_ACTION_TYPE||a===UNSELECT_ACTION_TYPE||a===TOGGLE_SELECT_ACTION_TYPE}function isHighDownPayload(s){var a=s.type;return a===HIGHLIGHT_ACTION_TYPE||a===DOWNPLAY_ACTION_TYPE}function savePathStates(s){var a=getSavedStates(s);a.normalFill=s.style.fill,a.normalStroke=s.style.stroke;var o=s.states.select||{};a.selectFill=o.style&&o.style.fill||null,a.selectStroke=o.style&&o.style.stroke||null}var CMD$2=PathProxy.CMD,points$2=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;function transformPath(s,a){if(a){var o=s.data,c=s.len(),d,tt,nt,it,st,ut,ct=CMD$2.M,ot=CMD$2.C,at=CMD$2.L,ht=CMD$2.R,ft=CMD$2.A,mt=CMD$2.Q;for(nt=0,it=0;nt<c;){switch(d=o[nt++],it=nt,tt=0,d){case ct:tt=1;break;case at:tt=1;break;case ot:tt=3;break;case mt:tt=2;break;case ft:var yt=a[4],bt=a[5],wt=mathSqrt$2(a[0]*a[0]+a[1]*a[1]),Tt=mathSqrt$2(a[2]*a[2]+a[3]*a[3]),Ct=mathAtan2(-a[1]/Tt,a[0]/wt);o[nt]*=wt,o[nt++]+=yt,o[nt]*=Tt,o[nt++]+=bt,o[nt++]*=wt,o[nt++]*=Tt,o[nt++]+=Ct,o[nt++]+=Ct,nt+=2,it=nt;break;case ht:ut[0]=o[nt++],ut[1]=o[nt++],applyTransform$1(ut,ut,a),o[it++]=ut[0],o[it++]=ut[1],ut[0]+=o[nt++],ut[1]+=o[nt++],applyTransform$1(ut,ut,a),o[it++]=ut[0],o[it++]=ut[1]}for(st=0;st<tt;st++){var Dt=points$2[st];Dt[0]=o[nt++],Dt[1]=o[nt++],applyTransform$1(Dt,Dt,a),o[it++]=Dt[0],o[it++]=Dt[1]}}s.increaseVersion()}}var mathSqrt$1=Math.sqrt,mathSin$2=Math.sin,mathCos$2=Math.cos,PI$7=Math.PI;function vMag(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function vRatio(s,a){return(s[0]*a[0]+s[1]*a[1])/(vMag(s)*vMag(a))}function vAngle(s,a){return(s[0]*a[1]<s[1]*a[0]?-1:1)*Math.acos(vRatio(s,a))}function processArc(s,a,o,c,d,tt,nt,it,st,ut,ct){var ot=st*(PI$7/180),at=mathCos$2(ot)*(s-o)/2+mathSin$2(ot)*(a-c)/2,ht=-1*mathSin$2(ot)*(s-o)/2+mathCos$2(ot)*(a-c)/2,ft=at*at/(nt*nt)+ht*ht/(it*it);ft>1&&(nt*=mathSqrt$1(ft),it*=mathSqrt$1(ft));var mt=(d===tt?-1:1)*mathSqrt$1((nt*nt*(it*it)-nt*nt*(ht*ht)-it*it*(at*at))/(nt*nt*(ht*ht)+it*it*(at*at)))||0,yt=mt*nt*ht/it,bt=mt*-it*at/nt,wt=(s+o)/2+mathCos$2(ot)*yt-mathSin$2(ot)*bt,Tt=(a+c)/2+mathSin$2(ot)*yt+mathCos$2(ot)*bt,Ct=vAngle([1,0],[(at-yt)/nt,(ht-bt)/it]),Dt=[(at-yt)/nt,(ht-bt)/it],Ot=[(-1*at-yt)/nt,(-1*ht-bt)/it],$t=vAngle(Dt,Ot);if(vRatio(Dt,Ot)<=-1&&($t=PI$7),vRatio(Dt,Ot)>=1&&($t=0),$t<0){var Ft=Math.round($t/PI$7*1e6)/1e6;$t=PI$7*2+Ft%2*PI$7}ct.addData(ut,wt,Tt,nt,it,Ct,$t,ot,tt)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,numberReg$1=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function createPathProxyFromString(s){var a=new PathProxy;if(!s)return a;var o=0,c=0,d=o,tt=c,nt,it=PathProxy.CMD,st=s.match(commandReg);if(!st)return a;for(var ut=0;ut<st.length;ut++){for(var ct=st[ut],ot=ct.charAt(0),at=void 0,ht=ct.match(numberReg$1)||[],ft=ht.length,mt=0;mt<ft;mt++)ht[mt]=parseFloat(ht[mt]);for(var yt=0;yt<ft;){var bt=void 0,wt=void 0,Tt=void 0,Ct=void 0,Dt=void 0,Ot=void 0,$t=void 0,Ft=o,kt=c,Vt=void 0,Ht=void 0;switch(ot){case"l":o+=ht[yt++],c+=ht[yt++],at=it.L,a.addData(at,o,c);break;case"L":o=ht[yt++],c=ht[yt++],at=it.L,a.addData(at,o,c);break;case"m":o+=ht[yt++],c+=ht[yt++],at=it.M,a.addData(at,o,c),d=o,tt=c,ot="l";break;case"M":o=ht[yt++],c=ht[yt++],at=it.M,a.addData(at,o,c),d=o,tt=c,ot="L";break;case"h":o+=ht[yt++],at=it.L,a.addData(at,o,c);break;case"H":o=ht[yt++],at=it.L,a.addData(at,o,c);break;case"v":c+=ht[yt++],at=it.L,a.addData(at,o,c);break;case"V":c=ht[yt++],at=it.L,a.addData(at,o,c);break;case"C":at=it.C,a.addData(at,ht[yt++],ht[yt++],ht[yt++],ht[yt++],ht[yt++],ht[yt++]),o=ht[yt-2],c=ht[yt-1];break;case"c":at=it.C,a.addData(at,ht[yt++]+o,ht[yt++]+c,ht[yt++]+o,ht[yt++]+c,ht[yt++]+o,ht[yt++]+c),o+=ht[yt-2],c+=ht[yt-1];break;case"S":bt=o,wt=c,Vt=a.len(),Ht=a.data,nt===it.C&&(bt+=o-Ht[Vt-4],wt+=c-Ht[Vt-3]),at=it.C,Ft=ht[yt++],kt=ht[yt++],o=ht[yt++],c=ht[yt++],a.addData(at,bt,wt,Ft,kt,o,c);break;case"s":bt=o,wt=c,Vt=a.len(),Ht=a.data,nt===it.C&&(bt+=o-Ht[Vt-4],wt+=c-Ht[Vt-3]),at=it.C,Ft=o+ht[yt++],kt=c+ht[yt++],o+=ht[yt++],c+=ht[yt++],a.addData(at,bt,wt,Ft,kt,o,c);break;case"Q":Ft=ht[yt++],kt=ht[yt++],o=ht[yt++],c=ht[yt++],at=it.Q,a.addData(at,Ft,kt,o,c);break;case"q":Ft=ht[yt++]+o,kt=ht[yt++]+c,o+=ht[yt++],c+=ht[yt++],at=it.Q,a.addData(at,Ft,kt,o,c);break;case"T":bt=o,wt=c,Vt=a.len(),Ht=a.data,nt===it.Q&&(bt+=o-Ht[Vt-4],wt+=c-Ht[Vt-3]),o=ht[yt++],c=ht[yt++],at=it.Q,a.addData(at,bt,wt,o,c);break;case"t":bt=o,wt=c,Vt=a.len(),Ht=a.data,nt===it.Q&&(bt+=o-Ht[Vt-4],wt+=c-Ht[Vt-3]),o+=ht[yt++],c+=ht[yt++],at=it.Q,a.addData(at,bt,wt,o,c);break;case"A":Tt=ht[yt++],Ct=ht[yt++],Dt=ht[yt++],Ot=ht[yt++],$t=ht[yt++],Ft=o,kt=c,o=ht[yt++],c=ht[yt++],at=it.A,processArc(Ft,kt,o,c,Ot,$t,Tt,Ct,Dt,at,a);break;case"a":Tt=ht[yt++],Ct=ht[yt++],Dt=ht[yt++],Ot=ht[yt++],$t=ht[yt++],Ft=o,kt=c,o+=ht[yt++],c+=ht[yt++],at=it.A,processArc(Ft,kt,o,c,Ot,$t,Tt,Ct,Dt,at,a);break}}(ot==="z"||ot==="Z")&&(at=it.Z,a.addData(at),o=d,c=tt),nt=at}return a.toStatic(),a}var SVGPath=function(s){__extends(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.applyTransform=function(o){},a}(Path);function isPathProxy(s){return s.setData!=null}function createPathOptions(s,a){var o=createPathProxyFromString(s),c=extend({},a);return c.buildPath=function(d){if(isPathProxy(d)){d.setData(o.data);var tt=d.getContext();tt&&d.rebuildPath(tt,1)}else{var tt=d;o.rebuildPath(tt,1)}},c.applyTransform=function(d){transformPath(o,d),this.dirtyShape()},c}function createFromString(s,a){return new SVGPath(createPathOptions(s,a))}function extendFromString(s,a){var o=createPathOptions(s,a),c=function(d){__extends(tt,d);function tt(nt){var it=d.call(this,nt)||this;return it.applyTransform=o.applyTransform,it.buildPath=o.buildPath,it}return tt}(SVGPath);return c}function mergePath$1(s,a){for(var o=[],c=s.length,d=0;d<c;d++){var tt=s[d];o.push(tt.getUpdatedPathProxy(!0))}var nt=new Path(a);return nt.createPathProxy(),nt.buildPath=function(it){if(isPathProxy(it)){it.appendPath(o);var st=it.getContext();st&&it.rebuildPath(st,1)}},nt}function clonePath(s,a){a=a||{};var o=new Path;return s.shape&&o.setShape(s.shape),o.setStyle(s.style),a.bakeTransform?transformPath(o.path,s.getComputedTransform()):a.toLocal?o.setLocalTransform(s.getComputedTransform()):o.copyTransform(s),o.buildPath=s.buildPath,o.applyTransform=o.applyTransform,o.z=s.z,o.z2=s.z2,o.zlevel=s.zlevel,o}var CircleShape=function(){function s(){this.cx=0,this.cy=0,this.r=0}return s}(),Circle=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new CircleShape},a.prototype.buildPath=function(o,c){o.moveTo(c.cx+c.r,c.cy),o.arc(c.cx,c.cy,c.r,0,Math.PI*2)},a}(Path);Circle.prototype.type="circle";var EllipseShape=function(){function s(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return s}(),Ellipse=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new EllipseShape},a.prototype.buildPath=function(o,c){var d=.5522848,tt=c.cx,nt=c.cy,it=c.rx,st=c.ry,ut=it*d,ct=st*d;o.moveTo(tt-it,nt),o.bezierCurveTo(tt-it,nt-ct,tt-ut,nt-st,tt,nt-st),o.bezierCurveTo(tt+ut,nt-st,tt+it,nt-ct,tt+it,nt),o.bezierCurveTo(tt+it,nt+ct,tt+ut,nt+st,tt,nt+st),o.bezierCurveTo(tt-ut,nt+st,tt-it,nt+ct,tt-it,nt),o.closePath()},a}(Path);Ellipse.prototype.type="ellipse";var PI$6=Math.PI,PI2$3=PI$6*2,mathSin$1=Math.sin,mathCos$1=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs$1=Math.abs,mathSqrt=Math.sqrt,mathMax$7=Math.max,mathMin$7=Math.min,e=1e-4;function intersect(s,a,o,c,d,tt,nt,it){var st=o-s,ut=c-a,ct=nt-d,ot=it-tt,at=ot*st-ct*ut;if(!(at*at<e))return at=(ct*(a-tt)-ot*(s-d))/at,[s+at*st,a+at*ut]}function computeCornerTangents(s,a,o,c,d,tt,nt){var it=s-o,st=a-c,ut=(nt?tt:-tt)/mathSqrt(it*it+st*st),ct=ut*st,ot=-ut*it,at=s+ct,ht=a+ot,ft=o+ct,mt=c+ot,yt=(at+ft)/2,bt=(ht+mt)/2,wt=ft-at,Tt=mt-ht,Ct=wt*wt+Tt*Tt,Dt=d-tt,Ot=at*mt-ft*ht,$t=(Tt<0?-1:1)*mathSqrt(mathMax$7(0,Dt*Dt*Ct-Ot*Ot)),Ft=(Ot*Tt-wt*$t)/Ct,kt=(-Ot*wt-Tt*$t)/Ct,Vt=(Ot*Tt+wt*$t)/Ct,Ht=(-Ot*wt+Tt*$t)/Ct,Qt=Ft-yt,Xt=kt-bt,Zt=Vt-yt,ar=Ht-bt;return Qt*Qt+Xt*Xt>Zt*Zt+ar*ar&&(Ft=Vt,kt=Ht),{cx:Ft,cy:kt,x0:-ct,y0:-ot,x1:Ft*(d/Dt-1),y1:kt*(d/Dt-1)}}function normalizeCornerRadius(s){var a;if(isArray$1(s)){var o=s.length;if(!o)return s;o===1?a=[s[0],s[0],0,0]:o===2?a=[s[0],s[0],s[1],s[1]]:o===3?a=s.concat(s[2]):a=s}else a=[s,s,s,s];return a}function buildPath$1(s,a){var o,c=mathMax$7(a.r,0),d=mathMax$7(a.r0||0,0),tt=c>0,nt=d>0;if(!(!tt&&!nt)){if(tt||(c=d,d=0),d>c){var it=c;c=d,d=it}var st=a.startAngle,ut=a.endAngle;if(!(isNaN(st)||isNaN(ut))){var ct=a.cx,ot=a.cy,at=!!a.clockwise,ht=mathAbs$1(ut-st),ft=ht>PI2$3&&ht%PI2$3;if(ft>e&&(ht=ft),!(c>e))s.moveTo(ct,ot);else if(ht>PI2$3-e)s.moveTo(ct+c*mathCos$1(st),ot+c*mathSin$1(st)),s.arc(ct,ot,c,st,ut,!at),d>e&&(s.moveTo(ct+d*mathCos$1(ut),ot+d*mathSin$1(ut)),s.arc(ct,ot,d,ut,st,at));else{var mt=void 0,yt=void 0,bt=void 0,wt=void 0,Tt=void 0,Ct=void 0,Dt=void 0,Ot=void 0,$t=void 0,Ft=void 0,kt=void 0,Vt=void 0,Ht=void 0,Qt=void 0,Xt=void 0,Zt=void 0,ar=c*mathCos$1(st),nr=c*mathSin$1(st),cr=d*mathCos$1(ut),dr=d*mathSin$1(ut),mr=ht>e;if(mr){var Dr=a.cornerRadius;Dr&&(o=normalizeCornerRadius(Dr),mt=o[0],yt=o[1],bt=o[2],wt=o[3]);var kr=mathAbs$1(c-d)/2;if(Tt=mathMin$7(kr,bt),Ct=mathMin$7(kr,wt),Dt=mathMin$7(kr,mt),Ot=mathMin$7(kr,yt),kt=$t=mathMax$7(Tt,Ct),Vt=Ft=mathMax$7(Dt,Ot),($t>e||Ft>e)&&(Ht=c*mathCos$1(ut),Qt=c*mathSin$1(ut),Xt=d*mathCos$1(st),Zt=d*mathSin$1(st),ht<PI$6)){var Yr=intersect(ar,nr,Xt,Zt,Ht,Qt,cr,dr);if(Yr){var Mr=ar-Yr[0],Jr=nr-Yr[1],an=Ht-Yr[0],xn=Qt-Yr[1],Rn=1/mathSin$1(mathACos((Mr*an+Jr*xn)/(mathSqrt(Mr*Mr+Jr*Jr)*mathSqrt(an*an+xn*xn)))/2),hn=mathSqrt(Yr[0]*Yr[0]+Yr[1]*Yr[1]);kt=mathMin$7($t,(c-hn)/(Rn+1)),Vt=mathMin$7(Ft,(d-hn)/(Rn-1))}}}if(!mr)s.moveTo(ct+ar,ot+nr);else if(kt>e){var pn=mathMin$7(bt,kt),yn=mathMin$7(wt,kt),un=computeCornerTangents(Xt,Zt,ar,nr,c,pn,at),fn=computeCornerTangents(Ht,Qt,cr,dr,c,yn,at);s.moveTo(ct+un.cx+un.x0,ot+un.cy+un.y0),kt<$t&&pn===yn?s.arc(ct+un.cx,ot+un.cy,kt,mathATan2(un.y0,un.x0),mathATan2(fn.y0,fn.x0),!at):(pn>0&&s.arc(ct+un.cx,ot+un.cy,pn,mathATan2(un.y0,un.x0),mathATan2(un.y1,un.x1),!at),s.arc(ct,ot,c,mathATan2(un.cy+un.y1,un.cx+un.x1),mathATan2(fn.cy+fn.y1,fn.cx+fn.x1),!at),yn>0&&s.arc(ct+fn.cx,ot+fn.cy,yn,mathATan2(fn.y1,fn.x1),mathATan2(fn.y0,fn.x0),!at))}else s.moveTo(ct+ar,ot+nr),s.arc(ct,ot,c,st,ut,!at);if(!(d>e)||!mr)s.lineTo(ct+cr,ot+dr);else if(Vt>e){var pn=mathMin$7(mt,Vt),yn=mathMin$7(yt,Vt),un=computeCornerTangents(cr,dr,Ht,Qt,d,-yn,at),fn=computeCornerTangents(ar,nr,Xt,Zt,d,-pn,at);s.lineTo(ct+un.cx+un.x0,ot+un.cy+un.y0),Vt<Ft&&pn===yn?s.arc(ct+un.cx,ot+un.cy,Vt,mathATan2(un.y0,un.x0),mathATan2(fn.y0,fn.x0),!at):(yn>0&&s.arc(ct+un.cx,ot+un.cy,yn,mathATan2(un.y0,un.x0),mathATan2(un.y1,un.x1),!at),s.arc(ct,ot,d,mathATan2(un.cy+un.y1,un.cx+un.x1),mathATan2(fn.cy+fn.y1,fn.cx+fn.x1),at),pn>0&&s.arc(ct+fn.cx,ot+fn.cy,pn,mathATan2(fn.y1,fn.x1),mathATan2(fn.y0,fn.x0),!at))}else s.lineTo(ct+cr,ot+dr),s.arc(ct,ot,d,ut,st,at)}s.closePath()}}}var SectorShape=function(){function s(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return s}(),Sector=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new SectorShape},a.prototype.buildPath=function(o,c){buildPath$1(o,c)},a.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},a}(Path);Sector.prototype.type="sector";var RingShape=function(){function s(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return s}(),Ring=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new RingShape},a.prototype.buildPath=function(o,c){var d=c.cx,tt=c.cy,nt=Math.PI*2;o.moveTo(d+c.r,tt),o.arc(d,tt,c.r,0,nt,!1),o.moveTo(d+c.r0,tt),o.arc(d,tt,c.r0,0,nt,!0)},a}(Path);Ring.prototype.type="ring";function smoothBezier(s,a,o,c){var d=[],tt=[],nt=[],it=[],st,ut,ct,ot;if(c){ct=[1/0,1/0],ot=[-1/0,-1/0];for(var at=0,ht=s.length;at<ht;at++)min$1(ct,ct,s[at]),max$2(ot,ot,s[at]);min$1(ct,ct,c[0]),max$2(ot,ot,c[1])}for(var at=0,ht=s.length;at<ht;at++){var ft=s[at];if(o)st=s[at?at-1:ht-1],ut=s[(at+1)%ht];else if(at===0||at===ht-1){d.push(clone$3(s[at]));continue}else st=s[at-1],ut=s[at+1];sub(tt,ut,st),scale$2(tt,tt,a);var mt=distance(ft,st),yt=distance(ft,ut),bt=mt+yt;bt!==0&&(mt/=bt,yt/=bt),scale$2(nt,tt,-mt),scale$2(it,tt,yt);var wt=add([],ft,nt),Tt=add([],ft,it);c&&(max$2(wt,wt,ct),min$1(wt,wt,ot),max$2(Tt,Tt,ct),min$1(Tt,Tt,ot)),d.push(wt),d.push(Tt)}return o&&d.push(d.shift()),d}function buildPath(s,a,o){var c=a.smooth,d=a.points;if(d&&d.length>=2){if(c){var tt=smoothBezier(d,c,o,a.smoothConstraint);s.moveTo(d[0][0],d[0][1]);for(var nt=d.length,it=0;it<(o?nt:nt-1);it++){var st=tt[it*2],ut=tt[it*2+1],ct=d[(it+1)%nt];s.bezierCurveTo(st[0],st[1],ut[0],ut[1],ct[0],ct[1])}}else{s.moveTo(d[0][0],d[0][1]);for(var it=1,ot=d.length;it<ot;it++)s.lineTo(d[it][0],d[it][1])}o&&s.closePath()}}var PolygonShape=function(){function s(){this.points=null,this.smooth=0,this.smoothConstraint=null}return s}(),Polygon=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new PolygonShape},a.prototype.buildPath=function(o,c){buildPath(o,c,!0)},a}(Path);Polygon.prototype.type="polygon";var PolylineShape=function(){function s(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return s}(),Polyline$1=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new PolylineShape},a.prototype.buildPath=function(o,c){buildPath(o,c,!1)},a}(Path);Polyline$1.prototype.type="polyline";var subPixelOptimizeOutputShape={},LineShape=function(){function s(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return s}(),Line$1=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new LineShape},a.prototype.buildPath=function(o,c){var d,tt,nt,it;if(this.subPixelOptimize){var st=subPixelOptimizeLine$1(subPixelOptimizeOutputShape,c,this.style);d=st.x1,tt=st.y1,nt=st.x2,it=st.y2}else d=c.x1,tt=c.y1,nt=c.x2,it=c.y2;var ut=c.percent;ut!==0&&(o.moveTo(d,tt),ut<1&&(nt=d*(1-ut)+nt*ut,it=tt*(1-ut)+it*ut),o.lineTo(nt,it))},a.prototype.pointAt=function(o){var c=this.shape;return[c.x1*(1-o)+c.x2*o,c.y1*(1-o)+c.y2*o]},a}(Path);Line$1.prototype.type="line";var out=[],BezierCurveShape=function(){function s(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return s}();function someVectorAt(s,a,o){var c=s.cpx2,d=s.cpy2;return c!=null||d!=null?[(o?cubicDerivativeAt:cubicAt)(s.x1,s.cpx1,s.cpx2,s.x2,a),(o?cubicDerivativeAt:cubicAt)(s.y1,s.cpy1,s.cpy2,s.y2,a)]:[(o?quadraticDerivativeAt:quadraticAt$1)(s.x1,s.cpx1,s.x2,a),(o?quadraticDerivativeAt:quadraticAt$1)(s.y1,s.cpy1,s.y2,a)]}var BezierCurve=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new BezierCurveShape},a.prototype.buildPath=function(o,c){var d=c.x1,tt=c.y1,nt=c.x2,it=c.y2,st=c.cpx1,ut=c.cpy1,ct=c.cpx2,ot=c.cpy2,at=c.percent;at!==0&&(o.moveTo(d,tt),ct==null||ot==null?(at<1&&(quadraticSubdivide(d,st,nt,at,out),st=out[1],nt=out[2],quadraticSubdivide(tt,ut,it,at,out),ut=out[1],it=out[2]),o.quadraticCurveTo(st,ut,nt,it)):(at<1&&(cubicSubdivide(d,st,ct,nt,at,out),st=out[1],ct=out[2],nt=out[3],cubicSubdivide(tt,ut,ot,it,at,out),ut=out[1],ot=out[2],it=out[3]),o.bezierCurveTo(st,ut,ct,ot,nt,it)))},a.prototype.pointAt=function(o){return someVectorAt(this.shape,o,!1)},a.prototype.tangentAt=function(o){var c=someVectorAt(this.shape,o,!0);return normalize$3(c,c)},a}(Path);BezierCurve.prototype.type="bezier-curve";var ArcShape=function(){function s(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return s}(),Arc=function(s){__extends(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new ArcShape},a.prototype.buildPath=function(o,c){var d=c.cx,tt=c.cy,nt=Math.max(c.r,0),it=c.startAngle,st=c.endAngle,ut=c.clockwise,ct=Math.cos(it),ot=Math.sin(it);o.moveTo(ct*nt+d,ot*nt+tt),o.arc(d,tt,nt,it,st,!ut)},a}(Path);Arc.prototype.type="arc";var CompoundPath=function(s){__extends(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="compound",o}return a.prototype._updatePathDirty=function(){for(var o=this.shape.paths,c=this.shapeChanged(),d=0;d<o.length;d++)c=c||o[d].shapeChanged();c&&this.dirtyShape()},a.prototype.beforeBrush=function(){this._updatePathDirty();for(var o=this.shape.paths||[],c=this.getGlobalScale(),d=0;d<o.length;d++)o[d].path||o[d].createPathProxy(),o[d].path.setScale(c[0],c[1],o[d].segmentIgnoreThreshold)},a.prototype.buildPath=function(o,c){for(var d=c.paths||[],tt=0;tt<d.length;tt++)d[tt].buildPath(o,d[tt].shape,!0)},a.prototype.afterBrush=function(){for(var o=this.shape.paths||[],c=0;c<o.length;c++)o[c].pathUpdated()},a.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path.prototype.getBoundingRect.call(this)},a}(Path),Gradient=function(){function s(a){this.colorStops=a||[]}return s.prototype.addColorStop=function(a,o){this.colorStops.push({offset:a,color:o})},s}(),LinearGradient=function(s){__extends(a,s);function a(o,c,d,tt,nt,it){var st=s.call(this,nt)||this;return st.x=o??0,st.y=c??0,st.x2=d??1,st.y2=tt??0,st.type="linear",st.global=it||!1,st}return a}(Gradient),RadialGradient=function(s){__extends(a,s);function a(o,c,d,tt,nt){var it=s.call(this,tt)||this;return it.x=o??.5,it.y=c??.5,it.r=d??.5,it.type="radial",it.global=nt||!1,it}return a}(Gradient),extent=[0,0],extent2=[0,0],minTv=new Point,maxTv=new Point,OrientedBoundingRect=function(){function s(a,o){this._corners=[],this._axes=[],this._origin=[0,0];for(var c=0;c<4;c++)this._corners[c]=new Point;for(var c=0;c<2;c++)this._axes[c]=new Point;a&&this.fromBoundingRect(a,o)}return s.prototype.fromBoundingRect=function(a,o){var c=this._corners,d=this._axes,tt=a.x,nt=a.y,it=tt+a.width,st=nt+a.height;if(c[0].set(tt,nt),c[1].set(it,nt),c[2].set(it,st),c[3].set(tt,st),o)for(var ut=0;ut<4;ut++)c[ut].transform(o);Point.sub(d[0],c[1],c[0]),Point.sub(d[1],c[3],c[0]),d[0].normalize(),d[1].normalize();for(var ut=0;ut<2;ut++)this._origin[ut]=d[ut].dot(c[0])},s.prototype.intersect=function(a,o){var c=!0,d=!o;return minTv.set(1/0,1/0),maxTv.set(0,0),!this._intersectCheckOneSide(this,a,minTv,maxTv,d,1)&&(c=!1,d)||!this._intersectCheckOneSide(a,this,minTv,maxTv,d,-1)&&(c=!1,d)||d||Point.copy(o,c?minTv:maxTv),c},s.prototype._intersectCheckOneSide=function(a,o,c,d,tt,nt){for(var it=!0,st=0;st<2;st++){var ut=this._axes[st];if(this._getProjMinMaxOnAxis(st,a._corners,extent),this._getProjMinMaxOnAxis(st,o._corners,extent2),extent[1]<extent2[0]||extent[0]>extent2[1]){if(it=!1,tt)return it;var ct=Math.abs(extent2[0]-extent[1]),ot=Math.abs(extent[0]-extent2[1]);Math.min(ct,ot)>d.len()&&(ct<ot?Point.scale(d,ut,-ct*nt):Point.scale(d,ut,ot*nt))}else if(c){var ct=Math.abs(extent2[0]-extent[1]),ot=Math.abs(extent[0]-extent2[1]);Math.min(ct,ot)<c.len()&&(ct<ot?Point.scale(c,ut,ct*nt):Point.scale(c,ut,-ot*nt))}}return it},s.prototype._getProjMinMaxOnAxis=function(a,o,c){for(var d=this._axes[a],tt=this._origin,nt=o[0].dot(d)+tt[a],it=nt,st=nt,ut=1;ut<o.length;ut++){var ct=o[ut].dot(d)+tt[a];it=Math.min(ct,it),st=Math.max(ct,st)}c[0]=it,c[1]=st},s}(),m=[],IncrementalDisplayable=function(s){__extends(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.notClear=!0,o.incremental=!0,o._displayables=[],o._temporaryDisplayables=[],o._cursor=0,o}return a.prototype.traverse=function(o,c){o.call(c,this)},a.prototype.useStyle=function(){this.style={}},a.prototype.getCursor=function(){return this._cursor},a.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},a.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},a.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},a.prototype.addDisplayable=function(o,c){c?this._temporaryDisplayables.push(o):this._displayables.push(o),this.markRedraw()},a.prototype.addDisplayables=function(o,c){c=c||!1;for(var d=0;d<o.length;d++)this.addDisplayable(o[d],c)},a.prototype.getDisplayables=function(){return this._displayables},a.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},a.prototype.eachPendingDisplayable=function(o){for(var c=this._cursor;c<this._displayables.length;c++)o&&o(this._displayables[c]);for(var c=0;c<this._temporaryDisplayables.length;c++)o&&o(this._temporaryDisplayables[c])},a.prototype.update=function(){this.updateTransform();for(var o=this._cursor;o<this._displayables.length;o++){var c=this._displayables[o];c.parent=this,c.update(),c.parent=null}for(var o=0;o<this._temporaryDisplayables.length;o++){var c=this._temporaryDisplayables[o];c.parent=this,c.update(),c.parent=null}},a.prototype.getBoundingRect=function(){if(!this._rect){for(var o=new BoundingRect(1/0,1/0,-1/0,-1/0),c=0;c<this._displayables.length;c++){var d=this._displayables[c],tt=d.getBoundingRect().clone();d.needLocalTransform()&&tt.applyTransform(d.getLocalTransform(m)),o.union(tt)}this._rect=o}return this._rect},a.prototype.contain=function(o,c){var d=this.transformCoordToLocal(o,c),tt=this.getBoundingRect();if(tt.contain(d[0],d[1]))for(var nt=0;nt<this._displayables.length;nt++){var it=this._displayables[nt];if(it.contain(o,c))return!0}return!1},a}(Displayable),transitionStore=makeInner();function getAnimationConfig(s,a,o,c,d){var tt;if(a&&a.ecModel){var nt=a.ecModel.getUpdatePayload();tt=nt&&nt.animation}var it=a&&a.isAnimationEnabled(),st=s==="update";if(it){var ut=void 0,ct=void 0,ot=void 0;c?(ut=retrieve2(c.duration,200),ct=retrieve2(c.easing,"cubicOut"),ot=0):(ut=a.getShallow(st?"animationDurationUpdate":"animationDuration"),ct=a.getShallow(st?"animationEasingUpdate":"animationEasing"),ot=a.getShallow(st?"animationDelayUpdate":"animationDelay")),tt&&(tt.duration!=null&&(ut=tt.duration),tt.easing!=null&&(ct=tt.easing),tt.delay!=null&&(ot=tt.delay)),isFunction$1(ot)&&(ot=ot(o,d)),isFunction$1(ut)&&(ut=ut(o));var at={duration:ut||0,delay:ot,easing:ct};return at}else return null}function animateOrSetProps(s,a,o,c,d,tt,nt){var it=!1,st;isFunction$1(d)?(nt=tt,tt=d,d=null):isObject$3(d)&&(tt=d.cb,nt=d.during,it=d.isFrom,st=d.removeOpt,d=d.dataIndex);var ut=s==="leave";ut||a.stopAnimation("leave");var ct=getAnimationConfig(s,c,d,ut?st||{}:null,c&&c.getAnimationDelayParams?c.getAnimationDelayParams(a,d):null);if(ct&&ct.duration>0){var ot=ct.duration,at=ct.delay,ht=ct.easing,ft={duration:ot,delay:at||0,easing:ht,done:tt,force:!!tt||!!nt,setToFinal:!ut,scope:s,during:nt};it?a.animateFrom(o,ft):a.animateTo(o,ft)}else a.stopAnimation(),!it&&a.attr(o),nt&&nt(1),tt&&tt()}function updateProps$1(s,a,o,c,d,tt){animateOrSetProps("update",s,a,o,c,d,tt)}function initProps(s,a,o,c,d,tt){animateOrSetProps("enter",s,a,o,c,d,tt)}function isElementRemoved(s){if(!s.__zr)return!0;for(var a=0;a<s.animators.length;a++){var o=s.animators[a];if(o.scope==="leave")return!0}return!1}function removeElement(s,a,o,c,d,tt){isElementRemoved(s)||animateOrSetProps("leave",s,a,o,c,d,tt)}function fadeOutDisplayable(s,a,o,c){s.removeTextContent(),s.removeTextGuideLine(),removeElement(s,{style:{opacity:0}},a,o,c)}function removeElementWithFadeOut(s,a,o){function c(){s.parent&&s.parent.remove(s)}s.isGroup?s.traverse(function(d){d.isGroup||fadeOutDisplayable(d,a,o,c)}):fadeOutDisplayable(s,a,o,c)}function saveOldStyle(s){transitionStore(s).oldStyle=s.style}function getOldStyle(s){return transitionStore(s).oldStyle}var mathMax$6=Math.max,mathMin$6=Math.min,_customShapeMap={};function extendShape(s){return Path.extend(s)}var extendPathFromString=extendFromString;function extendPath(s,a){return extendPathFromString(s,a)}function registerShape(s,a){_customShapeMap[s]=a}function getShapeClass(s){if(_customShapeMap.hasOwnProperty(s))return _customShapeMap[s]}function makePath(s,a,o,c){var d=createFromString(s,a);return o&&(c==="center"&&(o=centerGraphic(o,d.getBoundingRect())),resizePath(d,o)),d}function makeImage(s,a,o){var c=new ZRImage({style:{image:s,x:a.x,y:a.y,width:a.width,height:a.height},onload:function(d){if(o==="center"){var tt={width:d.width,height:d.height};c.setStyle(centerGraphic(a,tt))}}});return c}function centerGraphic(s,a){var o=a.width/a.height,c=s.height*o,d;c<=s.width?d=s.height:(c=s.width,d=c/o);var tt=s.x+s.width/2,nt=s.y+s.height/2;return{x:tt-c/2,y:nt-d/2,width:c,height:d}}var mergePath=mergePath$1;function resizePath(s,a){if(s.applyTransform){var o=s.getBoundingRect(),c=o.calculateTransform(a);s.applyTransform(c)}}function subPixelOptimizeLine(s,a){return subPixelOptimizeLine$1(s,s,{lineWidth:a}),s}function subPixelOptimizeRect(s){return subPixelOptimizeRect$1(s.shape,s.shape,s.style),s}var subPixelOptimize=subPixelOptimize$1;function getTransform$1(s,a){for(var o=identity([]);s&&s!==a;)mul(o,s.getLocalTransform(),o),s=s.parent;return o}function applyTransform(s,a,o){return a&&!isArrayLike(a)&&(a=Transformable.getLocalTransform(a)),o&&(a=invert([],a)),applyTransform$1([],s,a)}function transformDirection(s,a,o){var c=a[4]===0||a[5]===0||a[0]===0?1:Math.abs(2*a[4]/a[0]),d=a[4]===0||a[5]===0||a[2]===0?1:Math.abs(2*a[4]/a[2]),tt=[s==="left"?-c:s==="right"?c:0,s==="top"?-d:s==="bottom"?d:0];return tt=applyTransform(tt,a,o),Math.abs(tt[0])>Math.abs(tt[1])?tt[0]>0?"right":"left":tt[1]>0?"bottom":"top"}function isNotGroup(s){return!s.isGroup}function isPath$1(s){return s.shape!=null}function groupTransition(s,a,o){if(!s||!a)return;function c(nt){var it={};return nt.traverse(function(st){isNotGroup(st)&&st.anid&&(it[st.anid]=st)}),it}function d(nt){var it={x:nt.x,y:nt.y,rotation:nt.rotation};return isPath$1(nt)&&(it.shape=extend({},nt.shape)),it}var tt=c(s);a.traverse(function(nt){if(isNotGroup(nt)&&nt.anid){var it=tt[nt.anid];if(it){var st=d(nt);nt.attr(d(it)),updateProps$1(nt,st,o,getECData(nt).dataIndex)}}})}function clipPointsByRect(s,a){return map$1(s,function(o){var c=o[0];c=mathMax$6(c,a.x),c=mathMin$6(c,a.x+a.width);var d=o[1];return d=mathMax$6(d,a.y),d=mathMin$6(d,a.y+a.height),[c,d]})}function clipRectByRect(s,a){var o=mathMax$6(s.x,a.x),c=mathMin$6(s.x+s.width,a.x+a.width),d=mathMax$6(s.y,a.y),tt=mathMin$6(s.y+s.height,a.y+a.height);if(c>=o&&tt>=d)return{x:o,y:d,width:c-o,height:tt-d}}function createIcon(s,a,o){var c=extend({rectHover:!0},a),d=c.style={strokeNoScale:!0};if(o=o||{x:-1,y:-1,width:2,height:2},s)return s.indexOf("image://")===0?(d.image=s.slice(8),defaults(d,o),new ZRImage(c)):makePath(s.replace("path://",""),c,o,"center")}function linePolygonIntersect(s,a,o,c,d){for(var tt=0,nt=d[d.length-1];tt<d.length;tt++){var it=d[tt];if(lineLineIntersect$1(s,a,o,c,it[0],it[1],nt[0],nt[1]))return!0;nt=it}}function lineLineIntersect$1(s,a,o,c,d,tt,nt,it){var st=o-s,ut=c-a,ct=nt-d,ot=it-tt,at=crossProduct2d$1(ct,ot,st,ut);if(nearZero(at))return!1;var ht=s-d,ft=a-tt,mt=crossProduct2d$1(ht,ft,st,ut)/at;if(mt<0||mt>1)return!1;var yt=crossProduct2d$1(ht,ft,ct,ot)/at;return!(yt<0||yt>1)}function crossProduct2d$1(s,a,o,c){return s*c-o*a}function nearZero(s){return s<=1e-6&&s>=-1e-6}function setTooltipConfig(s){var a=s.itemTooltipOption,o=s.componentModel,c=s.itemName,d=isString$1(a)?{formatter:a}:a,tt=o.mainType,nt=o.componentIndex,it={componentType:tt,name:c,$vars:["name"]};it[tt+"Index"]=nt;var st=s.formatterParamsExtra;st&&each$f(keys(st),function(ct){hasOwn(it,ct)||(it[ct]=st[ct],it.$vars.push(ct))});var ut=getECData(s.el);ut.componentMainType=tt,ut.componentIndex=nt,ut.tooltipConfig={name:c,option:defaults({content:c,encodeHTMLContent:!0,formatterParams:it},d)}}function traverseElement(s,a){var o;s.isGroup&&(o=a(s)),o||s.traverse(a)}function traverseElements(s,a){if(s)if(isArray$1(s))for(var o=0;o<s.length;o++)traverseElement(s[o],a);else traverseElement(s,a)}registerShape("circle",Circle);registerShape("ellipse",Ellipse);registerShape("sector",Sector);registerShape("ring",Ring);registerShape("polygon",Polygon);registerShape("polyline",Polyline$1);registerShape("rect",Rect$2);registerShape("line",Line$1);registerShape("bezierCurve",BezierCurve);registerShape("arc",Arc);const graphic$1=Object.freeze(Object.defineProperty({__proto__:null,Arc,BezierCurve,BoundingRect,Circle,CompoundPath,Ellipse,Group:Group$3,Image:ZRImage,IncrementalDisplayable,Line:Line$1,LinearGradient,OrientedBoundingRect,Path,Point,Polygon,Polyline:Polyline$1,RadialGradient,Rect:Rect$2,Ring,Sector,Text:ZRText,applyTransform,clipPointsByRect,clipRectByRect,createIcon,extendPath,extendShape,getShapeClass,getTransform:getTransform$1,groupTransition,initProps,isElementRemoved,lineLineIntersect:lineLineIntersect$1,linePolygonIntersect,makeImage,makePath,mergePath,registerShape,removeElement,removeElementWithFadeOut,resizePath,setTooltipConfig,subPixelOptimize,subPixelOptimizeLine,subPixelOptimizeRect,transformDirection,traverseElements,updateProps:updateProps$1},Symbol.toStringTag,{value:"Module"}));var EMPTY_OBJ={};function setLabelText(s,a){for(var o=0;o<SPECIAL_STATES.length;o++){var c=SPECIAL_STATES[o],d=a[c],tt=s.ensureState(c);tt.style=tt.style||{},tt.style.text=d}var nt=s.currentStates.slice();s.clearStates(!0),s.setStyle({text:a.normal}),s.useStates(nt,!0)}function getLabelText(s,a,o){var c=s.labelFetcher,d=s.labelDataIndex,tt=s.labelDimIndex,nt=a.normal,it;c&&(it=c.getFormattedLabel(d,"normal",null,tt,nt&&nt.get("formatter"),o!=null?{interpolatedValue:o}:null)),it==null&&(it=isFunction$1(s.defaultText)?s.defaultText(d,s,o):s.defaultText);for(var st={normal:it},ut=0;ut<SPECIAL_STATES.length;ut++){var ct=SPECIAL_STATES[ut],ot=a[ct];st[ct]=retrieve2(c?c.getFormattedLabel(d,ct,null,tt,ot&&ot.get("formatter")):null,it)}return st}function setLabelStyle(s,a,o,c){o=o||EMPTY_OBJ;for(var d=s instanceof ZRText,tt=!1,nt=0;nt<DISPLAY_STATES.length;nt++){var it=a[DISPLAY_STATES[nt]];if(it&&it.getShallow("show")){tt=!0;break}}var st=d?s:s.getTextContent();if(tt){d||(st||(st=new ZRText,s.setTextContent(st)),s.stateProxy&&(st.stateProxy=s.stateProxy));var ut=getLabelText(o,a),ct=a.normal,ot=!!ct.getShallow("show"),at=createTextStyle$1(ct,c&&c.normal,o,!1,!d);at.text=ut.normal,d||s.setTextConfig(createTextConfig(ct,o,!1));for(var nt=0;nt<SPECIAL_STATES.length;nt++){var ht=SPECIAL_STATES[nt],it=a[ht];if(it){var ft=st.ensureState(ht),mt=!!retrieve2(it.getShallow("show"),ot);if(mt!==ot&&(ft.ignore=!mt),ft.style=createTextStyle$1(it,c&&c[ht],o,!0,!d),ft.style.text=ut[ht],!d){var yt=s.ensureState(ht);yt.textConfig=createTextConfig(it,o,!0)}}}st.silent=!!ct.getShallow("silent"),st.style.x!=null&&(at.x=st.style.x),st.style.y!=null&&(at.y=st.style.y),st.ignore=!ot,st.useStyle(at),st.dirty(),o.enableTextSetter&&(labelInner(st).setLabelText=function(bt){var wt=getLabelText(o,a,bt);setLabelText(st,wt)})}else st&&(st.ignore=!0);s.dirty()}function getLabelStatesModels(s,a){a=a||"label";for(var o={normal:s.getModel(a)},c=0;c<SPECIAL_STATES.length;c++){var d=SPECIAL_STATES[c];o[d]=s.getModel([d,a])}return o}function createTextStyle$1(s,a,o,c,d){var tt={};return setTextStyleCommon(tt,s,o,c,d),a&&extend(tt,a),tt}function createTextConfig(s,a,o){a=a||{};var c={},d,tt=s.getShallow("rotate"),nt=retrieve2(s.getShallow("distance"),o?null:5),it=s.getShallow("offset");return d=s.getShallow("position")||(o?null:"inside"),d==="outside"&&(d=a.defaultOutsidePosition||"top"),d!=null&&(c.position=d),it!=null&&(c.offset=it),tt!=null&&(tt*=Math.PI/180,c.rotation=tt),nt!=null&&(c.distance=nt),c.outsideFill=s.get("color")==="inherit"?a.inheritColor||null:"auto",c}function setTextStyleCommon(s,a,o,c,d){o=o||EMPTY_OBJ;var tt=a.ecModel,nt=tt&&tt.option.textStyle,it=getRichItemNames(a),st;if(it){st={};for(var ut in it)if(it.hasOwnProperty(ut)){var ct=a.getModel(["rich",ut]);setTokenTextStyle(st[ut]={},ct,nt,o,c,d,!1,!0)}}st&&(s.rich=st);var ot=a.get("overflow");ot&&(s.overflow=ot);var at=a.get("minMargin");at!=null&&(s.margin=at),setTokenTextStyle(s,a,nt,o,c,d,!0,!1)}function getRichItemNames(s){for(var a;s&&s!==s.ecModel;){var o=(s.option||EMPTY_OBJ).rich;if(o){a=a||{};for(var c=keys(o),d=0;d<c.length;d++){var tt=c[d];a[tt]=1}}s=s.parentModel}return a}var TEXT_PROPS_WITH_GLOBAL=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],TEXT_PROPS_SELF=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],TEXT_PROPS_BOX=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function setTokenTextStyle(s,a,o,c,d,tt,nt,it){o=!d&&o||EMPTY_OBJ;var st=c&&c.inheritColor,ut=a.getShallow("color"),ct=a.getShallow("textBorderColor"),ot=retrieve2(a.getShallow("opacity"),o.opacity);(ut==="inherit"||ut==="auto")&&(st?ut=st:ut=null),(ct==="inherit"||ct==="auto")&&(st?ct=st:ct=null),tt||(ut=ut||o.color,ct=ct||o.textBorderColor),ut!=null&&(s.fill=ut),ct!=null&&(s.stroke=ct);var at=retrieve2(a.getShallow("textBorderWidth"),o.textBorderWidth);at!=null&&(s.lineWidth=at);var ht=retrieve2(a.getShallow("textBorderType"),o.textBorderType);ht!=null&&(s.lineDash=ht);var ft=retrieve2(a.getShallow("textBorderDashOffset"),o.textBorderDashOffset);ft!=null&&(s.lineDashOffset=ft),!d&&ot==null&&!it&&(ot=c&&c.defaultOpacity),ot!=null&&(s.opacity=ot),!d&&!tt&&s.fill==null&&c.inheritColor&&(s.fill=c.inheritColor);for(var mt=0;mt<TEXT_PROPS_WITH_GLOBAL.length;mt++){var yt=TEXT_PROPS_WITH_GLOBAL[mt],bt=retrieve2(a.getShallow(yt),o[yt]);bt!=null&&(s[yt]=bt)}for(var mt=0;mt<TEXT_PROPS_SELF.length;mt++){var yt=TEXT_PROPS_SELF[mt],bt=a.getShallow(yt);bt!=null&&(s[yt]=bt)}if(s.verticalAlign==null){var wt=a.getShallow("baseline");wt!=null&&(s.verticalAlign=wt)}if(!nt||!c.disableBox){for(var mt=0;mt<TEXT_PROPS_BOX.length;mt++){var yt=TEXT_PROPS_BOX[mt],bt=a.getShallow(yt);bt!=null&&(s[yt]=bt)}var Tt=a.getShallow("borderType");Tt!=null&&(s.borderDash=Tt),(s.backgroundColor==="auto"||s.backgroundColor==="inherit")&&st&&(s.backgroundColor=st),(s.borderColor==="auto"||s.borderColor==="inherit")&&st&&(s.borderColor=st)}}function getFont(s,a){var o=a&&a.getModel("textStyle");return trim$1([s.fontStyle||o&&o.getShallow("fontStyle")||"",s.fontWeight||o&&o.getShallow("fontWeight")||"",(s.fontSize||o&&o.getShallow("fontSize")||12)+"px",s.fontFamily||o&&o.getShallow("fontFamily")||"sans-serif"].join(" "))}var labelInner=makeInner();function setLabelValueAnimation(s,a,o,c){if(s){var d=labelInner(s);d.prevValue=d.value,d.value=o;var tt=a.normal;d.valueAnimation=tt.get("valueAnimation"),d.valueAnimation&&(d.precision=tt.get("precision"),d.defaultInterpolatedText=c,d.statesModels=a)}}function animateLabelValue(s,a,o,c,d){var tt=labelInner(s);if(!tt.valueAnimation||tt.prevValue===tt.value)return;var nt=tt.defaultInterpolatedText,it=retrieve2(tt.interpolatedValue,tt.prevValue),st=tt.value;function ut(ct){var ot=interpolateRawValues(o,tt.precision,it,st,ct);tt.interpolatedValue=ct===1?null:ot;var at=getLabelText({labelDataIndex:a,labelFetcher:d,defaultText:nt?nt(ot):ot+""},tt.statesModels,ot);setLabelText(s,at)}s.percent=0,(tt.prevValue==null?initProps:updateProps$1)(s,{percent:1},c,a,null,ut)}var PATH_COLOR=["textStyle","color"],textStyleParams=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],tmpText=new ZRText,TextStyleMixin=function(){function s(){}return s.prototype.getTextColor=function(a){var o=this.ecModel;return this.getShallow("color")||(!a&&o?o.get(PATH_COLOR):null)},s.prototype.getFont=function(){return getFont({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},s.prototype.getTextRect=function(a){for(var o={text:a,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},c=0;c<textStyleParams.length;c++)o[textStyleParams[c]]=this.getShallow(textStyleParams[c]);return tmpText.useStyle(o),tmpText.update(),tmpText.getBoundingRect()},s}(),LINE_STYLE_KEY_MAP=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],getLineStyle=makeStyleMapper(LINE_STYLE_KEY_MAP),LineStyleMixin=function(){function s(){}return s.prototype.getLineStyle=function(a){return getLineStyle(this,a)},s}(),ITEM_STYLE_KEY_MAP=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],getItemStyle=makeStyleMapper(ITEM_STYLE_KEY_MAP),ItemStyleMixin=function(){function s(){}return s.prototype.getItemStyle=function(a,o){return getItemStyle(this,a,o)},s}(),Model=function(){function s(a,o,c){this.parentModel=o,this.ecModel=c,this.option=a}return s.prototype.init=function(a,o,c){},s.prototype.mergeOption=function(a,o){merge(this.option,a,!0)},s.prototype.get=function(a,o){return a==null?this.option:this._doGet(this.parsePath(a),!o&&this.parentModel)},s.prototype.getShallow=function(a,o){var c=this.option,d=c==null?c:c[a];if(d==null&&!o){var tt=this.parentModel;tt&&(d=tt.getShallow(a))}return d},s.prototype.getModel=function(a,o){var c=a!=null,d=c?this.parsePath(a):null,tt=c?this._doGet(d):this.option;return o=o||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(d)),new s(tt,o,this.ecModel)},s.prototype.isEmpty=function(){return this.option==null},s.prototype.restoreData=function(){},s.prototype.clone=function(){var a=this.constructor;return new a(clone$4(this.option))},s.prototype.parsePath=function(a){return typeof a=="string"?a.split("."):a},s.prototype.resolveParentPath=function(a){return a},s.prototype.isAnimationEnabled=function(){if(!env.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},s.prototype._doGet=function(a,o){var c=this.option;if(!a)return c;for(var d=0;d<a.length&&!(a[d]&&(c=c&&typeof c=="object"?c[a[d]]:null,c==null));d++);return c==null&&o&&(c=o._doGet(this.resolveParentPath(a),o.parentModel)),c},s}();enableClassExtend(Model);enableClassCheck(Model);mixin(Model,LineStyleMixin);mixin(Model,ItemStyleMixin);mixin(Model,AreaStyleMixin);mixin(Model,TextStyleMixin);var base=Math.round(Math.random()*10);function getUID(s){return[s||"",base++].join("_")}function enableSubTypeDefaulter(s){var a={};s.registerSubTypeDefaulter=function(o,c){var d=parseClassType(o);a[d.main]=c},s.determineSubType=function(o,c){var d=c.type;if(!d){var tt=parseClassType(o).main;s.hasSubTypes(o)&&a[tt]&&(d=a[tt](c))}return d}}function enableTopologicalTravel(s,a){s.topologicalTravel=function(tt,nt,it,st){if(!tt.length)return;var ut=o(nt),ct=ut.graph,ot=ut.noEntryList,at={};for(each$f(tt,function(wt){at[wt]=!0});ot.length;){var ht=ot.pop(),ft=ct[ht],mt=!!at[ht];mt&&(it.call(st,ht,ft.originalDeps.slice()),delete at[ht]),each$f(ft.successor,mt?bt:yt)}each$f(at,function(){var wt="";throw new Error(wt)});function yt(wt){ct[wt].entryCount--,ct[wt].entryCount===0&&ot.push(wt)}function bt(wt){at[wt]=!0,yt(wt)}};function o(tt){var nt={},it=[];return each$f(tt,function(st){var ut=c(nt,st),ct=ut.originalDeps=a(st),ot=d(ct,tt);ut.entryCount=ot.length,ut.entryCount===0&&it.push(st),each$f(ot,function(at){indexOf(ut.predecessor,at)<0&&ut.predecessor.push(at);var ht=c(nt,at);indexOf(ht.successor,at)<0&&ht.successor.push(st)})}),{graph:nt,noEntryList:it}}function c(tt,nt){return tt[nt]||(tt[nt]={predecessor:[],successor:[]}),tt[nt]}function d(tt,nt){var it=[];return each$f(tt,function(st){indexOf(nt,st)>=0&&it.push(st)}),it}}function inheritDefaultOption(s,a){return merge(merge({},s,!0),a,!0)}const langEN={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},langZH={time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图",custom:"自定义图表",chart:"图表"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}};var LOCALE_ZH="ZH",LOCALE_EN="EN",DEFAULT_LOCALE=LOCALE_EN,localeStorage={},localeModels={},SYSTEM_LANG=env.domSupported?function(){var s=(document.documentElement.lang||navigator.language||navigator.browserLanguage||DEFAULT_LOCALE).toUpperCase();return s.indexOf(LOCALE_ZH)>-1?LOCALE_ZH:DEFAULT_LOCALE}():DEFAULT_LOCALE;function registerLocale(s,a){s=s.toUpperCase(),localeModels[s]=new Model(a),localeStorage[s]=a}function createLocaleObject(s){if(isString$1(s)){var a=localeStorage[s.toUpperCase()]||{};return s===LOCALE_ZH||s===LOCALE_EN?clone$4(a):merge(clone$4(a),clone$4(localeStorage[DEFAULT_LOCALE]),!1)}else return merge(clone$4(s),clone$4(localeStorage[DEFAULT_LOCALE]),!1)}function getLocaleModel(s){return localeModels[s]}function getDefaultLocaleModel(){return localeModels[DEFAULT_LOCALE]}registerLocale(LOCALE_EN,langEN);registerLocale(LOCALE_ZH,langZH);var ONE_SECOND=1e3,ONE_MINUTE=ONE_SECOND*60,ONE_HOUR=ONE_MINUTE*60,ONE_DAY=ONE_HOUR*24,ONE_YEAR=ONE_DAY*365,defaultLeveledFormatter={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},fullDayFormatter="{yyyy}-{MM}-{dd}",fullLeveledFormatter={year:"{yyyy}",month:"{yyyy}-{MM}",day:fullDayFormatter,hour:fullDayFormatter+" "+defaultLeveledFormatter.hour,minute:fullDayFormatter+" "+defaultLeveledFormatter.minute,second:fullDayFormatter+" "+defaultLeveledFormatter.second,millisecond:defaultLeveledFormatter.none},primaryTimeUnits=["year","month","day","hour","minute","second","millisecond"],timeUnits=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function pad(s,a){return s+="","0000".substr(0,a-s.length)+s}function getPrimaryTimeUnit(s){switch(s){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return s}}function isPrimaryTimeUnit(s){return s===getPrimaryTimeUnit(s)}function getDefaultFormatPrecisionOfInterval(s){switch(s){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function format$1(s,a,o,c){var d=parseDate(s),tt=d[fullYearGetterName(o)](),nt=d[monthGetterName(o)]()+1,it=Math.floor((nt-1)/3)+1,st=d[dateGetterName(o)](),ut=d["get"+(o?"UTC":"")+"Day"](),ct=d[hoursGetterName(o)](),ot=(ct-1)%12+1,at=d[minutesGetterName(o)](),ht=d[secondsGetterName(o)](),ft=d[millisecondsGetterName(o)](),mt=ct>=12?"pm":"am",yt=mt.toUpperCase(),bt=c instanceof Model?c:getLocaleModel(c||SYSTEM_LANG)||getDefaultLocaleModel(),wt=bt.getModel("time"),Tt=wt.get("month"),Ct=wt.get("monthAbbr"),Dt=wt.get("dayOfWeek"),Ot=wt.get("dayOfWeekAbbr");return(a||"").replace(/{a}/g,mt+"").replace(/{A}/g,yt+"").replace(/{yyyy}/g,tt+"").replace(/{yy}/g,pad(tt%100+"",2)).replace(/{Q}/g,it+"").replace(/{MMMM}/g,Tt[nt-1]).replace(/{MMM}/g,Ct[nt-1]).replace(/{MM}/g,pad(nt,2)).replace(/{M}/g,nt+"").replace(/{dd}/g,pad(st,2)).replace(/{d}/g,st+"").replace(/{eeee}/g,Dt[ut]).replace(/{ee}/g,Ot[ut]).replace(/{e}/g,ut+"").replace(/{HH}/g,pad(ct,2)).replace(/{H}/g,ct+"").replace(/{hh}/g,pad(ot+"",2)).replace(/{h}/g,ot+"").replace(/{mm}/g,pad(at,2)).replace(/{m}/g,at+"").replace(/{ss}/g,pad(ht,2)).replace(/{s}/g,ht+"").replace(/{SSS}/g,pad(ft,3)).replace(/{S}/g,ft+"")}function leveledFormat(s,a,o,c,d){var tt=null;if(isString$1(o))tt=o;else if(isFunction$1(o))tt=o(s.value,a,{level:s.level});else{var nt=extend({},defaultLeveledFormatter);if(s.level>0)for(var it=0;it<primaryTimeUnits.length;++it)nt[primaryTimeUnits[it]]="{primary|"+nt[primaryTimeUnits[it]]+"}";var st=o?o.inherit===!1?o:defaults(o,nt):nt,ut=getUnitFromValue(s.value,d);if(st[ut])tt=st[ut];else if(st.inherit){for(var ct=timeUnits.indexOf(ut),it=ct-1;it>=0;--it)if(st[ut]){tt=st[ut];break}tt=tt||nt.none}if(isArray$1(tt)){var ot=s.level==null?0:s.level>=0?s.level:tt.length+s.level;ot=Math.min(ot,tt.length-1),tt=tt[ot]}}return format$1(new Date(s.value),tt,d,c)}function getUnitFromValue(s,a){var o=parseDate(s),c=o[monthGetterName(a)]()+1,d=o[dateGetterName(a)](),tt=o[hoursGetterName(a)](),nt=o[minutesGetterName(a)](),it=o[secondsGetterName(a)](),st=o[millisecondsGetterName(a)](),ut=st===0,ct=ut&&it===0,ot=ct&&nt===0,at=ot&&tt===0,ht=at&&d===1,ft=ht&&c===1;return ft?"year":ht?"month":at?"day":ot?"hour":ct?"minute":ut?"second":"millisecond"}function getUnitValue(s,a,o){var c=isNumber(s)?parseDate(s):s;switch(a=a||getUnitFromValue(s,o),a){case"year":return c[fullYearGetterName(o)]();case"half-year":return c[monthGetterName(o)]()>=6?1:0;case"quarter":return Math.floor((c[monthGetterName(o)]()+1)/4);case"month":return c[monthGetterName(o)]();case"day":return c[dateGetterName(o)]();case"half-day":return c[hoursGetterName(o)]()/24;case"hour":return c[hoursGetterName(o)]();case"minute":return c[minutesGetterName(o)]();case"second":return c[secondsGetterName(o)]();case"millisecond":return c[millisecondsGetterName(o)]()}}function fullYearGetterName(s){return s?"getUTCFullYear":"getFullYear"}function monthGetterName(s){return s?"getUTCMonth":"getMonth"}function dateGetterName(s){return s?"getUTCDate":"getDate"}function hoursGetterName(s){return s?"getUTCHours":"getHours"}function minutesGetterName(s){return s?"getUTCMinutes":"getMinutes"}function secondsGetterName(s){return s?"getUTCSeconds":"getSeconds"}function millisecondsGetterName(s){return s?"getUTCMilliseconds":"getMilliseconds"}function fullYearSetterName(s){return s?"setUTCFullYear":"setFullYear"}function monthSetterName(s){return s?"setUTCMonth":"setMonth"}function dateSetterName(s){return s?"setUTCDate":"setDate"}function hoursSetterName(s){return s?"setUTCHours":"setHours"}function minutesSetterName(s){return s?"setUTCMinutes":"setMinutes"}function secondsSetterName(s){return s?"setUTCSeconds":"setSeconds"}function millisecondsSetterName(s){return s?"setUTCMilliseconds":"setMilliseconds"}function getTextRect(s,a,o,c,d,tt,nt,it){var st=new ZRText({style:{text:s,font:a,align:o,verticalAlign:c,padding:d,rich:tt,overflow:nt?"truncate":null,lineHeight:it}});return st.getBoundingRect()}function addCommas(s){if(!isNumeric(s))return isString$1(s)?s:"-";var a=(s+"").split(".");return a[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(a.length>1?"."+a[1]:"")}function toCamelCase(s,a){return s=(s||"").toLowerCase().replace(/-(.)/g,function(o,c){return c.toUpperCase()}),a&&s&&(s=s.charAt(0).toUpperCase()+s.slice(1)),s}var normalizeCssArray=normalizeCssArray$1;function makeValueReadable(s,a,o){var c="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function d(ct){return ct&&trim$1(ct)?ct:"-"}function tt(ct){return!!(ct!=null&&!isNaN(ct)&&isFinite(ct))}var nt=a==="time",it=s instanceof Date;if(nt||it){var st=nt?parseDate(s):s;if(isNaN(+st)){if(it)return"-"}else return format$1(st,c,o)}if(a==="ordinal")return isStringSafe(s)?d(s):isNumber(s)&&tt(s)?s+"":"-";var ut=numericToNumber(s);return tt(ut)?addCommas(ut):isStringSafe(s)?d(s):typeof s=="boolean"?s+"":"-"}var TPL_VAR_ALIAS=["a","b","c","d","e","f","g"],wrapVar=function(s,a){return"{"+s+(a??"")+"}"};function formatTpl(s,a,o){isArray$1(a)||(a=[a]);var c=a.length;if(!c)return"";for(var d=a[0].$vars||[],tt=0;tt<d.length;tt++){var nt=TPL_VAR_ALIAS[tt];s=s.replace(wrapVar(nt),wrapVar(nt,0))}for(var it=0;it<c;it++)for(var st=0;st<d.length;st++){var ut=a[it][d[st]];s=s.replace(wrapVar(TPL_VAR_ALIAS[st],it),o?encodeHTML(ut):ut)}return s}function formatTplSimple(s,a,o){return each$f(a,function(c,d){s=s.replace("{"+d+"}",c)}),s}function getTooltipMarker(s,a){var o=isString$1(s)?{color:s,extraCssText:a}:s||{},c=o.color,d=o.type;a=o.extraCssText;var tt=o.renderMode||"html";if(!c)return"";if(tt==="html")return d==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+encodeHTML(c)+";"+(a||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+encodeHTML(c)+";"+(a||"")+'"></span>';var nt=o.markerId||"markerX";return{renderMode:tt,content:"{"+nt+"|}  ",style:d==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:c}:{width:10,height:10,borderRadius:5,backgroundColor:c}}}function formatTime(s,a,o){(s==="week"||s==="month"||s==="quarter"||s==="half-year"||s==="year")&&(s=`MM-dd
yyyy`);var c=parseDate(a),d=o?"getUTC":"get",tt=c[d+"FullYear"](),nt=c[d+"Month"]()+1,it=c[d+"Date"](),st=c[d+"Hours"](),ut=c[d+"Minutes"](),ct=c[d+"Seconds"](),ot=c[d+"Milliseconds"]();return s=s.replace("MM",pad(nt,2)).replace("M",nt).replace("yyyy",tt).replace("yy",pad(tt%100+"",2)).replace("dd",pad(it,2)).replace("d",it).replace("hh",pad(st,2)).replace("h",st).replace("mm",pad(ut,2)).replace("m",ut).replace("ss",pad(ct,2)).replace("s",ct).replace("SSS",pad(ot,3)),s}function capitalFirst(s){return s&&s.charAt(0).toUpperCase()+s.substr(1)}function convertToColorString(s,a){return a=a||"transparent",isString$1(s)?s:isObject$3(s)&&s.colorStops&&(s.colorStops[0]||{}).color||a}function windowOpen(s,a){if(a==="_blank"||a==="blank"){var o=window.open();o.opener=null,o.location.href=s}else window.open(s,a)}var each$e=each$f,LOCATION_PARAMS=["left","right","top","bottom","width","height"],HV_NAMES=[["width","left","right"],["height","top","bottom"]];function boxLayout(s,a,o,c,d){var tt=0,nt=0;c==null&&(c=1/0),d==null&&(d=1/0);var it=0;a.eachChild(function(st,ut){var ct=st.getBoundingRect(),ot=a.childAt(ut+1),at=ot&&ot.getBoundingRect(),ht,ft;if(s==="horizontal"){var mt=ct.width+(at?-at.x+ct.x:0);ht=tt+mt,ht>c||st.newline?(tt=0,ht=mt,nt+=it+o,it=ct.height):it=Math.max(it,ct.height)}else{var yt=ct.height+(at?-at.y+ct.y:0);ft=nt+yt,ft>d||st.newline?(tt+=it+o,nt=0,ft=yt,it=ct.width):it=Math.max(it,ct.width)}st.newline||(st.x=tt,st.y=nt,st.markRedraw(),s==="horizontal"?tt=ht+o:nt=ft+o)})}var box=boxLayout;curry$1(boxLayout,"vertical");curry$1(boxLayout,"horizontal");function getAvailableSize(s,a,o){var c=a.width,d=a.height,tt=parsePercent(s.left,c),nt=parsePercent(s.top,d),it=parsePercent(s.right,c),st=parsePercent(s.bottom,d);return(isNaN(tt)||isNaN(parseFloat(s.left)))&&(tt=0),(isNaN(it)||isNaN(parseFloat(s.right)))&&(it=c),(isNaN(nt)||isNaN(parseFloat(s.top)))&&(nt=0),(isNaN(st)||isNaN(parseFloat(s.bottom)))&&(st=d),o=normalizeCssArray(o||0),{width:Math.max(it-tt-o[1]-o[3],0),height:Math.max(st-nt-o[0]-o[2],0)}}function getLayoutRect(s,a,o){o=normalizeCssArray(o||0);var c=a.width,d=a.height,tt=parsePercent(s.left,c),nt=parsePercent(s.top,d),it=parsePercent(s.right,c),st=parsePercent(s.bottom,d),ut=parsePercent(s.width,c),ct=parsePercent(s.height,d),ot=o[2]+o[0],at=o[1]+o[3],ht=s.aspect;switch(isNaN(ut)&&(ut=c-it-at-tt),isNaN(ct)&&(ct=d-st-ot-nt),ht!=null&&(isNaN(ut)&&isNaN(ct)&&(ht>c/d?ut=c*.8:ct=d*.8),isNaN(ut)&&(ut=ht*ct),isNaN(ct)&&(ct=ut/ht)),isNaN(tt)&&(tt=c-it-ut-at),isNaN(nt)&&(nt=d-st-ct-ot),s.left||s.right){case"center":tt=c/2-ut/2-o[3];break;case"right":tt=c-ut-at;break}switch(s.top||s.bottom){case"middle":case"center":nt=d/2-ct/2-o[0];break;case"bottom":nt=d-ct-ot;break}tt=tt||0,nt=nt||0,isNaN(ut)&&(ut=c-at-tt-(it||0)),isNaN(ct)&&(ct=d-ot-nt-(st||0));var ft=new BoundingRect(tt+o[3],nt+o[0],ut,ct);return ft.margin=o,ft}function positionElement(s,a,o,c,d,tt){var nt=!d||!d.hv||d.hv[0],it=!d||!d.hv||d.hv[1],st=d&&d.boundingMode||"all";if(tt=tt||s,tt.x=s.x,tt.y=s.y,!nt&&!it)return!1;var ut;if(st==="raw")ut=s.type==="group"?new BoundingRect(0,0,+a.width||0,+a.height||0):s.getBoundingRect();else if(ut=s.getBoundingRect(),s.needLocalTransform()){var ct=s.getLocalTransform();ut=ut.clone(),ut.applyTransform(ct)}var ot=getLayoutRect(defaults({width:ut.width,height:ut.height},a),o,c),at=nt?ot.x-ut.x:0,ht=it?ot.y-ut.y:0;return st==="raw"?(tt.x=at,tt.y=ht):(tt.x+=at,tt.y+=ht),tt===s&&s.markRedraw(),!0}function sizeCalculable(s,a){return s[HV_NAMES[a][0]]!=null||s[HV_NAMES[a][1]]!=null&&s[HV_NAMES[a][2]]!=null}function fetchLayoutMode(s){var a=s.layoutMode||s.constructor.layoutMode;return isObject$3(a)?a:a?{type:a}:null}function mergeLayoutParam(s,a,o){var c=o&&o.ignoreSize;!isArray$1(c)&&(c=[c,c]);var d=nt(HV_NAMES[0],0),tt=nt(HV_NAMES[1],1);ut(HV_NAMES[0],s,d),ut(HV_NAMES[1],s,tt);function nt(ct,ot){var at={},ht=0,ft={},mt=0,yt=2;if(each$e(ct,function(Tt){ft[Tt]=s[Tt]}),each$e(ct,function(Tt){it(a,Tt)&&(at[Tt]=ft[Tt]=a[Tt]),st(at,Tt)&&ht++,st(ft,Tt)&&mt++}),c[ot])return st(a,ct[1])?ft[ct[2]]=null:st(a,ct[2])&&(ft[ct[1]]=null),ft;if(mt===yt||!ht)return ft;if(ht>=yt)return at;for(var bt=0;bt<ct.length;bt++){var wt=ct[bt];if(!it(at,wt)&&it(s,wt)){at[wt]=s[wt];break}}return at}function it(ct,ot){return ct.hasOwnProperty(ot)}function st(ct,ot){return ct[ot]!=null&&ct[ot]!=="auto"}function ut(ct,ot,at){each$e(ct,function(ht){ot[ht]=at[ht]})}}function getLayoutParams(s){return copyLayoutParams({},s)}function copyLayoutParams(s,a){return a&&s&&each$e(LOCATION_PARAMS,function(o){a.hasOwnProperty(o)&&(s[o]=a[o])}),s}var inner$l=makeInner(),ComponentModel=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this,o,c,d)||this;return tt.uid=getUID("ec_cpt_model"),tt}return a.prototype.init=function(o,c,d){this.mergeDefaultAndTheme(o,d)},a.prototype.mergeDefaultAndTheme=function(o,c){var d=fetchLayoutMode(this),tt=d?getLayoutParams(o):{},nt=c.getTheme();merge(o,nt.get(this.mainType)),merge(o,this.getDefaultOption()),d&&mergeLayoutParam(o,tt,d)},a.prototype.mergeOption=function(o,c){merge(this.option,o,!0);var d=fetchLayoutMode(this);d&&mergeLayoutParam(this.option,o,d)},a.prototype.optionUpdated=function(o,c){},a.prototype.getDefaultOption=function(){var o=this.constructor;if(!isExtendedClass(o))return o.defaultOption;var c=inner$l(this);if(!c.defaultOption){for(var d=[],tt=o;tt;){var nt=tt.prototype.defaultOption;nt&&d.push(nt),tt=tt.superClass}for(var it={},st=d.length-1;st>=0;st--)it=merge(it,d[st],!0);c.defaultOption=it}return c.defaultOption},a.prototype.getReferringComponents=function(o,c){var d=o+"Index",tt=o+"Id";return queryReferringComponents(this.ecModel,o,{index:this.get(d,!0),id:this.get(tt,!0)},c)},a.prototype.getBoxLayoutParams=function(){var o=this;return{left:o.get("left"),top:o.get("top"),right:o.get("right"),bottom:o.get("bottom"),width:o.get("width"),height:o.get("height")}},a.prototype.getZLevelKey=function(){return""},a.prototype.setZLevel=function(o){this.option.zlevel=o},a.protoInitialize=function(){var o=a.prototype;o.type="component",o.id="",o.name="",o.mainType="",o.subType="",o.componentIndex=0}(),a}(Model);mountExtend(ComponentModel,Model);enableClassManagement(ComponentModel);enableSubTypeDefaulter(ComponentModel);enableTopologicalTravel(ComponentModel,getDependencies);function getDependencies(s){var a=[];return each$f(ComponentModel.getClassesByMainType(s),function(o){a=a.concat(o.dependencies||o.prototype.dependencies||[])}),a=map$1(a,function(o){return parseClassType(o).main}),s!=="dataset"&&indexOf(a,"dataset")<=0&&a.unshift("dataset"),a}var platform="";typeof navigator<"u"&&(platform=navigator.platform||"");var decalColor="rgba(0, 0, 0, 0.2)";const globalDefault={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:decalColor,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:decalColor,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:decalColor,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:decalColor,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:decalColor,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:decalColor,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:platform.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var VISUAL_DIMENSIONS=createHashMap(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),SOURCE_FORMAT_ORIGINAL="original",SOURCE_FORMAT_ARRAY_ROWS="arrayRows",SOURCE_FORMAT_OBJECT_ROWS="objectRows",SOURCE_FORMAT_KEYED_COLUMNS="keyedColumns",SOURCE_FORMAT_TYPED_ARRAY="typedArray",SOURCE_FORMAT_UNKNOWN="unknown",SERIES_LAYOUT_BY_COLUMN="column",SERIES_LAYOUT_BY_ROW="row",BE_ORDINAL={Must:1,Might:2,Not:3},innerGlobalModel=makeInner();function resetSourceDefaulter(s){innerGlobalModel(s).datasetMap=createHashMap()}function makeSeriesEncodeForAxisCoordSys(s,a,o){var c={},d=querySeriesUpstreamDatasetModel(a);if(!d||!s)return c;var tt=[],nt=[],it=a.ecModel,st=innerGlobalModel(it).datasetMap,ut=d.uid+"_"+o.seriesLayoutBy,ct,ot;s=s.slice(),each$f(s,function(mt,yt){var bt=isObject$3(mt)?mt:s[yt]={name:mt};bt.type==="ordinal"&&ct==null&&(ct=yt,ot=ft(bt)),c[bt.name]=[]});var at=st.get(ut)||st.set(ut,{categoryWayDim:ot,valueWayDim:0});each$f(s,function(mt,yt){var bt=mt.name,wt=ft(mt);if(ct==null){var Tt=at.valueWayDim;ht(c[bt],Tt,wt),ht(nt,Tt,wt),at.valueWayDim+=wt}else if(ct===yt)ht(c[bt],0,wt),ht(tt,0,wt);else{var Tt=at.categoryWayDim;ht(c[bt],Tt,wt),ht(nt,Tt,wt),at.categoryWayDim+=wt}});function ht(mt,yt,bt){for(var wt=0;wt<bt;wt++)mt.push(yt+wt)}function ft(mt){var yt=mt.dimsDef;return yt?yt.length:1}return tt.length&&(c.itemName=tt),nt.length&&(c.seriesName=nt),c}function makeSeriesEncodeForNameBased(s,a,o){var c={},d=querySeriesUpstreamDatasetModel(s);if(!d)return c;var tt=a.sourceFormat,nt=a.dimensionsDefine,it;(tt===SOURCE_FORMAT_OBJECT_ROWS||tt===SOURCE_FORMAT_KEYED_COLUMNS)&&each$f(nt,function(ct,ot){(isObject$3(ct)?ct.name:ct)==="name"&&(it=ot)});var st=function(){for(var ct={},ot={},at=[],ht=0,ft=Math.min(5,o);ht<ft;ht++){var mt=doGuessOrdinal(a.data,tt,a.seriesLayoutBy,nt,a.startIndex,ht);at.push(mt);var yt=mt===BE_ORDINAL.Not;if(yt&&ct.v==null&&ht!==it&&(ct.v=ht),(ct.n==null||ct.n===ct.v||!yt&&at[ct.n]===BE_ORDINAL.Not)&&(ct.n=ht),bt(ct)&&at[ct.n]!==BE_ORDINAL.Not)return ct;yt||(mt===BE_ORDINAL.Might&&ot.v==null&&ht!==it&&(ot.v=ht),(ot.n==null||ot.n===ot.v)&&(ot.n=ht))}function bt(wt){return wt.v!=null&&wt.n!=null}return bt(ct)?ct:bt(ot)?ot:null}();if(st){c.value=[st.v];var ut=it??st.n;c.itemName=[ut],c.seriesName=[ut]}return c}function querySeriesUpstreamDatasetModel(s){var a=s.get("data",!0);if(!a)return queryReferringComponents(s.ecModel,"dataset",{index:s.get("datasetIndex",!0),id:s.get("datasetId",!0)},SINGLE_REFERRING).models[0]}function queryDatasetUpstreamDatasetModels(s){return!s.get("transform",!0)&&!s.get("fromTransformResult",!0)?[]:queryReferringComponents(s.ecModel,"dataset",{index:s.get("fromDatasetIndex",!0),id:s.get("fromDatasetId",!0)},SINGLE_REFERRING).models}function guessOrdinal(s,a){return doGuessOrdinal(s.data,s.sourceFormat,s.seriesLayoutBy,s.dimensionsDefine,s.startIndex,a)}function doGuessOrdinal(s,a,o,c,d,tt){var nt,it=5;if(isTypedArray(s))return BE_ORDINAL.Not;var st,ut;if(c){var ct=c[tt];isObject$3(ct)?(st=ct.name,ut=ct.type):isString$1(ct)&&(st=ct)}if(ut!=null)return ut==="ordinal"?BE_ORDINAL.Must:BE_ORDINAL.Not;if(a===SOURCE_FORMAT_ARRAY_ROWS){var ot=s;if(o===SERIES_LAYOUT_BY_ROW){for(var at=ot[tt],ht=0;ht<(at||[]).length&&ht<it;ht++)if((nt=Ct(at[d+ht]))!=null)return nt}else for(var ht=0;ht<ot.length&&ht<it;ht++){var ft=ot[d+ht];if(ft&&(nt=Ct(ft[tt]))!=null)return nt}}else if(a===SOURCE_FORMAT_OBJECT_ROWS){var mt=s;if(!st)return BE_ORDINAL.Not;for(var ht=0;ht<mt.length&&ht<it;ht++){var yt=mt[ht];if(yt&&(nt=Ct(yt[st]))!=null)return nt}}else if(a===SOURCE_FORMAT_KEYED_COLUMNS){var bt=s;if(!st)return BE_ORDINAL.Not;var at=bt[st];if(!at||isTypedArray(at))return BE_ORDINAL.Not;for(var ht=0;ht<at.length&&ht<it;ht++)if((nt=Ct(at[ht]))!=null)return nt}else if(a===SOURCE_FORMAT_ORIGINAL)for(var wt=s,ht=0;ht<wt.length&&ht<it;ht++){var yt=wt[ht],Tt=getDataItemValue(yt);if(!isArray$1(Tt))return BE_ORDINAL.Not;if((nt=Ct(Tt[tt]))!=null)return nt}function Ct(Dt){var Ot=isString$1(Dt);if(Dt!=null&&Number.isFinite(Number(Dt))&&Dt!=="")return Ot?BE_ORDINAL.Might:BE_ORDINAL.Not;if(Ot&&Dt!=="-")return BE_ORDINAL.Must}return BE_ORDINAL.Not}var internalOptionCreatorMap=createHashMap();function registerInternalOptionCreator(s,a){assert(internalOptionCreatorMap.get(s)==null&&a),internalOptionCreatorMap.set(s,a)}function concatInternalOptions(s,a,o){var c=internalOptionCreatorMap.get(a);if(!c)return o;var d=c(s);return d?o.concat(d):o}var innerColor=makeInner(),innerDecal=makeInner(),PaletteMixin=function(){function s(){}return s.prototype.getColorFromPalette=function(a,o,c){var d=normalizeToArray(this.get("color",!0)),tt=this.get("colorLayer",!0);return getFromPalette(this,innerColor,d,tt,a,o,c)},s.prototype.clearColorPalette=function(){clearPalette(this,innerColor)},s}();function getDecalFromPalette(s,a,o,c){var d=normalizeToArray(s.get(["aria","decal","decals"]));return getFromPalette(s,innerDecal,d,null,a,o,c)}function getNearestPalette(s,a){for(var o=s.length,c=0;c<o;c++)if(s[c].length>a)return s[c];return s[o-1]}function getFromPalette(s,a,o,c,d,tt,nt){tt=tt||s;var it=a(tt),st=it.paletteIdx||0,ut=it.paletteNameMap=it.paletteNameMap||{};if(ut.hasOwnProperty(d))return ut[d];var ct=nt==null||!c?o:getNearestPalette(c,nt);if(ct=ct||o,!(!ct||!ct.length)){var ot=ct[st];return d&&(ut[d]=ot),it.paletteIdx=(st+1)%ct.length,ot}}function clearPalette(s,a){a(s).paletteIdx=0,a(s).paletteNameMap={}}var reCreateSeriesIndices,assertSeriesInitialized,initBase,OPTION_INNER_KEY="\0_ec_inner",OPTION_INNER_VALUE=1,GlobalModel=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.init=function(o,c,d,tt,nt,it){tt=tt||{},this.option=null,this._theme=new Model(tt),this._locale=new Model(nt),this._optionManager=it},a.prototype.setOption=function(o,c,d){var tt=normalizeSetOptionInput(c);this._optionManager.setOption(o,d,tt),this._resetOption(null,tt)},a.prototype.resetOption=function(o,c){return this._resetOption(o,normalizeSetOptionInput(c))},a.prototype._resetOption=function(o,c){var d=!1,tt=this._optionManager;if(!o||o==="recreate"){var nt=tt.mountOption(o==="recreate");!this.option||o==="recreate"?initBase(this,nt):(this.restoreData(),this._mergeOption(nt,c)),d=!0}if((o==="timeline"||o==="media")&&this.restoreData(),!o||o==="recreate"||o==="timeline"){var it=tt.getTimelineOption(this);it&&(d=!0,this._mergeOption(it,c))}if(!o||o==="recreate"||o==="media"){var st=tt.getMediaOption(this);st.length&&each$f(st,function(ut){d=!0,this._mergeOption(ut,c)},this)}return d},a.prototype.mergeOption=function(o){this._mergeOption(o,null)},a.prototype._mergeOption=function(o,c){var d=this.option,tt=this._componentsMap,nt=this._componentsCount,it=[],st=createHashMap(),ut=c&&c.replaceMergeMainTypeMap;resetSourceDefaulter(this),each$f(o,function(ot,at){ot!=null&&(ComponentModel.hasClass(at)?at&&(it.push(at),st.set(at,!0)):d[at]=d[at]==null?clone$4(ot):merge(d[at],ot,!0))}),ut&&ut.each(function(ot,at){ComponentModel.hasClass(at)&&!st.get(at)&&(it.push(at),st.set(at,!0))}),ComponentModel.topologicalTravel(it,ComponentModel.getAllClassMainTypes(),ct,this);function ct(ot){var at=concatInternalOptions(this,ot,normalizeToArray(o[ot])),ht=tt.get(ot),ft=ht?ut&&ut.get(ot)?"replaceMerge":"normalMerge":"replaceAll",mt=mappingToExists(ht,at,ft);setComponentTypeToKeyInfo(mt,ot,ComponentModel),d[ot]=null,tt.set(ot,null),nt.set(ot,0);var yt=[],bt=[],wt=0,Tt;each$f(mt,function(Ct,Dt){var Ot=Ct.existing,$t=Ct.newOption;if(!$t)Ot&&(Ot.mergeOption({},this),Ot.optionUpdated({},!1));else{var Ft=ot==="series",kt=ComponentModel.getClass(ot,Ct.keyInfo.subType,!Ft);if(!kt)return;if(ot==="tooltip"){if(Tt)return;Tt=!0}if(Ot&&Ot.constructor===kt)Ot.name=Ct.keyInfo.name,Ot.mergeOption($t,this),Ot.optionUpdated($t,!1);else{var Vt=extend({componentIndex:Dt},Ct.keyInfo);Ot=new kt($t,this,this,Vt),extend(Ot,Vt),Ct.brandNew&&(Ot.__requireNewView=!0),Ot.init($t,this,this),Ot.optionUpdated(null,!0)}}Ot?(yt.push(Ot.option),bt.push(Ot),wt++):(yt.push(void 0),bt.push(void 0))},this),d[ot]=yt,tt.set(ot,bt),nt.set(ot,wt),ot==="series"&&reCreateSeriesIndices(this)}this._seriesIndices||reCreateSeriesIndices(this)},a.prototype.getOption=function(){var o=clone$4(this.option);return each$f(o,function(c,d){if(ComponentModel.hasClass(d)){for(var tt=normalizeToArray(c),nt=tt.length,it=!1,st=nt-1;st>=0;st--)tt[st]&&!isComponentIdInternal(tt[st])?it=!0:(tt[st]=null,!it&&nt--);tt.length=nt,o[d]=tt}}),delete o[OPTION_INNER_KEY],o},a.prototype.getTheme=function(){return this._theme},a.prototype.getLocaleModel=function(){return this._locale},a.prototype.setUpdatePayload=function(o){this._payload=o},a.prototype.getUpdatePayload=function(){return this._payload},a.prototype.getComponent=function(o,c){var d=this._componentsMap.get(o);if(d){var tt=d[c||0];if(tt)return tt;if(c==null){for(var nt=0;nt<d.length;nt++)if(d[nt])return d[nt]}}},a.prototype.queryComponents=function(o){var c=o.mainType;if(!c)return[];var d=o.index,tt=o.id,nt=o.name,it=this._componentsMap.get(c);if(!it||!it.length)return[];var st;return d!=null?(st=[],each$f(normalizeToArray(d),function(ut){it[ut]&&st.push(it[ut])})):tt!=null?st=queryByIdOrName("id",tt,it):nt!=null?st=queryByIdOrName("name",nt,it):st=filter(it,function(ut){return!!ut}),filterBySubType(st,o)},a.prototype.findComponents=function(o){var c=o.query,d=o.mainType,tt=it(c),nt=tt?this.queryComponents(tt):filter(this._componentsMap.get(d),function(ut){return!!ut});return st(filterBySubType(nt,o));function it(ut){var ct=d+"Index",ot=d+"Id",at=d+"Name";return ut&&(ut[ct]!=null||ut[ot]!=null||ut[at]!=null)?{mainType:d,index:ut[ct],id:ut[ot],name:ut[at]}:null}function st(ut){return o.filter?filter(ut,o.filter):ut}},a.prototype.eachComponent=function(o,c,d){var tt=this._componentsMap;if(isFunction$1(o)){var nt=c,it=o;tt.each(function(ot,at){for(var ht=0;ot&&ht<ot.length;ht++){var ft=ot[ht];ft&&it.call(nt,at,ft,ft.componentIndex)}})}else for(var st=isString$1(o)?tt.get(o):isObject$3(o)?this.findComponents(o):null,ut=0;st&&ut<st.length;ut++){var ct=st[ut];ct&&c.call(d,ct,ct.componentIndex)}},a.prototype.getSeriesByName=function(o){var c=convertOptionIdName(o,null);return filter(this._componentsMap.get("series"),function(d){return!!d&&c!=null&&d.name===c})},a.prototype.getSeriesByIndex=function(o){return this._componentsMap.get("series")[o]},a.prototype.getSeriesByType=function(o){return filter(this._componentsMap.get("series"),function(c){return!!c&&c.subType===o})},a.prototype.getSeries=function(){return filter(this._componentsMap.get("series"),function(o){return!!o})},a.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},a.prototype.eachSeries=function(o,c){assertSeriesInitialized(this),each$f(this._seriesIndices,function(d){var tt=this._componentsMap.get("series")[d];o.call(c,tt,d)},this)},a.prototype.eachRawSeries=function(o,c){each$f(this._componentsMap.get("series"),function(d){d&&o.call(c,d,d.componentIndex)})},a.prototype.eachSeriesByType=function(o,c,d){assertSeriesInitialized(this),each$f(this._seriesIndices,function(tt){var nt=this._componentsMap.get("series")[tt];nt.subType===o&&c.call(d,nt,tt)},this)},a.prototype.eachRawSeriesByType=function(o,c,d){return each$f(this.getSeriesByType(o),c,d)},a.prototype.isSeriesFiltered=function(o){return assertSeriesInitialized(this),this._seriesIndicesMap.get(o.componentIndex)==null},a.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},a.prototype.filterSeries=function(o,c){assertSeriesInitialized(this);var d=[];each$f(this._seriesIndices,function(tt){var nt=this._componentsMap.get("series")[tt];o.call(c,nt,tt)&&d.push(tt)},this),this._seriesIndices=d,this._seriesIndicesMap=createHashMap(d)},a.prototype.restoreData=function(o){reCreateSeriesIndices(this);var c=this._componentsMap,d=[];c.each(function(tt,nt){ComponentModel.hasClass(nt)&&d.push(nt)}),ComponentModel.topologicalTravel(d,ComponentModel.getAllClassMainTypes(),function(tt){each$f(c.get(tt),function(nt){nt&&(tt!=="series"||!isNotTargetSeries(nt,o))&&nt.restoreData()})})},a.internalField=function(){reCreateSeriesIndices=function(o){var c=o._seriesIndices=[];each$f(o._componentsMap.get("series"),function(d){d&&c.push(d.componentIndex)}),o._seriesIndicesMap=createHashMap(c)},assertSeriesInitialized=function(o){},initBase=function(o,c){o.option={},o.option[OPTION_INNER_KEY]=OPTION_INNER_VALUE,o._componentsMap=createHashMap({series:[]}),o._componentsCount=createHashMap();var d=c.aria;isObject$3(d)&&d.enabled==null&&(d.enabled=!0),mergeTheme(c,o._theme.option),merge(c,globalDefault,!1),o._mergeOption(c,null)}}(),a}(Model);function isNotTargetSeries(s,a){if(a){var o=a.seriesIndex,c=a.seriesId,d=a.seriesName;return o!=null&&s.componentIndex!==o||c!=null&&s.id!==c||d!=null&&s.name!==d}}function mergeTheme(s,a){var o=s.color&&!s.colorLayer;each$f(a,function(c,d){d==="colorLayer"&&o||ComponentModel.hasClass(d)||(typeof c=="object"?s[d]=s[d]?merge(s[d],c,!1):clone$4(c):s[d]==null&&(s[d]=c))})}function queryByIdOrName(s,a,o){if(isArray$1(a)){var c=createHashMap();return each$f(a,function(tt){if(tt!=null){var nt=convertOptionIdName(tt,null);nt!=null&&c.set(tt,!0)}}),filter(o,function(tt){return tt&&c.get(tt[s])})}else{var d=convertOptionIdName(a,null);return filter(o,function(tt){return tt&&d!=null&&tt[s]===d})}}function filterBySubType(s,a){return a.hasOwnProperty("subType")?filter(s,function(o){return o&&o.subType===a.subType}):s}function normalizeSetOptionInput(s){var a=createHashMap();return s&&each$f(normalizeToArray(s.replaceMerge),function(o){a.set(o,!0)}),{replaceMergeMainTypeMap:a}}mixin(GlobalModel,PaletteMixin);var availableMethods=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],ExtensionAPI=function(){function s(a){each$f(availableMethods,function(o){this[o]=bind$2(a[o],a)},this)}return s}(),coordinateSystemCreators={},CoordinateSystemManager=function(){function s(){this._coordinateSystems=[]}return s.prototype.create=function(a,o){var c=[];each$f(coordinateSystemCreators,function(d,tt){var nt=d.create(a,o);c=c.concat(nt||[])}),this._coordinateSystems=c},s.prototype.update=function(a,o){each$f(this._coordinateSystems,function(c){c.update&&c.update(a,o)})},s.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},s.register=function(a,o){coordinateSystemCreators[a]=o},s.get=function(a){return coordinateSystemCreators[a]},s}(),QUERY_REG=/^(min|max)?(.+)$/,OptionManager=function(){function s(a){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=a}return s.prototype.setOption=function(a,o,c){a&&(each$f(normalizeToArray(a.series),function(nt){nt&&nt.data&&isTypedArray(nt.data)&&setAsPrimitive(nt.data)}),each$f(normalizeToArray(a.dataset),function(nt){nt&&nt.source&&isTypedArray(nt.source)&&setAsPrimitive(nt.source)})),a=clone$4(a);var d=this._optionBackup,tt=parseRawOption(a,o,!d);this._newBaseOption=tt.baseOption,d?(tt.timelineOptions.length&&(d.timelineOptions=tt.timelineOptions),tt.mediaList.length&&(d.mediaList=tt.mediaList),tt.mediaDefault&&(d.mediaDefault=tt.mediaDefault)):this._optionBackup=tt},s.prototype.mountOption=function(a){var o=this._optionBackup;return this._timelineOptions=o.timelineOptions,this._mediaList=o.mediaList,this._mediaDefault=o.mediaDefault,this._currentMediaIndices=[],clone$4(a?o.baseOption:this._newBaseOption)},s.prototype.getTimelineOption=function(a){var o,c=this._timelineOptions;if(c.length){var d=a.getComponent("timeline");d&&(o=clone$4(c[d.getCurrentIndex()]))}return o},s.prototype.getMediaOption=function(a){var o=this._api.getWidth(),c=this._api.getHeight(),d=this._mediaList,tt=this._mediaDefault,nt=[],it=[];if(!d.length&&!tt)return it;for(var st=0,ut=d.length;st<ut;st++)applyMediaQuery(d[st].query,o,c)&&nt.push(st);return!nt.length&&tt&&(nt=[-1]),nt.length&&!indicesEquals(nt,this._currentMediaIndices)&&(it=map$1(nt,function(ct){return clone$4(ct===-1?tt.option:d[ct].option)})),this._currentMediaIndices=nt,it},s}();function parseRawOption(s,a,o){var c=[],d,tt,nt=s.baseOption,it=s.timeline,st=s.options,ut=s.media,ct=!!s.media,ot=!!(st||it||nt&&nt.timeline);nt?(tt=nt,tt.timeline||(tt.timeline=it)):((ot||ct)&&(s.options=s.media=null),tt=s),ct&&isArray$1(ut)&&each$f(ut,function(ht){ht&&ht.option&&(ht.query?c.push(ht):d||(d=ht))}),at(tt),each$f(st,function(ht){return at(ht)}),each$f(c,function(ht){return at(ht.option)});function at(ht){each$f(a,function(ft){ft(ht,o)})}return{baseOption:tt,timelineOptions:st||[],mediaDefault:d,mediaList:c}}function applyMediaQuery(s,a,o){var c={width:a,height:o,aspectratio:a/o},d=!0;return each$f(s,function(tt,nt){var it=nt.match(QUERY_REG);if(!(!it||!it[1]||!it[2])){var st=it[1],ut=it[2].toLowerCase();compare$1(c[ut],tt,st)||(d=!1)}}),d}function compare$1(s,a,o){return o==="min"?s>=a:o==="max"?s<=a:s===a}function indicesEquals(s,a){return s.join(",")===a.join(",")}var each$d=each$f,isObject$2=isObject$3,POSSIBLE_STYLES=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function compatEC2ItemStyle(s){var a=s&&s.itemStyle;if(a)for(var o=0,c=POSSIBLE_STYLES.length;o<c;o++){var d=POSSIBLE_STYLES[o],tt=a.normal,nt=a.emphasis;tt&&tt[d]&&(s[d]=s[d]||{},s[d].normal?merge(s[d].normal,tt[d]):s[d].normal=tt[d],tt[d]=null),nt&&nt[d]&&(s[d]=s[d]||{},s[d].emphasis?merge(s[d].emphasis,nt[d]):s[d].emphasis=nt[d],nt[d]=null)}}function convertNormalEmphasis(s,a,o){if(s&&s[a]&&(s[a].normal||s[a].emphasis)){var c=s[a].normal,d=s[a].emphasis;c&&(o?(s[a].normal=s[a].emphasis=null,defaults(s[a],c)):s[a]=c),d&&(s.emphasis=s.emphasis||{},s.emphasis[a]=d,d.focus&&(s.emphasis.focus=d.focus),d.blurScope&&(s.emphasis.blurScope=d.blurScope))}}function removeEC3NormalStatus(s){convertNormalEmphasis(s,"itemStyle"),convertNormalEmphasis(s,"lineStyle"),convertNormalEmphasis(s,"areaStyle"),convertNormalEmphasis(s,"label"),convertNormalEmphasis(s,"labelLine"),convertNormalEmphasis(s,"upperLabel"),convertNormalEmphasis(s,"edgeLabel")}function compatTextStyle(s,a){var o=isObject$2(s)&&s[a],c=isObject$2(o)&&o.textStyle;if(c)for(var d=0,tt=TEXT_STYLE_OPTIONS.length;d<tt;d++){var nt=TEXT_STYLE_OPTIONS[d];c.hasOwnProperty(nt)&&(o[nt]=c[nt])}}function compatEC3CommonStyles(s){s&&(removeEC3NormalStatus(s),compatTextStyle(s,"label"),s.emphasis&&compatTextStyle(s.emphasis,"label"))}function processSeries(s){if(isObject$2(s)){compatEC2ItemStyle(s),removeEC3NormalStatus(s),compatTextStyle(s,"label"),compatTextStyle(s,"upperLabel"),compatTextStyle(s,"edgeLabel"),s.emphasis&&(compatTextStyle(s.emphasis,"label"),compatTextStyle(s.emphasis,"upperLabel"),compatTextStyle(s.emphasis,"edgeLabel"));var a=s.markPoint;a&&(compatEC2ItemStyle(a),compatEC3CommonStyles(a));var o=s.markLine;o&&(compatEC2ItemStyle(o),compatEC3CommonStyles(o));var c=s.markArea;c&&compatEC3CommonStyles(c);var d=s.data;if(s.type==="graph"){d=d||s.nodes;var tt=s.links||s.edges;if(tt&&!isTypedArray(tt))for(var nt=0;nt<tt.length;nt++)compatEC3CommonStyles(tt[nt]);each$f(s.categories,function(ut){removeEC3NormalStatus(ut)})}if(d&&!isTypedArray(d))for(var nt=0;nt<d.length;nt++)compatEC3CommonStyles(d[nt]);if(a=s.markPoint,a&&a.data)for(var it=a.data,nt=0;nt<it.length;nt++)compatEC3CommonStyles(it[nt]);if(o=s.markLine,o&&o.data)for(var st=o.data,nt=0;nt<st.length;nt++)isArray$1(st[nt])?(compatEC3CommonStyles(st[nt][0]),compatEC3CommonStyles(st[nt][1])):compatEC3CommonStyles(st[nt]);s.type==="gauge"?(compatTextStyle(s,"axisLabel"),compatTextStyle(s,"title"),compatTextStyle(s,"detail")):s.type==="treemap"?(convertNormalEmphasis(s.breadcrumb,"itemStyle"),each$f(s.levels,function(ut){removeEC3NormalStatus(ut)})):s.type==="tree"&&removeEC3NormalStatus(s.leaves)}}function toArr(s){return isArray$1(s)?s:s?[s]:[]}function toObj(s){return(isArray$1(s)?s[0]:s)||{}}function globalCompatStyle(s,a){each$d(toArr(s.series),function(c){isObject$2(c)&&processSeries(c)});var o=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];a&&o.push("valueAxis","categoryAxis","logAxis","timeAxis"),each$d(o,function(c){each$d(toArr(s[c]),function(d){d&&(compatTextStyle(d,"axisLabel"),compatTextStyle(d.axisPointer,"label"))})}),each$d(toArr(s.parallel),function(c){var d=c&&c.parallelAxisDefault;compatTextStyle(d,"axisLabel"),compatTextStyle(d&&d.axisPointer,"label")}),each$d(toArr(s.calendar),function(c){convertNormalEmphasis(c,"itemStyle"),compatTextStyle(c,"dayLabel"),compatTextStyle(c,"monthLabel"),compatTextStyle(c,"yearLabel")}),each$d(toArr(s.radar),function(c){compatTextStyle(c,"name"),c.name&&c.axisName==null&&(c.axisName=c.name,delete c.name),c.nameGap!=null&&c.axisNameGap==null&&(c.axisNameGap=c.nameGap,delete c.nameGap)}),each$d(toArr(s.geo),function(c){isObject$2(c)&&(compatEC3CommonStyles(c),each$d(toArr(c.regions),function(d){compatEC3CommonStyles(d)}))}),each$d(toArr(s.timeline),function(c){compatEC3CommonStyles(c),convertNormalEmphasis(c,"label"),convertNormalEmphasis(c,"itemStyle"),convertNormalEmphasis(c,"controlStyle",!0);var d=c.data;isArray$1(d)&&each$f(d,function(tt){isObject$3(tt)&&(convertNormalEmphasis(tt,"label"),convertNormalEmphasis(tt,"itemStyle"))})}),each$d(toArr(s.toolbox),function(c){convertNormalEmphasis(c,"iconStyle"),each$d(c.feature,function(d){convertNormalEmphasis(d,"iconStyle")})}),compatTextStyle(toObj(s.axisPointer),"label"),compatTextStyle(toObj(s.tooltip).axisPointer,"label")}function get(s,a){for(var o=a.split(","),c=s,d=0;d<o.length&&(c=c&&c[o[d]],c!=null);d++);return c}function set(s,a,o,c){for(var d=a.split(","),tt=s,nt,it=0;it<d.length-1;it++)nt=d[it],tt[nt]==null&&(tt[nt]={}),tt=tt[nt];tt[d[it]]==null&&(tt[d[it]]=o)}function compatLayoutProperties(s){s&&each$f(LAYOUT_PROPERTIES,function(a){a[0]in s&&!(a[1]in s)&&(s[a[1]]=s[a[0]])})}var LAYOUT_PROPERTIES=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],COMPATITABLE_COMPONENTS=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],BAR_ITEM_STYLE_MAP=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function compatBarItemStyle(s){var a=s&&s.itemStyle;if(a)for(var o=0;o<BAR_ITEM_STYLE_MAP.length;o++){var c=BAR_ITEM_STYLE_MAP[o][1],d=BAR_ITEM_STYLE_MAP[o][0];a[c]!=null&&(a[d]=a[c])}}function compatPieLabel(s){s&&s.alignTo==="edge"&&s.margin!=null&&s.edgeDistance==null&&(s.edgeDistance=s.margin)}function compatSunburstState(s){s&&s.downplay&&!s.blur&&(s.blur=s.downplay)}function compatGraphFocus(s){s&&s.focusNodeAdjacency!=null&&(s.emphasis=s.emphasis||{},s.emphasis.focus==null&&(s.emphasis.focus="adjacency"))}function traverseTree(s,a){if(s)for(var o=0;o<s.length;o++)a(s[o]),s[o]&&traverseTree(s[o].children,a)}function globalBackwardCompat(s,a){globalCompatStyle(s,a),s.series=normalizeToArray(s.series),each$f(s.series,function(o){if(isObject$3(o)){var c=o.type;if(c==="line")o.clipOverflow!=null&&(o.clip=o.clipOverflow);else if(c==="pie"||c==="gauge"){o.clockWise!=null&&(o.clockwise=o.clockWise),compatPieLabel(o.label);var d=o.data;if(d&&!isTypedArray(d))for(var tt=0;tt<d.length;tt++)compatPieLabel(d[tt]);o.hoverOffset!=null&&(o.emphasis=o.emphasis||{},(o.emphasis.scaleSize=null)&&(o.emphasis.scaleSize=o.hoverOffset))}else if(c==="gauge"){var nt=get(o,"pointer.color");nt!=null&&set(o,"itemStyle.color",nt)}else if(c==="bar"){compatBarItemStyle(o),compatBarItemStyle(o.backgroundStyle),compatBarItemStyle(o.emphasis);var d=o.data;if(d&&!isTypedArray(d))for(var tt=0;tt<d.length;tt++)typeof d[tt]=="object"&&(compatBarItemStyle(d[tt]),compatBarItemStyle(d[tt]&&d[tt].emphasis))}else if(c==="sunburst"){var it=o.highlightPolicy;it&&(o.emphasis=o.emphasis||{},o.emphasis.focus||(o.emphasis.focus=it)),compatSunburstState(o),traverseTree(o.data,compatSunburstState)}else c==="graph"||c==="sankey"?compatGraphFocus(o):c==="map"&&(o.mapType&&!o.map&&(o.map=o.mapType),o.mapLocation&&defaults(o,o.mapLocation));o.hoverAnimation!=null&&(o.emphasis=o.emphasis||{},o.emphasis&&o.emphasis.scale==null&&(o.emphasis.scale=o.hoverAnimation)),compatLayoutProperties(o)}}),s.dataRange&&(s.visualMap=s.dataRange),each$f(COMPATITABLE_COMPONENTS,function(o){var c=s[o];c&&(isArray$1(c)||(c=[c]),each$f(c,function(d){compatLayoutProperties(d)}))})}function dataStack$1(s){var a=createHashMap();s.eachSeries(function(o){var c=o.get("stack");if(c){var d=a.get(c)||a.set(c,[]),tt=o.getData(),nt={stackResultDimension:tt.getCalculationInfo("stackResultDimension"),stackedOverDimension:tt.getCalculationInfo("stackedOverDimension"),stackedDimension:tt.getCalculationInfo("stackedDimension"),stackedByDimension:tt.getCalculationInfo("stackedByDimension"),isStackedByIndex:tt.getCalculationInfo("isStackedByIndex"),data:tt,seriesModel:o};if(!nt.stackedDimension||!(nt.isStackedByIndex||nt.stackedByDimension))return;d.length&&tt.setCalculationInfo("stackedOnSeries",d[d.length-1].seriesModel),d.push(nt)}}),a.each(calculateStack)}function calculateStack(s){each$f(s,function(a,o){var c=[],d=[NaN,NaN],tt=[a.stackResultDimension,a.stackedOverDimension],nt=a.data,it=a.isStackedByIndex,st=a.seriesModel.get("stackStrategy")||"samesign";nt.modify(tt,function(ut,ct,ot){var at=nt.get(a.stackedDimension,ot);if(isNaN(at))return d;var ht,ft;it?ft=nt.getRawIndex(ot):ht=nt.get(a.stackedByDimension,ot);for(var mt=NaN,yt=o-1;yt>=0;yt--){var bt=s[yt];if(it||(ft=bt.data.rawIndexOf(bt.stackedByDimension,ht)),ft>=0){var wt=bt.data.getByRawIndex(bt.stackResultDimension,ft);if(st==="all"||st==="positive"&&wt>0||st==="negative"&&wt<0||st==="samesign"&&at>=0&&wt>0||st==="samesign"&&at<=0&&wt<0){at=addSafe(at,wt),mt=wt;break}}}return c[0]=at,c[1]=mt,c})})}var SourceImpl=function(){function s(a){this.data=a.data||(a.sourceFormat===SOURCE_FORMAT_KEYED_COLUMNS?{}:[]),this.sourceFormat=a.sourceFormat||SOURCE_FORMAT_UNKNOWN,this.seriesLayoutBy=a.seriesLayoutBy||SERIES_LAYOUT_BY_COLUMN,this.startIndex=a.startIndex||0,this.dimensionsDetectedCount=a.dimensionsDetectedCount,this.metaRawOption=a.metaRawOption;var o=this.dimensionsDefine=a.dimensionsDefine;if(o)for(var c=0;c<o.length;c++){var d=o[c];d.type==null&&guessOrdinal(this,c)===BE_ORDINAL.Must&&(d.type="ordinal")}}return s}();function isSourceInstance(s){return s instanceof SourceImpl}function createSource(s,a,o){o=o||detectSourceFormat(s);var c=a.seriesLayoutBy,d=determineSourceDimensions(s,o,c,a.sourceHeader,a.dimensions),tt=new SourceImpl({data:s,sourceFormat:o,seriesLayoutBy:c,dimensionsDefine:d.dimensionsDefine,startIndex:d.startIndex,dimensionsDetectedCount:d.dimensionsDetectedCount,metaRawOption:clone$4(a)});return tt}function createSourceFromSeriesDataOption(s){return new SourceImpl({data:s,sourceFormat:isTypedArray(s)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL})}function cloneSourceShallow(s){return new SourceImpl({data:s.data,sourceFormat:s.sourceFormat,seriesLayoutBy:s.seriesLayoutBy,dimensionsDefine:clone$4(s.dimensionsDefine),startIndex:s.startIndex,dimensionsDetectedCount:s.dimensionsDetectedCount})}function detectSourceFormat(s){var a=SOURCE_FORMAT_UNKNOWN;if(isTypedArray(s))a=SOURCE_FORMAT_TYPED_ARRAY;else if(isArray$1(s)){s.length===0&&(a=SOURCE_FORMAT_ARRAY_ROWS);for(var o=0,c=s.length;o<c;o++){var d=s[o];if(d!=null){if(isArray$1(d)||isTypedArray(d)){a=SOURCE_FORMAT_ARRAY_ROWS;break}else if(isObject$3(d)){a=SOURCE_FORMAT_OBJECT_ROWS;break}}}}else if(isObject$3(s)){for(var tt in s)if(hasOwn(s,tt)&&isArrayLike(s[tt])){a=SOURCE_FORMAT_KEYED_COLUMNS;break}}return a}function determineSourceDimensions(s,a,o,c,d){var tt,nt;if(!s)return{dimensionsDefine:normalizeDimensionsOption(d),startIndex:nt,dimensionsDetectedCount:tt};if(a===SOURCE_FORMAT_ARRAY_ROWS){var it=s;c==="auto"||c==null?arrayRowsTravelFirst(function(ut){ut!=null&&ut!=="-"&&(isString$1(ut)?nt==null&&(nt=1):nt=0)},o,it,10):nt=isNumber(c)?c:c?1:0,!d&&nt===1&&(d=[],arrayRowsTravelFirst(function(ut,ct){d[ct]=ut!=null?ut+"":""},o,it,1/0)),tt=d?d.length:o===SERIES_LAYOUT_BY_ROW?it.length:it[0]?it[0].length:null}else if(a===SOURCE_FORMAT_OBJECT_ROWS)d||(d=objectRowsCollectDimensions(s));else if(a===SOURCE_FORMAT_KEYED_COLUMNS)d||(d=[],each$f(s,function(ut,ct){d.push(ct)}));else if(a===SOURCE_FORMAT_ORIGINAL){var st=getDataItemValue(s[0]);tt=isArray$1(st)&&st.length||1}return{startIndex:nt,dimensionsDefine:normalizeDimensionsOption(d),dimensionsDetectedCount:tt}}function objectRowsCollectDimensions(s){for(var a=0,o;a<s.length&&!(o=s[a++]););if(o)return keys(o)}function normalizeDimensionsOption(s){if(s){var a=createHashMap();return map$1(s,function(o,c){o=isObject$3(o)?o:{name:o};var d={name:o.name,displayName:o.displayName,type:o.type};if(d.name==null)return d;d.name+="",d.displayName==null&&(d.displayName=d.name);var tt=a.get(d.name);return tt?d.name+="-"+tt.count++:a.set(d.name,{count:1}),d})}}function arrayRowsTravelFirst(s,a,o,c){if(a===SERIES_LAYOUT_BY_ROW)for(var d=0;d<o.length&&d<c;d++)s(o[d]?o[d][0]:null,d);else for(var tt=o[0]||[],d=0;d<tt.length&&d<c;d++)s(tt[d],d)}function shouldRetrieveDataByName(s){var a=s.sourceFormat;return a===SOURCE_FORMAT_OBJECT_ROWS||a===SOURCE_FORMAT_KEYED_COLUMNS}var _a$1,_b$1,_c,providerMethods,mountMethods,DefaultDataProvider=function(){function s(a,o){var c=isSourceInstance(a)?a:createSourceFromSeriesDataOption(a);this._source=c;var d=this._data=c.data;c.sourceFormat===SOURCE_FORMAT_TYPED_ARRAY&&(this._offset=0,this._dimSize=o,this._data=d),mountMethods(this,d,c)}return s.prototype.getSource=function(){return this._source},s.prototype.count=function(){return 0},s.prototype.getItem=function(a,o){},s.prototype.appendData=function(a){},s.prototype.clean=function(){},s.protoInitialize=function(){var a=s.prototype;a.pure=!1,a.persistent=!0}(),s.internalField=function(){var a;mountMethods=function(nt,it,st){var ut=st.sourceFormat,ct=st.seriesLayoutBy,ot=st.startIndex,at=st.dimensionsDefine,ht=providerMethods[getMethodMapKey(ut,ct)];if(extend(nt,ht),ut===SOURCE_FORMAT_TYPED_ARRAY)nt.getItem=o,nt.count=d,nt.fillStorage=c;else{var ft=getRawSourceItemGetter(ut,ct);nt.getItem=bind$2(ft,null,it,ot,at);var mt=getRawSourceDataCounter(ut,ct);nt.count=bind$2(mt,null,it,ot,at)}};var o=function(nt,it){nt=nt-this._offset,it=it||[];for(var st=this._data,ut=this._dimSize,ct=ut*nt,ot=0;ot<ut;ot++)it[ot]=st[ct+ot];return it},c=function(nt,it,st,ut){for(var ct=this._data,ot=this._dimSize,at=0;at<ot;at++){for(var ht=ut[at],ft=ht[0]==null?1/0:ht[0],mt=ht[1]==null?-1/0:ht[1],yt=it-nt,bt=st[at],wt=0;wt<yt;wt++){var Tt=ct[wt*ot+at];bt[nt+wt]=Tt,Tt<ft&&(ft=Tt),Tt>mt&&(mt=Tt)}ht[0]=ft,ht[1]=mt}},d=function(){return this._data?this._data.length/this._dimSize:0};providerMethods=(a={},a[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]={pure:!0,appendData:tt},a[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},a[SOURCE_FORMAT_OBJECT_ROWS]={pure:!0,appendData:tt},a[SOURCE_FORMAT_KEYED_COLUMNS]={pure:!0,appendData:function(nt){var it=this._data;each$f(nt,function(st,ut){for(var ct=it[ut]||(it[ut]=[]),ot=0;ot<(st||[]).length;ot++)ct.push(st[ot])})}},a[SOURCE_FORMAT_ORIGINAL]={appendData:tt},a[SOURCE_FORMAT_TYPED_ARRAY]={persistent:!1,pure:!0,appendData:function(nt){this._data=nt},clean:function(){this._offset+=this.count(),this._data=null}},a);function tt(nt){for(var it=0;it<nt.length;it++)this._data.push(nt[it])}}(),s}(),getItemSimply=function(s,a,o,c){return s[c]},rawSourceItemGetterMap=(_a$1={},_a$1[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(s,a,o,c){return s[c+a]},_a$1[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(s,a,o,c,d){c+=a;for(var tt=d||[],nt=s,it=0;it<nt.length;it++){var st=nt[it];tt[it]=st?st[c]:null}return tt},_a$1[SOURCE_FORMAT_OBJECT_ROWS]=getItemSimply,_a$1[SOURCE_FORMAT_KEYED_COLUMNS]=function(s,a,o,c,d){for(var tt=d||[],nt=0;nt<o.length;nt++){var it=o[nt].name,st=s[it];tt[nt]=st?st[c]:null}return tt},_a$1[SOURCE_FORMAT_ORIGINAL]=getItemSimply,_a$1);function getRawSourceItemGetter(s,a){var o=rawSourceItemGetterMap[getMethodMapKey(s,a)];return o}var countSimply=function(s,a,o){return s.length},rawSourceDataCounterMap=(_b$1={},_b$1[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(s,a,o){return Math.max(0,s.length-a)},_b$1[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(s,a,o){var c=s[0];return c?Math.max(0,c.length-a):0},_b$1[SOURCE_FORMAT_OBJECT_ROWS]=countSimply,_b$1[SOURCE_FORMAT_KEYED_COLUMNS]=function(s,a,o){var c=o[0].name,d=s[c];return d?d.length:0},_b$1[SOURCE_FORMAT_ORIGINAL]=countSimply,_b$1);function getRawSourceDataCounter(s,a){var o=rawSourceDataCounterMap[getMethodMapKey(s,a)];return o}var getRawValueSimply=function(s,a,o){return s[a]},rawSourceValueGetterMap=(_c={},_c[SOURCE_FORMAT_ARRAY_ROWS]=getRawValueSimply,_c[SOURCE_FORMAT_OBJECT_ROWS]=function(s,a,o){return s[o]},_c[SOURCE_FORMAT_KEYED_COLUMNS]=getRawValueSimply,_c[SOURCE_FORMAT_ORIGINAL]=function(s,a,o){var c=getDataItemValue(s);return c instanceof Array?c[a]:c},_c[SOURCE_FORMAT_TYPED_ARRAY]=getRawValueSimply,_c);function getRawSourceValueGetter(s){var a=rawSourceValueGetterMap[s];return a}function getMethodMapKey(s,a){return s===SOURCE_FORMAT_ARRAY_ROWS?s+"_"+a:s}function retrieveRawValue(s,a,o){if(s){var c=s.getRawDataItem(a);if(c!=null){var d=s.getStore(),tt=d.getSource().sourceFormat;if(o!=null){var nt=s.getDimensionIndex(o),it=d.getDimensionProperty(nt);return getRawSourceValueGetter(tt)(c,nt,it)}else{var st=c;return tt===SOURCE_FORMAT_ORIGINAL&&(st=getDataItemValue(c)),st}}}}var DIMENSION_LABEL_REG=/\{@(.+?)\}/g,DataFormatMixin=function(){function s(){}return s.prototype.getDataParams=function(a,o){var c=this.getData(o),d=this.getRawValue(a,o),tt=c.getRawIndex(a),nt=c.getName(a),it=c.getRawDataItem(a),st=c.getItemVisual(a,"style"),ut=st&&st[c.getItemVisual(a,"drawType")||"fill"],ct=st&&st.stroke,ot=this.mainType,at=ot==="series",ht=c.userOutput&&c.userOutput.get();return{componentType:ot,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:at?this.subType:null,seriesIndex:this.seriesIndex,seriesId:at?this.id:null,seriesName:at?this.name:null,name:nt,dataIndex:tt,data:it,dataType:o,value:d,color:ut,borderColor:ct,dimensionNames:ht?ht.fullDimensions:null,encode:ht?ht.encode:null,$vars:["seriesName","name","value"]}},s.prototype.getFormattedLabel=function(a,o,c,d,tt,nt){o=o||"normal";var it=this.getData(c),st=this.getDataParams(a,c);if(nt&&(st.value=nt.interpolatedValue),d!=null&&isArray$1(st.value)&&(st.value=st.value[d]),!tt){var ut=it.getItemModel(a);tt=ut.get(o==="normal"?["label","formatter"]:[o,"label","formatter"])}if(isFunction$1(tt))return st.status=o,st.dimensionIndex=d,tt(st);if(isString$1(tt)){var ct=formatTpl(tt,st);return ct.replace(DIMENSION_LABEL_REG,function(ot,at){var ht=at.length,ft=at;ft.charAt(0)==="["&&ft.charAt(ht-1)==="]"&&(ft=+ft.slice(1,ht-1));var mt=retrieveRawValue(it,a,ft);if(nt&&isArray$1(nt.interpolatedValue)){var yt=it.getDimensionIndex(ft);yt>=0&&(mt=nt.interpolatedValue[yt])}return mt!=null?mt+"":""})}},s.prototype.getRawValue=function(a,o){return retrieveRawValue(this.getData(o),a)},s.prototype.formatTooltip=function(a,o,c){},s}();function normalizeTooltipFormatResult(s){var a,o;return isObject$3(s)?s.type&&(o=s):a=s,{text:a,frag:o}}function createTask(s){return new Task(s)}var Task=function(){function s(a){a=a||{},this._reset=a.reset,this._plan=a.plan,this._count=a.count,this._onDirty=a.onDirty,this._dirty=!0}return s.prototype.perform=function(a){var o=this._upstream,c=a&&a.skip;if(this._dirty&&o){var d=this.context;d.data=d.outputData=o.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var tt;this._plan&&!c&&(tt=this._plan(this.context));var nt=ct(this._modBy),it=this._modDataCount||0,st=ct(a&&a.modBy),ut=a&&a.modDataCount||0;(nt!==st||it!==ut)&&(tt="reset");function ct(wt){return!(wt>=1)&&(wt=1),wt}var ot;(this._dirty||tt==="reset")&&(this._dirty=!1,ot=this._doReset(c)),this._modBy=st,this._modDataCount=ut;var at=a&&a.step;if(o?this._dueEnd=o._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var ht=this._dueIndex,ft=Math.min(at!=null?this._dueIndex+at:1/0,this._dueEnd);if(!c&&(ot||ht<ft)){var mt=this._progress;if(isArray$1(mt))for(var yt=0;yt<mt.length;yt++)this._doProgress(mt[yt],ht,ft,st,ut);else this._doProgress(mt,ht,ft,st,ut)}this._dueIndex=ft;var bt=this._settedOutputEnd!=null?this._settedOutputEnd:ft;this._outputDueEnd=bt}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},s.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},s.prototype._doProgress=function(a,o,c,d,tt){iterator.reset(o,c,d,tt),this._callingProgress=a,this._callingProgress({start:o,end:c,count:c-o,next:iterator.next},this.context)},s.prototype._doReset=function(a){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var o,c;!a&&this._reset&&(o=this._reset(this.context),o&&o.progress&&(c=o.forceFirstProgress,o=o.progress),isArray$1(o)&&!o.length&&(o=null)),this._progress=o,this._modBy=this._modDataCount=null;var d=this._downstream;return d&&d.dirty(),c},s.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},s.prototype.pipe=function(a){(this._downstream!==a||this._dirty)&&(this._downstream=a,a._upstream=this,a.dirty())},s.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},s.prototype.getUpstream=function(){return this._upstream},s.prototype.getDownstream=function(){return this._downstream},s.prototype.setOutputEnd=function(a){this._outputDueEnd=this._settedOutputEnd=a},s}(),iterator=function(){var s,a,o,c,d,tt={reset:function(st,ut,ct,ot){a=st,s=ut,o=ct,c=ot,d=Math.ceil(c/o),tt.next=o>1&&c>0?it:nt}};return tt;function nt(){return a<s?a++:null}function it(){var st=a%d*o+Math.ceil(a/d),ut=a>=s?null:st<c?st:a;return a++,ut}}();function parseDataValue(s,a){var o=a&&a.type;return o==="ordinal"?s:(o==="time"&&!isNumber(s)&&s!=null&&s!=="-"&&(s=+parseDate(s)),s==null||s===""?NaN:Number(s))}var valueParserMap=createHashMap({number:function(s){return parseFloat(s)},time:function(s){return+parseDate(s)},trim:function(s){return isString$1(s)?trim$1(s):s}});function getRawValueParser(s){return valueParserMap.get(s)}var ORDER_COMPARISON_OP_MAP={lt:function(s,a){return s<a},lte:function(s,a){return s<=a},gt:function(s,a){return s>a},gte:function(s,a){return s>=a}},FilterOrderComparator=function(){function s(a,o){if(!isNumber(o)){var c="";throwError(c)}this._opFn=ORDER_COMPARISON_OP_MAP[a],this._rvalFloat=numericToNumber(o)}return s.prototype.evaluate=function(a){return isNumber(a)?this._opFn(a,this._rvalFloat):this._opFn(numericToNumber(a),this._rvalFloat)},s}(),SortOrderComparator=function(){function s(a,o){var c=a==="desc";this._resultLT=c?1:-1,o==null&&(o=c?"min":"max"),this._incomparable=o==="min"?-1/0:1/0}return s.prototype.evaluate=function(a,o){var c=isNumber(a)?a:numericToNumber(a),d=isNumber(o)?o:numericToNumber(o),tt=isNaN(c),nt=isNaN(d);if(tt&&(c=this._incomparable),nt&&(d=this._incomparable),tt&&nt){var it=isString$1(a),st=isString$1(o);it&&(c=st?a:0),st&&(d=it?o:0)}return c<d?this._resultLT:c>d?-this._resultLT:0},s}(),FilterEqualityComparator=function(){function s(a,o){this._rval=o,this._isEQ=a,this._rvalTypeof=typeof o,this._rvalFloat=numericToNumber(o)}return s.prototype.evaluate=function(a){var o=a===this._rval;if(!o){var c=typeof a;c!==this._rvalTypeof&&(c==="number"||this._rvalTypeof==="number")&&(o=numericToNumber(a)===this._rvalFloat)}return this._isEQ?o:!o},s}();function createFilterComparator(s,a){return s==="eq"||s==="ne"?new FilterEqualityComparator(s==="eq",a):hasOwn(ORDER_COMPARISON_OP_MAP,s)?new FilterOrderComparator(s,a):null}var ExternalSource=function(){function s(){}return s.prototype.getRawData=function(){throw new Error("not supported")},s.prototype.getRawDataItem=function(a){throw new Error("not supported")},s.prototype.cloneRawData=function(){},s.prototype.getDimensionInfo=function(a){},s.prototype.cloneAllDimensionInfo=function(){},s.prototype.count=function(){},s.prototype.retrieveValue=function(a,o){},s.prototype.retrieveValueFromItem=function(a,o){},s.prototype.convertValue=function(a,o){return parseDataValue(a,o)},s}();function createExternalSource(s,a){var o=new ExternalSource,c=s.data,d=o.sourceFormat=s.sourceFormat,tt=s.startIndex,nt="";s.seriesLayoutBy!==SERIES_LAYOUT_BY_COLUMN&&throwError(nt);var it=[],st={},ut=s.dimensionsDefine;if(ut)each$f(ut,function(mt,yt){var bt=mt.name,wt={index:yt,name:bt,displayName:mt.displayName};if(it.push(wt),bt!=null){var Tt="";hasOwn(st,bt)&&throwError(Tt),st[bt]=wt}});else for(var ct=0;ct<s.dimensionsDetectedCount;ct++)it.push({index:ct});var ot=getRawSourceItemGetter(d,SERIES_LAYOUT_BY_COLUMN);a.__isBuiltIn&&(o.getRawDataItem=function(mt){return ot(c,tt,it,mt)},o.getRawData=bind$2(getRawData,null,s)),o.cloneRawData=bind$2(cloneRawData,null,s);var at=getRawSourceDataCounter(d,SERIES_LAYOUT_BY_COLUMN);o.count=bind$2(at,null,c,tt,it);var ht=getRawSourceValueGetter(d);o.retrieveValue=function(mt,yt){var bt=ot(c,tt,it,mt);return ft(bt,yt)};var ft=o.retrieveValueFromItem=function(mt,yt){if(mt!=null){var bt=it[yt];if(bt)return ht(mt,yt,bt.name)}};return o.getDimensionInfo=bind$2(getDimensionInfo,null,it,st),o.cloneAllDimensionInfo=bind$2(cloneAllDimensionInfo,null,it),o}function getRawData(s){var a=s.sourceFormat;if(!isSupportedSourceFormat(a)){var o="";throwError(o)}return s.data}function cloneRawData(s){var a=s.sourceFormat,o=s.data;if(!isSupportedSourceFormat(a)){var c="";throwError(c)}if(a===SOURCE_FORMAT_ARRAY_ROWS){for(var d=[],tt=0,nt=o.length;tt<nt;tt++)d.push(o[tt].slice());return d}else if(a===SOURCE_FORMAT_OBJECT_ROWS){for(var d=[],tt=0,nt=o.length;tt<nt;tt++)d.push(extend({},o[tt]));return d}}function getDimensionInfo(s,a,o){if(o!=null){if(isNumber(o)||!isNaN(o)&&!hasOwn(a,o))return s[o];if(hasOwn(a,o))return a[o]}}function cloneAllDimensionInfo(s){return clone$4(s)}var externalTransformMap=createHashMap();function registerExternalTransform(s){s=clone$4(s);var a=s.type,o="";a||throwError(o);var c=a.split(":");c.length!==2&&throwError(o);var d=!1;c[0]==="echarts"&&(a=c[1],d=!0),s.__isBuiltIn=d,externalTransformMap.set(a,s)}function applyDataTransform(s,a,o){var c=normalizeToArray(s),d=c.length,tt="";d||throwError(tt);for(var nt=0,it=d;nt<it;nt++){var st=c[nt];a=applySingleDataTransform(st,a),nt!==it-1&&(a.length=Math.max(a.length,1))}return a}function applySingleDataTransform(s,a,o,c){var d="";a.length||throwError(d),isObject$3(s)||throwError(d);var tt=s.type,nt=externalTransformMap.get(tt);nt||throwError(d);var it=map$1(a,function(ut){return createExternalSource(ut,nt)}),st=normalizeToArray(nt.transform({upstream:it[0],upstreamList:it,config:clone$4(s.config)}));return map$1(st,function(ut,ct){var ot="";isObject$3(ut)||throwError(ot),ut.data||throwError(ot);var at=detectSourceFormat(ut.data);isSupportedSourceFormat(at)||throwError(ot);var ht,ft=a[0];if(ft&&ct===0&&!ut.dimensions){var mt=ft.startIndex;mt&&(ut.data=ft.data.slice(0,mt).concat(ut.data)),ht={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:mt,dimensions:ft.metaRawOption.dimensions}}else ht={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:0,dimensions:ut.dimensions};return createSource(ut.data,ht,null)})}function isSupportedSourceFormat(s){return s===SOURCE_FORMAT_ARRAY_ROWS||s===SOURCE_FORMAT_OBJECT_ROWS}var UNDEFINED="undefined",CtorUint32Array=typeof Uint32Array===UNDEFINED?Array:Uint32Array,CtorUint16Array=typeof Uint16Array===UNDEFINED?Array:Uint16Array,CtorInt32Array$1=typeof Int32Array===UNDEFINED?Array:Int32Array,CtorFloat64Array=typeof Float64Array===UNDEFINED?Array:Float64Array,dataCtors={float:CtorFloat64Array,int:CtorInt32Array$1,ordinal:Array,number:Array,time:CtorFloat64Array},defaultDimValueGetters;function getIndicesCtor(s){return s>65535?CtorUint32Array:CtorUint16Array}function getInitialExtent(){return[1/0,-1/0]}function cloneChunk(s){var a=s.constructor;return a===Array?s.slice():new a(s)}function prepareStore(s,a,o,c,d){var tt=dataCtors[o||"float"];if(d){var nt=s[a],it=nt&&nt.length;if(it!==c){for(var st=new tt(c),ut=0;ut<it;ut++)st[ut]=nt[ut];s[a]=st}}else s[a]=new tt(c)}var DataStore=function(){function s(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=createHashMap()}return s.prototype.initData=function(a,o,c){this._provider=a,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var d=a.getSource(),tt=this.defaultDimValueGetter=defaultDimValueGetters[d.sourceFormat];this._dimValueGetter=c||tt,this._rawExtent=[],shouldRetrieveDataByName(d),this._dimensions=map$1(o,function(nt){return{type:nt.type,property:nt.property}}),this._initDataFromProvider(0,a.count())},s.prototype.getProvider=function(){return this._provider},s.prototype.getSource=function(){return this._provider.getSource()},s.prototype.ensureCalculationDimension=function(a,o){var c=this._calcDimNameToIdx,d=this._dimensions,tt=c.get(a);if(tt!=null){if(d[tt].type===o)return tt}else tt=d.length;return d[tt]={type:o},c.set(a,tt),this._chunks[tt]=new dataCtors[o||"float"](this._rawCount),this._rawExtent[tt]=getInitialExtent(),tt},s.prototype.collectOrdinalMeta=function(a,o){var c=this._chunks[a],d=this._dimensions[a],tt=this._rawExtent,nt=d.ordinalOffset||0,it=c.length;nt===0&&(tt[a]=getInitialExtent());for(var st=tt[a],ut=nt;ut<it;ut++){var ct=c[ut]=o.parseAndCollect(c[ut]);isNaN(ct)||(st[0]=Math.min(ct,st[0]),st[1]=Math.max(ct,st[1]))}d.ordinalMeta=o,d.ordinalOffset=it,d.type="ordinal"},s.prototype.getOrdinalMeta=function(a){var o=this._dimensions[a],c=o.ordinalMeta;return c},s.prototype.getDimensionProperty=function(a){var o=this._dimensions[a];return o&&o.property},s.prototype.appendData=function(a){var o=this._provider,c=this.count();o.appendData(a);var d=o.count();return o.persistent||(d+=c),c<d&&this._initDataFromProvider(c,d,!0),[c,d]},s.prototype.appendValues=function(a,o){for(var c=this._chunks,d=this._dimensions,tt=d.length,nt=this._rawExtent,it=this.count(),st=it+Math.max(a.length,o||0),ut=0;ut<tt;ut++){var ct=d[ut];prepareStore(c,ut,ct.type,st,!0)}for(var ot=[],at=it;at<st;at++)for(var ht=at-it,ft=0;ft<tt;ft++){var ct=d[ft],mt=defaultDimValueGetters.arrayRows.call(this,a[ht]||ot,ct.property,ht,ft);c[ft][at]=mt;var yt=nt[ft];mt<yt[0]&&(yt[0]=mt),mt>yt[1]&&(yt[1]=mt)}return this._rawCount=this._count=st,{start:it,end:st}},s.prototype._initDataFromProvider=function(a,o,c){for(var d=this._provider,tt=this._chunks,nt=this._dimensions,it=nt.length,st=this._rawExtent,ut=map$1(nt,function(wt){return wt.property}),ct=0;ct<it;ct++){var ot=nt[ct];st[ct]||(st[ct]=getInitialExtent()),prepareStore(tt,ct,ot.type,o,c)}if(d.fillStorage)d.fillStorage(a,o,tt,st);else for(var at=[],ht=a;ht<o;ht++){at=d.getItem(ht,at);for(var ft=0;ft<it;ft++){var mt=tt[ft],yt=this._dimValueGetter(at,ut[ft],ht,ft);mt[ht]=yt;var bt=st[ft];yt<bt[0]&&(bt[0]=yt),yt>bt[1]&&(bt[1]=yt)}}!d.persistent&&d.clean&&d.clean(),this._rawCount=this._count=o,this._extent=[]},s.prototype.count=function(){return this._count},s.prototype.get=function(a,o){if(!(o>=0&&o<this._count))return NaN;var c=this._chunks[a];return c?c[this.getRawIndex(o)]:NaN},s.prototype.getValues=function(a,o){var c=[],d=[];if(o==null){o=a,a=[];for(var tt=0;tt<this._dimensions.length;tt++)d.push(tt)}else d=a;for(var tt=0,nt=d.length;tt<nt;tt++)c.push(this.get(d[tt],o));return c},s.prototype.getByRawIndex=function(a,o){if(!(o>=0&&o<this._rawCount))return NaN;var c=this._chunks[a];return c?c[o]:NaN},s.prototype.getSum=function(a){var o=this._chunks[a],c=0;if(o)for(var d=0,tt=this.count();d<tt;d++){var nt=this.get(a,d);isNaN(nt)||(c+=nt)}return c},s.prototype.getMedian=function(a){var o=[];this.each([a],function(tt){isNaN(tt)||o.push(tt)});var c=o.sort(function(tt,nt){return tt-nt}),d=this.count();return d===0?0:d%2===1?c[(d-1)/2]:(c[d/2]+c[d/2-1])/2},s.prototype.indexOfRawIndex=function(a){if(a>=this._rawCount||a<0)return-1;if(!this._indices)return a;var o=this._indices,c=o[a];if(c!=null&&c<this._count&&c===a)return a;for(var d=0,tt=this._count-1;d<=tt;){var nt=(d+tt)/2|0;if(o[nt]<a)d=nt+1;else if(o[nt]>a)tt=nt-1;else return nt}return-1},s.prototype.indicesOfNearest=function(a,o,c){var d=this._chunks,tt=d[a],nt=[];if(!tt)return nt;c==null&&(c=1/0);for(var it=1/0,st=-1,ut=0,ct=0,ot=this.count();ct<ot;ct++){var at=this.getRawIndex(ct),ht=o-tt[at],ft=Math.abs(ht);ft<=c&&((ft<it||ft===it&&ht>=0&&st<0)&&(it=ft,st=ht,ut=0),ht===st&&(nt[ut++]=ct))}return nt.length=ut,nt},s.prototype.getIndices=function(){var a,o=this._indices;if(o){var c=o.constructor,d=this._count;if(c===Array){a=new c(d);for(var tt=0;tt<d;tt++)a[tt]=o[tt]}else a=new c(o.buffer,0,d)}else{var c=getIndicesCtor(this._rawCount);a=new c(this.count());for(var tt=0;tt<a.length;tt++)a[tt]=tt}return a},s.prototype.filter=function(a,o){if(!this._count)return this;for(var c=this.clone(),d=c.count(),tt=getIndicesCtor(c._rawCount),nt=new tt(d),it=[],st=a.length,ut=0,ct=a[0],ot=c._chunks,at=0;at<d;at++){var ht=void 0,ft=c.getRawIndex(at);if(st===0)ht=o(at);else if(st===1){var mt=ot[ct][ft];ht=o(mt,at)}else{for(var yt=0;yt<st;yt++)it[yt]=ot[a[yt]][ft];it[yt]=at,ht=o.apply(null,it)}ht&&(nt[ut++]=ft)}return ut<d&&(c._indices=nt),c._count=ut,c._extent=[],c._updateGetRawIdx(),c},s.prototype.selectRange=function(a){var o=this.clone(),c=o._count;if(!c)return this;var d=keys(a),tt=d.length;if(!tt)return this;var nt=o.count(),it=getIndicesCtor(o._rawCount),st=new it(nt),ut=0,ct=d[0],ot=a[ct][0],at=a[ct][1],ht=o._chunks,ft=!1;if(!o._indices){var mt=0;if(tt===1){for(var yt=ht[d[0]],bt=0;bt<c;bt++){var wt=yt[bt];(wt>=ot&&wt<=at||isNaN(wt))&&(st[ut++]=mt),mt++}ft=!0}else if(tt===2){for(var yt=ht[d[0]],Tt=ht[d[1]],Ct=a[d[1]][0],Dt=a[d[1]][1],bt=0;bt<c;bt++){var wt=yt[bt],Ot=Tt[bt];(wt>=ot&&wt<=at||isNaN(wt))&&(Ot>=Ct&&Ot<=Dt||isNaN(Ot))&&(st[ut++]=mt),mt++}ft=!0}}if(!ft)if(tt===1)for(var bt=0;bt<nt;bt++){var $t=o.getRawIndex(bt),wt=ht[d[0]][$t];(wt>=ot&&wt<=at||isNaN(wt))&&(st[ut++]=$t)}else for(var bt=0;bt<nt;bt++){for(var Ft=!0,$t=o.getRawIndex(bt),kt=0;kt<tt;kt++){var Vt=d[kt],wt=ht[Vt][$t];(wt<a[Vt][0]||wt>a[Vt][1])&&(Ft=!1)}Ft&&(st[ut++]=o.getRawIndex(bt))}return ut<nt&&(o._indices=st),o._count=ut,o._extent=[],o._updateGetRawIdx(),o},s.prototype.map=function(a,o){var c=this.clone(a);return this._updateDims(c,a,o),c},s.prototype.modify=function(a,o){this._updateDims(this,a,o)},s.prototype._updateDims=function(a,o,c){for(var d=a._chunks,tt=[],nt=o.length,it=a.count(),st=[],ut=a._rawExtent,ct=0;ct<o.length;ct++)ut[o[ct]]=getInitialExtent();for(var ot=0;ot<it;ot++){for(var at=a.getRawIndex(ot),ht=0;ht<nt;ht++)st[ht]=d[o[ht]][at];st[nt]=ot;var ft=c&&c.apply(null,st);if(ft!=null){typeof ft!="object"&&(tt[0]=ft,ft=tt);for(var ct=0;ct<ft.length;ct++){var mt=o[ct],yt=ft[ct],bt=ut[mt],wt=d[mt];wt&&(wt[at]=yt),yt<bt[0]&&(bt[0]=yt),yt>bt[1]&&(bt[1]=yt)}}}},s.prototype.lttbDownSample=function(a,o){var c=this.clone([a],!0),d=c._chunks,tt=d[a],nt=this.count(),it=0,st=Math.floor(1/o),ut=this.getRawIndex(0),ct,ot,at,ht=new(getIndicesCtor(this._rawCount))(Math.min((Math.ceil(nt/st)+2)*2,nt));ht[it++]=ut;for(var ft=1;ft<nt-1;ft+=st){for(var mt=Math.min(ft+st,nt-1),yt=Math.min(ft+st*2,nt),bt=(yt+mt)/2,wt=0,Tt=mt;Tt<yt;Tt++){var Ct=this.getRawIndex(Tt),Dt=tt[Ct];isNaN(Dt)||(wt+=Dt)}wt/=yt-mt;var Ot=ft,$t=Math.min(ft+st,nt),Ft=ft-1,kt=tt[ut];ct=-1,at=Ot;for(var Vt=-1,Ht=0,Tt=Ot;Tt<$t;Tt++){var Ct=this.getRawIndex(Tt),Dt=tt[Ct];if(isNaN(Dt)){Ht++,Vt<0&&(Vt=Ct);continue}ot=Math.abs((Ft-bt)*(Dt-kt)-(Ft-Tt)*(wt-kt)),ot>ct&&(ct=ot,at=Ct)}Ht>0&&Ht<$t-Ot&&(ht[it++]=Math.min(Vt,at),at=Math.max(Vt,at)),ht[it++]=at,ut=at}return ht[it++]=this.getRawIndex(nt-1),c._count=it,c._indices=ht,c.getRawIndex=this._getRawIdx,c},s.prototype.minmaxDownSample=function(a,o){for(var c=this.clone([a],!0),d=c._chunks,tt=Math.floor(1/o),nt=d[a],it=this.count(),st=new(getIndicesCtor(this._rawCount))(Math.ceil(it/tt)*2),ut=0,ct=0;ct<it;ct+=tt){var ot=ct,at=nt[this.getRawIndex(ot)],ht=ct,ft=nt[this.getRawIndex(ht)],mt=tt;ct+tt>it&&(mt=it-ct);for(var yt=0;yt<mt;yt++){var bt=this.getRawIndex(ct+yt),wt=nt[bt];wt<at&&(at=wt,ot=ct+yt),wt>ft&&(ft=wt,ht=ct+yt)}var Tt=this.getRawIndex(ot),Ct=this.getRawIndex(ht);ot<ht?(st[ut++]=Tt,st[ut++]=Ct):(st[ut++]=Ct,st[ut++]=Tt)}return c._count=ut,c._indices=st,c._updateGetRawIdx(),c},s.prototype.downSample=function(a,o,c,d){for(var tt=this.clone([a],!0),nt=tt._chunks,it=[],st=Math.floor(1/o),ut=nt[a],ct=this.count(),ot=tt._rawExtent[a]=getInitialExtent(),at=new(getIndicesCtor(this._rawCount))(Math.ceil(ct/st)),ht=0,ft=0;ft<ct;ft+=st){st>ct-ft&&(st=ct-ft,it.length=st);for(var mt=0;mt<st;mt++){var yt=this.getRawIndex(ft+mt);it[mt]=ut[yt]}var bt=c(it),wt=this.getRawIndex(Math.min(ft+d(it,bt)||0,ct-1));ut[wt]=bt,bt<ot[0]&&(ot[0]=bt),bt>ot[1]&&(ot[1]=bt),at[ht++]=wt}return tt._count=ht,tt._indices=at,tt._updateGetRawIdx(),tt},s.prototype.each=function(a,o){if(this._count)for(var c=a.length,d=this._chunks,tt=0,nt=this.count();tt<nt;tt++){var it=this.getRawIndex(tt);switch(c){case 0:o(tt);break;case 1:o(d[a[0]][it],tt);break;case 2:o(d[a[0]][it],d[a[1]][it],tt);break;default:for(var st=0,ut=[];st<c;st++)ut[st]=d[a[st]][it];ut[st]=tt,o.apply(null,ut)}}},s.prototype.getDataExtent=function(a){var o=this._chunks[a],c=getInitialExtent();if(!o)return c;var d=this.count(),tt=!this._indices,nt;if(tt)return this._rawExtent[a].slice();if(nt=this._extent[a],nt)return nt.slice();nt=c;for(var it=nt[0],st=nt[1],ut=0;ut<d;ut++){var ct=this.getRawIndex(ut),ot=o[ct];ot<it&&(it=ot),ot>st&&(st=ot)}return nt=[it,st],this._extent[a]=nt,nt},s.prototype.getRawDataItem=function(a){var o=this.getRawIndex(a);if(this._provider.persistent)return this._provider.getItem(o);for(var c=[],d=this._chunks,tt=0;tt<d.length;tt++)c.push(d[tt][o]);return c},s.prototype.clone=function(a,o){var c=new s,d=this._chunks,tt=a&&reduce(a,function(it,st){return it[st]=!0,it},{});if(tt)for(var nt=0;nt<d.length;nt++)c._chunks[nt]=tt[nt]?cloneChunk(d[nt]):d[nt];else c._chunks=d;return this._copyCommonProps(c),o||(c._indices=this._cloneIndices()),c._updateGetRawIdx(),c},s.prototype._copyCommonProps=function(a){a._count=this._count,a._rawCount=this._rawCount,a._provider=this._provider,a._dimensions=this._dimensions,a._extent=clone$4(this._extent),a._rawExtent=clone$4(this._rawExtent)},s.prototype._cloneIndices=function(){if(this._indices){var a=this._indices.constructor,o=void 0;if(a===Array){var c=this._indices.length;o=new a(c);for(var d=0;d<c;d++)o[d]=this._indices[d]}else o=new a(this._indices);return o}return null},s.prototype._getRawIdxIdentity=function(a){return a},s.prototype._getRawIdx=function(a){return a<this._count&&a>=0?this._indices[a]:-1},s.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},s.internalField=function(){function a(o,c,d,tt){return parseDataValue(o[tt],this._dimensions[tt])}defaultDimValueGetters={arrayRows:a,objectRows:function(o,c,d,tt){return parseDataValue(o[c],this._dimensions[tt])},keyedColumns:a,original:function(o,c,d,tt){var nt=o&&(o.value==null?o:o.value);return parseDataValue(nt instanceof Array?nt[tt]:nt,this._dimensions[tt])},typedArray:function(o,c,d,tt){return o[tt]}}}(),s}(),SourceManager=function(){function s(a){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=a}return s.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},s.prototype._setLocalSource=function(a,o){this._sourceList=a,this._upstreamSignList=o,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},s.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},s.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},s.prototype._createSource=function(){this._setLocalSource([],[]);var a=this._sourceHost,o=this._getUpstreamSourceManagers(),c=!!o.length,d,tt;if(isSeries(a)){var nt=a,it=void 0,st=void 0,ut=void 0;if(c){var ct=o[0];ct.prepareSource(),ut=ct.getSource(),it=ut.data,st=ut.sourceFormat,tt=[ct._getVersionSign()]}else it=nt.get("data",!0),st=isTypedArray(it)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL,tt=[];var ot=this._getSourceMetaRawOption()||{},at=ut&&ut.metaRawOption||{},ht=retrieve2(ot.seriesLayoutBy,at.seriesLayoutBy)||null,ft=retrieve2(ot.sourceHeader,at.sourceHeader),mt=retrieve2(ot.dimensions,at.dimensions),yt=ht!==at.seriesLayoutBy||!!ft!=!!at.sourceHeader||mt;d=yt?[createSource(it,{seriesLayoutBy:ht,sourceHeader:ft,dimensions:mt},st)]:[]}else{var bt=a;if(c){var wt=this._applyTransform(o);d=wt.sourceList,tt=wt.upstreamSignList}else{var Tt=bt.get("source",!0);d=[createSource(Tt,this._getSourceMetaRawOption(),null)],tt=[]}}this._setLocalSource(d,tt)},s.prototype._applyTransform=function(a){var o=this._sourceHost,c=o.get("transform",!0),d=o.get("fromTransformResult",!0);if(d!=null){var tt="";a.length!==1&&doThrow(tt)}var nt,it=[],st=[];return each$f(a,function(ut){ut.prepareSource();var ct=ut.getSource(d||0),ot="";d!=null&&!ct&&doThrow(ot),it.push(ct),st.push(ut._getVersionSign())}),c?nt=applyDataTransform(c,it,{datasetIndex:o.componentIndex}):d!=null&&(nt=[cloneSourceShallow(it[0])]),{sourceList:nt,upstreamSignList:st}},s.prototype._isDirty=function(){if(this._dirty)return!0;for(var a=this._getUpstreamSourceManagers(),o=0;o<a.length;o++){var c=a[o];if(c._isDirty()||this._upstreamSignList[o]!==c._getVersionSign())return!0}},s.prototype.getSource=function(a){a=a||0;var o=this._sourceList[a];if(!o){var c=this._getUpstreamSourceManagers();return c[0]&&c[0].getSource(a)}return o},s.prototype.getSharedDataStore=function(a){var o=a.makeStoreSchema();return this._innerGetDataStore(o.dimensions,a.source,o.hash)},s.prototype._innerGetDataStore=function(a,o,c){var d=0,tt=this._storeList,nt=tt[d];nt||(nt=tt[d]={});var it=nt[c];if(!it){var st=this._getUpstreamSourceManagers()[0];isSeries(this._sourceHost)&&st?it=st._innerGetDataStore(a,o,c):(it=new DataStore,it.initData(new DefaultDataProvider(o,a.length),a)),nt[c]=it}return it},s.prototype._getUpstreamSourceManagers=function(){var a=this._sourceHost;if(isSeries(a)){var o=querySeriesUpstreamDatasetModel(a);return o?[o.getSourceManager()]:[]}else return map$1(queryDatasetUpstreamDatasetModels(a),function(c){return c.getSourceManager()})},s.prototype._getSourceMetaRawOption=function(){var a=this._sourceHost,o,c,d;if(isSeries(a))o=a.get("seriesLayoutBy",!0),c=a.get("sourceHeader",!0),d=a.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var tt=a;o=tt.get("seriesLayoutBy",!0),c=tt.get("sourceHeader",!0),d=tt.get("dimensions",!0)}return{seriesLayoutBy:o,sourceHeader:c,dimensions:d}},s}();function disableTransformOptionMerge(s){var a=s.option.transform;a&&setAsPrimitive(s.option.transform)}function isSeries(s){return s.mainType==="series"}function doThrow(s){throw new Error(s)}var TOOLTIP_LINE_HEIGHT_CSS="line-height:1";function getTooltipLineHeight(s){var a=s.lineHeight;return a==null?TOOLTIP_LINE_HEIGHT_CSS:"line-height:"+encodeHTML(a+"")+"px"}function getTooltipTextStyle(s,a){var o=s.color||"#6e7079",c=s.fontSize||12,d=s.fontWeight||"400",tt=s.color||"#464646",nt=s.fontSize||14,it=s.fontWeight||"900";return a==="html"?{nameStyle:"font-size:"+encodeHTML(c+"")+"px;color:"+encodeHTML(o)+";font-weight:"+encodeHTML(d+""),valueStyle:"font-size:"+encodeHTML(nt+"")+"px;color:"+encodeHTML(tt)+";font-weight:"+encodeHTML(it+"")}:{nameStyle:{fontSize:c,fill:o,fontWeight:d},valueStyle:{fontSize:nt,fill:tt,fontWeight:it}}}var HTML_GAPS=[0,10,20,30],RICH_TEXT_GAPS=["",`
`,`

`,`


`];function createTooltipMarkup(s,a){return a.type=s,a}function isSectionFragment(s){return s.type==="section"}function getBuilder(s){return isSectionFragment(s)?buildSection:buildNameValue}function getBlockGapLevel(s){if(isSectionFragment(s)){var a=0,o=s.blocks.length,c=o>1||o>0&&!s.noHeader;return each$f(s.blocks,function(d){var tt=getBlockGapLevel(d);tt>=a&&(a=tt+ +(c&&(!tt||isSectionFragment(d)&&!d.noHeader)))}),a}return 0}function buildSection(s,a,o,c){var d=a.noHeader,tt=getGap(getBlockGapLevel(a)),nt=[],it=a.blocks||[];assert(!it||isArray$1(it)),it=it||[];var st=s.orderMode;if(a.sortBlocks&&st){it=it.slice();var ut={valueAsc:"asc",valueDesc:"desc"};if(hasOwn(ut,st)){var ct=new SortOrderComparator(ut[st],null);it.sort(function(mt,yt){return ct.evaluate(mt.sortParam,yt.sortParam)})}else st==="seriesDesc"&&it.reverse()}each$f(it,function(mt,yt){var bt=a.valueFormatter,wt=getBuilder(mt)(bt?extend(extend({},s),{valueFormatter:bt}):s,mt,yt>0?tt.html:0,c);wt!=null&&nt.push(wt)});var ot=s.renderMode==="richText"?nt.join(tt.richText):wrapBlockHTML(c,nt.join(""),d?o:tt.html);if(d)return ot;var at=makeValueReadable(a.header,"ordinal",s.useUTC),ht=getTooltipTextStyle(c,s.renderMode).nameStyle,ft=getTooltipLineHeight(c);return s.renderMode==="richText"?wrapInlineNameRichText(s,at,ht)+tt.richText+ot:wrapBlockHTML(c,'<div style="'+ht+";"+ft+';">'+encodeHTML(at)+"</div>"+ot,o)}function buildNameValue(s,a,o,c){var d=s.renderMode,tt=a.noName,nt=a.noValue,it=!a.markerType,st=a.name,ut=s.useUTC,ct=a.valueFormatter||s.valueFormatter||function(Ct){return Ct=isArray$1(Ct)?Ct:[Ct],map$1(Ct,function(Dt,Ot){return makeValueReadable(Dt,isArray$1(ht)?ht[Ot]:ht,ut)})};if(!(tt&&nt)){var ot=it?"":s.markupStyleCreator.makeTooltipMarker(a.markerType,a.markerColor||"#333",d),at=tt?"":makeValueReadable(st,"ordinal",ut),ht=a.valueType,ft=nt?[]:ct(a.value,a.dataIndex),mt=!it||!tt,yt=!it&&tt,bt=getTooltipTextStyle(c,d),wt=bt.nameStyle,Tt=bt.valueStyle;return d==="richText"?(it?"":ot)+(tt?"":wrapInlineNameRichText(s,at,wt))+(nt?"":wrapInlineValueRichText(s,ft,mt,yt,Tt)):wrapBlockHTML(c,(it?"":ot)+(tt?"":wrapInlineNameHTML(at,!it,wt))+(nt?"":wrapInlineValueHTML(ft,mt,yt,Tt)),o)}}function buildTooltipMarkup(s,a,o,c,d,tt){if(s){var nt=getBuilder(s),it={useUTC:d,renderMode:o,orderMode:c,markupStyleCreator:a,valueFormatter:s.valueFormatter};return nt(it,s,0,tt)}}function getGap(s){return{html:HTML_GAPS[s],richText:RICH_TEXT_GAPS[s]}}function wrapBlockHTML(s,a,o){var c='<div style="clear:both"></div>',d="margin: "+o+"px 0 0",tt=getTooltipLineHeight(s);return'<div style="'+d+";"+tt+';">'+a+c+"</div>"}function wrapInlineNameHTML(s,a,o){var c=a?"margin-left:2px":"";return'<span style="'+o+";"+c+'">'+encodeHTML(s)+"</span>"}function wrapInlineValueHTML(s,a,o,c){var d=o?"10px":"20px",tt=a?"float:right;margin-left:"+d:"";return s=isArray$1(s)?s:[s],'<span style="'+tt+";"+c+'">'+map$1(s,function(nt){return encodeHTML(nt)}).join("&nbsp;&nbsp;")+"</span>"}function wrapInlineNameRichText(s,a,o){return s.markupStyleCreator.wrapRichTextStyle(a,o)}function wrapInlineValueRichText(s,a,o,c,d){var tt=[d],nt=c?10:20;return o&&tt.push({padding:[0,0,0,nt],align:"right"}),s.markupStyleCreator.wrapRichTextStyle(isArray$1(a)?a.join("  "):a,tt)}function retrieveVisualColorForTooltipMarker(s,a){var o=s.getData().getItemVisual(a,"style"),c=o[s.visualDrawType];return convertToColorString(c)}function getPaddingFromTooltipModel(s,a){var o=s.get("padding");return o??(a==="richText"?[8,10]:10)}var TooltipMarkupStyleCreator=function(){function s(){this.richTextStyles={},this._nextStyleNameId=getRandomIdBase()}return s.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},s.prototype.makeTooltipMarker=function(a,o,c){var d=c==="richText"?this._generateStyleName():null,tt=getTooltipMarker({color:o,type:a,renderMode:c,markerId:d});return isString$1(tt)?tt:(this.richTextStyles[d]=tt.style,tt.content)},s.prototype.wrapRichTextStyle=function(a,o){var c={};isArray$1(o)?each$f(o,function(tt){return extend(c,tt)}):extend(c,o);var d=this._generateStyleName();return this.richTextStyles[d]=c,"{"+d+"|"+a+"}"},s}();function defaultSeriesFormatTooltip(s){var a=s.series,o=s.dataIndex,c=s.multipleSeries,d=a.getData(),tt=d.mapDimensionsAll("defaultedTooltip"),nt=tt.length,it=a.getRawValue(o),st=isArray$1(it),ut=retrieveVisualColorForTooltipMarker(a,o),ct,ot,at,ht;if(nt>1||st&&!nt){var ft=formatTooltipArrayValue(it,a,o,tt,ut);ct=ft.inlineValues,ot=ft.inlineValueTypes,at=ft.blocks,ht=ft.inlineValues[0]}else if(nt){var mt=d.getDimensionInfo(tt[0]);ht=ct=retrieveRawValue(d,o,tt[0]),ot=mt.type}else ht=ct=st?it[0]:it;var yt=isNameSpecified(a),bt=yt&&a.name||"",wt=d.getName(o),Tt=c?bt:wt;return createTooltipMarkup("section",{header:bt,noHeader:c||!yt,sortParam:ht,blocks:[createTooltipMarkup("nameValue",{markerType:"item",markerColor:ut,name:Tt,noName:!trim$1(Tt),value:ct,valueType:ot,dataIndex:o})].concat(at||[])})}function formatTooltipArrayValue(s,a,o,c,d){var tt=a.getData(),nt=reduce(s,function(ot,at,ht){var ft=tt.getDimensionInfo(ht);return ot=ot||ft&&ft.tooltip!==!1&&ft.displayName!=null},!1),it=[],st=[],ut=[];c.length?each$f(c,function(ot){ct(retrieveRawValue(tt,o,ot),ot)}):each$f(s,ct);function ct(ot,at){var ht=tt.getDimensionInfo(at);!ht||ht.otherDims.tooltip===!1||(nt?ut.push(createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:d,name:ht.displayName,value:ot,valueType:ht.type})):(it.push(ot),st.push(ht.type)))}return{inlineValues:it,inlineValueTypes:st,blocks:ut}}var inner$k=makeInner();function getSelectionKey(s,a){return s.getName(a)||s.getId(a)}var SERIES_UNIVERSAL_TRANSITION_PROP="__universalTransitionEnabled",SeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o._selectedDataIndicesMap={},o}return a.prototype.init=function(o,c,d){this.seriesIndex=this.componentIndex,this.dataTask=createTask({count:dataTaskCount,reset:dataTaskReset}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(o,d);var tt=inner$k(this).sourceManager=new SourceManager(this);tt.prepareSource();var nt=this.getInitialData(o,d);wrapData(nt,this),this.dataTask.context.data=nt,inner$k(this).dataBeforeProcessed=nt,autoSeriesName(this),this._initSelectedMapFromData(nt)},a.prototype.mergeDefaultAndTheme=function(o,c){var d=fetchLayoutMode(this),tt=d?getLayoutParams(o):{},nt=this.subType;ComponentModel.hasClass(nt)&&(nt+="Series"),merge(o,c.getTheme().get(this.subType)),merge(o,this.getDefaultOption()),defaultEmphasis(o,"label",["show"]),this.fillDataTextStyle(o.data),d&&mergeLayoutParam(o,tt,d)},a.prototype.mergeOption=function(o,c){o=merge(this.option,o,!0),this.fillDataTextStyle(o.data);var d=fetchLayoutMode(this);d&&mergeLayoutParam(this.option,o,d);var tt=inner$k(this).sourceManager;tt.dirty(),tt.prepareSource();var nt=this.getInitialData(o,c);wrapData(nt,this),this.dataTask.dirty(),this.dataTask.context.data=nt,inner$k(this).dataBeforeProcessed=nt,autoSeriesName(this),this._initSelectedMapFromData(nt)},a.prototype.fillDataTextStyle=function(o){if(o&&!isTypedArray(o))for(var c=["show"],d=0;d<o.length;d++)o[d]&&o[d].label&&defaultEmphasis(o[d],"label",c)},a.prototype.getInitialData=function(o,c){},a.prototype.appendData=function(o){var c=this.getRawData();c.appendData(o.data)},a.prototype.getData=function(o){var c=getCurrentTask(this);if(c){var d=c.context.data;return o==null||!d.getLinkedData?d:d.getLinkedData(o)}else return inner$k(this).data},a.prototype.getAllData=function(){var o=this.getData();return o&&o.getLinkedDataAll?o.getLinkedDataAll():[{data:o}]},a.prototype.setData=function(o){var c=getCurrentTask(this);if(c){var d=c.context;d.outputData=o,c!==this.dataTask&&(d.data=o)}inner$k(this).data=o},a.prototype.getEncode=function(){var o=this.get("encode",!0);if(o)return createHashMap(o)},a.prototype.getSourceManager=function(){return inner$k(this).sourceManager},a.prototype.getSource=function(){return this.getSourceManager().getSource()},a.prototype.getRawData=function(){return inner$k(this).dataBeforeProcessed},a.prototype.getColorBy=function(){var o=this.get("colorBy");return o||"series"},a.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},a.prototype.getBaseAxis=function(){var o=this.coordinateSystem;return o&&o.getBaseAxis&&o.getBaseAxis()},a.prototype.formatTooltip=function(o,c,d){return defaultSeriesFormatTooltip({series:this,dataIndex:o,multipleSeries:c})},a.prototype.isAnimationEnabled=function(){var o=this.ecModel;if(env.node&&!(o&&o.ssr))return!1;var c=this.getShallow("animation");return c&&this.getData().count()>this.getShallow("animationThreshold")&&(c=!1),!!c},a.prototype.restoreData=function(){this.dataTask.dirty()},a.prototype.getColorFromPalette=function(o,c,d){var tt=this.ecModel,nt=PaletteMixin.prototype.getColorFromPalette.call(this,o,c,d);return nt||(nt=tt.getColorFromPalette(o,c,d)),nt},a.prototype.coordDimToDataDim=function(o){return this.getRawData().mapDimensionsAll(o)},a.prototype.getProgressive=function(){return this.get("progressive")},a.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},a.prototype.select=function(o,c){this._innerSelect(this.getData(c),o)},a.prototype.unselect=function(o,c){var d=this.option.selectedMap;if(d){var tt=this.option.selectedMode,nt=this.getData(c);if(tt==="series"||d==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var it=0;it<o.length;it++){var st=o[it],ut=getSelectionKey(nt,st);d[ut]=!1,this._selectedDataIndicesMap[ut]=-1}}},a.prototype.toggleSelect=function(o,c){for(var d=[],tt=0;tt<o.length;tt++)d[0]=o[tt],this.isSelected(o[tt],c)?this.unselect(d,c):this.select(d,c)},a.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var o=this._selectedDataIndicesMap,c=keys(o),d=[],tt=0;tt<c.length;tt++){var nt=o[c[tt]];nt>=0&&d.push(nt)}return d},a.prototype.isSelected=function(o,c){var d=this.option.selectedMap;if(!d)return!1;var tt=this.getData(c);return(d==="all"||d[getSelectionKey(tt,o)])&&!tt.getItemModel(o).get(["select","disabled"])},a.prototype.isUniversalTransitionEnabled=function(){if(this[SERIES_UNIVERSAL_TRANSITION_PROP])return!0;var o=this.option.universalTransition;return o?o===!0?!0:o&&o.enabled:!1},a.prototype._innerSelect=function(o,c){var d,tt,nt=this.option,it=nt.selectedMode,st=c.length;if(!(!it||!st)){if(it==="series")nt.selectedMap="all";else if(it==="multiple"){isObject$3(nt.selectedMap)||(nt.selectedMap={});for(var ut=nt.selectedMap,ct=0;ct<st;ct++){var ot=c[ct],at=getSelectionKey(o,ot);ut[at]=!0,this._selectedDataIndicesMap[at]=o.getRawIndex(ot)}}else if(it==="single"||it===!0){var ht=c[st-1],at=getSelectionKey(o,ht);nt.selectedMap=(d={},d[at]=!0,d),this._selectedDataIndicesMap=(tt={},tt[at]=o.getRawIndex(ht),tt)}}},a.prototype._initSelectedMapFromData=function(o){if(!this.option.selectedMap){var c=[];o.hasItemOption&&o.each(function(d){var tt=o.getRawDataItem(d);tt&&tt.selected&&c.push(d)}),c.length>0&&this._innerSelect(o,c)}},a.registerClass=function(o){return ComponentModel.registerClass(o)},a.protoInitialize=function(){var o=a.prototype;o.type="series.__base__",o.seriesIndex=0,o.ignoreStyleOnData=!1,o.hasSymbolVisual=!1,o.defaultSymbol="circle",o.visualStyleAccessPath="itemStyle",o.visualDrawType="fill"}(),a}(ComponentModel);mixin(SeriesModel,DataFormatMixin);mixin(SeriesModel,PaletteMixin);mountExtend(SeriesModel,ComponentModel);function autoSeriesName(s){var a=s.name;isNameSpecified(s)||(s.name=getSeriesAutoName(s)||a)}function getSeriesAutoName(s){var a=s.getRawData(),o=a.mapDimensionsAll("seriesName"),c=[];return each$f(o,function(d){var tt=a.getDimensionInfo(d);tt.displayName&&c.push(tt.displayName)}),c.join(" ")}function dataTaskCount(s){return s.model.getRawData().count()}function dataTaskReset(s){var a=s.model;return a.setData(a.getRawData().cloneShallow()),dataTaskProgress}function dataTaskProgress(s,a){a.outputData&&s.end>a.outputData.count()&&a.model.getRawData().cloneShallow(a.outputData)}function wrapData(s,a){each$f(concatArray(s.CHANGABLE_METHODS,s.DOWNSAMPLE_METHODS),function(o){s.wrapMethod(o,curry$1(onDataChange,a))})}function onDataChange(s,a){var o=getCurrentTask(s);return o&&o.setOutputEnd((a||this).count()),a}function getCurrentTask(s){var a=(s.ecModel||{}).scheduler,o=a&&a.getPipeline(s.uid);if(o){var c=o.currentTask;if(c){var d=c.agentStubMap;d&&(c=d.get(s.uid))}return c}}var ComponentView=function(){function s(){this.group=new Group$3,this.uid=getUID("viewComponent")}return s.prototype.init=function(a,o){},s.prototype.render=function(a,o,c,d){},s.prototype.dispose=function(a,o){},s.prototype.updateView=function(a,o,c,d){},s.prototype.updateLayout=function(a,o,c,d){},s.prototype.updateVisual=function(a,o,c,d){},s.prototype.toggleBlurSeries=function(a,o,c){},s.prototype.eachRendered=function(a){var o=this.group;o&&o.traverse(a)},s}();enableClassExtend(ComponentView);enableClassManagement(ComponentView);function createRenderPlanner(){var s=makeInner();return function(a){var o=s(a),c=a.pipelineContext,d=!!o.large,tt=!!o.progressiveRender,nt=o.large=!!(c&&c.large),it=o.progressiveRender=!!(c&&c.progressiveRender);return(d!==nt||tt!==it)&&"reset"}}var inner$j=makeInner(),renderPlanner=createRenderPlanner(),ChartView=function(){function s(){this.group=new Group$3,this.uid=getUID("viewChart"),this.renderTask=createTask({plan:renderTaskPlan,reset:renderTaskReset}),this.renderTask.context={view:this}}return s.prototype.init=function(a,o){},s.prototype.render=function(a,o,c,d){},s.prototype.highlight=function(a,o,c,d){var tt=a.getData(d&&d.dataType);tt&&toggleHighlight(tt,d,"emphasis")},s.prototype.downplay=function(a,o,c,d){var tt=a.getData(d&&d.dataType);tt&&toggleHighlight(tt,d,"normal")},s.prototype.remove=function(a,o){this.group.removeAll()},s.prototype.dispose=function(a,o){},s.prototype.updateView=function(a,o,c,d){this.render(a,o,c,d)},s.prototype.updateLayout=function(a,o,c,d){this.render(a,o,c,d)},s.prototype.updateVisual=function(a,o,c,d){this.render(a,o,c,d)},s.prototype.eachRendered=function(a){traverseElements(this.group,a)},s.markUpdateMethod=function(a,o){inner$j(a).updateMethod=o},s.protoInitialize=function(){var a=s.prototype;a.type="chart"}(),s}();function elSetState(s,a,o){s&&isHighDownDispatcher(s)&&(a==="emphasis"?enterEmphasis:leaveEmphasis)(s,o)}function toggleHighlight(s,a,o){var c=queryDataIndex(s,a),d=a&&a.highlightKey!=null?getHighlightDigit(a.highlightKey):null;c!=null?each$f(normalizeToArray(c),function(tt){elSetState(s.getItemGraphicEl(tt),o,d)}):s.eachItemGraphicEl(function(tt){elSetState(tt,o,d)})}enableClassExtend(ChartView);enableClassManagement(ChartView);function renderTaskPlan(s){return renderPlanner(s.model)}function renderTaskReset(s){var a=s.model,o=s.ecModel,c=s.api,d=s.payload,tt=a.pipelineContext.progressiveRender,nt=s.view,it=d&&inner$j(d).updateMethod,st=tt?"incrementalPrepareRender":it&&nt[it]?it:"render";return st!=="render"&&nt[st](a,o,c,d),progressMethodMap[st]}var progressMethodMap={incrementalPrepareRender:{progress:function(s,a){a.view.incrementalRender(s,a.model,a.ecModel,a.api,a.payload)}},render:{forceFirstProgress:!0,progress:function(s,a){a.view.render(a.model,a.ecModel,a.api,a.payload)}}},ORIGIN_METHOD="\0__throttleOriginMethod",RATE="\0__throttleRate",THROTTLE_TYPE="\0__throttleType";function throttle(s,a,o){var c,d=0,tt=0,nt=null,it,st,ut,ct;a=a||0;function ot(){tt=new Date().getTime(),nt=null,s.apply(st,ut||[])}var at=function(){for(var ht=[],ft=0;ft<arguments.length;ft++)ht[ft]=arguments[ft];c=new Date().getTime(),st=this,ut=ht;var mt=ct||a,yt=ct||o;ct=null,it=c-(yt?d:tt)-mt,clearTimeout(nt),yt?nt=setTimeout(ot,mt):it>=0?ot():nt=setTimeout(ot,-it),d=c};return at.clear=function(){nt&&(clearTimeout(nt),nt=null)},at.debounceNextCall=function(ht){ct=ht},at}function createOrUpdate(s,a,o,c){var d=s[a];if(d){var tt=d[ORIGIN_METHOD]||d,nt=d[THROTTLE_TYPE],it=d[RATE];if(it!==o||nt!==c){if(o==null||!c)return s[a]=tt;d=s[a]=throttle(tt,o,c==="debounce"),d[ORIGIN_METHOD]=tt,d[THROTTLE_TYPE]=c,d[RATE]=o}return d}}function clear$2(s,a){var o=s[a];o&&o[ORIGIN_METHOD]&&(o.clear&&o.clear(),s[a]=o[ORIGIN_METHOD])}var inner$i=makeInner(),defaultStyleMappers={itemStyle:makeStyleMapper(ITEM_STYLE_KEY_MAP,!0),lineStyle:makeStyleMapper(LINE_STYLE_KEY_MAP,!0)},defaultColorKey={lineStyle:"stroke",itemStyle:"fill"};function getStyleMapper(s,a){var o=s.visualStyleMapper||defaultStyleMappers[a];return o||(console.warn("Unknown style type '"+a+"'."),defaultStyleMappers.itemStyle)}function getDefaultColorKey(s,a){var o=s.visualDrawType||defaultColorKey[a];return o||(console.warn("Unknown style type '"+a+"'."),"fill")}var seriesStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(s,a){var o=s.getData(),c=s.visualStyleAccessPath||"itemStyle",d=s.getModel(c),tt=getStyleMapper(s,c),nt=tt(d),it=d.getShallow("decal");it&&(o.setVisual("decal",it),it.dirty=!0);var st=getDefaultColorKey(s,c),ut=nt[st],ct=isFunction$1(ut)?ut:null,ot=nt.fill==="auto"||nt.stroke==="auto";if(!nt[st]||ct||ot){var at=s.getColorFromPalette(s.name,null,a.getSeriesCount());nt[st]||(nt[st]=at,o.setVisual("colorFromPalette",!0)),nt.fill=nt.fill==="auto"||isFunction$1(nt.fill)?at:nt.fill,nt.stroke=nt.stroke==="auto"||isFunction$1(nt.stroke)?at:nt.stroke}if(o.setVisual("style",nt),o.setVisual("drawType",st),!a.isSeriesFiltered(s)&&ct)return o.setVisual("colorFromPalette",!1),{dataEach:function(ht,ft){var mt=s.getDataParams(ft),yt=extend({},nt);yt[st]=ct(mt),ht.setItemVisual(ft,"style",yt)}}}},sharedModel=new Model,dataStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(s,a){if(!(s.ignoreStyleOnData||a.isSeriesFiltered(s))){var o=s.getData(),c=s.visualStyleAccessPath||"itemStyle",d=getStyleMapper(s,c),tt=o.getVisual("drawType");return{dataEach:o.hasItemOption?function(nt,it){var st=nt.getRawDataItem(it);if(st&&st[c]){sharedModel.option=st[c];var ut=d(sharedModel),ct=nt.ensureUniqueItemVisual(it,"style");extend(ct,ut),sharedModel.option.decal&&(nt.setItemVisual(it,"decal",sharedModel.option.decal),sharedModel.option.decal.dirty=!0),tt in ut&&nt.setItemVisual(it,"colorFromPalette",!1)}}:null}}}},dataColorPaletteTask={performRawSeries:!0,overallReset:function(s){var a=createHashMap();s.eachSeries(function(o){var c=o.getColorBy();if(!o.isColorBySeries()){var d=o.type+"-"+c,tt=a.get(d);tt||(tt={},a.set(d,tt)),inner$i(o).scope=tt}}),s.eachSeries(function(o){if(!(o.isColorBySeries()||s.isSeriesFiltered(o))){var c=o.getRawData(),d={},tt=o.getData(),nt=inner$i(o).scope,it=o.visualStyleAccessPath||"itemStyle",st=getDefaultColorKey(o,it);tt.each(function(ut){var ct=tt.getRawIndex(ut);d[ct]=ut}),c.each(function(ut){var ct=d[ut],ot=tt.getItemVisual(ct,"colorFromPalette");if(ot){var at=tt.ensureUniqueItemVisual(ct,"style"),ht=c.getName(ut)||ut+"",ft=c.count();at[st]=o.getColorFromPalette(ht,nt,ft)}})}})}},PI$5=Math.PI;function defaultLoading(s,a){a=a||{},defaults(a,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var o=new Group$3,c=new Rect$2({style:{fill:a.maskColor},zlevel:a.zlevel,z:1e4});o.add(c);var d=new ZRText({style:{text:a.text,fill:a.textColor,fontSize:a.fontSize,fontWeight:a.fontWeight,fontStyle:a.fontStyle,fontFamily:a.fontFamily},zlevel:a.zlevel,z:10001}),tt=new Rect$2({style:{fill:"none"},textContent:d,textConfig:{position:"right",distance:10},zlevel:a.zlevel,z:10001});o.add(tt);var nt;return a.showSpinner&&(nt=new Arc({shape:{startAngle:-PI$5/2,endAngle:-PI$5/2+.1,r:a.spinnerRadius},style:{stroke:a.color,lineCap:"round",lineWidth:a.lineWidth},zlevel:a.zlevel,z:10001}),nt.animateShape(!0).when(1e3,{endAngle:PI$5*3/2}).start("circularInOut"),nt.animateShape(!0).when(1e3,{startAngle:PI$5*3/2}).delay(300).start("circularInOut"),o.add(nt)),o.resize=function(){var it=d.getBoundingRect().width,st=a.showSpinner?a.spinnerRadius:0,ut=(s.getWidth()-st*2-(a.showSpinner&&it?10:0)-it)/2-(a.showSpinner&&it?0:5+it/2)+(a.showSpinner?0:it/2)+(it?0:st),ct=s.getHeight()/2;a.showSpinner&&nt.setShape({cx:ut,cy:ct}),tt.setShape({x:ut-st,y:ct-st,width:st*2,height:st*2}),c.setShape({x:0,y:0,width:s.getWidth(),height:s.getHeight()})},o.resize(),o}var Scheduler=function(){function s(a,o,c,d){this._stageTaskMap=createHashMap(),this.ecInstance=a,this.api=o,c=this._dataProcessorHandlers=c.slice(),d=this._visualHandlers=d.slice(),this._allHandlers=c.concat(d)}return s.prototype.restoreData=function(a,o){a.restoreData(o),this._stageTaskMap.each(function(c){var d=c.overallTask;d&&d.dirty()})},s.prototype.getPerformArgs=function(a,o){if(a.__pipeline){var c=this._pipelineMap.get(a.__pipeline.id),d=c.context,tt=!o&&c.progressiveEnabled&&(!d||d.progressiveRender)&&a.__idxInPipeline>c.blockIndex,nt=tt?c.step:null,it=d&&d.modDataCount,st=it!=null?Math.ceil(it/nt):null;return{step:nt,modBy:st,modDataCount:it}}},s.prototype.getPipeline=function(a){return this._pipelineMap.get(a)},s.prototype.updateStreamModes=function(a,o){var c=this._pipelineMap.get(a.uid),d=a.getData(),tt=d.count(),nt=c.progressiveEnabled&&o.incrementalPrepareRender&&tt>=c.threshold,it=a.get("large")&&tt>=a.get("largeThreshold"),st=a.get("progressiveChunkMode")==="mod"?tt:null;a.pipelineContext=c.context={progressiveRender:nt,modDataCount:st,large:it}},s.prototype.restorePipelines=function(a){var o=this,c=o._pipelineMap=createHashMap();a.eachSeries(function(d){var tt=d.getProgressive(),nt=d.uid;c.set(nt,{id:nt,head:null,tail:null,threshold:d.getProgressiveThreshold(),progressiveEnabled:tt&&!(d.preventIncremental&&d.preventIncremental()),blockIndex:-1,step:Math.round(tt||700),count:0}),o._pipe(d,d.dataTask)})},s.prototype.prepareStageTasks=function(){var a=this._stageTaskMap,o=this.api.getModel(),c=this.api;each$f(this._allHandlers,function(d){var tt=a.get(d.uid)||a.set(d.uid,{}),nt="";assert(!(d.reset&&d.overallReset),nt),d.reset&&this._createSeriesStageTask(d,tt,o,c),d.overallReset&&this._createOverallStageTask(d,tt,o,c)},this)},s.prototype.prepareView=function(a,o,c,d){var tt=a.renderTask,nt=tt.context;nt.model=o,nt.ecModel=c,nt.api=d,tt.__block=!a.incrementalPrepareRender,this._pipe(o,tt)},s.prototype.performDataProcessorTasks=function(a,o){this._performStageTasks(this._dataProcessorHandlers,a,o,{block:!0})},s.prototype.performVisualTasks=function(a,o,c){this._performStageTasks(this._visualHandlers,a,o,c)},s.prototype._performStageTasks=function(a,o,c,d){d=d||{};var tt=!1,nt=this;each$f(a,function(st,ut){if(!(d.visualType&&d.visualType!==st.visualType)){var ct=nt._stageTaskMap.get(st.uid),ot=ct.seriesTaskMap,at=ct.overallTask;if(at){var ht,ft=at.agentStubMap;ft.each(function(yt){it(d,yt)&&(yt.dirty(),ht=!0)}),ht&&at.dirty(),nt.updatePayload(at,c);var mt=nt.getPerformArgs(at,d.block);ft.each(function(yt){yt.perform(mt)}),at.perform(mt)&&(tt=!0)}else ot&&ot.each(function(yt,bt){it(d,yt)&&yt.dirty();var wt=nt.getPerformArgs(yt,d.block);wt.skip=!st.performRawSeries&&o.isSeriesFiltered(yt.context.model),nt.updatePayload(yt,c),yt.perform(wt)&&(tt=!0)})}});function it(st,ut){return st.setDirty&&(!st.dirtyMap||st.dirtyMap.get(ut.__pipeline.id))}this.unfinished=tt||this.unfinished},s.prototype.performSeriesTasks=function(a){var o;a.eachSeries(function(c){o=c.dataTask.perform()||o}),this.unfinished=o||this.unfinished},s.prototype.plan=function(){this._pipelineMap.each(function(a){var o=a.tail;do{if(o.__block){a.blockIndex=o.__idxInPipeline;break}o=o.getUpstream()}while(o)})},s.prototype.updatePayload=function(a,o){o!=="remain"&&(a.context.payload=o)},s.prototype._createSeriesStageTask=function(a,o,c,d){var tt=this,nt=o.seriesTaskMap,it=o.seriesTaskMap=createHashMap(),st=a.seriesType,ut=a.getTargetSeries;a.createOnAllSeries?c.eachRawSeries(ct):st?c.eachRawSeriesByType(st,ct):ut&&ut(c,d).each(ct);function ct(ot){var at=ot.uid,ht=it.set(at,nt&&nt.get(at)||createTask({plan:seriesTaskPlan,reset:seriesTaskReset,count:seriesTaskCount}));ht.context={model:ot,ecModel:c,api:d,useClearVisual:a.isVisual&&!a.isLayout,plan:a.plan,reset:a.reset,scheduler:tt},tt._pipe(ot,ht)}},s.prototype._createOverallStageTask=function(a,o,c,d){var tt=this,nt=o.overallTask=o.overallTask||createTask({reset:overallTaskReset});nt.context={ecModel:c,api:d,overallReset:a.overallReset,scheduler:tt};var it=nt.agentStubMap,st=nt.agentStubMap=createHashMap(),ut=a.seriesType,ct=a.getTargetSeries,ot=!0,at=!1,ht="";assert(!a.createOnAllSeries,ht),ut?c.eachRawSeriesByType(ut,ft):ct?ct(c,d).each(ft):(ot=!1,each$f(c.getSeries(),ft));function ft(mt){var yt=mt.uid,bt=st.set(yt,it&&it.get(yt)||(at=!0,createTask({reset:stubReset,onDirty:stubOnDirty})));bt.context={model:mt,overallProgress:ot},bt.agent=nt,bt.__block=ot,tt._pipe(mt,bt)}at&&nt.dirty()},s.prototype._pipe=function(a,o){var c=a.uid,d=this._pipelineMap.get(c);!d.head&&(d.head=o),d.tail&&d.tail.pipe(o),d.tail=o,o.__idxInPipeline=d.count++,o.__pipeline=d},s.wrapStageHandler=function(a,o){return isFunction$1(a)&&(a={overallReset:a,seriesType:detectSeriseType(a)}),a.uid=getUID("stageHandler"),o&&(a.visualType=o),a},s}();function overallTaskReset(s){s.overallReset(s.ecModel,s.api,s.payload)}function stubReset(s){return s.overallProgress&&stubProgress}function stubProgress(){this.agent.dirty(),this.getDownstream().dirty()}function stubOnDirty(){this.agent&&this.agent.dirty()}function seriesTaskPlan(s){return s.plan?s.plan(s.model,s.ecModel,s.api,s.payload):null}function seriesTaskReset(s){s.useClearVisual&&s.data.clearAllVisual();var a=s.resetDefines=normalizeToArray(s.reset(s.model,s.ecModel,s.api,s.payload));return a.length>1?map$1(a,function(o,c){return makeSeriesTaskProgress(c)}):singleSeriesTaskProgress}var singleSeriesTaskProgress=makeSeriesTaskProgress(0);function makeSeriesTaskProgress(s){return function(a,o){var c=o.data,d=o.resetDefines[s];if(d&&d.dataEach)for(var tt=a.start;tt<a.end;tt++)d.dataEach(c,tt);else d&&d.progress&&d.progress(a,c)}}function seriesTaskCount(s){return s.data.count()}function detectSeriseType(s){seriesType=null;try{s(ecModelMock,apiMock)}catch{}return seriesType}var ecModelMock={},apiMock={},seriesType;mockMethods(ecModelMock,GlobalModel);mockMethods(apiMock,ExtensionAPI);ecModelMock.eachSeriesByType=ecModelMock.eachRawSeriesByType=function(s){seriesType=s};ecModelMock.eachComponent=function(s){s.mainType==="series"&&s.subType&&(seriesType=s.subType)};function mockMethods(s,a){for(var o in a.prototype)s[o]=noop}var colorAll=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const lightTheme={color:colorAll,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],colorAll]};var contrastColor="#B9B8CE",backgroundColor="#100C2A",axisCommon=function(){return{axisLine:{lineStyle:{color:contrastColor}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},colorPalette=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],theme={darkMode:!0,color:colorPalette,backgroundColor,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:contrastColor},pageTextStyle:{color:contrastColor}},textStyle:{color:contrastColor},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:contrastColor}},dataZoom:{borderColor:"#71708A",textStyle:{color:contrastColor},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:contrastColor}},timeline:{lineStyle:{color:contrastColor},label:{color:contrastColor},controlStyle:{color:contrastColor,borderColor:contrastColor}},calendar:{itemStyle:{color:backgroundColor},dayLabel:{color:contrastColor},monthLabel:{color:contrastColor},yearLabel:{color:contrastColor}},timeAxis:axisCommon(),logAxis:axisCommon(),valueAxis:axisCommon(),categoryAxis:axisCommon(),line:{symbol:"circle"},graph:{color:colorPalette},gauge:{title:{color:contrastColor},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:contrastColor},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};theme.categoryAxis.splitLine.show=!1;var ECEventProcessor=function(){function s(){}return s.prototype.normalizeQuery=function(a){var o={},c={},d={};if(isString$1(a)){var tt=parseClassType(a);o.mainType=tt.main||null,o.subType=tt.sub||null}else{var nt=["Index","Name","Id"],it={name:1,dataIndex:1,dataType:1};each$f(a,function(st,ut){for(var ct=!1,ot=0;ot<nt.length;ot++){var at=nt[ot],ht=ut.lastIndexOf(at);if(ht>0&&ht===ut.length-at.length){var ft=ut.slice(0,ht);ft!=="data"&&(o.mainType=ft,o[at.toLowerCase()]=st,ct=!0)}}it.hasOwnProperty(ut)&&(c[ut]=st,ct=!0),ct||(d[ut]=st)})}return{cptQuery:o,dataQuery:c,otherQuery:d}},s.prototype.filter=function(a,o){var c=this.eventInfo;if(!c)return!0;var d=c.targetEl,tt=c.packedEvent,nt=c.model,it=c.view;if(!nt||!it)return!0;var st=o.cptQuery,ut=o.dataQuery;return ct(st,nt,"mainType")&&ct(st,nt,"subType")&&ct(st,nt,"index","componentIndex")&&ct(st,nt,"name")&&ct(st,nt,"id")&&ct(ut,tt,"name")&&ct(ut,tt,"dataIndex")&&ct(ut,tt,"dataType")&&(!it.filterForExposedEvent||it.filterForExposedEvent(a,o.otherQuery,d,tt));function ct(ot,at,ht,ft){return ot[ht]==null||at[ft||ht]===ot[ht]}},s.prototype.afterTrigger=function(){this.eventInfo=null},s}(),SYMBOL_PROPS_WITH_CB=["symbol","symbolSize","symbolRotate","symbolOffset"],SYMBOL_PROPS=SYMBOL_PROPS_WITH_CB.concat(["symbolKeepAspect"]),seriesSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(s,a){var o=s.getData();if(s.legendIcon&&o.setVisual("legendIcon",s.legendIcon),!s.hasSymbolVisual)return;for(var c={},d={},tt=!1,nt=0;nt<SYMBOL_PROPS_WITH_CB.length;nt++){var it=SYMBOL_PROPS_WITH_CB[nt],st=s.get(it);isFunction$1(st)?(tt=!0,d[it]=st):c[it]=st}if(c.symbol=c.symbol||s.defaultSymbol,o.setVisual(extend({legendIcon:s.legendIcon||c.symbol,symbolKeepAspect:s.get("symbolKeepAspect")},c)),a.isSeriesFiltered(s))return;var ut=keys(d);function ct(ot,at){for(var ht=s.getRawValue(at),ft=s.getDataParams(at),mt=0;mt<ut.length;mt++){var yt=ut[mt];ot.setItemVisual(at,yt,d[yt](ht,ft))}}return{dataEach:tt?ct:null}}},dataSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(s,a){if(!s.hasSymbolVisual||a.isSeriesFiltered(s))return;var o=s.getData();function c(d,tt){for(var nt=d.getItemModel(tt),it=0;it<SYMBOL_PROPS.length;it++){var st=SYMBOL_PROPS[it],ut=nt.getShallow(st,!0);ut!=null&&d.setItemVisual(tt,st,ut)}}return{dataEach:o.hasItemOption?c:null}}};function getItemVisualFromData(s,a,o){switch(o){case"color":var c=s.getItemVisual(a,"style");return c[s.getVisual("drawType")];case"opacity":return s.getItemVisual(a,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return s.getItemVisual(a,o)}}function getVisualFromData(s,a){switch(a){case"color":var o=s.getVisual("style");return o[s.getVisual("drawType")];case"opacity":return s.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return s.getVisual(a)}}function setItemVisualFromData(s,a,o,c){switch(o){case"color":var d=s.ensureUniqueItemVisual(a,"style");d[s.getVisual("drawType")]=c,s.setItemVisual(a,"colorFromPalette",!1);break;case"opacity":s.ensureUniqueItemVisual(a,"style").opacity=c;break;case"symbol":case"symbolSize":case"liftZ":s.setItemVisual(a,o,c);break}}function createLegacyDataSelectAction(s,a){function o(c,d){var tt=[];return c.eachComponent({mainType:"series",subType:s,query:d},function(nt){tt.push(nt.seriesIndex)}),tt}each$f([[s+"ToggleSelect","toggleSelect"],[s+"Select","select"],[s+"UnSelect","unselect"]],function(c){a(c[0],function(d,tt,nt){d=extend({},d),nt.dispatchAction(extend(d,{type:c[1],seriesIndex:o(tt,d)}))})})}function handleSeriesLegacySelectEvents(s,a,o,c,d){var tt=s+a;o.isSilent(tt)||c.eachComponent({mainType:"series",subType:"pie"},function(nt){for(var it=nt.seriesIndex,st=nt.option.selectedMap,ut=d.selected,ct=0;ct<ut.length;ct++)if(ut[ct].seriesIndex===it){var ot=nt.getData(),at=queryDataIndex(ot,d.fromActionPayload);o.trigger(tt,{type:tt,seriesId:nt.id,name:isArray$1(at)?ot.getName(at[0]):ot.getName(at),selected:isString$1(st)?st:extend({},st)})}})}function handleLegacySelectEvents(s,a,o){s.on("selectchanged",function(c){var d=o.getModel();c.isFromClick?(handleSeriesLegacySelectEvents("map","selectchanged",a,d,c),handleSeriesLegacySelectEvents("pie","selectchanged",a,d,c)):c.fromAction==="select"?(handleSeriesLegacySelectEvents("map","selected",a,d,c),handleSeriesLegacySelectEvents("pie","selected",a,d,c)):c.fromAction==="unselect"&&(handleSeriesLegacySelectEvents("map","unselected",a,d,c),handleSeriesLegacySelectEvents("pie","unselected",a,d,c))})}function findEventDispatcher(s,a,o){for(var c;s&&!(a(s)&&(c=s,o));)s=s.__hostTarget||s.parent;return c}var wmUniqueIndex=Math.round(Math.random()*9),supportDefineProperty=typeof Object.defineProperty=="function",WeakMap$1=function(){function s(){this._id="__ec_inner_"+wmUniqueIndex++}return s.prototype.get=function(a){return this._guard(a)[this._id]},s.prototype.set=function(a,o){var c=this._guard(a);return supportDefineProperty?Object.defineProperty(c,this._id,{value:o,enumerable:!1,configurable:!0}):c[this._id]=o,this},s.prototype.delete=function(a){return this.has(a)?(delete this._guard(a)[this._id],!0):!1},s.prototype.has=function(a){return!!this._guard(a)[this._id]},s.prototype._guard=function(a){if(a!==Object(a))throw TypeError("Value of WeakMap is not a non-null object.");return a},s}(),Triangle=Path.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(s,a){var o=a.cx,c=a.cy,d=a.width/2,tt=a.height/2;s.moveTo(o,c-tt),s.lineTo(o+d,c+tt),s.lineTo(o-d,c+tt),s.closePath()}}),Diamond=Path.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(s,a){var o=a.cx,c=a.cy,d=a.width/2,tt=a.height/2;s.moveTo(o,c-tt),s.lineTo(o+d,c),s.lineTo(o,c+tt),s.lineTo(o-d,c),s.closePath()}}),Pin=Path.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(s,a){var o=a.x,c=a.y,d=a.width/5*3,tt=Math.max(d,a.height),nt=d/2,it=nt*nt/(tt-nt),st=c-tt+nt+it,ut=Math.asin(it/nt),ct=Math.cos(ut)*nt,ot=Math.sin(ut),at=Math.cos(ut),ht=nt*.6,ft=nt*.7;s.moveTo(o-ct,st+it),s.arc(o,st,nt,Math.PI-ut,Math.PI*2+ut),s.bezierCurveTo(o+ct-ot*ht,st+it+at*ht,o,c-ft,o,c),s.bezierCurveTo(o,c-ft,o-ct+ot*ht,st+it+at*ht,o-ct,st+it),s.closePath()}}),Arrow=Path.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(s,a){var o=a.height,c=a.width,d=a.x,tt=a.y,nt=c/3*2;s.moveTo(d,tt),s.lineTo(d+nt,tt+o),s.lineTo(d,tt+o/4*3),s.lineTo(d-nt,tt+o),s.lineTo(d,tt),s.closePath()}}),symbolCtors={line:Line$1,rect:Rect$2,roundRect:Rect$2,square:Rect$2,circle:Circle,diamond:Diamond,pin:Pin,arrow:Arrow,triangle:Triangle},symbolShapeMakers={line:function(s,a,o,c,d){d.x1=s,d.y1=a+c/2,d.x2=s+o,d.y2=a+c/2},rect:function(s,a,o,c,d){d.x=s,d.y=a,d.width=o,d.height=c},roundRect:function(s,a,o,c,d){d.x=s,d.y=a,d.width=o,d.height=c,d.r=Math.min(o,c)/4},square:function(s,a,o,c,d){var tt=Math.min(o,c);d.x=s,d.y=a,d.width=tt,d.height=tt},circle:function(s,a,o,c,d){d.cx=s+o/2,d.cy=a+c/2,d.r=Math.min(o,c)/2},diamond:function(s,a,o,c,d){d.cx=s+o/2,d.cy=a+c/2,d.width=o,d.height=c},pin:function(s,a,o,c,d){d.x=s+o/2,d.y=a+c/2,d.width=o,d.height=c},arrow:function(s,a,o,c,d){d.x=s+o/2,d.y=a+c/2,d.width=o,d.height=c},triangle:function(s,a,o,c,d){d.cx=s+o/2,d.cy=a+c/2,d.width=o,d.height=c}},symbolBuildProxies={};each$f(symbolCtors,function(s,a){symbolBuildProxies[a]=new s});var SymbolClz=Path.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(s,a,o){var c=calculateTextPosition(s,a,o),d=this.shape;return d&&d.symbolType==="pin"&&a.position==="inside"&&(c.y=o.y+o.height*.4),c},buildPath:function(s,a,o){var c=a.symbolType;if(c!=="none"){var d=symbolBuildProxies[c];d||(c="rect",d=symbolBuildProxies[c]),symbolShapeMakers[c](a.x,a.y,a.width,a.height,d.shape),d.buildPath(s,d.shape,o)}}});function symbolPathSetColor(s,a){if(this.type!=="image"){var o=this.style;this.__isEmptyBrush?(o.stroke=s,o.fill=a||"#fff",o.lineWidth=2):this.shape.symbolType==="line"?o.stroke=s:o.fill=s,this.markRedraw()}}function createSymbol$1(s,a,o,c,d,tt,nt){var it=s.indexOf("empty")===0;it&&(s=s.substr(5,1).toLowerCase()+s.substr(6));var st;return s.indexOf("image://")===0?st=makeImage(s.slice(8),new BoundingRect(a,o,c,d),nt?"center":"cover"):s.indexOf("path://")===0?st=makePath(s.slice(7),{},new BoundingRect(a,o,c,d),nt?"center":"cover"):st=new SymbolClz({shape:{symbolType:s,x:a,y:o,width:c,height:d}}),st.__isEmptyBrush=it,st.setColor=symbolPathSetColor,tt&&st.setColor(tt),st}function normalizeSymbolSize(s){return isArray$1(s)||(s=[+s,+s]),[s[0]||0,s[1]||0]}function normalizeSymbolOffset(s,a){if(s!=null)return isArray$1(s)||(s=[s,s]),[parsePercent(s[0],a[0])||0,parsePercent(retrieve2(s[1],s[0]),a[1])||0]}function isSafeNum(s){return isFinite(s)}function createLinearGradient(s,a,o){var c=a.x==null?0:a.x,d=a.x2==null?1:a.x2,tt=a.y==null?0:a.y,nt=a.y2==null?0:a.y2;a.global||(c=c*o.width+o.x,d=d*o.width+o.x,tt=tt*o.height+o.y,nt=nt*o.height+o.y),c=isSafeNum(c)?c:0,d=isSafeNum(d)?d:1,tt=isSafeNum(tt)?tt:0,nt=isSafeNum(nt)?nt:0;var it=s.createLinearGradient(c,tt,d,nt);return it}function createRadialGradient(s,a,o){var c=o.width,d=o.height,tt=Math.min(c,d),nt=a.x==null?.5:a.x,it=a.y==null?.5:a.y,st=a.r==null?.5:a.r;a.global||(nt=nt*c+o.x,it=it*d+o.y,st=st*tt),nt=isSafeNum(nt)?nt:.5,it=isSafeNum(it)?it:.5,st=st>=0&&isSafeNum(st)?st:.5;var ut=s.createRadialGradient(nt,it,0,nt,it,st);return ut}function getCanvasGradient(s,a,o){for(var c=a.type==="radial"?createRadialGradient(s,a,o):createLinearGradient(s,a,o),d=a.colorStops,tt=0;tt<d.length;tt++)c.addColorStop(d[tt].offset,d[tt].color);return c}function isClipPathChanged(s,a){if(s===a||!s&&!a)return!1;if(!s||!a||s.length!==a.length)return!0;for(var o=0;o<s.length;o++)if(s[o]!==a[o])return!0;return!1}function parseInt10(s){return parseInt(s,10)}function getSize$1(s,a,o){var c=["width","height"][a],d=["clientWidth","clientHeight"][a],tt=["paddingLeft","paddingTop"][a],nt=["paddingRight","paddingBottom"][a];if(o[c]!=null&&o[c]!=="auto")return parseFloat(o[c]);var it=document.defaultView.getComputedStyle(s);return(s[d]||parseInt10(it[c])||parseInt10(s.style[c]))-(parseInt10(it[tt])||0)-(parseInt10(it[nt])||0)|0}function normalizeLineDash(s,a){return!s||s==="solid"||!(a>0)?null:s==="dashed"?[4*a,2*a]:s==="dotted"?[a]:isNumber(s)?[s]:isArray$1(s)?s:null}function getLineDash(s){var a=s.style,o=a.lineDash&&a.lineWidth>0&&normalizeLineDash(a.lineDash,a.lineWidth),c=a.lineDashOffset;if(o){var d=a.strokeNoScale&&s.getLineScale?s.getLineScale():1;d&&d!==1&&(o=map$1(o,function(tt){return tt/d}),c/=d)}return[o,c]}var pathProxyForDraw=new PathProxy(!0);function styleHasStroke(s){var a=s.stroke;return!(a==null||a==="none"||!(s.lineWidth>0))}function isValidStrokeFillStyle(s){return typeof s=="string"&&s!=="none"}function styleHasFill(s){var a=s.fill;return a!=null&&a!=="none"}function doFillPath(s,a){if(a.fillOpacity!=null&&a.fillOpacity!==1){var o=s.globalAlpha;s.globalAlpha=a.fillOpacity*a.opacity,s.fill(),s.globalAlpha=o}else s.fill()}function doStrokePath(s,a){if(a.strokeOpacity!=null&&a.strokeOpacity!==1){var o=s.globalAlpha;s.globalAlpha=a.strokeOpacity*a.opacity,s.stroke(),s.globalAlpha=o}else s.stroke()}function createCanvasPattern(s,a,o){var c=createOrUpdateImage(a.image,a.__image,o);if(isImageReady(c)){var d=s.createPattern(c,a.repeat||"repeat");if(typeof DOMMatrix=="function"&&d&&d.setTransform){var tt=new DOMMatrix;tt.translateSelf(a.x||0,a.y||0),tt.rotateSelf(0,0,(a.rotation||0)*RADIAN_TO_DEGREE),tt.scaleSelf(a.scaleX||1,a.scaleY||1),d.setTransform(tt)}return d}}function brushPath(s,a,o,c){var d,tt=styleHasStroke(o),nt=styleHasFill(o),it=o.strokePercent,st=it<1,ut=!a.path;(!a.silent||st)&&ut&&a.createPathProxy();var ct=a.path||pathProxyForDraw,ot=a.__dirty;if(!c){var at=o.fill,ht=o.stroke,ft=nt&&!!at.colorStops,mt=tt&&!!ht.colorStops,yt=nt&&!!at.image,bt=tt&&!!ht.image,wt=void 0,Tt=void 0,Ct=void 0,Dt=void 0,Ot=void 0;(ft||mt)&&(Ot=a.getBoundingRect()),ft&&(wt=ot?getCanvasGradient(s,at,Ot):a.__canvasFillGradient,a.__canvasFillGradient=wt),mt&&(Tt=ot?getCanvasGradient(s,ht,Ot):a.__canvasStrokeGradient,a.__canvasStrokeGradient=Tt),yt&&(Ct=ot||!a.__canvasFillPattern?createCanvasPattern(s,at,a):a.__canvasFillPattern,a.__canvasFillPattern=Ct),bt&&(Dt=ot||!a.__canvasStrokePattern?createCanvasPattern(s,ht,a):a.__canvasStrokePattern,a.__canvasStrokePattern=Ct),ft?s.fillStyle=wt:yt&&(Ct?s.fillStyle=Ct:nt=!1),mt?s.strokeStyle=Tt:bt&&(Dt?s.strokeStyle=Dt:tt=!1)}var $t=a.getGlobalScale();ct.setScale($t[0],$t[1],a.segmentIgnoreThreshold);var Ft,kt;s.setLineDash&&o.lineDash&&(d=getLineDash(a),Ft=d[0],kt=d[1]);var Vt=!0;(ut||ot&SHAPE_CHANGED_BIT)&&(ct.setDPR(s.dpr),st?ct.setContext(null):(ct.setContext(s),Vt=!1),ct.reset(),a.buildPath(ct,a.shape,c),ct.toStatic(),a.pathUpdated()),Vt&&ct.rebuildPath(s,st?it:1),Ft&&(s.setLineDash(Ft),s.lineDashOffset=kt),c||(o.strokeFirst?(tt&&doStrokePath(s,o),nt&&doFillPath(s,o)):(nt&&doFillPath(s,o),tt&&doStrokePath(s,o))),Ft&&s.setLineDash([])}function brushImage(s,a,o){var c=a.__image=createOrUpdateImage(o.image,a.__image,a,a.onload);if(!(!c||!isImageReady(c))){var d=o.x||0,tt=o.y||0,nt=a.getWidth(),it=a.getHeight(),st=c.width/c.height;if(nt==null&&it!=null?nt=it*st:it==null&&nt!=null?it=nt/st:nt==null&&it==null&&(nt=c.width,it=c.height),o.sWidth&&o.sHeight){var ut=o.sx||0,ct=o.sy||0;s.drawImage(c,ut,ct,o.sWidth,o.sHeight,d,tt,nt,it)}else if(o.sx&&o.sy){var ut=o.sx,ct=o.sy,ot=nt-ut,at=it-ct;s.drawImage(c,ut,ct,ot,at,d,tt,nt,it)}else s.drawImage(c,d,tt,nt,it)}}function brushText(s,a,o){var c,d=o.text;if(d!=null&&(d+=""),d){s.font=o.font||DEFAULT_FONT,s.textAlign=o.textAlign,s.textBaseline=o.textBaseline;var tt=void 0,nt=void 0;s.setLineDash&&o.lineDash&&(c=getLineDash(a),tt=c[0],nt=c[1]),tt&&(s.setLineDash(tt),s.lineDashOffset=nt),o.strokeFirst?(styleHasStroke(o)&&s.strokeText(d,o.x,o.y),styleHasFill(o)&&s.fillText(d,o.x,o.y)):(styleHasFill(o)&&s.fillText(d,o.x,o.y),styleHasStroke(o)&&s.strokeText(d,o.x,o.y)),tt&&s.setLineDash([])}}var SHADOW_NUMBER_PROPS=["shadowBlur","shadowOffsetX","shadowOffsetY"],STROKE_PROPS=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function bindCommonProps(s,a,o,c,d){var tt=!1;if(!c&&(o=o||{},a===o))return!1;if(c||a.opacity!==o.opacity){flushPathDrawn(s,d),tt=!0;var nt=Math.max(Math.min(a.opacity,1),0);s.globalAlpha=isNaN(nt)?DEFAULT_COMMON_STYLE.opacity:nt}(c||a.blend!==o.blend)&&(tt||(flushPathDrawn(s,d),tt=!0),s.globalCompositeOperation=a.blend||DEFAULT_COMMON_STYLE.blend);for(var it=0;it<SHADOW_NUMBER_PROPS.length;it++){var st=SHADOW_NUMBER_PROPS[it];(c||a[st]!==o[st])&&(tt||(flushPathDrawn(s,d),tt=!0),s[st]=s.dpr*(a[st]||0))}return(c||a.shadowColor!==o.shadowColor)&&(tt||(flushPathDrawn(s,d),tt=!0),s.shadowColor=a.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),tt}function bindPathAndTextCommonStyle(s,a,o,c,d){var tt=getStyle(a,d.inHover),nt=c?null:o&&getStyle(o,d.inHover)||{};if(tt===nt)return!1;var it=bindCommonProps(s,tt,nt,c,d);if((c||tt.fill!==nt.fill)&&(it||(flushPathDrawn(s,d),it=!0),isValidStrokeFillStyle(tt.fill)&&(s.fillStyle=tt.fill)),(c||tt.stroke!==nt.stroke)&&(it||(flushPathDrawn(s,d),it=!0),isValidStrokeFillStyle(tt.stroke)&&(s.strokeStyle=tt.stroke)),(c||tt.opacity!==nt.opacity)&&(it||(flushPathDrawn(s,d),it=!0),s.globalAlpha=tt.opacity==null?1:tt.opacity),a.hasStroke()){var st=tt.lineWidth,ut=st/(tt.strokeNoScale&&a.getLineScale?a.getLineScale():1);s.lineWidth!==ut&&(it||(flushPathDrawn(s,d),it=!0),s.lineWidth=ut)}for(var ct=0;ct<STROKE_PROPS.length;ct++){var ot=STROKE_PROPS[ct],at=ot[0];(c||tt[at]!==nt[at])&&(it||(flushPathDrawn(s,d),it=!0),s[at]=tt[at]||ot[1])}return it}function bindImageStyle(s,a,o,c,d){return bindCommonProps(s,getStyle(a,d.inHover),o&&getStyle(o,d.inHover),c,d)}function setContextTransform(s,a){var o=a.transform,c=s.dpr||1;o?s.setTransform(c*o[0],c*o[1],c*o[2],c*o[3],c*o[4],c*o[5]):s.setTransform(c,0,0,c,0,0)}function updateClipStatus(s,a,o){for(var c=!1,d=0;d<s.length;d++){var tt=s[d];c=c||tt.isZeroArea(),setContextTransform(a,tt),a.beginPath(),tt.buildPath(a,tt.shape),a.clip()}o.allClipped=c}function isTransformChanged(s,a){return s&&a?s[0]!==a[0]||s[1]!==a[1]||s[2]!==a[2]||s[3]!==a[3]||s[4]!==a[4]||s[5]!==a[5]:!(!s&&!a)}var DRAW_TYPE_PATH=1,DRAW_TYPE_IMAGE=2,DRAW_TYPE_TEXT=3,DRAW_TYPE_INCREMENTAL=4;function canPathBatch(s){var a=styleHasFill(s),o=styleHasStroke(s);return!(s.lineDash||!(+a^+o)||a&&typeof s.fill!="string"||o&&typeof s.stroke!="string"||s.strokePercent<1||s.strokeOpacity<1||s.fillOpacity<1)}function flushPathDrawn(s,a){a.batchFill&&s.fill(),a.batchStroke&&s.stroke(),a.batchFill="",a.batchStroke=""}function getStyle(s,a){return a&&s.__hoverStyle||s.style}function brushSingle(s,a){brush$1(s,a,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush$1(s,a,o,c){var d=a.transform;if(!a.shouldBePainted(o.viewWidth,o.viewHeight,!1,!1)){a.__dirty&=~REDRAW_BIT,a.__isRendered=!1;return}var tt=a.__clipPaths,nt=o.prevElClipPaths,it=!1,st=!1;if((!nt||isClipPathChanged(tt,nt))&&(nt&&nt.length&&(flushPathDrawn(s,o),s.restore(),st=it=!0,o.prevElClipPaths=null,o.allClipped=!1,o.prevEl=null),tt&&tt.length&&(flushPathDrawn(s,o),s.save(),updateClipStatus(tt,s,o),it=!0),o.prevElClipPaths=tt),o.allClipped){a.__isRendered=!1;return}a.beforeBrush&&a.beforeBrush(),a.innerBeforeBrush();var ut=o.prevEl;ut||(st=it=!0);var ct=a instanceof Path&&a.autoBatch&&canPathBatch(a.style);it||isTransformChanged(d,ut.transform)?(flushPathDrawn(s,o),setContextTransform(s,a)):ct||flushPathDrawn(s,o);var ot=getStyle(a,o.inHover);a instanceof Path?(o.lastDrawType!==DRAW_TYPE_PATH&&(st=!0,o.lastDrawType=DRAW_TYPE_PATH),bindPathAndTextCommonStyle(s,a,ut,st,o),(!ct||!o.batchFill&&!o.batchStroke)&&s.beginPath(),brushPath(s,a,ot,ct),ct&&(o.batchFill=ot.fill||"",o.batchStroke=ot.stroke||"")):a instanceof TSpan?(o.lastDrawType!==DRAW_TYPE_TEXT&&(st=!0,o.lastDrawType=DRAW_TYPE_TEXT),bindPathAndTextCommonStyle(s,a,ut,st,o),brushText(s,a,ot)):a instanceof ZRImage?(o.lastDrawType!==DRAW_TYPE_IMAGE&&(st=!0,o.lastDrawType=DRAW_TYPE_IMAGE),bindImageStyle(s,a,ut,st,o),brushImage(s,a,ot)):a.getTemporalDisplayables&&(o.lastDrawType!==DRAW_TYPE_INCREMENTAL&&(st=!0,o.lastDrawType=DRAW_TYPE_INCREMENTAL),brushIncremental(s,a,o)),ct&&c&&flushPathDrawn(s,o),a.innerAfterBrush(),a.afterBrush&&a.afterBrush(),o.prevEl=a,a.__dirty=0,a.__isRendered=!0}function brushIncremental(s,a,o){var c=a.getDisplayables(),d=a.getTemporalDisplayables();s.save();var tt={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:o.viewWidth,viewHeight:o.viewHeight,inHover:o.inHover},nt,it;for(nt=a.getCursor(),it=c.length;nt<it;nt++){var st=c[nt];st.beforeBrush&&st.beforeBrush(),st.innerBeforeBrush(),brush$1(s,st,tt,nt===it-1),st.innerAfterBrush(),st.afterBrush&&st.afterBrush(),tt.prevEl=st}for(var ut=0,ct=d.length;ut<ct;ut++){var st=d[ut];st.beforeBrush&&st.beforeBrush(),st.innerBeforeBrush(),brush$1(s,st,tt,ut===ct-1),st.innerAfterBrush(),st.afterBrush&&st.afterBrush(),tt.prevEl=st}a.clearTemporalDisplayables(),a.notClear=!0,s.restore()}var decalMap=new WeakMap$1,decalCache=new LRU(100),decalKeys=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function createOrUpdatePatternFromDecal(s,a){if(s==="none")return null;var o=a.getDevicePixelRatio(),c=a.getZr(),d=c.painter.type==="svg";s.dirty&&decalMap.delete(s);var tt=decalMap.get(s);if(tt)return tt;var nt=defaults(s,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});nt.backgroundColor==="none"&&(nt.backgroundColor=null);var it={repeat:"repeat"};return st(it),it.rotation=nt.rotation,it.scaleX=it.scaleY=d?1:1/o,decalMap.set(s,it),s.dirty=!1,it;function st(ut){for(var ct=[o],ot=!0,at=0;at<decalKeys.length;++at){var ht=nt[decalKeys[at]];if(ht!=null&&!isArray$1(ht)&&!isString$1(ht)&&!isNumber(ht)&&typeof ht!="boolean"){ot=!1;break}ct.push(ht)}var ft;if(ot){ft=ct.join(",")+(d?"-svg":"");var mt=decalCache.get(ft);mt&&(d?ut.svgElement=mt:ut.image=mt)}var yt=normalizeDashArrayX(nt.dashArrayX),bt=normalizeDashArrayY(nt.dashArrayY),wt=normalizeSymbolArray(nt.symbol),Tt=getLineBlockLengthX(yt),Ct=getLineBlockLengthY(bt),Dt=!d&&platformApi.createCanvas(),Ot=d&&{tag:"g",attrs:{},key:"dcl",children:[]},$t=kt(),Ft;Dt&&(Dt.width=$t.width*o,Dt.height=$t.height*o,Ft=Dt.getContext("2d")),Vt(),ot&&decalCache.put(ft,Dt||Ot),ut.image=Dt,ut.svgElement=Ot,ut.svgWidth=$t.width,ut.svgHeight=$t.height;function kt(){for(var Ht=1,Qt=0,Xt=Tt.length;Qt<Xt;++Qt)Ht=getLeastCommonMultiple(Ht,Tt[Qt]);for(var Zt=1,Qt=0,Xt=wt.length;Qt<Xt;++Qt)Zt=getLeastCommonMultiple(Zt,wt[Qt].length);Ht*=Zt;var ar=Ct*Tt.length*wt.length;return{width:Math.max(1,Math.min(Ht,nt.maxTileWidth)),height:Math.max(1,Math.min(ar,nt.maxTileHeight))}}function Vt(){Ft&&(Ft.clearRect(0,0,Dt.width,Dt.height),nt.backgroundColor&&(Ft.fillStyle=nt.backgroundColor,Ft.fillRect(0,0,Dt.width,Dt.height)));for(var Ht=0,Qt=0;Qt<bt.length;++Qt)Ht+=bt[Qt];if(Ht<=0)return;for(var Xt=-Ct,Zt=0,ar=0,nr=0;Xt<$t.height;){if(Zt%2===0){for(var cr=ar/2%wt.length,dr=0,mr=0,Dr=0;dr<$t.width*2;){for(var kr=0,Qt=0;Qt<yt[nr].length;++Qt)kr+=yt[nr][Qt];if(kr<=0)break;if(mr%2===0){var Yr=(1-nt.symbolSize)*.5,Mr=dr+yt[nr][mr]*Yr,Jr=Xt+bt[Zt]*Yr,an=yt[nr][mr]*nt.symbolSize,xn=bt[Zt]*nt.symbolSize,Rn=Dr/2%wt[cr].length;hn(Mr,Jr,an,xn,wt[cr][Rn])}dr+=yt[nr][mr],++Dr,++mr,mr===yt[nr].length&&(mr=0)}++nr,nr===yt.length&&(nr=0)}Xt+=bt[Zt],++ar,++Zt,Zt===bt.length&&(Zt=0)}function hn(pn,yn,un,fn,Bn){var Dn=d?1:o,Qn=createSymbol$1(Bn,pn*Dn,yn*Dn,un*Dn,fn*Dn,nt.color,nt.symbolKeepAspect);if(d){var zr=c.painter.renderOneToVNode(Qn);zr&&Ot.children.push(zr)}else brushSingle(Ft,Qn)}}}}function normalizeSymbolArray(s){if(!s||s.length===0)return[["rect"]];if(isString$1(s))return[[s]];for(var a=!0,o=0;o<s.length;++o)if(!isString$1(s[o])){a=!1;break}if(a)return normalizeSymbolArray([s]);for(var c=[],o=0;o<s.length;++o)isString$1(s[o])?c.push([s[o]]):c.push(s[o]);return c}function normalizeDashArrayX(s){if(!s||s.length===0)return[[0,0]];if(isNumber(s)){var a=Math.ceil(s);return[[a,a]]}for(var o=!0,c=0;c<s.length;++c)if(!isNumber(s[c])){o=!1;break}if(o)return normalizeDashArrayX([s]);for(var d=[],c=0;c<s.length;++c)if(isNumber(s[c])){var a=Math.ceil(s[c]);d.push([a,a])}else{var a=map$1(s[c],function(it){return Math.ceil(it)});a.length%2===1?d.push(a.concat(a)):d.push(a)}return d}function normalizeDashArrayY(s){if(!s||typeof s=="object"&&s.length===0)return[0,0];if(isNumber(s)){var a=Math.ceil(s);return[a,a]}var o=map$1(s,function(c){return Math.ceil(c)});return s.length%2?o.concat(o):o}function getLineBlockLengthX(s){return map$1(s,function(a){return getLineBlockLengthY(a)})}function getLineBlockLengthY(s){for(var a=0,o=0;o<s.length;++o)a+=s[o];return s.length%2===1?a*2:a}function decalVisual(s,a){s.eachRawSeries(function(o){if(!s.isSeriesFiltered(o)){var c=o.getData();c.hasItemVisual()&&c.each(function(nt){var it=c.getItemVisual(nt,"decal");if(it){var st=c.ensureUniqueItemVisual(nt,"style");st.decal=createOrUpdatePatternFromDecal(it,a)}});var d=c.getVisual("decal");if(d){var tt=c.getVisual("style");tt.decal=createOrUpdatePatternFromDecal(d,a)}}})}var lifecycle=new Eventful,implsStore={};function registerImpl(s,a){implsStore[s]=a}function getImpl(s){return implsStore[s]}var version="5.6.0",dependencies={zrender:"5.6.1"},TEST_FRAME_REMAIN_TIME=1,PRIORITY_PROCESSOR_SERIES_FILTER=800,PRIORITY_PROCESSOR_DATASTACK=900,PRIORITY_PROCESSOR_FILTER=1e3,PRIORITY_PROCESSOR_DEFAULT=2e3,PRIORITY_PROCESSOR_STATISTIC=5e3,PRIORITY_VISUAL_LAYOUT=1e3,PRIORITY_VISUAL_PROGRESSIVE_LAYOUT=1100,PRIORITY_VISUAL_GLOBAL=2e3,PRIORITY_VISUAL_CHART=3e3,PRIORITY_VISUAL_COMPONENT=4e3,PRIORITY_VISUAL_CHART_DATA_CUSTOM=4500,PRIORITY_VISUAL_POST_CHART_LAYOUT=4600,PRIORITY_VISUAL_BRUSH=5e3,PRIORITY_VISUAL_ARIA=6e3,PRIORITY_VISUAL_DECAL=7e3,PRIORITY={PROCESSOR:{FILTER:PRIORITY_PROCESSOR_FILTER,SERIES_FILTER:PRIORITY_PROCESSOR_SERIES_FILTER,STATISTIC:PRIORITY_PROCESSOR_STATISTIC},VISUAL:{LAYOUT:PRIORITY_VISUAL_LAYOUT,PROGRESSIVE_LAYOUT:PRIORITY_VISUAL_PROGRESSIVE_LAYOUT,GLOBAL:PRIORITY_VISUAL_GLOBAL,CHART:PRIORITY_VISUAL_CHART,POST_CHART_LAYOUT:PRIORITY_VISUAL_POST_CHART_LAYOUT,COMPONENT:PRIORITY_VISUAL_COMPONENT,BRUSH:PRIORITY_VISUAL_BRUSH,CHART_ITEM:PRIORITY_VISUAL_CHART_DATA_CUSTOM,ARIA:PRIORITY_VISUAL_ARIA,DECAL:PRIORITY_VISUAL_DECAL}},IN_MAIN_PROCESS_KEY="__flagInMainProcess",PENDING_UPDATE="__pendingUpdate",STATUS_NEEDS_UPDATE_KEY="__needsUpdateStatus",ACTION_REG=/^[a-zA-Z0-9_]+$/,CONNECT_STATUS_KEY="__connectUpdateStatus",CONNECT_STATUS_PENDING=0,CONNECT_STATUS_UPDATING=1,CONNECT_STATUS_UPDATED=2;function createRegisterEventWithLowercaseECharts(s){return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(this.isDisposed()){this.id;return}return toLowercaseNameAndCallEventful(this,s,a)}}function createRegisterEventWithLowercaseMessageCenter(s){return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return toLowercaseNameAndCallEventful(this,s,a)}}function toLowercaseNameAndCallEventful(s,a,o){return o[0]=o[0]&&o[0].toLowerCase(),Eventful.prototype[a].apply(s,o)}var MessageCenter=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a}(Eventful),messageCenterProto=MessageCenter.prototype;messageCenterProto.on=createRegisterEventWithLowercaseMessageCenter("on");messageCenterProto.off=createRegisterEventWithLowercaseMessageCenter("off");var prepare,prepareView,updateDirectly,updateMethods,doConvertPixel,updateStreamModes,doDispatchAction,flushPendingActions,triggerUpdatedEvent,bindRenderedEvent,bindMouseEvent,render,renderComponents,renderSeries,createExtensionAPI,enableConnect,markStatusToUpdate,applyChangedStates,ECharts=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this,new ECEventProcessor)||this;tt._chartsViews=[],tt._chartsMap={},tt._componentsViews=[],tt._componentsMap={},tt._pendingActions=[],d=d||{},isString$1(c)&&(c=themeStorage[c]),tt._dom=o;var nt="canvas",it="auto",st=!1;d.ssr&&registerSSRDataGetter(function(at){var ht=getECData(at),ft=ht.dataIndex;if(ft!=null){var mt=createHashMap();return mt.set("series_index",ht.seriesIndex),mt.set("data_index",ft),ht.ssrType&&mt.set("ssr_type",ht.ssrType),mt}});var ut=tt._zr=init$2(o,{renderer:d.renderer||nt,devicePixelRatio:d.devicePixelRatio,width:d.width,height:d.height,ssr:d.ssr,useDirtyRect:retrieve2(d.useDirtyRect,st),useCoarsePointer:retrieve2(d.useCoarsePointer,it),pointerSize:d.pointerSize});tt._ssr=d.ssr,tt._throttledZrFlush=throttle(bind$2(ut.flush,ut),17),c=clone$4(c),c&&globalBackwardCompat(c,!0),tt._theme=c,tt._locale=createLocaleObject(d.locale||SYSTEM_LANG),tt._coordSysMgr=new CoordinateSystemManager;var ct=tt._api=createExtensionAPI(tt);function ot(at,ht){return at.__prio-ht.__prio}return sort$2(visualFuncs,ot),sort$2(dataProcessorFuncs,ot),tt._scheduler=new Scheduler(tt,ct,dataProcessorFuncs,visualFuncs),tt._messageCenter=new MessageCenter,tt._initEvents(),tt.resize=bind$2(tt.resize,tt),ut.animation.on("frame",tt._onframe,tt),bindRenderedEvent(ut,tt),bindMouseEvent(ut,tt),setAsPrimitive(tt),tt}return a.prototype._onframe=function(){if(!this._disposed){applyChangedStates(this);var o=this._scheduler;if(this[PENDING_UPDATE]){var c=this[PENDING_UPDATE].silent;this[IN_MAIN_PROCESS_KEY]=!0;try{prepare(this),updateMethods.update.call(this,null,this[PENDING_UPDATE].updateParams)}catch(st){throw this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,st}this._zr.flush(),this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,flushPendingActions.call(this,c),triggerUpdatedEvent.call(this,c)}else if(o.unfinished){var d=TEST_FRAME_REMAIN_TIME,tt=this._model,nt=this._api;o.unfinished=!1;do{var it=+new Date;o.performSeriesTasks(tt),o.performDataProcessorTasks(tt),updateStreamModes(this,tt),o.performVisualTasks(tt),renderSeries(this,this._model,nt,"remain",{}),d-=+new Date-it}while(d>0&&o.unfinished);o.unfinished||this._zr.flush()}}},a.prototype.getDom=function(){return this._dom},a.prototype.getId=function(){return this.id},a.prototype.getZr=function(){return this._zr},a.prototype.isSSR=function(){return this._ssr},a.prototype.setOption=function(o,c,d){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}var tt,nt,it;if(isObject$3(c)&&(d=c.lazyUpdate,tt=c.silent,nt=c.replaceMerge,it=c.transition,c=c.notMerge),this[IN_MAIN_PROCESS_KEY]=!0,!this._model||c){var st=new OptionManager(this._api),ut=this._theme,ct=this._model=new GlobalModel;ct.scheduler=this._scheduler,ct.ssr=this._ssr,ct.init(null,null,null,ut,this._locale,st)}this._model.setOption(o,{replaceMerge:nt},optionPreprocessorFuncs);var ot={seriesTransition:it,optionChanged:!0};if(d)this[PENDING_UPDATE]={silent:tt,updateParams:ot},this[IN_MAIN_PROCESS_KEY]=!1,this.getZr().wakeUp();else{try{prepare(this),updateMethods.update.call(this,null,ot)}catch(at){throw this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,at}this._ssr||this._zr.flush(),this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,tt),triggerUpdatedEvent.call(this,tt)}}},a.prototype.setTheme=function(){},a.prototype.getModel=function(){return this._model},a.prototype.getOption=function(){return this._model&&this._model.getOption()},a.prototype.getWidth=function(){return this._zr.getWidth()},a.prototype.getHeight=function(){return this._zr.getHeight()},a.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||env.hasGlobalWindow&&window.devicePixelRatio||1},a.prototype.getRenderedCanvas=function(o){return this.renderToCanvas(o)},a.prototype.renderToCanvas=function(o){o=o||{};var c=this._zr.painter;return c.getRenderedCanvas({backgroundColor:o.backgroundColor||this._model.get("backgroundColor"),pixelRatio:o.pixelRatio||this.getDevicePixelRatio()})},a.prototype.renderToSVGString=function(o){o=o||{};var c=this._zr.painter;return c.renderToString({useViewBox:o.useViewBox})},a.prototype.getSvgDataURL=function(){if(env.svgSupported){var o=this._zr,c=o.storage.getDisplayList();return each$f(c,function(d){d.stopAnimation(null,!0)}),o.painter.toDataURL()}},a.prototype.getDataURL=function(o){if(this._disposed){this.id;return}o=o||{};var c=o.excludeComponents,d=this._model,tt=[],nt=this;each$f(c,function(st){d.eachComponent({mainType:st},function(ut){var ct=nt._componentsMap[ut.__viewId];ct.group.ignore||(tt.push(ct),ct.group.ignore=!0)})});var it=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(o).toDataURL("image/"+(o&&o.type||"png"));return each$f(tt,function(st){st.group.ignore=!1}),it},a.prototype.getConnectedDataURL=function(o){if(this._disposed){this.id;return}var c=o.type==="svg",d=this.group,tt=Math.min,nt=Math.max,it=1/0;if(connectedGroups[d]){var st=it,ut=it,ct=-it,ot=-it,at=[],ht=o&&o.pixelRatio||this.getDevicePixelRatio();each$f(instances,function(Tt,Ct){if(Tt.group===d){var Dt=c?Tt.getZr().painter.getSvgDom().innerHTML:Tt.renderToCanvas(clone$4(o)),Ot=Tt.getDom().getBoundingClientRect();st=tt(Ot.left,st),ut=tt(Ot.top,ut),ct=nt(Ot.right,ct),ot=nt(Ot.bottom,ot),at.push({dom:Dt,left:Ot.left,top:Ot.top})}}),st*=ht,ut*=ht,ct*=ht,ot*=ht;var ft=ct-st,mt=ot-ut,yt=platformApi.createCanvas(),bt=init$2(yt,{renderer:c?"svg":"canvas"});if(bt.resize({width:ft,height:mt}),c){var wt="";return each$f(at,function(Tt){var Ct=Tt.left-st,Dt=Tt.top-ut;wt+='<g transform="translate('+Ct+","+Dt+')">'+Tt.dom+"</g>"}),bt.painter.getSvgRoot().innerHTML=wt,o.connectedBackgroundColor&&bt.painter.setBackgroundColor(o.connectedBackgroundColor),bt.refreshImmediately(),bt.painter.toDataURL()}else return o.connectedBackgroundColor&&bt.add(new Rect$2({shape:{x:0,y:0,width:ft,height:mt},style:{fill:o.connectedBackgroundColor}})),each$f(at,function(Tt){var Ct=new ZRImage({style:{x:Tt.left*ht-st,y:Tt.top*ht-ut,image:Tt.dom}});bt.add(Ct)}),bt.refreshImmediately(),yt.toDataURL("image/"+(o&&o.type||"png"))}else return this.getDataURL(o)},a.prototype.convertToPixel=function(o,c){return doConvertPixel(this,"convertToPixel",o,c)},a.prototype.convertFromPixel=function(o,c){return doConvertPixel(this,"convertFromPixel",o,c)},a.prototype.containPixel=function(o,c){if(this._disposed){this.id;return}var d=this._model,tt,nt=parseFinder$1(d,o);return each$f(nt,function(it,st){st.indexOf("Models")>=0&&each$f(it,function(ut){var ct=ut.coordinateSystem;if(ct&&ct.containPoint)tt=tt||!!ct.containPoint(c);else if(st==="seriesModels"){var ot=this._chartsMap[ut.__viewId];ot&&ot.containPoint&&(tt=tt||ot.containPoint(c,ut))}},this)},this),!!tt},a.prototype.getVisual=function(o,c){var d=this._model,tt=parseFinder$1(d,o,{defaultMainType:"series"}),nt=tt.seriesModel,it=nt.getData(),st=tt.hasOwnProperty("dataIndexInside")?tt.dataIndexInside:tt.hasOwnProperty("dataIndex")?it.indexOfRawIndex(tt.dataIndex):null;return st!=null?getItemVisualFromData(it,st,c):getVisualFromData(it,c)},a.prototype.getViewOfComponentModel=function(o){return this._componentsMap[o.__viewId]},a.prototype.getViewOfSeriesModel=function(o){return this._chartsMap[o.__viewId]},a.prototype._initEvents=function(){var o=this;each$f(MOUSE_EVENT_NAMES,function(c){var d=function(tt){var nt=o.getModel(),it=tt.target,st,ut=c==="globalout";if(ut?st={}:it&&findEventDispatcher(it,function(ft){var mt=getECData(ft);if(mt&&mt.dataIndex!=null){var yt=mt.dataModel||nt.getSeriesByIndex(mt.seriesIndex);return st=yt&&yt.getDataParams(mt.dataIndex,mt.dataType,it)||{},!0}else if(mt.eventData)return st=extend({},mt.eventData),!0},!0),st){var ct=st.componentType,ot=st.componentIndex;(ct==="markLine"||ct==="markPoint"||ct==="markArea")&&(ct="series",ot=st.seriesIndex);var at=ct&&ot!=null&&nt.getComponent(ct,ot),ht=at&&o[at.mainType==="series"?"_chartsMap":"_componentsMap"][at.__viewId];st.event=tt,st.type=c,o._$eventProcessor.eventInfo={targetEl:it,packedEvent:st,model:at,view:ht},o.trigger(c,st)}};d.zrEventfulCallAtLast=!0,o._zr.on(c,d,o)}),each$f(eventActionMap,function(c,d){o._messageCenter.on(d,function(tt){this.trigger(d,tt)},o)}),each$f(["selectchanged"],function(c){o._messageCenter.on(c,function(d){this.trigger(c,d)},o)}),handleLegacySelectEvents(this._messageCenter,this,this._api)},a.prototype.isDisposed=function(){return this._disposed},a.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},a.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var o=this.getDom();o&&setAttribute(this.getDom(),DOM_ATTRIBUTE_KEY,"");var c=this,d=c._api,tt=c._model;each$f(c._componentsViews,function(nt){nt.dispose(tt,d)}),each$f(c._chartsViews,function(nt){nt.dispose(tt,d)}),c._zr.dispose(),c._dom=c._model=c._chartsMap=c._componentsMap=c._chartsViews=c._componentsViews=c._scheduler=c._api=c._zr=c._throttledZrFlush=c._theme=c._coordSysMgr=c._messageCenter=null,delete instances[c.id]},a.prototype.resize=function(o){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}this._zr.resize(o);var c=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!c){var d=c.resetOption("media"),tt=o&&o.silent;this[PENDING_UPDATE]&&(tt==null&&(tt=this[PENDING_UPDATE].silent),d=!0,this[PENDING_UPDATE]=null),this[IN_MAIN_PROCESS_KEY]=!0;try{d&&prepare(this),updateMethods.update.call(this,{type:"resize",animation:extend({duration:0},o&&o.animation)})}catch(nt){throw this[IN_MAIN_PROCESS_KEY]=!1,nt}this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,tt),triggerUpdatedEvent.call(this,tt)}}},a.prototype.showLoading=function(o,c){if(this._disposed){this.id;return}if(isObject$3(o)&&(c=o,o=""),o=o||"default",this.hideLoading(),!!loadingEffects[o]){var d=loadingEffects[o](this._api,c),tt=this._zr;this._loadingFX=d,tt.add(d)}},a.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},a.prototype.makeActionFromEvent=function(o){var c=extend({},o);return c.type=eventActionMap[o.type],c},a.prototype.dispatchAction=function(o,c){if(this._disposed){this.id;return}if(isObject$3(c)||(c={silent:!!c}),!!actions[o.type]&&this._model){if(this[IN_MAIN_PROCESS_KEY]){this._pendingActions.push(o);return}var d=c.silent;doDispatchAction.call(this,o,d);var tt=c.flush;tt?this._zr.flush():tt!==!1&&env.browser.weChat&&this._throttledZrFlush(),flushPendingActions.call(this,d),triggerUpdatedEvent.call(this,d)}},a.prototype.updateLabelLayout=function(){lifecycle.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},a.prototype.appendData=function(o){if(this._disposed){this.id;return}var c=o.seriesIndex,d=this.getModel(),tt=d.getSeriesByIndex(c);tt.appendData(o),this._scheduler.unfinished=!0,this.getZr().wakeUp()},a.internalField=function(){prepare=function(ot){var at=ot._scheduler;at.restorePipelines(ot._model),at.prepareStageTasks(),prepareView(ot,!0),prepareView(ot,!1),at.plan()},prepareView=function(ot,at){for(var ht=ot._model,ft=ot._scheduler,mt=at?ot._componentsViews:ot._chartsViews,yt=at?ot._componentsMap:ot._chartsMap,bt=ot._zr,wt=ot._api,Tt=0;Tt<mt.length;Tt++)mt[Tt].__alive=!1;at?ht.eachComponent(function(Ot,$t){Ot!=="series"&&Ct($t)}):ht.eachSeries(Ct);function Ct(Ot){var $t=Ot.__requireNewView;Ot.__requireNewView=!1;var Ft="_ec_"+Ot.id+"_"+Ot.type,kt=!$t&&yt[Ft];if(!kt){var Vt=parseClassType(Ot.type),Ht=at?ComponentView.getClass(Vt.main,Vt.sub):ChartView.getClass(Vt.sub);kt=new Ht,kt.init(ht,wt),yt[Ft]=kt,mt.push(kt),bt.add(kt.group)}Ot.__viewId=kt.__id=Ft,kt.__alive=!0,kt.__model=Ot,kt.group.__ecComponentInfo={mainType:Ot.mainType,index:Ot.componentIndex},!at&&ft.prepareView(kt,Ot,ht,wt)}for(var Tt=0;Tt<mt.length;){var Dt=mt[Tt];Dt.__alive?Tt++:(!at&&Dt.renderTask.dispose(),bt.remove(Dt.group),Dt.dispose(ht,wt),mt.splice(Tt,1),yt[Dt.__id]===Dt&&delete yt[Dt.__id],Dt.__id=Dt.group.__ecComponentInfo=null)}},updateDirectly=function(ot,at,ht,ft,mt){var yt=ot._model;if(yt.setUpdatePayload(ht),!ft){each$f([].concat(ot._componentsViews).concat(ot._chartsViews),Dt);return}var bt={};bt[ft+"Id"]=ht[ft+"Id"],bt[ft+"Index"]=ht[ft+"Index"],bt[ft+"Name"]=ht[ft+"Name"];var wt={mainType:ft,query:bt};mt&&(wt.subType=mt);var Tt=ht.excludeSeriesId,Ct;Tt!=null&&(Ct=createHashMap(),each$f(normalizeToArray(Tt),function(Ot){var $t=convertOptionIdName(Ot,null);$t!=null&&Ct.set($t,!0)})),yt&&yt.eachComponent(wt,function(Ot){var $t=Ct&&Ct.get(Ot.id)!=null;if(!$t)if(isHighDownPayload(ht))if(Ot instanceof SeriesModel)ht.type===HIGHLIGHT_ACTION_TYPE&&!ht.notBlur&&!Ot.get(["emphasis","disabled"])&&blurSeriesFromHighlightPayload(Ot,ht,ot._api);else{var Ft=findComponentHighDownDispatchers(Ot.mainType,Ot.componentIndex,ht.name,ot._api),kt=Ft.focusSelf,Vt=Ft.dispatchers;ht.type===HIGHLIGHT_ACTION_TYPE&&kt&&!ht.notBlur&&blurComponent(Ot.mainType,Ot.componentIndex,ot._api),Vt&&each$f(Vt,function(Ht){ht.type===HIGHLIGHT_ACTION_TYPE?enterEmphasis(Ht):leaveEmphasis(Ht)})}else isSelectChangePayload(ht)&&Ot instanceof SeriesModel&&(toggleSelectionFromPayload(Ot,ht,ot._api),updateSeriesElementSelection(Ot),markStatusToUpdate(ot))},ot),yt&&yt.eachComponent(wt,function(Ot){var $t=Ct&&Ct.get(Ot.id)!=null;$t||Dt(ot[ft==="series"?"_chartsMap":"_componentsMap"][Ot.__viewId])},ot);function Dt(Ot){Ot&&Ot.__alive&&Ot[at]&&Ot[at](Ot.__model,yt,ot._api,ht)}},updateMethods={prepareAndUpdate:function(ot){prepare(this),updateMethods.update.call(this,ot,{optionChanged:ot.newOption!=null})},update:function(ot,at){var ht=this._model,ft=this._api,mt=this._zr,yt=this._coordSysMgr,bt=this._scheduler;if(ht){ht.setUpdatePayload(ot),bt.restoreData(ht,ot),bt.performSeriesTasks(ht),yt.create(ht,ft),bt.performDataProcessorTasks(ht,ot),updateStreamModes(this,ht),yt.update(ht,ft),o(ht),bt.performVisualTasks(ht,ot),render(this,ht,ft,ot,at);var wt=ht.get("backgroundColor")||"transparent",Tt=ht.get("darkMode");mt.setBackgroundColor(wt),Tt!=null&&Tt!=="auto"&&mt.setDarkMode(Tt),lifecycle.trigger("afterupdate",ht,ft)}},updateTransform:function(ot){var at=this,ht=this._model,ft=this._api;if(ht){ht.setUpdatePayload(ot);var mt=[];ht.eachComponent(function(bt,wt){if(bt!=="series"){var Tt=at.getViewOfComponentModel(wt);if(Tt&&Tt.__alive)if(Tt.updateTransform){var Ct=Tt.updateTransform(wt,ht,ft,ot);Ct&&Ct.update&&mt.push(Tt)}else mt.push(Tt)}});var yt=createHashMap();ht.eachSeries(function(bt){var wt=at._chartsMap[bt.__viewId];if(wt.updateTransform){var Tt=wt.updateTransform(bt,ht,ft,ot);Tt&&Tt.update&&yt.set(bt.uid,1)}else yt.set(bt.uid,1)}),o(ht),this._scheduler.performVisualTasks(ht,ot,{setDirty:!0,dirtyMap:yt}),renderSeries(this,ht,ft,ot,{},yt),lifecycle.trigger("afterupdate",ht,ft)}},updateView:function(ot){var at=this._model;at&&(at.setUpdatePayload(ot),ChartView.markUpdateMethod(ot,"updateView"),o(at),this._scheduler.performVisualTasks(at,ot,{setDirty:!0}),render(this,at,this._api,ot,{}),lifecycle.trigger("afterupdate",at,this._api))},updateVisual:function(ot){var at=this,ht=this._model;ht&&(ht.setUpdatePayload(ot),ht.eachSeries(function(ft){ft.getData().clearAllVisual()}),ChartView.markUpdateMethod(ot,"updateVisual"),o(ht),this._scheduler.performVisualTasks(ht,ot,{visualType:"visual",setDirty:!0}),ht.eachComponent(function(ft,mt){if(ft!=="series"){var yt=at.getViewOfComponentModel(mt);yt&&yt.__alive&&yt.updateVisual(mt,ht,at._api,ot)}}),ht.eachSeries(function(ft){var mt=at._chartsMap[ft.__viewId];mt.updateVisual(ft,ht,at._api,ot)}),lifecycle.trigger("afterupdate",ht,this._api))},updateLayout:function(ot){updateMethods.update.call(this,ot)}},doConvertPixel=function(ot,at,ht,ft){if(ot._disposed){ot.id;return}for(var mt=ot._model,yt=ot._coordSysMgr.getCoordinateSystems(),bt,wt=parseFinder$1(mt,ht),Tt=0;Tt<yt.length;Tt++){var Ct=yt[Tt];if(Ct[at]&&(bt=Ct[at](mt,wt,ft))!=null)return bt}},updateStreamModes=function(ot,at){var ht=ot._chartsMap,ft=ot._scheduler;at.eachSeries(function(mt){ft.updateStreamModes(mt,ht[mt.__viewId])})},doDispatchAction=function(ot,at){var ht=this,ft=this.getModel(),mt=ot.type,yt=ot.escapeConnect,bt=actions[mt],wt=bt.actionInfo,Tt=(wt.update||"update").split(":"),Ct=Tt.pop(),Dt=Tt[0]!=null&&parseClassType(Tt[0]);this[IN_MAIN_PROCESS_KEY]=!0;var Ot=[ot],$t=!1;ot.batch&&($t=!0,Ot=map$1(ot.batch,function(Zt){return Zt=defaults(extend({},Zt),ot),Zt.batch=null,Zt}));var Ft=[],kt,Vt=isSelectChangePayload(ot),Ht=isHighDownPayload(ot);if(Ht&&allLeaveBlur(this._api),each$f(Ot,function(Zt){if(kt=bt.action(Zt,ht._model,ht._api),kt=kt||extend({},Zt),kt.type=wt.event||kt.type,Ft.push(kt),Ht){var ar=preParseFinder(ot),nr=ar.queryOptionMap,cr=ar.mainTypeSpecified,dr=cr?nr.keys()[0]:"series";updateDirectly(ht,Ct,Zt,dr),markStatusToUpdate(ht)}else Vt?(updateDirectly(ht,Ct,Zt,"series"),markStatusToUpdate(ht)):Dt&&updateDirectly(ht,Ct,Zt,Dt.main,Dt.sub)}),Ct!=="none"&&!Ht&&!Vt&&!Dt)try{this[PENDING_UPDATE]?(prepare(this),updateMethods.update.call(this,ot),this[PENDING_UPDATE]=null):updateMethods[Ct].call(this,ot)}catch(Zt){throw this[IN_MAIN_PROCESS_KEY]=!1,Zt}if($t?kt={type:wt.event||mt,escapeConnect:yt,batch:Ft}:kt=Ft[0],this[IN_MAIN_PROCESS_KEY]=!1,!at){var Qt=this._messageCenter;if(Qt.trigger(kt.type,kt),Vt){var Xt={type:"selectchanged",escapeConnect:yt,selected:getAllSelectedIndices(ft),isFromClick:ot.isFromClick||!1,fromAction:ot.type,fromActionPayload:ot};Qt.trigger(Xt.type,Xt)}}},flushPendingActions=function(ot){for(var at=this._pendingActions;at.length;){var ht=at.shift();doDispatchAction.call(this,ht,ot)}},triggerUpdatedEvent=function(ot){!ot&&this.trigger("updated")},bindRenderedEvent=function(ot,at){ot.on("rendered",function(ht){at.trigger("rendered",ht),ot.animation.isFinished()&&!at[PENDING_UPDATE]&&!at._scheduler.unfinished&&!at._pendingActions.length&&at.trigger("finished")})},bindMouseEvent=function(ot,at){ot.on("mouseover",function(ht){var ft=ht.target,mt=findEventDispatcher(ft,isHighDownDispatcher);mt&&(handleGlobalMouseOverForHighDown(mt,ht,at._api),markStatusToUpdate(at))}).on("mouseout",function(ht){var ft=ht.target,mt=findEventDispatcher(ft,isHighDownDispatcher);mt&&(handleGlobalMouseOutForHighDown(mt,ht,at._api),markStatusToUpdate(at))}).on("click",function(ht){var ft=ht.target,mt=findEventDispatcher(ft,function(wt){return getECData(wt).dataIndex!=null},!0);if(mt){var yt=mt.selected?"unselect":"select",bt=getECData(mt);at._api.dispatchAction({type:yt,dataType:bt.dataType,dataIndexInside:bt.dataIndex,seriesIndex:bt.seriesIndex,isFromClick:!0})}})};function o(ot){ot.clearColorPalette(),ot.eachSeries(function(at){at.clearColorPalette()})}function c(ot){var at=[],ht=[],ft=!1;if(ot.eachComponent(function(wt,Tt){var Ct=Tt.get("zlevel")||0,Dt=Tt.get("z")||0,Ot=Tt.getZLevelKey();ft=ft||!!Ot,(wt==="series"?ht:at).push({zlevel:Ct,z:Dt,idx:Tt.componentIndex,type:wt,key:Ot})}),ft){var mt=at.concat(ht),yt,bt;sort$2(mt,function(wt,Tt){return wt.zlevel===Tt.zlevel?wt.z-Tt.z:wt.zlevel-Tt.zlevel}),each$f(mt,function(wt){var Tt=ot.getComponent(wt.type,wt.idx),Ct=wt.zlevel,Dt=wt.key;yt!=null&&(Ct=Math.max(yt,Ct)),Dt?(Ct===yt&&Dt!==bt&&Ct++,bt=Dt):bt&&(Ct===yt&&Ct++,bt=""),yt=Ct,Tt.setZLevel(Ct)})}}render=function(ot,at,ht,ft,mt){c(at),renderComponents(ot,at,ht,ft,mt),each$f(ot._chartsViews,function(yt){yt.__alive=!1}),renderSeries(ot,at,ht,ft,mt),each$f(ot._chartsViews,function(yt){yt.__alive||yt.remove(at,ht)})},renderComponents=function(ot,at,ht,ft,mt,yt){each$f(yt||ot._componentsViews,function(bt){var wt=bt.__model;ut(wt,bt),bt.render(wt,at,ht,ft),it(wt,bt),ct(wt,bt)})},renderSeries=function(ot,at,ht,ft,mt,yt){var bt=ot._scheduler;mt=extend(mt||{},{updatedSeries:at.getSeries()}),lifecycle.trigger("series:beforeupdate",at,ht,mt);var wt=!1;at.eachSeries(function(Tt){var Ct=ot._chartsMap[Tt.__viewId];Ct.__alive=!0;var Dt=Ct.renderTask;bt.updatePayload(Dt,ft),ut(Tt,Ct),yt&&yt.get(Tt.uid)&&Dt.dirty(),Dt.perform(bt.getPerformArgs(Dt))&&(wt=!0),Ct.group.silent=!!Tt.get("silent"),nt(Tt,Ct),updateSeriesElementSelection(Tt)}),bt.unfinished=wt||bt.unfinished,lifecycle.trigger("series:layoutlabels",at,ht,mt),lifecycle.trigger("series:transition",at,ht,mt),at.eachSeries(function(Tt){var Ct=ot._chartsMap[Tt.__viewId];it(Tt,Ct),ct(Tt,Ct)}),tt(ot,at),lifecycle.trigger("series:afterupdate",at,ht,mt)},markStatusToUpdate=function(ot){ot[STATUS_NEEDS_UPDATE_KEY]=!0,ot.getZr().wakeUp()},applyChangedStates=function(ot){ot[STATUS_NEEDS_UPDATE_KEY]&&(ot.getZr().storage.traverse(function(at){isElementRemoved(at)||d(at)}),ot[STATUS_NEEDS_UPDATE_KEY]=!1)};function d(ot){for(var at=[],ht=ot.currentStates,ft=0;ft<ht.length;ft++){var mt=ht[ft];mt==="emphasis"||mt==="blur"||mt==="select"||at.push(mt)}ot.selected&&ot.states.select&&at.push("select"),ot.hoverState===HOVER_STATE_EMPHASIS&&ot.states.emphasis?at.push("emphasis"):ot.hoverState===HOVER_STATE_BLUR&&ot.states.blur&&at.push("blur"),ot.useStates(at)}function tt(ot,at){var ht=ot._zr,ft=ht.storage,mt=0;ft.traverse(function(yt){yt.isGroup||mt++}),mt>at.get("hoverLayerThreshold")&&!env.node&&!env.worker&&at.eachSeries(function(yt){if(!yt.preventUsingHoverLayer){var bt=ot._chartsMap[yt.__viewId];bt.__alive&&bt.eachRendered(function(wt){wt.states.emphasis&&(wt.states.emphasis.hoverLayer=!0)})}})}function nt(ot,at){var ht=ot.get("blendMode")||null;at.eachRendered(function(ft){ft.isGroup||(ft.style.blend=ht)})}function it(ot,at){if(!ot.preventAutoZ){var ht=ot.get("z")||0,ft=ot.get("zlevel")||0;at.eachRendered(function(mt){return st(mt,ht,ft,-1/0),!0})}}function st(ot,at,ht,ft){var mt=ot.getTextContent(),yt=ot.getTextGuideLine(),bt=ot.isGroup;if(bt)for(var wt=ot.childrenRef(),Tt=0;Tt<wt.length;Tt++)ft=Math.max(st(wt[Tt],at,ht,ft),ft);else ot.z=at,ot.zlevel=ht,ft=Math.max(ot.z2,ft);if(mt&&(mt.z=at,mt.zlevel=ht,isFinite(ft)&&(mt.z2=ft+2)),yt){var Ct=ot.textGuideLineConfig;yt.z=at,yt.zlevel=ht,isFinite(ft)&&(yt.z2=ft+(Ct&&Ct.showAbove?1:-1))}return ft}function ut(ot,at){at.eachRendered(function(ht){if(!isElementRemoved(ht)){var ft=ht.getTextContent(),mt=ht.getTextGuideLine();ht.stateTransition&&(ht.stateTransition=null),ft&&ft.stateTransition&&(ft.stateTransition=null),mt&&mt.stateTransition&&(mt.stateTransition=null),ht.hasState()?(ht.prevStates=ht.currentStates,ht.clearStates()):ht.prevStates&&(ht.prevStates=null)}})}function ct(ot,at){var ht=ot.getModel("stateAnimation"),ft=ot.isAnimationEnabled(),mt=ht.get("duration"),yt=mt>0?{duration:mt,delay:ht.get("delay"),easing:ht.get("easing")}:null;at.eachRendered(function(bt){if(bt.states&&bt.states.emphasis){if(isElementRemoved(bt))return;if(bt instanceof Path&&savePathStates(bt),bt.__dirty){var wt=bt.prevStates;wt&&bt.useStates(wt)}if(ft){bt.stateTransition=yt;var Tt=bt.getTextContent(),Ct=bt.getTextGuideLine();Tt&&(Tt.stateTransition=yt),Ct&&(Ct.stateTransition=yt)}bt.__dirty&&d(bt)}})}createExtensionAPI=function(ot){return new(function(at){__extends$1(ht,at);function ht(){return at!==null&&at.apply(this,arguments)||this}return ht.prototype.getCoordinateSystems=function(){return ot._coordSysMgr.getCoordinateSystems()},ht.prototype.getComponentByElement=function(ft){for(;ft;){var mt=ft.__ecComponentInfo;if(mt!=null)return ot._model.getComponent(mt.mainType,mt.index);ft=ft.parent}},ht.prototype.enterEmphasis=function(ft,mt){enterEmphasis(ft,mt),markStatusToUpdate(ot)},ht.prototype.leaveEmphasis=function(ft,mt){leaveEmphasis(ft,mt),markStatusToUpdate(ot)},ht.prototype.enterBlur=function(ft){enterBlur(ft),markStatusToUpdate(ot)},ht.prototype.leaveBlur=function(ft){leaveBlur(ft),markStatusToUpdate(ot)},ht.prototype.enterSelect=function(ft){enterSelect(ft),markStatusToUpdate(ot)},ht.prototype.leaveSelect=function(ft){leaveSelect(ft),markStatusToUpdate(ot)},ht.prototype.getModel=function(){return ot.getModel()},ht.prototype.getViewOfComponentModel=function(ft){return ot.getViewOfComponentModel(ft)},ht.prototype.getViewOfSeriesModel=function(ft){return ot.getViewOfSeriesModel(ft)},ht}(ExtensionAPI))(ot)},enableConnect=function(ot){function at(ht,ft){for(var mt=0;mt<ht.length;mt++){var yt=ht[mt];yt[CONNECT_STATUS_KEY]=ft}}each$f(eventActionMap,function(ht,ft){ot._messageCenter.on(ft,function(mt){if(connectedGroups[ot.group]&&ot[CONNECT_STATUS_KEY]!==CONNECT_STATUS_PENDING){if(mt&&mt.escapeConnect)return;var yt=ot.makeActionFromEvent(mt),bt=[];each$f(instances,function(wt){wt!==ot&&wt.group===ot.group&&bt.push(wt)}),at(bt,CONNECT_STATUS_PENDING),each$f(bt,function(wt){wt[CONNECT_STATUS_KEY]!==CONNECT_STATUS_UPDATING&&wt.dispatchAction(yt)}),at(bt,CONNECT_STATUS_UPDATED)}})})}}(),a}(Eventful),echartsProto=ECharts.prototype;echartsProto.on=createRegisterEventWithLowercaseECharts("on");echartsProto.off=createRegisterEventWithLowercaseECharts("off");echartsProto.one=function(s,a,o){var c=this;function d(){for(var tt=[],nt=0;nt<arguments.length;nt++)tt[nt]=arguments[nt];a&&a.apply&&a.apply(this,tt),c.off(s,d)}this.on.call(this,s,d,o)};var MOUSE_EVENT_NAMES=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function disposedWarning(s){}var actions={},eventActionMap={},dataProcessorFuncs=[],optionPreprocessorFuncs=[],visualFuncs=[],themeStorage={},loadingEffects={},instances={},connectedGroups={},idBase=+new Date-0,groupIdBase=+new Date-0,DOM_ATTRIBUTE_KEY="_echarts_instance_";function init$1(s,a,o){var c=!(o&&o.ssr);if(c){var d=getInstanceByDom(s);if(d)return d}var tt=new ECharts(s,a,o);return tt.id="ec_"+idBase++,instances[tt.id]=tt,c&&setAttribute(s,DOM_ATTRIBUTE_KEY,tt.id),enableConnect(tt),lifecycle.trigger("afterinit",tt),tt}function connect(s){if(isArray$1(s)){var a=s;s=null,each$f(a,function(o){o.group!=null&&(s=o.group)}),s=s||"g_"+groupIdBase++,each$f(a,function(o){o.group=s})}return connectedGroups[s]=!0,s}function disconnect(s){connectedGroups[s]=!1}var disConnect=disconnect;function dispose(s){isString$1(s)?s=instances[s]:s instanceof ECharts||(s=getInstanceByDom(s)),s instanceof ECharts&&!s.isDisposed()&&s.dispose()}function getInstanceByDom(s){return instances[getAttribute(s,DOM_ATTRIBUTE_KEY)]}function getInstanceById(s){return instances[s]}function registerTheme(s,a){themeStorage[s]=a}function registerPreprocessor(s){indexOf(optionPreprocessorFuncs,s)<0&&optionPreprocessorFuncs.push(s)}function registerProcessor(s,a){normalizeRegister(dataProcessorFuncs,s,a,PRIORITY_PROCESSOR_DEFAULT)}function registerPostInit(s){registerUpdateLifecycle("afterinit",s)}function registerPostUpdate(s){registerUpdateLifecycle("afterupdate",s)}function registerUpdateLifecycle(s,a){lifecycle.on(s,a)}function registerAction(s,a,o){isFunction$1(a)&&(o=a,a="");var c=isObject$3(s)?s.type:[s,s={event:a}][0];s.event=(s.event||c).toLowerCase(),a=s.event,!eventActionMap[a]&&(assert(ACTION_REG.test(c)&&ACTION_REG.test(a)),actions[c]||(actions[c]={action:o,actionInfo:s}),eventActionMap[a]=c)}function registerCoordinateSystem(s,a){CoordinateSystemManager.register(s,a)}function getCoordinateSystemDimensions(s){var a=CoordinateSystemManager.get(s);if(a)return a.getDimensionsInfo?a.getDimensionsInfo():a.dimensions.slice()}function registerLayout(s,a){normalizeRegister(visualFuncs,s,a,PRIORITY_VISUAL_LAYOUT,"layout")}function registerVisual(s,a){normalizeRegister(visualFuncs,s,a,PRIORITY_VISUAL_CHART,"visual")}var registeredTasks=[];function normalizeRegister(s,a,o,c,d){if((isFunction$1(a)||isObject$3(a))&&(o=a,a=c),!(indexOf(registeredTasks,o)>=0)){registeredTasks.push(o);var tt=Scheduler.wrapStageHandler(o,d);tt.__prio=a,tt.__raw=o,s.push(tt)}}function registerLoading(s,a){loadingEffects[s]=a}function setCanvasCreator(s){setPlatformAPI({createCanvas:s})}function registerMap$1(s,a,o){var c=getImpl("registerMap");c&&c(s,a,o)}function getMap(s){var a=getImpl("getMap");return a&&a(s)}var registerTransform=registerExternalTransform;registerVisual(PRIORITY_VISUAL_GLOBAL,seriesStyleTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataStyleTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataColorPaletteTask);registerVisual(PRIORITY_VISUAL_GLOBAL,seriesSymbolTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataSymbolTask);registerVisual(PRIORITY_VISUAL_DECAL,decalVisual);registerPreprocessor(globalBackwardCompat);registerProcessor(PRIORITY_PROCESSOR_DATASTACK,dataStack$1);registerLoading("default",defaultLoading);registerAction({type:HIGHLIGHT_ACTION_TYPE,event:HIGHLIGHT_ACTION_TYPE,update:HIGHLIGHT_ACTION_TYPE},noop);registerAction({type:DOWNPLAY_ACTION_TYPE,event:DOWNPLAY_ACTION_TYPE,update:DOWNPLAY_ACTION_TYPE},noop);registerAction({type:SELECT_ACTION_TYPE,event:SELECT_ACTION_TYPE,update:SELECT_ACTION_TYPE},noop);registerAction({type:UNSELECT_ACTION_TYPE,event:UNSELECT_ACTION_TYPE,update:UNSELECT_ACTION_TYPE},noop);registerAction({type:TOGGLE_SELECT_ACTION_TYPE,event:TOGGLE_SELECT_ACTION_TYPE,update:TOGGLE_SELECT_ACTION_TYPE},noop);registerTheme("light",lightTheme);registerTheme("dark",theme);var dataTool={},extensions=[],extensionRegisters={registerPreprocessor,registerProcessor,registerPostInit,registerPostUpdate,registerUpdateLifecycle,registerAction,registerCoordinateSystem,registerLayout,registerVisual,registerTransform,registerLoading,registerMap:registerMap$1,registerImpl,PRIORITY,ComponentModel,ComponentView,SeriesModel,ChartView,registerComponentModel:function(s){ComponentModel.registerClass(s)},registerComponentView:function(s){ComponentView.registerClass(s)},registerSeriesModel:function(s){SeriesModel.registerClass(s)},registerChartView:function(s){ChartView.registerClass(s)},registerSubTypeDefaulter:function(s,a){ComponentModel.registerSubTypeDefaulter(s,a)},registerPainter:function(s,a){registerPainter(s,a)}};function use(s){if(isArray$1(s)){each$f(s,function(a){use(a)});return}indexOf(extensions,s)>=0||(extensions.push(s),isFunction$1(s)&&(s={install:s}),s.install(extensionRegisters))}function dataIndexMapValueLength(s){return s==null?0:s.length||1}function defaultKeyGetter(s){return s}var DataDiffer=function(){function s(a,o,c,d,tt,nt){this._old=a,this._new=o,this._oldKeyGetter=c||defaultKeyGetter,this._newKeyGetter=d||defaultKeyGetter,this.context=tt,this._diffModeMultiple=nt==="multiple"}return s.prototype.add=function(a){return this._add=a,this},s.prototype.update=function(a){return this._update=a,this},s.prototype.updateManyToOne=function(a){return this._updateManyToOne=a,this},s.prototype.updateOneToMany=function(a){return this._updateOneToMany=a,this},s.prototype.updateManyToMany=function(a){return this._updateManyToMany=a,this},s.prototype.remove=function(a){return this._remove=a,this},s.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},s.prototype._executeOneToOne=function(){var a=this._old,o=this._new,c={},d=new Array(a.length),tt=new Array(o.length);this._initIndexMap(a,null,d,"_oldKeyGetter"),this._initIndexMap(o,c,tt,"_newKeyGetter");for(var nt=0;nt<a.length;nt++){var it=d[nt],st=c[it],ut=dataIndexMapValueLength(st);if(ut>1){var ct=st.shift();st.length===1&&(c[it]=st[0]),this._update&&this._update(ct,nt)}else ut===1?(c[it]=null,this._update&&this._update(st,nt)):this._remove&&this._remove(nt)}this._performRestAdd(tt,c)},s.prototype._executeMultiple=function(){var a=this._old,o=this._new,c={},d={},tt=[],nt=[];this._initIndexMap(a,c,tt,"_oldKeyGetter"),this._initIndexMap(o,d,nt,"_newKeyGetter");for(var it=0;it<tt.length;it++){var st=tt[it],ut=c[st],ct=d[st],ot=dataIndexMapValueLength(ut),at=dataIndexMapValueLength(ct);if(ot>1&&at===1)this._updateManyToOne&&this._updateManyToOne(ct,ut),d[st]=null;else if(ot===1&&at>1)this._updateOneToMany&&this._updateOneToMany(ct,ut),d[st]=null;else if(ot===1&&at===1)this._update&&this._update(ct,ut),d[st]=null;else if(ot>1&&at>1)this._updateManyToMany&&this._updateManyToMany(ct,ut),d[st]=null;else if(ot>1)for(var ht=0;ht<ot;ht++)this._remove&&this._remove(ut[ht]);else this._remove&&this._remove(ut)}this._performRestAdd(nt,d)},s.prototype._performRestAdd=function(a,o){for(var c=0;c<a.length;c++){var d=a[c],tt=o[d],nt=dataIndexMapValueLength(tt);if(nt>1)for(var it=0;it<nt;it++)this._add&&this._add(tt[it]);else nt===1&&this._add&&this._add(tt);o[d]=null}},s.prototype._initIndexMap=function(a,o,c,d){for(var tt=this._diffModeMultiple,nt=0;nt<a.length;nt++){var it="_ec_"+this[d](a[nt],nt);if(tt||(c[nt]=it),!!o){var st=o[it],ut=dataIndexMapValueLength(st);ut===0?(o[it]=nt,tt&&c.push(it)):ut===1?o[it]=[st,nt]:st.push(nt)}}},s}(),DimensionUserOuput=function(){function s(a,o){this._encode=a,this._schema=o}return s.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},s.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},s}();function summarizeDimensions(s,a){var o={},c=o.encode={},d=createHashMap(),tt=[],nt=[],it={};each$f(s.dimensions,function(at){var ht=s.getDimensionInfo(at),ft=ht.coordDim;if(ft){var mt=ht.coordDimIndex;getOrCreateEncodeArr(c,ft)[mt]=at,ht.isExtraCoord||(d.set(ft,1),mayLabelDimType(ht.type)&&(tt[0]=at),getOrCreateEncodeArr(it,ft)[mt]=s.getDimensionIndex(ht.name)),ht.defaultTooltip&&nt.push(at)}VISUAL_DIMENSIONS.each(function(yt,bt){var wt=getOrCreateEncodeArr(c,bt),Tt=ht.otherDims[bt];Tt!=null&&Tt!==!1&&(wt[Tt]=ht.name)})});var st=[],ut={};d.each(function(at,ht){var ft=c[ht];ut[ht]=ft[0],st=st.concat(ft)}),o.dataDimsOnCoord=st,o.dataDimIndicesOnCoord=map$1(st,function(at){return s.getDimensionInfo(at).storeDimIndex}),o.encodeFirstDimNotExtra=ut;var ct=c.label;ct&&ct.length&&(tt=ct.slice());var ot=c.tooltip;return ot&&ot.length?nt=ot.slice():nt.length||(nt=tt.slice()),c.defaultedLabel=tt,c.defaultedTooltip=nt,o.userOutput=new DimensionUserOuput(it,a),o}function getOrCreateEncodeArr(s,a){return s.hasOwnProperty(a)||(s[a]=[]),s[a]}function getDimensionTypeByAxis(s){return s==="category"?"ordinal":s==="time"?"time":"float"}function mayLabelDimType(s){return!(s==="ordinal"||s==="time")}var SeriesDimensionDefine=function(){function s(a){this.otherDims={},a!=null&&extend(this,a)}return s}(),inner$h=makeInner(),dimTypeShort={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},SeriesDataSchema=function(){function s(a){this.dimensions=a.dimensions,this._dimOmitted=a.dimensionOmitted,this.source=a.source,this._fullDimCount=a.fullDimensionCount,this._updateDimOmitted(a.dimensionOmitted)}return s.prototype.isDimensionOmitted=function(){return this._dimOmitted},s.prototype._updateDimOmitted=function(a){this._dimOmitted=a,a&&(this._dimNameMap||(this._dimNameMap=ensureSourceDimNameMap(this.source)))},s.prototype.getSourceDimensionIndex=function(a){return retrieve2(this._dimNameMap.get(a),-1)},s.prototype.getSourceDimension=function(a){var o=this.source.dimensionsDefine;if(o)return o[a]},s.prototype.makeStoreSchema=function(){for(var a=this._fullDimCount,o=shouldRetrieveDataByName(this.source),c=!shouldOmitUnusedDimensions(a),d="",tt=[],nt=0,it=0;nt<a;nt++){var st=void 0,ut=void 0,ct=void 0,ot=this.dimensions[it];if(ot&&ot.storeDimIndex===nt)st=o?ot.name:null,ut=ot.type,ct=ot.ordinalMeta,it++;else{var at=this.getSourceDimension(nt);at&&(st=o?at.name:null,ut=at.type)}tt.push({property:st,type:ut,ordinalMeta:ct}),o&&st!=null&&(!ot||!ot.isCalculationCoord)&&(d+=c?st.replace(/\`/g,"`1").replace(/\$/g,"`2"):st),d+="$",d+=dimTypeShort[ut]||"f",ct&&(d+=ct.uid),d+="$"}var ht=this.source,ft=[ht.seriesLayoutBy,ht.startIndex,d].join("$$");return{dimensions:tt,hash:ft}},s.prototype.makeOutputDimensionNames=function(){for(var a=[],o=0,c=0;o<this._fullDimCount;o++){var d=void 0,tt=this.dimensions[c];if(tt&&tt.storeDimIndex===o)tt.isCalculationCoord||(d=tt.name),c++;else{var nt=this.getSourceDimension(o);nt&&(d=nt.name)}a.push(d)}return a},s.prototype.appendCalculationDimension=function(a){this.dimensions.push(a),a.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},s}();function isSeriesDataSchema(s){return s instanceof SeriesDataSchema}function createDimNameMap(s){for(var a=createHashMap(),o=0;o<(s||[]).length;o++){var c=s[o],d=isObject$3(c)?c.name:c;d!=null&&a.get(d)==null&&a.set(d,o)}return a}function ensureSourceDimNameMap(s){var a=inner$h(s);return a.dimNameMap||(a.dimNameMap=createDimNameMap(s.dimensionsDefine))}function shouldOmitUnusedDimensions(s){return s>30}var isObject$1=isObject$3,map=map$1,CtorInt32Array=typeof Int32Array>"u"?Array:Int32Array,ID_PREFIX="e\0\0",INDEX_NOT_FOUND=-1,TRANSFERABLE_PROPERTIES=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],CLONE_PROPERTIES=["_approximateExtent"],prepareInvertedIndex,getId,getIdNameFromStore,normalizeDimensions,transferProperties,cloneListForMapAndSample,makeIdFromName,SeriesData=function(){function s(a,o){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var c,d=!1;isSeriesDataSchema(a)?(c=a.dimensions,this._dimOmitted=a.isDimensionOmitted(),this._schema=a):(d=!0,c=a),c=c||["x","y"];for(var tt={},nt=[],it={},st=!1,ut={},ct=0;ct<c.length;ct++){var ot=c[ct],at=isString$1(ot)?new SeriesDimensionDefine({name:ot}):ot instanceof SeriesDimensionDefine?ot:new SeriesDimensionDefine(ot),ht=at.name;at.type=at.type||"float",at.coordDim||(at.coordDim=ht,at.coordDimIndex=0);var ft=at.otherDims=at.otherDims||{};nt.push(ht),tt[ht]=at,ut[ht]!=null&&(st=!0),at.createInvertedIndices&&(it[ht]=[]),ft.itemName===0&&(this._nameDimIdx=ct),ft.itemId===0&&(this._idDimIdx=ct),d&&(at.storeDimIndex=ct)}if(this.dimensions=nt,this._dimInfos=tt,this._initGetDimensionInfo(st),this.hostModel=o,this._invertedIndicesMap=it,this._dimOmitted){var mt=this._dimIdxToName=createHashMap();each$f(nt,function(yt){mt.set(tt[yt].storeDimIndex,yt)})}}return s.prototype.getDimension=function(a){var o=this._recognizeDimIndex(a);if(o==null)return a;if(o=a,!this._dimOmitted)return this.dimensions[o];var c=this._dimIdxToName.get(o);if(c!=null)return c;var d=this._schema.getSourceDimension(o);if(d)return d.name},s.prototype.getDimensionIndex=function(a){var o=this._recognizeDimIndex(a);if(o!=null)return o;if(a==null)return-1;var c=this._getDimInfo(a);return c?c.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(a):-1},s.prototype._recognizeDimIndex=function(a){if(isNumber(a)||a!=null&&!isNaN(a)&&!this._getDimInfo(a)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(a)<0))return+a},s.prototype._getStoreDimIndex=function(a){var o=this.getDimensionIndex(a);return o},s.prototype.getDimensionInfo=function(a){return this._getDimInfo(this.getDimension(a))},s.prototype._initGetDimensionInfo=function(a){var o=this._dimInfos;this._getDimInfo=a?function(c){return o.hasOwnProperty(c)?o[c]:void 0}:function(c){return o[c]}},s.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},s.prototype.mapDimension=function(a,o){var c=this._dimSummary;if(o==null)return c.encodeFirstDimNotExtra[a];var d=c.encode[a];return d?d[o]:null},s.prototype.mapDimensionsAll=function(a){var o=this._dimSummary,c=o.encode[a];return(c||[]).slice()},s.prototype.getStore=function(){return this._store},s.prototype.initData=function(a,o,c){var d=this,tt;if(a instanceof DataStore&&(tt=a),!tt){var nt=this.dimensions,it=isSourceInstance(a)||isArrayLike(a)?new DefaultDataProvider(a,nt.length):a;tt=new DataStore;var st=map(nt,function(ut){return{type:d._dimInfos[ut].type,property:ut}});tt.initData(it,st,c)}this._store=tt,this._nameList=(o||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,tt.count()),this._dimSummary=summarizeDimensions(this,this._schema),this.userOutput=this._dimSummary.userOutput},s.prototype.appendData=function(a){var o=this._store.appendData(a);this._doInit(o[0],o[1])},s.prototype.appendValues=function(a,o){var c=this._store.appendValues(a,o&&o.length),d=c.start,tt=c.end,nt=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),o)for(var it=d;it<tt;it++){var st=it-d;this._nameList[it]=o[st],nt&&makeIdFromName(this,it)}},s.prototype._updateOrdinalMeta=function(){for(var a=this._store,o=this.dimensions,c=0;c<o.length;c++){var d=this._dimInfos[o[c]];d.ordinalMeta&&a.collectOrdinalMeta(d.storeDimIndex,d.ordinalMeta)}},s.prototype._shouldMakeIdFromName=function(){var a=this._store.getProvider();return this._idDimIdx==null&&a.getSource().sourceFormat!==SOURCE_FORMAT_TYPED_ARRAY&&!a.fillStorage},s.prototype._doInit=function(a,o){if(!(a>=o)){var c=this._store,d=c.getProvider();this._updateOrdinalMeta();var tt=this._nameList,nt=this._idList,it=d.getSource().sourceFormat,st=it===SOURCE_FORMAT_ORIGINAL;if(st&&!d.pure)for(var ut=[],ct=a;ct<o;ct++){var ot=d.getItem(ct,ut);if(!this.hasItemOption&&isDataItemOption(ot)&&(this.hasItemOption=!0),ot){var at=ot.name;tt[ct]==null&&at!=null&&(tt[ct]=convertOptionIdName(at,null));var ht=ot.id;nt[ct]==null&&ht!=null&&(nt[ct]=convertOptionIdName(ht,null))}}if(this._shouldMakeIdFromName())for(var ct=a;ct<o;ct++)makeIdFromName(this,ct);prepareInvertedIndex(this)}},s.prototype.getApproximateExtent=function(a){return this._approximateExtent[a]||this._store.getDataExtent(this._getStoreDimIndex(a))},s.prototype.setApproximateExtent=function(a,o){o=this.getDimension(o),this._approximateExtent[o]=a.slice()},s.prototype.getCalculationInfo=function(a){return this._calculationInfo[a]},s.prototype.setCalculationInfo=function(a,o){isObject$1(a)?extend(this._calculationInfo,a):this._calculationInfo[a]=o},s.prototype.getName=function(a){var o=this.getRawIndex(a),c=this._nameList[o];return c==null&&this._nameDimIdx!=null&&(c=getIdNameFromStore(this,this._nameDimIdx,o)),c==null&&(c=""),c},s.prototype._getCategory=function(a,o){var c=this._store.get(a,o),d=this._store.getOrdinalMeta(a);return d?d.categories[c]:c},s.prototype.getId=function(a){return getId(this,this.getRawIndex(a))},s.prototype.count=function(){return this._store.count()},s.prototype.get=function(a,o){var c=this._store,d=this._dimInfos[a];if(d)return c.get(d.storeDimIndex,o)},s.prototype.getByRawIndex=function(a,o){var c=this._store,d=this._dimInfos[a];if(d)return c.getByRawIndex(d.storeDimIndex,o)},s.prototype.getIndices=function(){return this._store.getIndices()},s.prototype.getDataExtent=function(a){return this._store.getDataExtent(this._getStoreDimIndex(a))},s.prototype.getSum=function(a){return this._store.getSum(this._getStoreDimIndex(a))},s.prototype.getMedian=function(a){return this._store.getMedian(this._getStoreDimIndex(a))},s.prototype.getValues=function(a,o){var c=this,d=this._store;return isArray$1(a)?d.getValues(map(a,function(tt){return c._getStoreDimIndex(tt)}),o):d.getValues(a)},s.prototype.hasValue=function(a){for(var o=this._dimSummary.dataDimIndicesOnCoord,c=0,d=o.length;c<d;c++)if(isNaN(this._store.get(o[c],a)))return!1;return!0},s.prototype.indexOfName=function(a){for(var o=0,c=this._store.count();o<c;o++)if(this.getName(o)===a)return o;return-1},s.prototype.getRawIndex=function(a){return this._store.getRawIndex(a)},s.prototype.indexOfRawIndex=function(a){return this._store.indexOfRawIndex(a)},s.prototype.rawIndexOf=function(a,o){var c=a&&this._invertedIndicesMap[a],d=c&&c[o];return d==null||isNaN(d)?INDEX_NOT_FOUND:d},s.prototype.indicesOfNearest=function(a,o,c){return this._store.indicesOfNearest(this._getStoreDimIndex(a),o,c)},s.prototype.each=function(a,o,c){isFunction$1(a)&&(c=o,o=a,a=[]);var d=c||this,tt=map(normalizeDimensions(a),this._getStoreDimIndex,this);this._store.each(tt,d?bind$2(o,d):o)},s.prototype.filterSelf=function(a,o,c){isFunction$1(a)&&(c=o,o=a,a=[]);var d=c||this,tt=map(normalizeDimensions(a),this._getStoreDimIndex,this);return this._store=this._store.filter(tt,d?bind$2(o,d):o),this},s.prototype.selectRange=function(a){var o=this,c={},d=keys(a);return each$f(d,function(tt){var nt=o._getStoreDimIndex(tt);c[nt]=a[tt]}),this._store=this._store.selectRange(c),this},s.prototype.mapArray=function(a,o,c){isFunction$1(a)&&(c=o,o=a,a=[]),c=c||this;var d=[];return this.each(a,function(){d.push(o&&o.apply(this,arguments))},c),d},s.prototype.map=function(a,o,c,d){var tt=c||d||this,nt=map(normalizeDimensions(a),this._getStoreDimIndex,this),it=cloneListForMapAndSample(this);return it._store=this._store.map(nt,tt?bind$2(o,tt):o),it},s.prototype.modify=function(a,o,c,d){var tt=c||d||this,nt=map(normalizeDimensions(a),this._getStoreDimIndex,this);this._store.modify(nt,tt?bind$2(o,tt):o)},s.prototype.downSample=function(a,o,c,d){var tt=cloneListForMapAndSample(this);return tt._store=this._store.downSample(this._getStoreDimIndex(a),o,c,d),tt},s.prototype.minmaxDownSample=function(a,o){var c=cloneListForMapAndSample(this);return c._store=this._store.minmaxDownSample(this._getStoreDimIndex(a),o),c},s.prototype.lttbDownSample=function(a,o){var c=cloneListForMapAndSample(this);return c._store=this._store.lttbDownSample(this._getStoreDimIndex(a),o),c},s.prototype.getRawDataItem=function(a){return this._store.getRawDataItem(a)},s.prototype.getItemModel=function(a){var o=this.hostModel,c=this.getRawDataItem(a);return new Model(c,o,o&&o.ecModel)},s.prototype.diff=function(a){var o=this;return new DataDiffer(a?a.getStore().getIndices():[],this.getStore().getIndices(),function(c){return getId(a,c)},function(c){return getId(o,c)})},s.prototype.getVisual=function(a){var o=this._visual;return o&&o[a]},s.prototype.setVisual=function(a,o){this._visual=this._visual||{},isObject$1(a)?extend(this._visual,a):this._visual[a]=o},s.prototype.getItemVisual=function(a,o){var c=this._itemVisuals[a],d=c&&c[o];return d??this.getVisual(o)},s.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},s.prototype.ensureUniqueItemVisual=function(a,o){var c=this._itemVisuals,d=c[a];d||(d=c[a]={});var tt=d[o];return tt==null&&(tt=this.getVisual(o),isArray$1(tt)?tt=tt.slice():isObject$1(tt)&&(tt=extend({},tt)),d[o]=tt),tt},s.prototype.setItemVisual=function(a,o,c){var d=this._itemVisuals[a]||{};this._itemVisuals[a]=d,isObject$1(o)?extend(d,o):d[o]=c},s.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},s.prototype.setLayout=function(a,o){isObject$1(a)?extend(this._layout,a):this._layout[a]=o},s.prototype.getLayout=function(a){return this._layout[a]},s.prototype.getItemLayout=function(a){return this._itemLayouts[a]},s.prototype.setItemLayout=function(a,o,c){this._itemLayouts[a]=c?extend(this._itemLayouts[a]||{},o):o},s.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},s.prototype.setItemGraphicEl=function(a,o){var c=this.hostModel&&this.hostModel.seriesIndex;setCommonECData(c,this.dataType,a,o),this._graphicEls[a]=o},s.prototype.getItemGraphicEl=function(a){return this._graphicEls[a]},s.prototype.eachItemGraphicEl=function(a,o){each$f(this._graphicEls,function(c,d){c&&a&&a.call(o,c,d)})},s.prototype.cloneShallow=function(a){return a||(a=new s(this._schema?this._schema:map(this.dimensions,this._getDimInfo,this),this.hostModel)),transferProperties(a,this),a._store=this._store,a},s.prototype.wrapMethod=function(a,o){var c=this[a];isFunction$1(c)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(a),this[a]=function(){var d=c.apply(this,arguments);return o.apply(this,[d].concat(slice(arguments)))})},s.internalField=function(){prepareInvertedIndex=function(a){var o=a._invertedIndicesMap;each$f(o,function(c,d){var tt=a._dimInfos[d],nt=tt.ordinalMeta,it=a._store;if(nt){c=o[d]=new CtorInt32Array(nt.categories.length);for(var st=0;st<c.length;st++)c[st]=INDEX_NOT_FOUND;for(var st=0;st<it.count();st++)c[it.get(tt.storeDimIndex,st)]=st}})},getIdNameFromStore=function(a,o,c){return convertOptionIdName(a._getCategory(o,c),null)},getId=function(a,o){var c=a._idList[o];return c==null&&a._idDimIdx!=null&&(c=getIdNameFromStore(a,a._idDimIdx,o)),c==null&&(c=ID_PREFIX+o),c},normalizeDimensions=function(a){return isArray$1(a)||(a=a!=null?[a]:[]),a},cloneListForMapAndSample=function(a){var o=new s(a._schema?a._schema:map(a.dimensions,a._getDimInfo,a),a.hostModel);return transferProperties(o,a),o},transferProperties=function(a,o){each$f(TRANSFERABLE_PROPERTIES.concat(o.__wrappedMethods||[]),function(c){o.hasOwnProperty(c)&&(a[c]=o[c])}),a.__wrappedMethods=o.__wrappedMethods,each$f(CLONE_PROPERTIES,function(c){a[c]=clone$4(o[c])}),a._calculationInfo=extend({},o._calculationInfo)},makeIdFromName=function(a,o){var c=a._nameList,d=a._idList,tt=a._nameDimIdx,nt=a._idDimIdx,it=c[o],st=d[o];if(it==null&&tt!=null&&(c[o]=it=getIdNameFromStore(a,tt,o)),st==null&&nt!=null&&(d[o]=st=getIdNameFromStore(a,nt,o)),st==null&&it!=null){var ut=a._nameRepeatCount,ct=ut[it]=(ut[it]||0)+1;st=it,ct>1&&(st+="__ec__"+ct),d[o]=st}}}(),s}();function createDimensions(s,a){return prepareSeriesDataSchema(s,a).dimensions}function prepareSeriesDataSchema(s,a){isSourceInstance(s)||(s=createSourceFromSeriesDataOption(s)),a=a||{};var o=a.coordDimensions||[],c=a.dimensionsDefine||s.dimensionsDefine||[],d=createHashMap(),tt=[],nt=getDimCount(s,o,c,a.dimensionsCount),it=a.canOmitUnusedDimensions&&shouldOmitUnusedDimensions(nt),st=c===s.dimensionsDefine,ut=st?ensureSourceDimNameMap(s):createDimNameMap(c),ct=a.encodeDefine;!ct&&a.encodeDefaulter&&(ct=a.encodeDefaulter(s,nt));for(var ot=createHashMap(ct),at=new CtorInt32Array$1(nt),ht=0;ht<at.length;ht++)at[ht]=-1;function ft(kt){var Vt=at[kt];if(Vt<0){var Ht=c[kt],Qt=isObject$3(Ht)?Ht:{name:Ht},Xt=new SeriesDimensionDefine,Zt=Qt.name;Zt!=null&&ut.get(Zt)!=null&&(Xt.name=Xt.displayName=Zt),Qt.type!=null&&(Xt.type=Qt.type),Qt.displayName!=null&&(Xt.displayName=Qt.displayName);var ar=tt.length;return at[kt]=ar,Xt.storeDimIndex=kt,tt.push(Xt),Xt}return tt[Vt]}if(!it)for(var ht=0;ht<nt;ht++)ft(ht);ot.each(function(kt,Vt){var Ht=normalizeToArray(kt).slice();if(Ht.length===1&&!isString$1(Ht[0])&&Ht[0]<0){ot.set(Vt,!1);return}var Qt=ot.set(Vt,[]);each$f(Ht,function(Xt,Zt){var ar=isString$1(Xt)?ut.get(Xt):Xt;ar!=null&&ar<nt&&(Qt[Zt]=ar,yt(ft(ar),Vt,Zt))})});var mt=0;each$f(o,function(kt){var Vt,Ht,Qt,Xt;if(isString$1(kt))Vt=kt,Xt={};else{Xt=kt,Vt=Xt.name;var Zt=Xt.ordinalMeta;Xt.ordinalMeta=null,Xt=extend({},Xt),Xt.ordinalMeta=Zt,Ht=Xt.dimsDef,Qt=Xt.otherDims,Xt.name=Xt.coordDim=Xt.coordDimIndex=Xt.dimsDef=Xt.otherDims=null}var ar=ot.get(Vt);if(ar!==!1){if(ar=normalizeToArray(ar),!ar.length)for(var nr=0;nr<(Ht&&Ht.length||1);nr++){for(;mt<nt&&ft(mt).coordDim!=null;)mt++;mt<nt&&ar.push(mt++)}each$f(ar,function(cr,dr){var mr=ft(cr);if(st&&Xt.type!=null&&(mr.type=Xt.type),yt(defaults(mr,Xt),Vt,dr),mr.name==null&&Ht){var Dr=Ht[dr];!isObject$3(Dr)&&(Dr={name:Dr}),mr.name=mr.displayName=Dr.name,mr.defaultTooltip=Dr.defaultTooltip}Qt&&defaults(mr.otherDims,Qt)})}});function yt(kt,Vt,Ht){VISUAL_DIMENSIONS.get(Vt)!=null?kt.otherDims[Vt]=Ht:(kt.coordDim=Vt,kt.coordDimIndex=Ht,d.set(Vt,!0))}var bt=a.generateCoord,wt=a.generateCoordCount,Tt=wt!=null;wt=bt?wt||1:0;var Ct=bt||"value";function Dt(kt){kt.name==null&&(kt.name=kt.coordDim)}if(it)each$f(tt,function(kt){Dt(kt)}),tt.sort(function(kt,Vt){return kt.storeDimIndex-Vt.storeDimIndex});else for(var Ot=0;Ot<nt;Ot++){var $t=ft(Ot),Ft=$t.coordDim;Ft==null&&($t.coordDim=genCoordDimName(Ct,d,Tt),$t.coordDimIndex=0,(!bt||wt<=0)&&($t.isExtraCoord=!0),wt--),Dt($t),$t.type==null&&(guessOrdinal(s,Ot)===BE_ORDINAL.Must||$t.isExtraCoord&&($t.otherDims.itemName!=null||$t.otherDims.seriesName!=null))&&($t.type="ordinal")}return removeDuplication(tt),new SeriesDataSchema({source:s,dimensions:tt,fullDimensionCount:nt,dimensionOmitted:it})}function removeDuplication(s){for(var a=createHashMap(),o=0;o<s.length;o++){var c=s[o],d=c.name,tt=a.get(d)||0;tt>0&&(c.name=d+(tt-1)),tt++,a.set(d,tt)}}function getDimCount(s,a,o,c){var d=Math.max(s.dimensionsDetectedCount||1,a.length,o.length,c||0);return each$f(a,function(tt){var nt;isObject$3(tt)&&(nt=tt.dimsDef)&&(d=Math.max(d,nt.length))}),d}function genCoordDimName(s,a,o){if(o||a.hasKey(s)){for(var c=0;a.hasKey(s+c);)c++;s+=c}return a.set(s,!0),s}var CoordSysInfo=function(){function s(a){this.coordSysDims=[],this.axisMap=createHashMap(),this.categoryAxisMap=createHashMap(),this.coordSysName=a}return s}();function getCoordSysInfoBySeries(s){var a=s.get("coordinateSystem"),o=new CoordSysInfo(a),c=fetchers[a];if(c)return c(s,o,o.axisMap,o.categoryAxisMap),o}var fetchers={cartesian2d:function(s,a,o,c){var d=s.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],tt=s.getReferringComponents("yAxis",SINGLE_REFERRING).models[0];a.coordSysDims=["x","y"],o.set("x",d),o.set("y",tt),isCategory(d)&&(c.set("x",d),a.firstCategoryDimIndex=0),isCategory(tt)&&(c.set("y",tt),a.firstCategoryDimIndex==null&&(a.firstCategoryDimIndex=1))},singleAxis:function(s,a,o,c){var d=s.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];a.coordSysDims=["single"],o.set("single",d),isCategory(d)&&(c.set("single",d),a.firstCategoryDimIndex=0)},polar:function(s,a,o,c){var d=s.getReferringComponents("polar",SINGLE_REFERRING).models[0],tt=d.findAxisModel("radiusAxis"),nt=d.findAxisModel("angleAxis");a.coordSysDims=["radius","angle"],o.set("radius",tt),o.set("angle",nt),isCategory(tt)&&(c.set("radius",tt),a.firstCategoryDimIndex=0),isCategory(nt)&&(c.set("angle",nt),a.firstCategoryDimIndex==null&&(a.firstCategoryDimIndex=1))},geo:function(s,a,o,c){a.coordSysDims=["lng","lat"]},parallel:function(s,a,o,c){var d=s.ecModel,tt=d.getComponent("parallel",s.get("parallelIndex")),nt=a.coordSysDims=tt.dimensions.slice();each$f(tt.parallelAxisIndex,function(it,st){var ut=d.getComponent("parallelAxis",it),ct=nt[st];o.set(ct,ut),isCategory(ut)&&(c.set(ct,ut),a.firstCategoryDimIndex==null&&(a.firstCategoryDimIndex=st))})}};function isCategory(s){return s.get("type")==="category"}function enableDataStack(s,a,o){o=o||{};var c=o.byIndex,d=o.stackedCoordDimension,tt,nt,it;isLegacyDimensionsInput(a)?tt=a:(nt=a.schema,tt=nt.dimensions,it=a.store);var st=!!(s&&s.get("stack")),ut,ct,ot,at;if(each$f(tt,function(wt,Tt){isString$1(wt)&&(tt[Tt]=wt={name:wt}),st&&!wt.isExtraCoord&&(!c&&!ut&&wt.ordinalMeta&&(ut=wt),!ct&&wt.type!=="ordinal"&&wt.type!=="time"&&(!d||d===wt.coordDim)&&(ct=wt))}),ct&&!c&&!ut&&(c=!0),ct){ot="__\0ecstackresult_"+s.id,at="__\0ecstackedover_"+s.id,ut&&(ut.createInvertedIndices=!0);var ht=ct.coordDim,ft=ct.type,mt=0;each$f(tt,function(wt){wt.coordDim===ht&&mt++});var yt={name:ot,coordDim:ht,coordDimIndex:mt,type:ft,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:tt.length},bt={name:at,coordDim:at,coordDimIndex:mt+1,type:ft,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:tt.length+1};nt?(it&&(yt.storeDimIndex=it.ensureCalculationDimension(at,ft),bt.storeDimIndex=it.ensureCalculationDimension(ot,ft)),nt.appendCalculationDimension(yt),nt.appendCalculationDimension(bt)):(tt.push(yt),tt.push(bt))}return{stackedDimension:ct&&ct.name,stackedByDimension:ut&&ut.name,isStackedByIndex:c,stackedOverDimension:at,stackResultDimension:ot}}function isLegacyDimensionsInput(s){return!isSeriesDataSchema(s.schema)}function isDimensionStacked(s,a){return!!a&&a===s.getCalculationInfo("stackedDimension")}function getStackedDimension(s,a){return isDimensionStacked(s,a)?s.getCalculationInfo("stackResultDimension"):a}function getCoordSysDimDefs(s,a){var o=s.get("coordinateSystem"),c=CoordinateSystemManager.get(o),d;return a&&a.coordSysDims&&(d=map$1(a.coordSysDims,function(tt){var nt={name:tt},it=a.axisMap.get(tt);if(it){var st=it.get("type");nt.type=getDimensionTypeByAxis(st)}return nt})),d||(d=c&&(c.getDimensionsInfo?c.getDimensionsInfo():c.dimensions.slice())||["x","y"]),d}function injectOrdinalMeta(s,a,o){var c,d;return o&&each$f(s,function(tt,nt){var it=tt.coordDim,st=o.categoryAxisMap.get(it);st&&(c==null&&(c=nt),tt.ordinalMeta=st.getOrdinalMeta(),a&&(tt.createInvertedIndices=!0)),tt.otherDims.itemName!=null&&(d=!0)}),!d&&c!=null&&(s[c].otherDims.itemName=0),c}function createSeriesData(s,a,o){o=o||{};var c=a.getSourceManager(),d,tt=!1;s?(tt=!0,d=createSourceFromSeriesDataOption(s)):(d=c.getSource(),tt=d.sourceFormat===SOURCE_FORMAT_ORIGINAL);var nt=getCoordSysInfoBySeries(a),it=getCoordSysDimDefs(a,nt),st=o.useEncodeDefaulter,ut=isFunction$1(st)?st:st?curry$1(makeSeriesEncodeForAxisCoordSys,it,a):null,ct={coordDimensions:it,generateCoord:o.generateCoord,encodeDefine:a.getEncode(),encodeDefaulter:ut,canOmitUnusedDimensions:!tt},ot=prepareSeriesDataSchema(d,ct),at=injectOrdinalMeta(ot.dimensions,o.createInvertedIndices,nt),ht=tt?null:c.getSharedDataStore(ot),ft=enableDataStack(a,{schema:ot,store:ht}),mt=new SeriesData(ot,a);mt.setCalculationInfo(ft);var yt=at!=null&&isNeedCompleteOrdinalData(d)?function(bt,wt,Tt,Ct){return Ct===at?Tt:this.defaultDimValueGetter(bt,wt,Tt,Ct)}:null;return mt.hasItemOption=!1,mt.initData(tt?d:ht,null,yt),mt}function isNeedCompleteOrdinalData(s){if(s.sourceFormat===SOURCE_FORMAT_ORIGINAL){var a=firstDataNotNull(s.data||[]);return!isArray$1(getDataItemValue(a))}}function firstDataNotNull(s){for(var a=0;a<s.length&&s[a]==null;)a++;return s[a]}var Scale=function(){function s(a){this._setting=a||{},this._extent=[1/0,-1/0]}return s.prototype.getSetting=function(a){return this._setting[a]},s.prototype.unionExtent=function(a){var o=this._extent;a[0]<o[0]&&(o[0]=a[0]),a[1]>o[1]&&(o[1]=a[1])},s.prototype.unionExtentFromData=function(a,o){this.unionExtent(a.getApproximateExtent(o))},s.prototype.getExtent=function(){return this._extent.slice()},s.prototype.setExtent=function(a,o){var c=this._extent;isNaN(a)||(c[0]=a),isNaN(o)||(c[1]=o)},s.prototype.isInExtentRange=function(a){return this._extent[0]<=a&&this._extent[1]>=a},s.prototype.isBlank=function(){return this._isBlank},s.prototype.setBlank=function(a){this._isBlank=a},s}();enableClassManagement(Scale);var uidBase=0,OrdinalMeta=function(){function s(a){this.categories=a.categories||[],this._needCollect=a.needCollect,this._deduplication=a.deduplication,this.uid=++uidBase}return s.createByAxisModel=function(a){var o=a.option,c=o.data,d=c&&map$1(c,getName);return new s({categories:d,needCollect:!d,deduplication:o.dedplication!==!1})},s.prototype.getOrdinal=function(a){return this._getOrCreateMap().get(a)},s.prototype.parseAndCollect=function(a){var o,c=this._needCollect;if(!isString$1(a)&&!c)return a;if(c&&!this._deduplication)return o=this.categories.length,this.categories[o]=a,o;var d=this._getOrCreateMap();return o=d.get(a),o==null&&(c?(o=this.categories.length,this.categories[o]=a,d.set(a,o)):o=NaN),o},s.prototype._getOrCreateMap=function(){return this._map||(this._map=createHashMap(this.categories))},s}();function getName(s){return isObject$3(s)&&s.value!=null?s.value:s+""}function isIntervalOrLogScale(s){return s.type==="interval"||s.type==="log"}function intervalScaleNiceTicks(s,a,o,c){var d={},tt=s[1]-s[0],nt=d.interval=nice(tt/a,!0);o!=null&&nt<o&&(nt=d.interval=o),c!=null&&nt>c&&(nt=d.interval=c);var it=d.intervalPrecision=getIntervalPrecision(nt),st=d.niceTickExtent=[round$3(Math.ceil(s[0]/nt)*nt,it),round$3(Math.floor(s[1]/nt)*nt,it)];return fixExtent(st,s),d}function increaseInterval(s){var a=Math.pow(10,quantityExponent(s)),o=s/a;return o?o===2?o=3:o===3?o=5:o*=2:o=1,round$3(o*a)}function getIntervalPrecision(s){return getPrecision(s)+2}function clamp(s,a,o){s[a]=Math.max(Math.min(s[a],o[1]),o[0])}function fixExtent(s,a){!isFinite(s[0])&&(s[0]=a[0]),!isFinite(s[1])&&(s[1]=a[1]),clamp(s,0,a),clamp(s,1,a),s[0]>s[1]&&(s[0]=s[1])}function contain$1(s,a){return s>=a[0]&&s<=a[1]}function normalize$2(s,a){return a[1]===a[0]?.5:(s-a[0])/(a[1]-a[0])}function scale(s,a){return s*(a[1]-a[0])+a[0]}var OrdinalScale=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;c.type="ordinal";var d=c.getSetting("ordinalMeta");return d||(d=new OrdinalMeta({})),isArray$1(d)&&(d=new OrdinalMeta({categories:map$1(d,function(tt){return isObject$3(tt)?tt.value:tt})})),c._ordinalMeta=d,c._extent=c.getSetting("extent")||[0,d.categories.length-1],c}return a.prototype.parse=function(o){return o==null?NaN:isString$1(o)?this._ordinalMeta.getOrdinal(o):Math.round(o)},a.prototype.contain=function(o){return o=this.parse(o),contain$1(o,this._extent)&&this._ordinalMeta.categories[o]!=null},a.prototype.normalize=function(o){return o=this._getTickNumber(this.parse(o)),normalize$2(o,this._extent)},a.prototype.scale=function(o){return o=Math.round(scale(o,this._extent)),this.getRawOrdinalNumber(o)},a.prototype.getTicks=function(){for(var o=[],c=this._extent,d=c[0];d<=c[1];)o.push({value:d}),d++;return o},a.prototype.getMinorTicks=function(o){},a.prototype.setSortInfo=function(o){if(o==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var c=o.ordinalNumbers,d=this._ordinalNumbersByTick=[],tt=this._ticksByOrdinalNumber=[],nt=0,it=this._ordinalMeta.categories.length,st=Math.min(it,c.length);nt<st;++nt){var ut=c[nt];d[nt]=ut,tt[ut]=nt}for(var ct=0;nt<it;++nt){for(;tt[ct]!=null;)ct++;d.push(ct),tt[ct]=nt}},a.prototype._getTickNumber=function(o){var c=this._ticksByOrdinalNumber;return c&&o>=0&&o<c.length?c[o]:o},a.prototype.getRawOrdinalNumber=function(o){var c=this._ordinalNumbersByTick;return c&&o>=0&&o<c.length?c[o]:o},a.prototype.getLabel=function(o){if(!this.isBlank()){var c=this.getRawOrdinalNumber(o.value),d=this._ordinalMeta.categories[c];return d==null?"":d+""}},a.prototype.count=function(){return this._extent[1]-this._extent[0]+1},a.prototype.unionExtentFromData=function(o,c){this.unionExtent(o.getApproximateExtent(c))},a.prototype.isInExtentRange=function(o){return o=this._getTickNumber(o),this._extent[0]<=o&&this._extent[1]>=o},a.prototype.getOrdinalMeta=function(){return this._ordinalMeta},a.prototype.calcNiceTicks=function(){},a.prototype.calcNiceExtent=function(){},a.type="ordinal",a}(Scale);Scale.registerClass(OrdinalScale);var roundNumber=round$3,IntervalScale=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="interval",o._interval=0,o._intervalPrecision=2,o}return a.prototype.parse=function(o){return o},a.prototype.contain=function(o){return contain$1(o,this._extent)},a.prototype.normalize=function(o){return normalize$2(o,this._extent)},a.prototype.scale=function(o){return scale(o,this._extent)},a.prototype.setExtent=function(o,c){var d=this._extent;isNaN(o)||(d[0]=parseFloat(o)),isNaN(c)||(d[1]=parseFloat(c))},a.prototype.unionExtent=function(o){var c=this._extent;o[0]<c[0]&&(c[0]=o[0]),o[1]>c[1]&&(c[1]=o[1]),this.setExtent(c[0],c[1])},a.prototype.getInterval=function(){return this._interval},a.prototype.setInterval=function(o){this._interval=o,this._niceExtent=this._extent.slice(),this._intervalPrecision=getIntervalPrecision(o)},a.prototype.getTicks=function(o){var c=this._interval,d=this._extent,tt=this._niceExtent,nt=this._intervalPrecision,it=[];if(!c)return it;var st=1e4;d[0]<tt[0]&&(o?it.push({value:roundNumber(tt[0]-c,nt)}):it.push({value:d[0]}));for(var ut=tt[0];ut<=tt[1]&&(it.push({value:ut}),ut=roundNumber(ut+c,nt),ut!==it[it.length-1].value);)if(it.length>st)return[];var ct=it.length?it[it.length-1].value:tt[1];return d[1]>ct&&(o?it.push({value:roundNumber(ct+c,nt)}):it.push({value:d[1]})),it},a.prototype.getMinorTicks=function(o){for(var c=this.getTicks(!0),d=[],tt=this.getExtent(),nt=1;nt<c.length;nt++){for(var it=c[nt],st=c[nt-1],ut=0,ct=[],ot=it.value-st.value,at=ot/o;ut<o-1;){var ht=roundNumber(st.value+(ut+1)*at);ht>tt[0]&&ht<tt[1]&&ct.push(ht),ut++}d.push(ct)}return d},a.prototype.getLabel=function(o,c){if(o==null)return"";var d=c&&c.precision;d==null?d=getPrecision(o.value)||0:d==="auto"&&(d=this._intervalPrecision);var tt=roundNumber(o.value,d,!0);return addCommas(tt)},a.prototype.calcNiceTicks=function(o,c,d){o=o||5;var tt=this._extent,nt=tt[1]-tt[0];if(isFinite(nt)){nt<0&&(nt=-nt,tt.reverse());var it=intervalScaleNiceTicks(tt,o,c,d);this._intervalPrecision=it.intervalPrecision,this._interval=it.interval,this._niceExtent=it.niceTickExtent}},a.prototype.calcNiceExtent=function(o){var c=this._extent;if(c[0]===c[1])if(c[0]!==0){var d=Math.abs(c[0]);o.fixMax||(c[1]+=d/2),c[0]-=d/2}else c[1]=1;var tt=c[1]-c[0];isFinite(tt)||(c[0]=0,c[1]=1),this.calcNiceTicks(o.splitNumber,o.minInterval,o.maxInterval);var nt=this._interval;o.fixMin||(c[0]=roundNumber(Math.floor(c[0]/nt)*nt)),o.fixMax||(c[1]=roundNumber(Math.ceil(c[1]/nt)*nt))},a.prototype.setNiceExtent=function(o,c){this._niceExtent=[o,c]},a.type="interval",a}(Scale);Scale.registerClass(IntervalScale);var supportFloat32Array=typeof Float32Array<"u",Float32ArrayCtor=supportFloat32Array?Float32Array:Array;function createFloat32Array(s){return isArray$1(s)?supportFloat32Array?new Float32Array(s):s:new Float32ArrayCtor(s)}var STACK_PREFIX="__ec_stack_";function getSeriesStackId$1(s){return s.get("stack")||STACK_PREFIX+s.seriesIndex}function getAxisKey$1(s){return s.dim+s.index}function getLayoutOnAxis(s){var a=[],o=s.axis,c="axis0";if(o.type==="category"){for(var d=o.getBandWidth(),tt=0;tt<s.count;tt++)a.push(defaults({bandWidth:d,axisKey:c,stackId:STACK_PREFIX+tt},s));for(var nt=doCalBarWidthAndOffset(a),it=[],tt=0;tt<s.count;tt++){var st=nt[c][STACK_PREFIX+tt];st.offsetCenter=st.offset+st.width/2,it.push(st)}return it}}function prepareLayoutBarSeries(s,a){var o=[];return a.eachSeriesByType(s,function(c){isOnCartesian(c)&&o.push(c)}),o}function getValueAxesMinGaps(s){var a={};each$f(s,function(st){var ut=st.coordinateSystem,ct=ut.getBaseAxis();if(!(ct.type!=="time"&&ct.type!=="value"))for(var ot=st.getData(),at=ct.dim+"_"+ct.index,ht=ot.getDimensionIndex(ot.mapDimension(ct.dim)),ft=ot.getStore(),mt=0,yt=ft.count();mt<yt;++mt){var bt=ft.get(ht,mt);a[at]?a[at].push(bt):a[at]=[bt]}});var o={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(d){d.sort(function(st,ut){return st-ut});for(var tt=null,nt=1;nt<d.length;++nt){var it=d[nt]-d[nt-1];it>0&&(tt=tt===null?it:Math.min(tt,it))}o[c]=tt}}return o}function makeColumnLayout(s){var a=getValueAxesMinGaps(s),o=[];return each$f(s,function(c){var d=c.coordinateSystem,tt=d.getBaseAxis(),nt=tt.getExtent(),it;if(tt.type==="category")it=tt.getBandWidth();else if(tt.type==="value"||tt.type==="time"){var st=tt.dim+"_"+tt.index,ut=a[st],ct=Math.abs(nt[1]-nt[0]),ot=tt.scale.getExtent(),at=Math.abs(ot[1]-ot[0]);it=ut?ct/at*ut:ct}else{var ht=c.getData();it=Math.abs(nt[1]-nt[0])/ht.count()}var ft=parsePercent(c.get("barWidth"),it),mt=parsePercent(c.get("barMaxWidth"),it),yt=parsePercent(c.get("barMinWidth")||(isInLargeMode(c)?.5:1),it),bt=c.get("barGap"),wt=c.get("barCategoryGap");o.push({bandWidth:it,barWidth:ft,barMaxWidth:mt,barMinWidth:yt,barGap:bt,barCategoryGap:wt,axisKey:getAxisKey$1(tt),stackId:getSeriesStackId$1(c)})}),doCalBarWidthAndOffset(o)}function doCalBarWidthAndOffset(s){var a={};each$f(s,function(c,d){var tt=c.axisKey,nt=c.bandWidth,it=a[tt]||{bandWidth:nt,remainedWidth:nt,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},st=it.stacks;a[tt]=it;var ut=c.stackId;st[ut]||it.autoWidthCount++,st[ut]=st[ut]||{width:0,maxWidth:0};var ct=c.barWidth;ct&&!st[ut].width&&(st[ut].width=ct,ct=Math.min(it.remainedWidth,ct),it.remainedWidth-=ct);var ot=c.barMaxWidth;ot&&(st[ut].maxWidth=ot);var at=c.barMinWidth;at&&(st[ut].minWidth=at);var ht=c.barGap;ht!=null&&(it.gap=ht);var ft=c.barCategoryGap;ft!=null&&(it.categoryGap=ft)});var o={};return each$f(a,function(c,d){o[d]={};var tt=c.stacks,nt=c.bandWidth,it=c.categoryGap;if(it==null){var st=keys(tt).length;it=Math.max(35-st*4,15)+"%"}var ut=parsePercent(it,nt),ct=parsePercent(c.gap,1),ot=c.remainedWidth,at=c.autoWidthCount,ht=(ot-ut)/(at+(at-1)*ct);ht=Math.max(ht,0),each$f(tt,function(bt){var wt=bt.maxWidth,Tt=bt.minWidth;if(bt.width){var Ct=bt.width;wt&&(Ct=Math.min(Ct,wt)),Tt&&(Ct=Math.max(Ct,Tt)),bt.width=Ct,ot-=Ct+ct*Ct,at--}else{var Ct=ht;wt&&wt<Ct&&(Ct=Math.min(wt,ot)),Tt&&Tt>Ct&&(Ct=Tt),Ct!==ht&&(bt.width=Ct,ot-=Ct+ct*Ct,at--)}}),ht=(ot-ut)/(at+(at-1)*ct),ht=Math.max(ht,0);var ft=0,mt;each$f(tt,function(bt,wt){bt.width||(bt.width=ht),mt=bt,ft+=bt.width*(1+ct)}),mt&&(ft-=mt.width*ct);var yt=-ft/2;each$f(tt,function(bt,wt){o[d][wt]=o[d][wt]||{bandWidth:nt,offset:yt,width:bt.width},yt+=bt.width*(1+ct)})}),o}function retrieveColumnLayout(s,a,o){if(s&&a){var c=s[getAxisKey$1(a)];return c}}function layout$3(s,a){var o=prepareLayoutBarSeries(s,a),c=makeColumnLayout(o);each$f(o,function(d){var tt=d.getData(),nt=d.coordinateSystem,it=nt.getBaseAxis(),st=getSeriesStackId$1(d),ut=c[getAxisKey$1(it)][st],ct=ut.offset,ot=ut.width;tt.setLayout({bandWidth:ut.bandWidth,offset:ct,size:ot})})}function createProgressiveLayout(s){return{seriesType:s,plan:createRenderPlanner(),reset:function(a){if(isOnCartesian(a)){var o=a.getData(),c=a.coordinateSystem,d=c.getBaseAxis(),tt=c.getOtherAxis(d),nt=o.getDimensionIndex(o.mapDimension(tt.dim)),it=o.getDimensionIndex(o.mapDimension(d.dim)),st=a.get("showBackground",!0),ut=o.mapDimension(tt.dim),ct=o.getCalculationInfo("stackResultDimension"),ot=isDimensionStacked(o,ut)&&!!o.getCalculationInfo("stackedOnSeries"),at=tt.isHorizontal(),ht=getValueAxisStart(d,tt),ft=isInLargeMode(a),mt=a.get("barMinHeight")||0,yt=ct&&o.getDimensionIndex(ct),bt=o.getLayout("size"),wt=o.getLayout("offset");return{progress:function(Tt,Ct){for(var Dt=Tt.count,Ot=ft&&createFloat32Array(Dt*3),$t=ft&&st&&createFloat32Array(Dt*3),Ft=ft&&createFloat32Array(Dt),kt=c.master.getRect(),Vt=at?kt.width:kt.height,Ht,Qt=Ct.getStore(),Xt=0;(Ht=Tt.next())!=null;){var Zt=Qt.get(ot?yt:nt,Ht),ar=Qt.get(it,Ht),nr=ht,cr=void 0;ot&&(cr=+Zt-Qt.get(nt,Ht));var dr=void 0,mr=void 0,Dr=void 0,kr=void 0;if(at){var Yr=c.dataToPoint([Zt,ar]);if(ot){var Mr=c.dataToPoint([cr,ar]);nr=Mr[0]}dr=nr,mr=Yr[1]+wt,Dr=Yr[0]-nr,kr=bt,Math.abs(Dr)<mt&&(Dr=(Dr<0?-1:1)*mt)}else{var Yr=c.dataToPoint([ar,Zt]);if(ot){var Mr=c.dataToPoint([ar,cr]);nr=Mr[1]}dr=Yr[0]+wt,mr=nr,Dr=bt,kr=Yr[1]-nr,Math.abs(kr)<mt&&(kr=(kr<=0?-1:1)*mt)}ft?(Ot[Xt]=dr,Ot[Xt+1]=mr,Ot[Xt+2]=at?Dr:kr,$t&&($t[Xt]=at?kt.x:dr,$t[Xt+1]=at?mr:kt.y,$t[Xt+2]=Vt),Ft[Ht]=Ht):Ct.setItemLayout(Ht,{x:dr,y:mr,width:Dr,height:kr}),Xt+=3}ft&&Ct.setLayout({largePoints:Ot,largeDataIndices:Ft,largeBackgroundPoints:$t,valueAxisHorizontal:at})}}}}}}function isOnCartesian(s){return s.coordinateSystem&&s.coordinateSystem.type==="cartesian2d"}function isInLargeMode(s){return s.pipelineContext&&s.pipelineContext.large}function getValueAxisStart(s,a){var o=a.model.get("startValue");return o||(o=0),a.toGlobalCoord(a.dataToCoord(a.type==="log"?o>0?o:1:o))}var bisect=function(s,a,o,c){for(;o<c;){var d=o+c>>>1;s[d][1]<a?o=d+1:c=d}return o},TimeScale=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="time",c}return a.prototype.getLabel=function(o){var c=this.getSetting("useUTC");return format$1(o.value,fullLeveledFormatter[getDefaultFormatPrecisionOfInterval(getPrimaryTimeUnit(this._minLevelUnit))]||fullLeveledFormatter.second,c,this.getSetting("locale"))},a.prototype.getFormattedLabel=function(o,c,d){var tt=this.getSetting("useUTC"),nt=this.getSetting("locale");return leveledFormat(o,c,d,nt,tt)},a.prototype.getTicks=function(){var o=this._interval,c=this._extent,d=[];if(!o)return d;d.push({value:c[0],level:0});var tt=this.getSetting("useUTC"),nt=getIntervalTicks(this._minLevelUnit,this._approxInterval,tt,c);return d=d.concat(nt),d.push({value:c[1],level:0}),d},a.prototype.calcNiceExtent=function(o){var c=this._extent;if(c[0]===c[1]&&(c[0]-=ONE_DAY,c[1]+=ONE_DAY),c[1]===-1/0&&c[0]===1/0){var d=new Date;c[1]=+new Date(d.getFullYear(),d.getMonth(),d.getDate()),c[0]=c[1]-ONE_DAY}this.calcNiceTicks(o.splitNumber,o.minInterval,o.maxInterval)},a.prototype.calcNiceTicks=function(o,c,d){o=o||10;var tt=this._extent,nt=tt[1]-tt[0];this._approxInterval=nt/o,c!=null&&this._approxInterval<c&&(this._approxInterval=c),d!=null&&this._approxInterval>d&&(this._approxInterval=d);var it=scaleIntervals.length,st=Math.min(bisect(scaleIntervals,this._approxInterval,0,it),it-1);this._interval=scaleIntervals[st][1],this._minLevelUnit=scaleIntervals[Math.max(st-1,0)][0]},a.prototype.parse=function(o){return isNumber(o)?o:+parseDate(o)},a.prototype.contain=function(o){return contain$1(this.parse(o),this._extent)},a.prototype.normalize=function(o){return normalize$2(this.parse(o),this._extent)},a.prototype.scale=function(o){return scale(o,this._extent)},a.type="time",a}(IntervalScale),scaleIntervals=[["second",ONE_SECOND],["minute",ONE_MINUTE],["hour",ONE_HOUR],["quarter-day",ONE_HOUR*6],["half-day",ONE_HOUR*12],["day",ONE_DAY*1.2],["half-week",ONE_DAY*3.5],["week",ONE_DAY*7],["month",ONE_DAY*31],["quarter",ONE_DAY*95],["half-year",ONE_YEAR/2],["year",ONE_YEAR]];function isUnitValueSame(s,a,o,c){var d=parseDate(a),tt=parseDate(o),nt=function(ft){return getUnitValue(d,ft,c)===getUnitValue(tt,ft,c)},it=function(){return nt("year")},st=function(){return it()&&nt("month")},ut=function(){return st()&&nt("day")},ct=function(){return ut()&&nt("hour")},ot=function(){return ct()&&nt("minute")},at=function(){return ot()&&nt("second")},ht=function(){return at()&&nt("millisecond")};switch(s){case"year":return it();case"month":return st();case"day":return ut();case"hour":return ct();case"minute":return ot();case"second":return at();case"millisecond":return ht()}}function getDateInterval(s,a){return s/=ONE_DAY,s>16?16:s>7.5?7:s>3.5?4:s>1.5?2:1}function getMonthInterval(s){var a=30*ONE_DAY;return s/=a,s>6?6:s>3?3:s>2?2:1}function getHourInterval(s){return s/=ONE_HOUR,s>12?12:s>6?6:s>3.5?4:s>2?2:1}function getMinutesAndSecondsInterval(s,a){return s/=a?ONE_MINUTE:ONE_SECOND,s>30?30:s>20?20:s>15?15:s>10?10:s>5?5:s>2?2:1}function getMillisecondsInterval(s){return nice(s,!0)}function getFirstTimestampOfUnit(s,a,o){var c=new Date(s);switch(getPrimaryTimeUnit(a)){case"year":case"month":c[monthSetterName(o)](0);case"day":c[dateSetterName(o)](1);case"hour":c[hoursSetterName(o)](0);case"minute":c[minutesSetterName(o)](0);case"second":c[secondsSetterName(o)](0),c[millisecondsSetterName(o)](0)}return c.getTime()}function getIntervalTicks(s,a,o,c){var d=1e4,tt=timeUnits,nt=0;function it(Vt,Ht,Qt,Xt,Zt,ar,nr){for(var cr=new Date(Ht),dr=Ht,mr=cr[Xt]();dr<Qt&&dr<=c[1];)nr.push({value:dr}),mr+=Vt,cr[Zt](mr),dr=cr.getTime();nr.push({value:dr,notAdd:!0})}function st(Vt,Ht,Qt){var Xt=[],Zt=!Ht.length;if(!isUnitValueSame(getPrimaryTimeUnit(Vt),c[0],c[1],o)){Zt&&(Ht=[{value:getFirstTimestampOfUnit(new Date(c[0]),Vt,o)},{value:c[1]}]);for(var ar=0;ar<Ht.length-1;ar++){var nr=Ht[ar].value,cr=Ht[ar+1].value;if(nr!==cr){var dr=void 0,mr=void 0,Dr=void 0,kr=!1;switch(Vt){case"year":dr=Math.max(1,Math.round(a/ONE_DAY/365)),mr=fullYearGetterName(o),Dr=fullYearSetterName(o);break;case"half-year":case"quarter":case"month":dr=getMonthInterval(a),mr=monthGetterName(o),Dr=monthSetterName(o);break;case"week":case"half-week":case"day":dr=getDateInterval(a),mr=dateGetterName(o),Dr=dateSetterName(o),kr=!0;break;case"half-day":case"quarter-day":case"hour":dr=getHourInterval(a),mr=hoursGetterName(o),Dr=hoursSetterName(o);break;case"minute":dr=getMinutesAndSecondsInterval(a,!0),mr=minutesGetterName(o),Dr=minutesSetterName(o);break;case"second":dr=getMinutesAndSecondsInterval(a,!1),mr=secondsGetterName(o),Dr=secondsSetterName(o);break;case"millisecond":dr=getMillisecondsInterval(a),mr=millisecondsGetterName(o),Dr=millisecondsSetterName(o);break}it(dr,nr,cr,mr,Dr,kr,Xt),Vt==="year"&&Qt.length>1&&ar===0&&Qt.unshift({value:Qt[0].value-dr})}}for(var ar=0;ar<Xt.length;ar++)Qt.push(Xt[ar]);return Xt}}for(var ut=[],ct=[],ot=0,at=0,ht=0;ht<tt.length&&nt++<d;++ht){var ft=getPrimaryTimeUnit(tt[ht]);if(isPrimaryTimeUnit(tt[ht])){st(tt[ht],ut[ut.length-1]||[],ct);var mt=tt[ht+1]?getPrimaryTimeUnit(tt[ht+1]):null;if(ft!==mt){if(ct.length){at=ot,ct.sort(function(Vt,Ht){return Vt.value-Ht.value});for(var yt=[],bt=0;bt<ct.length;++bt){var wt=ct[bt].value;(bt===0||ct[bt-1].value!==wt)&&(yt.push(ct[bt]),wt>=c[0]&&wt<=c[1]&&ot++)}var Tt=(c[1]-c[0])/a;if(ot>Tt*1.5&&at>Tt/1.5||(ut.push(yt),ot>Tt||s===tt[ht]))break}ct=[]}}}for(var Ct=filter(map$1(ut,function(Vt){return filter(Vt,function(Ht){return Ht.value>=c[0]&&Ht.value<=c[1]&&!Ht.notAdd})}),function(Vt){return Vt.length>0}),Dt=[],Ot=Ct.length-1,ht=0;ht<Ct.length;++ht)for(var $t=Ct[ht],Ft=0;Ft<$t.length;++Ft)Dt.push({value:$t[Ft].value,level:Ot-ht});Dt.sort(function(Vt,Ht){return Vt.value-Ht.value});for(var kt=[],ht=0;ht<Dt.length;++ht)(ht===0||Dt[ht].value!==Dt[ht-1].value)&&kt.push(Dt[ht]);return kt}Scale.registerClass(TimeScale);var scaleProto=Scale.prototype,intervalScaleProto=IntervalScale.prototype,roundingErrorFix=round$3,mathFloor$1=Math.floor,mathCeil$1=Math.ceil,mathPow$1=Math.pow,mathLog$1=Math.log,LogScale=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="log",o.base=10,o._originalScale=new IntervalScale,o._interval=0,o}return a.prototype.getTicks=function(o){var c=this._originalScale,d=this._extent,tt=c.getExtent(),nt=intervalScaleProto.getTicks.call(this,o);return map$1(nt,function(it){var st=it.value,ut=round$3(mathPow$1(this.base,st));return ut=st===d[0]&&this._fixMin?fixRoundingError(ut,tt[0]):ut,ut=st===d[1]&&this._fixMax?fixRoundingError(ut,tt[1]):ut,{value:ut}},this)},a.prototype.setExtent=function(o,c){var d=mathLog$1(this.base);o=mathLog$1(Math.max(0,o))/d,c=mathLog$1(Math.max(0,c))/d,intervalScaleProto.setExtent.call(this,o,c)},a.prototype.getExtent=function(){var o=this.base,c=scaleProto.getExtent.call(this);c[0]=mathPow$1(o,c[0]),c[1]=mathPow$1(o,c[1]);var d=this._originalScale,tt=d.getExtent();return this._fixMin&&(c[0]=fixRoundingError(c[0],tt[0])),this._fixMax&&(c[1]=fixRoundingError(c[1],tt[1])),c},a.prototype.unionExtent=function(o){this._originalScale.unionExtent(o);var c=this.base;o[0]=mathLog$1(o[0])/mathLog$1(c),o[1]=mathLog$1(o[1])/mathLog$1(c),scaleProto.unionExtent.call(this,o)},a.prototype.unionExtentFromData=function(o,c){this.unionExtent(o.getApproximateExtent(c))},a.prototype.calcNiceTicks=function(o){o=o||10;var c=this._extent,d=c[1]-c[0];if(!(d===1/0||d<=0)){var tt=quantity(d),nt=o/d*tt;for(nt<=.5&&(tt*=10);!isNaN(tt)&&Math.abs(tt)<1&&Math.abs(tt)>0;)tt*=10;var it=[round$3(mathCeil$1(c[0]/tt)*tt),round$3(mathFloor$1(c[1]/tt)*tt)];this._interval=tt,this._niceExtent=it}},a.prototype.calcNiceExtent=function(o){intervalScaleProto.calcNiceExtent.call(this,o),this._fixMin=o.fixMin,this._fixMax=o.fixMax},a.prototype.parse=function(o){return o},a.prototype.contain=function(o){return o=mathLog$1(o)/mathLog$1(this.base),contain$1(o,this._extent)},a.prototype.normalize=function(o){return o=mathLog$1(o)/mathLog$1(this.base),normalize$2(o,this._extent)},a.prototype.scale=function(o){return o=scale(o,this._extent),mathPow$1(this.base,o)},a.type="log",a}(Scale),proto=LogScale.prototype;proto.getMinorTicks=intervalScaleProto.getMinorTicks;proto.getLabel=intervalScaleProto.getLabel;function fixRoundingError(s,a){return roundingErrorFix(s,getPrecision(a))}Scale.registerClass(LogScale);var ScaleRawExtentInfo=function(){function s(a,o,c){this._prepareParams(a,o,c)}return s.prototype._prepareParams=function(a,o,c){c[1]<c[0]&&(c=[NaN,NaN]),this._dataMin=c[0],this._dataMax=c[1];var d=this._isOrdinal=a.type==="ordinal";this._needCrossZero=a.type==="interval"&&o.getNeedCrossZero&&o.getNeedCrossZero();var tt=o.get("min",!0);tt==null&&(tt=o.get("startValue",!0));var nt=this._modelMinRaw=tt;isFunction$1(nt)?this._modelMinNum=parseAxisModelMinMax(a,nt({min:c[0],max:c[1]})):nt!=="dataMin"&&(this._modelMinNum=parseAxisModelMinMax(a,nt));var it=this._modelMaxRaw=o.get("max",!0);if(isFunction$1(it)?this._modelMaxNum=parseAxisModelMinMax(a,it({min:c[0],max:c[1]})):it!=="dataMax"&&(this._modelMaxNum=parseAxisModelMinMax(a,it)),d)this._axisDataLen=o.getCategories().length;else{var st=o.get("boundaryGap"),ut=isArray$1(st)?st:[st||0,st||0];typeof ut[0]=="boolean"||typeof ut[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[parsePercent$1(ut[0],1),parsePercent$1(ut[1],1)]}},s.prototype.calculate=function(){var a=this._isOrdinal,o=this._dataMin,c=this._dataMax,d=this._axisDataLen,tt=this._boundaryGapInner,nt=a?null:c-o||Math.abs(o),it=this._modelMinRaw==="dataMin"?o:this._modelMinNum,st=this._modelMaxRaw==="dataMax"?c:this._modelMaxNum,ut=it!=null,ct=st!=null;it==null&&(it=a?d?0:NaN:o-tt[0]*nt),st==null&&(st=a?d?d-1:NaN:c+tt[1]*nt),(it==null||!isFinite(it))&&(it=NaN),(st==null||!isFinite(st))&&(st=NaN);var ot=eqNaN(it)||eqNaN(st)||a&&!d;this._needCrossZero&&(it>0&&st>0&&!ut&&(it=0),it<0&&st<0&&!ct&&(st=0));var at=this._determinedMin,ht=this._determinedMax;return at!=null&&(it=at,ut=!0),ht!=null&&(st=ht,ct=!0),{min:it,max:st,minFixed:ut,maxFixed:ct,isBlank:ot}},s.prototype.modifyDataMinMax=function(a,o){this[DATA_MIN_MAX_ATTR[a]]=o},s.prototype.setDeterminedMinMax=function(a,o){var c=DETERMINED_MIN_MAX_ATTR[a];this[c]=o},s.prototype.freeze=function(){this.frozen=!0},s}(),DETERMINED_MIN_MAX_ATTR={min:"_determinedMin",max:"_determinedMax"},DATA_MIN_MAX_ATTR={min:"_dataMin",max:"_dataMax"};function ensureScaleRawExtentInfo(s,a,o){var c=s.rawExtentInfo;return c||(c=new ScaleRawExtentInfo(s,a,o),s.rawExtentInfo=c,c)}function parseAxisModelMinMax(s,a){return a==null?null:eqNaN(a)?NaN:s.parse(a)}function getScaleExtent(s,a){var o=s.type,c=ensureScaleRawExtentInfo(s,a,s.getExtent()).calculate();s.setBlank(c.isBlank);var d=c.min,tt=c.max,nt=a.ecModel;if(nt&&o==="time"){var it=prepareLayoutBarSeries("bar",nt),st=!1;if(each$f(it,function(ot){st=st||ot.getBaseAxis()===a.axis}),st){var ut=makeColumnLayout(it),ct=adjustScaleForOverflow(d,tt,a,ut);d=ct.min,tt=ct.max}}return{extent:[d,tt],fixMin:c.minFixed,fixMax:c.maxFixed}}function adjustScaleForOverflow(s,a,o,c){var d=o.axis.getExtent(),tt=Math.abs(d[1]-d[0]),nt=retrieveColumnLayout(c,o.axis);if(nt===void 0)return{min:s,max:a};var it=1/0;each$f(nt,function(ht){it=Math.min(ht.offset,it)});var st=-1/0;each$f(nt,function(ht){st=Math.max(ht.offset+ht.width,st)}),it=Math.abs(it),st=Math.abs(st);var ut=it+st,ct=a-s,ot=1-(it+st)/tt,at=ct/ot-ct;return a+=at*(st/ut),s-=at*(it/ut),{min:s,max:a}}function niceScaleExtent(s,a){var o=a,c=getScaleExtent(s,o),d=c.extent,tt=o.get("splitNumber");s instanceof LogScale&&(s.base=o.get("logBase"));var nt=s.type,it=o.get("interval"),st=nt==="interval"||nt==="time";s.setExtent(d[0],d[1]),s.calcNiceExtent({splitNumber:tt,fixMin:c.fixMin,fixMax:c.fixMax,minInterval:st?o.get("minInterval"):null,maxInterval:st?o.get("maxInterval"):null}),it!=null&&s.setInterval&&s.setInterval(it)}function createScaleByModel$1(s,a){if(a=a||s.get("type"),a)switch(a){case"category":return new OrdinalScale({ordinalMeta:s.getOrdinalMeta?s.getOrdinalMeta():s.getCategories(),extent:[1/0,-1/0]});case"time":return new TimeScale({locale:s.ecModel.getLocaleModel(),useUTC:s.ecModel.get("useUTC")});default:return new(Scale.getClass(a)||IntervalScale)}}function ifAxisCrossZero(s){var a=s.scale.getExtent(),o=a[0],c=a[1];return!(o>0&&c>0||o<0&&c<0)}function makeLabelFormatter(s){var a=s.getLabelModel().get("formatter"),o=s.type==="category"?s.scale.getExtent()[0]:null;return s.scale.type==="time"?function(c){return function(d,tt){return s.scale.getFormattedLabel(d,tt,c)}}(a):isString$1(a)?function(c){return function(d){var tt=s.scale.getLabel(d),nt=c.replace("{value}",tt??"");return nt}}(a):isFunction$1(a)?function(c){return function(d,tt){return o!=null&&(tt=d.value-o),c(getAxisRawValue(s,d),tt,d.level!=null?{level:d.level}:null)}}(a):function(c){return s.scale.getLabel(c)}}function getAxisRawValue(s,a){return s.type==="category"?s.scale.getLabel(a):a.value}function estimateLabelUnionRect(s){var a=s.model,o=s.scale;if(!(!a.get(["axisLabel","show"])||o.isBlank())){var c,d,tt=o.getExtent();o instanceof OrdinalScale?d=o.count():(c=o.getTicks(),d=c.length);var nt=s.getLabelModel(),it=makeLabelFormatter(s),st,ut=1;d>40&&(ut=Math.ceil(d/40));for(var ct=0;ct<d;ct+=ut){var ot=c?c[ct]:{value:tt[0]+ct},at=it(ot,ct),ht=nt.getTextRect(at),ft=rotateTextRect(ht,nt.get("rotate")||0);st?st.union(ft):st=ft}return st}}function rotateTextRect(s,a){var o=a*Math.PI/180,c=s.width,d=s.height,tt=c*Math.abs(Math.cos(o))+Math.abs(d*Math.sin(o)),nt=c*Math.abs(Math.sin(o))+Math.abs(d*Math.cos(o)),it=new BoundingRect(s.x,s.y,tt,nt);return it}function getOptionCategoryInterval(s){var a=s.get("interval");return a??"auto"}function shouldShowAllLabels(s){return s.type==="category"&&getOptionCategoryInterval(s.getLabelModel())===0}function getDataDimensionsOnAxis(s,a){var o={};return each$f(s.mapDimensionsAll(a),function(c){o[getStackedDimension(s,c)]=!0}),keys(o)}function unionAxisExtentFromData(s,a,o){a&&each$f(getDataDimensionsOnAxis(a,o),function(c){var d=a.getApproximateExtent(c);d[0]<s[0]&&(s[0]=d[0]),d[1]>s[1]&&(s[1]=d[1])})}var AxisModelCommonMixin=function(){function s(){}return s.prototype.getNeedCrossZero=function(){var a=this.option;return!a.scale},s.prototype.getCoordSysModel=function(){},s}();function createList$2(s){return createSeriesData(null,s)}var dataStack={isDimensionStacked,enableDataStack,getStackedDimension};function createScale(s,a){var o=a;a instanceof Model||(o=new Model(a));var c=createScaleByModel$1(o);return c.setExtent(s[0],s[1]),niceScaleExtent(c,o),c}function mixinAxisModelCommonMethods(s){mixin(s,AxisModelCommonMixin)}function createTextStyle(s,a){return a=a||{},createTextStyle$1(s,null,null,a.state!=="normal")}const helper=Object.freeze(Object.defineProperty({__proto__:null,createDimensions,createList:createList$2,createScale,createSymbol:createSymbol$1,createTextStyle,dataStack,enableHoverEmphasis,getECData,getLayoutRect,mixinAxisModelCommonMethods},Symbol.toStringTag,{value:"Module"}));var EPSILON=1e-8;function isAroundEqual(s,a){return Math.abs(s-a)<EPSILON}function contain(s,a,o){var c=0,d=s[0];if(!d)return!1;for(var tt=1;tt<s.length;tt++){var nt=s[tt];c+=windingLine(d[0],d[1],nt[0],nt[1],a,o),d=nt}var it=s[0];return(!isAroundEqual(d[0],it[0])||!isAroundEqual(d[1],it[1]))&&(c+=windingLine(d[0],d[1],it[0],it[1],a,o)),c!==0}var TMP_TRANSFORM=[];function transformPoints(s,a){for(var o=0;o<s.length;o++)applyTransform$1(s[o],s[o],a)}function updateBBoxFromPoints(s,a,o,c){for(var d=0;d<s.length;d++){var tt=s[d];c&&(tt=c.project(tt)),tt&&isFinite(tt[0])&&isFinite(tt[1])&&(min$1(a,a,tt),max$2(o,o,tt))}}function centroid$1(s){for(var a=0,o=0,c=0,d=s.length,tt=s[d-1][0],nt=s[d-1][1],it=0;it<d;it++){var st=s[it][0],ut=s[it][1],ct=tt*ut-st*nt;a+=ct,o+=(tt+st)*ct,c+=(nt+ut)*ct,tt=st,nt=ut}return a?[o/a/3,c/a/3,a]:[s[0][0]||0,s[0][1]||0]}var Region=function(){function s(a){this.name=a}return s.prototype.setCenter=function(a){this._center=a},s.prototype.getCenter=function(){var a=this._center;return a||(a=this._center=this.calcCenter()),a},s}(),GeoJSONPolygonGeometry=function(){function s(a,o){this.type="polygon",this.exterior=a,this.interiors=o}return s}(),GeoJSONLineStringGeometry=function(){function s(a){this.type="linestring",this.points=a}return s}(),GeoJSONRegion=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this,o)||this;return tt.type="geoJSON",tt.geometries=c,tt._center=d&&[d[0],d[1]],tt}return a.prototype.calcCenter=function(){for(var o=this.geometries,c,d=0,tt=0;tt<o.length;tt++){var nt=o[tt],it=nt.exterior,st=it&&it.length;st>d&&(c=nt,d=st)}if(c)return centroid$1(c.exterior);var ut=this.getBoundingRect();return[ut.x+ut.width/2,ut.y+ut.height/2]},a.prototype.getBoundingRect=function(o){var c=this._rect;if(c&&!o)return c;var d=[1/0,1/0],tt=[-1/0,-1/0],nt=this.geometries;return each$f(nt,function(it){it.type==="polygon"?updateBBoxFromPoints(it.exterior,d,tt,o):each$f(it.points,function(st){updateBBoxFromPoints(st,d,tt,o)})}),isFinite(d[0])&&isFinite(d[1])&&isFinite(tt[0])&&isFinite(tt[1])||(d[0]=d[1]=tt[0]=tt[1]=0),c=new BoundingRect(d[0],d[1],tt[0]-d[0],tt[1]-d[1]),o||(this._rect=c),c},a.prototype.contain=function(o){var c=this.getBoundingRect(),d=this.geometries;if(!c.contain(o[0],o[1]))return!1;e:for(var tt=0,nt=d.length;tt<nt;tt++){var it=d[tt];if(it.type==="polygon"){var st=it.exterior,ut=it.interiors;if(contain(st,o[0],o[1])){for(var ct=0;ct<(ut?ut.length:0);ct++)if(contain(ut[ct],o[0],o[1]))continue e;return!0}}}return!1},a.prototype.transformTo=function(o,c,d,tt){var nt=this.getBoundingRect(),it=nt.width/nt.height;d?tt||(tt=d/it):d=it*tt;for(var st=new BoundingRect(o,c,d,tt),ut=nt.calculateTransform(st),ct=this.geometries,ot=0;ot<ct.length;ot++){var at=ct[ot];at.type==="polygon"?(transformPoints(at.exterior,ut),each$f(at.interiors,function(ht){transformPoints(ht,ut)})):each$f(at.points,function(ht){transformPoints(ht,ut)})}nt=this._rect,nt.copy(st),this._center=[nt.x+nt.width/2,nt.y+nt.height/2]},a.prototype.cloneShallow=function(o){o==null&&(o=this.name);var c=new a(o,this.geometries,this._center);return c._rect=this._rect,c.transformTo=null,c},a}(Region),GeoSVGRegion=function(s){__extends$1(a,s);function a(o,c){var d=s.call(this,o)||this;return d.type="geoSVG",d._elOnlyForCalculate=c,d}return a.prototype.calcCenter=function(){for(var o=this._elOnlyForCalculate,c=o.getBoundingRect(),d=[c.x+c.width/2,c.y+c.height/2],tt=identity(TMP_TRANSFORM),nt=o;nt&&!nt.isGeoSVGGraphicRoot;)mul(tt,nt.getLocalTransform(),tt),nt=nt.parent;return invert(tt,tt),applyTransform$1(d,d,tt),d},a}(Region);function decode(s){if(!s.UTF8Encoding)return s;var a=s,o=a.UTF8Scale;o==null&&(o=1024);var c=a.features;return each$f(c,function(d){var tt=d.geometry,nt=tt.encodeOffsets,it=tt.coordinates;if(nt)switch(tt.type){case"LineString":tt.coordinates=decodeRing(it,nt,o);break;case"Polygon":decodeRings(it,nt,o);break;case"MultiLineString":decodeRings(it,nt,o);break;case"MultiPolygon":each$f(it,function(st,ut){return decodeRings(st,nt[ut],o)})}}),a.UTF8Encoding=!1,a}function decodeRings(s,a,o){for(var c=0;c<s.length;c++)s[c]=decodeRing(s[c],a[c],o)}function decodeRing(s,a,o){for(var c=[],d=a[0],tt=a[1],nt=0;nt<s.length;nt+=2){var it=s.charCodeAt(nt)-64,st=s.charCodeAt(nt+1)-64;it=it>>1^-(it&1),st=st>>1^-(st&1),it+=d,st+=tt,d=it,tt=st,c.push([it/o,st/o])}return c}function parseGeoJSON(s,a){return s=decode(s),map$1(filter(s.features,function(o){return o.geometry&&o.properties&&o.geometry.coordinates.length>0}),function(o){var c=o.properties,d=o.geometry,tt=[];switch(d.type){case"Polygon":var nt=d.coordinates;tt.push(new GeoJSONPolygonGeometry(nt[0],nt.slice(1)));break;case"MultiPolygon":each$f(d.coordinates,function(st){st[0]&&tt.push(new GeoJSONPolygonGeometry(st[0],st.slice(1)))});break;case"LineString":tt.push(new GeoJSONLineStringGeometry([d.coordinates]));break;case"MultiLineString":tt.push(new GeoJSONLineStringGeometry(d.coordinates))}var it=new GeoJSONRegion(c[a||"name"],tt,c.cp);return it.properties=c,it})}const number=Object.freeze(Object.defineProperty({__proto__:null,MAX_SAFE_INTEGER,asc:asc$2,getPercentWithPrecision,getPixelPrecision,getPrecision,getPrecisionSafe,isNumeric,isRadianAroundZero,linearMap:linearMap$2,nice,numericToNumber,parseDate,quantile,quantity,quantityExponent,reformIntervals,remRadian,round:round$3},Symbol.toStringTag,{value:"Module"})),time=Object.freeze(Object.defineProperty({__proto__:null,format:format$1,parse:parseDate},Symbol.toStringTag,{value:"Module"})),graphic=Object.freeze(Object.defineProperty({__proto__:null,Arc,BezierCurve,BoundingRect,Circle,CompoundPath,Ellipse,Group:Group$3,Image:ZRImage,IncrementalDisplayable,Line:Line$1,LinearGradient,Polygon,Polyline:Polyline$1,RadialGradient,Rect:Rect$2,Ring,Sector,Text:ZRText,clipPointsByRect,clipRectByRect,createIcon,extendPath,extendShape,getShapeClass,getTransform:getTransform$1,initProps,makeImage,makePath,mergePath,registerShape,resizePath,updateProps:updateProps$1},Symbol.toStringTag,{value:"Module"})),format=Object.freeze(Object.defineProperty({__proto__:null,addCommas,capitalFirst,encodeHTML,formatTime,formatTpl,getTextRect,getTooltipMarker,normalizeCssArray,toCamelCase,truncateText},Symbol.toStringTag,{value:"Module"})),util=Object.freeze(Object.defineProperty({__proto__:null,bind:bind$2,clone:clone$4,curry:curry$1,defaults,each:each$f,extend,filter,indexOf,inherits,isArray:isArray$1,isFunction:isFunction$1,isObject:isObject$3,isString:isString$1,map:map$1,merge,reduce},Symbol.toStringTag,{value:"Module"}));var inner$g=makeInner();function tickValuesToNumbers(s,a){var o=map$1(a,function(c){return s.scale.parse(c)});return s.type==="time"&&o.length>0&&(o.sort(),o.unshift(o[0]),o.push(o[o.length-1])),o}function createAxisLabels(s){var a=s.getLabelModel().get("customValues");if(a){var o=makeLabelFormatter(s),c=s.scale.getExtent(),d=tickValuesToNumbers(s,a),tt=filter(d,function(nt){return nt>=c[0]&&nt<=c[1]});return{labels:map$1(tt,function(nt){var it={value:nt};return{formattedLabel:o(it),rawLabel:s.scale.getLabel(it),tickValue:nt}})}}return s.type==="category"?makeCategoryLabels(s):makeRealNumberLabels(s)}function createAxisTicks(s,a){var o=s.getTickModel().get("customValues");if(o){var c=s.scale.getExtent(),d=tickValuesToNumbers(s,o);return{ticks:filter(d,function(tt){return tt>=c[0]&&tt<=c[1]})}}return s.type==="category"?makeCategoryTicks(s,a):{ticks:map$1(s.scale.getTicks(),function(tt){return tt.value})}}function makeCategoryLabels(s){var a=s.getLabelModel(),o=makeCategoryLabelsActually(s,a);return!a.get("show")||s.scale.isBlank()?{labels:[],labelCategoryInterval:o.labelCategoryInterval}:o}function makeCategoryLabelsActually(s,a){var o=getListCache(s,"labels"),c=getOptionCategoryInterval(a),d=listCacheGet(o,c);if(d)return d;var tt,nt;return isFunction$1(c)?tt=makeLabelsByCustomizedCategoryInterval(s,c):(nt=c==="auto"?makeAutoCategoryInterval(s):c,tt=makeLabelsByNumericCategoryInterval(s,nt)),listCacheSet(o,c,{labels:tt,labelCategoryInterval:nt})}function makeCategoryTicks(s,a){var o=getListCache(s,"ticks"),c=getOptionCategoryInterval(a),d=listCacheGet(o,c);if(d)return d;var tt,nt;if((!a.get("show")||s.scale.isBlank())&&(tt=[]),isFunction$1(c))tt=makeLabelsByCustomizedCategoryInterval(s,c,!0);else if(c==="auto"){var it=makeCategoryLabelsActually(s,s.getLabelModel());nt=it.labelCategoryInterval,tt=map$1(it.labels,function(st){return st.tickValue})}else nt=c,tt=makeLabelsByNumericCategoryInterval(s,nt,!0);return listCacheSet(o,c,{ticks:tt,tickCategoryInterval:nt})}function makeRealNumberLabels(s){var a=s.scale.getTicks(),o=makeLabelFormatter(s);return{labels:map$1(a,function(c,d){return{level:c.level,formattedLabel:o(c,d),rawLabel:s.scale.getLabel(c),tickValue:c.value}})}}function getListCache(s,a){return inner$g(s)[a]||(inner$g(s)[a]=[])}function listCacheGet(s,a){for(var o=0;o<s.length;o++)if(s[o].key===a)return s[o].value}function listCacheSet(s,a,o){return s.push({key:a,value:o}),o}function makeAutoCategoryInterval(s){var a=inner$g(s).autoInterval;return a??(inner$g(s).autoInterval=s.calculateCategoryInterval())}function calculateCategoryInterval(s){var a=fetchAutoCategoryIntervalCalculationParams(s),o=makeLabelFormatter(s),c=(a.axisRotate-a.labelRotate)/180*Math.PI,d=s.scale,tt=d.getExtent(),nt=d.count();if(tt[1]-tt[0]<1)return 0;var it=1;nt>40&&(it=Math.max(1,Math.floor(nt/40)));for(var st=tt[0],ut=s.dataToCoord(st+1)-s.dataToCoord(st),ct=Math.abs(ut*Math.cos(c)),ot=Math.abs(ut*Math.sin(c)),at=0,ht=0;st<=tt[1];st+=it){var ft=0,mt=0,yt=getBoundingRect(o({value:st}),a.font,"center","top");ft=yt.width*1.3,mt=yt.height*1.3,at=Math.max(at,ft,7),ht=Math.max(ht,mt,7)}var bt=at/ct,wt=ht/ot;isNaN(bt)&&(bt=1/0),isNaN(wt)&&(wt=1/0);var Tt=Math.max(0,Math.floor(Math.min(bt,wt))),Ct=inner$g(s.model),Dt=s.getExtent(),Ot=Ct.lastAutoInterval,$t=Ct.lastTickCount;return Ot!=null&&$t!=null&&Math.abs(Ot-Tt)<=1&&Math.abs($t-nt)<=1&&Ot>Tt&&Ct.axisExtent0===Dt[0]&&Ct.axisExtent1===Dt[1]?Tt=Ot:(Ct.lastTickCount=nt,Ct.lastAutoInterval=Tt,Ct.axisExtent0=Dt[0],Ct.axisExtent1=Dt[1]),Tt}function fetchAutoCategoryIntervalCalculationParams(s){var a=s.getLabelModel();return{axisRotate:s.getRotate?s.getRotate():s.isHorizontal&&!s.isHorizontal()?90:0,labelRotate:a.get("rotate")||0,font:a.getFont()}}function makeLabelsByNumericCategoryInterval(s,a,o){var c=makeLabelFormatter(s),d=s.scale,tt=d.getExtent(),nt=s.getLabelModel(),it=[],st=Math.max((a||0)+1,1),ut=tt[0],ct=d.count();ut!==0&&st>1&&ct/st>2&&(ut=Math.round(Math.ceil(ut/st)*st));var ot=shouldShowAllLabels(s),at=nt.get("showMinLabel")||ot,ht=nt.get("showMaxLabel")||ot;at&&ut!==tt[0]&&mt(tt[0]);for(var ft=ut;ft<=tt[1];ft+=st)mt(ft);ht&&ft-st!==tt[1]&&mt(tt[1]);function mt(yt){var bt={value:yt};it.push(o?yt:{formattedLabel:c(bt),rawLabel:d.getLabel(bt),tickValue:yt})}return it}function makeLabelsByCustomizedCategoryInterval(s,a,o){var c=s.scale,d=makeLabelFormatter(s),tt=[];return each$f(c.getTicks(),function(nt){var it=c.getLabel(nt),st=nt.value;a(nt.value,it)&&tt.push(o?st:{formattedLabel:d(nt),rawLabel:it,tickValue:st})}),tt}var NORMALIZED_EXTENT=[0,1],Axis=function(){function s(a,o,c){this.onBand=!1,this.inverse=!1,this.dim=a,this.scale=o,this._extent=c||[0,0]}return s.prototype.contain=function(a){var o=this._extent,c=Math.min(o[0],o[1]),d=Math.max(o[0],o[1]);return a>=c&&a<=d},s.prototype.containData=function(a){return this.scale.contain(a)},s.prototype.getExtent=function(){return this._extent.slice()},s.prototype.getPixelPrecision=function(a){return getPixelPrecision(a||this.scale.getExtent(),this._extent)},s.prototype.setExtent=function(a,o){var c=this._extent;c[0]=a,c[1]=o},s.prototype.dataToCoord=function(a,o){var c=this._extent,d=this.scale;return a=d.normalize(a),this.onBand&&d.type==="ordinal"&&(c=c.slice(),fixExtentWithBands(c,d.count())),linearMap$2(a,NORMALIZED_EXTENT,c,o)},s.prototype.coordToData=function(a,o){var c=this._extent,d=this.scale;this.onBand&&d.type==="ordinal"&&(c=c.slice(),fixExtentWithBands(c,d.count()));var tt=linearMap$2(a,c,NORMALIZED_EXTENT,o);return this.scale.scale(tt)},s.prototype.pointToData=function(a,o){},s.prototype.getTicksCoords=function(a){a=a||{};var o=a.tickModel||this.getTickModel(),c=createAxisTicks(this,o),d=c.ticks,tt=map$1(d,function(it){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(it):it),tickValue:it}},this),nt=o.get("alignWithLabel");return fixOnBandTicksCoords(this,tt,nt,a.clamp),tt},s.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var a=this.model.getModel("minorTick"),o=a.get("splitNumber");o>0&&o<100||(o=5);var c=this.scale.getMinorTicks(o),d=map$1(c,function(tt){return map$1(tt,function(nt){return{coord:this.dataToCoord(nt),tickValue:nt}},this)},this);return d},s.prototype.getViewLabels=function(){return createAxisLabels(this).labels},s.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},s.prototype.getTickModel=function(){return this.model.getModel("axisTick")},s.prototype.getBandWidth=function(){var a=this._extent,o=this.scale.getExtent(),c=o[1]-o[0]+(this.onBand?1:0);c===0&&(c=1);var d=Math.abs(a[1]-a[0]);return Math.abs(d)/c},s.prototype.calculateCategoryInterval=function(){return calculateCategoryInterval(this)},s}();function fixExtentWithBands(s,a){var o=s[1]-s[0],c=a,d=o/c/2;s[0]+=d,s[1]-=d}function fixOnBandTicksCoords(s,a,o,c){var d=a.length;if(!s.onBand||o||!d)return;var tt=s.getExtent(),nt,it;if(d===1)a[0].coord=tt[0],nt=a[1]={coord:tt[1],tickValue:a[0].tickValue};else{var st=a[d-1].tickValue-a[0].tickValue,ut=(a[d-1].coord-a[0].coord)/st;each$f(a,function(ht){ht.coord-=ut/2});var ct=s.scale.getExtent();it=1+ct[1]-a[d-1].tickValue,nt={coord:a[d-1].coord+ut*it,tickValue:ct[1]+1},a.push(nt)}var ot=tt[0]>tt[1];at(a[0].coord,tt[0])&&(c?a[0].coord=tt[0]:a.shift()),c&&at(tt[0],a[0].coord)&&a.unshift({coord:tt[0]}),at(tt[1],nt.coord)&&(c?nt.coord=tt[1]:a.pop()),c&&at(nt.coord,tt[1])&&a.push({coord:tt[1]});function at(ht,ft){return ht=round$3(ht),ft=round$3(ft),ot?ht>ft:ht<ft}}function extendComponentModel(s){var a=ComponentModel.extend(s);return ComponentModel.registerClass(a),a}function extendComponentView(s){var a=ComponentView.extend(s);return ComponentView.registerClass(a),a}function extendSeriesModel(s){var a=SeriesModel.extend(s);return SeriesModel.registerClass(a),a}function extendChartView(s){var a=ChartView.extend(s);return ChartView.registerClass(a),a}var PI2$2=Math.PI*2,CMD$1=PathProxy.CMD,DEFAULT_SEARCH_SPACE=["top","right","bottom","left"];function getCandidateAnchor(s,a,o,c,d){var tt=o.width,nt=o.height;switch(s){case"top":c.set(o.x+tt/2,o.y-a),d.set(0,-1);break;case"bottom":c.set(o.x+tt/2,o.y+nt+a),d.set(0,1);break;case"left":c.set(o.x-a,o.y+nt/2),d.set(-1,0);break;case"right":c.set(o.x+tt+a,o.y+nt/2),d.set(1,0);break}}function projectPointToArc(s,a,o,c,d,tt,nt,it,st){nt-=s,it-=a;var ut=Math.sqrt(nt*nt+it*it);nt/=ut,it/=ut;var ct=nt*o+s,ot=it*o+a;if(Math.abs(c-d)%PI2$2<1e-4)return st[0]=ct,st[1]=ot,ut-o;if(tt){var at=c;c=normalizeRadian(d),d=normalizeRadian(at)}else c=normalizeRadian(c),d=normalizeRadian(d);c>d&&(d+=PI2$2);var ht=Math.atan2(it,nt);if(ht<0&&(ht+=PI2$2),ht>=c&&ht<=d||ht+PI2$2>=c&&ht+PI2$2<=d)return st[0]=ct,st[1]=ot,ut-o;var ft=o*Math.cos(c)+s,mt=o*Math.sin(c)+a,yt=o*Math.cos(d)+s,bt=o*Math.sin(d)+a,wt=(ft-nt)*(ft-nt)+(mt-it)*(mt-it),Tt=(yt-nt)*(yt-nt)+(bt-it)*(bt-it);return wt<Tt?(st[0]=ft,st[1]=mt,Math.sqrt(wt)):(st[0]=yt,st[1]=bt,Math.sqrt(Tt))}function projectPointToLine(s,a,o,c,d,tt,nt,it){var st=d-s,ut=tt-a,ct=o-s,ot=c-a,at=Math.sqrt(ct*ct+ot*ot);ct/=at,ot/=at;var ht=st*ct+ut*ot,ft=ht/at;it&&(ft=Math.min(Math.max(ft,0),1)),ft*=at;var mt=nt[0]=s+ft*ct,yt=nt[1]=a+ft*ot;return Math.sqrt((mt-d)*(mt-d)+(yt-tt)*(yt-tt))}function projectPointToRect(s,a,o,c,d,tt,nt){o<0&&(s=s+o,o=-o),c<0&&(a=a+c,c=-c);var it=s+o,st=a+c,ut=nt[0]=Math.min(Math.max(d,s),it),ct=nt[1]=Math.min(Math.max(tt,a),st);return Math.sqrt((ut-d)*(ut-d)+(ct-tt)*(ct-tt))}var tmpPt=[];function nearestPointOnRect(s,a,o){var c=projectPointToRect(a.x,a.y,a.width,a.height,s.x,s.y,tmpPt);return o.set(tmpPt[0],tmpPt[1]),c}function nearestPointOnPath(s,a,o){for(var c=0,d=0,tt=0,nt=0,it,st,ut=1/0,ct=a.data,ot=s.x,at=s.y,ht=0;ht<ct.length;){var ft=ct[ht++];ht===1&&(c=ct[ht],d=ct[ht+1],tt=c,nt=d);var mt=ut;switch(ft){case CMD$1.M:tt=ct[ht++],nt=ct[ht++],c=tt,d=nt;break;case CMD$1.L:mt=projectPointToLine(c,d,ct[ht],ct[ht+1],ot,at,tmpPt,!0),c=ct[ht++],d=ct[ht++];break;case CMD$1.C:mt=cubicProjectPoint(c,d,ct[ht++],ct[ht++],ct[ht++],ct[ht++],ct[ht],ct[ht+1],ot,at,tmpPt),c=ct[ht++],d=ct[ht++];break;case CMD$1.Q:mt=quadraticProjectPoint(c,d,ct[ht++],ct[ht++],ct[ht],ct[ht+1],ot,at,tmpPt),c=ct[ht++],d=ct[ht++];break;case CMD$1.A:var yt=ct[ht++],bt=ct[ht++],wt=ct[ht++],Tt=ct[ht++],Ct=ct[ht++],Dt=ct[ht++];ht+=1;var Ot=!!(1-ct[ht++]);it=Math.cos(Ct)*wt+yt,st=Math.sin(Ct)*Tt+bt,ht<=1&&(tt=it,nt=st);var $t=(ot-yt)*Tt/wt+yt;mt=projectPointToArc(yt,bt,Tt,Ct,Ct+Dt,Ot,$t,at,tmpPt),c=Math.cos(Ct+Dt)*wt+yt,d=Math.sin(Ct+Dt)*Tt+bt;break;case CMD$1.R:tt=c=ct[ht++],nt=d=ct[ht++];var Ft=ct[ht++],kt=ct[ht++];mt=projectPointToRect(tt,nt,Ft,kt,ot,at,tmpPt);break;case CMD$1.Z:mt=projectPointToLine(c,d,tt,nt,ot,at,tmpPt,!0),c=tt,d=nt;break}mt<ut&&(ut=mt,o.set(tmpPt[0],tmpPt[1]))}return ut}var pt0=new Point,pt1=new Point,pt2=new Point,dir=new Point,dir2=new Point;function updateLabelLinePoints(s,a){if(s){var o=s.getTextGuideLine(),c=s.getTextContent();if(c&&o){var d=s.textGuideLineConfig||{},tt=[[0,0],[0,0],[0,0]],nt=d.candidates||DEFAULT_SEARCH_SPACE,it=c.getBoundingRect().clone();it.applyTransform(c.getComputedTransform());var st=1/0,ut=d.anchor,ct=s.getComputedTransform(),ot=ct&&invert([],ct),at=a.get("length2")||0;ut&&pt2.copy(ut);for(var ht=0;ht<nt.length;ht++){var ft=nt[ht];getCandidateAnchor(ft,0,it,pt0,dir),Point.scaleAndAdd(pt1,pt0,dir,at),pt1.transform(ot);var mt=s.getBoundingRect(),yt=ut?ut.distance(pt1):s instanceof Path?nearestPointOnPath(pt1,s.path,pt2):nearestPointOnRect(pt1,mt,pt2);yt<st&&(st=yt,pt1.transform(ct),pt2.transform(ct),pt2.toArray(tt[0]),pt1.toArray(tt[1]),pt0.toArray(tt[2]))}limitTurnAngle(tt,a.get("minTurnAngle")),o.setShape({points:tt})}}}var tmpArr=[],tmpProjPoint=new Point;function limitTurnAngle(s,a){if(a<=180&&a>0){a=a/180*Math.PI,pt0.fromArray(s[0]),pt1.fromArray(s[1]),pt2.fromArray(s[2]),Point.sub(dir,pt0,pt1),Point.sub(dir2,pt2,pt1);var o=dir.len(),c=dir2.len();if(!(o<.001||c<.001)){dir.scale(1/o),dir2.scale(1/c);var d=dir.dot(dir2),tt=Math.cos(a);if(tt<d){var nt=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr,!1);tmpProjPoint.fromArray(tmpArr),tmpProjPoint.scaleAndAdd(dir2,nt/Math.tan(Math.PI-a));var it=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(it))return;it<0?Point.copy(tmpProjPoint,pt1):it>1&&Point.copy(tmpProjPoint,pt2),tmpProjPoint.toArray(s[1])}}}}function limitSurfaceAngle(s,a,o){if(o<=180&&o>0){o=o/180*Math.PI,pt0.fromArray(s[0]),pt1.fromArray(s[1]),pt2.fromArray(s[2]),Point.sub(dir,pt1,pt0),Point.sub(dir2,pt2,pt1);var c=dir.len(),d=dir2.len();if(!(c<.001||d<.001)){dir.scale(1/c),dir2.scale(1/d);var tt=dir.dot(a),nt=Math.cos(o);if(tt<nt){var it=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr,!1);tmpProjPoint.fromArray(tmpArr);var st=Math.PI/2,ut=Math.acos(dir2.dot(a)),ct=st+ut-o;if(ct>=st)Point.copy(tmpProjPoint,pt2);else{tmpProjPoint.scaleAndAdd(dir2,it/Math.tan(Math.PI/2-ct));var ot=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(ot))return;ot<0?Point.copy(tmpProjPoint,pt1):ot>1&&Point.copy(tmpProjPoint,pt2)}tmpProjPoint.toArray(s[1])}}}}function setLabelLineState(s,a,o,c){var d=o==="normal",tt=d?s:s.ensureState(o);tt.ignore=a;var nt=c.get("smooth");nt&&nt===!0&&(nt=.3),tt.shape=tt.shape||{},nt>0&&(tt.shape.smooth=nt);var it=c.getModel("lineStyle").getLineStyle();d?s.useStyle(it):tt.style=it}function buildLabelLinePath(s,a){var o=a.smooth,c=a.points;if(c)if(s.moveTo(c[0][0],c[0][1]),o>0&&c.length>=3){var d=dist$1(c[0],c[1]),tt=dist$1(c[1],c[2]);if(!d||!tt){s.lineTo(c[1][0],c[1][1]),s.lineTo(c[2][0],c[2][1]);return}var nt=Math.min(d,tt)*o,it=lerp$1([],c[1],c[0],nt/d),st=lerp$1([],c[1],c[2],nt/tt),ut=lerp$1([],it,st,.5);s.bezierCurveTo(it[0],it[1],it[0],it[1],ut[0],ut[1]),s.bezierCurveTo(st[0],st[1],st[0],st[1],c[2][0],c[2][1])}else for(var ct=1;ct<c.length;ct++)s.lineTo(c[ct][0],c[ct][1])}function setLabelLineStyle(s,a,o){var c=s.getTextGuideLine(),d=s.getTextContent();if(!d){c&&s.removeTextGuideLine();return}for(var tt=a.normal,nt=tt.get("show"),it=d.ignore,st=0;st<DISPLAY_STATES.length;st++){var ut=DISPLAY_STATES[st],ct=a[ut],ot=ut==="normal";if(ct){var at=ct.get("show"),ht=ot?it:retrieve2(d.states[ut]&&d.states[ut].ignore,it);if(ht||!retrieve2(at,nt)){var ft=ot?c:c&&c.states[ut];ft&&(ft.ignore=!0),c&&setLabelLineState(c,!0,ut,ct);continue}c||(c=new Polyline$1,s.setTextGuideLine(c),!ot&&(it||!nt)&&setLabelLineState(c,!0,"normal",a.normal),s.stateProxy&&(c.stateProxy=s.stateProxy)),setLabelLineState(c,!1,ut,ct)}}if(c){defaults(c.style,o),c.style.fill=null;var mt=tt.get("showAbove"),yt=s.textGuideLineConfig=s.textGuideLineConfig||{};yt.showAbove=mt||!1,c.buildPath=buildLabelLinePath}}function getLabelLineStatesModels(s,a){a=a||"labelLine";for(var o={normal:s.getModel(a)},c=0;c<SPECIAL_STATES.length;c++){var d=SPECIAL_STATES[c];o[d]=s.getModel([d,a])}return o}function prepareLayoutList(s){for(var a=[],o=0;o<s.length;o++){var c=s[o];if(!c.defaultAttr.ignore){var d=c.label,tt=d.getComputedTransform(),nt=d.getBoundingRect(),it=!tt||tt[1]<1e-5&&tt[2]<1e-5,st=d.style.margin||0,ut=nt.clone();ut.applyTransform(tt),ut.x-=st/2,ut.y-=st/2,ut.width+=st,ut.height+=st;var ct=it?new OrientedBoundingRect(nt,tt):null;a.push({label:d,labelLine:c.labelLine,rect:ut,localRect:nt,obb:ct,priority:c.priority,defaultAttr:c.defaultAttr,layoutOption:c.computedLayoutOption,axisAligned:it,transform:tt})}}return a}function shiftLayout(s,a,o,c,d,tt){var nt=s.length;if(nt<2)return;s.sort(function(Ot,$t){return Ot.rect[a]-$t.rect[a]});for(var it=0,st,ut=!1,ct=0;ct<nt;ct++){var ot=s[ct],at=ot.rect;st=at[a]-it,st<0&&(at[a]-=st,ot.label[a]-=st,ut=!0),it=at[a]+at[o]}var ht=s[0],ft=s[nt-1],mt,yt;bt(),mt<0&&Ct(-mt,.8),yt<0&&Ct(yt,.8),bt(),wt(mt,yt,1),wt(yt,mt,-1),bt(),mt<0&&Dt(-mt),yt<0&&Dt(yt);function bt(){mt=ht.rect[a]-c,yt=d-ft.rect[a]-ft.rect[o]}function wt(Ot,$t,Ft){if(Ot<0){var kt=Math.min($t,-Ot);if(kt>0){Tt(kt*Ft,0,nt);var Vt=kt+Ot;Vt<0&&Ct(-Vt*Ft,1)}else Ct(-Ot*Ft,1)}}function Tt(Ot,$t,Ft){Ot!==0&&(ut=!0);for(var kt=$t;kt<Ft;kt++){var Vt=s[kt],Ht=Vt.rect;Ht[a]+=Ot,Vt.label[a]+=Ot}}function Ct(Ot,$t){for(var Ft=[],kt=0,Vt=1;Vt<nt;Vt++){var Ht=s[Vt-1].rect,Qt=Math.max(s[Vt].rect[a]-Ht[a]-Ht[o],0);Ft.push(Qt),kt+=Qt}if(kt){var Xt=Math.min(Math.abs(Ot)/kt,$t);if(Ot>0)for(var Vt=0;Vt<nt-1;Vt++){var Zt=Ft[Vt]*Xt;Tt(Zt,0,Vt+1)}else for(var Vt=nt-1;Vt>0;Vt--){var Zt=Ft[Vt-1]*Xt;Tt(-Zt,Vt,nt)}}}function Dt(Ot){var $t=Ot<0?-1:1;Ot=Math.abs(Ot);for(var Ft=Math.ceil(Ot/(nt-1)),kt=0;kt<nt-1;kt++)if($t>0?Tt(Ft,0,kt+1):Tt(-Ft,nt-kt-1,nt),Ot-=Ft,Ot<=0)return}return ut}function shiftLayoutOnX(s,a,o,c){return shiftLayout(s,"x","width",a,o)}function shiftLayoutOnY(s,a,o,c){return shiftLayout(s,"y","height",a,o)}function hideOverlap(s){var a=[];s.sort(function(mt,yt){return yt.priority-mt.priority});var o=new BoundingRect(0,0,0,0);function c(mt){if(!mt.ignore){var yt=mt.ensureState("emphasis");yt.ignore==null&&(yt.ignore=!1)}mt.ignore=!0}for(var d=0;d<s.length;d++){var tt=s[d],nt=tt.axisAligned,it=tt.localRect,st=tt.transform,ut=tt.label,ct=tt.labelLine;o.copy(tt.rect),o.width-=.1,o.height-=.1,o.x+=.05,o.y+=.05;for(var ot=tt.obb,at=!1,ht=0;ht<a.length;ht++){var ft=a[ht];if(o.intersect(ft.rect)){if(nt&&ft.axisAligned){at=!0;break}if(ft.obb||(ft.obb=new OrientedBoundingRect(ft.localRect,ft.transform)),ot||(ot=new OrientedBoundingRect(it,st)),ot.intersect(ft.obb)){at=!0;break}}}at?(c(ut),ct&&c(ct)):(ut.attr("ignore",tt.defaultAttr.ignore),ct&&ct.attr("ignore",tt.defaultAttr.labelGuideIgnore),a.push(tt))}}function cloneArr(s){if(s){for(var a=[],o=0;o<s.length;o++)a.push(s[o].slice());return a}}function prepareLayoutCallbackParams(s,a){var o=s.label,c=a&&a.getTextGuideLine();return{dataIndex:s.dataIndex,dataType:s.dataType,seriesIndex:s.seriesModel.seriesIndex,text:s.label.style.text,rect:s.hostRect,labelRect:s.rect,align:o.style.align,verticalAlign:o.style.verticalAlign,labelLinePoints:cloneArr(c&&c.shape.points)}}var LABEL_OPTION_TO_STYLE_KEYS=["align","verticalAlign","width","height","fontSize"],dummyTransformable=new Transformable,labelLayoutInnerStore=makeInner(),labelLineAnimationStore=makeInner();function extendWithKeys(s,a,o){for(var c=0;c<o.length;c++){var d=o[c];a[d]!=null&&(s[d]=a[d])}}var LABEL_LAYOUT_PROPS=["x","y","rotation"],LabelManager=function(){function s(){this._labelList=[],this._chartViewList=[]}return s.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},s.prototype._addLabel=function(a,o,c,d,tt){var nt=d.style,it=d.__hostTarget,st=it.textConfig||{},ut=d.getComputedTransform(),ct=d.getBoundingRect().plain();BoundingRect.applyTransform(ct,ct,ut),ut?dummyTransformable.setLocalTransform(ut):(dummyTransformable.x=dummyTransformable.y=dummyTransformable.rotation=dummyTransformable.originX=dummyTransformable.originY=0,dummyTransformable.scaleX=dummyTransformable.scaleY=1),dummyTransformable.rotation=normalizeRadian(dummyTransformable.rotation);var ot=d.__hostTarget,at;if(ot){at=ot.getBoundingRect().plain();var ht=ot.getComputedTransform();BoundingRect.applyTransform(at,at,ht)}var ft=at&&ot.getTextGuideLine();this._labelList.push({label:d,labelLine:ft,seriesModel:c,dataIndex:a,dataType:o,layoutOption:tt,computedLayoutOption:null,rect:ct,hostRect:at,priority:at?at.width*at.height:0,defaultAttr:{ignore:d.ignore,labelGuideIgnore:ft&&ft.ignore,x:dummyTransformable.x,y:dummyTransformable.y,scaleX:dummyTransformable.scaleX,scaleY:dummyTransformable.scaleY,rotation:dummyTransformable.rotation,style:{x:nt.x,y:nt.y,align:nt.align,verticalAlign:nt.verticalAlign,width:nt.width,height:nt.height,fontSize:nt.fontSize},cursor:d.cursor,attachedPos:st.position,attachedRot:st.rotation}})},s.prototype.addLabelsOfSeries=function(a){var o=this;this._chartViewList.push(a);var c=a.__model,d=c.get("labelLayout");(isFunction$1(d)||keys(d).length)&&a.group.traverse(function(tt){if(tt.ignore)return!0;var nt=tt.getTextContent(),it=getECData(tt);nt&&!nt.disableLabelLayout&&o._addLabel(it.dataIndex,it.dataType,c,nt,d)})},s.prototype.updateLayoutConfig=function(a){var o=a.getWidth(),c=a.getHeight();function d(Tt,Ct){return function(){updateLabelLinePoints(Tt,Ct)}}for(var tt=0;tt<this._labelList.length;tt++){var nt=this._labelList[tt],it=nt.label,st=it.__hostTarget,ut=nt.defaultAttr,ct=void 0;isFunction$1(nt.layoutOption)?ct=nt.layoutOption(prepareLayoutCallbackParams(nt,st)):ct=nt.layoutOption,ct=ct||{},nt.computedLayoutOption=ct;var ot=Math.PI/180;st&&st.setTextConfig({local:!1,position:ct.x!=null||ct.y!=null?null:ut.attachedPos,rotation:ct.rotate!=null?ct.rotate*ot:ut.attachedRot,offset:[ct.dx||0,ct.dy||0]});var at=!1;if(ct.x!=null?(it.x=parsePercent(ct.x,o),it.setStyle("x",0),at=!0):(it.x=ut.x,it.setStyle("x",ut.style.x)),ct.y!=null?(it.y=parsePercent(ct.y,c),it.setStyle("y",0),at=!0):(it.y=ut.y,it.setStyle("y",ut.style.y)),ct.labelLinePoints){var ht=st.getTextGuideLine();ht&&(ht.setShape({points:ct.labelLinePoints}),at=!1)}var ft=labelLayoutInnerStore(it);ft.needsUpdateLabelLine=at,it.rotation=ct.rotate!=null?ct.rotate*ot:ut.rotation,it.scaleX=ut.scaleX,it.scaleY=ut.scaleY;for(var mt=0;mt<LABEL_OPTION_TO_STYLE_KEYS.length;mt++){var yt=LABEL_OPTION_TO_STYLE_KEYS[mt];it.setStyle(yt,ct[yt]!=null?ct[yt]:ut.style[yt])}if(ct.draggable){if(it.draggable=!0,it.cursor="move",st){var bt=nt.seriesModel;if(nt.dataIndex!=null){var wt=nt.seriesModel.getData(nt.dataType);bt=wt.getItemModel(nt.dataIndex)}it.on("drag",d(st,bt.getModel("labelLine")))}}else it.off("drag"),it.cursor=ut.cursor}},s.prototype.layout=function(a){var o=a.getWidth(),c=a.getHeight(),d=prepareLayoutList(this._labelList),tt=filter(d,function(st){return st.layoutOption.moveOverlap==="shiftX"}),nt=filter(d,function(st){return st.layoutOption.moveOverlap==="shiftY"});shiftLayoutOnX(tt,0,o),shiftLayoutOnY(nt,0,c);var it=filter(d,function(st){return st.layoutOption.hideOverlap});hideOverlap(it)},s.prototype.processLabelsOverall=function(){var a=this;each$f(this._chartViewList,function(o){var c=o.__model,d=o.ignoreLabelLineUpdate,tt=c.isAnimationEnabled();o.group.traverse(function(nt){if(nt.ignore&&!nt.forceLabelAnimation)return!0;var it=!d,st=nt.getTextContent();!it&&st&&(it=labelLayoutInnerStore(st).needsUpdateLabelLine),it&&a._updateLabelLine(nt,c),tt&&a._animateLabels(nt,c)})})},s.prototype._updateLabelLine=function(a,o){var c=a.getTextContent(),d=getECData(a),tt=d.dataIndex;if(c&&tt!=null){var nt=o.getData(d.dataType),it=nt.getItemModel(tt),st={},ut=nt.getItemVisual(tt,"style");if(ut){var ct=nt.getVisual("drawType");st.stroke=ut[ct]}var ot=it.getModel("labelLine");setLabelLineStyle(a,getLabelLineStatesModels(it),st),updateLabelLinePoints(a,ot)}},s.prototype._animateLabels=function(a,o){var c=a.getTextContent(),d=a.getTextGuideLine();if(c&&(a.forceLabelAnimation||!c.ignore&&!c.invisible&&!a.disableLabelAnimation&&!isElementRemoved(a))){var tt=labelLayoutInnerStore(c),nt=tt.oldLayout,it=getECData(a),st=it.dataIndex,ut={x:c.x,y:c.y,rotation:c.rotation},ct=o.getData(it.dataType);if(nt){c.attr(nt);var at=a.prevStates;at&&(indexOf(at,"select")>=0&&c.attr(tt.oldLayoutSelect),indexOf(at,"emphasis")>=0&&c.attr(tt.oldLayoutEmphasis)),updateProps$1(c,ut,o,st)}else if(c.attr(ut),!labelInner(c).valueAnimation){var ot=retrieve2(c.style.opacity,1);c.style.opacity=0,initProps(c,{style:{opacity:ot}},o,st)}if(tt.oldLayout=ut,c.states.select){var ht=tt.oldLayoutSelect={};extendWithKeys(ht,ut,LABEL_LAYOUT_PROPS),extendWithKeys(ht,c.states.select,LABEL_LAYOUT_PROPS)}if(c.states.emphasis){var ft=tt.oldLayoutEmphasis={};extendWithKeys(ft,ut,LABEL_LAYOUT_PROPS),extendWithKeys(ft,c.states.emphasis,LABEL_LAYOUT_PROPS)}animateLabelValue(c,st,ct,o,o)}if(d&&!d.ignore&&!d.invisible){var tt=labelLineAnimationStore(d),nt=tt.oldLayout,mt={points:d.shape.points};nt?(d.attr({shape:nt}),updateProps$1(d,{shape:mt},o)):(d.setShape(mt),d.style.strokePercent=0,initProps(d,{style:{strokePercent:1}},o)),tt.oldLayout=mt}},s}(),getLabelManager=makeInner();function installLabelLayout(s){s.registerUpdateLifecycle("series:beforeupdate",function(a,o,c){var d=getLabelManager(o).labelManager;d||(d=getLabelManager(o).labelManager=new LabelManager),d.clearLabels()}),s.registerUpdateLifecycle("series:layoutlabels",function(a,o,c){var d=getLabelManager(o).labelManager;c.updatedSeries.forEach(function(tt){d.addLabelsOfSeries(o.getViewOfSeriesModel(tt))}),d.updateLayoutConfig(o),d.layout(o),d.processLabelsOverall()})}var mathSin=Math.sin,mathCos=Math.cos,PI$4=Math.PI,PI2$1=Math.PI*2,degree=180/PI$4,SVGPathRebuilder=function(){function s(){}return s.prototype.reset=function(a){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,a||4)},s.prototype.moveTo=function(a,o){this._add("M",a,o)},s.prototype.lineTo=function(a,o){this._add("L",a,o)},s.prototype.bezierCurveTo=function(a,o,c,d,tt,nt){this._add("C",a,o,c,d,tt,nt)},s.prototype.quadraticCurveTo=function(a,o,c,d){this._add("Q",a,o,c,d)},s.prototype.arc=function(a,o,c,d,tt,nt){this.ellipse(a,o,c,c,0,d,tt,nt)},s.prototype.ellipse=function(a,o,c,d,tt,nt,it,st){var ut=it-nt,ct=!st,ot=Math.abs(ut),at=isAroundZero(ot-PI2$1)||(ct?ut>=PI2$1:-ut>=PI2$1),ht=ut>0?ut%PI2$1:ut%PI2$1+PI2$1,ft=!1;at?ft=!0:isAroundZero(ot)?ft=!1:ft=ht>=PI$4==!!ct;var mt=a+c*mathCos(nt),yt=o+d*mathSin(nt);this._start&&this._add("M",mt,yt);var bt=Math.round(tt*degree);if(at){var wt=1/this._p,Tt=(ct?1:-1)*(PI2$1-wt);this._add("A",c,d,bt,1,+ct,a+c*mathCos(nt+Tt),o+d*mathSin(nt+Tt)),wt>.01&&this._add("A",c,d,bt,0,+ct,mt,yt)}else{var Ct=a+c*mathCos(it),Dt=o+d*mathSin(it);this._add("A",c,d,bt,+ft,+ct,Ct,Dt)}},s.prototype.rect=function(a,o,c,d){this._add("M",a,o),this._add("l",c,0),this._add("l",0,d),this._add("l",-c,0),this._add("Z")},s.prototype.closePath=function(){this._d.length>0&&this._add("Z")},s.prototype._add=function(a,o,c,d,tt,nt,it,st,ut){for(var ct=[],ot=this._p,at=1;at<arguments.length;at++){var ht=arguments[at];if(isNaN(ht)){this._invalid=!0;return}ct.push(Math.round(ht*ot)/ot)}this._d.push(a+ct.join(" ")),this._start=a==="Z"},s.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},s.prototype.getStr=function(){return this._str},s}(),NONE="none",mathRound=Math.round;function pathHasFill(s){var a=s.fill;return a!=null&&a!==NONE}function pathHasStroke(s){var a=s.stroke;return a!=null&&a!==NONE}var strokeProps=["lineCap","miterLimit","lineJoin"],svgStrokeProps=map$1(strokeProps,function(s){return"stroke-"+s.toLowerCase()});function mapStyleToAttrs(s,a,o,c){var d=a.opacity==null?1:a.opacity;if(o instanceof ZRImage){s("opacity",d);return}if(pathHasFill(a)){var tt=normalizeColor(a.fill);s("fill",tt.color);var nt=a.fillOpacity!=null?a.fillOpacity*tt.opacity*d:tt.opacity*d;nt<1&&s("fill-opacity",nt)}else s("fill",NONE);if(pathHasStroke(a)){var it=normalizeColor(a.stroke);s("stroke",it.color);var st=a.strokeNoScale?o.getLineScale():1,ut=st?(a.lineWidth||0)/st:0,ct=a.strokeOpacity!=null?a.strokeOpacity*it.opacity*d:it.opacity*d,ot=a.strokeFirst;if(ut!==1&&s("stroke-width",ut),ot&&s("paint-order",ot?"stroke":"fill"),ct<1&&s("stroke-opacity",ct),a.lineDash){var at=getLineDash(o),ht=at[0],ft=at[1];ht&&(ft=mathRound(ft||0),s("stroke-dasharray",ht.join(",")),(ft||c)&&s("stroke-dashoffset",ft))}for(var mt=0;mt<strokeProps.length;mt++){var yt=strokeProps[mt];if(a[yt]!==DEFAULT_PATH_STYLE[yt]){var bt=a[yt]||DEFAULT_PATH_STYLE[yt];bt&&s(svgStrokeProps[mt],bt)}}}}var SVGNS="http://www.w3.org/2000/svg",XLINKNS="http://www.w3.org/1999/xlink",XMLNS="http://www.w3.org/2000/xmlns/",XML_NAMESPACE="http://www.w3.org/XML/1998/namespace",META_DATA_PREFIX="ecmeta_";function createElement(s){return document.createElementNS(SVGNS,s)}function createVNode(s,a,o,c,d){return{tag:s,attrs:o||{},children:c,text:d,key:a}}function createElementOpen(s,a){var o=[];if(a)for(var c in a){var d=a[c],tt=c;d!==!1&&(d!==!0&&d!=null&&(tt+='="'+d+'"'),o.push(tt))}return"<"+s+" "+o.join(" ")+">"}function createElementClose(s){return"</"+s+">"}function vNodeToString(s,a){a=a||{};var o=a.newline?`
`:"";function c(d){var tt=d.children,nt=d.tag,it=d.attrs,st=d.text;return createElementOpen(nt,it)+(nt!=="style"?encodeHTML(st):st||"")+(tt?""+o+map$1(tt,function(ut){return c(ut)}).join(o)+o:"")+createElementClose(nt)}return c(s)}function getCssString(s,a,o){o=o||{};var c=o.newline?`
`:"",d=" {"+c,tt=c+"}",nt=map$1(keys(s),function(st){return st+d+map$1(keys(s[st]),function(ut){return ut+":"+s[st][ut]+";"}).join(c)+tt}).join(c),it=map$1(keys(a),function(st){return"@keyframes "+st+d+map$1(keys(a[st]),function(ut){return ut+d+map$1(keys(a[st][ut]),function(ct){var ot=a[st][ut][ct];return ct==="d"&&(ot='path("'+ot+'")'),ct+":"+ot+";"}).join(c)+tt}).join(c)+tt}).join(c);return!nt&&!it?"":["<![CDATA[",nt,it,"]]>"].join(c)}function createBrushScope(s){return{zrId:s,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function createSVGVNode(s,a,o,c){return createVNode("svg","root",{width:s,height:a,xmlns:SVGNS,"xmlns:xlink":XLINKNS,version:"1.1",baseProfile:"full",viewBox:c?"0 0 "+s+" "+a:!1},o)}var cssClassIdx=0;function getClassId(){return cssClassIdx++}var EASING_MAP={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},transformOriginKey="transform-origin";function buildPathString(s,a,o){var c=extend({},s.shape);extend(c,a),s.buildPath(o,c);var d=new SVGPathRebuilder;return d.reset(getPathPrecision(s)),o.rebuildPath(d,1),d.generateStr(),d.getStr()}function setTransformOrigin(s,a){var o=a.originX,c=a.originY;(o||c)&&(s[transformOriginKey]=o+"px "+c+"px")}var ANIMATE_STYLE_MAP={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function addAnimation(s,a){var o=a.zrId+"-ani-"+a.cssAnimIdx++;return a.cssAnims[o]=s,o}function createCompoundPathCSSAnimation(s,a,o){var c=s.shape.paths,d={},tt,nt;if(each$f(c,function(st){var ut=createBrushScope(o.zrId);ut.animation=!0,createCSSAnimation(st,{},ut,!0);var ct=ut.cssAnims,ot=ut.cssNodes,at=keys(ct),ht=at.length;if(ht){nt=at[ht-1];var ft=ct[nt];for(var mt in ft){var yt=ft[mt];d[mt]=d[mt]||{d:""},d[mt].d+=yt.d||""}for(var bt in ot){var wt=ot[bt].animation;wt.indexOf(nt)>=0&&(tt=wt)}}}),!!tt){a.d=!1;var it=addAnimation(d,o);return tt.replace(nt,it)}}function getEasingFunc(s){return isString$1(s)?EASING_MAP[s]?"cubic-bezier("+EASING_MAP[s]+")":createCubicEasingFunc(s)?s:"":""}function createCSSAnimation(s,a,o,c){var d=s.animators,tt=d.length,nt=[];if(s instanceof CompoundPath){var it=createCompoundPathCSSAnimation(s,a,o);if(it)nt.push(it);else if(!tt)return}else if(!tt)return;for(var st={},ut=0;ut<tt;ut++){var ct=d[ut],ot=[ct.getMaxTime()/1e3+"s"],at=getEasingFunc(ct.getClip().easing),ht=ct.getDelay();at?ot.push(at):ot.push("linear"),ht&&ot.push(ht/1e3+"s"),ct.getLoop()&&ot.push("infinite");var ft=ot.join(" ");st[ft]=st[ft]||[ft,[]],st[ft][1].push(ct)}function mt(wt){var Tt=wt[1],Ct=Tt.length,Dt={},Ot={},$t={},Ft="animation-timing-function";function kt(hn,pn,yn){for(var un=hn.getTracks(),fn=hn.getMaxTime(),Bn=0;Bn<un.length;Bn++){var Dn=un[Bn];if(Dn.needsAnimate()){var Qn=Dn.keyframes,zr=Dn.propName;if(yn&&(zr=yn(zr)),zr)for(var ao=0;ao<Qn.length;ao++){var oo=Qn[ao],Wn=Math.round(oo.time/fn*100)+"%",no=getEasingFunc(oo.easing),Eo=oo.rawValue;(isString$1(Eo)||isNumber(Eo))&&(pn[Wn]=pn[Wn]||{},pn[Wn][zr]=oo.rawValue,no&&(pn[Wn][Ft]=no))}}}}for(var Vt=0;Vt<Ct;Vt++){var Ht=Tt[Vt],Qt=Ht.targetName;Qt?Qt==="shape"&&kt(Ht,Ot):!c&&kt(Ht,Dt)}for(var Xt in Dt){var Zt={};copyTransform(Zt,s),extend(Zt,Dt[Xt]);var ar=getSRTTransformString(Zt),nr=Dt[Xt][Ft];$t[Xt]=ar?{transform:ar}:{},setTransformOrigin($t[Xt],Zt),nr&&($t[Xt][Ft]=nr)}var cr,dr=!0;for(var Xt in Ot){$t[Xt]=$t[Xt]||{};var mr=!cr,nr=Ot[Xt][Ft];mr&&(cr=new PathProxy);var Dr=cr.len();cr.reset(),$t[Xt].d=buildPathString(s,Ot[Xt],cr);var kr=cr.len();if(!mr&&Dr!==kr){dr=!1;break}nr&&($t[Xt][Ft]=nr)}if(!dr)for(var Xt in $t)delete $t[Xt].d;if(!c)for(var Vt=0;Vt<Ct;Vt++){var Ht=Tt[Vt],Qt=Ht.targetName;Qt==="style"&&kt(Ht,$t,function(un){return ANIMATE_STYLE_MAP[un]})}for(var Yr=keys($t),Mr=!0,Jr,Vt=1;Vt<Yr.length;Vt++){var an=Yr[Vt-1],xn=Yr[Vt];if($t[an][transformOriginKey]!==$t[xn][transformOriginKey]){Mr=!1;break}Jr=$t[an][transformOriginKey]}if(Mr&&Jr){for(var Xt in $t)$t[Xt][transformOriginKey]&&delete $t[Xt][transformOriginKey];a[transformOriginKey]=Jr}if(filter(Yr,function(hn){return keys($t[hn]).length>0}).length){var Rn=addAnimation($t,o);return Rn+" "+wt[0]+" both"}}for(var yt in st){var it=mt(st[yt]);it&&nt.push(it)}if(nt.length){var bt=o.zrId+"-cls-"+getClassId();o.cssNodes["."+bt]={animation:nt.join(",")},a.class=bt}}function createCSSEmphasis(s,a,o){if(!s.ignore)if(s.isSilent()){var c={"pointer-events":"none"};setClassAttribute(c,a,o)}else{var d=s.states.emphasis&&s.states.emphasis.style?s.states.emphasis.style:{},tt=d.fill;if(!tt){var nt=s.style&&s.style.fill,it=s.states.select&&s.states.select.style&&s.states.select.style.fill,st=s.currentStates.indexOf("select")>=0&&it||nt;st&&(tt=liftColor(st))}var ut=d.lineWidth;if(ut){var ct=!d.strokeNoScale&&s.transform?s.transform[0]:1;ut=ut/ct}var c={cursor:"pointer"};tt&&(c.fill=tt),d.stroke&&(c.stroke=d.stroke),ut&&(c["stroke-width"]=ut),setClassAttribute(c,a,o)}}function setClassAttribute(s,a,o,c){var d=JSON.stringify(s),tt=o.cssStyleCache[d];tt||(tt=o.zrId+"-cls-"+getClassId(),o.cssStyleCache[d]=tt,o.cssNodes["."+tt+":hover"]=s),a.class=a.class?a.class+" "+tt:tt}var round$1=Math.round;function isImageLike(s){return s&&isString$1(s.src)}function isCanvasLike(s){return s&&isFunction$1(s.toDataURL)}function setStyleAttrs(s,a,o,c){mapStyleToAttrs(function(d,tt){var nt=d==="fill"||d==="stroke";nt&&isGradient(tt)?setGradient(a,s,d,c):nt&&isPattern(tt)?setPattern(o,s,d,c):s[d]=tt,nt&&c.ssr&&tt==="none"&&(s["pointer-events"]="visible")},a,o,!1),setShadow(o,s,c)}function setMetaData(s,a){var o=getElementSSRData(a);o&&(o.each(function(c,d){c!=null&&(s[(META_DATA_PREFIX+d).toLowerCase()]=c+"")}),a.isSilent()&&(s[META_DATA_PREFIX+"silent"]="true"))}function noRotateScale(s){return isAroundZero(s[0]-1)&&isAroundZero(s[1])&&isAroundZero(s[2])&&isAroundZero(s[3]-1)}function noTranslate(s){return isAroundZero(s[4])&&isAroundZero(s[5])}function setTransform(s,a,o){if(a&&!(noTranslate(a)&&noRotateScale(a))){var c=1e4;s.transform=noRotateScale(a)?"translate("+round$1(a[4]*c)/c+" "+round$1(a[5]*c)/c+")":getMatrixStr(a)}}function convertPolyShape(s,a,o){for(var c=s.points,d=[],tt=0;tt<c.length;tt++)d.push(round$1(c[tt][0]*o)/o),d.push(round$1(c[tt][1]*o)/o);a.points=d.join(" ")}function validatePolyShape(s){return!s.smooth}function createAttrsConvert(s){var a=map$1(s,function(o){return typeof o=="string"?[o,o]:o});return function(o,c,d){for(var tt=0;tt<a.length;tt++){var nt=a[tt],it=o[nt[0]];it!=null&&(c[nt[1]]=round$1(it*d)/d)}}}var builtinShapesDef={circle:[createAttrsConvert(["cx","cy","r"])],polyline:[convertPolyShape,validatePolyShape],polygon:[convertPolyShape,validatePolyShape]};function hasShapeAnimation(s){for(var a=s.animators,o=0;o<a.length;o++)if(a[o].targetName==="shape")return!0;return!1}function brushSVGPath(s,a){var o=s.style,c=s.shape,d=builtinShapesDef[s.type],tt={},nt=a.animation,it="path",st=s.style.strokePercent,ut=a.compress&&getPathPrecision(s)||4;if(d&&!a.willUpdate&&!(d[1]&&!d[1](c))&&!(nt&&hasShapeAnimation(s))&&!(st<1)){it=s.type;var ct=Math.pow(10,ut);d[0](c,tt,ct)}else{var ot=!s.path||s.shapeChanged();s.path||s.createPathProxy();var at=s.path;ot&&(at.beginPath(),s.buildPath(at,s.shape),s.pathUpdated());var ht=at.getVersion(),ft=s,mt=ft.__svgPathBuilder;(ft.__svgPathVersion!==ht||!mt||st!==ft.__svgPathStrokePercent)&&(mt||(mt=ft.__svgPathBuilder=new SVGPathRebuilder),mt.reset(ut),at.rebuildPath(mt,st),mt.generateStr(),ft.__svgPathVersion=ht,ft.__svgPathStrokePercent=st),tt.d=mt.getStr()}return setTransform(tt,s.transform),setStyleAttrs(tt,o,s,a),setMetaData(tt,s),a.animation&&createCSSAnimation(s,tt,a),a.emphasis&&createCSSEmphasis(s,tt,a),createVNode(it,s.id+"",tt)}function brushSVGImage(s,a){var o=s.style,c=o.image;if(c&&!isString$1(c)&&(isImageLike(c)?c=c.src:isCanvasLike(c)&&(c=c.toDataURL())),!!c){var d=o.x||0,tt=o.y||0,nt=o.width,it=o.height,st={href:c,width:nt,height:it};return d&&(st.x=d),tt&&(st.y=tt),setTransform(st,s.transform),setStyleAttrs(st,o,s,a),setMetaData(st,s),a.animation&&createCSSAnimation(s,st,a),createVNode("image",s.id+"",st)}}function brushSVGTSpan(s,a){var o=s.style,c=o.text;if(c!=null&&(c+=""),!(!c||isNaN(o.x)||isNaN(o.y))){var d=o.font||DEFAULT_FONT,tt=o.x||0,nt=adjustTextY$1(o.y||0,getLineHeight(d),o.textBaseline),it=TEXT_ALIGN_TO_ANCHOR[o.textAlign]||o.textAlign,st={"dominant-baseline":"central","text-anchor":it};if(hasSeparateFont(o)){var ut="",ct=o.fontStyle,ot=parseFontSize(o.fontSize);if(!parseFloat(ot))return;var at=o.fontFamily||DEFAULT_FONT_FAMILY,ht=o.fontWeight;ut+="font-size:"+ot+";font-family:"+at+";",ct&&ct!=="normal"&&(ut+="font-style:"+ct+";"),ht&&ht!=="normal"&&(ut+="font-weight:"+ht+";"),st.style=ut}else st.style="font: "+d;return c.match(/\s/)&&(st["xml:space"]="preserve"),tt&&(st.x=tt),nt&&(st.y=nt),setTransform(st,s.transform),setStyleAttrs(st,o,s,a),setMetaData(st,s),a.animation&&createCSSAnimation(s,st,a),createVNode("text",s.id+"",st,void 0,c)}}function brush(s,a){if(s instanceof Path)return brushSVGPath(s,a);if(s instanceof ZRImage)return brushSVGImage(s,a);if(s instanceof TSpan)return brushSVGTSpan(s,a)}function setShadow(s,a,o){var c=s.style;if(hasShadow(c)){var d=getShadowKey(s),tt=o.shadowCache,nt=tt[d];if(!nt){var it=s.getGlobalScale(),st=it[0],ut=it[1];if(!st||!ut)return;var ct=c.shadowOffsetX||0,ot=c.shadowOffsetY||0,at=c.shadowBlur,ht=normalizeColor(c.shadowColor),ft=ht.opacity,mt=ht.color,yt=at/2/st,bt=at/2/ut,wt=yt+" "+bt;nt=o.zrId+"-s"+o.shadowIdx++,o.defs[nt]=createVNode("filter",nt,{id:nt,x:"-100%",y:"-100%",width:"300%",height:"300%"},[createVNode("feDropShadow","",{dx:ct/st,dy:ot/ut,stdDeviation:wt,"flood-color":mt,"flood-opacity":ft})]),tt[d]=nt}a.filter=getIdURL(nt)}}function setGradient(s,a,o,c){var d=s[o],tt,nt={gradientUnits:d.global?"userSpaceOnUse":"objectBoundingBox"};if(isLinearGradient(d))tt="linearGradient",nt.x1=d.x,nt.y1=d.y,nt.x2=d.x2,nt.y2=d.y2;else if(isRadialGradient(d))tt="radialGradient",nt.cx=retrieve2(d.x,.5),nt.cy=retrieve2(d.y,.5),nt.r=retrieve2(d.r,.5);else return;for(var it=d.colorStops,st=[],ut=0,ct=it.length;ut<ct;++ut){var ot=round4(it[ut].offset)*100+"%",at=it[ut].color,ht=normalizeColor(at),ft=ht.color,mt=ht.opacity,yt={offset:ot};yt["stop-color"]=ft,mt<1&&(yt["stop-opacity"]=mt),st.push(createVNode("stop",ut+"",yt))}var bt=createVNode(tt,"",nt,st),wt=vNodeToString(bt),Tt=c.gradientCache,Ct=Tt[wt];Ct||(Ct=c.zrId+"-g"+c.gradientIdx++,Tt[wt]=Ct,nt.id=Ct,c.defs[Ct]=createVNode(tt,Ct,nt,st)),a[o]=getIdURL(Ct)}function setPattern(s,a,o,c){var d=s.style[o],tt=s.getBoundingRect(),nt={},it=d.repeat,st=it==="no-repeat",ut=it==="repeat-x",ct=it==="repeat-y",ot;if(isImagePattern(d)){var at=d.imageWidth,ht=d.imageHeight,ft=void 0,mt=d.image;if(isString$1(mt)?ft=mt:isImageLike(mt)?ft=mt.src:isCanvasLike(mt)&&(ft=mt.toDataURL()),typeof Image>"u"){var yt="Image width/height must been given explictly in svg-ssr renderer.";assert(at,yt),assert(ht,yt)}else if(at==null||ht==null){var bt=function(Vt,Ht){if(Vt){var Qt=Vt.elm,Xt=at||Ht.width,Zt=ht||Ht.height;Vt.tag==="pattern"&&(ut?(Zt=1,Xt/=tt.width):ct&&(Xt=1,Zt/=tt.height)),Vt.attrs.width=Xt,Vt.attrs.height=Zt,Qt&&(Qt.setAttribute("width",Xt),Qt.setAttribute("height",Zt))}},wt=createOrUpdateImage(ft,null,s,function(Vt){st||bt(Ot,Vt),bt(ot,Vt)});wt&&wt.width&&wt.height&&(at=at||wt.width,ht=ht||wt.height)}ot=createVNode("image","img",{href:ft,width:at,height:ht}),nt.width=at,nt.height=ht}else d.svgElement&&(ot=clone$4(d.svgElement),nt.width=d.svgWidth,nt.height=d.svgHeight);if(ot){var Tt,Ct;st?Tt=Ct=1:ut?(Ct=1,Tt=nt.width/tt.width):ct?(Tt=1,Ct=nt.height/tt.height):nt.patternUnits="userSpaceOnUse",Tt!=null&&!isNaN(Tt)&&(nt.width=Tt),Ct!=null&&!isNaN(Ct)&&(nt.height=Ct);var Dt=getSRTTransformString(d);Dt&&(nt.patternTransform=Dt);var Ot=createVNode("pattern","",nt,[ot]),$t=vNodeToString(Ot),Ft=c.patternCache,kt=Ft[$t];kt||(kt=c.zrId+"-p"+c.patternIdx++,Ft[$t]=kt,nt.id=kt,Ot=c.defs[kt]=createVNode("pattern",kt,nt,[ot])),a[o]=getIdURL(kt)}}function setClipPath(s,a,o){var c=o.clipPathCache,d=o.defs,tt=c[s.id];if(!tt){tt=o.zrId+"-c"+o.clipPathIdx++;var nt={id:tt};c[s.id]=tt,d[tt]=createVNode("clipPath",tt,nt,[brushSVGPath(s,o)])}a["clip-path"]=getIdURL(tt)}function createTextNode(s){return document.createTextNode(s)}function insertBefore(s,a,o){s.insertBefore(a,o)}function removeChild(s,a){s.removeChild(a)}function appendChild(s,a){s.appendChild(a)}function parentNode(s){return s.parentNode}function nextSibling(s){return s.nextSibling}function setTextContent(s,a){s.textContent=a}var colonChar=58,xChar=120,emptyNode=createVNode("","");function isUndef(s){return s===void 0}function isDef(s){return s!==void 0}function createKeyToOldIdx(s,a,o){for(var c={},d=a;d<=o;++d){var tt=s[d].key;tt!==void 0&&(c[tt]=d)}return c}function sameVnode(s,a){var o=s.key===a.key,c=s.tag===a.tag;return c&&o}function createElm(s){var a,o=s.children,c=s.tag;if(isDef(c)){var d=s.elm=createElement(c);if(updateAttrs(emptyNode,s),isArray$1(o))for(a=0;a<o.length;++a){var tt=o[a];tt!=null&&appendChild(d,createElm(tt))}else isDef(s.text)&&!isObject$3(s.text)&&appendChild(d,createTextNode(s.text))}else s.elm=createTextNode(s.text);return s.elm}function addVnodes(s,a,o,c,d){for(;c<=d;++c){var tt=o[c];tt!=null&&insertBefore(s,createElm(tt),a)}}function removeVnodes(s,a,o,c){for(;o<=c;++o){var d=a[o];if(d!=null)if(isDef(d.tag)){var tt=parentNode(d.elm);removeChild(tt,d.elm)}else removeChild(s,d.elm)}}function updateAttrs(s,a){var o,c=a.elm,d=s&&s.attrs||{},tt=a.attrs||{};if(d!==tt){for(o in tt){var nt=tt[o],it=d[o];it!==nt&&(nt===!0?c.setAttribute(o,""):nt===!1?c.removeAttribute(o):o==="style"?c.style.cssText=nt:o.charCodeAt(0)!==xChar?c.setAttribute(o,nt):o==="xmlns:xlink"||o==="xmlns"?c.setAttributeNS(XMLNS,o,nt):o.charCodeAt(3)===colonChar?c.setAttributeNS(XML_NAMESPACE,o,nt):o.charCodeAt(5)===colonChar?c.setAttributeNS(XLINKNS,o,nt):c.setAttribute(o,nt))}for(o in d)o in tt||c.removeAttribute(o)}}function updateChildren(s,a,o){for(var c=0,d=0,tt=a.length-1,nt=a[0],it=a[tt],st=o.length-1,ut=o[0],ct=o[st],ot,at,ht,ft;c<=tt&&d<=st;)nt==null?nt=a[++c]:it==null?it=a[--tt]:ut==null?ut=o[++d]:ct==null?ct=o[--st]:sameVnode(nt,ut)?(patchVnode(nt,ut),nt=a[++c],ut=o[++d]):sameVnode(it,ct)?(patchVnode(it,ct),it=a[--tt],ct=o[--st]):sameVnode(nt,ct)?(patchVnode(nt,ct),insertBefore(s,nt.elm,nextSibling(it.elm)),nt=a[++c],ct=o[--st]):sameVnode(it,ut)?(patchVnode(it,ut),insertBefore(s,it.elm,nt.elm),it=a[--tt],ut=o[++d]):(isUndef(ot)&&(ot=createKeyToOldIdx(a,c,tt)),at=ot[ut.key],isUndef(at)?insertBefore(s,createElm(ut),nt.elm):(ht=a[at],ht.tag!==ut.tag?insertBefore(s,createElm(ut),nt.elm):(patchVnode(ht,ut),a[at]=void 0,insertBefore(s,ht.elm,nt.elm))),ut=o[++d]);(c<=tt||d<=st)&&(c>tt?(ft=o[st+1]==null?null:o[st+1].elm,addVnodes(s,ft,o,d,st)):removeVnodes(s,a,c,tt))}function patchVnode(s,a){var o=a.elm=s.elm,c=s.children,d=a.children;s!==a&&(updateAttrs(s,a),isUndef(a.text)?isDef(c)&&isDef(d)?c!==d&&updateChildren(o,c,d):isDef(d)?(isDef(s.text)&&setTextContent(o,""),addVnodes(o,null,d,0,d.length-1)):isDef(c)?removeVnodes(o,c,0,c.length-1):isDef(s.text)&&setTextContent(o,""):s.text!==a.text&&(isDef(c)&&removeVnodes(o,c,0,c.length-1),setTextContent(o,a.text)))}function patch(s,a){if(sameVnode(s,a))patchVnode(s,a);else{var o=s.elm,c=parentNode(o);createElm(a),c!==null&&(insertBefore(c,a.elm,nextSibling(o)),removeVnodes(c,[s],0,0))}return a}var svgId=0,SVGPainter=function(){function s(a,o,c){if(this.type="svg",this.refreshHover=createMethodNotSupport(),this.configLayer=createMethodNotSupport(),this.storage=o,this._opts=c=extend({},c),this.root=a,this._id="zr"+svgId++,this._oldVNode=createSVGVNode(c.width,c.height),a&&!c.ssr){var d=this._viewport=document.createElement("div");d.style.cssText="position:relative;overflow:hidden";var tt=this._svgDom=this._oldVNode.elm=createElement("svg");updateAttrs(null,this._oldVNode),d.appendChild(tt),a.appendChild(d)}this.resize(c.width,c.height)}return s.prototype.getType=function(){return this.type},s.prototype.getViewportRoot=function(){return this._viewport},s.prototype.getViewportRootOffset=function(){var a=this.getViewportRoot();if(a)return{offsetLeft:a.offsetLeft||0,offsetTop:a.offsetTop||0}},s.prototype.getSvgDom=function(){return this._svgDom},s.prototype.refresh=function(){if(this.root){var a=this.renderToVNode({willUpdate:!0});a.attrs.style="position:absolute;left:0;top:0;user-select:none",patch(this._oldVNode,a),this._oldVNode=a}},s.prototype.renderOneToVNode=function(a){return brush(a,createBrushScope(this._id))},s.prototype.renderToVNode=function(a){a=a||{};var o=this.storage.getDisplayList(!0),c=this._width,d=this._height,tt=createBrushScope(this._id);tt.animation=a.animation,tt.willUpdate=a.willUpdate,tt.compress=a.compress,tt.emphasis=a.emphasis,tt.ssr=this._opts.ssr;var nt=[],it=this._bgVNode=createBackgroundVNode(c,d,this._backgroundColor,tt);it&&nt.push(it);var st=a.compress?null:this._mainVNode=createVNode("g","main",{},[]);this._paintList(o,tt,st?st.children:nt),st&&nt.push(st);var ut=map$1(keys(tt.defs),function(at){return tt.defs[at]});if(ut.length&&nt.push(createVNode("defs","defs",{},ut)),a.animation){var ct=getCssString(tt.cssNodes,tt.cssAnims,{newline:!0});if(ct){var ot=createVNode("style","stl",{},[],ct);nt.push(ot)}}return createSVGVNode(c,d,nt,a.useViewBox)},s.prototype.renderToString=function(a){return a=a||{},vNodeToString(this.renderToVNode({animation:retrieve2(a.cssAnimation,!0),emphasis:retrieve2(a.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:retrieve2(a.useViewBox,!0)}),{newline:!0})},s.prototype.setBackgroundColor=function(a){this._backgroundColor=a},s.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},s.prototype._paintList=function(a,o,c){for(var d=a.length,tt=[],nt=0,it,st,ut=0,ct=0;ct<d;ct++){var ot=a[ct];if(!ot.invisible){var at=ot.__clipPaths,ht=at&&at.length||0,ft=st&&st.length||0,mt=void 0;for(mt=Math.max(ht-1,ft-1);mt>=0&&!(at&&st&&at[mt]===st[mt]);mt--);for(var yt=ft-1;yt>mt;yt--)nt--,it=tt[nt-1];for(var bt=mt+1;bt<ht;bt++){var wt={};setClipPath(at[bt],wt,o);var Tt=createVNode("g","clip-g-"+ut++,wt,[]);(it?it.children:c).push(Tt),tt[nt++]=Tt,it=Tt}st=at;var Ct=brush(ot,o);Ct&&(it?it.children:c).push(Ct)}}},s.prototype.resize=function(a,o){var c=this._opts,d=this.root,tt=this._viewport;if(a!=null&&(c.width=a),o!=null&&(c.height=o),d&&tt&&(tt.style.display="none",a=getSize$1(d,0,c),o=getSize$1(d,1,c),tt.style.display=""),this._width!==a||this._height!==o){if(this._width=a,this._height=o,tt){var nt=tt.style;nt.width=a+"px",nt.height=o+"px"}if(isPattern(this._backgroundColor))this.refresh();else{var it=this._svgDom;it&&(it.setAttribute("width",a),it.setAttribute("height",o));var st=this._bgVNode&&this._bgVNode.elm;st&&(st.setAttribute("width",a),st.setAttribute("height",o))}}},s.prototype.getWidth=function(){return this._width},s.prototype.getHeight=function(){return this._height},s.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},s.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},s.prototype.toDataURL=function(a){var o=this.renderToString(),c="data:image/svg+xml;";return a?(o=encodeBase64(o),o&&c+"base64,"+o):c+"charset=UTF-8,"+encodeURIComponent(o)},s}();function createMethodNotSupport(s){return function(){}}function createBackgroundVNode(s,a,o,c){var d;if(o&&o!=="none")if(d=createVNode("rect","bg",{width:s,height:a,x:"0",y:"0"}),isGradient(o))setGradient({fill:o},d.attrs,"fill",c);else if(isPattern(o))setPattern({style:{fill:o},dirty:noop,getBoundingRect:function(){return{width:s,height:a}}},d.attrs,"fill",c);else{var tt=normalizeColor(o),nt=tt.color,it=tt.opacity;d.attrs.fill=nt,it<1&&(d.attrs["fill-opacity"]=it)}return d}function install$S(s){s.registerPainter("svg",SVGPainter)}function createDom(s,a,o){var c=platformApi.createCanvas(),d=a.getWidth(),tt=a.getHeight(),nt=c.style;return nt&&(nt.position="absolute",nt.left="0",nt.top="0",nt.width=d+"px",nt.height=tt+"px",c.setAttribute("data-zr-dom-id",s)),c.width=d*o,c.height=tt*o,c}var Layer=function(s){__extends(a,s);function a(o,c,d){var tt=s.call(this)||this;tt.motionBlur=!1,tt.lastFrameAlpha=.7,tt.dpr=1,tt.virtual=!1,tt.config={},tt.incremental=!1,tt.zlevel=0,tt.maxRepaintRectCount=5,tt.__dirty=!0,tt.__firstTimePaint=!0,tt.__used=!1,tt.__drawIndex=0,tt.__startIndex=0,tt.__endIndex=0,tt.__prevStartIndex=null,tt.__prevEndIndex=null;var nt;d=d||devicePixelRatio$1,typeof o=="string"?nt=createDom(o,c,d):isObject$3(o)&&(nt=o,o=nt.id),tt.id=o,tt.dom=nt;var it=nt.style;return it&&(disableUserSelect(nt),nt.onselectstart=function(){return!1},it.padding="0",it.margin="0",it.borderWidth="0"),tt.painter=c,tt.dpr=d,tt}return a.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},a.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},a.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},a.prototype.setUnpainted=function(){this.__firstTimePaint=!0},a.prototype.createBackBuffer=function(){var o=this.dpr;this.domBack=createDom("back-"+this.id,this.painter,o),this.ctxBack=this.domBack.getContext("2d"),o!==1&&this.ctxBack.scale(o,o)},a.prototype.createRepaintRects=function(o,c,d,tt){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var nt=[],it=this.maxRepaintRectCount,st=!1,ut=new BoundingRect(0,0,0,0);function ct(wt){if(!(!wt.isFinite()||wt.isZero()))if(nt.length===0){var Tt=new BoundingRect(0,0,0,0);Tt.copy(wt),nt.push(Tt)}else{for(var Ct=!1,Dt=1/0,Ot=0,$t=0;$t<nt.length;++$t){var Ft=nt[$t];if(Ft.intersect(wt)){var kt=new BoundingRect(0,0,0,0);kt.copy(Ft),kt.union(wt),nt[$t]=kt,Ct=!0;break}else if(st){ut.copy(wt),ut.union(Ft);var Vt=wt.width*wt.height,Ht=Ft.width*Ft.height,Qt=ut.width*ut.height,Xt=Qt-Vt-Ht;Xt<Dt&&(Dt=Xt,Ot=$t)}}if(st&&(nt[Ot].union(wt),Ct=!0),!Ct){var Tt=new BoundingRect(0,0,0,0);Tt.copy(wt),nt.push(Tt)}st||(st=nt.length>=it)}}for(var ot=this.__startIndex;ot<this.__endIndex;++ot){var at=o[ot];if(at){var ht=at.shouldBePainted(d,tt,!0,!0),ft=at.__isRendered&&(at.__dirty&REDRAW_BIT||!ht)?at.getPrevPaintRect():null;ft&&ct(ft);var mt=ht&&(at.__dirty&REDRAW_BIT||!at.__isRendered)?at.getPaintRect():null;mt&&ct(mt)}}for(var ot=this.__prevStartIndex;ot<this.__prevEndIndex;++ot){var at=c[ot],ht=at&&at.shouldBePainted(d,tt,!0,!0);if(at&&(!ht||!at.__zr)&&at.__isRendered){var ft=at.getPrevPaintRect();ft&&ct(ft)}}var yt;do{yt=!1;for(var ot=0;ot<nt.length;){if(nt[ot].isZero()){nt.splice(ot,1);continue}for(var bt=ot+1;bt<nt.length;)nt[ot].intersect(nt[bt])?(yt=!0,nt[ot].union(nt[bt]),nt.splice(bt,1)):bt++;ot++}}while(yt);return this._paintRects=nt,nt},a.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},a.prototype.resize=function(o,c){var d=this.dpr,tt=this.dom,nt=tt.style,it=this.domBack;nt&&(nt.width=o+"px",nt.height=c+"px"),tt.width=o*d,tt.height=c*d,it&&(it.width=o*d,it.height=c*d,d!==1&&this.ctxBack.scale(d,d))},a.prototype.clear=function(o,c,d){var tt=this.dom,nt=this.ctx,it=tt.width,st=tt.height;c=c||this.clearColor;var ut=this.motionBlur&&!o,ct=this.lastFrameAlpha,ot=this.dpr,at=this;ut&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(tt,0,0,it/ot,st/ot));var ht=this.domBack;function ft(mt,yt,bt,wt){if(nt.clearRect(mt,yt,bt,wt),c&&c!=="transparent"){var Tt=void 0;if(isGradientObject(c)){var Ct=c.global||c.__width===bt&&c.__height===wt;Tt=Ct&&c.__canvasGradient||getCanvasGradient(nt,c,{x:0,y:0,width:bt,height:wt}),c.__canvasGradient=Tt,c.__width=bt,c.__height=wt}else isImagePatternObject(c)&&(c.scaleX=c.scaleX||ot,c.scaleY=c.scaleY||ot,Tt=createCanvasPattern(nt,c,{dirty:function(){at.setUnpainted(),at.painter.refresh()}}));nt.save(),nt.fillStyle=Tt||c,nt.fillRect(mt,yt,bt,wt),nt.restore()}ut&&(nt.save(),nt.globalAlpha=ct,nt.drawImage(ht,mt,yt,bt,wt),nt.restore())}!d||ut?ft(0,0,it,st):d.length&&each$f(d,function(mt){ft(mt.x*ot,mt.y*ot,mt.width*ot,mt.height*ot)})},a}(Eventful),HOVER_LAYER_ZLEVEL=1e5,CANVAS_ZLEVEL=314159,EL_AFTER_INCREMENTAL_INC=.01,INCREMENTAL_INC=.001;function isLayerValid(s){return s?s.__builtin__?!0:!(typeof s.resize!="function"||typeof s.refresh!="function"):!1}function createRoot(s,a){var o=document.createElement("div");return o.style.cssText=["position:relative","width:"+s+"px","height:"+a+"px","padding:0","margin:0","border-width:0"].join(";")+";",o}var CanvasPainter=function(){function s(a,o,c,d){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var tt=!a.nodeName||a.nodeName.toUpperCase()==="CANVAS";this._opts=c=extend({},c||{}),this.dpr=c.devicePixelRatio||devicePixelRatio$1,this._singleCanvas=tt,this.root=a;var nt=a.style;nt&&(disableUserSelect(a),a.innerHTML=""),this.storage=o;var it=this._zlevelList;this._prevDisplayList=[];var st=this._layers;if(tt){var ct=a,ot=ct.width,at=ct.height;c.width!=null&&(ot=c.width),c.height!=null&&(at=c.height),this.dpr=c.devicePixelRatio||1,ct.width=ot*this.dpr,ct.height=at*this.dpr,this._width=ot,this._height=at;var ht=new Layer(ct,this,this.dpr);ht.__builtin__=!0,ht.initContext(),st[CANVAS_ZLEVEL]=ht,ht.zlevel=CANVAS_ZLEVEL,it.push(CANVAS_ZLEVEL),this._domRoot=a}else{this._width=getSize$1(a,0,c),this._height=getSize$1(a,1,c);var ut=this._domRoot=createRoot(this._width,this._height);a.appendChild(ut)}}return s.prototype.getType=function(){return"canvas"},s.prototype.isSingleCanvas=function(){return this._singleCanvas},s.prototype.getViewportRoot=function(){return this._domRoot},s.prototype.getViewportRootOffset=function(){var a=this.getViewportRoot();if(a)return{offsetLeft:a.offsetLeft||0,offsetTop:a.offsetTop||0}},s.prototype.refresh=function(a){var o=this.storage.getDisplayList(!0),c=this._prevDisplayList,d=this._zlevelList;this._redrawId=Math.random(),this._paintList(o,c,a,this._redrawId);for(var tt=0;tt<d.length;tt++){var nt=d[tt],it=this._layers[nt];if(!it.__builtin__&&it.refresh){var st=tt===0?this._backgroundColor:null;it.refresh(st)}}return this._opts.useDirtyRect&&(this._prevDisplayList=o.slice()),this},s.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},s.prototype._paintHoverList=function(a){var o=a.length,c=this._hoverlayer;if(c&&c.clear(),!!o){for(var d={inHover:!0,viewWidth:this._width,viewHeight:this._height},tt,nt=0;nt<o;nt++){var it=a[nt];it.__inHover&&(c||(c=this._hoverlayer=this.getLayer(HOVER_LAYER_ZLEVEL)),tt||(tt=c.ctx,tt.save()),brush$1(tt,it,d,nt===o-1))}tt&&tt.restore()}},s.prototype.getHoverLayer=function(){return this.getLayer(HOVER_LAYER_ZLEVEL)},s.prototype.paintOne=function(a,o){brushSingle(a,o)},s.prototype._paintList=function(a,o,c,d){if(this._redrawId===d){c=c||!1,this._updateLayerStatus(a);var tt=this._doPaintList(a,o,c),nt=tt.finished,it=tt.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),it&&this._paintHoverList(a),nt)this.eachLayer(function(ut){ut.afterBrush&&ut.afterBrush()});else{var st=this;requestAnimationFrame$1(function(){st._paintList(a,o,c,d)})}}},s.prototype._compositeManually=function(){var a=this.getLayer(CANVAS_ZLEVEL).ctx,o=this._domRoot.width,c=this._domRoot.height;a.clearRect(0,0,o,c),this.eachBuiltinLayer(function(d){d.virtual&&a.drawImage(d.dom,0,0,o,c)})},s.prototype._doPaintList=function(a,o,c){for(var d=this,tt=[],nt=this._opts.useDirtyRect,it=0;it<this._zlevelList.length;it++){var st=this._zlevelList[it],ut=this._layers[st];ut.__builtin__&&ut!==this._hoverlayer&&(ut.__dirty||c)&&tt.push(ut)}for(var ct=!0,ot=!1,at=function(mt){var yt=tt[mt],bt=yt.ctx,wt=nt&&yt.createRepaintRects(a,o,ht._width,ht._height),Tt=c?yt.__startIndex:yt.__drawIndex,Ct=!c&&yt.incremental&&Date.now,Dt=Ct&&Date.now(),Ot=yt.zlevel===ht._zlevelList[0]?ht._backgroundColor:null;if(yt.__startIndex===yt.__endIndex)yt.clear(!1,Ot,wt);else if(Tt===yt.__startIndex){var $t=a[Tt];(!$t.incremental||!$t.notClear||c)&&yt.clear(!1,Ot,wt)}Tt===-1&&(console.error("For some unknown reason. drawIndex is -1"),Tt=yt.__startIndex);var Ft,kt=function(Xt){var Zt={inHover:!1,allClipped:!1,prevEl:null,viewWidth:d._width,viewHeight:d._height};for(Ft=Tt;Ft<yt.__endIndex;Ft++){var ar=a[Ft];if(ar.__inHover&&(ot=!0),d._doPaintEl(ar,yt,nt,Xt,Zt,Ft===yt.__endIndex-1),Ct){var nr=Date.now()-Dt;if(nr>15)break}}Zt.prevElClipPaths&&bt.restore()};if(wt)if(wt.length===0)Ft=yt.__endIndex;else for(var Vt=ht.dpr,Ht=0;Ht<wt.length;++Ht){var Qt=wt[Ht];bt.save(),bt.beginPath(),bt.rect(Qt.x*Vt,Qt.y*Vt,Qt.width*Vt,Qt.height*Vt),bt.clip(),kt(Qt),bt.restore()}else bt.save(),kt(),bt.restore();yt.__drawIndex=Ft,yt.__drawIndex<yt.__endIndex&&(ct=!1)},ht=this,ft=0;ft<tt.length;ft++)at(ft);return env.wxa&&each$f(this._layers,function(mt){mt&&mt.ctx&&mt.ctx.draw&&mt.ctx.draw()}),{finished:ct,needsRefreshHover:ot}},s.prototype._doPaintEl=function(a,o,c,d,tt,nt){var it=o.ctx;if(c){var st=a.getPaintRect();(!d||st&&st.intersect(d))&&(brush$1(it,a,tt,nt),a.setPrevPaintRect(st))}else brush$1(it,a,tt,nt)},s.prototype.getLayer=function(a,o){this._singleCanvas&&!this._needsManuallyCompositing&&(a=CANVAS_ZLEVEL);var c=this._layers[a];return c||(c=new Layer("zr_"+a,this,this.dpr),c.zlevel=a,c.__builtin__=!0,this._layerConfig[a]?merge(c,this._layerConfig[a],!0):this._layerConfig[a-EL_AFTER_INCREMENTAL_INC]&&merge(c,this._layerConfig[a-EL_AFTER_INCREMENTAL_INC],!0),o&&(c.virtual=o),this.insertLayer(a,c),c.initContext()),c},s.prototype.insertLayer=function(a,o){var c=this._layers,d=this._zlevelList,tt=d.length,nt=this._domRoot,it=null,st=-1;if(!c[a]&&isLayerValid(o)){if(tt>0&&a>d[0]){for(st=0;st<tt-1&&!(d[st]<a&&d[st+1]>a);st++);it=c[d[st]]}if(d.splice(st+1,0,a),c[a]=o,!o.virtual)if(it){var ut=it.dom;ut.nextSibling?nt.insertBefore(o.dom,ut.nextSibling):nt.appendChild(o.dom)}else nt.firstChild?nt.insertBefore(o.dom,nt.firstChild):nt.appendChild(o.dom);o.painter||(o.painter=this)}},s.prototype.eachLayer=function(a,o){for(var c=this._zlevelList,d=0;d<c.length;d++){var tt=c[d];a.call(o,this._layers[tt],tt)}},s.prototype.eachBuiltinLayer=function(a,o){for(var c=this._zlevelList,d=0;d<c.length;d++){var tt=c[d],nt=this._layers[tt];nt.__builtin__&&a.call(o,nt,tt)}},s.prototype.eachOtherLayer=function(a,o){for(var c=this._zlevelList,d=0;d<c.length;d++){var tt=c[d],nt=this._layers[tt];nt.__builtin__||a.call(o,nt,tt)}},s.prototype.getLayers=function(){return this._layers},s.prototype._updateLayerStatus=function(a){this.eachBuiltinLayer(function(ot,at){ot.__dirty=ot.__used=!1});function o(ot){tt&&(tt.__endIndex!==ot&&(tt.__dirty=!0),tt.__endIndex=ot)}if(this._singleCanvas)for(var c=1;c<a.length;c++){var d=a[c];if(d.zlevel!==a[c-1].zlevel||d.incremental){this._needsManuallyCompositing=!0;break}}var tt=null,nt=0,it,st;for(st=0;st<a.length;st++){var d=a[st],ut=d.zlevel,ct=void 0;it!==ut&&(it=ut,nt=0),d.incremental?(ct=this.getLayer(ut+INCREMENTAL_INC,this._needsManuallyCompositing),ct.incremental=!0,nt=1):ct=this.getLayer(ut+(nt>0?EL_AFTER_INCREMENTAL_INC:0),this._needsManuallyCompositing),ct.__builtin__||logError("ZLevel "+ut+" has been used by unkown layer "+ct.id),ct!==tt&&(ct.__used=!0,ct.__startIndex!==st&&(ct.__dirty=!0),ct.__startIndex=st,ct.incremental?ct.__drawIndex=-1:ct.__drawIndex=st,o(st),tt=ct),d.__dirty&REDRAW_BIT&&!d.__inHover&&(ct.__dirty=!0,ct.incremental&&ct.__drawIndex<0&&(ct.__drawIndex=st))}o(st),this.eachBuiltinLayer(function(ot,at){!ot.__used&&ot.getElementCount()>0&&(ot.__dirty=!0,ot.__startIndex=ot.__endIndex=ot.__drawIndex=0),ot.__dirty&&ot.__drawIndex<0&&(ot.__drawIndex=ot.__startIndex)})},s.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},s.prototype._clearLayer=function(a){a.clear()},s.prototype.setBackgroundColor=function(a){this._backgroundColor=a,each$f(this._layers,function(o){o.setUnpainted()})},s.prototype.configLayer=function(a,o){if(o){var c=this._layerConfig;c[a]?merge(c[a],o,!0):c[a]=o;for(var d=0;d<this._zlevelList.length;d++){var tt=this._zlevelList[d];if(tt===a||tt===a+EL_AFTER_INCREMENTAL_INC){var nt=this._layers[tt];merge(nt,c[a],!0)}}}},s.prototype.delLayer=function(a){var o=this._layers,c=this._zlevelList,d=o[a];d&&(d.dom.parentNode.removeChild(d.dom),delete o[a],c.splice(indexOf(c,a),1))},s.prototype.resize=function(a,o){if(this._domRoot.style){var c=this._domRoot;c.style.display="none";var d=this._opts,tt=this.root;if(a!=null&&(d.width=a),o!=null&&(d.height=o),a=getSize$1(tt,0,d),o=getSize$1(tt,1,d),c.style.display="",this._width!==a||o!==this._height){c.style.width=a+"px",c.style.height=o+"px";for(var nt in this._layers)this._layers.hasOwnProperty(nt)&&this._layers[nt].resize(a,o);this.refresh(!0)}this._width=a,this._height=o}else{if(a==null||o==null)return;this._width=a,this._height=o,this.getLayer(CANVAS_ZLEVEL).resize(a,o)}return this},s.prototype.clearLayer=function(a){var o=this._layers[a];o&&o.clear()},s.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},s.prototype.getRenderedCanvas=function(a){if(a=a||{},this._singleCanvas&&!this._compositeManually)return this._layers[CANVAS_ZLEVEL].dom;var o=new Layer("image",this,a.pixelRatio||this.dpr);o.initContext(),o.clear(!1,a.backgroundColor||this._backgroundColor);var c=o.ctx;if(a.pixelRatio<=this.dpr){this.refresh();var d=o.dom.width,tt=o.dom.height;this.eachLayer(function(ot){ot.__builtin__?c.drawImage(ot.dom,0,0,d,tt):ot.renderToCanvas&&(c.save(),ot.renderToCanvas(c),c.restore())})}else for(var nt={inHover:!1,viewWidth:this._width,viewHeight:this._height},it=this.storage.getDisplayList(!0),st=0,ut=it.length;st<ut;st++){var ct=it[st];brush$1(c,ct,nt,st===ut-1)}return o.dom},s.prototype.getWidth=function(){return this._width},s.prototype.getHeight=function(){return this._height},s}();function install$R(s){s.registerPainter("canvas",CanvasPainter)}var LineSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o}return a.prototype.getInitialData=function(o){return createSeriesData(null,this,{useEncodeDefaulter:!0})},a.prototype.getLegendIcon=function(o){var c=new Group$3,d=createSymbol$1("line",0,o.itemHeight/2,o.itemWidth,0,o.lineStyle.stroke,!1);c.add(d),d.setStyle(o.lineStyle);var tt=this.getData().getVisual("symbol"),nt=this.getData().getVisual("symbolRotate"),it=tt==="none"?"circle":tt,st=o.itemHeight*.8,ut=createSymbol$1(it,(o.itemWidth-st)/2,(o.itemHeight-st)/2,st,st,o.itemStyle.fill);c.add(ut),ut.setStyle(o.itemStyle);var ct=o.iconRotate==="inherit"?nt:o.iconRotate||0;return ut.rotation=ct*Math.PI/180,ut.setOrigin([o.itemWidth/2,o.itemHeight/2]),it.indexOf("empty")>-1&&(ut.style.stroke=ut.style.fill,ut.style.fill="#fff",ut.style.lineWidth=2),c},a.type="series.line",a.dependencies=["grid","polar"],a.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},a}(SeriesModel);function getDefaultLabel(s,a){var o=s.mapDimensionsAll("defaultedLabel"),c=o.length;if(c===1){var d=retrieveRawValue(s,a,o[0]);return d!=null?d+"":null}else if(c){for(var tt=[],nt=0;nt<o.length;nt++)tt.push(retrieveRawValue(s,a,o[nt]));return tt.join(" ")}}function getDefaultInterpolatedLabel(s,a){var o=s.mapDimensionsAll("defaultedLabel");if(!isArray$1(a))return a+"";for(var c=[],d=0;d<o.length;d++){var tt=s.getDimensionIndex(o[d]);tt>=0&&c.push(a[tt])}return c.join(" ")}var Symbol$1=function(s){__extends$1(a,s);function a(o,c,d,tt){var nt=s.call(this)||this;return nt.updateData(o,c,d,tt),nt}return a.prototype._createSymbol=function(o,c,d,tt,nt){this.removeAll();var it=createSymbol$1(o,-1,-1,2,2,null,nt);it.attr({z2:100,culling:!0,scaleX:tt[0]/2,scaleY:tt[1]/2}),it.drift=driftSymbol,this._symbolType=o,this.add(it)},a.prototype.stopSymbolAnimation=function(o){this.childAt(0).stopAnimation(null,o)},a.prototype.getSymbolType=function(){return this._symbolType},a.prototype.getSymbolPath=function(){return this.childAt(0)},a.prototype.highlight=function(){enterEmphasis(this.childAt(0))},a.prototype.downplay=function(){leaveEmphasis(this.childAt(0))},a.prototype.setZ=function(o,c){var d=this.childAt(0);d.zlevel=o,d.z=c},a.prototype.setDraggable=function(o,c){var d=this.childAt(0);d.draggable=o,d.cursor=!c&&o?"move":d.cursor},a.prototype.updateData=function(o,c,d,tt){this.silent=!1;var nt=o.getItemVisual(c,"symbol")||"circle",it=o.hostModel,st=a.getSymbolSize(o,c),ut=nt!==this._symbolType,ct=tt&&tt.disableAnimation;if(ut){var ot=o.getItemVisual(c,"symbolKeepAspect");this._createSymbol(nt,o,c,st,ot)}else{var at=this.childAt(0);at.silent=!1;var ht={scaleX:st[0]/2,scaleY:st[1]/2};ct?at.attr(ht):updateProps$1(at,ht,it,c),saveOldStyle(at)}if(this._updateCommon(o,c,st,d,tt),ut){var at=this.childAt(0);if(!ct){var ht={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:at.style.opacity}};at.scaleX=at.scaleY=0,at.style.opacity=0,initProps(at,ht,it,c)}}ct&&this.childAt(0).stopAnimation("leave")},a.prototype._updateCommon=function(o,c,d,tt,nt){var it=this.childAt(0),st=o.hostModel,ut,ct,ot,at,ht,ft,mt,yt,bt;if(tt&&(ut=tt.emphasisItemStyle,ct=tt.blurItemStyle,ot=tt.selectItemStyle,at=tt.focus,ht=tt.blurScope,mt=tt.labelStatesModels,yt=tt.hoverScale,bt=tt.cursorStyle,ft=tt.emphasisDisabled),!tt||o.hasItemOption){var wt=tt&&tt.itemModel?tt.itemModel:o.getItemModel(c),Tt=wt.getModel("emphasis");ut=Tt.getModel("itemStyle").getItemStyle(),ot=wt.getModel(["select","itemStyle"]).getItemStyle(),ct=wt.getModel(["blur","itemStyle"]).getItemStyle(),at=Tt.get("focus"),ht=Tt.get("blurScope"),ft=Tt.get("disabled"),mt=getLabelStatesModels(wt),yt=Tt.getShallow("scale"),bt=wt.getShallow("cursor")}var Ct=o.getItemVisual(c,"symbolRotate");it.attr("rotation",(Ct||0)*Math.PI/180||0);var Dt=normalizeSymbolOffset(o.getItemVisual(c,"symbolOffset"),d);Dt&&(it.x=Dt[0],it.y=Dt[1]),bt&&it.attr("cursor",bt);var Ot=o.getItemVisual(c,"style"),$t=Ot.fill;if(it instanceof ZRImage){var Ft=it.style;it.useStyle(extend({image:Ft.image,x:Ft.x,y:Ft.y,width:Ft.width,height:Ft.height},Ot))}else it.__isEmptyBrush?it.useStyle(extend({},Ot)):it.useStyle(Ot),it.style.decal=null,it.setColor($t,nt&&nt.symbolInnerColor),it.style.strokeNoScale=!0;var kt=o.getItemVisual(c,"liftZ"),Vt=this._z2;kt!=null?Vt==null&&(this._z2=it.z2,it.z2+=kt):Vt!=null&&(it.z2=Vt,this._z2=null);var Ht=nt&&nt.useNameLabel;setLabelStyle(it,mt,{labelFetcher:st,labelDataIndex:c,defaultText:Qt,inheritColor:$t,defaultOpacity:Ot.opacity});function Qt(ar){return Ht?o.getName(ar):getDefaultLabel(o,ar)}this._sizeX=d[0]/2,this._sizeY=d[1]/2;var Xt=it.ensureState("emphasis");Xt.style=ut,it.ensureState("select").style=ot,it.ensureState("blur").style=ct;var Zt=yt==null||yt===!0?Math.max(1.1,3/this._sizeY):isFinite(yt)&&yt>0?+yt:1;Xt.scaleX=this._sizeX*Zt,Xt.scaleY=this._sizeY*Zt,this.setSymbolScale(1),toggleHoverEmphasis(this,at,ht,ft)},a.prototype.setSymbolScale=function(o){this.scaleX=this.scaleY=o},a.prototype.fadeOut=function(o,c,d){var tt=this.childAt(0),nt=getECData(this).dataIndex,it=d&&d.animation;if(this.silent=tt.silent=!0,d&&d.fadeLabel){var st=tt.getTextContent();st&&removeElement(st,{style:{opacity:0}},c,{dataIndex:nt,removeOpt:it,cb:function(){tt.removeTextContent()}})}else tt.removeTextContent();removeElement(tt,{style:{opacity:0},scaleX:0,scaleY:0},c,{dataIndex:nt,cb:o,removeOpt:it})},a.getSymbolSize=function(o,c){return normalizeSymbolSize(o.getItemVisual(c,"symbolSize"))},a}(Group$3);function driftSymbol(s,a){this.parent.drift(s,a)}function symbolNeedsDraw$1(s,a,o,c){return a&&!isNaN(a[0])&&!isNaN(a[1])&&!(c.isIgnore&&c.isIgnore(o))&&!(c.clipShape&&!c.clipShape.contain(a[0],a[1]))&&s.getItemVisual(o,"symbol")!=="none"}function normalizeUpdateOpt(s){return s!=null&&!isObject$3(s)&&(s={isIgnore:s}),s||{}}function makeSeriesScope$2(s){var a=s.hostModel,o=a.getModel("emphasis");return{emphasisItemStyle:o.getModel("itemStyle").getItemStyle(),blurItemStyle:a.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:a.getModel(["select","itemStyle"]).getItemStyle(),focus:o.get("focus"),blurScope:o.get("blurScope"),emphasisDisabled:o.get("disabled"),hoverScale:o.get("scale"),labelStatesModels:getLabelStatesModels(a),cursorStyle:a.get("cursor")}}var SymbolDraw=function(){function s(a){this.group=new Group$3,this._SymbolCtor=a||Symbol$1}return s.prototype.updateData=function(a,o){this._progressiveEls=null,o=normalizeUpdateOpt(o);var c=this.group,d=a.hostModel,tt=this._data,nt=this._SymbolCtor,it=o.disableAnimation,st=makeSeriesScope$2(a),ut={disableAnimation:it},ct=o.getSymbolPoint||function(ot){return a.getItemLayout(ot)};tt||c.removeAll(),a.diff(tt).add(function(ot){var at=ct(ot);if(symbolNeedsDraw$1(a,at,ot,o)){var ht=new nt(a,ot,st,ut);ht.setPosition(at),a.setItemGraphicEl(ot,ht),c.add(ht)}}).update(function(ot,at){var ht=tt.getItemGraphicEl(at),ft=ct(ot);if(!symbolNeedsDraw$1(a,ft,ot,o)){c.remove(ht);return}var mt=a.getItemVisual(ot,"symbol")||"circle",yt=ht&&ht.getSymbolType&&ht.getSymbolType();if(!ht||yt&&yt!==mt)c.remove(ht),ht=new nt(a,ot,st,ut),ht.setPosition(ft);else{ht.updateData(a,ot,st,ut);var bt={x:ft[0],y:ft[1]};it?ht.attr(bt):updateProps$1(ht,bt,d)}c.add(ht),a.setItemGraphicEl(ot,ht)}).remove(function(ot){var at=tt.getItemGraphicEl(ot);at&&at.fadeOut(function(){c.remove(at)},d)}).execute(),this._getSymbolPoint=ct,this._data=a},s.prototype.updateLayout=function(){var a=this,o=this._data;o&&o.eachItemGraphicEl(function(c,d){var tt=a._getSymbolPoint(d);c.setPosition(tt),c.markRedraw()})},s.prototype.incrementalPrepareUpdate=function(a){this._seriesScope=makeSeriesScope$2(a),this._data=null,this.group.removeAll()},s.prototype.incrementalUpdate=function(a,o,c){this._progressiveEls=[],c=normalizeUpdateOpt(c);function d(st){st.isGroup||(st.incremental=!0,st.ensureState("emphasis").hoverLayer=!0)}for(var tt=a.start;tt<a.end;tt++){var nt=o.getItemLayout(tt);if(symbolNeedsDraw$1(o,nt,tt,c)){var it=new this._SymbolCtor(o,tt,this._seriesScope);it.traverse(d),it.setPosition(nt),this.group.add(it),o.setItemGraphicEl(tt,it),this._progressiveEls.push(it)}}},s.prototype.eachRendered=function(a){traverseElements(this._progressiveEls||this.group,a)},s.prototype.remove=function(a){var o=this.group,c=this._data;c&&a?c.eachItemGraphicEl(function(d){d.fadeOut(function(){o.remove(d)},c.hostModel)}):o.removeAll()},s}();function prepareDataCoordInfo(s,a,o){var c=s.getBaseAxis(),d=s.getOtherAxis(c),tt=getValueStart(d,o),nt=c.dim,it=d.dim,st=a.mapDimension(it),ut=a.mapDimension(nt),ct=it==="x"||it==="radius"?1:0,ot=map$1(s.dimensions,function(ft){return a.mapDimension(ft)}),at=!1,ht=a.getCalculationInfo("stackResultDimension");return isDimensionStacked(a,ot[0])&&(at=!0,ot[0]=ht),isDimensionStacked(a,ot[1])&&(at=!0,ot[1]=ht),{dataDimsForPoint:ot,valueStart:tt,valueAxisDim:it,baseAxisDim:nt,stacked:!!at,valueDim:st,baseDim:ut,baseDataOffset:ct,stackedOverDimension:a.getCalculationInfo("stackedOverDimension")}}function getValueStart(s,a){var o=0,c=s.scale.getExtent();return a==="start"?o=c[0]:a==="end"?o=c[1]:isNumber(a)&&!isNaN(a)?o=a:c[0]>0?o=c[0]:c[1]<0&&(o=c[1]),o}function getStackedOnPoint(s,a,o,c){var d=NaN;s.stacked&&(d=o.get(o.getCalculationInfo("stackedOverDimension"),c)),isNaN(d)&&(d=s.valueStart);var tt=s.baseDataOffset,nt=[];return nt[tt]=o.get(s.baseDim,c),nt[1-tt]=d,a.dataToPoint(nt)}function diffData(s,a){var o=[];return a.diff(s).add(function(c){o.push({cmd:"+",idx:c})}).update(function(c,d){o.push({cmd:"=",idx:d,idx1:c})}).remove(function(c){o.push({cmd:"-",idx:c})}).execute(),o}function lineAnimationDiff(s,a,o,c,d,tt,nt,it){for(var st=diffData(s,a),ut=[],ct=[],ot=[],at=[],ht=[],ft=[],mt=[],yt=prepareDataCoordInfo(d,a,nt),bt=s.getLayout("points")||[],wt=a.getLayout("points")||[],Tt=0;Tt<st.length;Tt++){var Ct=st[Tt],Dt=!0,Ot=void 0,$t=void 0;switch(Ct.cmd){case"=":Ot=Ct.idx*2,$t=Ct.idx1*2;var Ft=bt[Ot],kt=bt[Ot+1],Vt=wt[$t],Ht=wt[$t+1];(isNaN(Ft)||isNaN(kt))&&(Ft=Vt,kt=Ht),ut.push(Ft,kt),ct.push(Vt,Ht),ot.push(o[Ot],o[Ot+1]),at.push(c[$t],c[$t+1]),mt.push(a.getRawIndex(Ct.idx1));break;case"+":var Qt=Ct.idx,Xt=yt.dataDimsForPoint,Zt=d.dataToPoint([a.get(Xt[0],Qt),a.get(Xt[1],Qt)]);$t=Qt*2,ut.push(Zt[0],Zt[1]),ct.push(wt[$t],wt[$t+1]);var ar=getStackedOnPoint(yt,d,a,Qt);ot.push(ar[0],ar[1]),at.push(c[$t],c[$t+1]),mt.push(a.getRawIndex(Qt));break;case"-":Dt=!1}Dt&&(ht.push(Ct),ft.push(ft.length))}ft.sort(function(an,xn){return mt[an]-mt[xn]});for(var nr=ut.length,cr=createFloat32Array(nr),dr=createFloat32Array(nr),mr=createFloat32Array(nr),Dr=createFloat32Array(nr),kr=[],Tt=0;Tt<ft.length;Tt++){var Yr=ft[Tt],Mr=Tt*2,Jr=Yr*2;cr[Mr]=ut[Jr],cr[Mr+1]=ut[Jr+1],dr[Mr]=ct[Jr],dr[Mr+1]=ct[Jr+1],mr[Mr]=ot[Jr],mr[Mr+1]=ot[Jr+1],Dr[Mr]=at[Jr],Dr[Mr+1]=at[Jr+1],kr[Tt]=ht[Yr]}return{current:cr,next:dr,stackedOnCurrent:mr,stackedOnNext:Dr,status:kr}}var mathMin$5=Math.min,mathMax$5=Math.max;function isPointNull$1(s,a){return isNaN(s)||isNaN(a)}function drawSegment(s,a,o,c,d,tt,nt,it,st){for(var ut,ct,ot,at,ht,ft,mt=o,yt=0;yt<c;yt++){var bt=a[mt*2],wt=a[mt*2+1];if(mt>=d||mt<0)break;if(isPointNull$1(bt,wt)){if(st){mt+=tt;continue}break}if(mt===o)s[tt>0?"moveTo":"lineTo"](bt,wt),ot=bt,at=wt;else{var Tt=bt-ut,Ct=wt-ct;if(Tt*Tt+Ct*Ct<.5){mt+=tt;continue}if(nt>0){for(var Dt=mt+tt,Ot=a[Dt*2],$t=a[Dt*2+1];Ot===bt&&$t===wt&&yt<c;)yt++,Dt+=tt,mt+=tt,Ot=a[Dt*2],$t=a[Dt*2+1],bt=a[mt*2],wt=a[mt*2+1],Tt=bt-ut,Ct=wt-ct;var Ft=yt+1;if(st)for(;isPointNull$1(Ot,$t)&&Ft<c;)Ft++,Dt+=tt,Ot=a[Dt*2],$t=a[Dt*2+1];var kt=.5,Vt=0,Ht=0,Qt=void 0,Xt=void 0;if(Ft>=c||isPointNull$1(Ot,$t))ht=bt,ft=wt;else{Vt=Ot-ut,Ht=$t-ct;var Zt=bt-ut,ar=Ot-bt,nr=wt-ct,cr=$t-wt,dr=void 0,mr=void 0;if(it==="x"){dr=Math.abs(Zt),mr=Math.abs(ar);var Dr=Vt>0?1:-1;ht=bt-Dr*dr*nt,ft=wt,Qt=bt+Dr*mr*nt,Xt=wt}else if(it==="y"){dr=Math.abs(nr),mr=Math.abs(cr);var kr=Ht>0?1:-1;ht=bt,ft=wt-kr*dr*nt,Qt=bt,Xt=wt+kr*mr*nt}else dr=Math.sqrt(Zt*Zt+nr*nr),mr=Math.sqrt(ar*ar+cr*cr),kt=mr/(mr+dr),ht=bt-Vt*nt*(1-kt),ft=wt-Ht*nt*(1-kt),Qt=bt+Vt*nt*kt,Xt=wt+Ht*nt*kt,Qt=mathMin$5(Qt,mathMax$5(Ot,bt)),Xt=mathMin$5(Xt,mathMax$5($t,wt)),Qt=mathMax$5(Qt,mathMin$5(Ot,bt)),Xt=mathMax$5(Xt,mathMin$5($t,wt)),Vt=Qt-bt,Ht=Xt-wt,ht=bt-Vt*dr/mr,ft=wt-Ht*dr/mr,ht=mathMin$5(ht,mathMax$5(ut,bt)),ft=mathMin$5(ft,mathMax$5(ct,wt)),ht=mathMax$5(ht,mathMin$5(ut,bt)),ft=mathMax$5(ft,mathMin$5(ct,wt)),Vt=bt-ht,Ht=wt-ft,Qt=bt+Vt*mr/dr,Xt=wt+Ht*mr/dr}s.bezierCurveTo(ot,at,ht,ft,bt,wt),ot=Qt,at=Xt}else s.lineTo(bt,wt)}ut=bt,ct=wt,mt+=tt}return yt}var ECPolylineShape=function(){function s(){this.smooth=0,this.smoothConstraint=!0}return s}(),ECPolyline=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="ec-polyline",c}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new ECPolylineShape},a.prototype.buildPath=function(o,c){var d=c.points,tt=0,nt=d.length/2;if(c.connectNulls){for(;nt>0&&isPointNull$1(d[nt*2-2],d[nt*2-1]);nt--);for(;tt<nt&&isPointNull$1(d[tt*2],d[tt*2+1]);tt++);}for(;tt<nt;)tt+=drawSegment(o,d,tt,nt,nt,1,c.smooth,c.smoothMonotone,c.connectNulls)+1},a.prototype.getPointOn=function(o,c){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var d=this.path,tt=d.data,nt=PathProxy.CMD,it,st,ut=c==="x",ct=[],ot=0;ot<tt.length;){var at=tt[ot++],ht=void 0,ft=void 0,mt=void 0,yt=void 0,bt=void 0,wt=void 0,Tt=void 0;switch(at){case nt.M:it=tt[ot++],st=tt[ot++];break;case nt.L:if(ht=tt[ot++],ft=tt[ot++],Tt=ut?(o-it)/(ht-it):(o-st)/(ft-st),Tt<=1&&Tt>=0){var Ct=ut?(ft-st)*Tt+st:(ht-it)*Tt+it;return ut?[o,Ct]:[Ct,o]}it=ht,st=ft;break;case nt.C:ht=tt[ot++],ft=tt[ot++],mt=tt[ot++],yt=tt[ot++],bt=tt[ot++],wt=tt[ot++];var Dt=ut?cubicRootAt(it,ht,mt,bt,o,ct):cubicRootAt(st,ft,yt,wt,o,ct);if(Dt>0)for(var Ot=0;Ot<Dt;Ot++){var $t=ct[Ot];if($t<=1&&$t>=0){var Ct=ut?cubicAt(st,ft,yt,wt,$t):cubicAt(it,ht,mt,bt,$t);return ut?[o,Ct]:[Ct,o]}}it=bt,st=wt;break}}},a}(Path),ECPolygonShape=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a}(ECPolylineShape),ECPolygon=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="ec-polygon",c}return a.prototype.getDefaultShape=function(){return new ECPolygonShape},a.prototype.buildPath=function(o,c){var d=c.points,tt=c.stackedOnPoints,nt=0,it=d.length/2,st=c.smoothMonotone;if(c.connectNulls){for(;it>0&&isPointNull$1(d[it*2-2],d[it*2-1]);it--);for(;nt<it&&isPointNull$1(d[nt*2],d[nt*2+1]);nt++);}for(;nt<it;){var ut=drawSegment(o,d,nt,it,it,1,c.smooth,st,c.connectNulls);drawSegment(o,tt,nt+ut-1,ut,it,-1,c.stackedOnSmooth,st,c.connectNulls),nt+=ut+1,o.closePath()}},a}(Path);function createGridClipPath(s,a,o,c,d){var tt=s.getArea(),nt=tt.x,it=tt.y,st=tt.width,ut=tt.height,ct=o.get(["lineStyle","width"])||0;nt-=ct/2,it-=ct/2,st+=ct,ut+=ct,st=Math.ceil(st),nt!==Math.floor(nt)&&(nt=Math.floor(nt),st++);var ot=new Rect$2({shape:{x:nt,y:it,width:st,height:ut}});if(a){var at=s.getBaseAxis(),ht=at.isHorizontal(),ft=at.inverse;ht?(ft&&(ot.shape.x+=st),ot.shape.width=0):(ft||(ot.shape.y+=ut),ot.shape.height=0);var mt=isFunction$1(d)?function(yt){d(yt,ot)}:null;initProps(ot,{shape:{width:st,height:ut,x:nt,y:it}},o,null,c,mt)}return ot}function createPolarClipPath(s,a,o){var c=s.getArea(),d=round$3(c.r0,1),tt=round$3(c.r,1),nt=new Sector({shape:{cx:round$3(s.cx,1),cy:round$3(s.cy,1),r0:d,r:tt,startAngle:c.startAngle,endAngle:c.endAngle,clockwise:c.clockwise}});if(a){var it=s.getBaseAxis().dim==="angle";it?nt.shape.endAngle=c.startAngle:nt.shape.r=d,initProps(nt,{shape:{endAngle:c.endAngle,r:tt}},o)}return nt}function createClipPath(s,a,o,c,d){if(s){if(s.type==="polar")return createPolarClipPath(s,a,o);if(s.type==="cartesian2d")return createGridClipPath(s,a,o,c,d)}else return null;return null}function isCoordinateSystemType(s,a){return s.type===a}function isPointsSame(s,a){if(s.length===a.length){for(var o=0;o<s.length;o++)if(s[o]!==a[o])return;return!0}}function bboxFromPoints(s){for(var a=1/0,o=1/0,c=-1/0,d=-1/0,tt=0;tt<s.length;){var nt=s[tt++],it=s[tt++];isNaN(nt)||(a=Math.min(nt,a),c=Math.max(nt,c)),isNaN(it)||(o=Math.min(it,o),d=Math.max(it,d))}return[[a,o],[c,d]]}function getBoundingDiff(s,a){var o=bboxFromPoints(s),c=o[0],d=o[1],tt=bboxFromPoints(a),nt=tt[0],it=tt[1];return Math.max(Math.abs(c[0]-nt[0]),Math.abs(c[1]-nt[1]),Math.abs(d[0]-it[0]),Math.abs(d[1]-it[1]))}function getSmooth(s){return isNumber(s)?s:s?.5:0}function getStackedOnPoints(s,a,o){if(!o.valueDim)return[];for(var c=a.count(),d=createFloat32Array(c*2),tt=0;tt<c;tt++){var nt=getStackedOnPoint(o,s,a,tt);d[tt*2]=nt[0],d[tt*2+1]=nt[1]}return d}function turnPointsIntoStep(s,a,o,c,d){var tt=o.getBaseAxis(),nt=tt.dim==="x"||tt.dim==="radius"?0:1,it=[],st=0,ut=[],ct=[],ot=[],at=[];if(d){for(st=0;st<s.length;st+=2){var ht=a||s;!isNaN(ht[st])&&!isNaN(ht[st+1])&&at.push(s[st],s[st+1])}s=at}for(st=0;st<s.length-2;st+=2)switch(ot[0]=s[st+2],ot[1]=s[st+3],ct[0]=s[st],ct[1]=s[st+1],it.push(ct[0],ct[1]),c){case"end":ut[nt]=ot[nt],ut[1-nt]=ct[1-nt],it.push(ut[0],ut[1]);break;case"middle":var ft=(ct[nt]+ot[nt])/2,mt=[];ut[nt]=mt[nt]=ft,ut[1-nt]=ct[1-nt],mt[1-nt]=ot[1-nt],it.push(ut[0],ut[1]),it.push(mt[0],mt[1]);break;default:ut[nt]=ct[nt],ut[1-nt]=ot[1-nt],it.push(ut[0],ut[1])}return it.push(s[st++],s[st++]),it}function clipColorStops(s,a){var o=[],c=s.length,d,tt;function nt(ct,ot,at){var ht=ct.coord,ft=(at-ht)/(ot.coord-ht),mt=lerp(ft,[ct.color,ot.color]);return{coord:at,color:mt}}for(var it=0;it<c;it++){var st=s[it],ut=st.coord;if(ut<0)d=st;else if(ut>a){tt?o.push(nt(tt,st,a)):d&&o.push(nt(d,st,0),nt(d,st,a));break}else d&&(o.push(nt(d,st,0)),d=null),o.push(st),tt=st}return o}function getVisualGradient(s,a,o){var c=s.getVisual("visualMeta");if(!(!c||!c.length||!s.count())&&a.type==="cartesian2d"){for(var d,tt,nt=c.length-1;nt>=0;nt--){var it=s.getDimensionInfo(c[nt].dimension);if(d=it&&it.coordDim,d==="x"||d==="y"){tt=c[nt];break}}if(tt){var st=a.getAxis(d),ut=map$1(tt.stops,function(Tt){return{coord:st.toGlobalCoord(st.dataToCoord(Tt.value)),color:Tt.color}}),ct=ut.length,ot=tt.outerColors.slice();ct&&ut[0].coord>ut[ct-1].coord&&(ut.reverse(),ot.reverse());var at=clipColorStops(ut,d==="x"?o.getWidth():o.getHeight()),ht=at.length;if(!ht&&ct)return ut[0].coord<0?ot[1]?ot[1]:ut[ct-1].color:ot[0]?ot[0]:ut[0].color;var ft=10,mt=at[0].coord-ft,yt=at[ht-1].coord+ft,bt=yt-mt;if(bt<.001)return"transparent";each$f(at,function(Tt){Tt.offset=(Tt.coord-mt)/bt}),at.push({offset:ht?at[ht-1].offset:.5,color:ot[1]||"transparent"}),at.unshift({offset:ht?at[0].offset:.5,color:ot[0]||"transparent"});var wt=new LinearGradient(0,0,0,0,at,!0);return wt[d]=mt,wt[d+"2"]=yt,wt}}}function getIsIgnoreFunc(s,a,o){var c=s.get("showAllSymbol"),d=c==="auto";if(!(c&&!d)){var tt=o.getAxesByScale("ordinal")[0];if(tt&&!(d&&canShowAllSymbolForCategory(tt,a))){var nt=a.mapDimension(tt.dim),it={};return each$f(tt.getViewLabels(),function(st){var ut=tt.scale.getRawOrdinalNumber(st.tickValue);it[ut]=1}),function(st){return!it.hasOwnProperty(a.get(nt,st))}}}}function canShowAllSymbolForCategory(s,a){var o=s.getExtent(),c=Math.abs(o[1]-o[0])/s.scale.count();isNaN(c)&&(c=0);for(var d=a.count(),tt=Math.max(1,Math.round(d/5)),nt=0;nt<d;nt+=tt)if(Symbol$1.getSymbolSize(a,nt)[s.isHorizontal()?1:0]*1.5>c)return!1;return!0}function isPointNull(s,a){return isNaN(s)||isNaN(a)}function getLastIndexNotNull(s){for(var a=s.length/2;a>0&&isPointNull(s[a*2-2],s[a*2-1]);a--);return a-1}function getPointAtIndex(s,a){return[s[a*2],s[a*2+1]]}function getIndexRange(s,a,o){for(var c=s.length/2,d=o==="x"?0:1,tt,nt,it=0,st=-1,ut=0;ut<c;ut++)if(nt=s[ut*2+d],!(isNaN(nt)||isNaN(s[ut*2+1-d]))){if(ut===0){tt=nt;continue}if(tt<=a&&nt>=a||tt>=a&&nt<=a){st=ut;break}it=ut,tt=nt}return{range:[it,st],t:(a-tt)/(nt-tt)}}function anyStateShowEndLabel(s){if(s.get(["endLabel","show"]))return!0;for(var a=0;a<SPECIAL_STATES.length;a++)if(s.get([SPECIAL_STATES[a],"endLabel","show"]))return!0;return!1}function createLineClipPath(s,a,o,c){if(isCoordinateSystemType(a,"cartesian2d")){var d=c.getModel("endLabel"),tt=d.get("valueAnimation"),nt=c.getData(),it={lastFrameIndex:0},st=anyStateShowEndLabel(c)?function(ht,ft){s._endLabelOnDuring(ht,ft,nt,it,tt,d,a)}:null,ut=a.getBaseAxis().isHorizontal(),ct=createGridClipPath(a,o,c,function(){var ht=s._endLabel;ht&&o&&it.originalX!=null&&ht.attr({x:it.originalX,y:it.originalY})},st);if(!c.get("clip",!0)){var ot=ct.shape,at=Math.max(ot.width,ot.height);ut?(ot.y-=at,ot.height+=at*2):(ot.x-=at,ot.width+=at*2)}return st&&st(1,ct),ct}else return createPolarClipPath(a,o,c)}function getEndLabelStateSpecified(s,a){var o=a.getBaseAxis(),c=o.isHorizontal(),d=o.inverse,tt=c?d?"right":"left":"center",nt=c?"middle":d?"top":"bottom";return{normal:{align:s.get("align")||tt,verticalAlign:s.get("verticalAlign")||nt}}}var LineView=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.init=function(){var o=new Group$3,c=new SymbolDraw;this.group.add(c.group),this._symbolDraw=c,this._lineGroup=o,this._changePolyState=bind$2(this._changePolyState,this)},a.prototype.render=function(o,c,d){var tt=o.coordinateSystem,nt=this.group,it=o.getData(),st=o.getModel("lineStyle"),ut=o.getModel("areaStyle"),ct=it.getLayout("points")||[],ot=tt.type==="polar",at=this._coordSys,ht=this._symbolDraw,ft=this._polyline,mt=this._polygon,yt=this._lineGroup,bt=!c.ssr&&o.get("animation"),wt=!ut.isEmpty(),Tt=ut.get("origin"),Ct=prepareDataCoordInfo(tt,it,Tt),Dt=wt&&getStackedOnPoints(tt,it,Ct),Ot=o.get("showSymbol"),$t=o.get("connectNulls"),Ft=Ot&&!ot&&getIsIgnoreFunc(o,it,tt),kt=this._data;kt&&kt.eachItemGraphicEl(function(an,xn){an.__temp&&(nt.remove(an),kt.setItemGraphicEl(xn,null))}),Ot||ht.remove(),nt.add(yt);var Vt=ot?!1:o.get("step"),Ht;tt&&tt.getArea&&o.get("clip",!0)&&(Ht=tt.getArea(),Ht.width!=null?(Ht.x-=.1,Ht.y-=.1,Ht.width+=.2,Ht.height+=.2):Ht.r0&&(Ht.r0-=.5,Ht.r+=.5)),this._clipShapeForSymbol=Ht;var Qt=getVisualGradient(it,tt,d)||it.getVisual("style")[it.getVisual("drawType")];if(!(ft&&at.type===tt.type&&Vt===this._step))Ot&&ht.updateData(it,{isIgnore:Ft,clipShape:Ht,disableAnimation:!0,getSymbolPoint:function(an){return[ct[an*2],ct[an*2+1]]}}),bt&&this._initSymbolLabelAnimation(it,tt,Ht),Vt&&(Dt&&(Dt=turnPointsIntoStep(Dt,ct,tt,Vt,$t)),ct=turnPointsIntoStep(ct,null,tt,Vt,$t)),ft=this._newPolyline(ct),wt?mt=this._newPolygon(ct,Dt):mt&&(yt.remove(mt),mt=this._polygon=null),ot||this._initOrUpdateEndLabel(o,tt,convertToColorString(Qt)),yt.setClipPath(createLineClipPath(this,tt,!0,o));else{wt&&!mt?mt=this._newPolygon(ct,Dt):mt&&!wt&&(yt.remove(mt),mt=this._polygon=null),ot||this._initOrUpdateEndLabel(o,tt,convertToColorString(Qt));var Xt=yt.getClipPath();if(Xt){var Zt=createLineClipPath(this,tt,!1,o);initProps(Xt,{shape:Zt.shape},o)}else yt.setClipPath(createLineClipPath(this,tt,!0,o));Ot&&ht.updateData(it,{isIgnore:Ft,clipShape:Ht,disableAnimation:!0,getSymbolPoint:function(an){return[ct[an*2],ct[an*2+1]]}}),(!isPointsSame(this._stackedOnPoints,Dt)||!isPointsSame(this._points,ct))&&(bt?this._doUpdateAnimation(it,Dt,tt,d,Vt,Tt,$t):(Vt&&(Dt&&(Dt=turnPointsIntoStep(Dt,ct,tt,Vt,$t)),ct=turnPointsIntoStep(ct,null,tt,Vt,$t)),ft.setShape({points:ct}),mt&&mt.setShape({points:ct,stackedOnPoints:Dt})))}var ar=o.getModel("emphasis"),nr=ar.get("focus"),cr=ar.get("blurScope"),dr=ar.get("disabled");if(ft.useStyle(defaults(st.getLineStyle(),{fill:"none",stroke:Qt,lineJoin:"bevel"})),setStatesStylesFromModel(ft,o,"lineStyle"),ft.style.lineWidth>0&&o.get(["emphasis","lineStyle","width"])==="bolder"){var mr=ft.getState("emphasis").style;mr.lineWidth=+ft.style.lineWidth+1}getECData(ft).seriesIndex=o.seriesIndex,toggleHoverEmphasis(ft,nr,cr,dr);var Dr=getSmooth(o.get("smooth")),kr=o.get("smoothMonotone");if(ft.setShape({smooth:Dr,smoothMonotone:kr,connectNulls:$t}),mt){var Yr=it.getCalculationInfo("stackedOnSeries"),Mr=0;mt.useStyle(defaults(ut.getAreaStyle(),{fill:Qt,opacity:.7,lineJoin:"bevel",decal:it.getVisual("style").decal})),Yr&&(Mr=getSmooth(Yr.get("smooth"))),mt.setShape({smooth:Dr,stackedOnSmooth:Mr,smoothMonotone:kr,connectNulls:$t}),setStatesStylesFromModel(mt,o,"areaStyle"),getECData(mt).seriesIndex=o.seriesIndex,toggleHoverEmphasis(mt,nr,cr,dr)}var Jr=this._changePolyState;it.eachItemGraphicEl(function(an){an&&(an.onHoverStateChange=Jr)}),this._polyline.onHoverStateChange=Jr,this._data=it,this._coordSys=tt,this._stackedOnPoints=Dt,this._points=ct,this._step=Vt,this._valueOrigin=Tt,o.get("triggerLineEvent")&&(this.packEventData(o,ft),mt&&this.packEventData(o,mt))},a.prototype.packEventData=function(o,c){getECData(c).eventData={componentType:"series",componentSubType:"line",componentIndex:o.componentIndex,seriesIndex:o.seriesIndex,seriesName:o.name,seriesType:"line"}},a.prototype.highlight=function(o,c,d,tt){var nt=o.getData(),it=queryDataIndex(nt,tt);if(this._changePolyState("emphasis"),!(it instanceof Array)&&it!=null&&it>=0){var st=nt.getLayout("points"),ut=nt.getItemGraphicEl(it);if(!ut){var ct=st[it*2],ot=st[it*2+1];if(isNaN(ct)||isNaN(ot)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(ct,ot))return;var at=o.get("zlevel")||0,ht=o.get("z")||0;ut=new Symbol$1(nt,it),ut.x=ct,ut.y=ot,ut.setZ(at,ht);var ft=ut.getSymbolPath().getTextContent();ft&&(ft.zlevel=at,ft.z=ht,ft.z2=this._polyline.z2+1),ut.__temp=!0,nt.setItemGraphicEl(it,ut),ut.stopSymbolAnimation(!0),this.group.add(ut)}ut.highlight()}else ChartView.prototype.highlight.call(this,o,c,d,tt)},a.prototype.downplay=function(o,c,d,tt){var nt=o.getData(),it=queryDataIndex(nt,tt);if(this._changePolyState("normal"),it!=null&&it>=0){var st=nt.getItemGraphicEl(it);st&&(st.__temp?(nt.setItemGraphicEl(it,null),this.group.remove(st)):st.downplay())}else ChartView.prototype.downplay.call(this,o,c,d,tt)},a.prototype._changePolyState=function(o){var c=this._polygon;setStatesFlag(this._polyline,o),c&&setStatesFlag(c,o)},a.prototype._newPolyline=function(o){var c=this._polyline;return c&&this._lineGroup.remove(c),c=new ECPolyline({shape:{points:o},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(c),this._polyline=c,c},a.prototype._newPolygon=function(o,c){var d=this._polygon;return d&&this._lineGroup.remove(d),d=new ECPolygon({shape:{points:o,stackedOnPoints:c},segmentIgnoreThreshold:2}),this._lineGroup.add(d),this._polygon=d,d},a.prototype._initSymbolLabelAnimation=function(o,c,d){var tt,nt,it=c.getBaseAxis(),st=it.inverse;c.type==="cartesian2d"?(tt=it.isHorizontal(),nt=!1):c.type==="polar"&&(tt=it.dim==="angle",nt=!0);var ut=o.hostModel,ct=ut.get("animationDuration");isFunction$1(ct)&&(ct=ct(null));var ot=ut.get("animationDelay")||0,at=isFunction$1(ot)?ot(null):ot;o.eachItemGraphicEl(function(ht,ft){var mt=ht;if(mt){var yt=[ht.x,ht.y],bt=void 0,wt=void 0,Tt=void 0;if(d)if(nt){var Ct=d,Dt=c.pointToCoord(yt);tt?(bt=Ct.startAngle,wt=Ct.endAngle,Tt=-Dt[1]/180*Math.PI):(bt=Ct.r0,wt=Ct.r,Tt=Dt[0])}else{var Ot=d;tt?(bt=Ot.x,wt=Ot.x+Ot.width,Tt=ht.x):(bt=Ot.y+Ot.height,wt=Ot.y,Tt=ht.y)}var $t=wt===bt?0:(Tt-bt)/(wt-bt);st&&($t=1-$t);var Ft=isFunction$1(ot)?ot(ft):ct*$t+at,kt=mt.getSymbolPath(),Vt=kt.getTextContent();mt.attr({scaleX:0,scaleY:0}),mt.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:Ft}),Vt&&Vt.animateFrom({style:{opacity:0}},{duration:300,delay:Ft}),kt.disableLabelAnimation=!0}})},a.prototype._initOrUpdateEndLabel=function(o,c,d){var tt=o.getModel("endLabel");if(anyStateShowEndLabel(o)){var nt=o.getData(),it=this._polyline,st=nt.getLayout("points");if(!st){it.removeTextContent(),this._endLabel=null;return}var ut=this._endLabel;ut||(ut=this._endLabel=new ZRText({z2:200}),ut.ignoreClip=!0,it.setTextContent(this._endLabel),it.disableLabelAnimation=!0);var ct=getLastIndexNotNull(st);ct>=0&&(setLabelStyle(it,getLabelStatesModels(o,"endLabel"),{inheritColor:d,labelFetcher:o,labelDataIndex:ct,defaultText:function(ot,at,ht){return ht!=null?getDefaultInterpolatedLabel(nt,ht):getDefaultLabel(nt,ot)},enableTextSetter:!0},getEndLabelStateSpecified(tt,c)),it.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},a.prototype._endLabelOnDuring=function(o,c,d,tt,nt,it,st){var ut=this._endLabel,ct=this._polyline;if(ut){o<1&&tt.originalX==null&&(tt.originalX=ut.x,tt.originalY=ut.y);var ot=d.getLayout("points"),at=d.hostModel,ht=at.get("connectNulls"),ft=it.get("precision"),mt=it.get("distance")||0,yt=st.getBaseAxis(),bt=yt.isHorizontal(),wt=yt.inverse,Tt=c.shape,Ct=wt?bt?Tt.x:Tt.y+Tt.height:bt?Tt.x+Tt.width:Tt.y,Dt=(bt?mt:0)*(wt?-1:1),Ot=(bt?0:-mt)*(wt?-1:1),$t=bt?"x":"y",Ft=getIndexRange(ot,Ct,$t),kt=Ft.range,Vt=kt[1]-kt[0],Ht=void 0;if(Vt>=1){if(Vt>1&&!ht){var Qt=getPointAtIndex(ot,kt[0]);ut.attr({x:Qt[0]+Dt,y:Qt[1]+Ot}),nt&&(Ht=at.getRawValue(kt[0]))}else{var Qt=ct.getPointOn(Ct,$t);Qt&&ut.attr({x:Qt[0]+Dt,y:Qt[1]+Ot});var Xt=at.getRawValue(kt[0]),Zt=at.getRawValue(kt[1]);nt&&(Ht=interpolateRawValues(d,ft,Xt,Zt,Ft.t))}tt.lastFrameIndex=kt[0]}else{var ar=o===1||tt.lastFrameIndex>0?kt[0]:0,Qt=getPointAtIndex(ot,ar);nt&&(Ht=at.getRawValue(ar)),ut.attr({x:Qt[0]+Dt,y:Qt[1]+Ot})}if(nt){var nr=labelInner(ut);typeof nr.setLabelText=="function"&&nr.setLabelText(Ht)}}},a.prototype._doUpdateAnimation=function(o,c,d,tt,nt,it,st){var ut=this._polyline,ct=this._polygon,ot=o.hostModel,at=lineAnimationDiff(this._data,o,this._stackedOnPoints,c,this._coordSys,d,this._valueOrigin),ht=at.current,ft=at.stackedOnCurrent,mt=at.next,yt=at.stackedOnNext;if(nt&&(ft=turnPointsIntoStep(at.stackedOnCurrent,at.current,d,nt,st),ht=turnPointsIntoStep(at.current,null,d,nt,st),yt=turnPointsIntoStep(at.stackedOnNext,at.next,d,nt,st),mt=turnPointsIntoStep(at.next,null,d,nt,st)),getBoundingDiff(ht,mt)>3e3||ct&&getBoundingDiff(ft,yt)>3e3){ut.stopAnimation(),ut.setShape({points:mt}),ct&&(ct.stopAnimation(),ct.setShape({points:mt,stackedOnPoints:yt}));return}ut.shape.__points=at.current,ut.shape.points=ht;var bt={shape:{points:mt}};at.current!==ht&&(bt.shape.__points=at.next),ut.stopAnimation(),updateProps$1(ut,bt,ot),ct&&(ct.setShape({points:ht,stackedOnPoints:ft}),ct.stopAnimation(),updateProps$1(ct,{shape:{stackedOnPoints:yt}},ot),ut.shape.points!==ct.shape.points&&(ct.shape.points=ut.shape.points));for(var wt=[],Tt=at.status,Ct=0;Ct<Tt.length;Ct++){var Dt=Tt[Ct].cmd;if(Dt==="="){var Ot=o.getItemGraphicEl(Tt[Ct].idx1);Ot&&wt.push({el:Ot,ptIdx:Ct})}}ut.animators&&ut.animators.length&&ut.animators[0].during(function(){ct&&ct.dirtyShape();for(var $t=ut.shape.__points,Ft=0;Ft<wt.length;Ft++){var kt=wt[Ft].el,Vt=wt[Ft].ptIdx*2;kt.x=$t[Vt],kt.y=$t[Vt+1],kt.markRedraw()}})},a.prototype.remove=function(o){var c=this.group,d=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),d&&d.eachItemGraphicEl(function(tt,nt){tt.__temp&&(c.remove(tt),d.setItemGraphicEl(nt,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},a.type="line",a}(ChartView);function pointsLayout(s,a){return{seriesType:s,plan:createRenderPlanner(),reset:function(o){var c=o.getData(),d=o.coordinateSystem,tt=o.pipelineContext,nt=a||tt.large;if(d){var it=map$1(d.dimensions,function(ht){return c.mapDimension(ht)}).slice(0,2),st=it.length,ut=c.getCalculationInfo("stackResultDimension");isDimensionStacked(c,it[0])&&(it[0]=ut),isDimensionStacked(c,it[1])&&(it[1]=ut);var ct=c.getStore(),ot=c.getDimensionIndex(it[0]),at=c.getDimensionIndex(it[1]);return st&&{progress:function(ht,ft){for(var mt=ht.end-ht.start,yt=nt&&createFloat32Array(mt*st),bt=[],wt=[],Tt=ht.start,Ct=0;Tt<ht.end;Tt++){var Dt=void 0;if(st===1){var Ot=ct.get(ot,Tt);Dt=d.dataToPoint(Ot,null,wt)}else bt[0]=ct.get(ot,Tt),bt[1]=ct.get(at,Tt),Dt=d.dataToPoint(bt,null,wt);nt?(yt[Ct++]=Dt[0],yt[Ct++]=Dt[1]):ft.setItemLayout(Tt,Dt.slice())}nt&&ft.setLayout("points",yt)}}}}}}var samplers={average:function(s){for(var a=0,o=0,c=0;c<s.length;c++)isNaN(s[c])||(a+=s[c],o++);return o===0?NaN:a/o},sum:function(s){for(var a=0,o=0;o<s.length;o++)a+=s[o]||0;return a},max:function(s){for(var a=-1/0,o=0;o<s.length;o++)s[o]>a&&(a=s[o]);return isFinite(a)?a:NaN},min:function(s){for(var a=1/0,o=0;o<s.length;o++)s[o]<a&&(a=s[o]);return isFinite(a)?a:NaN},nearest:function(s){return s[0]}},indexSampler=function(s){return Math.round(s.length/2)};function dataSample(s){return{seriesType:s,reset:function(a,o,c){var d=a.getData(),tt=a.get("sampling"),nt=a.coordinateSystem,it=d.count();if(it>10&&nt.type==="cartesian2d"&&tt){var st=nt.getBaseAxis(),ut=nt.getOtherAxis(st),ct=st.getExtent(),ot=c.getDevicePixelRatio(),at=Math.abs(ct[1]-ct[0])*(ot||1),ht=Math.round(it/at);if(isFinite(ht)&&ht>1){tt==="lttb"?a.setData(d.lttbDownSample(d.mapDimension(ut.dim),1/ht)):tt==="minmax"&&a.setData(d.minmaxDownSample(d.mapDimension(ut.dim),1/ht));var ft=void 0;isString$1(tt)?ft=samplers[tt]:isFunction$1(tt)&&(ft=tt),ft&&a.setData(d.downSample(d.mapDimension(ut.dim),1/ht,ft,indexSampler))}}}}}function install$Q(s){s.registerChartView(LineView),s.registerSeriesModel(LineSeriesModel),s.registerLayout(pointsLayout("line",!0)),s.registerVisual({seriesType:"line",reset:function(a){var o=a.getData(),c=a.getModel("lineStyle").getLineStyle();c&&!c.stroke&&(c.stroke=o.getVisual("style").fill),o.setVisual("legendLineStyle",c)}}),s.registerProcessor(s.PRIORITY.PROCESSOR.STATISTIC,dataSample("line"))}var BaseBarSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.getInitialData=function(o,c){return createSeriesData(null,this,{useEncodeDefaulter:!0})},a.prototype.getMarkerPosition=function(o,c,d){var tt=this.coordinateSystem;if(tt&&tt.clampData){var nt=tt.clampData(o),it=tt.dataToPoint(nt);if(d)each$f(tt.getAxes(),function(at,ht){if(at.type==="category"&&c!=null){var ft=at.getTicksCoords(),mt=at.getTickModel().get("alignWithLabel"),yt=nt[ht],bt=c[ht]==="x1"||c[ht]==="y1";if(bt&&!mt&&(yt+=1),ft.length<2)return;if(ft.length===2){it[ht]=at.toGlobalCoord(at.getExtent()[bt?1:0]);return}for(var wt=void 0,Tt=void 0,Ct=1,Dt=0;Dt<ft.length;Dt++){var Ot=ft[Dt].coord,$t=Dt===ft.length-1?ft[Dt-1].tickValue+Ct:ft[Dt].tickValue;if($t===yt){Tt=Ot;break}else if($t<yt)wt=Ot;else if(wt!=null&&$t>yt){Tt=(Ot+wt)/2;break}Dt===1&&(Ct=$t-ft[0].tickValue)}Tt==null&&(wt?wt&&(Tt=ft[ft.length-1].coord):Tt=ft[0].coord),it[ht]=at.toGlobalCoord(Tt)}});else{var st=this.getData(),ut=st.getLayout("offset"),ct=st.getLayout("size"),ot=tt.getBaseAxis().isHorizontal()?0:1;it[ot]+=ut+ct/2}return it}return[NaN,NaN]},a.type="series.__base_bar__",a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},a}(SeriesModel);SeriesModel.registerClass(BaseBarSeriesModel);var BarSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.getInitialData=function(){return createSeriesData(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},a.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},a.prototype.getProgressiveThreshold=function(){var o=this.get("progressiveThreshold"),c=this.get("largeThreshold");return c>o&&(o=c),o},a.prototype.brushSelector=function(o,c,d){return d.rect(c.getItemLayout(o))},a.type="series.bar",a.dependencies=["grid","polar"],a.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),a}(BaseBarSeriesModel),SausageShape=function(){function s(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return s}(),SausagePath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="sausage",c}return a.prototype.getDefaultShape=function(){return new SausageShape},a.prototype.buildPath=function(o,c){var d=c.cx,tt=c.cy,nt=Math.max(c.r0||0,0),it=Math.max(c.r,0),st=(it-nt)*.5,ut=nt+st,ct=c.startAngle,ot=c.endAngle,at=c.clockwise,ht=Math.PI*2,ft=at?ot-ct<ht:ct-ot<ht;ft||(ct=ot-(at?ht:-ht));var mt=Math.cos(ct),yt=Math.sin(ct),bt=Math.cos(ot),wt=Math.sin(ot);ft?(o.moveTo(mt*nt+d,yt*nt+tt),o.arc(mt*ut+d,yt*ut+tt,st,-Math.PI+ct,ct,!at)):o.moveTo(mt*it+d,yt*it+tt),o.arc(d,tt,it,ct,ot,!at),o.arc(bt*ut+d,wt*ut+tt,st,ot-Math.PI*2,ot-Math.PI,!at),nt!==0&&o.arc(d,tt,nt,ot,ct,at)},a}(Path);function createSectorCalculateTextPosition(s,a){a=a||{};var o=a.isRoundCap;return function(c,d,tt){var nt=d.position;if(!nt||nt instanceof Array)return calculateTextPosition(c,d,tt);var it=s(nt),st=d.distance!=null?d.distance:5,ut=this.shape,ct=ut.cx,ot=ut.cy,at=ut.r,ht=ut.r0,ft=(at+ht)/2,mt=ut.startAngle,yt=ut.endAngle,bt=(mt+yt)/2,wt=o?Math.abs(at-ht)/2:0,Tt=Math.cos,Ct=Math.sin,Dt=ct+at*Tt(mt),Ot=ot+at*Ct(mt),$t="left",Ft="top";switch(it){case"startArc":Dt=ct+(ht-st)*Tt(bt),Ot=ot+(ht-st)*Ct(bt),$t="center",Ft="top";break;case"insideStartArc":Dt=ct+(ht+st)*Tt(bt),Ot=ot+(ht+st)*Ct(bt),$t="center",Ft="bottom";break;case"startAngle":Dt=ct+ft*Tt(mt)+adjustAngleDistanceX(mt,st+wt,!1),Ot=ot+ft*Ct(mt)+adjustAngleDistanceY(mt,st+wt,!1),$t="right",Ft="middle";break;case"insideStartAngle":Dt=ct+ft*Tt(mt)+adjustAngleDistanceX(mt,-st+wt,!1),Ot=ot+ft*Ct(mt)+adjustAngleDistanceY(mt,-st+wt,!1),$t="left",Ft="middle";break;case"middle":Dt=ct+ft*Tt(bt),Ot=ot+ft*Ct(bt),$t="center",Ft="middle";break;case"endArc":Dt=ct+(at+st)*Tt(bt),Ot=ot+(at+st)*Ct(bt),$t="center",Ft="bottom";break;case"insideEndArc":Dt=ct+(at-st)*Tt(bt),Ot=ot+(at-st)*Ct(bt),$t="center",Ft="top";break;case"endAngle":Dt=ct+ft*Tt(yt)+adjustAngleDistanceX(yt,st+wt,!0),Ot=ot+ft*Ct(yt)+adjustAngleDistanceY(yt,st+wt,!0),$t="left",Ft="middle";break;case"insideEndAngle":Dt=ct+ft*Tt(yt)+adjustAngleDistanceX(yt,-st+wt,!0),Ot=ot+ft*Ct(yt)+adjustAngleDistanceY(yt,-st+wt,!0),$t="right",Ft="middle";break;default:return calculateTextPosition(c,d,tt)}return c=c||{},c.x=Dt,c.y=Ot,c.align=$t,c.verticalAlign=Ft,c}}function setSectorTextRotation(s,a,o,c){if(isNumber(c)){s.setTextConfig({rotation:c});return}else if(isArray$1(a)){s.setTextConfig({rotation:0});return}var d=s.shape,tt=d.clockwise?d.startAngle:d.endAngle,nt=d.clockwise?d.endAngle:d.startAngle,it=(tt+nt)/2,st,ut=o(a);switch(ut){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":st=it;break;case"startAngle":case"insideStartAngle":st=tt;break;case"endAngle":case"insideEndAngle":st=nt;break;default:s.setTextConfig({rotation:0});return}var ct=Math.PI*1.5-st;ut==="middle"&&ct>Math.PI/2&&ct<Math.PI*1.5&&(ct-=Math.PI),s.setTextConfig({rotation:ct})}function adjustAngleDistanceX(s,a,o){return a*Math.sin(s)*(o?-1:1)}function adjustAngleDistanceY(s,a,o){return a*Math.cos(s)*(o?1:-1)}function getSectorCornerRadius(s,a,o){var c=s.get("borderRadius");if(c==null)return o?{cornerRadius:0}:null;isArray$1(c)||(c=[c,c,c,c]);var d=Math.abs(a.r||0-a.r0||0);return{cornerRadius:map$1(c,function(tt){return parsePercent$1(tt,d)})}}var mathMax$4=Math.max,mathMin$4=Math.min;function getClipArea(s,a){var o=s.getArea&&s.getArea();if(isCoordinateSystemType(s,"cartesian2d")){var c=s.getBaseAxis();if(c.type!=="category"||!c.onBand){var d=a.getLayout("bandWidth");c.isHorizontal()?(o.x-=d,o.width+=d*2):(o.y-=d,o.height+=d*2)}}return o}var BarView=function(s){__extends$1(a,s);function a(){var o=s.call(this)||this;return o.type=a.type,o._isFirstFrame=!0,o}return a.prototype.render=function(o,c,d,tt){this._model=o,this._removeOnRenderedListener(d),this._updateDrawMode(o);var nt=o.get("coordinateSystem");(nt==="cartesian2d"||nt==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(o,c,d):this._renderNormal(o,c,d,tt))},a.prototype.incrementalPrepareRender=function(o){this._clear(),this._updateDrawMode(o),this._updateLargeClip(o)},a.prototype.incrementalRender=function(o,c){this._progressiveEls=[],this._incrementalRenderLarge(o,c)},a.prototype.eachRendered=function(o){traverseElements(this._progressiveEls||this.group,o)},a.prototype._updateDrawMode=function(o){var c=o.pipelineContext.large;(this._isLargeDraw==null||c!==this._isLargeDraw)&&(this._isLargeDraw=c,this._clear())},a.prototype._renderNormal=function(o,c,d,tt){var nt=this.group,it=o.getData(),st=this._data,ut=o.coordinateSystem,ct=ut.getBaseAxis(),ot;ut.type==="cartesian2d"?ot=ct.isHorizontal():ut.type==="polar"&&(ot=ct.dim==="angle");var at=o.isAnimationEnabled()?o:null,ht=shouldRealtimeSort(o,ut);ht&&this._enableRealtimeSort(ht,it,d);var ft=o.get("clip",!0)||ht,mt=getClipArea(ut,it);nt.removeClipPath();var yt=o.get("roundCap",!0),bt=o.get("showBackground",!0),wt=o.getModel("backgroundStyle"),Tt=wt.get("borderRadius")||0,Ct=[],Dt=this._backgroundEls,Ot=tt&&tt.isInitSort,$t=tt&&tt.type==="changeAxisOrder";function Ft(Ht){var Qt=getLayout[ut.type](it,Ht),Xt=createBackgroundEl(ut,ot,Qt);return Xt.useStyle(wt.getItemStyle()),ut.type==="cartesian2d"?Xt.setShape("r",Tt):Xt.setShape("cornerRadius",Tt),Ct[Ht]=Xt,Xt}it.diff(st).add(function(Ht){var Qt=it.getItemModel(Ht),Xt=getLayout[ut.type](it,Ht,Qt);if(bt&&Ft(Ht),!(!it.hasValue(Ht)||!isValidLayout[ut.type](Xt))){var Zt=!1;ft&&(Zt=clip[ut.type](mt,Xt));var ar=elementCreator[ut.type](o,it,Ht,Xt,ot,at,ct.model,!1,yt);ht&&(ar.forceLabelAnimation=!0),updateStyle(ar,it,Ht,Qt,Xt,o,ot,ut.type==="polar"),Ot?ar.attr({shape:Xt}):ht?updateRealtimeAnimation(ht,at,ar,Xt,Ht,ot,!1,!1):initProps(ar,{shape:Xt},o,Ht),it.setItemGraphicEl(Ht,ar),nt.add(ar),ar.ignore=Zt}}).update(function(Ht,Qt){var Xt=it.getItemModel(Ht),Zt=getLayout[ut.type](it,Ht,Xt);if(bt){var ar=void 0;Dt.length===0?ar=Ft(Qt):(ar=Dt[Qt],ar.useStyle(wt.getItemStyle()),ut.type==="cartesian2d"?ar.setShape("r",Tt):ar.setShape("cornerRadius",Tt),Ct[Ht]=ar);var nr=getLayout[ut.type](it,Ht),cr=createBackgroundShape(ot,nr,ut);updateProps$1(ar,{shape:cr},at,Ht)}var dr=st.getItemGraphicEl(Qt);if(!it.hasValue(Ht)||!isValidLayout[ut.type](Zt)){nt.remove(dr);return}var mr=!1;if(ft&&(mr=clip[ut.type](mt,Zt),mr&&nt.remove(dr)),dr?saveOldStyle(dr):dr=elementCreator[ut.type](o,it,Ht,Zt,ot,at,ct.model,!!dr,yt),ht&&(dr.forceLabelAnimation=!0),$t){var Dr=dr.getTextContent();if(Dr){var kr=labelInner(Dr);kr.prevValue!=null&&(kr.prevValue=kr.value)}}else updateStyle(dr,it,Ht,Xt,Zt,o,ot,ut.type==="polar");Ot?dr.attr({shape:Zt}):ht?updateRealtimeAnimation(ht,at,dr,Zt,Ht,ot,!0,$t):updateProps$1(dr,{shape:Zt},o,Ht,null),it.setItemGraphicEl(Ht,dr),dr.ignore=mr,nt.add(dr)}).remove(function(Ht){var Qt=st.getItemGraphicEl(Ht);Qt&&removeElementWithFadeOut(Qt,o,Ht)}).execute();var kt=this._backgroundGroup||(this._backgroundGroup=new Group$3);kt.removeAll();for(var Vt=0;Vt<Ct.length;++Vt)kt.add(Ct[Vt]);nt.add(kt),this._backgroundEls=Ct,this._data=it},a.prototype._renderLarge=function(o,c,d){this._clear(),createLarge$1(o,this.group),this._updateLargeClip(o)},a.prototype._incrementalRenderLarge=function(o,c){this._removeBackground(),createLarge$1(c,this.group,this._progressiveEls,!0)},a.prototype._updateLargeClip=function(o){var c=o.get("clip",!0)&&createClipPath(o.coordinateSystem,!1,o),d=this.group;c?d.setClipPath(c):d.removeClipPath()},a.prototype._enableRealtimeSort=function(o,c,d){var tt=this;if(c.count()){var nt=o.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(c,o,d),this._isFirstFrame=!1;else{var it=function(st){var ut=c.getItemGraphicEl(st),ct=ut&&ut.shape;return ct&&Math.abs(nt.isHorizontal()?ct.height:ct.width)||0};this._onRendered=function(){tt._updateSortWithinSameData(c,it,nt,d)},d.getZr().on("rendered",this._onRendered)}}},a.prototype._dataSort=function(o,c,d){var tt=[];return o.each(o.mapDimension(c.dim),function(nt,it){var st=d(it);st=st??NaN,tt.push({dataIndex:it,mappedValue:st,ordinalNumber:nt})}),tt.sort(function(nt,it){return it.mappedValue-nt.mappedValue}),{ordinalNumbers:map$1(tt,function(nt){return nt.ordinalNumber})}},a.prototype._isOrderChangedWithinSameData=function(o,c,d){for(var tt=d.scale,nt=o.mapDimension(d.dim),it=Number.MAX_VALUE,st=0,ut=tt.getOrdinalMeta().categories.length;st<ut;++st){var ct=o.rawIndexOf(nt,tt.getRawOrdinalNumber(st)),ot=ct<0?Number.MIN_VALUE:c(o.indexOfRawIndex(ct));if(ot>it)return!0;it=ot}return!1},a.prototype._isOrderDifferentInView=function(o,c){for(var d=c.scale,tt=d.getExtent(),nt=Math.max(0,tt[0]),it=Math.min(tt[1],d.getOrdinalMeta().categories.length-1);nt<=it;++nt)if(o.ordinalNumbers[nt]!==d.getRawOrdinalNumber(nt))return!0},a.prototype._updateSortWithinSameData=function(o,c,d,tt){if(this._isOrderChangedWithinSameData(o,c,d)){var nt=this._dataSort(o,d,c);this._isOrderDifferentInView(nt,d)&&(this._removeOnRenderedListener(tt),tt.dispatchAction({type:"changeAxisOrder",componentType:d.dim+"Axis",axisId:d.index,sortInfo:nt}))}},a.prototype._dispatchInitSort=function(o,c,d){var tt=c.baseAxis,nt=this._dataSort(o,tt,function(it){return o.get(o.mapDimension(c.otherAxis.dim),it)});d.dispatchAction({type:"changeAxisOrder",componentType:tt.dim+"Axis",isInitSort:!0,axisId:tt.index,sortInfo:nt})},a.prototype.remove=function(o,c){this._clear(this._model),this._removeOnRenderedListener(c)},a.prototype.dispose=function(o,c){this._removeOnRenderedListener(c)},a.prototype._removeOnRenderedListener=function(o){this._onRendered&&(o.getZr().off("rendered",this._onRendered),this._onRendered=null)},a.prototype._clear=function(o){var c=this.group,d=this._data;o&&o.isAnimationEnabled()&&d&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],d.eachItemGraphicEl(function(tt){removeElementWithFadeOut(tt,o,getECData(tt).dataIndex)})):c.removeAll(),this._data=null,this._isFirstFrame=!0},a.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},a.type="bar",a}(ChartView),clip={cartesian2d:function(s,a){var o=a.width<0?-1:1,c=a.height<0?-1:1;o<0&&(a.x+=a.width,a.width=-a.width),c<0&&(a.y+=a.height,a.height=-a.height);var d=s.x+s.width,tt=s.y+s.height,nt=mathMax$4(a.x,s.x),it=mathMin$4(a.x+a.width,d),st=mathMax$4(a.y,s.y),ut=mathMin$4(a.y+a.height,tt),ct=it<nt,ot=ut<st;return a.x=ct&&nt>d?it:nt,a.y=ot&&st>tt?ut:st,a.width=ct?0:it-nt,a.height=ot?0:ut-st,o<0&&(a.x+=a.width,a.width=-a.width),c<0&&(a.y+=a.height,a.height=-a.height),ct||ot},polar:function(s,a){var o=a.r0<=a.r?1:-1;if(o<0){var c=a.r;a.r=a.r0,a.r0=c}var d=mathMin$4(a.r,s.r),tt=mathMax$4(a.r0,s.r0);a.r=d,a.r0=tt;var nt=d-tt<0;if(o<0){var c=a.r;a.r=a.r0,a.r0=c}return nt}},elementCreator={cartesian2d:function(s,a,o,c,d,tt,nt,it,st){var ut=new Rect$2({shape:extend({},c),z2:1});if(ut.__dataIndex=o,ut.name="item",tt){var ct=ut.shape,ot=d?"height":"width";ct[ot]=0}return ut},polar:function(s,a,o,c,d,tt,nt,it,st){var ut=!d&&st?SausagePath:Sector,ct=new ut({shape:c,z2:1});ct.name="item";var ot=createPolarPositionMapping(d);if(ct.calculateTextPosition=createSectorCalculateTextPosition(ot,{isRoundCap:ut===SausagePath}),tt){var at=ct.shape,ht=d?"r":"endAngle",ft={};at[ht]=d?c.r0:c.startAngle,ft[ht]=c[ht],(it?updateProps$1:initProps)(ct,{shape:ft},tt)}return ct}};function shouldRealtimeSort(s,a){var o=s.get("realtimeSort",!0),c=a.getBaseAxis();if(o&&c.type==="category"&&a.type==="cartesian2d")return{baseAxis:c,otherAxis:a.getOtherAxis(c)}}function updateRealtimeAnimation(s,a,o,c,d,tt,nt,it){var st,ut;tt?(ut={x:c.x,width:c.width},st={y:c.y,height:c.height}):(ut={y:c.y,height:c.height},st={x:c.x,width:c.width}),it||(nt?updateProps$1:initProps)(o,{shape:st},a,d,null);var ct=a?s.baseAxis.model:null;(nt?updateProps$1:initProps)(o,{shape:ut},ct,d)}function checkPropertiesNotValid(s,a){for(var o=0;o<a.length;o++)if(!isFinite(s[a[o]]))return!0;return!1}var rectPropties=["x","y","width","height"],polarPropties=["cx","cy","r","startAngle","endAngle"],isValidLayout={cartesian2d:function(s){return!checkPropertiesNotValid(s,rectPropties)},polar:function(s){return!checkPropertiesNotValid(s,polarPropties)}},getLayout={cartesian2d:function(s,a,o){var c=s.getItemLayout(a),d=o?getLineWidth(o,c):0,tt=c.width>0?1:-1,nt=c.height>0?1:-1;return{x:c.x+tt*d/2,y:c.y+nt*d/2,width:c.width-tt*d,height:c.height-nt*d}},polar:function(s,a,o){var c=s.getItemLayout(a);return{cx:c.cx,cy:c.cy,r0:c.r0,r:c.r,startAngle:c.startAngle,endAngle:c.endAngle,clockwise:c.clockwise}}};function isZeroOnPolar(s){return s.startAngle!=null&&s.endAngle!=null&&s.startAngle===s.endAngle}function createPolarPositionMapping(s){return function(a){var o=a?"Arc":"Angle";return function(c){switch(c){case"start":case"insideStart":case"end":case"insideEnd":return c+o;default:return c}}}(s)}function updateStyle(s,a,o,c,d,tt,nt,it){var st=a.getItemVisual(o,"style");if(it){if(!tt.get("roundCap")){var ct=s.shape,ot=getSectorCornerRadius(c.getModel("itemStyle"),ct,!0);extend(ct,ot),s.setShape(ct)}}else{var ut=c.get(["itemStyle","borderRadius"])||0;s.setShape("r",ut)}s.useStyle(st);var at=c.getShallow("cursor");at&&s.attr("cursor",at);var ht=it?nt?d.r>=d.r0?"endArc":"startArc":d.endAngle>=d.startAngle?"endAngle":"startAngle":nt?d.height>=0?"bottom":"top":d.width>=0?"right":"left",ft=getLabelStatesModels(c);setLabelStyle(s,ft,{labelFetcher:tt,labelDataIndex:o,defaultText:getDefaultLabel(tt.getData(),o),inheritColor:st.fill,defaultOpacity:st.opacity,defaultOutsidePosition:ht});var mt=s.getTextContent();if(it&&mt){var yt=c.get(["label","position"]);s.textConfig.inside=yt==="middle"?!0:null,setSectorTextRotation(s,yt==="outside"?ht:yt,createPolarPositionMapping(nt),c.get(["label","rotate"]))}setLabelValueAnimation(mt,ft,tt.getRawValue(o),function(wt){return getDefaultInterpolatedLabel(a,wt)});var bt=c.getModel(["emphasis"]);toggleHoverEmphasis(s,bt.get("focus"),bt.get("blurScope"),bt.get("disabled")),setStatesStylesFromModel(s,c),isZeroOnPolar(d)&&(s.style.fill="none",s.style.stroke="none",each$f(s.states,function(wt){wt.style&&(wt.style.fill=wt.style.stroke="none")}))}function getLineWidth(s,a){var o=s.get(["itemStyle","borderColor"]);if(!o||o==="none")return 0;var c=s.get(["itemStyle","borderWidth"])||0,d=isNaN(a.width)?Number.MAX_VALUE:Math.abs(a.width),tt=isNaN(a.height)?Number.MAX_VALUE:Math.abs(a.height);return Math.min(c,d,tt)}var LagePathShape=function(){function s(){}return s}(),LargePath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="largeBar",c}return a.prototype.getDefaultShape=function(){return new LagePathShape},a.prototype.buildPath=function(o,c){for(var d=c.points,tt=this.baseDimIdx,nt=1-this.baseDimIdx,it=[],st=[],ut=this.barWidth,ct=0;ct<d.length;ct+=3)st[tt]=ut,st[nt]=d[ct+2],it[tt]=d[ct+tt],it[nt]=d[ct+nt],o.rect(it[0],it[1],st[0],st[1])},a}(Path);function createLarge$1(s,a,o,c){var d=s.getData(),tt=d.getLayout("valueAxisHorizontal")?1:0,nt=d.getLayout("largeDataIndices"),it=d.getLayout("size"),st=s.getModel("backgroundStyle"),ut=d.getLayout("largeBackgroundPoints");if(ut){var ct=new LargePath({shape:{points:ut},incremental:!!c,silent:!0,z2:0});ct.baseDimIdx=tt,ct.largeDataIndices=nt,ct.barWidth=it,ct.useStyle(st.getItemStyle()),a.add(ct),o&&o.push(ct)}var ot=new LargePath({shape:{points:d.getLayout("largePoints")},incremental:!!c,ignoreCoarsePointer:!0,z2:1});ot.baseDimIdx=tt,ot.largeDataIndices=nt,ot.barWidth=it,a.add(ot),ot.useStyle(d.getVisual("style")),ot.style.stroke=null,getECData(ot).seriesIndex=s.seriesIndex,s.get("silent")||(ot.on("mousedown",largePathUpdateDataIndex),ot.on("mousemove",largePathUpdateDataIndex)),o&&o.push(ot)}var largePathUpdateDataIndex=throttle(function(s){var a=this,o=largePathFindDataIndex(a,s.offsetX,s.offsetY);getECData(a).dataIndex=o>=0?o:null},30,!1);function largePathFindDataIndex(s,a,o){for(var c=s.baseDimIdx,d=1-c,tt=s.shape.points,nt=s.largeDataIndices,it=[],st=[],ut=s.barWidth,ct=0,ot=tt.length/3;ct<ot;ct++){var at=ct*3;if(st[c]=ut,st[d]=tt[at+2],it[c]=tt[at+c],it[d]=tt[at+d],st[d]<0&&(it[d]+=st[d],st[d]=-st[d]),a>=it[0]&&a<=it[0]+st[0]&&o>=it[1]&&o<=it[1]+st[1])return nt[ct]}return-1}function createBackgroundShape(s,a,o){if(isCoordinateSystemType(o,"cartesian2d")){var c=a,d=o.getArea();return{x:s?c.x:d.x,y:s?d.y:c.y,width:s?c.width:d.width,height:s?d.height:c.height}}else{var d=o.getArea(),tt=a;return{cx:d.cx,cy:d.cy,r0:s?d.r0:tt.r0,r:s?d.r:tt.r,startAngle:s?tt.startAngle:0,endAngle:s?tt.endAngle:Math.PI*2}}}function createBackgroundEl(s,a,o){var c=s.type==="polar"?Sector:Rect$2;return new c({shape:createBackgroundShape(a,o,s),silent:!0,z2:0})}function install$P(s){s.registerChartView(BarView),s.registerSeriesModel(BarSeriesModel),s.registerLayout(s.PRIORITY.VISUAL.LAYOUT,curry$1(layout$3,"bar")),s.registerLayout(s.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("bar")),s.registerProcessor(s.PRIORITY.PROCESSOR.STATISTIC,dataSample("bar")),s.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(a,o){var c=a.componentType||"series";o.eachComponent({mainType:c,query:a},function(d){a.sortInfo&&d.axis.setCategorySortInfo(a.sortInfo)})})}var PI2=Math.PI*2,RADIAN$2=Math.PI/180;function getViewRect$5(s,a){return getLayoutRect(s.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})}function getBasicPieLayout(s,a){var o=getViewRect$5(s,a),c=s.get("center"),d=s.get("radius");isArray$1(d)||(d=[0,d]);var tt=parsePercent(o.width,a.getWidth()),nt=parsePercent(o.height,a.getHeight()),it=Math.min(tt,nt),st=parsePercent(d[0],it/2),ut=parsePercent(d[1],it/2),ct,ot,at=s.coordinateSystem;if(at){var ht=at.dataToPoint(c);ct=ht[0]||0,ot=ht[1]||0}else isArray$1(c)||(c=[c,c]),ct=parsePercent(c[0],tt)+o.x,ot=parsePercent(c[1],nt)+o.y;return{cx:ct,cy:ot,r0:st,r:ut}}function pieLayout(s,a,o){a.eachSeriesByType(s,function(c){var d=c.getData(),tt=d.mapDimension("value"),nt=getViewRect$5(c,o),it=getBasicPieLayout(c,o),st=it.cx,ut=it.cy,ct=it.r,ot=it.r0,at=-c.get("startAngle")*RADIAN$2,ht=c.get("endAngle"),ft=c.get("padAngle")*RADIAN$2;ht=ht==="auto"?at-PI2:-ht*RADIAN$2;var mt=c.get("minAngle")*RADIAN$2,yt=mt+ft,bt=0;d.each(tt,function(cr){!isNaN(cr)&&bt++});var wt=d.getSum(tt),Tt=Math.PI/(wt||bt)*2,Ct=c.get("clockwise"),Dt=c.get("roseType"),Ot=c.get("stillShowZeroSum"),$t=d.getDataExtent(tt);$t[0]=0;var Ft=Ct?1:-1,kt=[at,ht],Vt=Ft*ft/2;normalizeArcAngles(kt,!Ct),at=kt[0],ht=kt[1];var Ht=getSeriesLayoutData(c);Ht.startAngle=at,Ht.endAngle=ht,Ht.clockwise=Ct;var Qt=Math.abs(ht-at),Xt=Qt,Zt=0,ar=at;if(d.setLayout({viewRect:nt,r:ct}),d.each(tt,function(cr,dr){var mr;if(isNaN(cr)){d.setItemLayout(dr,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:Ct,cx:st,cy:ut,r0:ot,r:Dt?NaN:ct});return}Dt!=="area"?mr=wt===0&&Ot?Tt:cr*Tt:mr=Qt/bt,mr<yt?(mr=yt,Xt-=yt):Zt+=cr;var Dr=ar+Ft*mr,kr=0,Yr=0;ft>mr?(kr=ar+Ft*mr/2,Yr=kr):(kr=ar+Vt,Yr=Dr-Vt),d.setItemLayout(dr,{angle:mr,startAngle:kr,endAngle:Yr,clockwise:Ct,cx:st,cy:ut,r0:ot,r:Dt?linearMap$2(cr,$t,[ot,ct]):ct}),ar=Dr}),Xt<PI2&&bt)if(Xt<=.001){var nr=Qt/bt;d.each(tt,function(cr,dr){if(!isNaN(cr)){var mr=d.getItemLayout(dr);mr.angle=nr;var Dr=0,kr=0;nr<ft?(Dr=at+Ft*(dr+1/2)*nr,kr=Dr):(Dr=at+Ft*dr*nr+Vt,kr=at+Ft*(dr+1)*nr-Vt),mr.startAngle=Dr,mr.endAngle=kr}})}else Tt=Xt/Zt,ar=at,d.each(tt,function(cr,dr){if(!isNaN(cr)){var mr=d.getItemLayout(dr),Dr=mr.angle===yt?yt:cr*Tt,kr=0,Yr=0;Dr<ft?(kr=ar+Ft*Dr/2,Yr=kr):(kr=ar+Vt,Yr=ar+Ft*Dr-Vt),mr.startAngle=kr,mr.endAngle=Yr,ar+=Ft*Dr}})})}var getSeriesLayoutData=makeInner();function dataFilter$1(s){return{seriesType:s,reset:function(a,o){var c=o.findComponents({mainType:"legend"});if(!(!c||!c.length)){var d=a.getData();d.filterSelf(function(tt){for(var nt=d.getName(tt),it=0;it<c.length;it++)if(!c[it].isSelected(nt))return!1;return!0})}}}}var RADIAN$1=Math.PI/180;function adjustSingleSide(s,a,o,c,d,tt,nt,it,st,ut){if(s.length<2)return;function ct(mt){for(var yt=mt.rB,bt=yt*yt,wt=0;wt<mt.list.length;wt++){var Tt=mt.list[wt],Ct=Math.abs(Tt.label.y-o),Dt=c+Tt.len,Ot=Dt*Dt,$t=Math.sqrt(Math.abs((1-Ct*Ct/bt)*Ot)),Ft=a+($t+Tt.len2)*d,kt=Ft-Tt.label.x,Vt=Tt.targetTextWidth-kt*d;constrainTextWidth(Tt,Vt,!0),Tt.label.x=Ft}}function ot(mt){for(var yt={list:[],maxY:0},bt={list:[],maxY:0},wt=0;wt<mt.length;wt++)if(mt[wt].labelAlignTo==="none"){var Tt=mt[wt],Ct=Tt.label.y>o?bt:yt,Dt=Math.abs(Tt.label.y-o);if(Dt>=Ct.maxY){var Ot=Tt.label.x-a-Tt.len2*d,$t=c+Tt.len,Ft=Math.abs(Ot)<$t?Math.sqrt(Dt*Dt/(1-Ot*Ot/$t/$t)):$t;Ct.rB=Ft,Ct.maxY=Dt}Ct.list.push(Tt)}ct(yt),ct(bt)}for(var at=s.length,ht=0;ht<at;ht++)if(s[ht].position==="outer"&&s[ht].labelAlignTo==="labelLine"){var ft=s[ht].label.x-ut;s[ht].linePoints[1][0]+=ft,s[ht].label.x=ut}shiftLayoutOnY(s,st,st+nt)&&ot(s)}function avoidOverlap(s,a,o,c,d,tt,nt,it){for(var st=[],ut=[],ct=Number.MAX_VALUE,ot=-Number.MAX_VALUE,at=0;at<s.length;at++){var ht=s[at].label;isPositionCenter(s[at])||(ht.x<a?(ct=Math.min(ct,ht.x),st.push(s[at])):(ot=Math.max(ot,ht.x),ut.push(s[at])))}for(var at=0;at<s.length;at++){var ft=s[at];if(!isPositionCenter(ft)&&ft.linePoints){if(ft.labelStyleWidth!=null)continue;var ht=ft.label,mt=ft.linePoints,yt=void 0;ft.labelAlignTo==="edge"?ht.x<a?yt=mt[2][0]-ft.labelDistance-nt-ft.edgeDistance:yt=nt+d-ft.edgeDistance-mt[2][0]-ft.labelDistance:ft.labelAlignTo==="labelLine"?ht.x<a?yt=ct-nt-ft.bleedMargin:yt=nt+d-ot-ft.bleedMargin:ht.x<a?yt=ht.x-nt-ft.bleedMargin:yt=nt+d-ht.x-ft.bleedMargin,ft.targetTextWidth=yt,constrainTextWidth(ft,yt)}}adjustSingleSide(ut,a,o,c,1,d,tt,nt,it,ot),adjustSingleSide(st,a,o,c,-1,d,tt,nt,it,ct);for(var at=0;at<s.length;at++){var ft=s[at];if(!isPositionCenter(ft)&&ft.linePoints){var ht=ft.label,mt=ft.linePoints,bt=ft.labelAlignTo==="edge",wt=ht.style.padding,Tt=wt?wt[1]+wt[3]:0,Ct=ht.style.backgroundColor?0:Tt,Dt=ft.rect.width+Ct,Ot=mt[1][0]-mt[2][0];bt?ht.x<a?mt[2][0]=nt+ft.edgeDistance+Dt+ft.labelDistance:mt[2][0]=nt+d-ft.edgeDistance-Dt-ft.labelDistance:(ht.x<a?mt[2][0]=ht.x+ft.labelDistance:mt[2][0]=ht.x-ft.labelDistance,mt[1][0]=mt[2][0]+Ot),mt[1][1]=mt[2][1]=ht.y}}}function constrainTextWidth(s,a,o){if(o===void 0&&(o=!1),s.labelStyleWidth==null){var c=s.label,d=c.style,tt=s.rect,nt=d.backgroundColor,it=d.padding,st=it?it[1]+it[3]:0,ut=d.overflow,ct=tt.width+(nt?0:st);if(a<ct||o){var ot=tt.height;if(ut&&ut.match("break")){c.setStyle("backgroundColor",null),c.setStyle("width",a-st);var at=c.getBoundingRect();c.setStyle("width",Math.ceil(at.width)),c.setStyle("backgroundColor",nt)}else{var ht=a-st,ft=a<ct?ht:o?ht>s.unconstrainedWidth?null:ht:null;c.setStyle("width",ft)}var mt=c.getBoundingRect();tt.width=mt.width;var yt=(c.style.margin||0)+2.1;tt.height=mt.height+yt,tt.y-=(tt.height-ot)/2}}}function isPositionCenter(s){return s.position==="center"}function pieLabelLayout(s){var a=s.getData(),o=[],c,d,tt=!1,nt=(s.get("minShowLabelAngle")||0)*RADIAN$1,it=a.getLayout("viewRect"),st=a.getLayout("r"),ut=it.width,ct=it.x,ot=it.y,at=it.height;function ht(Ot){Ot.ignore=!0}function ft(Ot){if(!Ot.ignore)return!0;for(var $t in Ot.states)if(Ot.states[$t].ignore===!1)return!0;return!1}a.each(function(Ot){var $t=a.getItemGraphicEl(Ot),Ft=$t.shape,kt=$t.getTextContent(),Vt=$t.getTextGuideLine(),Ht=a.getItemModel(Ot),Qt=Ht.getModel("label"),Xt=Qt.get("position")||Ht.get(["emphasis","label","position"]),Zt=Qt.get("distanceToLabelLine"),ar=Qt.get("alignTo"),nr=parsePercent(Qt.get("edgeDistance"),ut),cr=Qt.get("bleedMargin"),dr=Ht.getModel("labelLine"),mr=dr.get("length");mr=parsePercent(mr,ut);var Dr=dr.get("length2");if(Dr=parsePercent(Dr,ut),Math.abs(Ft.endAngle-Ft.startAngle)<nt){each$f(kt.states,ht),kt.ignore=!0,Vt&&(each$f(Vt.states,ht),Vt.ignore=!0);return}if(ft(kt)){var kr=(Ft.startAngle+Ft.endAngle)/2,Yr=Math.cos(kr),Mr=Math.sin(kr),Jr,an,xn,Rn;c=Ft.cx,d=Ft.cy;var hn=Xt==="inside"||Xt==="inner";if(Xt==="center")Jr=Ft.cx,an=Ft.cy,Rn="center";else{var pn=(hn?(Ft.r+Ft.r0)/2*Yr:Ft.r*Yr)+c,yn=(hn?(Ft.r+Ft.r0)/2*Mr:Ft.r*Mr)+d;if(Jr=pn+Yr*3,an=yn+Mr*3,!hn){var un=pn+Yr*(mr+st-Ft.r),fn=yn+Mr*(mr+st-Ft.r),Bn=un+(Yr<0?-1:1)*Dr,Dn=fn;ar==="edge"?Jr=Yr<0?ct+nr:ct+ut-nr:Jr=Bn+(Yr<0?-Zt:Zt),an=Dn,xn=[[pn,yn],[un,fn],[Bn,Dn]]}Rn=hn?"center":ar==="edge"?Yr>0?"right":"left":Yr>0?"left":"right"}var Qn=Math.PI,zr=0,ao=Qt.get("rotate");if(isNumber(ao))zr=ao*(Qn/180);else if(Xt==="center")zr=0;else if(ao==="radial"||ao===!0){var oo=Yr<0?-kr+Qn:-kr;zr=oo}else if(ao==="tangential"&&Xt!=="outside"&&Xt!=="outer"){var Wn=Math.atan2(Yr,Mr);Wn<0&&(Wn=Qn*2+Wn);var no=Mr>0;no&&(Wn=Qn+Wn),zr=Wn-Qn}if(tt=!!zr,kt.x=Jr,kt.y=an,kt.rotation=zr,kt.setStyle({verticalAlign:"middle"}),hn){kt.setStyle({align:Rn});var Mo=kt.states.select;Mo&&(Mo.x+=kt.x,Mo.y+=kt.y)}else{var Eo=kt.getBoundingRect().clone();Eo.applyTransform(kt.getComputedTransform());var xo=(kt.style.margin||0)+2.1;Eo.y-=xo/2,Eo.height+=xo,o.push({label:kt,labelLine:Vt,position:Xt,len:mr,len2:Dr,minTurnAngle:dr.get("minTurnAngle"),maxSurfaceAngle:dr.get("maxSurfaceAngle"),surfaceNormal:new Point(Yr,Mr),linePoints:xn,textAlign:Rn,labelDistance:Zt,labelAlignTo:ar,edgeDistance:nr,bleedMargin:cr,rect:Eo,unconstrainedWidth:Eo.width,labelStyleWidth:kt.style.width})}$t.setTextConfig({inside:hn})}}),!tt&&s.get("avoidLabelOverlap")&&avoidOverlap(o,c,d,st,ut,at,ct,ot);for(var mt=0;mt<o.length;mt++){var yt=o[mt],bt=yt.label,wt=yt.labelLine,Tt=isNaN(bt.x)||isNaN(bt.y);if(bt){bt.setStyle({align:yt.textAlign}),Tt&&(each$f(bt.states,ht),bt.ignore=!0);var Ct=bt.states.select;Ct&&(Ct.x+=bt.x,Ct.y+=bt.y)}if(wt){var Dt=yt.linePoints;Tt||!Dt?(each$f(wt.states,ht),wt.ignore=!0):(limitTurnAngle(Dt,yt.minTurnAngle),limitSurfaceAngle(Dt,yt.surfaceNormal,yt.maxSurfaceAngle),wt.setShape({points:Dt}),bt.__hostTarget.textGuideLineConfig={anchor:new Point(Dt[0][0],Dt[0][1])})}}}var PiePiece=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this)||this;tt.z2=2;var nt=new ZRText;return tt.setTextContent(nt),tt.updateData(o,c,d,!0),tt}return a.prototype.updateData=function(o,c,d,tt){var nt=this,it=o.hostModel,st=o.getItemModel(c),ut=st.getModel("emphasis"),ct=o.getItemLayout(c),ot=extend(getSectorCornerRadius(st.getModel("itemStyle"),ct,!0),ct);if(isNaN(ot.startAngle)){nt.setShape(ot);return}if(tt){nt.setShape(ot);var at=it.getShallow("animationType");it.ecModel.ssr?(initProps(nt,{scaleX:0,scaleY:0},it,{dataIndex:c,isFrom:!0}),nt.originX=ot.cx,nt.originY=ot.cy):at==="scale"?(nt.shape.r=ct.r0,initProps(nt,{shape:{r:ct.r}},it,c)):d!=null?(nt.setShape({startAngle:d,endAngle:d}),initProps(nt,{shape:{startAngle:ct.startAngle,endAngle:ct.endAngle}},it,c)):(nt.shape.endAngle=ct.startAngle,updateProps$1(nt,{shape:{endAngle:ct.endAngle}},it,c))}else saveOldStyle(nt),updateProps$1(nt,{shape:ot},it,c);nt.useStyle(o.getItemVisual(c,"style")),setStatesStylesFromModel(nt,st);var ht=(ct.startAngle+ct.endAngle)/2,ft=it.get("selectedOffset"),mt=Math.cos(ht)*ft,yt=Math.sin(ht)*ft,bt=st.getShallow("cursor");bt&&nt.attr("cursor",bt),this._updateLabel(it,o,c),nt.ensureState("emphasis").shape=extend({r:ct.r+(ut.get("scale")&&ut.get("scaleSize")||0)},getSectorCornerRadius(ut.getModel("itemStyle"),ct)),extend(nt.ensureState("select"),{x:mt,y:yt,shape:getSectorCornerRadius(st.getModel(["select","itemStyle"]),ct)}),extend(nt.ensureState("blur"),{shape:getSectorCornerRadius(st.getModel(["blur","itemStyle"]),ct)});var wt=nt.getTextGuideLine(),Tt=nt.getTextContent();wt&&extend(wt.ensureState("select"),{x:mt,y:yt}),extend(Tt.ensureState("select"),{x:mt,y:yt}),toggleHoverEmphasis(this,ut.get("focus"),ut.get("blurScope"),ut.get("disabled"))},a.prototype._updateLabel=function(o,c,d){var tt=this,nt=c.getItemModel(d),it=nt.getModel("labelLine"),st=c.getItemVisual(d,"style"),ut=st&&st.fill,ct=st&&st.opacity;setLabelStyle(tt,getLabelStatesModels(nt),{labelFetcher:c.hostModel,labelDataIndex:d,inheritColor:ut,defaultOpacity:ct,defaultText:o.getFormattedLabel(d,"normal")||c.getName(d)});var ot=tt.getTextContent();tt.setTextConfig({position:null,rotation:null}),ot.attr({z2:10});var at=o.get(["label","position"]);if(at!=="outside"&&at!=="outer")tt.removeTextGuideLine();else{var ht=this.getTextGuideLine();ht||(ht=new Polyline$1,this.setTextGuideLine(ht)),setLabelLineStyle(this,getLabelLineStatesModels(nt),{stroke:ut,opacity:retrieve3(it.get(["lineStyle","opacity"]),ct,1)})}},a}(Sector),PieView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.ignoreLabelLineUpdate=!0,o}return a.prototype.render=function(o,c,d,tt){var nt=o.getData(),it=this._data,st=this.group,ut;if(!it&&nt.count()>0){for(var ct=nt.getItemLayout(0),ot=1;isNaN(ct&&ct.startAngle)&&ot<nt.count();++ot)ct=nt.getItemLayout(ot);ct&&(ut=ct.startAngle)}if(this._emptyCircleSector&&st.remove(this._emptyCircleSector),nt.count()===0&&o.get("showEmptyCircle")){var at=getSeriesLayoutData(o),ht=new Sector({shape:extend(getBasicPieLayout(o,d),at)});ht.useStyle(o.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=ht,st.add(ht)}nt.diff(it).add(function(ft){var mt=new PiePiece(nt,ft,ut);nt.setItemGraphicEl(ft,mt),st.add(mt)}).update(function(ft,mt){var yt=it.getItemGraphicEl(mt);yt.updateData(nt,ft,ut),yt.off("click"),st.add(yt),nt.setItemGraphicEl(ft,yt)}).remove(function(ft){var mt=it.getItemGraphicEl(ft);removeElementWithFadeOut(mt,o,ft)}).execute(),pieLabelLayout(o),o.get("animationTypeUpdate")!=="expansion"&&(this._data=nt)},a.prototype.dispose=function(){},a.prototype.containPoint=function(o,c){var d=c.getData(),tt=d.getItemLayout(0);if(tt){var nt=o[0]-tt.cx,it=o[1]-tt.cy,st=Math.sqrt(nt*nt+it*it);return st<=tt.r&&st>=tt.r0}},a.type="pie",a}(ChartView);function createSeriesDataSimply(s,a,o){a=isArray$1(a)&&{coordDimensions:a}||extend({encodeDefine:s.getEncode()},a);var c=s.getSource(),d=prepareSeriesDataSchema(c,a).dimensions,tt=new SeriesData(d,s);return tt.initData(c,o),tt}var LegendVisualProvider=function(){function s(a,o){this._getDataWithEncodedVisual=a,this._getRawData=o}return s.prototype.getAllNames=function(){var a=this._getRawData();return a.mapArray(a.getName)},s.prototype.containName=function(a){var o=this._getRawData();return o.indexOfName(a)>=0},s.prototype.indexOfName=function(a){var o=this._getDataWithEncodedVisual();return o.indexOfName(a)},s.prototype.getItemVisual=function(a,o){var c=this._getDataWithEncodedVisual();return c.getItemVisual(a,o)},s}(),innerData=makeInner(),PieSeriesModel=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.init=function(o){s.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$2(this.getData,this),bind$2(this.getRawData,this)),this._defaultLabelLine(o)},a.prototype.mergeOption=function(){s.prototype.mergeOption.apply(this,arguments)},a.prototype.getInitialData=function(){return createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)})},a.prototype.getDataParams=function(o){var c=this.getData(),d=innerData(c),tt=d.seats;if(!tt){var nt=[];c.each(c.mapDimension("value"),function(st){nt.push(st)}),tt=d.seats=getPercentSeats(nt,c.hostModel.get("percentPrecision"))}var it=s.prototype.getDataParams.call(this,o);return it.percent=tt[o]||0,it.$vars.push("percent"),it},a.prototype._defaultLabelLine=function(o){defaultEmphasis(o,"labelLine",["show"]);var c=o.labelLine,d=o.emphasis.labelLine;c.show=c.show&&o.label.show,d.show=d.show&&o.emphasis.label.show},a.type="series.pie",a.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},a}(SeriesModel);function negativeDataFilter(s){return{seriesType:s,reset:function(a,o){var c=a.getData();c.filterSelf(function(d){var tt=c.mapDimension("value"),nt=c.get(tt,d);return!(isNumber(nt)&&!isNaN(nt)&&nt<0)})}}}function install$O(s){s.registerChartView(PieView),s.registerSeriesModel(PieSeriesModel),createLegacyDataSelectAction("pie",s.registerAction),s.registerLayout(curry$1(pieLayout,"pie")),s.registerProcessor(dataFilter$1("pie")),s.registerProcessor(negativeDataFilter("pie"))}var ScatterSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o}return a.prototype.getInitialData=function(o,c){return createSeriesData(null,this,{useEncodeDefaulter:!0})},a.prototype.getProgressive=function(){var o=this.option.progressive;return o??(this.option.large?5e3:this.get("progressive"))},a.prototype.getProgressiveThreshold=function(){var o=this.option.progressiveThreshold;return o??(this.option.large?1e4:this.get("progressiveThreshold"))},a.prototype.brushSelector=function(o,c,d){return d.point(c.getItemLayout(o))},a.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},a.type="series.scatter",a.dependencies=["grid","polar","geo","singleAxis","calendar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},a}(SeriesModel),BOOST_SIZE_THRESHOLD=4,LargeSymbolPathShape=function(){function s(){}return s}(),LargeSymbolPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c._off=0,c.hoverDataIdx=-1,c}return a.prototype.getDefaultShape=function(){return new LargeSymbolPathShape},a.prototype.reset=function(){this.notClear=!1,this._off=0},a.prototype.buildPath=function(o,c){var d=c.points,tt=c.size,nt=this.symbolProxy,it=nt.shape,st=o.getContext?o.getContext():o,ut=st&&tt[0]<BOOST_SIZE_THRESHOLD,ct=this.softClipShape,ot;if(ut){this._ctx=st;return}for(this._ctx=null,ot=this._off;ot<d.length;){var at=d[ot++],ht=d[ot++];isNaN(at)||isNaN(ht)||ct&&!ct.contain(at,ht)||(it.x=at-tt[0]/2,it.y=ht-tt[1]/2,it.width=tt[0],it.height=tt[1],nt.buildPath(o,it,!0))}this.incremental&&(this._off=ot,this.notClear=!0)},a.prototype.afterBrush=function(){var o=this.shape,c=o.points,d=o.size,tt=this._ctx,nt=this.softClipShape,it;if(tt){for(it=this._off;it<c.length;){var st=c[it++],ut=c[it++];isNaN(st)||isNaN(ut)||nt&&!nt.contain(st,ut)||tt.fillRect(st-d[0]/2,ut-d[1]/2,d[0],d[1])}this.incremental&&(this._off=it,this.notClear=!0)}},a.prototype.findDataIndex=function(o,c){for(var d=this.shape,tt=d.points,nt=d.size,it=Math.max(nt[0],4),st=Math.max(nt[1],4),ut=tt.length/2-1;ut>=0;ut--){var ct=ut*2,ot=tt[ct]-it/2,at=tt[ct+1]-st/2;if(o>=ot&&c>=at&&o<=ot+it&&c<=at+st)return ut}return-1},a.prototype.contain=function(o,c){var d=this.transformCoordToLocal(o,c),tt=this.getBoundingRect();if(o=d[0],c=d[1],tt.contain(o,c)){var nt=this.hoverDataIdx=this.findDataIndex(o,c);return nt>=0}return this.hoverDataIdx=-1,!1},a.prototype.getBoundingRect=function(){var o=this._rect;if(!o){for(var c=this.shape,d=c.points,tt=c.size,nt=tt[0],it=tt[1],st=1/0,ut=1/0,ct=-1/0,ot=-1/0,at=0;at<d.length;){var ht=d[at++],ft=d[at++];st=Math.min(ht,st),ct=Math.max(ht,ct),ut=Math.min(ft,ut),ot=Math.max(ft,ot)}o=this._rect=new BoundingRect(st-nt/2,ut-it/2,ct-st+nt,ot-ut+it)}return o},a}(Path),LargeSymbolDraw=function(){function s(){this.group=new Group$3}return s.prototype.updateData=function(a,o){this._clear();var c=this._create();c.setShape({points:a.getLayout("points")}),this._setCommon(c,a,o)},s.prototype.updateLayout=function(a){var o=a.getLayout("points");this.group.eachChild(function(c){if(c.startIndex!=null){var d=(c.endIndex-c.startIndex)*2,tt=c.startIndex*4*2;o=new Float32Array(o.buffer,tt,d)}c.setShape("points",o),c.reset()})},s.prototype.incrementalPrepareUpdate=function(a){this._clear()},s.prototype.incrementalUpdate=function(a,o,c){var d=this._newAdded[0],tt=o.getLayout("points"),nt=d&&d.shape.points;if(nt&&nt.length<2e4){var it=nt.length,st=new Float32Array(it+tt.length);st.set(nt),st.set(tt,it),d.endIndex=a.end,d.setShape({points:st})}else{this._newAdded=[];var ut=this._create();ut.startIndex=a.start,ut.endIndex=a.end,ut.incremental=!0,ut.setShape({points:tt}),this._setCommon(ut,o,c)}},s.prototype.eachRendered=function(a){this._newAdded[0]&&a(this._newAdded[0])},s.prototype._create=function(){var a=new LargeSymbolPath({cursor:"default"});return a.ignoreCoarsePointer=!0,this.group.add(a),this._newAdded.push(a),a},s.prototype._setCommon=function(a,o,c){var d=o.hostModel;c=c||{};var tt=o.getVisual("symbolSize");a.setShape("size",tt instanceof Array?tt:[tt,tt]),a.softClipShape=c.clipShape||null,a.symbolProxy=createSymbol$1(o.getVisual("symbol"),0,0,0,0),a.setColor=a.symbolProxy.setColor;var nt=a.shape.size[0]<BOOST_SIZE_THRESHOLD;a.useStyle(d.getModel("itemStyle").getItemStyle(nt?["color","shadowBlur","shadowColor"]:["color"]));var it=o.getVisual("style"),st=it&&it.fill;st&&a.setColor(st);var ut=getECData(a);ut.seriesIndex=d.seriesIndex,a.on("mousemove",function(ct){ut.dataIndex=null;var ot=a.hoverDataIdx;ot>=0&&(ut.dataIndex=ot+(a.startIndex||0))})},s.prototype.remove=function(){this._clear()},s.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},s}(),ScatterView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this._updateSymbolDraw(tt,o);nt.updateData(tt,{clipShape:this._getClipShape(o)}),this._finished=!0},a.prototype.incrementalPrepareRender=function(o,c,d){var tt=o.getData(),nt=this._updateSymbolDraw(tt,o);nt.incrementalPrepareUpdate(tt),this._finished=!1},a.prototype.incrementalRender=function(o,c,d){this._symbolDraw.incrementalUpdate(o,c.getData(),{clipShape:this._getClipShape(c)}),this._finished=o.end===c.getData().count()},a.prototype.updateTransform=function(o,c,d){var tt=o.getData();if(this.group.dirty(),!this._finished||tt.count()>1e4)return{update:!0};var nt=pointsLayout("").reset(o,c,d);nt.progress&&nt.progress({start:0,end:tt.count(),count:tt.count()},tt),this._symbolDraw.updateLayout(tt)},a.prototype.eachRendered=function(o){this._symbolDraw&&this._symbolDraw.eachRendered(o)},a.prototype._getClipShape=function(o){if(o.get("clip",!0)){var c=o.coordinateSystem;return c&&c.getArea&&c.getArea(.1)}},a.prototype._updateSymbolDraw=function(o,c){var d=this._symbolDraw,tt=c.pipelineContext,nt=tt.large;return(!d||nt!==this._isLargeDraw)&&(d&&d.remove(),d=this._symbolDraw=nt?new LargeSymbolDraw:new SymbolDraw,this._isLargeDraw=nt,this.group.removeAll()),this.group.add(d.group),d},a.prototype.remove=function(o,c){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},a.prototype.dispose=function(){},a.type="scatter",a}(ChartView),GridModel=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.type="grid",a.dependencies=["xAxis","yAxis"],a.layoutMode="box",a.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},a}(ComponentModel),CartesianAxisModel=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",SINGLE_REFERRING).models[0]},a.type="cartesian2dAxis",a}(ComponentModel);mixin(CartesianAxisModel,AxisModelCommonMixin);var defaultOption$1={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},categoryAxis=merge({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},defaultOption$1),valueAxis=merge({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},defaultOption$1),timeAxis=merge({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},valueAxis),logAxis=defaults({logBase:10},valueAxis);const axisDefault={category:categoryAxis,value:valueAxis,time:timeAxis,log:logAxis};var AXIS_TYPES={value:1,category:1,time:1,log:1};function axisModelCreator(s,a,o,c){each$f(AXIS_TYPES,function(d,tt){var nt=merge(merge({},axisDefault[tt],!0),c,!0),it=function(st){__extends$1(ut,st);function ut(){var ct=st!==null&&st.apply(this,arguments)||this;return ct.type=a+"Axis."+tt,ct}return ut.prototype.mergeDefaultAndTheme=function(ct,ot){var at=fetchLayoutMode(this),ht=at?getLayoutParams(ct):{},ft=ot.getTheme();merge(ct,ft.get(tt+"Axis")),merge(ct,this.getDefaultOption()),ct.type=getAxisType(ct),at&&mergeLayoutParam(ct,ht,at)},ut.prototype.optionUpdated=function(){var ct=this.option;ct.type==="category"&&(this.__ordinalMeta=OrdinalMeta.createByAxisModel(this))},ut.prototype.getCategories=function(ct){var ot=this.option;if(ot.type==="category")return ct?ot.data:this.__ordinalMeta.categories},ut.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},ut.type=a+"Axis."+tt,ut.defaultOption=nt,ut}(o);s.registerComponentModel(it)}),s.registerSubTypeDefaulter(a+"Axis",getAxisType)}function getAxisType(s){return s.type||(s.data?"category":"value")}var Cartesian=function(){function s(a){this.type="cartesian",this._dimList=[],this._axes={},this.name=a||""}return s.prototype.getAxis=function(a){return this._axes[a]},s.prototype.getAxes=function(){return map$1(this._dimList,function(a){return this._axes[a]},this)},s.prototype.getAxesByScale=function(a){return a=a.toLowerCase(),filter(this.getAxes(),function(o){return o.scale.type===a})},s.prototype.addAxis=function(a){var o=a.dim;this._axes[o]=a,this._dimList.push(o)},s}(),cartesian2DDimensions=["x","y"];function canCalculateAffineTransform(s){return s.type==="interval"||s.type==="time"}var Cartesian2D=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="cartesian2d",o.dimensions=cartesian2DDimensions,o}return a.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var o=this.getAxis("x").scale,c=this.getAxis("y").scale;if(!(!canCalculateAffineTransform(o)||!canCalculateAffineTransform(c))){var d=o.getExtent(),tt=c.getExtent(),nt=this.dataToPoint([d[0],tt[0]]),it=this.dataToPoint([d[1],tt[1]]),st=d[1]-d[0],ut=tt[1]-tt[0];if(!(!st||!ut)){var ct=(it[0]-nt[0])/st,ot=(it[1]-nt[1])/ut,at=nt[0]-d[0]*ct,ht=nt[1]-tt[0]*ot,ft=this._transform=[ct,0,0,ot,at,ht];this._invTransform=invert([],ft)}}},a.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},a.prototype.containPoint=function(o){var c=this.getAxis("x"),d=this.getAxis("y");return c.contain(c.toLocalCoord(o[0]))&&d.contain(d.toLocalCoord(o[1]))},a.prototype.containData=function(o){return this.getAxis("x").containData(o[0])&&this.getAxis("y").containData(o[1])},a.prototype.containZone=function(o,c){var d=this.dataToPoint(o),tt=this.dataToPoint(c),nt=this.getArea(),it=new BoundingRect(d[0],d[1],tt[0]-d[0],tt[1]-d[1]);return nt.intersect(it)},a.prototype.dataToPoint=function(o,c,d){d=d||[];var tt=o[0],nt=o[1];if(this._transform&&tt!=null&&isFinite(tt)&&nt!=null&&isFinite(nt))return applyTransform$1(d,o,this._transform);var it=this.getAxis("x"),st=this.getAxis("y");return d[0]=it.toGlobalCoord(it.dataToCoord(tt,c)),d[1]=st.toGlobalCoord(st.dataToCoord(nt,c)),d},a.prototype.clampData=function(o,c){var d=this.getAxis("x").scale,tt=this.getAxis("y").scale,nt=d.getExtent(),it=tt.getExtent(),st=d.parse(o[0]),ut=tt.parse(o[1]);return c=c||[],c[0]=Math.min(Math.max(Math.min(nt[0],nt[1]),st),Math.max(nt[0],nt[1])),c[1]=Math.min(Math.max(Math.min(it[0],it[1]),ut),Math.max(it[0],it[1])),c},a.prototype.pointToData=function(o,c){var d=[];if(this._invTransform)return applyTransform$1(d,o,this._invTransform);var tt=this.getAxis("x"),nt=this.getAxis("y");return d[0]=tt.coordToData(tt.toLocalCoord(o[0]),c),d[1]=nt.coordToData(nt.toLocalCoord(o[1]),c),d},a.prototype.getOtherAxis=function(o){return this.getAxis(o.dim==="x"?"y":"x")},a.prototype.getArea=function(o){o=o||0;var c=this.getAxis("x").getGlobalExtent(),d=this.getAxis("y").getGlobalExtent(),tt=Math.min(c[0],c[1])-o,nt=Math.min(d[0],d[1])-o,it=Math.max(c[0],c[1])-tt+o,st=Math.max(d[0],d[1])-nt+o;return new BoundingRect(tt,nt,it,st)},a}(Cartesian),Axis2D=function(s){__extends$1(a,s);function a(o,c,d,tt,nt){var it=s.call(this,o,c,d)||this;return it.index=0,it.type=tt||"value",it.position=nt||"bottom",it}return a.prototype.isHorizontal=function(){var o=this.position;return o==="top"||o==="bottom"},a.prototype.getGlobalExtent=function(o){var c=this.getExtent();return c[0]=this.toGlobalCoord(c[0]),c[1]=this.toGlobalCoord(c[1]),o&&c[0]>c[1]&&c.reverse(),c},a.prototype.pointToData=function(o,c){return this.coordToData(this.toLocalCoord(o[this.dim==="x"?0:1]),c)},a.prototype.setCategorySortInfo=function(o){if(this.type!=="category")return!1;this.model.option.categorySortInfo=o,this.scale.setSortInfo(o)},a}(Axis);function layout$2(s,a,o){o=o||{};var c=s.coordinateSystem,d=a.axis,tt={},nt=d.getAxesOnZeroOf()[0],it=d.position,st=nt?"onZero":it,ut=d.dim,ct=c.getRect(),ot=[ct.x,ct.x+ct.width,ct.y,ct.y+ct.height],at={left:0,right:1,top:0,bottom:1,onZero:2},ht=a.get("offset")||0,ft=ut==="x"?[ot[2]-ht,ot[3]+ht]:[ot[0]-ht,ot[1]+ht];if(nt){var mt=nt.toGlobalCoord(nt.dataToCoord(0));ft[at.onZero]=Math.max(Math.min(mt,ft[1]),ft[0])}tt.position=[ut==="y"?ft[at[st]]:ot[0],ut==="x"?ft[at[st]]:ot[3]],tt.rotation=Math.PI/2*(ut==="x"?0:1);var yt={top:-1,bottom:1,left:-1,right:1};tt.labelDirection=tt.tickDirection=tt.nameDirection=yt[it],tt.labelOffset=nt?ft[at[it]]-ft[at.onZero]:0,a.get(["axisTick","inside"])&&(tt.tickDirection=-tt.tickDirection),retrieve(o.labelInside,a.get(["axisLabel","inside"]))&&(tt.labelDirection=-tt.labelDirection);var bt=a.get(["axisLabel","rotate"]);return tt.labelRotate=st==="top"?-bt:bt,tt.z2=1,tt}function isCartesian2DSeries(s){return s.get("coordinateSystem")==="cartesian2d"}function findAxisModels(s){var a={xAxisModel:null,yAxisModel:null};return each$f(a,function(o,c){var d=c.replace(/Model$/,""),tt=s.getReferringComponents(d,SINGLE_REFERRING).models[0];a[c]=tt}),a}var mathLog=Math.log;function alignScaleTicks(s,a,o){var c=IntervalScale.prototype,d=c.getTicks.call(o),tt=c.getTicks.call(o,!0),nt=d.length-1,it=c.getInterval.call(o),st=getScaleExtent(s,a),ut=st.extent,ct=st.fixMin,ot=st.fixMax;if(s.type==="log"){var at=mathLog(s.base);ut=[mathLog(ut[0])/at,mathLog(ut[1])/at]}s.setExtent(ut[0],ut[1]),s.calcNiceExtent({splitNumber:nt,fixMin:ct,fixMax:ot});var ht=c.getExtent.call(s);ct&&(ut[0]=ht[0]),ot&&(ut[1]=ht[1]);var ft=c.getInterval.call(s),mt=ut[0],yt=ut[1];if(ct&&ot)ft=(yt-mt)/nt;else if(ct)for(yt=ut[0]+ft*nt;yt<ut[1]&&isFinite(yt)&&isFinite(ut[1]);)ft=increaseInterval(ft),yt=ut[0]+ft*nt;else if(ot)for(mt=ut[1]-ft*nt;mt>ut[0]&&isFinite(mt)&&isFinite(ut[0]);)ft=increaseInterval(ft),mt=ut[1]-ft*nt;else{var bt=s.getTicks().length-1;bt>nt&&(ft=increaseInterval(ft));var wt=ft*nt;yt=Math.ceil(ut[1]/ft)*ft,mt=round$3(yt-wt),mt<0&&ut[0]>=0?(mt=0,yt=round$3(wt)):yt>0&&ut[1]<=0&&(yt=0,mt=-round$3(wt))}var Tt=(d[0].value-tt[0].value)/it,Ct=(d[nt].value-tt[nt].value)/it;c.setExtent.call(s,mt+ft*Tt,yt+ft*Ct),c.setInterval.call(s,ft),(Tt||Ct)&&c.setNiceExtent.call(s,mt+ft,yt-ft)}var Grid=function(){function s(a,o,c){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=cartesian2DDimensions,this._initCartesian(a,o,c),this.model=a}return s.prototype.getRect=function(){return this._rect},s.prototype.update=function(a,o){var c=this._axesMap;this._updateScale(a,this.model);function d(nt){var it,st=keys(nt),ut=st.length;if(ut){for(var ct=[],ot=ut-1;ot>=0;ot--){var at=+st[ot],ht=nt[at],ft=ht.model,mt=ht.scale;isIntervalOrLogScale(mt)&&ft.get("alignTicks")&&ft.get("interval")==null?ct.push(ht):(niceScaleExtent(mt,ft),isIntervalOrLogScale(mt)&&(it=ht))}ct.length&&(it||(it=ct.pop(),niceScaleExtent(it.scale,it.model)),each$f(ct,function(yt){alignScaleTicks(yt.scale,yt.model,it.scale)}))}}d(c.x),d(c.y);var tt={};each$f(c.x,function(nt){fixAxisOnZero(c,"y",nt,tt)}),each$f(c.y,function(nt){fixAxisOnZero(c,"x",nt,tt)}),this.resize(this.model,o)},s.prototype.resize=function(a,o,c){var d=a.getBoxLayoutParams(),tt=!c&&a.get("containLabel"),nt=getLayoutRect(d,{width:o.getWidth(),height:o.getHeight()});this._rect=nt;var it=this._axesList;st(),tt&&(each$f(it,function(ut){if(!ut.model.get(["axisLabel","inside"])){var ct=estimateLabelUnionRect(ut);if(ct){var ot=ut.isHorizontal()?"height":"width",at=ut.model.get(["axisLabel","margin"]);nt[ot]-=ct[ot]+at,ut.position==="top"?nt.y+=ct.height+at:ut.position==="left"&&(nt.x+=ct.width+at)}}}),st()),each$f(this._coordsList,function(ut){ut.calcAffineTransform()});function st(){each$f(it,function(ut){var ct=ut.isHorizontal(),ot=ct?[0,nt.width]:[0,nt.height],at=ut.inverse?1:0;ut.setExtent(ot[at],ot[1-at]),updateAxisTransform(ut,ct?nt.x:nt.y)})}},s.prototype.getAxis=function(a,o){var c=this._axesMap[a];if(c!=null)return c[o||0]},s.prototype.getAxes=function(){return this._axesList.slice()},s.prototype.getCartesian=function(a,o){if(a!=null&&o!=null){var c="x"+a+"y"+o;return this._coordsMap[c]}isObject$3(a)&&(o=a.yAxisIndex,a=a.xAxisIndex);for(var d=0,tt=this._coordsList;d<tt.length;d++)if(tt[d].getAxis("x").index===a||tt[d].getAxis("y").index===o)return tt[d]},s.prototype.getCartesians=function(){return this._coordsList.slice()},s.prototype.convertToPixel=function(a,o,c){var d=this._findConvertTarget(o);return d.cartesian?d.cartesian.dataToPoint(c):d.axis?d.axis.toGlobalCoord(d.axis.dataToCoord(c)):null},s.prototype.convertFromPixel=function(a,o,c){var d=this._findConvertTarget(o);return d.cartesian?d.cartesian.pointToData(c):d.axis?d.axis.coordToData(d.axis.toLocalCoord(c)):null},s.prototype._findConvertTarget=function(a){var o=a.seriesModel,c=a.xAxisModel||o&&o.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],d=a.yAxisModel||o&&o.getReferringComponents("yAxis",SINGLE_REFERRING).models[0],tt=a.gridModel,nt=this._coordsList,it,st;if(o)it=o.coordinateSystem,indexOf(nt,it)<0&&(it=null);else if(c&&d)it=this.getCartesian(c.componentIndex,d.componentIndex);else if(c)st=this.getAxis("x",c.componentIndex);else if(d)st=this.getAxis("y",d.componentIndex);else if(tt){var ut=tt.coordinateSystem;ut===this&&(it=this._coordsList[0])}return{cartesian:it,axis:st}},s.prototype.containPoint=function(a){var o=this._coordsList[0];if(o)return o.containPoint(a)},s.prototype._initCartesian=function(a,o,c){var d=this,tt=this,nt={left:!1,right:!1,top:!1,bottom:!1},it={x:{},y:{}},st={x:0,y:0};if(o.eachComponent("xAxis",ut("x"),this),o.eachComponent("yAxis",ut("y"),this),!st.x||!st.y){this._axesMap={},this._axesList=[];return}this._axesMap=it,each$f(it.x,function(ct,ot){each$f(it.y,function(at,ht){var ft="x"+ot+"y"+ht,mt=new Cartesian2D(ft);mt.master=d,mt.model=a,d._coordsMap[ft]=mt,d._coordsList.push(mt),mt.addAxis(ct),mt.addAxis(at)})});function ut(ct){return function(ot,at){if(isAxisUsedInTheGrid(ot,a)){var ht=ot.get("position");ct==="x"?ht!=="top"&&ht!=="bottom"&&(ht=nt.bottom?"top":"bottom"):ht!=="left"&&ht!=="right"&&(ht=nt.left?"right":"left"),nt[ht]=!0;var ft=new Axis2D(ct,createScaleByModel$1(ot),[0,0],ot.get("type"),ht),mt=ft.type==="category";ft.onBand=mt&&ot.get("boundaryGap"),ft.inverse=ot.get("inverse"),ot.axis=ft,ft.model=ot,ft.grid=tt,ft.index=at,tt._axesList.push(ft),it[ct][at]=ft,st[ct]++}}}},s.prototype._updateScale=function(a,o){each$f(this._axesList,function(d){if(d.scale.setExtent(1/0,-1/0),d.type==="category"){var tt=d.model.get("categorySortInfo");d.scale.setSortInfo(tt)}}),a.eachSeries(function(d){if(isCartesian2DSeries(d)){var tt=findAxisModels(d),nt=tt.xAxisModel,it=tt.yAxisModel;if(!isAxisUsedInTheGrid(nt,o)||!isAxisUsedInTheGrid(it,o))return;var st=this.getCartesian(nt.componentIndex,it.componentIndex),ut=d.getData(),ct=st.getAxis("x"),ot=st.getAxis("y");c(ut,ct),c(ut,ot)}},this);function c(d,tt){each$f(getDataDimensionsOnAxis(d,tt.dim),function(nt){tt.scale.unionExtentFromData(d,nt)})}},s.prototype.getTooltipAxes=function(a){var o=[],c=[];return each$f(this.getCartesians(),function(d){var tt=a!=null&&a!=="auto"?d.getAxis(a):d.getBaseAxis(),nt=d.getOtherAxis(tt);indexOf(o,tt)<0&&o.push(tt),indexOf(c,nt)<0&&c.push(nt)}),{baseAxes:o,otherAxes:c}},s.create=function(a,o){var c=[];return a.eachComponent("grid",function(d,tt){var nt=new s(d,a,o);nt.name="grid_"+tt,nt.resize(d,o,!0),d.coordinateSystem=nt,c.push(nt)}),a.eachSeries(function(d){if(isCartesian2DSeries(d)){var tt=findAxisModels(d),nt=tt.xAxisModel,it=tt.yAxisModel,st=nt.getCoordSysModel(),ut=st.coordinateSystem;d.coordinateSystem=ut.getCartesian(nt.componentIndex,it.componentIndex)}}),c},s.dimensions=cartesian2DDimensions,s}();function isAxisUsedInTheGrid(s,a){return s.getCoordSysModel()===a}function fixAxisOnZero(s,a,o,c){o.getAxesOnZeroOf=function(){return tt?[tt]:[]};var d=s[a],tt,nt=o.model,it=nt.get(["axisLine","onZero"]),st=nt.get(["axisLine","onZeroAxisIndex"]);if(!it)return;if(st!=null)canOnZeroToAxis(d[st])&&(tt=d[st]);else for(var ut in d)if(d.hasOwnProperty(ut)&&canOnZeroToAxis(d[ut])&&!c[ct(d[ut])]){tt=d[ut];break}tt&&(c[ct(tt)]=!0);function ct(ot){return ot.dim+"_"+ot.index}}function canOnZeroToAxis(s){return s&&s.type!=="category"&&s.type!=="time"&&ifAxisCrossZero(s)}function updateAxisTransform(s,a){var o=s.getExtent(),c=o[0]+o[1];s.toGlobalCoord=s.dim==="x"?function(d){return d+a}:function(d){return c-d+a},s.toLocalCoord=s.dim==="x"?function(d){return d-a}:function(d){return c-d+a}}var PI$3=Math.PI,AxisBuilder=function(){function s(a,o){this.group=new Group$3,this.opt=o,this.axisModel=a,defaults(o,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var c=new Group$3({x:o.position[0],y:o.position[1],rotation:o.rotation});c.updateTransform(),this._transformGroup=c}return s.prototype.hasBuilder=function(a){return!!builders[a]},s.prototype.add=function(a){builders[a](this.opt,this.axisModel,this.group,this._transformGroup)},s.prototype.getGroup=function(){return this.group},s.innerTextLayout=function(a,o,c){var d=remRadian(o-a),tt,nt;return isRadianAroundZero(d)?(nt=c>0?"top":"bottom",tt="center"):isRadianAroundZero(d-PI$3)?(nt=c>0?"bottom":"top",tt="center"):(nt="middle",d>0&&d<PI$3?tt=c>0?"right":"left":tt=c>0?"left":"right"),{rotation:d,textAlign:tt,textVerticalAlign:nt}},s.makeAxisEventDataBase=function(a){var o={componentType:a.mainType,componentIndex:a.componentIndex};return o[a.mainType+"Index"]=a.componentIndex,o},s.isLabelSilent=function(a){var o=a.get("tooltip");return a.get("silent")||!(a.get("triggerEvent")||o&&o.show)},s}(),builders={axisLine:function(s,a,o,c){var d=a.get(["axisLine","show"]);if(d==="auto"&&s.handleAutoShown&&(d=s.handleAutoShown("axisLine")),!!d){var tt=a.axis.getExtent(),nt=c.transform,it=[tt[0],0],st=[tt[1],0],ut=it[0]>st[0];nt&&(applyTransform$1(it,it,nt),applyTransform$1(st,st,nt));var ct=extend({lineCap:"round"},a.getModel(["axisLine","lineStyle"]).getLineStyle()),ot=new Line$1({shape:{x1:it[0],y1:it[1],x2:st[0],y2:st[1]},style:ct,strokeContainThreshold:s.strokeContainThreshold||5,silent:!0,z2:1});subPixelOptimizeLine(ot.shape,ot.style.lineWidth),ot.anid="line",o.add(ot);var at=a.get(["axisLine","symbol"]);if(at!=null){var ht=a.get(["axisLine","symbolSize"]);isString$1(at)&&(at=[at,at]),(isString$1(ht)||isNumber(ht))&&(ht=[ht,ht]);var ft=normalizeSymbolOffset(a.get(["axisLine","symbolOffset"])||0,ht),mt=ht[0],yt=ht[1];each$f([{rotate:s.rotation+Math.PI/2,offset:ft[0],r:0},{rotate:s.rotation-Math.PI/2,offset:ft[1],r:Math.sqrt((it[0]-st[0])*(it[0]-st[0])+(it[1]-st[1])*(it[1]-st[1]))}],function(bt,wt){if(at[wt]!=="none"&&at[wt]!=null){var Tt=createSymbol$1(at[wt],-mt/2,-yt/2,mt,yt,ct.stroke,!0),Ct=bt.r+bt.offset,Dt=ut?st:it;Tt.attr({rotation:bt.rotate,x:Dt[0]+Ct*Math.cos(s.rotation),y:Dt[1]-Ct*Math.sin(s.rotation),silent:!0,z2:11}),o.add(Tt)}})}}},axisTickLabel:function(s,a,o,c){var d=buildAxisMajorTicks(o,c,a,s),tt=buildAxisLabel(o,c,a,s);if(fixMinMaxLabelShow(a,tt,d),buildAxisMinorTicks(o,c,a,s.tickDirection),a.get(["axisLabel","hideOverlap"])){var nt=prepareLayoutList(map$1(tt,function(it){return{label:it,priority:it.z2,defaultAttr:{ignore:it.ignore}}}));hideOverlap(nt)}},axisName:function(s,a,o,c){var d=retrieve(s.axisName,a.get("name"));if(d){var tt=a.get("nameLocation"),nt=s.nameDirection,it=a.getModel("nameTextStyle"),st=a.get("nameGap")||0,ut=a.axis.getExtent(),ct=ut[0]>ut[1]?-1:1,ot=[tt==="start"?ut[0]-ct*st:tt==="end"?ut[1]+ct*st:(ut[0]+ut[1])/2,isNameLocationCenter(tt)?s.labelOffset+nt*st:0],at,ht=a.get("nameRotate");ht!=null&&(ht=ht*PI$3/180);var ft;isNameLocationCenter(tt)?at=AxisBuilder.innerTextLayout(s.rotation,ht??s.rotation,nt):(at=endTextLayout(s.rotation,tt,ht||0,ut),ft=s.axisNameAvailableWidth,ft!=null&&(ft=Math.abs(ft/Math.sin(at.rotation)),!isFinite(ft)&&(ft=null)));var mt=it.getFont(),yt=a.get("nameTruncate",!0)||{},bt=yt.ellipsis,wt=retrieve(s.nameTruncateMaxWidth,yt.maxWidth,ft),Tt=new ZRText({x:ot[0],y:ot[1],rotation:at.rotation,silent:AxisBuilder.isLabelSilent(a),style:createTextStyle$1(it,{text:d,font:mt,overflow:"truncate",width:wt,ellipsis:bt,fill:it.getTextColor()||a.get(["axisLine","lineStyle","color"]),align:it.get("align")||at.textAlign,verticalAlign:it.get("verticalAlign")||at.textVerticalAlign}),z2:1});if(setTooltipConfig({el:Tt,componentModel:a,itemName:d}),Tt.__fullText=d,Tt.anid="name",a.get("triggerEvent")){var Ct=AxisBuilder.makeAxisEventDataBase(a);Ct.targetType="axisName",Ct.name=d,getECData(Tt).eventData=Ct}c.add(Tt),Tt.updateTransform(),o.add(Tt),Tt.decomposeTransform()}}};function endTextLayout(s,a,o,c){var d=remRadian(o-s),tt,nt,it=c[0]>c[1],st=a==="start"&&!it||a!=="start"&&it;return isRadianAroundZero(d-PI$3/2)?(nt=st?"bottom":"top",tt="center"):isRadianAroundZero(d-PI$3*1.5)?(nt=st?"top":"bottom",tt="center"):(nt="middle",d<PI$3*1.5&&d>PI$3/2?tt=st?"left":"right":tt=st?"right":"left"),{rotation:d,textAlign:tt,textVerticalAlign:nt}}function fixMinMaxLabelShow(s,a,o){if(!shouldShowAllLabels(s.axis)){var c=s.get(["axisLabel","showMinLabel"]),d=s.get(["axisLabel","showMaxLabel"]);a=a||[],o=o||[];var tt=a[0],nt=a[1],it=a[a.length-1],st=a[a.length-2],ut=o[0],ct=o[1],ot=o[o.length-1],at=o[o.length-2];c===!1?(ignoreEl(tt),ignoreEl(ut)):isTwoLabelOverlapped(tt,nt)&&(c?(ignoreEl(nt),ignoreEl(ct)):(ignoreEl(tt),ignoreEl(ut))),d===!1?(ignoreEl(it),ignoreEl(ot)):isTwoLabelOverlapped(st,it)&&(d?(ignoreEl(st),ignoreEl(at)):(ignoreEl(it),ignoreEl(ot)))}}function ignoreEl(s){s&&(s.ignore=!0)}function isTwoLabelOverlapped(s,a){var o=s&&s.getBoundingRect().clone(),c=a&&a.getBoundingRect().clone();if(!(!o||!c)){var d=identity([]);return rotate$1(d,d,-s.rotation),o.applyTransform(mul([],d,s.getLocalTransform())),c.applyTransform(mul([],d,a.getLocalTransform())),o.intersect(c)}}function isNameLocationCenter(s){return s==="middle"||s==="center"}function createTicks(s,a,o,c,d){for(var tt=[],nt=[],it=[],st=0;st<s.length;st++){var ut=s[st].coord;nt[0]=ut,nt[1]=0,it[0]=ut,it[1]=o,a&&(applyTransform$1(nt,nt,a),applyTransform$1(it,it,a));var ct=new Line$1({shape:{x1:nt[0],y1:nt[1],x2:it[0],y2:it[1]},style:c,z2:2,autoBatch:!0,silent:!0});subPixelOptimizeLine(ct.shape,ct.style.lineWidth),ct.anid=d+"_"+s[st].tickValue,tt.push(ct)}return tt}function buildAxisMajorTicks(s,a,o,c){var d=o.axis,tt=o.getModel("axisTick"),nt=tt.get("show");if(nt==="auto"&&c.handleAutoShown&&(nt=c.handleAutoShown("axisTick")),!(!nt||d.scale.isBlank())){for(var it=tt.getModel("lineStyle"),st=c.tickDirection*tt.get("length"),ut=d.getTicksCoords(),ct=createTicks(ut,a.transform,st,defaults(it.getLineStyle(),{stroke:o.get(["axisLine","lineStyle","color"])}),"ticks"),ot=0;ot<ct.length;ot++)s.add(ct[ot]);return ct}}function buildAxisMinorTicks(s,a,o,c){var d=o.axis,tt=o.getModel("minorTick");if(!(!tt.get("show")||d.scale.isBlank())){var nt=d.getMinorTicksCoords();if(nt.length)for(var it=tt.getModel("lineStyle"),st=c*tt.get("length"),ut=defaults(it.getLineStyle(),defaults(o.getModel("axisTick").getLineStyle(),{stroke:o.get(["axisLine","lineStyle","color"])})),ct=0;ct<nt.length;ct++)for(var ot=createTicks(nt[ct],a.transform,st,ut,"minorticks_"+ct),at=0;at<ot.length;at++)s.add(ot[at])}}function buildAxisLabel(s,a,o,c){var d=o.axis,tt=retrieve(c.axisLabelShow,o.get(["axisLabel","show"]));if(!(!tt||d.scale.isBlank())){var nt=o.getModel("axisLabel"),it=nt.get("margin"),st=d.getViewLabels(),ut=(retrieve(c.labelRotate,nt.get("rotate"))||0)*PI$3/180,ct=AxisBuilder.innerTextLayout(c.rotation,ut,c.labelDirection),ot=o.getCategories&&o.getCategories(!0),at=[],ht=AxisBuilder.isLabelSilent(o),ft=o.get("triggerEvent");return each$f(st,function(mt,yt){var bt=d.scale.type==="ordinal"?d.scale.getRawOrdinalNumber(mt.tickValue):mt.tickValue,wt=mt.formattedLabel,Tt=mt.rawLabel,Ct=nt;if(ot&&ot[bt]){var Dt=ot[bt];isObject$3(Dt)&&Dt.textStyle&&(Ct=new Model(Dt.textStyle,nt,o.ecModel))}var Ot=Ct.getTextColor()||o.get(["axisLine","lineStyle","color"]),$t=d.dataToCoord(bt),Ft=Ct.getShallow("align",!0)||ct.textAlign,kt=retrieve2(Ct.getShallow("alignMinLabel",!0),Ft),Vt=retrieve2(Ct.getShallow("alignMaxLabel",!0),Ft),Ht=Ct.getShallow("verticalAlign",!0)||Ct.getShallow("baseline",!0)||ct.textVerticalAlign,Qt=retrieve2(Ct.getShallow("verticalAlignMinLabel",!0),Ht),Xt=retrieve2(Ct.getShallow("verticalAlignMaxLabel",!0),Ht),Zt=new ZRText({x:$t,y:c.labelOffset+c.labelDirection*it,rotation:ct.rotation,silent:ht,z2:10+(mt.level||0),style:createTextStyle$1(Ct,{text:wt,align:yt===0?kt:yt===st.length-1?Vt:Ft,verticalAlign:yt===0?Qt:yt===st.length-1?Xt:Ht,fill:isFunction$1(Ot)?Ot(d.type==="category"?Tt:d.type==="value"?bt+"":bt,yt):Ot})});if(Zt.anid="label_"+bt,setTooltipConfig({el:Zt,componentModel:o,itemName:wt,formatterParamsExtra:{isTruncated:function(){return Zt.isTruncated},value:Tt,tickIndex:yt}}),ft){var ar=AxisBuilder.makeAxisEventDataBase(o);ar.targetType="axisLabel",ar.value=Tt,ar.tickIndex=yt,d.type==="category"&&(ar.dataIndex=bt),getECData(Zt).eventData=ar}a.add(Zt),Zt.updateTransform(),at.push(Zt),s.add(Zt),Zt.decomposeTransform()}),at}}function collect(s,a){var o={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return collectAxesInfo(o,s,a),o.seriesInvolved&&collectSeriesInfo(o,s),o}function collectAxesInfo(s,a,o){var c=a.getComponent("tooltip"),d=a.getComponent("axisPointer"),tt=d.get("link",!0)||[],nt=[];each$f(o.getCoordinateSystems(),function(it){if(!it.axisPointerEnabled)return;var st=makeKey(it.model),ut=s.coordSysAxesInfo[st]={};s.coordSysMap[st]=it;var ct=it.model,ot=ct.getModel("tooltip",c);if(each$f(it.getAxes(),curry$1(mt,!1,null)),it.getTooltipAxes&&c&&ot.get("show")){var at=ot.get("trigger")==="axis",ht=ot.get(["axisPointer","type"])==="cross",ft=it.getTooltipAxes(ot.get(["axisPointer","axis"]));(at||ht)&&each$f(ft.baseAxes,curry$1(mt,ht?"cross":!0,at)),ht&&each$f(ft.otherAxes,curry$1(mt,"cross",!1))}function mt(yt,bt,wt){var Tt=wt.model.getModel("axisPointer",d),Ct=Tt.get("show");if(!(!Ct||Ct==="auto"&&!yt&&!isHandleTrigger(Tt))){bt==null&&(bt=Tt.get("triggerTooltip")),Tt=yt?makeAxisPointerModel(wt,ot,d,a,yt,bt):Tt;var Dt=Tt.get("snap"),Ot=Tt.get("triggerEmphasis"),$t=makeKey(wt.model),Ft=bt||Dt||wt.type==="category",kt=s.axesInfo[$t]={key:$t,axis:wt,coordSys:it,axisPointerModel:Tt,triggerTooltip:bt,triggerEmphasis:Ot,involveSeries:Ft,snap:Dt,useHandle:isHandleTrigger(Tt),seriesModels:[],linkGroup:null};ut[$t]=kt,s.seriesInvolved=s.seriesInvolved||Ft;var Vt=getLinkGroupIndex(tt,wt);if(Vt!=null){var Ht=nt[Vt]||(nt[Vt]={axesInfo:{}});Ht.axesInfo[$t]=kt,Ht.mapper=tt[Vt].mapper,kt.linkGroup=Ht}}}})}function makeAxisPointerModel(s,a,o,c,d,tt){var nt=a.getModel("axisPointer"),it=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],st={};each$f(it,function(at){st[at]=clone$4(nt.get(at))}),st.snap=s.type!=="category"&&!!tt,nt.get("type")==="cross"&&(st.type="line");var ut=st.label||(st.label={});if(ut.show==null&&(ut.show=!1),d==="cross"){var ct=nt.get(["label","show"]);if(ut.show=ct??!0,!tt){var ot=st.lineStyle=nt.get("crossStyle");ot&&defaults(ut,ot.textStyle)}}return s.model.getModel("axisPointer",new Model(st,o,c))}function collectSeriesInfo(s,a){a.eachSeries(function(o){var c=o.coordinateSystem,d=o.get(["tooltip","trigger"],!0),tt=o.get(["tooltip","show"],!0);!c||d==="none"||d===!1||d==="item"||tt===!1||o.get(["axisPointer","show"],!0)===!1||each$f(s.coordSysAxesInfo[makeKey(c.model)],function(nt){var it=nt.axis;c.getAxis(it.dim)===it&&(nt.seriesModels.push(o),nt.seriesDataCount==null&&(nt.seriesDataCount=0),nt.seriesDataCount+=o.getData().count())})})}function getLinkGroupIndex(s,a){for(var o=a.model,c=a.dim,d=0;d<s.length;d++){var tt=s[d]||{};if(checkPropInLink(tt[c+"AxisId"],o.id)||checkPropInLink(tt[c+"AxisIndex"],o.componentIndex)||checkPropInLink(tt[c+"AxisName"],o.name))return d}}function checkPropInLink(s,a){return s==="all"||isArray$1(s)&&indexOf(s,a)>=0||s===a}function fixValue(s){var a=getAxisInfo$1(s);if(a){var o=a.axisPointerModel,c=a.axis.scale,d=o.option,tt=o.get("status"),nt=o.get("value");nt!=null&&(nt=c.parse(nt));var it=isHandleTrigger(o);tt==null&&(d.status=it?"show":"hide");var st=c.getExtent().slice();st[0]>st[1]&&st.reverse(),(nt==null||nt>st[1])&&(nt=st[1]),nt<st[0]&&(nt=st[0]),d.value=nt,it&&(d.status=a.axis.scale.isBlank()?"hide":"show")}}function getAxisInfo$1(s){var a=(s.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return a&&a.axesInfo[makeKey(s)]}function getAxisPointerModel(s){var a=getAxisInfo$1(s);return a&&a.axisPointerModel}function isHandleTrigger(s){return!!s.get(["handle","show"])}function makeKey(s){return s.type+"||"+s.id}var axisPointerClazz={},AxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d,tt){this.axisPointerClass&&fixValue(o),s.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(o,d,!0)},a.prototype.updateAxisPointer=function(o,c,d,tt){this._doUpdateAxisPointerClass(o,d,!1)},a.prototype.remove=function(o,c){var d=this._axisPointer;d&&d.remove(c)},a.prototype.dispose=function(o,c){this._disposeAxisPointer(c),s.prototype.dispose.apply(this,arguments)},a.prototype._doUpdateAxisPointerClass=function(o,c,d){var tt=a.getAxisPointerClass(this.axisPointerClass);if(tt){var nt=getAxisPointerModel(o);nt?(this._axisPointer||(this._axisPointer=new tt)).render(o,nt,c,d):this._disposeAxisPointer(c)}},a.prototype._disposeAxisPointer=function(o){this._axisPointer&&this._axisPointer.dispose(o),this._axisPointer=null},a.registerAxisPointerClass=function(o,c){axisPointerClazz[o]=c},a.getAxisPointerClass=function(o){return o&&axisPointerClazz[o]},a.type="axis",a}(ComponentView),inner$f=makeInner();function rectCoordAxisBuildSplitArea(s,a,o,c){var d=o.axis;if(!d.scale.isBlank()){var tt=o.getModel("splitArea"),nt=tt.getModel("areaStyle"),it=nt.get("color"),st=c.coordinateSystem.getRect(),ut=d.getTicksCoords({tickModel:tt,clamp:!0});if(ut.length){var ct=it.length,ot=inner$f(s).splitAreaColors,at=createHashMap(),ht=0;if(ot)for(var ft=0;ft<ut.length;ft++){var mt=ot.get(ut[ft].tickValue);if(mt!=null){ht=(mt+(ct-1)*ft)%ct;break}}var yt=d.toGlobalCoord(ut[0].coord),bt=nt.getAreaStyle();it=isArray$1(it)?it:[it];for(var ft=1;ft<ut.length;ft++){var wt=d.toGlobalCoord(ut[ft].coord),Tt=void 0,Ct=void 0,Dt=void 0,Ot=void 0;d.isHorizontal()?(Tt=yt,Ct=st.y,Dt=wt-Tt,Ot=st.height,yt=Tt+Dt):(Tt=st.x,Ct=yt,Dt=st.width,Ot=wt-Ct,yt=Ct+Ot);var $t=ut[ft-1].tickValue;$t!=null&&at.set($t,ht),a.add(new Rect$2({anid:$t!=null?"area_"+$t:null,shape:{x:Tt,y:Ct,width:Dt,height:Ot},style:defaults({fill:it[ht]},bt),autoBatch:!0,silent:!0})),ht=(ht+1)%ct}inner$f(s).splitAreaColors=at}}}function rectCoordAxisHandleRemove(s){inner$f(s).splitAreaColors=null}var axisBuilderAttrs$3=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs$2=["splitArea","splitLine","minorSplitLine"],CartesianAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.axisPointerClass="CartesianAxisPointer",o}return a.prototype.render=function(o,c,d,tt){this.group.removeAll();var nt=this._axisGroup;if(this._axisGroup=new Group$3,this.group.add(this._axisGroup),!!o.get("show")){var it=o.getCoordSysModel(),st=layout$2(it,o),ut=new AxisBuilder(o,extend({handleAutoShown:function(ot){for(var at=it.coordinateSystem.getCartesians(),ht=0;ht<at.length;ht++)if(isIntervalOrLogScale(at[ht].getOtherAxis(o.axis).scale))return!0;return!1}},st));each$f(axisBuilderAttrs$3,ut.add,ut),this._axisGroup.add(ut.getGroup()),each$f(selfBuilderAttrs$2,function(ot){o.get([ot,"show"])&&axisElementBuilders$2[ot](this,this._axisGroup,o,it)},this);var ct=tt&&tt.type==="changeAxisOrder"&&tt.isInitSort;ct||groupTransition(nt,this._axisGroup,o),s.prototype.render.call(this,o,c,d,tt)}},a.prototype.remove=function(){rectCoordAxisHandleRemove(this)},a.type="cartesianAxis",a}(AxisView),axisElementBuilders$2={splitLine:function(s,a,o,c){var d=o.axis;if(!d.scale.isBlank()){var tt=o.getModel("splitLine"),nt=tt.getModel("lineStyle"),it=nt.get("color"),st=tt.get("showMinLine")!==!1,ut=tt.get("showMaxLine")!==!1;it=isArray$1(it)?it:[it];for(var ct=c.coordinateSystem.getRect(),ot=d.isHorizontal(),at=0,ht=d.getTicksCoords({tickModel:tt}),ft=[],mt=[],yt=nt.getLineStyle(),bt=0;bt<ht.length;bt++){var wt=d.toGlobalCoord(ht[bt].coord);if(!(bt===0&&!st||bt===ht.length-1&&!ut)){var Tt=ht[bt].tickValue;ot?(ft[0]=wt,ft[1]=ct.y,mt[0]=wt,mt[1]=ct.y+ct.height):(ft[0]=ct.x,ft[1]=wt,mt[0]=ct.x+ct.width,mt[1]=wt);var Ct=at++%it.length,Dt=new Line$1({anid:Tt!=null?"line_"+Tt:null,autoBatch:!0,shape:{x1:ft[0],y1:ft[1],x2:mt[0],y2:mt[1]},style:defaults({stroke:it[Ct]},yt),silent:!0});subPixelOptimizeLine(Dt.shape,yt.lineWidth),a.add(Dt)}}}},minorSplitLine:function(s,a,o,c){var d=o.axis,tt=o.getModel("minorSplitLine"),nt=tt.getModel("lineStyle"),it=c.coordinateSystem.getRect(),st=d.isHorizontal(),ut=d.getMinorTicksCoords();if(ut.length)for(var ct=[],ot=[],at=nt.getLineStyle(),ht=0;ht<ut.length;ht++)for(var ft=0;ft<ut[ht].length;ft++){var mt=d.toGlobalCoord(ut[ht][ft].coord);st?(ct[0]=mt,ct[1]=it.y,ot[0]=mt,ot[1]=it.y+it.height):(ct[0]=it.x,ct[1]=mt,ot[0]=it.x+it.width,ot[1]=mt);var yt=new Line$1({anid:"minor_line_"+ut[ht][ft].tickValue,autoBatch:!0,shape:{x1:ct[0],y1:ct[1],x2:ot[0],y2:ot[1]},style:at,silent:!0});subPixelOptimizeLine(yt.shape,at.lineWidth),a.add(yt)}},splitArea:function(s,a,o,c){rectCoordAxisBuildSplitArea(s,a,o,c)}},CartesianXAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="xAxis",a}(CartesianAxisView),CartesianYAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=CartesianXAxisView.type,o}return a.type="yAxis",a}(CartesianAxisView),GridView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="grid",o}return a.prototype.render=function(o,c){this.group.removeAll(),o.get("show")&&this.group.add(new Rect$2({shape:o.coordinateSystem.getRect(),style:defaults({fill:o.get("backgroundColor")},o.getItemStyle()),silent:!0,z2:-1}))},a.type="grid",a}(ComponentView),extraOption={offset:0};function install$N(s){s.registerComponentView(GridView),s.registerComponentModel(GridModel),s.registerCoordinateSystem("cartesian2d",Grid),axisModelCreator(s,"x",CartesianAxisModel,extraOption),axisModelCreator(s,"y",CartesianAxisModel,extraOption),s.registerComponentView(CartesianXAxisView),s.registerComponentView(CartesianYAxisView),s.registerPreprocessor(function(a){a.xAxis&&a.yAxis&&!a.grid&&(a.grid={})})}function install$M(s){use(install$N),s.registerSeriesModel(ScatterSeriesModel),s.registerChartView(ScatterView),s.registerLayout(pointsLayout("scatter"))}function radarLayout(s){s.eachSeriesByType("radar",function(a){var o=a.getData(),c=[],d=a.coordinateSystem;if(d){var tt=d.getIndicatorAxes();each$f(tt,function(nt,it){o.each(o.mapDimension(tt[it].dim),function(st,ut){c[ut]=c[ut]||[];var ct=d.dataToPoint(st,it);c[ut][it]=isValidPoint(ct)?ct:getValueMissingPoint(d)})}),o.each(function(nt){var it=find(c[nt],function(st){return isValidPoint(st)})||getValueMissingPoint(d);c[nt].push(it.slice()),o.setItemLayout(nt,c[nt])})}})}function isValidPoint(s){return!isNaN(s[0])&&!isNaN(s[1])}function getValueMissingPoint(s){return[s.cx,s.cy]}function radarBackwardCompat(s){var a=s.polar;if(a){isArray$1(a)||(a=[a]);var o=[];each$f(a,function(c,d){c.indicator?(c.type&&!c.shape&&(c.shape=c.type),s.radar=s.radar||[],isArray$1(s.radar)||(s.radar=[s.radar]),s.radar.push(c)):o.push(c)}),s.polar=o}each$f(s.series,function(c){c&&c.type==="radar"&&c.polarIndex&&(c.radarIndex=c.polarIndex)})}var RadarView$1=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=o.coordinateSystem,nt=this.group,it=o.getData(),st=this._data;function ut(at,ht){var ft=at.getItemVisual(ht,"symbol")||"circle";if(ft!=="none"){var mt=normalizeSymbolSize(at.getItemVisual(ht,"symbolSize")),yt=createSymbol$1(ft,-1,-1,2,2),bt=at.getItemVisual(ht,"symbolRotate")||0;return yt.attr({style:{strokeNoScale:!0},z2:100,scaleX:mt[0]/2,scaleY:mt[1]/2,rotation:bt*Math.PI/180||0}),yt}}function ct(at,ht,ft,mt,yt,bt){ft.removeAll();for(var wt=0;wt<ht.length-1;wt++){var Tt=ut(mt,yt);Tt&&(Tt.__dimIdx=wt,at[wt]?(Tt.setPosition(at[wt]),graphic$1[bt?"initProps":"updateProps"](Tt,{x:ht[wt][0],y:ht[wt][1]},o,yt)):Tt.setPosition(ht[wt]),ft.add(Tt))}}function ot(at){return map$1(at,function(ht){return[tt.cx,tt.cy]})}it.diff(st).add(function(at){var ht=it.getItemLayout(at);if(ht){var ft=new Polygon,mt=new Polyline$1,yt={shape:{points:ht}};ft.shape.points=ot(ht),mt.shape.points=ot(ht),initProps(ft,yt,o,at),initProps(mt,yt,o,at);var bt=new Group$3,wt=new Group$3;bt.add(mt),bt.add(ft),bt.add(wt),ct(mt.shape.points,ht,wt,it,at,!0),it.setItemGraphicEl(at,bt)}}).update(function(at,ht){var ft=st.getItemGraphicEl(ht),mt=ft.childAt(0),yt=ft.childAt(1),bt=ft.childAt(2),wt={shape:{points:it.getItemLayout(at)}};wt.shape.points&&(ct(mt.shape.points,wt.shape.points,bt,it,at,!1),saveOldStyle(yt),saveOldStyle(mt),updateProps$1(mt,wt,o),updateProps$1(yt,wt,o),it.setItemGraphicEl(at,ft))}).remove(function(at){nt.remove(st.getItemGraphicEl(at))}).execute(),it.eachItemGraphicEl(function(at,ht){var ft=it.getItemModel(ht),mt=at.childAt(0),yt=at.childAt(1),bt=at.childAt(2),wt=it.getItemVisual(ht,"style"),Tt=wt.fill;nt.add(at),mt.useStyle(defaults(ft.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:Tt})),setStatesStylesFromModel(mt,ft,"lineStyle"),setStatesStylesFromModel(yt,ft,"areaStyle");var Ct=ft.getModel("areaStyle"),Dt=Ct.isEmpty()&&Ct.parentModel.isEmpty();yt.ignore=Dt,each$f(["emphasis","select","blur"],function(Ft){var kt=ft.getModel([Ft,"areaStyle"]),Vt=kt.isEmpty()&&kt.parentModel.isEmpty();yt.ensureState(Ft).ignore=Vt&&Dt}),yt.useStyle(defaults(Ct.getAreaStyle(),{fill:Tt,opacity:.7,decal:wt.decal}));var Ot=ft.getModel("emphasis"),$t=Ot.getModel("itemStyle").getItemStyle();bt.eachChild(function(Ft){if(Ft instanceof ZRImage){var kt=Ft.style;Ft.useStyle(extend({image:kt.image,x:kt.x,y:kt.y,width:kt.width,height:kt.height},wt))}else Ft.useStyle(wt),Ft.setColor(Tt),Ft.style.strokeNoScale=!0;var Vt=Ft.ensureState("emphasis");Vt.style=clone$4($t);var Ht=it.getStore().get(it.getDimensionIndex(Ft.__dimIdx),ht);(Ht==null||isNaN(Ht))&&(Ht=""),setLabelStyle(Ft,getLabelStatesModels(ft),{labelFetcher:it.hostModel,labelDataIndex:ht,labelDimIndex:Ft.__dimIdx,defaultText:Ht,inheritColor:Tt,defaultOpacity:wt.opacity})}),toggleHoverEmphasis(at,Ot.get("focus"),Ot.get("blurScope"),Ot.get("disabled"))}),this._data=it},a.prototype.remove=function(){this.group.removeAll(),this._data=null},a.type="radar",a}(ChartView),RadarSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o}return a.prototype.init=function(o){s.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$2(this.getData,this),bind$2(this.getRawData,this))},a.prototype.getInitialData=function(o,c){return createSeriesDataSimply(this,{generateCoord:"indicator_",generateCoordCount:1/0})},a.prototype.formatTooltip=function(o,c,d){var tt=this.getData(),nt=this.coordinateSystem,it=nt.getIndicatorAxes(),st=this.getData().getName(o),ut=st===""?this.name:st,ct=retrieveVisualColorForTooltipMarker(this,o);return createTooltipMarkup("section",{header:ut,sortBlocks:!0,blocks:map$1(it,function(ot){var at=tt.get(tt.mapDimension(ot.dim),o);return createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:ct,name:ot.name,value:at,sortParam:at})})})},a.prototype.getTooltipPosition=function(o){if(o!=null){for(var c=this.getData(),d=this.coordinateSystem,tt=c.getValues(map$1(d.dimensions,function(ut){return c.mapDimension(ut)}),o),nt=0,it=tt.length;nt<it;nt++)if(!isNaN(tt[nt])){var st=d.getIndicatorAxes();return d.coordToPoint(st[nt].dataToCoord(tt[nt]),nt)}}},a.type="series.radar",a.dependencies=["radar"],a.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},a}(SeriesModel),valueAxisDefault=axisDefault.value;function defaultsShow(s,a){return defaults({show:a},s)}var RadarModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.optionUpdated=function(){var o=this.get("boundaryGap"),c=this.get("splitNumber"),d=this.get("scale"),tt=this.get("axisLine"),nt=this.get("axisTick"),it=this.get("axisLabel"),st=this.get("axisName"),ut=this.get(["axisName","show"]),ct=this.get(["axisName","formatter"]),ot=this.get("axisNameGap"),at=this.get("triggerEvent"),ht=map$1(this.get("indicator")||[],function(ft){ft.max!=null&&ft.max>0&&!ft.min?ft.min=0:ft.min!=null&&ft.min<0&&!ft.max&&(ft.max=0);var mt=st;ft.color!=null&&(mt=defaults({color:ft.color},st));var yt=merge(clone$4(ft),{boundaryGap:o,splitNumber:c,scale:d,axisLine:tt,axisTick:nt,axisLabel:it,name:ft.text,showName:ut,nameLocation:"end",nameGap:ot,nameTextStyle:mt,triggerEvent:at},!1);if(isString$1(ct)){var bt=yt.name;yt.name=ct.replace("{value}",bt??"")}else isFunction$1(ct)&&(yt.name=ct(yt.name,yt));var wt=new Model(yt,null,this.ecModel);return mixin(wt,AxisModelCommonMixin.prototype),wt.mainType="radar",wt.componentIndex=this.componentIndex,wt},this);this._indicatorModels=ht},a.prototype.getIndicatorModels=function(){return this._indicatorModels},a.type="radar",a.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:merge({lineStyle:{color:"#bbb"}},valueAxisDefault.axisLine),axisLabel:defaultsShow(valueAxisDefault.axisLabel,!1),axisTick:defaultsShow(valueAxisDefault.axisTick,!1),splitLine:defaultsShow(valueAxisDefault.splitLine,!0),splitArea:defaultsShow(valueAxisDefault.splitArea,!0),indicator:[]},a}(ComponentModel),axisBuilderAttrs$2=["axisLine","axisTickLabel","axisName"],RadarView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=this.group;tt.removeAll(),this._buildAxes(o),this._buildSplitLineAndArea(o)},a.prototype._buildAxes=function(o){var c=o.coordinateSystem,d=c.getIndicatorAxes(),tt=map$1(d,function(nt){var it=nt.model.get("showName")?nt.name:"",st=new AxisBuilder(nt.model,{axisName:it,position:[c.cx,c.cy],rotation:nt.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return st});each$f(tt,function(nt){each$f(axisBuilderAttrs$2,nt.add,nt),this.group.add(nt.getGroup())},this)},a.prototype._buildSplitLineAndArea=function(o){var c=o.coordinateSystem,d=c.getIndicatorAxes();if(!d.length)return;var tt=o.get("shape"),nt=o.getModel("splitLine"),it=o.getModel("splitArea"),st=nt.getModel("lineStyle"),ut=it.getModel("areaStyle"),ct=nt.get("show"),ot=it.get("show"),at=st.get("color"),ht=ut.get("color"),ft=isArray$1(at)?at:[at],mt=isArray$1(ht)?ht:[ht],yt=[],bt=[];function wt(ar,nr,cr){var dr=cr%nr.length;return ar[dr]=ar[dr]||[],dr}if(tt==="circle")for(var Tt=d[0].getTicksCoords(),Ct=c.cx,Dt=c.cy,Ot=0;Ot<Tt.length;Ot++){if(ct){var $t=wt(yt,ft,Ot);yt[$t].push(new Circle({shape:{cx:Ct,cy:Dt,r:Tt[Ot].coord}}))}if(ot&&Ot<Tt.length-1){var $t=wt(bt,mt,Ot);bt[$t].push(new Ring({shape:{cx:Ct,cy:Dt,r0:Tt[Ot].coord,r:Tt[Ot+1].coord}}))}}else for(var Ft,kt=map$1(d,function(ar,nr){var cr=ar.getTicksCoords();return Ft=Ft==null?cr.length-1:Math.min(cr.length-1,Ft),map$1(cr,function(dr){return c.coordToPoint(dr.coord,nr)})}),Vt=[],Ot=0;Ot<=Ft;Ot++){for(var Ht=[],Qt=0;Qt<d.length;Qt++)Ht.push(kt[Qt][Ot]);if(Ht[0]&&Ht.push(Ht[0].slice()),ct){var $t=wt(yt,ft,Ot);yt[$t].push(new Polyline$1({shape:{points:Ht}}))}if(ot&&Vt){var $t=wt(bt,mt,Ot-1);bt[$t].push(new Polygon({shape:{points:Ht.concat(Vt)}}))}Vt=Ht.slice().reverse()}var Xt=st.getLineStyle(),Zt=ut.getAreaStyle();each$f(bt,function(ar,nr){this.group.add(mergePath(ar,{style:defaults({stroke:"none",fill:mt[nr%mt.length]},Zt),silent:!0}))},this),each$f(yt,function(ar,nr){this.group.add(mergePath(ar,{style:defaults({fill:"none",stroke:ft[nr%ft.length]},Xt),silent:!0}))},this)},a.type="radar",a}(ComponentView),IndicatorAxis=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this,o,c,d)||this;return tt.type="value",tt.angle=0,tt.name="",tt}return a}(Axis),Radar=function(){function s(a,o,c){this.dimensions=[],this._model=a,this._indicatorAxes=map$1(a.getIndicatorModels(),function(d,tt){var nt="indicator_"+tt,it=new IndicatorAxis(nt,new IntervalScale);return it.name=d.get("name"),it.model=d,d.axis=it,this.dimensions.push(nt),it},this),this.resize(a,c)}return s.prototype.getIndicatorAxes=function(){return this._indicatorAxes},s.prototype.dataToPoint=function(a,o){var c=this._indicatorAxes[o];return this.coordToPoint(c.dataToCoord(a),o)},s.prototype.coordToPoint=function(a,o){var c=this._indicatorAxes[o],d=c.angle,tt=this.cx+a*Math.cos(d),nt=this.cy-a*Math.sin(d);return[tt,nt]},s.prototype.pointToData=function(a){var o=a[0]-this.cx,c=a[1]-this.cy,d=Math.sqrt(o*o+c*c);o/=d,c/=d;for(var tt=Math.atan2(-c,o),nt=1/0,it,st=-1,ut=0;ut<this._indicatorAxes.length;ut++){var ct=this._indicatorAxes[ut],ot=Math.abs(tt-ct.angle);ot<nt&&(it=ct,st=ut,nt=ot)}return[st,+(it&&it.coordToData(d))]},s.prototype.resize=function(a,o){var c=a.get("center"),d=o.getWidth(),tt=o.getHeight(),nt=Math.min(d,tt)/2;this.cx=parsePercent(c[0],d),this.cy=parsePercent(c[1],tt),this.startAngle=a.get("startAngle")*Math.PI/180;var it=a.get("radius");(isString$1(it)||isNumber(it))&&(it=[0,it]),this.r0=parsePercent(it[0],nt),this.r=parsePercent(it[1],nt),each$f(this._indicatorAxes,function(st,ut){st.setExtent(this.r0,this.r);var ct=this.startAngle+ut*Math.PI*2/this._indicatorAxes.length;ct=Math.atan2(Math.sin(ct),Math.cos(ct)),st.angle=ct},this)},s.prototype.update=function(a,o){var c=this._indicatorAxes,d=this._model;each$f(c,function(it){it.scale.setExtent(1/0,-1/0)}),a.eachSeriesByType("radar",function(it,st){if(!(it.get("coordinateSystem")!=="radar"||a.getComponent("radar",it.get("radarIndex"))!==d)){var ut=it.getData();each$f(c,function(ct){ct.scale.unionExtentFromData(ut,ut.mapDimension(ct.dim))})}},this);var tt=d.get("splitNumber"),nt=new IntervalScale;nt.setExtent(0,tt),nt.setInterval(1),each$f(c,function(it,st){alignScaleTicks(it.scale,it.model,nt)})},s.prototype.convertToPixel=function(a,o,c){return console.warn("Not implemented."),null},s.prototype.convertFromPixel=function(a,o,c){return console.warn("Not implemented."),null},s.prototype.containPoint=function(a){return console.warn("Not implemented."),!1},s.create=function(a,o){var c=[];return a.eachComponent("radar",function(d){var tt=new s(d,a,o);c.push(tt),d.coordinateSystem=tt}),a.eachSeriesByType("radar",function(d){d.get("coordinateSystem")==="radar"&&(d.coordinateSystem=c[d.get("radarIndex")||0])}),c},s.dimensions=[],s}();function install$L(s){s.registerCoordinateSystem("radar",Radar),s.registerComponentModel(RadarModel),s.registerComponentView(RadarView),s.registerVisual({seriesType:"radar",reset:function(a){var o=a.getData();o.each(function(c){o.setItemVisual(c,"legendIcon","roundRect")}),o.setVisual("legendIcon","roundRect")}})}function install$K(s){use(install$L),s.registerChartView(RadarView$1),s.registerSeriesModel(RadarSeriesModel),s.registerLayout(radarLayout),s.registerProcessor(dataFilter$1("radar")),s.registerPreprocessor(radarBackwardCompat)}var ATTR="\0_ec_interaction_mutex";function take(s,a,o){var c=getStore(s);c[a]=o}function release(s,a,o){var c=getStore(s),d=c[a];d===o&&(c[a]=null)}function isTaken(s,a){return!!getStore(s)[a]}function getStore(s){return s[ATTR]||(s[ATTR]={})}registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},noop);var RoamController=function(s){__extends$1(a,s);function a(o){var c=s.call(this)||this;c._zr=o;var d=bind$2(c._mousedownHandler,c),tt=bind$2(c._mousemoveHandler,c),nt=bind$2(c._mouseupHandler,c),it=bind$2(c._mousewheelHandler,c),st=bind$2(c._pinchHandler,c);return c.enable=function(ut,ct){this.disable(),this._opt=defaults(clone$4(ct)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),ut==null&&(ut=!0),(ut===!0||ut==="move"||ut==="pan")&&(o.on("mousedown",d),o.on("mousemove",tt),o.on("mouseup",nt)),(ut===!0||ut==="scale"||ut==="zoom")&&(o.on("mousewheel",it),o.on("pinch",st))},c.disable=function(){o.off("mousedown",d),o.off("mousemove",tt),o.off("mouseup",nt),o.off("mousewheel",it),o.off("pinch",st)},c}return a.prototype.isDragging=function(){return this._dragging},a.prototype.isPinching=function(){return this._pinching},a.prototype.setPointerChecker=function(o){this.pointerChecker=o},a.prototype.dispose=function(){this.disable()},a.prototype._mousedownHandler=function(o){if(!isMiddleOrRightButtonOnMouseUpDown(o)){for(var c=o.target;c;){if(c.draggable)return;c=c.__hostTarget||c.parent}var d=o.offsetX,tt=o.offsetY;this.pointerChecker&&this.pointerChecker(o,d,tt)&&(this._x=d,this._y=tt,this._dragging=!0)}},a.prototype._mousemoveHandler=function(o){if(!(!this._dragging||!isAvailableBehavior("moveOnMouseMove",o,this._opt)||o.gestureEvent==="pinch"||isTaken(this._zr,"globalPan"))){var c=o.offsetX,d=o.offsetY,tt=this._x,nt=this._y,it=c-tt,st=d-nt;this._x=c,this._y=d,this._opt.preventDefaultMouseMove&&stop(o.event),trigger$1(this,"pan","moveOnMouseMove",o,{dx:it,dy:st,oldX:tt,oldY:nt,newX:c,newY:d,isAvailableBehavior:null})}},a.prototype._mouseupHandler=function(o){isMiddleOrRightButtonOnMouseUpDown(o)||(this._dragging=!1)},a.prototype._mousewheelHandler=function(o){var c=isAvailableBehavior("zoomOnMouseWheel",o,this._opt),d=isAvailableBehavior("moveOnMouseWheel",o,this._opt),tt=o.wheelDelta,nt=Math.abs(tt),it=o.offsetX,st=o.offsetY;if(!(tt===0||!c&&!d)){if(c){var ut=nt>3?1.4:nt>1?1.2:1.1,ct=tt>0?ut:1/ut;checkPointerAndTrigger(this,"zoom","zoomOnMouseWheel",o,{scale:ct,originX:it,originY:st,isAvailableBehavior:null})}if(d){var ot=Math.abs(tt),at=(tt>0?1:-1)*(ot>3?.4:ot>1?.15:.05);checkPointerAndTrigger(this,"scrollMove","moveOnMouseWheel",o,{scrollDelta:at,originX:it,originY:st,isAvailableBehavior:null})}}},a.prototype._pinchHandler=function(o){if(!isTaken(this._zr,"globalPan")){var c=o.pinchScale>1?1.1:1/1.1;checkPointerAndTrigger(this,"zoom",null,o,{scale:c,originX:o.pinchX,originY:o.pinchY,isAvailableBehavior:null})}},a}(Eventful);function checkPointerAndTrigger(s,a,o,c,d){s.pointerChecker&&s.pointerChecker(c,d.originX,d.originY)&&(stop(c.event),trigger$1(s,a,o,c,d))}function trigger$1(s,a,o,c,d){d.isAvailableBehavior=bind$2(isAvailableBehavior,null,o,c),s.trigger(a,d)}function isAvailableBehavior(s,a,o){var c=o[s];return!s||c&&(!isString$1(c)||a.event[c+"Key"])}function updateViewOnPan(s,a,o){var c=s.target;c.x+=a,c.y+=o,c.dirty()}function updateViewOnZoom(s,a,o,c){var d=s.target,tt=s.zoomLimit,nt=s.zoom=s.zoom||1;if(nt*=a,tt){var it=tt.min||0,st=tt.max||1/0;nt=Math.max(Math.min(st,nt),it)}var ut=nt/s.zoom;s.zoom=nt,d.x-=(o-d.x)*(ut-1),d.y-=(c-d.y)*(ut-1),d.scaleX*=ut,d.scaleY*=ut,d.dirty()}var IRRELEVANT_EXCLUDES={axisPointer:1,tooltip:1,brush:1};function onIrrelevantElement(s,a,o){var c=a.getComponentByElement(s.topTarget),d=c&&c.coordinateSystem;return c&&c!==o&&!IRRELEVANT_EXCLUDES.hasOwnProperty(c.mainType)&&d&&d.model!==o}function parseXML(s){if(isString$1(s)){var a=new DOMParser;s=a.parseFromString(s,"text/xml")}var o=s;for(o.nodeType===9&&(o=o.firstChild);o.nodeName.toLowerCase()!=="svg"||o.nodeType!==1;)o=o.nextSibling;return o}var nodeParsers,INHERITABLE_STYLE_ATTRIBUTES_MAP={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS=keys(INHERITABLE_STYLE_ATTRIBUTES_MAP),SELF_STYLE_ATTRIBUTES_MAP={"alignment-baseline":"textBaseline","stop-color":"stopColor"},SELF_STYLE_ATTRIBUTES_MAP_KEYS=keys(SELF_STYLE_ATTRIBUTES_MAP),SVGParser=function(){function s(){this._defs={},this._root=null}return s.prototype.parse=function(a,o){o=o||{};var c=parseXML(a);this._defsUsePending=[];var d=new Group$3;this._root=d;var tt=[],nt=c.getAttribute("viewBox")||"",it=parseFloat(c.getAttribute("width")||o.width),st=parseFloat(c.getAttribute("height")||o.height);isNaN(it)&&(it=null),isNaN(st)&&(st=null),parseAttributes(c,d,null,!0,!1);for(var ut=c.firstChild;ut;)this._parseNode(ut,d,tt,null,!1,!1),ut=ut.nextSibling;applyDefs(this._defs,this._defsUsePending),this._defsUsePending=[];var ct,ot;if(nt){var at=splitNumberSequence(nt);at.length>=4&&(ct={x:parseFloat(at[0]||0),y:parseFloat(at[1]||0),width:parseFloat(at[2]),height:parseFloat(at[3])})}if(ct&&it!=null&&st!=null&&(ot=makeViewBoxTransform(ct,{x:0,y:0,width:it,height:st}),!o.ignoreViewBox)){var ht=d;d=new Group$3,d.add(ht),ht.scaleX=ht.scaleY=ot.scale,ht.x=ot.x,ht.y=ot.y}return!o.ignoreRootClip&&it!=null&&st!=null&&d.setClipPath(new Rect$2({shape:{x:0,y:0,width:it,height:st}})),{root:d,width:it,height:st,viewBoxRect:ct,viewBoxTransform:ot,named:tt}},s.prototype._parseNode=function(a,o,c,d,tt,nt){var it=a.nodeName.toLowerCase(),st,ut=d;if(it==="defs"&&(tt=!0),it==="text"&&(nt=!0),it==="defs"||it==="switch")st=o;else{if(!tt){var ct=nodeParsers[it];if(ct&&hasOwn(nodeParsers,it)){st=ct.call(this,a,o);var ot=a.getAttribute("name");if(ot){var at={name:ot,namedFrom:null,svgNodeTagLower:it,el:st};c.push(at),it==="g"&&(ut=at)}else d&&c.push({name:d.name,namedFrom:d,svgNodeTagLower:it,el:st});o.add(st)}}var ht=paintServerParsers[it];if(ht&&hasOwn(paintServerParsers,it)){var ft=ht.call(this,a),mt=a.getAttribute("id");mt&&(this._defs[mt]=ft)}}if(st&&st.isGroup)for(var yt=a.firstChild;yt;)yt.nodeType===1?this._parseNode(yt,st,c,ut,tt,nt):yt.nodeType===3&&nt&&this._parseText(yt,st),yt=yt.nextSibling},s.prototype._parseText=function(a,o){var c=new TSpan({style:{text:a.textContent},silent:!0,x:this._textX||0,y:this._textY||0});inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),applyTextAlignment(c,o);var d=c.style,tt=d.fontSize;tt&&tt<9&&(d.fontSize=9,c.scaleX*=tt/9,c.scaleY*=tt/9);var nt=(d.fontSize||d.fontFamily)&&[d.fontStyle,d.fontWeight,(d.fontSize||12)+"px",d.fontFamily||"sans-serif"].join(" ");d.font=nt;var it=c.getBoundingRect();return this._textX+=it.width,o.add(c),c},s.internalField=function(){nodeParsers={g:function(a,o){var c=new Group$3;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c},rect:function(a,o){var c=new Rect$2;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c.setShape({x:parseFloat(a.getAttribute("x")||"0"),y:parseFloat(a.getAttribute("y")||"0"),width:parseFloat(a.getAttribute("width")||"0"),height:parseFloat(a.getAttribute("height")||"0")}),c.silent=!0,c},circle:function(a,o){var c=new Circle;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c.setShape({cx:parseFloat(a.getAttribute("cx")||"0"),cy:parseFloat(a.getAttribute("cy")||"0"),r:parseFloat(a.getAttribute("r")||"0")}),c.silent=!0,c},line:function(a,o){var c=new Line$1;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c.setShape({x1:parseFloat(a.getAttribute("x1")||"0"),y1:parseFloat(a.getAttribute("y1")||"0"),x2:parseFloat(a.getAttribute("x2")||"0"),y2:parseFloat(a.getAttribute("y2")||"0")}),c.silent=!0,c},ellipse:function(a,o){var c=new Ellipse;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c.setShape({cx:parseFloat(a.getAttribute("cx")||"0"),cy:parseFloat(a.getAttribute("cy")||"0"),rx:parseFloat(a.getAttribute("rx")||"0"),ry:parseFloat(a.getAttribute("ry")||"0")}),c.silent=!0,c},polygon:function(a,o){var c=a.getAttribute("points"),d;c&&(d=parsePoints(c));var tt=new Polygon({shape:{points:d||[]},silent:!0});return inheritStyle(o,tt),parseAttributes(a,tt,this._defsUsePending,!1,!1),tt},polyline:function(a,o){var c=a.getAttribute("points"),d;c&&(d=parsePoints(c));var tt=new Polyline$1({shape:{points:d||[]},silent:!0});return inheritStyle(o,tt),parseAttributes(a,tt,this._defsUsePending,!1,!1),tt},image:function(a,o){var c=new ZRImage;return inheritStyle(o,c),parseAttributes(a,c,this._defsUsePending,!1,!1),c.setStyle({image:a.getAttribute("xlink:href")||a.getAttribute("href"),x:+a.getAttribute("x"),y:+a.getAttribute("y"),width:+a.getAttribute("width"),height:+a.getAttribute("height")}),c.silent=!0,c},text:function(a,o){var c=a.getAttribute("x")||"0",d=a.getAttribute("y")||"0",tt=a.getAttribute("dx")||"0",nt=a.getAttribute("dy")||"0";this._textX=parseFloat(c)+parseFloat(tt),this._textY=parseFloat(d)+parseFloat(nt);var it=new Group$3;return inheritStyle(o,it),parseAttributes(a,it,this._defsUsePending,!1,!0),it},tspan:function(a,o){var c=a.getAttribute("x"),d=a.getAttribute("y");c!=null&&(this._textX=parseFloat(c)),d!=null&&(this._textY=parseFloat(d));var tt=a.getAttribute("dx")||"0",nt=a.getAttribute("dy")||"0",it=new Group$3;return inheritStyle(o,it),parseAttributes(a,it,this._defsUsePending,!1,!0),this._textX+=parseFloat(tt),this._textY+=parseFloat(nt),it},path:function(a,o){var c=a.getAttribute("d")||"",d=createFromString(c);return inheritStyle(o,d),parseAttributes(a,d,this._defsUsePending,!1,!1),d.silent=!0,d}}}(),s}(),paintServerParsers={lineargradient:function(s){var a=parseInt(s.getAttribute("x1")||"0",10),o=parseInt(s.getAttribute("y1")||"0",10),c=parseInt(s.getAttribute("x2")||"10",10),d=parseInt(s.getAttribute("y2")||"0",10),tt=new LinearGradient(a,o,c,d);return parsePaintServerUnit(s,tt),parseGradientColorStops(s,tt),tt},radialgradient:function(s){var a=parseInt(s.getAttribute("cx")||"0",10),o=parseInt(s.getAttribute("cy")||"0",10),c=parseInt(s.getAttribute("r")||"0",10),d=new RadialGradient(a,o,c);return parsePaintServerUnit(s,d),parseGradientColorStops(s,d),d}};function parsePaintServerUnit(s,a){var o=s.getAttribute("gradientUnits");o==="userSpaceOnUse"&&(a.global=!0)}function parseGradientColorStops(s,a){for(var o=s.firstChild;o;){if(o.nodeType===1&&o.nodeName.toLocaleLowerCase()==="stop"){var c=o.getAttribute("offset"),d=void 0;c&&c.indexOf("%")>0?d=parseInt(c,10)/100:c?d=parseFloat(c):d=0;var tt={};parseInlineStyle(o,tt,tt);var nt=tt.stopColor||o.getAttribute("stop-color")||"#000000";a.colorStops.push({offset:d,color:nt})}o=o.nextSibling}}function inheritStyle(s,a){s&&s.__inheritedStyle&&(a.__inheritedStyle||(a.__inheritedStyle={}),defaults(a.__inheritedStyle,s.__inheritedStyle))}function parsePoints(s){for(var a=splitNumberSequence(s),o=[],c=0;c<a.length;c+=2){var d=parseFloat(a[c]),tt=parseFloat(a[c+1]);o.push([d,tt])}return o}function parseAttributes(s,a,o,c,d){var tt=a,nt=tt.__inheritedStyle=tt.__inheritedStyle||{},it={};s.nodeType===1&&(parseTransformAttribute(s,a),parseInlineStyle(s,nt,it),c||parseAttributeStyle(s,nt,it)),tt.style=tt.style||{},nt.fill!=null&&(tt.style.fill=getFillStrokeStyle(tt,"fill",nt.fill,o)),nt.stroke!=null&&(tt.style.stroke=getFillStrokeStyle(tt,"stroke",nt.stroke,o)),each$f(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(st){nt[st]!=null&&(tt.style[st]=parseFloat(nt[st]))}),each$f(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(st){nt[st]!=null&&(tt.style[st]=nt[st])}),d&&(tt.__selfStyle=it),nt.lineDash&&(tt.style.lineDash=map$1(splitNumberSequence(nt.lineDash),function(st){return parseFloat(st)})),(nt.visibility==="hidden"||nt.visibility==="collapse")&&(tt.invisible=!0),nt.display==="none"&&(tt.ignore=!0)}function applyTextAlignment(s,a){var o=a.__selfStyle;if(o){var c=o.textBaseline,d=c;!c||c==="auto"||c==="baseline"?d="alphabetic":c==="before-edge"||c==="text-before-edge"?d="top":c==="after-edge"||c==="text-after-edge"?d="bottom":(c==="central"||c==="mathematical")&&(d="middle"),s.style.textBaseline=d}var tt=a.__inheritedStyle;if(tt){var nt=tt.textAlign,it=nt;nt&&(nt==="middle"&&(it="center"),s.style.textAlign=it)}}var urlRegex=/^url\(\s*#(.*?)\)/;function getFillStrokeStyle(s,a,o,c){var d=o&&o.match(urlRegex);if(d){var tt=trim$1(d[1]);c.push([s,a,tt]);return}return o==="none"&&(o=null),o}function applyDefs(s,a){for(var o=0;o<a.length;o++){var c=a[o];c[0].style[c[1]]=s[c[2]]}}var numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function splitNumberSequence(s){return s.match(numberReg)||[]}var transformRegex=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,DEGREE_TO_ANGLE=Math.PI/180;function parseTransformAttribute(s,a){var o=s.getAttribute("transform");if(o){o=o.replace(/,/g," ");var c=[],d=null;o.replace(transformRegex,function(ot,at,ht){return c.push(at,ht),""});for(var tt=c.length-1;tt>0;tt-=2){var nt=c[tt],it=c[tt-1],st=splitNumberSequence(nt);switch(d=d||create$1(),it){case"translate":translate(d,d,[parseFloat(st[0]),parseFloat(st[1]||"0")]);break;case"scale":scale$1(d,d,[parseFloat(st[0]),parseFloat(st[1]||st[0])]);break;case"rotate":rotate$1(d,d,-parseFloat(st[0])*DEGREE_TO_ANGLE,[parseFloat(st[1]||"0"),parseFloat(st[2]||"0")]);break;case"skewX":var ut=Math.tan(parseFloat(st[0])*DEGREE_TO_ANGLE);mul(d,[1,0,ut,1,0,0],d);break;case"skewY":var ct=Math.tan(parseFloat(st[0])*DEGREE_TO_ANGLE);mul(d,[1,ct,0,1,0,0],d);break;case"matrix":d[0]=parseFloat(st[0]),d[1]=parseFloat(st[1]),d[2]=parseFloat(st[2]),d[3]=parseFloat(st[3]),d[4]=parseFloat(st[4]),d[5]=parseFloat(st[5]);break}}a.setLocalTransform(d)}}var styleRegex=/([^\s:;]+)\s*:\s*([^:;]+)/g;function parseInlineStyle(s,a,o){var c=s.getAttribute("style");if(c){styleRegex.lastIndex=0;for(var d;(d=styleRegex.exec(c))!=null;){var tt=d[1],nt=hasOwn(INHERITABLE_STYLE_ATTRIBUTES_MAP,tt)?INHERITABLE_STYLE_ATTRIBUTES_MAP[tt]:null;nt&&(a[nt]=d[2]);var it=hasOwn(SELF_STYLE_ATTRIBUTES_MAP,tt)?SELF_STYLE_ATTRIBUTES_MAP[tt]:null;it&&(o[it]=d[2])}}}function parseAttributeStyle(s,a,o){for(var c=0;c<INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS.length;c++){var d=INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS[c],tt=s.getAttribute(d);tt!=null&&(a[INHERITABLE_STYLE_ATTRIBUTES_MAP[d]]=tt)}for(var c=0;c<SELF_STYLE_ATTRIBUTES_MAP_KEYS.length;c++){var d=SELF_STYLE_ATTRIBUTES_MAP_KEYS[c],tt=s.getAttribute(d);tt!=null&&(o[SELF_STYLE_ATTRIBUTES_MAP[d]]=tt)}}function makeViewBoxTransform(s,a){var o=a.width/s.width,c=a.height/s.height,d=Math.min(o,c);return{scale:d,x:-(s.x+s.width/2)*d+(a.x+a.width/2),y:-(s.y+s.height/2)*d+(a.y+a.height/2)}}function parseSVG(s,a){var o=new SVGParser;return o.parse(s,a)}var REGION_AVAILABLE_SVG_TAG_MAP=createHashMap(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),GeoSVGResource=function(){function s(a,o){this.type="geoSVG",this._usedGraphicMap=createHashMap(),this._freedGraphics=[],this._mapName=a,this._parsedXML=parseXML(o)}return s.prototype.load=function(){var a=this._firstGraphic;if(!a){a=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(a),this._boundingRect=this._firstGraphic.boundingRect.clone();var o=createRegions(a.named),c=o.regions,d=o.regionsMap;this._regions=c,this._regionsMap=d}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},s.prototype._buildGraphic=function(a){var o,c;try{o=a&&parseSVG(a,{ignoreViewBox:!0,ignoreRootClip:!0})||{},c=o.root,assert(c!=null)}catch(yt){throw new Error(`Invalid svg format
`+yt.message)}var d=new Group$3;d.add(c),d.isGeoSVGGraphicRoot=!0;var tt=o.width,nt=o.height,it=o.viewBoxRect,st=this._boundingRect;if(!st){var ut=void 0,ct=void 0,ot=void 0,at=void 0;if(tt!=null?(ut=0,ot=tt):it&&(ut=it.x,ot=it.width),nt!=null?(ct=0,at=nt):it&&(ct=it.y,at=it.height),ut==null||ct==null){var ht=c.getBoundingRect();ut==null&&(ut=ht.x,ot=ht.width),ct==null&&(ct=ht.y,at=ht.height)}st=this._boundingRect=new BoundingRect(ut,ct,ot,at)}if(it){var ft=makeViewBoxTransform(it,st);c.scaleX=c.scaleY=ft.scale,c.x=ft.x,c.y=ft.y}d.setClipPath(new Rect$2({shape:st.plain()}));var mt=[];return each$f(o.named,function(yt){REGION_AVAILABLE_SVG_TAG_MAP.get(yt.svgNodeTagLower)!=null&&(mt.push(yt),setSilent(yt.el))}),{root:d,boundingRect:st,named:mt}},s.prototype.useGraphic=function(a){var o=this._usedGraphicMap,c=o.get(a);return c||(c=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),o.set(a,c),c)},s.prototype.freeGraphic=function(a){var o=this._usedGraphicMap,c=o.get(a);c&&(o.removeKey(a),this._freedGraphics.push(c))},s}();function setSilent(s){s.silent=!1,s.isGroup&&s.traverse(function(a){a.silent=!1})}function createRegions(s){var a=[],o=createHashMap();return each$f(s,function(c){if(c.namedFrom==null){var d=new GeoSVGRegion(c.name,c.el);a.push(d),o.set(c.name,d)}}),{regions:a,regionsMap:o}}var geoCoord=[126,25],nanhaiName="南海诸岛",points$1=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]];for(var i$1=0;i$1<points$1.length;i$1++)for(var k=0;k<points$1[i$1].length;k++)points$1[i$1][k][0]/=10.5,points$1[i$1][k][1]/=-10.5/.75,points$1[i$1][k][0]+=geoCoord[0],points$1[i$1][k][1]+=geoCoord[1];function fixNanhai(s,a){if(s==="china"){for(var o=0;o<a.length;o++)if(a[o].name===nanhaiName)return;a.push(new GeoJSONRegion(nanhaiName,map$1(points$1,function(c){return{type:"polygon",exterior:c}}),geoCoord))}}var coordsOffsetMap={南海诸岛:[32,80],广东:[0,-10],香港:[10,5],澳门:[-10,10],天津:[5,5]};function fixTextCoords(s,a){if(s==="china"){var o=coordsOffsetMap[a.name];if(o){var c=a.getCenter();c[0]+=o[0]/10.5,c[1]+=-o[1]/(10.5/.75),a.setCenter(c)}}}var points=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];function fixDiaoyuIsland(s,a){s==="china"&&a.name==="台湾"&&a.geometries.push({type:"polygon",exterior:points[0]})}var DEFAULT_NAME_PROPERTY="name",GeoJSONResource=function(){function s(a,o,c){this.type="geoJSON",this._parsedMap=createHashMap(),this._mapName=a,this._specialAreas=c,this._geoJSON=parseInput(o)}return s.prototype.load=function(a,o){o=o||DEFAULT_NAME_PROPERTY;var c=this._parsedMap.get(o);if(!c){var d=this._parseToRegions(o);c=this._parsedMap.set(o,{regions:d,boundingRect:calculateBoundingRect(d)})}var tt=createHashMap(),nt=[];return each$f(c.regions,function(it){var st=it.name;a&&hasOwn(a,st)&&(it=it.cloneShallow(st=a[st])),nt.push(it),tt.set(st,it)}),{regions:nt,boundingRect:c.boundingRect||new BoundingRect(0,0,0,0),regionsMap:tt}},s.prototype._parseToRegions=function(a){var o=this._mapName,c=this._geoJSON,d;try{d=c?parseGeoJSON(c,a):[]}catch(tt){throw new Error(`Invalid geoJson format
`+tt.message)}return fixNanhai(o,d),each$f(d,function(tt){var nt=tt.name;fixTextCoords(o,tt),fixDiaoyuIsland(o,tt);var it=this._specialAreas&&this._specialAreas[nt];it&&tt.transformTo(it.left,it.top,it.width,it.height)},this),d},s.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},s}();function calculateBoundingRect(s){for(var a,o=0;o<s.length;o++){var c=s[o].getBoundingRect();a=a||c.clone(),a.union(c)}return a}function parseInput(s){return isString$1(s)?typeof JSON<"u"&&JSON.parse?JSON.parse(s):new Function("return ("+s+");")():s}var storage=createHashMap();const geoSourceManager={registerMap:function(s,a,o){if(a.svg){var c=new GeoSVGResource(s,a.svg);storage.set(s,c)}else{var d=a.geoJson||a.geoJSON;d&&!a.features?o=a.specialAreas:d=a;var c=new GeoJSONResource(s,d,o);storage.set(s,c)}},getGeoResource:function(s){return storage.get(s)},getMapForUser:function(s){var a=storage.get(s);return a&&a.type==="geoJSON"&&a.getMapForUser()},load:function(s,a,o){var c=storage.get(s);if(c)return c.load(a,o)}};var OPTION_STYLE_ENABLED_TAGS=["rect","circle","line","ellipse","polygon","polyline","path"],OPTION_STYLE_ENABLED_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS),STATE_TRIGGER_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),LABEL_HOST_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),mapLabelRaw=makeInner();function getFixedItemStyle(s){var a=s.getItemStyle(),o=s.get("areaColor");return o!=null&&(a.fill=o),a}function fixLineStyle(s){var a=s.style;a&&(a.stroke=a.stroke||a.fill,a.fill=null)}var MapDraw=function(){function s(a){var o=new Group$3;this.uid=getUID("ec_map_draw"),this._controller=new RoamController(a.getZr()),this._controllerHost={target:o},this.group=o,o.add(this._regionsGroup=new Group$3),o.add(this._svgGroup=new Group$3)}return s.prototype.draw=function(a,o,c,d,tt){var nt=a.mainType==="geo",it=a.getData&&a.getData();nt&&o.eachComponent({mainType:"series",subType:"map"},function(bt){!it&&bt.getHostGeoModel()===a&&(it=bt.getData())});var st=a.coordinateSystem,ut=this._regionsGroup,ct=this.group,ot=st.getTransformInfo(),at=ot.raw,ht=ot.roam,ft=!ut.childAt(0)||tt;ft?(ct.x=ht.x,ct.y=ht.y,ct.scaleX=ht.scaleX,ct.scaleY=ht.scaleY,ct.dirty()):updateProps$1(ct,ht,a);var mt=it&&it.getVisual("visualMeta")&&it.getVisual("visualMeta").length>0,yt={api:c,geo:st,mapOrGeoModel:a,data:it,isVisualEncodedByVisualMap:mt,isGeo:nt,transformInfoRaw:at};st.resourceType==="geoJSON"?this._buildGeoJSON(yt):st.resourceType==="geoSVG"&&this._buildSVG(yt),this._updateController(a,o,c),this._updateMapSelectHandler(a,ut,c,d)},s.prototype._buildGeoJSON=function(a){var o=this._regionsGroupByName=createHashMap(),c=createHashMap(),d=this._regionsGroup,tt=a.transformInfoRaw,nt=a.mapOrGeoModel,it=a.data,st=a.geo.projection,ut=st&&st.stream;function ct(ht,ft){return ft&&(ht=ft(ht)),ht&&[ht[0]*tt.scaleX+tt.x,ht[1]*tt.scaleY+tt.y]}function ot(ht){for(var ft=[],mt=!ut&&st&&st.project,yt=0;yt<ht.length;++yt){var bt=ct(ht[yt],mt);bt&&ft.push(bt)}return ft}function at(ht){return{shape:{points:ot(ht)}}}d.removeAll(),each$f(a.geo.regions,function(ht){var ft=ht.name,mt=o.get(ft),yt=c.get(ft)||{},bt=yt.dataIdx,wt=yt.regionModel;if(!mt){mt=o.set(ft,new Group$3),d.add(mt),bt=it?it.indexOfName(ft):null,wt=a.isGeo?nt.getRegionModel(ft):it?it.getItemModel(bt):null;var Tt=wt.get("silent",!0);Tt!=null&&(mt.silent=Tt),c.set(ft,{dataIdx:bt,regionModel:wt})}var Ct=[],Dt=[];each$f(ht.geometries,function(Ft){if(Ft.type==="polygon"){var kt=[Ft.exterior].concat(Ft.interiors||[]);ut&&(kt=projectPolys(kt,ut)),each$f(kt,function(Ht){Ct.push(new Polygon(at(Ht)))})}else{var Vt=Ft.points;ut&&(Vt=projectPolys(Vt,ut,!0)),each$f(Vt,function(Ht){Dt.push(new Polyline$1(at(Ht)))})}});var Ot=ct(ht.getCenter(),st&&st.project);function $t(Ft,kt){if(Ft.length){var Vt=new CompoundPath({culling:!0,segmentIgnoreThreshold:1,shape:{paths:Ft}});mt.add(Vt),applyOptionStyleForRegion(a,Vt,bt,wt),resetLabelForRegion(a,Vt,ft,wt,nt,bt,Ot),kt&&(fixLineStyle(Vt),each$f(Vt.states,fixLineStyle))}}$t(Ct),$t(Dt,!0)}),o.each(function(ht,ft){var mt=c.get(ft),yt=mt.dataIdx,bt=mt.regionModel;resetEventTriggerForRegion(a,ht,ft,bt,nt,yt),resetTooltipForRegion(a,ht,ft,bt,nt),resetStateTriggerForRegion(a,ht,ft,bt,nt)},this)},s.prototype._buildSVG=function(a){var o=a.geo.map,c=a.transformInfoRaw;this._svgGroup.x=c.x,this._svgGroup.y=c.y,this._svgGroup.scaleX=c.scaleX,this._svgGroup.scaleY=c.scaleY,this._svgResourceChanged(o)&&(this._freeSVG(),this._useSVG(o));var d=this._svgDispatcherMap=createHashMap(),tt=!1;each$f(this._svgGraphicRecord.named,function(nt){var it=nt.name,st=a.mapOrGeoModel,ut=a.data,ct=nt.svgNodeTagLower,ot=nt.el,at=ut?ut.indexOfName(it):null,ht=st.getRegionModel(it);OPTION_STYLE_ENABLED_TAG_MAP.get(ct)!=null&&ot instanceof Displayable&&applyOptionStyleForRegion(a,ot,at,ht),ot instanceof Displayable&&(ot.culling=!0);var ft=ht.get("silent",!0);if(ft!=null&&(ot.silent=ft),ot.z2EmphasisLift=0,!nt.namedFrom&&(LABEL_HOST_MAP.get(ct)!=null&&resetLabelForRegion(a,ot,it,ht,st,at,null),resetEventTriggerForRegion(a,ot,it,ht,st,at),resetTooltipForRegion(a,ot,it,ht,st),STATE_TRIGGER_TAG_MAP.get(ct)!=null)){var mt=resetStateTriggerForRegion(a,ot,it,ht,st);mt==="self"&&(tt=!0);var yt=d.get(it)||d.set(it,[]);yt.push(ot)}},this),this._enableBlurEntireSVG(tt,a)},s.prototype._enableBlurEntireSVG=function(a,o){if(a&&o.isGeo){var c=o.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle(),d=c.opacity;this._svgGraphicRecord.root.traverse(function(tt){if(!tt.isGroup){setDefaultStateProxy(tt);var nt=tt.ensureState("blur").style||{};nt.opacity==null&&d!=null&&(nt.opacity=d),tt.ensureState("emphasis")}})}},s.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},s.prototype.findHighDownDispatchers=function(a,o){if(a==null)return[];var c=o.coordinateSystem;if(c.resourceType==="geoJSON"){var d=this._regionsGroupByName;if(d){var tt=d.get(a);return tt?[tt]:[]}}else if(c.resourceType==="geoSVG")return this._svgDispatcherMap&&this._svgDispatcherMap.get(a)||[]},s.prototype._svgResourceChanged=function(a){return this._svgMapName!==a},s.prototype._useSVG=function(a){var o=geoSourceManager.getGeoResource(a);if(o&&o.type==="geoSVG"){var c=o.useGraphic(this.uid);this._svgGroup.add(c.root),this._svgGraphicRecord=c,this._svgMapName=a}},s.prototype._freeSVG=function(){var a=this._svgMapName;if(a!=null){var o=geoSourceManager.getGeoResource(a);o&&o.type==="geoSVG"&&o.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},s.prototype._updateController=function(a,o,c){var d=a.coordinateSystem,tt=this._controller,nt=this._controllerHost;nt.zoomLimit=a.get("scaleLimit"),nt.zoom=d.getZoom(),tt.enable(a.get("roam")||!1);var it=a.mainType;function st(){var ut={type:"geoRoam",componentType:it};return ut[it+"Id"]=a.id,ut}tt.off("pan").on("pan",function(ut){this._mouseDownFlag=!1,updateViewOnPan(nt,ut.dx,ut.dy),c.dispatchAction(extend(st(),{dx:ut.dx,dy:ut.dy,animation:{duration:0}}))},this),tt.off("zoom").on("zoom",function(ut){this._mouseDownFlag=!1,updateViewOnZoom(nt,ut.scale,ut.originX,ut.originY),c.dispatchAction(extend(st(),{totalZoom:nt.zoom,zoom:ut.scale,originX:ut.originX,originY:ut.originY,animation:{duration:0}}))},this),tt.setPointerChecker(function(ut,ct,ot){return d.containPoint([ct,ot])&&!onIrrelevantElement(ut,c,a)})},s.prototype.resetForLabelLayout=function(){this.group.traverse(function(a){var o=a.getTextContent();o&&(o.ignore=mapLabelRaw(o).ignore)})},s.prototype._updateMapSelectHandler=function(a,o,c,d){var tt=this;o.off("mousedown"),o.off("click"),a.get("selectedMode")&&(o.on("mousedown",function(){tt._mouseDownFlag=!0}),o.on("click",function(nt){tt._mouseDownFlag&&(tt._mouseDownFlag=!1)}))},s}();function applyOptionStyleForRegion(s,a,o,c){var d=c.getModel("itemStyle"),tt=c.getModel(["emphasis","itemStyle"]),nt=c.getModel(["blur","itemStyle"]),it=c.getModel(["select","itemStyle"]),st=getFixedItemStyle(d),ut=getFixedItemStyle(tt),ct=getFixedItemStyle(it),ot=getFixedItemStyle(nt),at=s.data;if(at){var ht=at.getItemVisual(o,"style"),ft=at.getItemVisual(o,"decal");s.isVisualEncodedByVisualMap&&ht.fill&&(st.fill=ht.fill),ft&&(st.decal=createOrUpdatePatternFromDecal(ft,s.api))}a.setStyle(st),a.style.strokeNoScale=!0,a.ensureState("emphasis").style=ut,a.ensureState("select").style=ct,a.ensureState("blur").style=ot,setDefaultStateProxy(a)}function resetLabelForRegion(s,a,o,c,d,tt,nt){var it=s.data,st=s.isGeo,ut=it&&isNaN(it.get(it.mapDimension("value"),tt)),ct=it&&it.getItemLayout(tt);if(st||ut||ct&&ct.showLabel){var ot=st?o:tt,at=void 0;(!it||tt>=0)&&(at=d);var ht=nt?{normal:{align:"center",verticalAlign:"middle"}}:null;setLabelStyle(a,getLabelStatesModels(c),{labelFetcher:at,labelDataIndex:ot,defaultText:o},ht);var ft=a.getTextContent();if(ft&&(mapLabelRaw(ft).ignore=ft.ignore,a.textConfig&&nt)){var mt=a.getBoundingRect().clone();a.textConfig.layoutRect=mt,a.textConfig.position=[(nt[0]-mt.x)/mt.width*100+"%",(nt[1]-mt.y)/mt.height*100+"%"]}a.disableLabelAnimation=!0}else a.removeTextContent(),a.removeTextConfig(),a.disableLabelAnimation=null}function resetEventTriggerForRegion(s,a,o,c,d,tt){s.data?s.data.setItemGraphicEl(tt,a):getECData(a).eventData={componentType:"geo",componentIndex:d.componentIndex,geoIndex:d.componentIndex,name:o,region:c&&c.option||{}}}function resetTooltipForRegion(s,a,o,c,d){s.data||setTooltipConfig({el:a,componentModel:d,itemName:o,itemTooltipOption:c.get("tooltip")})}function resetStateTriggerForRegion(s,a,o,c,d){a.highDownSilentOnTouch=!!d.get("selectedMode");var tt=c.getModel("emphasis"),nt=tt.get("focus");return toggleHoverEmphasis(a,nt,tt.get("blurScope"),tt.get("disabled")),s.isGeo&&enableComponentHighDownFeatures(a,d,o),nt}function projectPolys(s,a,o){var c=[],d;function tt(){d=[]}function nt(){d.length&&(c.push(d),d=[])}var it=a({polygonStart:tt,polygonEnd:nt,lineStart:tt,lineEnd:nt,point:function(st,ut){isFinite(st)&&isFinite(ut)&&d.push([st,ut])},sphere:function(){}});return!o&&it.polygonStart(),each$f(s,function(st){it.lineStart();for(var ut=0;ut<st.length;ut++)it.point(st[ut][0],st[ut][1]);it.lineEnd()}),!o&&it.polygonEnd(),c}var MapView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d,tt){if(!(tt&&tt.type==="mapToggleSelect"&&tt.from===this.uid)){var nt=this.group;if(nt.removeAll(),!o.getHostGeoModel()){if(this._mapDraw&&tt&&tt.type==="geoRoam"&&this._mapDraw.resetForLabelLayout(),tt&&tt.type==="geoRoam"&&tt.componentType==="series"&&tt.seriesId===o.id){var it=this._mapDraw;it&&nt.add(it.group)}else if(o.needsDrawMap){var it=this._mapDraw||new MapDraw(d);nt.add(it.group),it.draw(o,c,d,this,tt),this._mapDraw=it}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;o.get("showLegendSymbol")&&c.getComponent("legend")&&this._renderSymbols(o,c,d)}}},a.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},a.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},a.prototype._renderSymbols=function(o,c,d){var tt=o.originalData,nt=this.group;tt.each(tt.mapDimension("value"),function(it,st){if(!isNaN(it)){var ut=tt.getItemLayout(st);if(!(!ut||!ut.point)){var ct=ut.point,ot=ut.offset,at=new Circle({style:{fill:o.getData().getVisual("style").fill},shape:{cx:ct[0]+ot*9,cy:ct[1],r:3},silent:!0,z2:8+(ot?0:Z2_EMPHASIS_LIFT+1)});if(!ot){var ht=o.mainSeries.getData(),ft=tt.getName(st),mt=ht.indexOfName(ft),yt=tt.getItemModel(st),bt=yt.getModel("label"),wt=ht.getItemGraphicEl(mt);setLabelStyle(at,getLabelStatesModels(yt),{labelFetcher:{getFormattedLabel:function(Tt,Ct){return o.getFormattedLabel(mt,Ct)}},defaultText:ft}),at.disableLabelAnimation=!0,bt.get("position")||at.setTextConfig({position:"bottom"}),wt.onHoverStateChange=function(Tt){setStatesFlag(at,Tt)}}nt.add(at)}}})},a.type="map",a}(ChartView),MapSeries=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.needsDrawMap=!1,o.seriesGroup=[],o.getTooltipPosition=function(c){if(c!=null){var d=this.getData().getName(c),tt=this.coordinateSystem,nt=tt.getRegion(d);return nt&&tt.dataToPoint(nt.getCenter())}},o}return a.prototype.getInitialData=function(o){for(var c=createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)}),d=createHashMap(),tt=[],nt=0,it=c.count();nt<it;nt++){var st=c.getName(nt);d.set(st,nt)}var ut=geoSourceManager.load(this.getMapType(),this.option.nameMap,this.option.nameProperty);return each$f(ut.regions,function(ct){var ot=ct.name,at=d.get(ot),ht=ct.properties&&ct.properties.echartsStyle,ft;at==null?(ft={name:ot},tt.push(ft)):ft=c.getRawDataItem(at),ht&&merge(ft,ht)}),c.appendData(tt),c},a.prototype.getHostGeoModel=function(){var o=this.option.geoIndex;return o!=null?this.ecModel.getComponent("geo",o):null},a.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},a.prototype.getRawValue=function(o){var c=this.getData();return c.get(c.mapDimension("value"),o)},a.prototype.getRegionModel=function(o){var c=this.getData();return c.getItemModel(c.indexOfName(o))},a.prototype.formatTooltip=function(o,c,d){for(var tt=this.getData(),nt=this.getRawValue(o),it=tt.getName(o),st=this.seriesGroup,ut=[],ct=0;ct<st.length;ct++){var ot=st[ct].originalData.indexOfName(it),at=tt.mapDimension("value");isNaN(st[ct].originalData.get(at,ot))||ut.push(st[ct].name)}return createTooltipMarkup("section",{header:ut.join(", "),noHeader:!ut.length,blocks:[createTooltipMarkup("nameValue",{name:it,value:nt})]})},a.prototype.setZoom=function(o){this.option.zoom=o},a.prototype.setCenter=function(o){this.option.center=o},a.prototype.getLegendIcon=function(o){var c=o.icon||"roundRect",d=createSymbol$1(c,0,0,o.itemWidth,o.itemHeight,o.itemStyle.fill);return d.setStyle(o.itemStyle),d.style.stroke="none",c.indexOf("empty")>-1&&(d.style.stroke=d.style.fill,d.style.fill="#fff",d.style.lineWidth=2),d},a.type="series.map",a.dependencies=["geo"],a.layoutMode="box",a.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},a}(SeriesModel);function dataStatistics(s,a){var o={};return each$f(s,function(c){c.each(c.mapDimension("value"),function(d,tt){var nt="ec-"+c.getName(tt);o[nt]=o[nt]||[],isNaN(d)||o[nt].push(d)})}),s[0].map(s[0].mapDimension("value"),function(c,d){for(var tt="ec-"+s[0].getName(d),nt=0,it=1/0,st=-1/0,ut=o[tt].length,ct=0;ct<ut;ct++)it=Math.min(it,o[tt][ct]),st=Math.max(st,o[tt][ct]),nt+=o[tt][ct];var ot;return a==="min"?ot=it:a==="max"?ot=st:a==="average"?ot=nt/ut:ot=nt,ut===0?NaN:ot})}function mapDataStatistic(s){var a={};s.eachSeriesByType("map",function(o){var c=o.getHostGeoModel(),d=c?"o"+c.id:"i"+o.getMapType();(a[d]=a[d]||[]).push(o)}),each$f(a,function(o,c){for(var d=dataStatistics(map$1(o,function(nt){return nt.getData()}),o[0].get("mapValueCalculation")),tt=0;tt<o.length;tt++)o[tt].originalData=o[tt].getData();for(var tt=0;tt<o.length;tt++)o[tt].seriesGroup=o,o[tt].needsDrawMap=tt===0&&!o[tt].getHostGeoModel(),o[tt].setData(d.cloneShallow()),o[tt].mainSeries=o[0]})}function mapSymbolLayout(s){var a={};s.eachSeriesByType("map",function(o){var c=o.getMapType();if(!(o.getHostGeoModel()||a[c])){var d={};each$f(o.seriesGroup,function(nt){var it=nt.coordinateSystem,st=nt.originalData;nt.get("showLegendSymbol")&&s.getComponent("legend")&&st.each(st.mapDimension("value"),function(ut,ct){var ot=st.getName(ct),at=it.getRegion(ot);if(!(!at||isNaN(ut))){var ht=d[ot]||0,ft=it.dataToPoint(at.getCenter());d[ot]=ht+1,st.setItemLayout(ct,{point:ft,offset:ht})}})});var tt=o.getData();tt.each(function(nt){var it=tt.getName(nt),st=tt.getItemLayout(nt)||{};st.showLabel=!d[it],tt.setItemLayout(nt,st)}),a[c]=!0}})}var v2ApplyTransform=applyTransform$1,View=function(s){__extends$1(a,s);function a(o){var c=s.call(this)||this;return c.type="view",c.dimensions=["x","y"],c._roamTransformable=new Transformable,c._rawTransformable=new Transformable,c.name=o,c}return a.prototype.setBoundingRect=function(o,c,d,tt){return this._rect=new BoundingRect(o,c,d,tt),this._rect},a.prototype.getBoundingRect=function(){return this._rect},a.prototype.setViewRect=function(o,c,d,tt){this._transformTo(o,c,d,tt),this._viewRect=new BoundingRect(o,c,d,tt)},a.prototype._transformTo=function(o,c,d,tt){var nt=this.getBoundingRect(),it=this._rawTransformable;it.transform=nt.calculateTransform(new BoundingRect(o,c,d,tt));var st=it.parent;it.parent=null,it.decomposeTransform(),it.parent=st,this._updateTransform()},a.prototype.setCenter=function(o,c){o&&(this._center=[parsePercent(o[0],c.getWidth()),parsePercent(o[1],c.getHeight())],this._updateCenterAndZoom())},a.prototype.setZoom=function(o){o=o||1;var c=this.zoomLimit;c&&(c.max!=null&&(o=Math.min(c.max,o)),c.min!=null&&(o=Math.max(c.min,o))),this._zoom=o,this._updateCenterAndZoom()},a.prototype.getDefaultCenter=function(){var o=this.getBoundingRect(),c=o.x+o.width/2,d=o.y+o.height/2;return[c,d]},a.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},a.prototype.getZoom=function(){return this._zoom||1},a.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},a.prototype._updateCenterAndZoom=function(){var o=this._rawTransformable.getLocalTransform(),c=this._roamTransformable,d=this.getDefaultCenter(),tt=this.getCenter(),nt=this.getZoom();tt=applyTransform$1([],tt,o),d=applyTransform$1([],d,o),c.originX=tt[0],c.originY=tt[1],c.x=d[0]-tt[0],c.y=d[1]-tt[1],c.scaleX=c.scaleY=nt,this._updateTransform()},a.prototype._updateTransform=function(){var o=this._roamTransformable,c=this._rawTransformable;c.parent=o,o.updateTransform(),c.updateTransform(),copy(this.transform||(this.transform=[]),c.transform||create$1()),this._rawTransform=c.getLocalTransform(),this.invTransform=this.invTransform||[],invert(this.invTransform,this.transform),this.decomposeTransform()},a.prototype.getTransformInfo=function(){var o=this._rawTransformable,c=this._roamTransformable,d=new Transformable;return d.transform=c.transform,d.decomposeTransform(),{roam:{x:d.x,y:d.y,scaleX:d.scaleX,scaleY:d.scaleY},raw:{x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY}}},a.prototype.getViewRect=function(){return this._viewRect},a.prototype.getViewRectAfterRoam=function(){var o=this.getBoundingRect().clone();return o.applyTransform(this.transform),o},a.prototype.dataToPoint=function(o,c,d){var tt=c?this._rawTransform:this.transform;return d=d||[],tt?v2ApplyTransform(d,o,tt):copy$1(d,o)},a.prototype.pointToData=function(o){var c=this.invTransform;return c?v2ApplyTransform([],o,c):[o[0],o[1]]},a.prototype.convertToPixel=function(o,c,d){var tt=getCoordSys$4(c);return tt===this?tt.dataToPoint(d):null},a.prototype.convertFromPixel=function(o,c,d){var tt=getCoordSys$4(c);return tt===this?tt.pointToData(d):null},a.prototype.containPoint=function(o){return this.getViewRectAfterRoam().contain(o[0],o[1])},a.dimensions=["x","y"],a}(Transformable);function getCoordSys$4(s){var a=s.seriesModel;return a?a.coordinateSystem:null}var GEO_DEFAULT_PARAMS={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},geo2DDimensions=["lng","lat"],Geo=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this,o)||this;tt.dimensions=geo2DDimensions,tt.type="geo",tt._nameCoordMap=createHashMap(),tt.map=c;var nt=d.projection,it=geoSourceManager.load(c,d.nameMap,d.nameProperty),st=geoSourceManager.getGeoResource(c);tt.resourceType=st?st.type:null;var ut=tt.regions=it.regions,ct=GEO_DEFAULT_PARAMS[st.type];tt._regionsMap=it.regionsMap,tt.regions=it.regions,tt.projection=nt;var ot;if(nt)for(var at=0;at<ut.length;at++){var ht=ut[at].getBoundingRect(nt);ot=ot||ht.clone(),ot.union(ht)}else ot=it.boundingRect;return tt.setBoundingRect(ot.x,ot.y,ot.width,ot.height),tt.aspectScale=nt?1:retrieve2(d.aspectScale,ct.aspectScale),tt._invertLongitute=nt?!1:ct.invertLongitute,tt}return a.prototype._transformTo=function(o,c,d,tt){var nt=this.getBoundingRect(),it=this._invertLongitute;nt=nt.clone(),it&&(nt.y=-nt.y-nt.height);var st=this._rawTransformable;st.transform=nt.calculateTransform(new BoundingRect(o,c,d,tt));var ut=st.parent;st.parent=null,st.decomposeTransform(),st.parent=ut,it&&(st.scaleY=-st.scaleY),this._updateTransform()},a.prototype.getRegion=function(o){return this._regionsMap.get(o)},a.prototype.getRegionByCoord=function(o){for(var c=this.regions,d=0;d<c.length;d++){var tt=c[d];if(tt.type==="geoJSON"&&tt.contain(o))return c[d]}},a.prototype.addGeoCoord=function(o,c){this._nameCoordMap.set(o,c)},a.prototype.getGeoCoord=function(o){var c=this._regionsMap.get(o);return this._nameCoordMap.get(o)||c&&c.getCenter()},a.prototype.dataToPoint=function(o,c,d){if(isString$1(o)&&(o=this.getGeoCoord(o)),o){var tt=this.projection;return tt&&(o=tt.project(o)),o&&this.projectedToPoint(o,c,d)}},a.prototype.pointToData=function(o){var c=this.projection;return c&&(o=c.unproject(o)),o&&this.pointToProjected(o)},a.prototype.pointToProjected=function(o){return s.prototype.pointToData.call(this,o)},a.prototype.projectedToPoint=function(o,c,d){return s.prototype.dataToPoint.call(this,o,c,d)},a.prototype.convertToPixel=function(o,c,d){var tt=getCoordSys$3(c);return tt===this?tt.dataToPoint(d):null},a.prototype.convertFromPixel=function(o,c,d){var tt=getCoordSys$3(c);return tt===this?tt.pointToData(d):null},a}(View);mixin(Geo,View);function getCoordSys$3(s){var a=s.geoModel,o=s.seriesModel;return a?a.coordinateSystem:o?o.coordinateSystem||(o.getReferringComponents("geo",SINGLE_REFERRING).models[0]||{}).coordinateSystem:null}function resizeGeo(s,a){var o=s.get("boundingCoords");if(o!=null){var c=o[0],d=o[1];if(isFinite(c[0])&&isFinite(c[1])&&isFinite(d[0])&&isFinite(d[1])){var tt=this.projection;if(tt){var nt=c[0],it=c[1],st=d[0],ut=d[1];c=[1/0,1/0],d=[-1/0,-1/0];var ct=function(Ot,$t,Ft,kt){for(var Vt=Ft-Ot,Ht=kt-$t,Qt=0;Qt<=100;Qt++){var Xt=Qt/100,Zt=tt.project([Ot+Vt*Xt,$t+Ht*Xt]);min$1(c,c,Zt),max$2(d,d,Zt)}};ct(nt,it,st,it),ct(st,it,st,ut),ct(st,ut,nt,ut),ct(nt,ut,st,it)}this.setBoundingRect(c[0],c[1],d[0]-c[0],d[1]-c[1])}}var ot=this.getBoundingRect(),at=s.get("layoutCenter"),ht=s.get("layoutSize"),ft=a.getWidth(),mt=a.getHeight(),yt=ot.width/ot.height*this.aspectScale,bt=!1,wt,Tt;at&&ht&&(wt=[parsePercent(at[0],ft),parsePercent(at[1],mt)],Tt=parsePercent(ht,Math.min(ft,mt)),!isNaN(wt[0])&&!isNaN(wt[1])&&!isNaN(Tt)&&(bt=!0));var Ct;if(bt)Ct={},yt>1?(Ct.width=Tt,Ct.height=Tt/yt):(Ct.height=Tt,Ct.width=Tt*yt),Ct.y=wt[1]-Ct.height/2,Ct.x=wt[0]-Ct.width/2;else{var Dt=s.getBoxLayoutParams();Dt.aspect=yt,Ct=getLayoutRect(Dt,{width:ft,height:mt})}this.setViewRect(Ct.x,Ct.y,Ct.width,Ct.height),this.setCenter(s.get("center"),a),this.setZoom(s.get("zoom"))}function setGeoCoords(s,a){each$f(a.get("geoCoord"),function(o,c){s.addGeoCoord(c,o)})}var GeoCreator=function(){function s(){this.dimensions=geo2DDimensions}return s.prototype.create=function(a,o){var c=[];function d(nt){return{nameProperty:nt.get("nameProperty"),aspectScale:nt.get("aspectScale"),projection:nt.get("projection")}}a.eachComponent("geo",function(nt,it){var st=nt.get("map"),ut=new Geo(st+it,st,extend({nameMap:nt.get("nameMap")},d(nt)));ut.zoomLimit=nt.get("scaleLimit"),c.push(ut),nt.coordinateSystem=ut,ut.model=nt,ut.resize=resizeGeo,ut.resize(nt,o)}),a.eachSeries(function(nt){var it=nt.get("coordinateSystem");if(it==="geo"){var st=nt.get("geoIndex")||0;nt.coordinateSystem=c[st]}});var tt={};return a.eachSeriesByType("map",function(nt){if(!nt.getHostGeoModel()){var it=nt.getMapType();tt[it]=tt[it]||[],tt[it].push(nt)}}),each$f(tt,function(nt,it){var st=map$1(nt,function(ct){return ct.get("nameMap")}),ut=new Geo(it,it,extend({nameMap:mergeAll(st)},d(nt[0])));ut.zoomLimit=retrieve.apply(null,map$1(nt,function(ct){return ct.get("scaleLimit")})),c.push(ut),ut.resize=resizeGeo,ut.resize(nt[0],o),each$f(nt,function(ct){ct.coordinateSystem=ut,setGeoCoords(ut,ct)})}),c},s.prototype.getFilledRegions=function(a,o,c,d){for(var tt=(a||[]).slice(),nt=createHashMap(),it=0;it<tt.length;it++)nt.set(tt[it].name,tt[it]);var st=geoSourceManager.load(o,c,d);return each$f(st.regions,function(ut){var ct=ut.name,ot=nt.get(ct),at=ut.properties&&ut.properties.echartsStyle;ot||(ot={name:ct},tt.push(ot)),at&&merge(ot,at)}),tt},s}(),geoCreator=new GeoCreator,GeoModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c,d){var tt=geoSourceManager.getGeoResource(o.map);if(tt&&tt.type==="geoJSON"){var nt=o.itemStyle=o.itemStyle||{};"color"in nt||(nt.color="#eee")}this.mergeDefaultAndTheme(o,d),defaultEmphasis(o,"label",["show"])},a.prototype.optionUpdated=function(){var o=this,c=this.option;c.regions=geoCreator.getFilledRegions(c.regions,c.map,c.nameMap,c.nameProperty);var d={};this._optionModelMap=reduce(c.regions||[],function(tt,nt){var it=nt.name;return it&&(tt.set(it,new Model(nt,o,o.ecModel)),nt.selected&&(d[it]=!0)),tt},createHashMap()),c.selectedMap||(c.selectedMap=d)},a.prototype.getRegionModel=function(o){return this._optionModelMap.get(o)||new Model(null,this,this.ecModel)},a.prototype.getFormattedLabel=function(o,c){var d=this.getRegionModel(o),tt=c==="normal"?d.get(["label","formatter"]):d.get(["emphasis","label","formatter"]),nt={name:o};if(isFunction$1(tt))return nt.status=c,tt(nt);if(isString$1(tt))return tt.replace("{a}",o??"")},a.prototype.setZoom=function(o){this.option.zoom=o},a.prototype.setCenter=function(o){this.option.center=o},a.prototype.select=function(o){var c=this.option,d=c.selectedMode;if(d){d!=="multiple"&&(c.selectedMap=null);var tt=c.selectedMap||(c.selectedMap={});tt[o]=!0}},a.prototype.unSelect=function(o){var c=this.option.selectedMap;c&&(c[o]=!1)},a.prototype.toggleSelected=function(o){this[this.isSelected(o)?"unSelect":"select"](o)},a.prototype.isSelected=function(o){var c=this.option.selectedMap;return!!(c&&c[o])},a.type="geo",a.layoutMode="box",a.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},a}(ComponentModel);function getCenterCoord(s,a){return s.pointToProjected?s.pointToProjected(a):s.pointToData(a)}function updateCenterAndZoom(s,a,o,c){var d=s.getZoom(),tt=s.getCenter(),nt=a.zoom,it=s.projectedToPoint?s.projectedToPoint(tt):s.dataToPoint(tt);if(a.dx!=null&&a.dy!=null&&(it[0]-=a.dx,it[1]-=a.dy,s.setCenter(getCenterCoord(s,it),c)),nt!=null){if(o){var st=o.min||0,ut=o.max||1/0;nt=Math.max(Math.min(d*nt,ut),st)/d}s.scaleX*=nt,s.scaleY*=nt;var ct=(a.originX-s.x)*(nt-1),ot=(a.originY-s.y)*(nt-1);s.x-=ct,s.y-=ot,s.updateTransform(),s.setCenter(getCenterCoord(s,it),c),s.setZoom(nt*d)}return{center:s.getCenter(),zoom:s.getZoom()}}var GeoView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.focusBlurEnabled=!0,o}return a.prototype.init=function(o,c){this._api=c},a.prototype.render=function(o,c,d,tt){if(this._model=o,!o.get("show")){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;return}this._mapDraw||(this._mapDraw=new MapDraw(d));var nt=this._mapDraw;nt.draw(o,c,d,this,tt),nt.group.on("click",this._handleRegionClick,this),nt.group.silent=o.get("silent"),this.group.add(nt.group),this.updateSelectStatus(o,c,d)},a.prototype._handleRegionClick=function(o){var c;findEventDispatcher(o.target,function(d){return(c=getECData(d).eventData)!=null},!0),c&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:c.name})},a.prototype.updateSelectStatus=function(o,c,d){var tt=this;this._mapDraw.group.traverse(function(nt){var it=getECData(nt).eventData;if(it)return tt._model.isSelected(it.name)?d.enterSelect(nt):d.leaveSelect(nt),!0})},a.prototype.findHighDownDispatchers=function(o){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(o,this._model)},a.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},a.type="geo",a}(ComponentView);function registerMap(s,a,o){geoSourceManager.registerMap(s,a,o)}function install$J(s){s.registerCoordinateSystem("geo",geoCreator),s.registerComponentModel(GeoModel),s.registerComponentView(GeoView),s.registerImpl("registerMap",registerMap),s.registerImpl("getMap",function(o){return geoSourceManager.getMapForUser(o)});function a(o,c){c.update="geo:updateSelectStatus",s.registerAction(c,function(d,tt){var nt={},it=[];return tt.eachComponent({mainType:"geo",query:d},function(st){st[o](d.name);var ut=st.coordinateSystem;each$f(ut.regions,function(ot){nt[ot.name]=st.isSelected(ot.name)||!1});var ct=[];each$f(nt,function(ot,at){nt[at]&&ct.push(at)}),it.push({geoIndex:st.componentIndex,name:ct})}),{selected:nt,allSelected:it,name:d.name}})}a("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),a("select",{type:"geoSelect",event:"geoselected"}),a("unSelect",{type:"geoUnSelect",event:"geounselected"}),s.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(o,c,d){var tt=o.componentType||"series";c.eachComponent({mainType:tt,query:o},function(nt){var it=nt.coordinateSystem;if(it.type==="geo"){var st=updateCenterAndZoom(it,o,nt.get("scaleLimit"),d);nt.setCenter&&nt.setCenter(st.center),nt.setZoom&&nt.setZoom(st.zoom),tt==="series"&&each$f(nt.seriesGroup,function(ut){ut.setCenter(st.center),ut.setZoom(st.zoom)})}})})}function install$I(s){use(install$J),s.registerChartView(MapView),s.registerSeriesModel(MapSeries),s.registerLayout(mapSymbolLayout),s.registerProcessor(s.PRIORITY.PROCESSOR.STATISTIC,mapDataStatistic),createLegacyDataSelectAction("map",s.registerAction)}function init(s){var a=s;a.hierNode={defaultAncestor:null,ancestor:a,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var o=[a],c,d;c=o.pop();)if(d=c.children,c.isExpand&&d.length)for(var tt=d.length,nt=tt-1;nt>=0;nt--){var it=d[nt];it.hierNode={defaultAncestor:null,ancestor:it,prelim:0,modifier:0,change:0,shift:0,i:nt,thread:null},o.push(it)}}function firstWalk(s,a){var o=s.isExpand?s.children:[],c=s.parentNode.children,d=s.hierNode.i?c[s.hierNode.i-1]:null;if(o.length){executeShifts(s);var tt=(o[0].hierNode.prelim+o[o.length-1].hierNode.prelim)/2;d?(s.hierNode.prelim=d.hierNode.prelim+a(s,d),s.hierNode.modifier=s.hierNode.prelim-tt):s.hierNode.prelim=tt}else d&&(s.hierNode.prelim=d.hierNode.prelim+a(s,d));s.parentNode.hierNode.defaultAncestor=apportion(s,d,s.parentNode.hierNode.defaultAncestor||c[0],a)}function secondWalk(s){var a=s.hierNode.prelim+s.parentNode.hierNode.modifier;s.setLayout({x:a},!0),s.hierNode.modifier+=s.parentNode.hierNode.modifier}function separation(s){return arguments.length?s:defaultSeparation}function radialCoordinate(s,a){return s-=Math.PI/2,{x:a*Math.cos(s),y:a*Math.sin(s)}}function getViewRect$4(s,a){return getLayoutRect(s.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})}function executeShifts(s){for(var a=s.children,o=a.length,c=0,d=0;--o>=0;){var tt=a[o];tt.hierNode.prelim+=c,tt.hierNode.modifier+=c,d+=tt.hierNode.change,c+=tt.hierNode.shift+d}}function apportion(s,a,o,c){if(a){for(var d=s,tt=s,nt=tt.parentNode.children[0],it=a,st=d.hierNode.modifier,ut=tt.hierNode.modifier,ct=nt.hierNode.modifier,ot=it.hierNode.modifier;it=nextRight(it),tt=nextLeft(tt),it&&tt;){d=nextRight(d),nt=nextLeft(nt),d.hierNode.ancestor=s;var at=it.hierNode.prelim+ot-tt.hierNode.prelim-ut+c(it,tt);at>0&&(moveSubtree(nextAncestor(it,s,o),s,at),ut+=at,st+=at),ot+=it.hierNode.modifier,ut+=tt.hierNode.modifier,st+=d.hierNode.modifier,ct+=nt.hierNode.modifier}it&&!nextRight(d)&&(d.hierNode.thread=it,d.hierNode.modifier+=ot-st),tt&&!nextLeft(nt)&&(nt.hierNode.thread=tt,nt.hierNode.modifier+=ut-ct,o=s)}return o}function nextRight(s){var a=s.children;return a.length&&s.isExpand?a[a.length-1]:s.hierNode.thread}function nextLeft(s){var a=s.children;return a.length&&s.isExpand?a[0]:s.hierNode.thread}function nextAncestor(s,a,o){return s.hierNode.ancestor.parentNode===a.parentNode?s.hierNode.ancestor:o}function moveSubtree(s,a,o){var c=o/(a.hierNode.i-s.hierNode.i);a.hierNode.change-=c,a.hierNode.shift+=o,a.hierNode.modifier+=o,a.hierNode.prelim+=o,s.hierNode.change+=c}function defaultSeparation(s,a){return s.parentNode===a.parentNode?1:2}var TreeEdgeShape=function(){function s(){this.parentPoint=[],this.childPoints=[]}return s}(),TreePath=function(s){__extends$1(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new TreeEdgeShape},a.prototype.buildPath=function(o,c){var d=c.childPoints,tt=d.length,nt=c.parentPoint,it=d[0],st=d[tt-1];if(tt===1){o.moveTo(nt[0],nt[1]),o.lineTo(it[0],it[1]);return}var ut=c.orient,ct=ut==="TB"||ut==="BT"?0:1,ot=1-ct,at=parsePercent(c.forkPosition,1),ht=[];ht[ct]=nt[ct],ht[ot]=nt[ot]+(st[ot]-nt[ot])*at,o.moveTo(nt[0],nt[1]),o.lineTo(ht[0],ht[1]),o.moveTo(it[0],it[1]),ht[ct]=it[ct],o.lineTo(ht[0],ht[1]),ht[ct]=st[ct],o.lineTo(ht[0],ht[1]),o.lineTo(st[0],st[1]);for(var ft=1;ft<tt-1;ft++){var mt=d[ft];o.moveTo(mt[0],mt[1]),ht[ct]=mt[ct],o.lineTo(ht[0],ht[1])}},a}(Path),TreeView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._mainGroup=new Group$3,o}return a.prototype.init=function(o,c){this._controller=new RoamController(c.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},a.prototype.render=function(o,c,d){var tt=o.getData(),nt=o.layoutInfo,it=this._mainGroup,st=o.get("layout");st==="radial"?(it.x=nt.x+nt.width/2,it.y=nt.y+nt.height/2):(it.x=nt.x,it.y=nt.y),this._updateViewCoordSys(o,d),this._updateController(o,c,d);var ut=this._data;tt.diff(ut).add(function(ct){symbolNeedsDraw(tt,ct)&&updateNode(tt,ct,null,it,o)}).update(function(ct,ot){var at=ut.getItemGraphicEl(ot);if(!symbolNeedsDraw(tt,ct)){at&&removeNode(ut,ot,at,it,o);return}updateNode(tt,ct,at,it,o)}).remove(function(ct){var ot=ut.getItemGraphicEl(ct);ot&&removeNode(ut,ct,ot,it,o)}).execute(),this._nodeScaleRatio=o.get("nodeScaleRatio"),this._updateNodeAndLinkScale(o),o.get("expandAndCollapse")===!0&&tt.eachItemGraphicEl(function(ct,ot){ct.off("click").on("click",function(){d.dispatchAction({type:"treeExpandAndCollapse",seriesId:o.id,dataIndex:ot})})}),this._data=tt},a.prototype._updateViewCoordSys=function(o,c){var d=o.getData(),tt=[];d.each(function(ot){var at=d.getItemLayout(ot);at&&!isNaN(at.x)&&!isNaN(at.y)&&tt.push([+at.x,+at.y])});var nt=[],it=[];fromPoints(tt,nt,it);var st=this._min,ut=this._max;it[0]-nt[0]===0&&(nt[0]=st?st[0]:nt[0]-1,it[0]=ut?ut[0]:it[0]+1),it[1]-nt[1]===0&&(nt[1]=st?st[1]:nt[1]-1,it[1]=ut?ut[1]:it[1]+1);var ct=o.coordinateSystem=new View;ct.zoomLimit=o.get("scaleLimit"),ct.setBoundingRect(nt[0],nt[1],it[0]-nt[0],it[1]-nt[1]),ct.setCenter(o.get("center"),c),ct.setZoom(o.get("zoom")),this.group.attr({x:ct.x,y:ct.y,scaleX:ct.scaleX,scaleY:ct.scaleY}),this._min=nt,this._max=it},a.prototype._updateController=function(o,c,d){var tt=this,nt=this._controller,it=this._controllerHost,st=this.group;nt.setPointerChecker(function(ut,ct,ot){var at=st.getBoundingRect();return at.applyTransform(st.transform),at.contain(ct,ot)&&!onIrrelevantElement(ut,d,o)}),nt.enable(o.get("roam")),it.zoomLimit=o.get("scaleLimit"),it.zoom=o.coordinateSystem.getZoom(),nt.off("pan").off("zoom").on("pan",function(ut){updateViewOnPan(it,ut.dx,ut.dy),d.dispatchAction({seriesId:o.id,type:"treeRoam",dx:ut.dx,dy:ut.dy})}).on("zoom",function(ut){updateViewOnZoom(it,ut.scale,ut.originX,ut.originY),d.dispatchAction({seriesId:o.id,type:"treeRoam",zoom:ut.scale,originX:ut.originX,originY:ut.originY}),tt._updateNodeAndLinkScale(o),d.updateLabelLayout()})},a.prototype._updateNodeAndLinkScale=function(o){var c=o.getData(),d=this._getNodeGlobalScale(o);c.eachItemGraphicEl(function(tt,nt){tt.setSymbolScale(d)})},a.prototype._getNodeGlobalScale=function(o){var c=o.coordinateSystem;if(c.type!=="view")return 1;var d=this._nodeScaleRatio,tt=c.scaleX||1,nt=c.getZoom(),it=(nt-1)*d+1;return it/tt},a.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},a.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},a.type="tree",a}(ChartView);function symbolNeedsDraw(s,a){var o=s.getItemLayout(a);return o&&!isNaN(o.x)&&!isNaN(o.y)}function updateNode(s,a,o,c,d){var tt=!o,nt=s.tree.getNodeByDataIndex(a),it=nt.getModel(),st=nt.getVisual("style").fill,ut=nt.isExpand===!1&&nt.children.length!==0?st:"#fff",ct=s.tree.root,ot=nt.parentNode===ct?nt:nt.parentNode||nt,at=s.getItemGraphicEl(ot.dataIndex),ht=ot.getLayout(),ft=at?{x:at.__oldX,y:at.__oldY,rawX:at.__radialOldRawX,rawY:at.__radialOldRawY}:ht,mt=nt.getLayout();tt?(o=new Symbol$1(s,a,null,{symbolInnerColor:ut,useNameLabel:!0}),o.x=ft.x,o.y=ft.y):o.updateData(s,a,null,{symbolInnerColor:ut,useNameLabel:!0}),o.__radialOldRawX=o.__radialRawX,o.__radialOldRawY=o.__radialRawY,o.__radialRawX=mt.rawX,o.__radialRawY=mt.rawY,c.add(o),s.setItemGraphicEl(a,o),o.__oldX=o.x,o.__oldY=o.y,updateProps$1(o,{x:mt.x,y:mt.y},d);var yt=o.getSymbolPath();if(d.get("layout")==="radial"){var bt=ct.children[0],wt=bt.getLayout(),Tt=bt.children.length,Ct=void 0,Dt=void 0;if(mt.x===wt.x&&nt.isExpand===!0&&bt.children.length){var Ot={x:(bt.children[0].getLayout().x+bt.children[Tt-1].getLayout().x)/2,y:(bt.children[0].getLayout().y+bt.children[Tt-1].getLayout().y)/2};Ct=Math.atan2(Ot.y-wt.y,Ot.x-wt.x),Ct<0&&(Ct=Math.PI*2+Ct),Dt=Ot.x<wt.x,Dt&&(Ct=Ct-Math.PI)}else Ct=Math.atan2(mt.y-wt.y,mt.x-wt.x),Ct<0&&(Ct=Math.PI*2+Ct),nt.children.length===0||nt.children.length!==0&&nt.isExpand===!1?(Dt=mt.x<wt.x,Dt&&(Ct=Ct-Math.PI)):(Dt=mt.x>wt.x,Dt||(Ct=Ct-Math.PI));var $t=Dt?"left":"right",Ft=it.getModel("label"),kt=Ft.get("rotate"),Vt=kt*(Math.PI/180),Ht=yt.getTextContent();Ht&&(yt.setTextConfig({position:Ft.get("position")||$t,rotation:kt==null?-Ct:Vt,origin:"center"}),Ht.setStyle("verticalAlign","middle"))}var Qt=it.get(["emphasis","focus"]),Xt=Qt==="relative"?concatArray(nt.getAncestorsIndices(),nt.getDescendantIndices()):Qt==="ancestor"?nt.getAncestorsIndices():Qt==="descendant"?nt.getDescendantIndices():null;Xt&&(getECData(o).focus=Xt),drawEdge(d,nt,ct,o,ft,ht,mt,c),o.__edge&&(o.onHoverStateChange=function(Zt){if(Zt!=="blur"){var ar=nt.parentNode&&s.getItemGraphicEl(nt.parentNode.dataIndex);ar&&ar.hoverState===HOVER_STATE_BLUR||setStatesFlag(o.__edge,Zt)}})}function drawEdge(s,a,o,c,d,tt,nt,it){var st=a.getModel(),ut=s.get("edgeShape"),ct=s.get("layout"),ot=s.getOrient(),at=s.get(["lineStyle","curveness"]),ht=s.get("edgeForkPosition"),ft=st.getModel("lineStyle").getLineStyle(),mt=c.__edge;if(ut==="curve")a.parentNode&&a.parentNode!==o&&(mt||(mt=c.__edge=new BezierCurve({shape:getEdgeShape(ct,ot,at,d,d)})),updateProps$1(mt,{shape:getEdgeShape(ct,ot,at,tt,nt)},s));else if(ut==="polyline"&&ct==="orthogonal"&&a!==o&&a.children&&a.children.length!==0&&a.isExpand===!0){for(var yt=a.children,bt=[],wt=0;wt<yt.length;wt++){var Tt=yt[wt].getLayout();bt.push([Tt.x,Tt.y])}mt||(mt=c.__edge=new TreePath({shape:{parentPoint:[nt.x,nt.y],childPoints:[[nt.x,nt.y]],orient:ot,forkPosition:ht}})),updateProps$1(mt,{shape:{parentPoint:[nt.x,nt.y],childPoints:bt}},s)}mt&&!(ut==="polyline"&&!a.isExpand)&&(mt.useStyle(defaults({strokeNoScale:!0,fill:null},ft)),setStatesStylesFromModel(mt,st,"lineStyle"),setDefaultStateProxy(mt),it.add(mt))}function removeNodeEdge(s,a,o,c,d){var tt=a.tree.root,nt=getSourceNode(tt,s),it=nt.source,st=nt.sourceLayout,ut=a.getItemGraphicEl(s.dataIndex);if(ut){var ct=a.getItemGraphicEl(it.dataIndex),ot=ct.__edge,at=ut.__edge||(it.isExpand===!1||it.children.length===1?ot:void 0),ht=c.get("edgeShape"),ft=c.get("layout"),mt=c.get("orient"),yt=c.get(["lineStyle","curveness"]);at&&(ht==="curve"?removeElement(at,{shape:getEdgeShape(ft,mt,yt,st,st),style:{opacity:0}},c,{cb:function(){o.remove(at)},removeOpt:d}):ht==="polyline"&&c.get("layout")==="orthogonal"&&removeElement(at,{shape:{parentPoint:[st.x,st.y],childPoints:[[st.x,st.y]]},style:{opacity:0}},c,{cb:function(){o.remove(at)},removeOpt:d}))}}function getSourceNode(s,a){for(var o=a.parentNode===s?a:a.parentNode||a,c;c=o.getLayout(),c==null;)o=o.parentNode===s?o:o.parentNode||o;return{source:o,sourceLayout:c}}function removeNode(s,a,o,c,d){var tt=s.tree.getNodeByDataIndex(a),nt=s.tree.root,it=getSourceNode(nt,tt).sourceLayout,st={duration:d.get("animationDurationUpdate"),easing:d.get("animationEasingUpdate")};removeElement(o,{x:it.x+1,y:it.y+1},d,{cb:function(){c.remove(o),s.setItemGraphicEl(a,null)},removeOpt:st}),o.fadeOut(null,s.hostModel,{fadeLabel:!0,animation:st}),tt.children.forEach(function(ut){removeNodeEdge(ut,s,c,d,st)}),removeNodeEdge(tt,s,c,d,st)}function getEdgeShape(s,a,o,c,d){var tt,nt,it,st,ut,ct,ot,at;if(s==="radial"){ut=c.rawX,ot=c.rawY,ct=d.rawX,at=d.rawY;var ht=radialCoordinate(ut,ot),ft=radialCoordinate(ut,ot+(at-ot)*o),mt=radialCoordinate(ct,at+(ot-at)*o),yt=radialCoordinate(ct,at);return{x1:ht.x||0,y1:ht.y||0,x2:yt.x||0,y2:yt.y||0,cpx1:ft.x||0,cpy1:ft.y||0,cpx2:mt.x||0,cpy2:mt.y||0}}else ut=c.x,ot=c.y,ct=d.x,at=d.y,(a==="LR"||a==="RL")&&(tt=ut+(ct-ut)*o,nt=ot,it=ct+(ut-ct)*o,st=at),(a==="TB"||a==="BT")&&(tt=ut,nt=ot+(at-ot)*o,it=ct,st=at+(ot-at)*o);return{x1:ut,y1:ot,x2:ct,y2:at,cpx1:tt,cpy1:nt,cpx2:it,cpy2:st}}var inner$e=makeInner();function linkSeriesData(s){var a=s.mainData,o=s.datas;o||(o={main:a},s.datasAttr={main:"data"}),s.datas=s.mainData=null,linkAll(a,o,s),each$f(o,function(c){each$f(a.TRANSFERABLE_METHODS,function(d){c.wrapMethod(d,curry$1(transferInjection,s))})}),a.wrapMethod("cloneShallow",curry$1(cloneShallowInjection,s)),each$f(a.CHANGABLE_METHODS,function(c){a.wrapMethod(c,curry$1(changeInjection,s))}),assert(o[a.dataType]===a)}function transferInjection(s,a){if(isMainData(this)){var o=extend({},inner$e(this).datas);o[this.dataType]=a,linkAll(a,o,s)}else linkSingle(a,this.dataType,inner$e(this).mainData,s);return a}function changeInjection(s,a){return s.struct&&s.struct.update(),a}function cloneShallowInjection(s,a){return each$f(inner$e(a).datas,function(o,c){o!==a&&linkSingle(o.cloneShallow(),c,a,s)}),a}function getLinkedData(s){var a=inner$e(this).mainData;return s==null||a==null?a:inner$e(a).datas[s]}function getLinkedDataAll(){var s=inner$e(this).mainData;return s==null?[{data:s}]:map$1(keys(inner$e(s).datas),function(a){return{type:a,data:inner$e(s).datas[a]}})}function isMainData(s){return inner$e(s).mainData===s}function linkAll(s,a,o){inner$e(s).datas={},each$f(a,function(c,d){linkSingle(c,d,s,o)})}function linkSingle(s,a,o,c){inner$e(o).datas[a]=s,inner$e(s).mainData=o,s.dataType=a,c.struct&&(s[c.structAttr]=c.struct,c.struct[c.datasAttr[a]]=s),s.getLinkedData=getLinkedData,s.getLinkedDataAll=getLinkedDataAll}var TreeNode=function(){function s(a,o){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=a||"",this.hostTree=o}return s.prototype.isRemoved=function(){return this.dataIndex<0},s.prototype.eachNode=function(a,o,c){isFunction$1(a)&&(c=o,o=a,a=null),a=a||{},isString$1(a)&&(a={order:a});var d=a.order||"preorder",tt=this[a.attr||"children"],nt;d==="preorder"&&(nt=o.call(c,this));for(var it=0;!nt&&it<tt.length;it++)tt[it].eachNode(a,o,c);d==="postorder"&&o.call(c,this)},s.prototype.updateDepthAndHeight=function(a){var o=0;this.depth=a;for(var c=0;c<this.children.length;c++){var d=this.children[c];d.updateDepthAndHeight(a+1),d.height>o&&(o=d.height)}this.height=o+1},s.prototype.getNodeById=function(a){if(this.getId()===a)return this;for(var o=0,c=this.children,d=c.length;o<d;o++){var tt=c[o].getNodeById(a);if(tt)return tt}},s.prototype.contains=function(a){if(a===this)return!0;for(var o=0,c=this.children,d=c.length;o<d;o++){var tt=c[o].contains(a);if(tt)return tt}},s.prototype.getAncestors=function(a){for(var o=[],c=a?this:this.parentNode;c;)o.push(c),c=c.parentNode;return o.reverse(),o},s.prototype.getAncestorsIndices=function(){for(var a=[],o=this;o;)a.push(o.dataIndex),o=o.parentNode;return a.reverse(),a},s.prototype.getDescendantIndices=function(){var a=[];return this.eachNode(function(o){a.push(o.dataIndex)}),a},s.prototype.getValue=function(a){var o=this.hostTree.data;return o.getStore().get(o.getDimensionIndex(a||"value"),this.dataIndex)},s.prototype.setLayout=function(a,o){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,a,o)},s.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},s.prototype.getModel=function(a){if(!(this.dataIndex<0)){var o=this.hostTree,c=o.data.getItemModel(this.dataIndex);return c.getModel(a)}},s.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},s.prototype.setVisual=function(a,o){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,a,o)},s.prototype.getVisual=function(a){return this.hostTree.data.getItemVisual(this.dataIndex,a)},s.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},s.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},s.prototype.getChildIndex=function(){if(this.parentNode){for(var a=this.parentNode.children,o=0;o<a.length;++o)if(a[o]===this)return o;return-1}return-1},s.prototype.isAncestorOf=function(a){for(var o=a.parentNode;o;){if(o===this)return!0;o=o.parentNode}return!1},s.prototype.isDescendantOf=function(a){return a!==this&&a.isAncestorOf(this)},s}(),Tree=function(){function s(a){this.type="tree",this._nodes=[],this.hostModel=a}return s.prototype.eachNode=function(a,o,c){this.root.eachNode(a,o,c)},s.prototype.getNodeByDataIndex=function(a){var o=this.data.getRawIndex(a);return this._nodes[o]},s.prototype.getNodeById=function(a){return this.root.getNodeById(a)},s.prototype.update=function(){for(var a=this.data,o=this._nodes,c=0,d=o.length;c<d;c++)o[c].dataIndex=-1;for(var c=0,d=a.count();c<d;c++)o[a.getRawIndex(c)].dataIndex=c},s.prototype.clearLayouts=function(){this.data.clearItemLayouts()},s.createTree=function(a,o,c){var d=new s(o),tt=[],nt=1;it(a);function it(ct,ot){var at=ct.value;nt=Math.max(nt,isArray$1(at)?at.length:1),tt.push(ct);var ht=new TreeNode(convertOptionIdName(ct.name,""),d);ot?addChild(ht,ot):d.root=ht,d._nodes.push(ht);var ft=ct.children;if(ft)for(var mt=0;mt<ft.length;mt++)it(ft[mt],ht)}d.root.updateDepthAndHeight(0);var st=prepareSeriesDataSchema(tt,{coordDimensions:["value"],dimensionsCount:nt}).dimensions,ut=new SeriesData(st,o);return ut.initData(tt),c&&c(ut),linkSeriesData({mainData:ut,struct:d,structAttr:"tree"}),d.update(),d},s}();function addChild(s,a){var o=a.children;s.parentNode!==a&&(o.push(s),s.parentNode=a)}function retrieveTargetInfo(s,a,o){if(s&&indexOf(a,s.type)>=0){var c=o.getData().tree.root,d=s.targetNode;if(isString$1(d)&&(d=c.getNodeById(d)),d&&c.contains(d))return{node:d};var tt=s.targetNodeId;if(tt!=null&&(d=c.getNodeById(tt)))return{node:d}}}function getPathToRoot(s){for(var a=[];s;)s=s.parentNode,s&&a.push(s);return a.reverse()}function aboveViewRoot(s,a){var o=getPathToRoot(s);return indexOf(o,a)>=0}function wrapTreePathInfo(s,a){for(var o=[];s;){var c=s.dataIndex;o.push({name:s.name,dataIndex:c,value:a.getRawValue(c)}),s=s.parentNode}return o.reverse(),o}var TreeSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.hasSymbolVisual=!0,o.ignoreStyleOnData=!0,o}return a.prototype.getInitialData=function(o){var c={name:o.name,children:o.data},d=o.leaves||{},tt=new Model(d,this,this.ecModel),nt=Tree.createTree(c,this,it);function it(ot){ot.wrapMethod("getItemModel",function(at,ht){var ft=nt.getNodeByDataIndex(ht);return ft&&ft.children.length&&ft.isExpand||(at.parentModel=tt),at})}var st=0;nt.eachNode("preorder",function(ot){ot.depth>st&&(st=ot.depth)});var ut=o.expandAndCollapse,ct=ut&&o.initialTreeDepth>=0?o.initialTreeDepth:st;return nt.root.eachNode("preorder",function(ot){var at=ot.hostTree.data.getRawDataItem(ot.dataIndex);ot.isExpand=at&&at.collapsed!=null?!at.collapsed:ot.depth<=ct}),nt.data},a.prototype.getOrient=function(){var o=this.get("orient");return o==="horizontal"?o="LR":o==="vertical"&&(o="TB"),o},a.prototype.setZoom=function(o){this.option.zoom=o},a.prototype.setCenter=function(o){this.option.center=o},a.prototype.formatTooltip=function(o,c,d){for(var tt=this.getData().tree,nt=tt.root.children[0],it=tt.getNodeByDataIndex(o),st=it.getValue(),ut=it.name;it&&it!==nt;)ut=it.parentNode.name+"."+ut,it=it.parentNode;return createTooltipMarkup("nameValue",{name:ut,value:st,noValue:isNaN(st)||st==null})},a.prototype.getDataParams=function(o){var c=s.prototype.getDataParams.apply(this,arguments),d=this.getData().tree.getNodeByDataIndex(o);return c.treeAncestors=wrapTreePathInfo(d,this),c.collapsed=!d.isExpand,c},a.type="series.tree",a.layoutMode="box",a.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},a}(SeriesModel);function eachAfter(s,a,o){for(var c=[s],d=[],tt;tt=c.pop();)if(d.push(tt),tt.isExpand){var nt=tt.children;if(nt.length)for(var it=0;it<nt.length;it++)c.push(nt[it])}for(;tt=d.pop();)a(tt,o)}function eachBefore(s,a){for(var o=[s],c;c=o.pop();)if(a(c),c.isExpand){var d=c.children;if(d.length)for(var tt=d.length-1;tt>=0;tt--)o.push(d[tt])}}function treeLayout(s,a){s.eachSeriesByType("tree",function(o){commonLayout(o,a)})}function commonLayout(s,a){var o=getViewRect$4(s,a);s.layoutInfo=o;var c=s.get("layout"),d=0,tt=0,nt=null;c==="radial"?(d=2*Math.PI,tt=Math.min(o.height,o.width)/2,nt=separation(function(Tt,Ct){return(Tt.parentNode===Ct.parentNode?1:2)/Tt.depth})):(d=o.width,tt=o.height,nt=separation());var it=s.getData().tree.root,st=it.children[0];if(st){init(it),eachAfter(st,firstWalk,nt),it.hierNode.modifier=-st.hierNode.prelim,eachBefore(st,secondWalk);var ut=st,ct=st,ot=st;eachBefore(st,function(Tt){var Ct=Tt.getLayout().x;Ct<ut.getLayout().x&&(ut=Tt),Ct>ct.getLayout().x&&(ct=Tt),Tt.depth>ot.depth&&(ot=Tt)});var at=ut===ct?1:nt(ut,ct)/2,ht=at-ut.getLayout().x,ft=0,mt=0,yt=0,bt=0;if(c==="radial")ft=d/(ct.getLayout().x+at+ht),mt=tt/(ot.depth-1||1),eachBefore(st,function(Tt){yt=(Tt.getLayout().x+ht)*ft,bt=(Tt.depth-1)*mt;var Ct=radialCoordinate(yt,bt);Tt.setLayout({x:Ct.x,y:Ct.y,rawX:yt,rawY:bt},!0)});else{var wt=s.getOrient();wt==="RL"||wt==="LR"?(mt=tt/(ct.getLayout().x+at+ht),ft=d/(ot.depth-1||1),eachBefore(st,function(Tt){bt=(Tt.getLayout().x+ht)*mt,yt=wt==="LR"?(Tt.depth-1)*ft:d-(Tt.depth-1)*ft,Tt.setLayout({x:yt,y:bt},!0)})):(wt==="TB"||wt==="BT")&&(ft=d/(ct.getLayout().x+at+ht),mt=tt/(ot.depth-1||1),eachBefore(st,function(Tt){yt=(Tt.getLayout().x+ht)*ft,bt=wt==="TB"?(Tt.depth-1)*mt:tt-(Tt.depth-1)*mt,Tt.setLayout({x:yt,y:bt},!0)}))}}}function treeVisual(s){s.eachSeriesByType("tree",function(a){var o=a.getData(),c=o.tree;c.eachNode(function(d){var tt=d.getModel(),nt=tt.getModel("itemStyle").getItemStyle(),it=o.ensureUniqueItemVisual(d.dataIndex,"style");extend(it,nt)})})}function installTreeAction(s){s.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(a,o){o.eachComponent({mainType:"series",subType:"tree",query:a},function(c){var d=a.dataIndex,tt=c.getData().tree,nt=tt.getNodeByDataIndex(d);nt.isExpand=!nt.isExpand})}),s.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(a,o,c){o.eachComponent({mainType:"series",subType:"tree",query:a},function(d){var tt=d.coordinateSystem,nt=updateCenterAndZoom(tt,a,void 0,c);d.setCenter&&d.setCenter(nt.center),d.setZoom&&d.setZoom(nt.zoom)})})}function install$H(s){s.registerChartView(TreeView),s.registerSeriesModel(TreeSeriesModel),s.registerLayout(treeLayout),s.registerVisual(treeVisual),installTreeAction(s)}var actionTypes=["treemapZoomToNode","treemapRender","treemapMove"];function installTreemapAction(s){for(var a=0;a<actionTypes.length;a++)s.registerAction({type:actionTypes[a],update:"updateView"},noop);s.registerAction({type:"treemapRootToNode",update:"updateView"},function(o,c){c.eachComponent({mainType:"series",subType:"treemap",query:o},d);function d(tt,nt){var it=["treemapZoomToNode","treemapRootToNode"],st=retrieveTargetInfo(o,it,tt);if(st){var ut=tt.getViewRoot();ut&&(o.direction=aboveViewRoot(ut,st.node)?"rollUp":"drillDown"),tt.resetViewRoot(st.node)}}})}function enableAriaDecalForTree(s){var a=s.getData(),o=a.tree,c={};o.eachNode(function(d){for(var tt=d;tt&&tt.depth>1;)tt=tt.parentNode;var nt=getDecalFromPalette(s.ecModel,tt.name||tt.dataIndex+"",c);d.setVisual("decal",nt)})}var TreemapSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.preventUsingHoverLayer=!0,o}return a.prototype.getInitialData=function(o,c){var d={name:o.name,children:o.data};completeTreeValue$1(d);var tt=o.levels||[],nt=this.designatedVisualItemStyle={},it=new Model({itemStyle:nt},this,c);tt=o.levels=setDefault(tt,c);var st=map$1(tt||[],function(ot){return new Model(ot,it,c)},this),ut=Tree.createTree(d,this,ct);function ct(ot){ot.wrapMethod("getItemModel",function(at,ht){var ft=ut.getNodeByDataIndex(ht),mt=ft?st[ft.depth]:null;return at.parentModel=mt||it,at})}return ut.data},a.prototype.optionUpdated=function(){this.resetViewRoot()},a.prototype.formatTooltip=function(o,c,d){var tt=this.getData(),nt=this.getRawValue(o),it=tt.getName(o);return createTooltipMarkup("nameValue",{name:it,value:nt})},a.prototype.getDataParams=function(o){var c=s.prototype.getDataParams.apply(this,arguments),d=this.getData().tree.getNodeByDataIndex(o);return c.treeAncestors=wrapTreePathInfo(d,this),c.treePathInfo=c.treeAncestors,c},a.prototype.setLayoutInfo=function(o){this.layoutInfo=this.layoutInfo||{},extend(this.layoutInfo,o)},a.prototype.mapIdToIndex=function(o){var c=this._idIndexMap;c||(c=this._idIndexMap=createHashMap(),this._idIndexMapCount=0);var d=c.get(o);return d==null&&c.set(o,d=this._idIndexMapCount++),d},a.prototype.getViewRoot=function(){return this._viewRoot},a.prototype.resetViewRoot=function(o){o?this._viewRoot=o:o=this._viewRoot;var c=this.getRawData().tree.root;(!o||o!==c&&!c.contains(o))&&(this._viewRoot=c)},a.prototype.enableAriaDecal=function(){enableAriaDecalForTree(this)},a.type="series.treemap",a.layoutMode="box",a.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.32*.32,scaleLimit:null,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},a}(SeriesModel);function completeTreeValue$1(s){var a=0;each$f(s.children,function(c){completeTreeValue$1(c);var d=c.value;isArray$1(d)&&(d=d[0]),a+=d});var o=s.value;isArray$1(o)&&(o=o[0]),(o==null||isNaN(o))&&(o=a),o<0&&(o=0),isArray$1(s.value)?s.value[0]=o:s.value=o}function setDefault(s,a){var o=normalizeToArray(a.get("color")),c=normalizeToArray(a.get(["aria","decal","decals"]));if(o){s=s||[];var d,tt;each$f(s,function(it){var st=new Model(it),ut=st.get("color"),ct=st.get("decal");(st.get(["itemStyle","color"])||ut&&ut!=="none")&&(d=!0),(st.get(["itemStyle","decal"])||ct&&ct!=="none")&&(tt=!0)});var nt=s[0]||(s[0]={});return d||(nt.color=o.slice()),!tt&&c&&(nt.decal=c.slice()),s}}var TEXT_PADDING=8,ITEM_GAP=8,ARRAY_LENGTH=5,Breadcrumb=function(){function s(a){this.group=new Group$3,a.add(this.group)}return s.prototype.render=function(a,o,c,d){var tt=a.getModel("breadcrumb"),nt=this.group;if(nt.removeAll(),!(!tt.get("show")||!c)){var it=tt.getModel("itemStyle"),st=tt.getModel("emphasis"),ut=it.getModel("textStyle"),ct=st.getModel(["itemStyle","textStyle"]),ot={pos:{left:tt.get("left"),right:tt.get("right"),top:tt.get("top"),bottom:tt.get("bottom")},box:{width:o.getWidth(),height:o.getHeight()},emptyItemWidth:tt.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(c,ot,ut),this._renderContent(a,ot,it,st,ut,ct,d),positionElement(nt,ot.pos,ot.box)}},s.prototype._prepare=function(a,o,c){for(var d=a;d;d=d.parentNode){var tt=convertOptionIdName(d.getModel().get("name"),""),nt=c.getTextRect(tt),it=Math.max(nt.width+TEXT_PADDING*2,o.emptyItemWidth);o.totalWidth+=it+ITEM_GAP,o.renderList.push({node:d,text:tt,width:it})}},s.prototype._renderContent=function(a,o,c,d,tt,nt,it){for(var st=0,ut=o.emptyItemWidth,ct=a.get(["breadcrumb","height"]),ot=getAvailableSize(o.pos,o.box),at=o.totalWidth,ht=o.renderList,ft=d.getModel("itemStyle").getItemStyle(),mt=ht.length-1;mt>=0;mt--){var yt=ht[mt],bt=yt.node,wt=yt.width,Tt=yt.text;at>ot.width&&(at-=wt-ut,wt=ut,Tt=null);var Ct=new Polygon({shape:{points:makeItemPoints(st,0,wt,ct,mt===ht.length-1,mt===0)},style:defaults(c.getItemStyle(),{lineJoin:"bevel"}),textContent:new ZRText({style:createTextStyle$1(tt,{text:Tt})}),textConfig:{position:"inside"},z2:Z2_EMPHASIS_LIFT*1e4,onclick:curry$1(it,bt)});Ct.disableLabelAnimation=!0,Ct.getTextContent().ensureState("emphasis").style=createTextStyle$1(nt,{text:Tt}),Ct.ensureState("emphasis").style=ft,toggleHoverEmphasis(Ct,d.get("focus"),d.get("blurScope"),d.get("disabled")),this.group.add(Ct),packEventData(Ct,a,bt),st+=wt+ITEM_GAP}},s.prototype.remove=function(){this.group.removeAll()},s}();function makeItemPoints(s,a,o,c,d,tt){var nt=[[d?s:s-ARRAY_LENGTH,a],[s+o,a],[s+o,a+c],[d?s:s-ARRAY_LENGTH,a+c]];return!tt&&nt.splice(2,0,[s+o+ARRAY_LENGTH,a+c/2]),!d&&nt.push([s,a+c/2]),nt}function packEventData(s,a,o){getECData(s).eventData={componentType:"series",componentSubType:"treemap",componentIndex:a.componentIndex,seriesIndex:a.seriesIndex,seriesName:a.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:o&&o.dataIndex,name:o&&o.name},treePathInfo:o&&wrapTreePathInfo(o,a)}}var AnimationWrap=function(){function s(){this._storage=[],this._elExistsMap={}}return s.prototype.add=function(a,o,c,d,tt){return this._elExistsMap[a.id]?!1:(this._elExistsMap[a.id]=!0,this._storage.push({el:a,target:o,duration:c,delay:d,easing:tt}),!0)},s.prototype.finished=function(a){return this._finishedCallback=a,this},s.prototype.start=function(){for(var a=this,o=this._storage.length,c=function(){o--,o<=0&&(a._storage.length=0,a._elExistsMap={},a._finishedCallback&&a._finishedCallback())},d=0,tt=this._storage.length;d<tt;d++){var nt=this._storage[d];nt.el.animateTo(nt.target,{duration:nt.duration,delay:nt.delay,easing:nt.easing,setToFinal:!0,done:c,aborted:c})}return this},s}();function createWrap(){return new AnimationWrap}var Group$2=Group$3,Rect$1=Rect$2,DRAG_THRESHOLD=3,PATH_LABEL_NOAMAL="label",PATH_UPPERLABEL_NORMAL="upperLabel",Z2_BASE=Z2_EMPHASIS_LIFT*10,Z2_BG=Z2_EMPHASIS_LIFT*2,Z2_CONTENT=Z2_EMPHASIS_LIFT*3,getStateItemStyle=makeStyleMapper([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),getItemStyleNormal=function(s){var a=getStateItemStyle(s);return a.stroke=a.fill=a.lineWidth=null,a},inner$d=makeInner(),TreemapView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._state="ready",o._storage=createStorage(),o}return a.prototype.render=function(o,c,d,tt){var nt=c.findComponents({mainType:"series",subType:"treemap",query:tt});if(!(indexOf(nt,o)<0)){this.seriesModel=o,this.api=d,this.ecModel=c;var it=["treemapZoomToNode","treemapRootToNode"],st=retrieveTargetInfo(tt,it,o),ut=tt&&tt.type,ct=o.layoutInfo,ot=!this._oldTree,at=this._storage,ht=ut==="treemapRootToNode"&&st&&at?{rootNodeGroup:at.nodeGroup[st.node.getRawIndex()],direction:tt.direction}:null,ft=this._giveContainerGroup(ct),mt=o.get("animation"),yt=this._doRender(ft,o,ht);mt&&!ot&&(!ut||ut==="treemapZoomToNode"||ut==="treemapRootToNode")?this._doAnimation(ft,yt,o,ht):yt.renderFinally(),this._resetController(d),this._renderBreadcrumb(o,d,st)}},a.prototype._giveContainerGroup=function(o){var c=this._containerGroup;return c||(c=this._containerGroup=new Group$2,this._initEvents(c),this.group.add(c)),c.x=o.x,c.y=o.y,c},a.prototype._doRender=function(o,c,d){var tt=c.getData().tree,nt=this._oldTree,it=createStorage(),st=createStorage(),ut=this._storage,ct=[];function ot(wt,Tt,Ct,Dt){return renderNode(c,st,ut,d,it,ct,wt,Tt,Ct,Dt)}mt(tt.root?[tt.root]:[],nt&&nt.root?[nt.root]:[],o,tt===nt||!nt,0);var at=yt(ut);if(this._oldTree=tt,this._storage=st,this._controllerHost){var ht=this.seriesModel.layoutInfo,ft=tt.root.getLayout();ft.width===ht.width&&ft.height===ht.height&&(this._controllerHost.zoom=1)}return{lastsForAnimation:it,willDeleteEls:at,renderFinally:bt};function mt(wt,Tt,Ct,Dt,Ot){Dt?(Tt=wt,each$f(wt,function(kt,Vt){!kt.isRemoved()&&Ft(Vt,Vt)})):new DataDiffer(Tt,wt,$t,$t).add(Ft).update(Ft).remove(curry$1(Ft,null)).execute();function $t(kt){return kt.getId()}function Ft(kt,Vt){var Ht=kt!=null?wt[kt]:null,Qt=Vt!=null?Tt[Vt]:null,Xt=ot(Ht,Qt,Ct,Ot);Xt&&mt(Ht&&Ht.viewChildren||[],Qt&&Qt.viewChildren||[],Xt,Dt,Ot+1)}}function yt(wt){var Tt=createStorage();return wt&&each$f(wt,function(Ct,Dt){var Ot=Tt[Dt];each$f(Ct,function($t){$t&&(Ot.push($t),inner$d($t).willDelete=!0)})}),Tt}function bt(){each$f(at,function(wt){each$f(wt,function(Tt){Tt.parent&&Tt.parent.remove(Tt)})}),each$f(ct,function(wt){wt.invisible=!0,wt.dirty()})}},a.prototype._doAnimation=function(o,c,d,tt){var nt=d.get("animationDurationUpdate"),it=d.get("animationEasing"),st=(isFunction$1(nt)?0:nt)||0,ut=(isFunction$1(it)?null:it)||"cubicOut",ct=createWrap();each$f(c.willDeleteEls,function(ot,at){each$f(ot,function(ht,ft){if(!ht.invisible){var mt=ht.parent,yt,bt=inner$d(mt);if(tt&&tt.direction==="drillDown")yt=mt===tt.rootNodeGroup?{shape:{x:0,y:0,width:bt.nodeWidth,height:bt.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var wt=0,Tt=0;bt.willDelete||(wt=bt.nodeWidth/2,Tt=bt.nodeHeight/2),yt=at==="nodeGroup"?{x:wt,y:Tt,style:{opacity:0}}:{shape:{x:wt,y:Tt,width:0,height:0},style:{opacity:0}}}yt&&ct.add(ht,yt,st,0,ut)}})}),each$f(this._storage,function(ot,at){each$f(ot,function(ht,ft){var mt=c.lastsForAnimation[at][ft],yt={};mt&&(ht instanceof Group$3?mt.oldX!=null&&(yt.x=ht.x,yt.y=ht.y,ht.x=mt.oldX,ht.y=mt.oldY):(mt.oldShape&&(yt.shape=extend({},ht.shape),ht.setShape(mt.oldShape)),mt.fadein?(ht.setStyle("opacity",0),yt.style={opacity:1}):ht.style.opacity!==1&&(yt.style={opacity:1})),ct.add(ht,yt,st,0,ut))})},this),this._state="animating",ct.finished(bind$2(function(){this._state="ready",c.renderFinally()},this)).start()},a.prototype._resetController=function(o){var c=this._controller,d=this._controllerHost;d||(this._controllerHost={target:this.group},d=this._controllerHost),c||(c=this._controller=new RoamController(o.getZr()),c.enable(this.seriesModel.get("roam")),d.zoomLimit=this.seriesModel.get("scaleLimit"),d.zoom=this.seriesModel.get("zoom"),c.on("pan",bind$2(this._onPan,this)),c.on("zoom",bind$2(this._onZoom,this)));var tt=new BoundingRect(0,0,o.getWidth(),o.getHeight());c.setPointerChecker(function(nt,it,st){return tt.contain(it,st)})},a.prototype._clearController=function(){var o=this._controller;this._controllerHost=null,o&&(o.dispose(),o=null)},a.prototype._onPan=function(o){if(this._state!=="animating"&&(Math.abs(o.dx)>DRAG_THRESHOLD||Math.abs(o.dy)>DRAG_THRESHOLD)){var c=this.seriesModel.getData().tree.root;if(!c)return;var d=c.getLayout();if(!d)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:d.x+o.dx,y:d.y+o.dy,width:d.width,height:d.height}})}},a.prototype._onZoom=function(o){var c=o.originX,d=o.originY,tt=o.scale;if(this._state!=="animating"){var nt=this.seriesModel.getData().tree.root;if(!nt)return;var it=nt.getLayout();if(!it)return;var st=new BoundingRect(it.x,it.y,it.width,it.height),ut=null,ct=this._controllerHost;ut=ct.zoomLimit;var ot=ct.zoom=ct.zoom||1;if(ot*=tt,ut){var at=ut.min||0,ht=ut.max||1/0;ot=Math.max(Math.min(ht,ot),at)}var ft=ot/ct.zoom;ct.zoom=ot;var mt=this.seriesModel.layoutInfo;c-=mt.x,d-=mt.y;var yt=create$1();translate(yt,yt,[-c,-d]),scale$1(yt,yt,[ft,ft]),translate(yt,yt,[c,d]),st.applyTransform(yt),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:st.x,y:st.y,width:st.width,height:st.height}})}},a.prototype._initEvents=function(o){var c=this;o.on("click",function(d){if(c._state==="ready"){var tt=c.seriesModel.get("nodeClick",!0);if(tt){var nt=c.findTarget(d.offsetX,d.offsetY);if(nt){var it=nt.node;if(it.getLayout().isLeafRoot)c._rootToNode(nt);else if(tt==="zoomToNode")c._zoomToNode(nt);else if(tt==="link"){var st=it.hostTree.data.getItemModel(it.dataIndex),ut=st.get("link",!0),ct=st.get("target",!0)||"blank";ut&&windowOpen(ut,ct)}}}}},this)},a.prototype._renderBreadcrumb=function(o,c,d){var tt=this;d||(d=o.get("leafDepth",!0)!=null?{node:o.getViewRoot()}:this.findTarget(c.getWidth()/2,c.getHeight()/2),d||(d={node:o.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new Breadcrumb(this.group))).render(o,c,d.node,function(nt){tt._state!=="animating"&&(aboveViewRoot(o.getViewRoot(),nt)?tt._rootToNode({node:nt}):tt._zoomToNode({node:nt}))})},a.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=createStorage(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},a.prototype.dispose=function(){this._clearController()},a.prototype._zoomToNode=function(o){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:o.node})},a.prototype._rootToNode=function(o){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:o.node})},a.prototype.findTarget=function(o,c){var d,tt=this.seriesModel.getViewRoot();return tt.eachNode({attr:"viewChildren",order:"preorder"},function(nt){var it=this._storage.background[nt.getRawIndex()];if(it){var st=it.transformCoordToLocal(o,c),ut=it.shape;if(ut.x<=st[0]&&st[0]<=ut.x+ut.width&&ut.y<=st[1]&&st[1]<=ut.y+ut.height)d={node:nt,offsetX:st[0],offsetY:st[1]};else return!1}},this),d},a.type="treemap",a}(ChartView);function createStorage(){return{nodeGroup:[],background:[],content:[]}}function renderNode(s,a,o,c,d,tt,nt,it,st,ut){if(!nt)return;var ct=nt.getLayout(),ot=s.getData(),at=nt.getModel();if(ot.setItemGraphicEl(nt.dataIndex,null),!ct||!ct.isInView)return;var ht=ct.width,ft=ct.height,mt=ct.borderWidth,yt=ct.invisible,bt=nt.getRawIndex(),wt=it&&it.getRawIndex(),Tt=nt.viewChildren,Ct=ct.upperHeight,Dt=Tt&&Tt.length,Ot=at.getModel("itemStyle"),$t=at.getModel(["emphasis","itemStyle"]),Ft=at.getModel(["blur","itemStyle"]),kt=at.getModel(["select","itemStyle"]),Vt=Ot.get("borderRadius")||0,Ht=an("nodeGroup",Group$2);if(!Ht)return;if(st.add(Ht),Ht.x=ct.x||0,Ht.y=ct.y||0,Ht.markRedraw(),inner$d(Ht).nodeWidth=ht,inner$d(Ht).nodeHeight=ft,ct.isAboveViewRoot)return Ht;var Qt=an("background",Rect$1,ut,Z2_BG);Qt&&Dr(Ht,Qt,Dt&&ct.upperLabelHeight);var Xt=at.getModel("emphasis"),Zt=Xt.get("focus"),ar=Xt.get("blurScope"),nr=Xt.get("disabled"),cr=Zt==="ancestor"?nt.getAncestorsIndices():Zt==="descendant"?nt.getDescendantIndices():Zt;if(Dt)isHighDownDispatcher(Ht)&&setAsHighDownDispatcher(Ht,!1),Qt&&(setAsHighDownDispatcher(Qt,!nr),ot.setItemGraphicEl(nt.dataIndex,Qt),enableHoverFocus(Qt,cr,ar));else{var dr=an("content",Rect$1,ut,Z2_CONTENT);dr&&kr(Ht,dr),Qt.disableMorphing=!0,Qt&&isHighDownDispatcher(Qt)&&setAsHighDownDispatcher(Qt,!1),setAsHighDownDispatcher(Ht,!nr),ot.setItemGraphicEl(nt.dataIndex,Ht);var mr=at.getShallow("cursor");mr&&dr.attr("cursor",mr),enableHoverFocus(Ht,cr,ar)}return Ht;function Dr(hn,pn,yn){var un=getECData(pn);if(un.dataIndex=nt.dataIndex,un.seriesIndex=s.seriesIndex,pn.setShape({x:0,y:0,width:ht,height:ft,r:Vt}),yt)Yr(pn);else{pn.invisible=!1;var fn=nt.getVisual("style"),Bn=fn.stroke,Dn=getItemStyleNormal(Ot);Dn.fill=Bn;var Qn=getStateItemStyle($t);Qn.fill=$t.get("borderColor");var zr=getStateItemStyle(Ft);zr.fill=Ft.get("borderColor");var ao=getStateItemStyle(kt);if(ao.fill=kt.get("borderColor"),yn){var oo=ht-2*mt;Mr(pn,Bn,fn.opacity,{x:mt,y:0,width:oo,height:Ct})}else pn.removeTextContent();pn.setStyle(Dn),pn.ensureState("emphasis").style=Qn,pn.ensureState("blur").style=zr,pn.ensureState("select").style=ao,setDefaultStateProxy(pn)}hn.add(pn)}function kr(hn,pn){var yn=getECData(pn);yn.dataIndex=nt.dataIndex,yn.seriesIndex=s.seriesIndex;var un=Math.max(ht-2*mt,0),fn=Math.max(ft-2*mt,0);if(pn.culling=!0,pn.setShape({x:mt,y:mt,width:un,height:fn,r:Vt}),yt)Yr(pn);else{pn.invisible=!1;var Bn=nt.getVisual("style"),Dn=Bn.fill,Qn=getItemStyleNormal(Ot);Qn.fill=Dn,Qn.decal=Bn.decal;var zr=getStateItemStyle($t),ao=getStateItemStyle(Ft),oo=getStateItemStyle(kt);Mr(pn,Dn,Bn.opacity,null),pn.setStyle(Qn),pn.ensureState("emphasis").style=zr,pn.ensureState("blur").style=ao,pn.ensureState("select").style=oo,setDefaultStateProxy(pn)}hn.add(pn)}function Yr(hn){!hn.invisible&&tt.push(hn)}function Mr(hn,pn,yn,un){var fn=at.getModel(un?PATH_UPPERLABEL_NORMAL:PATH_LABEL_NOAMAL),Bn=convertOptionIdName(at.get("name"),null),Dn=fn.getShallow("show");setLabelStyle(hn,getLabelStatesModels(at,un?PATH_UPPERLABEL_NORMAL:PATH_LABEL_NOAMAL),{defaultText:Dn?Bn:null,inheritColor:pn,defaultOpacity:yn,labelFetcher:s,labelDataIndex:nt.dataIndex});var Qn=hn.getTextContent();if(Qn){var zr=Qn.style,ao=normalizeCssArray$1(zr.padding||0);un&&(hn.setTextConfig({layoutRect:un}),Qn.disableLabelLayout=!0),Qn.beforeUpdate=function(){var Wn=Math.max((un?un.width:hn.shape.width)-ao[1]-ao[3],0),no=Math.max((un?un.height:hn.shape.height)-ao[0]-ao[2],0);(zr.width!==Wn||zr.height!==no)&&Qn.setStyle({width:Wn,height:no})},zr.truncateMinChar=2,zr.lineOverflow="truncate",Jr(zr,un,ct);var oo=Qn.getState("emphasis");Jr(oo?oo.style:null,un,ct)}}function Jr(hn,pn,yn){var un=hn?hn.text:null;if(!pn&&yn.isLeafRoot&&un!=null){var fn=s.get("drillDownIcon",!0);hn.text=fn?fn+" "+un:un}}function an(hn,pn,yn,un){var fn=wt!=null&&o[hn][wt],Bn=d[hn];return fn?(o[hn][wt]=null,xn(Bn,fn)):yt||(fn=new pn,fn instanceof Displayable&&(fn.z2=calculateZ2(yn,un)),Rn(Bn,fn)),a[hn][bt]=fn}function xn(hn,pn){var yn=hn[bt]={};pn instanceof Group$2?(yn.oldX=pn.x,yn.oldY=pn.y):yn.oldShape=extend({},pn.shape)}function Rn(hn,pn){var yn=hn[bt]={},un=nt.parentNode,fn=pn instanceof Group$3;if(un&&(!c||c.direction==="drillDown")){var Bn=0,Dn=0,Qn=d.background[un.getRawIndex()];!c&&Qn&&Qn.oldShape&&(Bn=Qn.oldShape.width,Dn=Qn.oldShape.height),fn?(yn.oldX=0,yn.oldY=Dn):yn.oldShape={x:Bn,y:Dn,width:0,height:0}}yn.fadein=!fn}}function calculateZ2(s,a){return s*Z2_BASE+a}var each$c=each$f,isObject=isObject$3,CATEGORY_DEFAULT_VISUAL_INDEX=-1,VisualMapping=function(){function s(a){var o=a.mappingMethod,c=a.type,d=this.option=clone$4(a);this.type=c,this.mappingMethod=o,this._normalizeData=normalizers[o];var tt=s.visualHandlers[c];this.applyVisual=tt.applyVisual,this.getColorMapper=tt.getColorMapper,this._normalizedToVisual=tt._normalizedToVisual[o],o==="piecewise"?(normalizeVisualRange(d),preprocessForPiecewise(d)):o==="category"?d.categories?preprocessForSpecifiedCategory(d):normalizeVisualRange(d,!0):(assert(o!=="linear"||d.dataExtent),normalizeVisualRange(d))}return s.prototype.mapValueToVisual=function(a){var o=this._normalizeData(a);return this._normalizedToVisual(o,a)},s.prototype.getNormalizer=function(){return bind$2(this._normalizeData,this)},s.listVisualTypes=function(){return keys(s.visualHandlers)},s.isValidType=function(a){return s.visualHandlers.hasOwnProperty(a)},s.eachVisual=function(a,o,c){isObject$3(a)?each$f(a,o,c):o.call(c,a)},s.mapVisual=function(a,o,c){var d,tt=isArray$1(a)?[]:isObject$3(a)?{}:(d=!0,null);return s.eachVisual(a,function(nt,it){var st=o.call(c,nt,it);d?tt=st:tt[it]=st}),tt},s.retrieveVisuals=function(a){var o={},c;return a&&each$c(s.visualHandlers,function(d,tt){a.hasOwnProperty(tt)&&(o[tt]=a[tt],c=!0)}),c?o:null},s.prepareVisualTypes=function(a){if(isArray$1(a))a=a.slice();else if(isObject(a)){var o=[];each$c(a,function(c,d){o.push(d)}),a=o}else return[];return a.sort(function(c,d){return d==="color"&&c!=="color"&&c.indexOf("color")===0?1:-1}),a},s.dependsOn=function(a,o){return o==="color"?!!(a&&a.indexOf(o)===0):a===o},s.findPieceIndex=function(a,o,c){for(var d,tt=1/0,nt=0,it=o.length;nt<it;nt++){var st=o[nt].value;if(st!=null){if(st===a||isString$1(st)&&st===a+"")return nt;c&&at(st,nt)}}for(var nt=0,it=o.length;nt<it;nt++){var ut=o[nt],ct=ut.interval,ot=ut.close;if(ct){if(ct[0]===-1/0){if(littleThan(ot[1],a,ct[1]))return nt}else if(ct[1]===1/0){if(littleThan(ot[0],ct[0],a))return nt}else if(littleThan(ot[0],ct[0],a)&&littleThan(ot[1],a,ct[1]))return nt;c&&at(ct[0],nt),c&&at(ct[1],nt)}}if(c)return a===1/0?o.length-1:a===-1/0?0:d;function at(ht,ft){var mt=Math.abs(ht-a);mt<tt&&(tt=mt,d=ft)}},s.visualHandlers={color:{applyVisual:makeApplyVisual("color"),getColorMapper:function(){var a=this.option;return bind$2(a.mappingMethod==="category"?function(o,c){return!c&&(o=this._normalizeData(o)),doMapCategory.call(this,o)}:function(o,c,d){var tt=!!d;return!c&&(o=this._normalizeData(o)),d=fastLerp(o,a.parsedVisual,d),tt?d:stringify(d,"rgba")},this)},_normalizedToVisual:{linear:function(a){return stringify(fastLerp(a,this.option.parsedVisual),"rgba")},category:doMapCategory,piecewise:function(a,o){var c=getSpecifiedVisual.call(this,o);return c==null&&(c=stringify(fastLerp(a,this.option.parsedVisual),"rgba")),c},fixed:doMapFixed}},colorHue:makePartialColorVisualHandler(function(a,o){return modifyHSL(a,o)}),colorSaturation:makePartialColorVisualHandler(function(a,o){return modifyHSL(a,null,o)}),colorLightness:makePartialColorVisualHandler(function(a,o){return modifyHSL(a,null,null,o)}),colorAlpha:makePartialColorVisualHandler(function(a,o){return modifyAlpha(a,o)}),decal:{applyVisual:makeApplyVisual("decal"),_normalizedToVisual:{linear:null,category:doMapCategory,piecewise:null,fixed:null}},opacity:{applyVisual:makeApplyVisual("opacity"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])},liftZ:{applyVisual:makeApplyVisual("liftZ"),_normalizedToVisual:{linear:doMapFixed,category:doMapFixed,piecewise:doMapFixed,fixed:doMapFixed}},symbol:{applyVisual:function(a,o,c){var d=this.mapValueToVisual(a);c("symbol",d)},_normalizedToVisual:{linear:doMapToArray,category:doMapCategory,piecewise:function(a,o){var c=getSpecifiedVisual.call(this,o);return c==null&&(c=doMapToArray.call(this,a)),c},fixed:doMapFixed}},symbolSize:{applyVisual:makeApplyVisual("symbolSize"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])}},s}();function preprocessForPiecewise(s){var a=s.pieceList;s.hasSpecialVisual=!1,each$f(a,function(o,c){o.originIndex=c,o.visual!=null&&(s.hasSpecialVisual=!0)})}function preprocessForSpecifiedCategory(s){var a=s.categories,o=s.categoryMap={},c=s.visual;if(each$c(a,function(nt,it){o[nt]=it}),!isArray$1(c)){var d=[];isObject$3(c)?each$c(c,function(nt,it){var st=o[it];d[st??CATEGORY_DEFAULT_VISUAL_INDEX]=nt}):d[CATEGORY_DEFAULT_VISUAL_INDEX]=c,c=setVisualToOption(s,d)}for(var tt=a.length-1;tt>=0;tt--)c[tt]==null&&(delete o[a[tt]],a.pop())}function normalizeVisualRange(s,a){var o=s.visual,c=[];isObject$3(o)?each$c(o,function(tt){c.push(tt)}):o!=null&&c.push(o);var d={color:1,symbol:1};!a&&c.length===1&&!d.hasOwnProperty(s.type)&&(c[1]=c[0]),setVisualToOption(s,c)}function makePartialColorVisualHandler(s){return{applyVisual:function(a,o,c){var d=this.mapValueToVisual(a);c("color",s(o("color"),d))},_normalizedToVisual:createNormalizedToNumericVisual([0,1])}}function doMapToArray(s){var a=this.option.visual;return a[Math.round(linearMap$2(s,[0,1],[0,a.length-1],!0))]||{}}function makeApplyVisual(s){return function(a,o,c){c(s,this.mapValueToVisual(a))}}function doMapCategory(s){var a=this.option.visual;return a[this.option.loop&&s!==CATEGORY_DEFAULT_VISUAL_INDEX?s%a.length:s]}function doMapFixed(){return this.option.visual[0]}function createNormalizedToNumericVisual(s){return{linear:function(a){return linearMap$2(a,s,this.option.visual,!0)},category:doMapCategory,piecewise:function(a,o){var c=getSpecifiedVisual.call(this,o);return c==null&&(c=linearMap$2(a,s,this.option.visual,!0)),c},fixed:doMapFixed}}function getSpecifiedVisual(s){var a=this.option,o=a.pieceList;if(a.hasSpecialVisual){var c=VisualMapping.findPieceIndex(s,o),d=o[c];if(d&&d.visual)return d.visual[this.type]}}function setVisualToOption(s,a){return s.visual=a,s.type==="color"&&(s.parsedVisual=map$1(a,function(o){var c=parse(o);return c||[0,0,0,1]})),a}var normalizers={linear:function(s){return linearMap$2(s,this.option.dataExtent,[0,1],!0)},piecewise:function(s){var a=this.option.pieceList,o=VisualMapping.findPieceIndex(s,a,!0);if(o!=null)return linearMap$2(o,[0,a.length-1],[0,1],!0)},category:function(s){var a=this.option.categories?this.option.categoryMap[s]:s;return a??CATEGORY_DEFAULT_VISUAL_INDEX},fixed:noop};function littleThan(s,a,o){return s?a<=o:a<o}var ITEM_STYLE_NORMAL="itemStyle",inner$c=makeInner();const treemapVisual={seriesType:"treemap",reset:function(s){var a=s.getData().tree,o=a.root;o.isRemoved()||travelTree(o,{},s.getViewRoot().getAncestors(),s)}};function travelTree(s,a,o,c){var d=s.getModel(),tt=s.getLayout(),nt=s.hostTree.data;if(!(!tt||tt.invisible||!tt.isInView)){var it=d.getModel(ITEM_STYLE_NORMAL),st=buildVisuals(it,a,c),ut=nt.ensureUniqueItemVisual(s.dataIndex,"style"),ct=it.get("borderColor"),ot=it.get("borderColorSaturation"),at;ot!=null&&(at=calculateColor(st),ct=calculateBorderColor(ot,at)),ut.stroke=ct;var ht=s.viewChildren;if(!ht||!ht.length)at=calculateColor(st),ut.fill=at;else{var ft=buildVisualMapping(s,d,tt,it,st,ht);each$f(ht,function(mt,yt){if(mt.depth>=o.length||mt===o[mt.depth]){var bt=mapVisual$1(d,st,mt,yt,ft,c);travelTree(mt,bt,o,c)}})}}}function buildVisuals(s,a,o){var c=extend({},a),d=o.designatedVisualItemStyle;return each$f(["color","colorAlpha","colorSaturation"],function(tt){d[tt]=a[tt];var nt=s.get(tt);d[tt]=null,nt!=null&&(c[tt]=nt)}),c}function calculateColor(s){var a=getValueVisualDefine(s,"color");if(a){var o=getValueVisualDefine(s,"colorAlpha"),c=getValueVisualDefine(s,"colorSaturation");return c&&(a=modifyHSL(a,null,null,c)),o&&(a=modifyAlpha(a,o)),a}}function calculateBorderColor(s,a){return a!=null?modifyHSL(a,null,null,s):null}function getValueVisualDefine(s,a){var o=s[a];if(o!=null&&o!=="none")return o}function buildVisualMapping(s,a,o,c,d,tt){if(!(!tt||!tt.length)){var nt=getRangeVisual(a,"color")||d.color!=null&&d.color!=="none"&&(getRangeVisual(a,"colorAlpha")||getRangeVisual(a,"colorSaturation"));if(nt){var it=a.get("visualMin"),st=a.get("visualMax"),ut=o.dataExtent.slice();it!=null&&it<ut[0]&&(ut[0]=it),st!=null&&st>ut[1]&&(ut[1]=st);var ct=a.get("colorMappingBy"),ot={type:nt.name,dataExtent:ut,visual:nt.range};ot.type==="color"&&(ct==="index"||ct==="id")?(ot.mappingMethod="category",ot.loop=!0):ot.mappingMethod="linear";var at=new VisualMapping(ot);return inner$c(at).drColorMappingBy=ct,at}}}function getRangeVisual(s,a){var o=s.get(a);return isArray$1(o)&&o.length?{name:a,range:o}:null}function mapVisual$1(s,a,o,c,d,tt){var nt=extend({},a);if(d){var it=d.type,st=it==="color"&&inner$c(d).drColorMappingBy,ut=st==="index"?c:st==="id"?tt.mapIdToIndex(o.getId()):o.getValue(s.get("visualDimension"));nt[it]=d.mapValueToVisual(ut)}return nt}var mathMax$3=Math.max,mathMin$3=Math.min,retrieveValue=retrieve,each$b=each$f,PATH_BORDER_WIDTH=["itemStyle","borderWidth"],PATH_GAP_WIDTH=["itemStyle","gapWidth"],PATH_UPPER_LABEL_SHOW=["upperLabel","show"],PATH_UPPER_LABEL_HEIGHT=["upperLabel","height"];const treemapLayout={seriesType:"treemap",reset:function(s,a,o,c){var d=o.getWidth(),tt=o.getHeight(),nt=s.option,it=getLayoutRect(s.getBoxLayoutParams(),{width:o.getWidth(),height:o.getHeight()}),st=nt.size||[],ut=parsePercent(retrieveValue(it.width,st[0]),d),ct=parsePercent(retrieveValue(it.height,st[1]),tt),ot=c&&c.type,at=["treemapZoomToNode","treemapRootToNode"],ht=retrieveTargetInfo(c,at,s),ft=ot==="treemapRender"||ot==="treemapMove"?c.rootRect:null,mt=s.getViewRoot(),yt=getPathToRoot(mt);if(ot!=="treemapMove"){var bt=ot==="treemapZoomToNode"?estimateRootSize(s,ht,mt,ut,ct):ft?[ft.width,ft.height]:[ut,ct],wt=nt.sort;wt&&wt!=="asc"&&wt!=="desc"&&(wt="desc");var Tt={squareRatio:nt.squareRatio,sort:wt,leafDepth:nt.leafDepth};mt.hostTree.clearLayouts();var Ct={x:0,y:0,width:bt[0],height:bt[1],area:bt[0]*bt[1]};mt.setLayout(Ct),squarify(mt,Tt,!1,0),Ct=mt.getLayout(),each$b(yt,function(Ot,$t){var Ft=(yt[$t+1]||mt).getValue();Ot.setLayout(extend({dataExtent:[Ft,Ft],borderWidth:0,upperHeight:0},Ct))})}var Dt=s.getData().tree.root;Dt.setLayout(calculateRootPosition(it,ft,ht),!0),s.setLayoutInfo(it),prunning(Dt,new BoundingRect(-it.x,-it.y,d,tt),yt,mt,0)}};function squarify(s,a,o,c){var d,tt;if(!s.isRemoved()){var nt=s.getLayout();d=nt.width,tt=nt.height;var it=s.getModel(),st=it.get(PATH_BORDER_WIDTH),ut=it.get(PATH_GAP_WIDTH)/2,ct=getUpperLabelHeight(it),ot=Math.max(st,ct),at=st-ut,ht=ot-ut;s.setLayout({borderWidth:st,upperHeight:ot,upperLabelHeight:ct},!0),d=mathMax$3(d-2*at,0),tt=mathMax$3(tt-at-ht,0);var ft=d*tt,mt=initChildren$1(s,it,ft,a,o,c);if(mt.length){var yt={x:at,y:ht,width:d,height:tt},bt=mathMin$3(d,tt),wt=1/0,Tt=[];Tt.area=0;for(var Ct=0,Dt=mt.length;Ct<Dt;){var Ot=mt[Ct];Tt.push(Ot),Tt.area+=Ot.getLayout().area;var $t=worst(Tt,bt,a.squareRatio);$t<=wt?(Ct++,wt=$t):(Tt.area-=Tt.pop().getLayout().area,position(Tt,bt,yt,ut,!1),bt=mathMin$3(yt.width,yt.height),Tt.length=Tt.area=0,wt=1/0)}if(Tt.length&&position(Tt,bt,yt,ut,!0),!o){var Ft=it.get("childrenVisibleMin");Ft!=null&&ft<Ft&&(o=!0)}for(var Ct=0,Dt=mt.length;Ct<Dt;Ct++)squarify(mt[Ct],a,o,c+1)}}}function initChildren$1(s,a,o,c,d,tt){var nt=s.children||[],it=c.sort;it!=="asc"&&it!=="desc"&&(it=null);var st=c.leafDepth!=null&&c.leafDepth<=tt;if(d&&!st)return s.viewChildren=[];nt=filter(nt,function(ht){return!ht.isRemoved()}),sort$1(nt,it);var ut=statistic(a,nt,it);if(ut.sum===0)return s.viewChildren=[];if(ut.sum=filterByThreshold(a,o,ut.sum,it,nt),ut.sum===0)return s.viewChildren=[];for(var ct=0,ot=nt.length;ct<ot;ct++){var at=nt[ct].getValue()/ut.sum*o;nt[ct].setLayout({area:at})}return st&&(nt.length&&s.setLayout({isLeafRoot:!0},!0),nt.length=0),s.viewChildren=nt,s.setLayout({dataExtent:ut.dataExtent},!0),nt}function filterByThreshold(s,a,o,c,d){if(!c)return o;for(var tt=s.get("visibleMin"),nt=d.length,it=nt,st=nt-1;st>=0;st--){var ut=d[c==="asc"?nt-st-1:st].getValue();ut/o*a<tt&&(it=st,o-=ut)}return c==="asc"?d.splice(0,nt-it):d.splice(it,nt-it),o}function sort$1(s,a){return a&&s.sort(function(o,c){var d=a==="asc"?o.getValue()-c.getValue():c.getValue()-o.getValue();return d===0?a==="asc"?o.dataIndex-c.dataIndex:c.dataIndex-o.dataIndex:d}),s}function statistic(s,a,o){for(var c=0,d=0,tt=a.length;d<tt;d++)c+=a[d].getValue();var nt=s.get("visualDimension"),it;return!a||!a.length?it=[NaN,NaN]:nt==="value"&&o?(it=[a[a.length-1].getValue(),a[0].getValue()],o==="asc"&&it.reverse()):(it=[1/0,-1/0],each$b(a,function(st){var ut=st.getValue(nt);ut<it[0]&&(it[0]=ut),ut>it[1]&&(it[1]=ut)})),{sum:c,dataExtent:it}}function worst(s,a,o){for(var c=0,d=1/0,tt=0,nt=void 0,it=s.length;tt<it;tt++)nt=s[tt].getLayout().area,nt&&(nt<d&&(d=nt),nt>c&&(c=nt));var st=s.area*s.area,ut=a*a*o;return st?mathMax$3(ut*c/st,st/(ut*d)):1/0}function position(s,a,o,c,d){var tt=a===o.width?0:1,nt=1-tt,it=["x","y"],st=["width","height"],ut=o[it[tt]],ct=a?s.area/a:0;(d||ct>o[st[nt]])&&(ct=o[st[nt]]);for(var ot=0,at=s.length;ot<at;ot++){var ht=s[ot],ft={},mt=ct?ht.getLayout().area/ct:0,yt=ft[st[nt]]=mathMax$3(ct-2*c,0),bt=o[it[tt]]+o[st[tt]]-ut,wt=ot===at-1||bt<mt?bt:mt,Tt=ft[st[tt]]=mathMax$3(wt-2*c,0);ft[it[nt]]=o[it[nt]]+mathMin$3(c,yt/2),ft[it[tt]]=ut+mathMin$3(c,Tt/2),ut+=wt,ht.setLayout(ft,!0)}o[it[nt]]+=ct,o[st[nt]]-=ct}function estimateRootSize(s,a,o,c,d){var tt=(a||{}).node,nt=[c,d];if(!tt||tt===o)return nt;for(var it,st=c*d,ut=st*s.option.zoomToNodeRatio;it=tt.parentNode;){for(var ct=0,ot=it.children,at=0,ht=ot.length;at<ht;at++)ct+=ot[at].getValue();var ft=tt.getValue();if(ft===0)return nt;ut*=ct/ft;var mt=it.getModel(),yt=mt.get(PATH_BORDER_WIDTH),bt=Math.max(yt,getUpperLabelHeight(mt));ut+=4*yt*yt+(3*yt+bt)*Math.pow(ut,.5),ut>MAX_SAFE_INTEGER&&(ut=MAX_SAFE_INTEGER),tt=it}ut<st&&(ut=st);var wt=Math.pow(ut/st,.5);return[c*wt,d*wt]}function calculateRootPosition(s,a,o){if(a)return{x:a.x,y:a.y};var c={x:0,y:0};if(!o)return c;var d=o.node,tt=d.getLayout();if(!tt)return c;for(var nt=[tt.width/2,tt.height/2],it=d;it;){var st=it.getLayout();nt[0]+=st.x,nt[1]+=st.y,it=it.parentNode}return{x:s.width/2-nt[0],y:s.height/2-nt[1]}}function prunning(s,a,o,c,d){var tt=s.getLayout(),nt=o[d],it=nt&&nt===s;if(!(nt&&!it||d===o.length&&s!==c)){s.setLayout({isInView:!0,invisible:!it&&!a.intersect(tt),isAboveViewRoot:it},!0);var st=new BoundingRect(a.x-tt.x,a.y-tt.y,a.width,a.height);each$b(s.viewChildren||[],function(ut){prunning(ut,st,o,c,d+1)})}}function getUpperLabelHeight(s){return s.get(PATH_UPPER_LABEL_SHOW)?s.get(PATH_UPPER_LABEL_HEIGHT):0}function install$G(s){s.registerSeriesModel(TreemapSeriesModel),s.registerChartView(TreemapView),s.registerVisual(treemapVisual),s.registerLayout(treemapLayout),installTreemapAction(s)}function categoryFilter(s){var a=s.findComponents({mainType:"legend"});!a||!a.length||s.eachSeriesByType("graph",function(o){var c=o.getCategoriesData(),d=o.getGraph(),tt=d.data,nt=c.mapArray(c.getName);tt.filterSelf(function(it){var st=tt.getItemModel(it),ut=st.getShallow("category");if(ut!=null){isNumber(ut)&&(ut=nt[ut]);for(var ct=0;ct<a.length;ct++)if(!a[ct].isSelected(ut))return!1}return!0})})}function categoryVisual(s){var a={};s.eachSeriesByType("graph",function(o){var c=o.getCategoriesData(),d=o.getData(),tt={};c.each(function(nt){var it=c.getName(nt);tt["ec-"+it]=nt;var st=c.getItemModel(nt),ut=st.getModel("itemStyle").getItemStyle();ut.fill||(ut.fill=o.getColorFromPalette(it,a)),c.setItemVisual(nt,"style",ut);for(var ct=["symbol","symbolSize","symbolKeepAspect"],ot=0;ot<ct.length;ot++){var at=st.getShallow(ct[ot],!0);at!=null&&c.setItemVisual(nt,ct[ot],at)}}),c.count()&&d.each(function(nt){var it=d.getItemModel(nt),st=it.getShallow("category");if(st!=null){isString$1(st)&&(st=tt["ec-"+st]);var ut=c.getItemVisual(st,"style"),ct=d.ensureUniqueItemVisual(nt,"style");extend(ct,ut);for(var ot=["symbol","symbolSize","symbolKeepAspect"],at=0;at<ot.length;at++)d.setItemVisual(nt,ot[at],c.getItemVisual(st,ot[at]))}})})}function normalize$1(s){return s instanceof Array||(s=[s,s]),s}function graphEdgeVisual(s){s.eachSeriesByType("graph",function(a){var o=a.getGraph(),c=a.getEdgeData(),d=normalize$1(a.get("edgeSymbol")),tt=normalize$1(a.get("edgeSymbolSize"));c.setVisual("fromSymbol",d&&d[0]),c.setVisual("toSymbol",d&&d[1]),c.setVisual("fromSymbolSize",tt&&tt[0]),c.setVisual("toSymbolSize",tt&&tt[1]),c.setVisual("style",a.getModel("lineStyle").getLineStyle()),c.each(function(nt){var it=c.getItemModel(nt),st=o.getEdgeByIndex(nt),ut=normalize$1(it.getShallow("symbol",!0)),ct=normalize$1(it.getShallow("symbolSize",!0)),ot=it.getModel("lineStyle").getLineStyle(),at=c.ensureUniqueItemVisual(nt,"style");switch(extend(at,ot),at.stroke){case"source":{var ht=st.node1.getVisual("style");at.stroke=ht&&ht.fill;break}case"target":{var ht=st.node2.getVisual("style");at.stroke=ht&&ht.fill;break}}ut[0]&&st.setVisual("fromSymbol",ut[0]),ut[1]&&st.setVisual("toSymbol",ut[1]),ct[0]&&st.setVisual("fromSymbolSize",ct[0]),ct[1]&&st.setVisual("toSymbolSize",ct[1])})})}var KEY_DELIMITER="-->",getAutoCurvenessParams=function(s){return s.get("autoCurveness")||null},createCurveness=function(s,a){var o=getAutoCurvenessParams(s),c=20,d=[];if(isNumber(o))c=o;else if(isArray$1(o)){s.__curvenessList=o;return}a>c&&(c=a);var tt=c%2?c+2:c+3;d=[];for(var nt=0;nt<tt;nt++)d.push((nt%2?nt+1:nt)/10*(nt%2?-1:1));s.__curvenessList=d},getKeyOfEdges=function(s,a,o){var c=[s.id,s.dataIndex].join("."),d=[a.id,a.dataIndex].join(".");return[o.uid,c,d].join(KEY_DELIMITER)},getOppositeKey=function(s){var a=s.split(KEY_DELIMITER);return[a[0],a[2],a[1]].join(KEY_DELIMITER)},getEdgeFromMap=function(s,a){var o=getKeyOfEdges(s.node1,s.node2,a);return a.__edgeMap[o]},getTotalLengthBetweenNodes=function(s,a){var o=getEdgeMapLengthWithKey(getKeyOfEdges(s.node1,s.node2,a),a),c=getEdgeMapLengthWithKey(getKeyOfEdges(s.node2,s.node1,a),a);return o+c},getEdgeMapLengthWithKey=function(s,a){var o=a.__edgeMap;return o[s]?o[s].length:0};function initCurvenessList(s){getAutoCurvenessParams(s)&&(s.__curvenessList=[],s.__edgeMap={},createCurveness(s))}function createEdgeMapForCurveness(s,a,o,c){if(getAutoCurvenessParams(o)){var d=getKeyOfEdges(s,a,o),tt=o.__edgeMap,nt=tt[getOppositeKey(d)];tt[d]&&!nt?tt[d].isForward=!0:nt&&tt[d]&&(nt.isForward=!0,tt[d].isForward=!1),tt[d]=tt[d]||[],tt[d].push(c)}}function getCurvenessForEdge(s,a,o,c){var d=getAutoCurvenessParams(a),tt=isArray$1(d);if(!d)return null;var nt=getEdgeFromMap(s,a);if(!nt)return null;for(var it=-1,st=0;st<nt.length;st++)if(nt[st]===o){it=st;break}var ut=getTotalLengthBetweenNodes(s,a);createCurveness(a,ut),s.lineStyle=s.lineStyle||{};var ct=getKeyOfEdges(s.node1,s.node2,a),ot=a.__curvenessList,at=tt||ut%2?0:1;if(nt.isForward)return ot[at+it];var ht=getOppositeKey(ct),ft=getEdgeMapLengthWithKey(ht,a),mt=ot[it+ft+at];return c?tt?d&&d[0]===0?(ft+at)%2?mt:-mt:((ft%2?0:1)+at)%2?mt:-mt:(ft+at)%2?mt:-mt:ot[it+ft+at]}function simpleLayout(s){var a=s.coordinateSystem;if(!(a&&a.type!=="view")){var o=s.getGraph();o.eachNode(function(c){var d=c.getModel();c.setLayout([+d.get("x"),+d.get("y")])}),simpleLayoutEdge(o,s)}}function simpleLayoutEdge(s,a){s.eachEdge(function(o,c){var d=retrieve3(o.getModel().get(["lineStyle","curveness"]),-getCurvenessForEdge(o,a,c,!0),0),tt=clone$3(o.node1.getLayout()),nt=clone$3(o.node2.getLayout()),it=[tt,nt];+d&&it.push([(tt[0]+nt[0])/2-(tt[1]-nt[1])*d,(tt[1]+nt[1])/2-(nt[0]-tt[0])*d]),o.setLayout(it)})}function graphSimpleLayout(s,a){s.eachSeriesByType("graph",function(o){var c=o.get("layout"),d=o.coordinateSystem;if(d&&d.type!=="view"){var tt=o.getData(),nt=[];each$f(d.dimensions,function(at){nt=nt.concat(tt.mapDimensionsAll(at))});for(var it=0;it<tt.count();it++){for(var st=[],ut=!1,ct=0;ct<nt.length;ct++){var ot=tt.get(nt[ct],it);isNaN(ot)||(ut=!0),st.push(ot)}ut?tt.setItemLayout(it,d.dataToPoint(st)):tt.setItemLayout(it,[NaN,NaN])}simpleLayoutEdge(tt.graph,o)}else(!c||c==="none")&&simpleLayout(o)})}function getNodeGlobalScale(s){var a=s.coordinateSystem;if(a.type!=="view")return 1;var o=s.option.nodeScaleRatio,c=a.scaleX,d=a.getZoom(),tt=(d-1)*o+1;return tt/c}function getSymbolSize(s){var a=s.getVisual("symbolSize");return a instanceof Array&&(a=(a[0]+a[1])/2),+a}var PI$2=Math.PI,_symbolRadiansHalf=[];function circularLayout(s,a,o,c){var d=s.coordinateSystem;if(!(d&&d.type!=="view")){var tt=d.getBoundingRect(),nt=s.getData(),it=nt.graph,st=tt.width/2+tt.x,ut=tt.height/2+tt.y,ct=Math.min(tt.width,tt.height)/2,ot=nt.count();if(nt.setLayout({cx:st,cy:ut}),!!ot){if(o){var at=d.pointToData(c),ht=at[0],ft=at[1],mt=[ht-st,ft-ut];normalize$3(mt,mt),scale$2(mt,mt,ct),o.setLayout([st+mt[0],ut+mt[1]],!0);var yt=s.get(["circular","rotateLabel"]);rotateNodeLabel(o,yt,st,ut)}_layoutNodesBasedOn[a](s,it,nt,ct,st,ut,ot),it.eachEdge(function(bt,wt){var Tt=retrieve3(bt.getModel().get(["lineStyle","curveness"]),getCurvenessForEdge(bt,s,wt),0),Ct=clone$3(bt.node1.getLayout()),Dt=clone$3(bt.node2.getLayout()),Ot,$t=(Ct[0]+Dt[0])/2,Ft=(Ct[1]+Dt[1])/2;+Tt&&(Tt*=3,Ot=[st*Tt+$t*(1-Tt),ut*Tt+Ft*(1-Tt)]),bt.setLayout([Ct,Dt,Ot])})}}}var _layoutNodesBasedOn={value:function(s,a,o,c,d,tt,nt){var it=0,st=o.getSum("value"),ut=Math.PI*2/(st||nt);a.eachNode(function(ct){var ot=ct.getValue("value"),at=ut*(st?ot:1)/2;it+=at,ct.setLayout([c*Math.cos(it)+d,c*Math.sin(it)+tt]),it+=at})},symbolSize:function(s,a,o,c,d,tt,nt){var it=0;_symbolRadiansHalf.length=nt;var st=getNodeGlobalScale(s);a.eachNode(function(ot){var at=getSymbolSize(ot);isNaN(at)&&(at=2),at<0&&(at=0),at*=st;var ht=Math.asin(at/2/c);isNaN(ht)&&(ht=PI$2/2),_symbolRadiansHalf[ot.dataIndex]=ht,it+=ht*2});var ut=(2*PI$2-it)/nt/2,ct=0;a.eachNode(function(ot){var at=ut+_symbolRadiansHalf[ot.dataIndex];ct+=at,(!ot.getLayout()||!ot.getLayout().fixed)&&ot.setLayout([c*Math.cos(ct)+d,c*Math.sin(ct)+tt]),ct+=at})}};function rotateNodeLabel(s,a,o,c){var d=s.getGraphicEl();if(d){var tt=s.getModel(),nt=tt.get(["label","rotate"])||0,it=d.getSymbolPath();if(a){var st=s.getLayout(),ut=Math.atan2(st[1]-c,st[0]-o);ut<0&&(ut=Math.PI*2+ut);var ct=st[0]<o;ct&&(ut=ut-Math.PI);var ot=ct?"left":"right";it.setTextConfig({rotation:-ut,position:ot,origin:"center"});var at=it.ensureState("emphasis");extend(at.textConfig||(at.textConfig={}),{position:ot})}else it.setTextConfig({rotation:nt*=Math.PI/180})}}function graphCircularLayout(s){s.eachSeriesByType("graph",function(a){a.get("layout")==="circular"&&circularLayout(a,"symbolSize")})}var scaleAndAdd=scaleAndAdd$1;function forceLayout(s,a,o){for(var c=s,d=a,tt=o.rect,nt=tt.width,it=tt.height,st=[tt.x+nt/2,tt.y+it/2],ut=o.gravity==null?.1:o.gravity,ct=0;ct<c.length;ct++){var ot=c[ct];ot.p||(ot.p=create$2(nt*(Math.random()-.5)+st[0],it*(Math.random()-.5)+st[1])),ot.pp=clone$3(ot.p),ot.edges=null}var at=o.friction==null?.6:o.friction,ht=at,ft,mt;return{warmUp:function(){ht=at*.8},setFixed:function(yt){c[yt].fixed=!0},setUnfixed:function(yt){c[yt].fixed=!1},beforeStep:function(yt){ft=yt},afterStep:function(yt){mt=yt},step:function(yt){ft&&ft(c,d);for(var bt=[],wt=c.length,Tt=0;Tt<d.length;Tt++){var Ct=d[Tt];if(!Ct.ignoreForceLayout){var Dt=Ct.n1,Ot=Ct.n2;sub(bt,Ot.p,Dt.p);var $t=len(bt)-Ct.d,Ft=Ot.w/(Dt.w+Ot.w);isNaN(Ft)&&(Ft=0),normalize$3(bt,bt),!Dt.fixed&&scaleAndAdd(Dt.p,Dt.p,bt,Ft*$t*ht),!Ot.fixed&&scaleAndAdd(Ot.p,Ot.p,bt,-(1-Ft)*$t*ht)}}for(var Tt=0;Tt<wt;Tt++){var kt=c[Tt];kt.fixed||(sub(bt,st,kt.p),scaleAndAdd(kt.p,kt.p,bt,ut*ht))}for(var Tt=0;Tt<wt;Tt++)for(var Dt=c[Tt],Vt=Tt+1;Vt<wt;Vt++){var Ot=c[Vt];sub(bt,Ot.p,Dt.p);var $t=len(bt);$t===0&&(set$1(bt,Math.random()-.5,Math.random()-.5),$t=1);var Ht=(Dt.rep+Ot.rep)/$t/$t;!Dt.fixed&&scaleAndAdd(Dt.pp,Dt.pp,bt,Ht),!Ot.fixed&&scaleAndAdd(Ot.pp,Ot.pp,bt,-Ht)}for(var Qt=[],Tt=0;Tt<wt;Tt++){var kt=c[Tt];kt.fixed||(sub(Qt,kt.p,kt.pp),scaleAndAdd(kt.p,kt.p,Qt,ht),copy$1(kt.pp,kt.p))}ht=ht*.992;var Xt=ht<.01;mt&&mt(c,d,Xt),yt&&yt(Xt)}}}function graphForceLayout(s){s.eachSeriesByType("graph",function(a){var o=a.coordinateSystem;if(!(o&&o.type!=="view"))if(a.get("layout")==="force"){var c=a.preservedPoints||{},d=a.getGraph(),tt=d.data,nt=d.edgeData,it=a.getModel("force"),st=it.get("initLayout");a.preservedPoints?tt.each(function(Tt){var Ct=tt.getId(Tt);tt.setItemLayout(Tt,c[Ct]||[NaN,NaN])}):!st||st==="none"?simpleLayout(a):st==="circular"&&circularLayout(a,"value");var ut=tt.getDataExtent("value"),ct=nt.getDataExtent("value"),ot=it.get("repulsion"),at=it.get("edgeLength"),ht=isArray$1(ot)?ot:[ot,ot],ft=isArray$1(at)?at:[at,at];ft=[ft[1],ft[0]];var mt=tt.mapArray("value",function(Tt,Ct){var Dt=tt.getItemLayout(Ct),Ot=linearMap$2(Tt,ut,ht);return isNaN(Ot)&&(Ot=(ht[0]+ht[1])/2),{w:Ot,rep:Ot,fixed:tt.getItemModel(Ct).get("fixed"),p:!Dt||isNaN(Dt[0])||isNaN(Dt[1])?null:Dt}}),yt=nt.mapArray("value",function(Tt,Ct){var Dt=d.getEdgeByIndex(Ct),Ot=linearMap$2(Tt,ct,ft);isNaN(Ot)&&(Ot=(ft[0]+ft[1])/2);var $t=Dt.getModel(),Ft=retrieve3(Dt.getModel().get(["lineStyle","curveness"]),-getCurvenessForEdge(Dt,a,Ct,!0),0);return{n1:mt[Dt.node1.dataIndex],n2:mt[Dt.node2.dataIndex],d:Ot,curveness:Ft,ignoreForceLayout:$t.get("ignoreForceLayout")}}),bt=o.getBoundingRect(),wt=forceLayout(mt,yt,{rect:bt,gravity:it.get("gravity"),friction:it.get("friction")});wt.beforeStep(function(Tt,Ct){for(var Dt=0,Ot=Tt.length;Dt<Ot;Dt++)Tt[Dt].fixed&&copy$1(Tt[Dt].p,d.getNodeByIndex(Dt).getLayout())}),wt.afterStep(function(Tt,Ct,Dt){for(var Ot=0,$t=Tt.length;Ot<$t;Ot++)Tt[Ot].fixed||d.getNodeByIndex(Ot).setLayout(Tt[Ot].p),c[tt.getId(Ot)]=Tt[Ot].p;for(var Ot=0,$t=Ct.length;Ot<$t;Ot++){var Ft=Ct[Ot],kt=d.getEdgeByIndex(Ot),Vt=Ft.n1.p,Ht=Ft.n2.p,Qt=kt.getLayout();Qt=Qt?Qt.slice():[],Qt[0]=Qt[0]||[],Qt[1]=Qt[1]||[],copy$1(Qt[0],Vt),copy$1(Qt[1],Ht),+Ft.curveness&&(Qt[2]=[(Vt[0]+Ht[0])/2-(Vt[1]-Ht[1])*Ft.curveness,(Vt[1]+Ht[1])/2-(Ht[0]-Vt[0])*Ft.curveness]),kt.setLayout(Qt)}}),a.forceLayout=wt,a.preservedPoints=c,wt.step()}else a.forceLayout=null})}function getViewRect$3(s,a,o){var c=extend(s.getBoxLayoutParams(),{aspect:o});return getLayoutRect(c,{width:a.getWidth(),height:a.getHeight()})}function createViewCoordSys(s,a){var o=[];return s.eachSeriesByType("graph",function(c){var d=c.get("coordinateSystem");if(!d||d==="view"){var tt=c.getData(),nt=tt.mapArray(function(yt){var bt=tt.getItemModel(yt);return[+bt.get("x"),+bt.get("y")]}),it=[],st=[];fromPoints(nt,it,st),st[0]-it[0]===0&&(st[0]+=1,it[0]-=1),st[1]-it[1]===0&&(st[1]+=1,it[1]-=1);var ut=(st[0]-it[0])/(st[1]-it[1]),ct=getViewRect$3(c,a,ut);isNaN(ut)&&(it=[ct.x,ct.y],st=[ct.x+ct.width,ct.y+ct.height]);var ot=st[0]-it[0],at=st[1]-it[1],ht=ct.width,ft=ct.height,mt=c.coordinateSystem=new View;mt.zoomLimit=c.get("scaleLimit"),mt.setBoundingRect(it[0],it[1],ot,at),mt.setViewRect(ct.x,ct.y,ht,ft),mt.setCenter(c.get("center"),a),mt.setZoom(c.get("zoom")),o.push(mt)}}),o}var straightLineProto=Line$1.prototype,bezierCurveProto=BezierCurve.prototype,StraightLineShape=function(){function s(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return s}();(function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a})(StraightLineShape);function isStraightLine(s){return isNaN(+s.cpx1)||isNaN(+s.cpy1)}var ECLinePath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="ec-line",c}return a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new StraightLineShape},a.prototype.buildPath=function(o,c){isStraightLine(c)?straightLineProto.buildPath.call(this,o,c):bezierCurveProto.buildPath.call(this,o,c)},a.prototype.pointAt=function(o){return isStraightLine(this.shape)?straightLineProto.pointAt.call(this,o):bezierCurveProto.pointAt.call(this,o)},a.prototype.tangentAt=function(o){var c=this.shape,d=isStraightLine(c)?[c.x2-c.x1,c.y2-c.y1]:bezierCurveProto.tangentAt.call(this,o);return normalize$3(d,d)},a}(Path),SYMBOL_CATEGORIES=["fromSymbol","toSymbol"];function makeSymbolTypeKey(s){return"_"+s+"Type"}function makeSymbolTypeValue(s,a,o){var c=a.getItemVisual(o,s);if(!c||c==="none")return c;var d=a.getItemVisual(o,s+"Size"),tt=a.getItemVisual(o,s+"Rotate"),nt=a.getItemVisual(o,s+"Offset"),it=a.getItemVisual(o,s+"KeepAspect"),st=normalizeSymbolSize(d),ut=normalizeSymbolOffset(nt||0,st);return c+st+ut+(tt||"")+(it||"")}function createSymbol(s,a,o){var c=a.getItemVisual(o,s);if(!(!c||c==="none")){var d=a.getItemVisual(o,s+"Size"),tt=a.getItemVisual(o,s+"Rotate"),nt=a.getItemVisual(o,s+"Offset"),it=a.getItemVisual(o,s+"KeepAspect"),st=normalizeSymbolSize(d),ut=normalizeSymbolOffset(nt||0,st),ct=createSymbol$1(c,-st[0]/2+ut[0],-st[1]/2+ut[1],st[0],st[1],null,it);return ct.__specifiedRotation=tt==null||isNaN(tt)?void 0:+tt*Math.PI/180||0,ct.name=s,ct}}function createLine(s){var a=new ECLinePath({name:"line",subPixelOptimize:!0});return setLinePoints(a.shape,s),a}function setLinePoints(s,a){s.x1=a[0][0],s.y1=a[0][1],s.x2=a[1][0],s.y2=a[1][1],s.percent=1;var o=a[2];o?(s.cpx1=o[0],s.cpy1=o[1]):(s.cpx1=NaN,s.cpy1=NaN)}var Line=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this)||this;return tt._createLine(o,c,d),tt}return a.prototype._createLine=function(o,c,d){var tt=o.hostModel,nt=o.getItemLayout(c),it=createLine(nt);it.shape.percent=0,initProps(it,{shape:{percent:1}},tt,c),this.add(it),each$f(SYMBOL_CATEGORIES,function(st){var ut=createSymbol(st,o,c);this.add(ut),this[makeSymbolTypeKey(st)]=makeSymbolTypeValue(st,o,c)},this),this._updateCommonStl(o,c,d)},a.prototype.updateData=function(o,c,d){var tt=o.hostModel,nt=this.childOfName("line"),it=o.getItemLayout(c),st={shape:{}};setLinePoints(st.shape,it),updateProps$1(nt,st,tt,c),each$f(SYMBOL_CATEGORIES,function(ut){var ct=makeSymbolTypeValue(ut,o,c),ot=makeSymbolTypeKey(ut);if(this[ot]!==ct){this.remove(this.childOfName(ut));var at=createSymbol(ut,o,c);this.add(at)}this[ot]=ct},this),this._updateCommonStl(o,c,d)},a.prototype.getLinePath=function(){return this.childAt(0)},a.prototype._updateCommonStl=function(o,c,d){var tt=o.hostModel,nt=this.childOfName("line"),it=d&&d.emphasisLineStyle,st=d&&d.blurLineStyle,ut=d&&d.selectLineStyle,ct=d&&d.labelStatesModels,ot=d&&d.emphasisDisabled,at=d&&d.focus,ht=d&&d.blurScope;if(!d||o.hasItemOption){var ft=o.getItemModel(c),mt=ft.getModel("emphasis");it=mt.getModel("lineStyle").getLineStyle(),st=ft.getModel(["blur","lineStyle"]).getLineStyle(),ut=ft.getModel(["select","lineStyle"]).getLineStyle(),ot=mt.get("disabled"),at=mt.get("focus"),ht=mt.get("blurScope"),ct=getLabelStatesModels(ft)}var yt=o.getItemVisual(c,"style"),bt=yt.stroke;nt.useStyle(yt),nt.style.fill=null,nt.style.strokeNoScale=!0,nt.ensureState("emphasis").style=it,nt.ensureState("blur").style=st,nt.ensureState("select").style=ut,each$f(SYMBOL_CATEGORIES,function(Ot){var $t=this.childOfName(Ot);if($t){$t.setColor(bt),$t.style.opacity=yt.opacity;for(var Ft=0;Ft<SPECIAL_STATES.length;Ft++){var kt=SPECIAL_STATES[Ft],Vt=nt.getState(kt);if(Vt){var Ht=Vt.style||{},Qt=$t.ensureState(kt),Xt=Qt.style||(Qt.style={});Ht.stroke!=null&&(Xt[$t.__isEmptyBrush?"stroke":"fill"]=Ht.stroke),Ht.opacity!=null&&(Xt.opacity=Ht.opacity)}}$t.markRedraw()}},this);var wt=tt.getRawValue(c);setLabelStyle(this,ct,{labelDataIndex:c,labelFetcher:{getFormattedLabel:function(Ot,$t){return tt.getFormattedLabel(Ot,$t,o.dataType)}},inheritColor:bt||"#000",defaultOpacity:yt.opacity,defaultText:(wt==null?o.getName(c):isFinite(wt)?round$3(wt):wt)+""});var Tt=this.getTextContent();if(Tt){var Ct=ct.normal;Tt.__align=Tt.style.align,Tt.__verticalAlign=Tt.style.verticalAlign,Tt.__position=Ct.get("position")||"middle";var Dt=Ct.get("distance");isArray$1(Dt)||(Dt=[Dt,Dt]),Tt.__labelDistance=Dt}this.setTextConfig({position:null,local:!0,inside:!1}),toggleHoverEmphasis(this,at,ht,ot)},a.prototype.highlight=function(){enterEmphasis(this)},a.prototype.downplay=function(){leaveEmphasis(this)},a.prototype.updateLayout=function(o,c){this.setLinePoints(o.getItemLayout(c))},a.prototype.setLinePoints=function(o){var c=this.childOfName("line");setLinePoints(c.shape,o),c.dirty()},a.prototype.beforeUpdate=function(){var o=this,c=o.childOfName("fromSymbol"),d=o.childOfName("toSymbol"),tt=o.getTextContent();if(!c&&!d&&(!tt||tt.ignore))return;for(var nt=1,it=this.parent;it;)it.scaleX&&(nt/=it.scaleX),it=it.parent;var st=o.childOfName("line");if(!this.__dirty&&!st.__dirty)return;var ut=st.shape.percent,ct=st.pointAt(0),ot=st.pointAt(ut),at=sub([],ot,ct);normalize$3(at,at);function ht(Vt,Ht){var Qt=Vt.__specifiedRotation;if(Qt==null){var Xt=st.tangentAt(Ht);Vt.attr("rotation",(Ht===1?-1:1)*Math.PI/2-Math.atan2(Xt[1],Xt[0]))}else Vt.attr("rotation",Qt)}if(c&&(c.setPosition(ct),ht(c,0),c.scaleX=c.scaleY=nt*ut,c.markRedraw()),d&&(d.setPosition(ot),ht(d,1),d.scaleX=d.scaleY=nt*ut,d.markRedraw()),tt&&!tt.ignore){tt.x=tt.y=0,tt.originX=tt.originY=0;var ft=void 0,mt=void 0,yt=tt.__labelDistance,bt=yt[0]*nt,wt=yt[1]*nt,Tt=ut/2,Ct=st.tangentAt(Tt),Dt=[Ct[1],-Ct[0]],Ot=st.pointAt(Tt);Dt[1]>0&&(Dt[0]=-Dt[0],Dt[1]=-Dt[1]);var $t=Ct[0]<0?-1:1;if(tt.__position!=="start"&&tt.__position!=="end"){var Ft=-Math.atan2(Ct[1],Ct[0]);ot[0]<ct[0]&&(Ft=Math.PI+Ft),tt.rotation=Ft}var kt=void 0;switch(tt.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":kt=-wt,mt="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":kt=wt,mt="top";break;default:kt=0,mt="middle"}switch(tt.__position){case"end":tt.x=at[0]*bt+ot[0],tt.y=at[1]*wt+ot[1],ft=at[0]>.8?"left":at[0]<-.8?"right":"center",mt=at[1]>.8?"top":at[1]<-.8?"bottom":"middle";break;case"start":tt.x=-at[0]*bt+ct[0],tt.y=-at[1]*wt+ct[1],ft=at[0]>.8?"right":at[0]<-.8?"left":"center",mt=at[1]>.8?"bottom":at[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":tt.x=bt*$t+ct[0],tt.y=ct[1]+kt,ft=Ct[0]<0?"right":"left",tt.originX=-bt*$t,tt.originY=-kt;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":tt.x=Ot[0],tt.y=Ot[1]+kt,ft="center",tt.originY=-kt;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":tt.x=-bt*$t+ot[0],tt.y=ot[1]+kt,ft=Ct[0]>=0?"right":"left",tt.originX=bt*$t,tt.originY=-kt;break}tt.scaleX=tt.scaleY=nt,tt.setStyle({verticalAlign:tt.__verticalAlign||mt,align:tt.__align||ft})}},a}(Group$3),LineDraw=function(){function s(a){this.group=new Group$3,this._LineCtor=a||Line}return s.prototype.updateData=function(a){var o=this;this._progressiveEls=null;var c=this,d=c.group,tt=c._lineData;c._lineData=a,tt||d.removeAll();var nt=makeSeriesScope$1(a);a.diff(tt).add(function(it){o._doAdd(a,it,nt)}).update(function(it,st){o._doUpdate(tt,a,st,it,nt)}).remove(function(it){d.remove(tt.getItemGraphicEl(it))}).execute()},s.prototype.updateLayout=function(){var a=this._lineData;a&&a.eachItemGraphicEl(function(o,c){o.updateLayout(a,c)},this)},s.prototype.incrementalPrepareUpdate=function(a){this._seriesScope=makeSeriesScope$1(a),this._lineData=null,this.group.removeAll()},s.prototype.incrementalUpdate=function(a,o){this._progressiveEls=[];function c(it){!it.isGroup&&!isEffectObject(it)&&(it.incremental=!0,it.ensureState("emphasis").hoverLayer=!0)}for(var d=a.start;d<a.end;d++){var tt=o.getItemLayout(d);if(lineNeedsDraw(tt)){var nt=new this._LineCtor(o,d,this._seriesScope);nt.traverse(c),this.group.add(nt),o.setItemGraphicEl(d,nt),this._progressiveEls.push(nt)}}},s.prototype.remove=function(){this.group.removeAll()},s.prototype.eachRendered=function(a){traverseElements(this._progressiveEls||this.group,a)},s.prototype._doAdd=function(a,o,c){var d=a.getItemLayout(o);if(lineNeedsDraw(d)){var tt=new this._LineCtor(a,o,c);a.setItemGraphicEl(o,tt),this.group.add(tt)}},s.prototype._doUpdate=function(a,o,c,d,tt){var nt=a.getItemGraphicEl(c);if(!lineNeedsDraw(o.getItemLayout(d))){this.group.remove(nt);return}nt?nt.updateData(o,d,tt):nt=new this._LineCtor(o,d,tt),o.setItemGraphicEl(d,nt),this.group.add(nt)},s}();function isEffectObject(s){return s.animators&&s.animators.length>0}function makeSeriesScope$1(s){var a=s.hostModel,o=a.getModel("emphasis");return{lineStyle:a.getModel("lineStyle").getLineStyle(),emphasisLineStyle:o.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:a.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:a.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:o.get("disabled"),blurScope:o.get("blurScope"),focus:o.get("focus"),labelStatesModels:getLabelStatesModels(a)}}function isPointNaN(s){return isNaN(s[0])||isNaN(s[1])}function lineNeedsDraw(s){return s&&!isPointNaN(s[0])&&!isPointNaN(s[1])}var v1=[],v2=[],v3=[],quadraticAt=quadraticAt$1,v2DistSquare=distSquare,mathAbs=Math.abs;function intersectCurveCircle(s,a,o){for(var c=s[0],d=s[1],tt=s[2],nt=1/0,it,st=o*o,ut=.1,ct=.1;ct<=.9;ct+=.1){v1[0]=quadraticAt(c[0],d[0],tt[0],ct),v1[1]=quadraticAt(c[1],d[1],tt[1],ct);var ot=mathAbs(v2DistSquare(v1,a)-st);ot<nt&&(nt=ot,it=ct)}for(var at=0;at<32;at++){var ht=it+ut;v2[0]=quadraticAt(c[0],d[0],tt[0],it),v2[1]=quadraticAt(c[1],d[1],tt[1],it),v3[0]=quadraticAt(c[0],d[0],tt[0],ht),v3[1]=quadraticAt(c[1],d[1],tt[1],ht);var ot=v2DistSquare(v2,a)-st;if(mathAbs(ot)<.01)break;var ft=v2DistSquare(v3,a)-st;ut/=2,ot<0?ft>=0?it=it+ut:it=it-ut:ft>=0?it=it-ut:it=it+ut}return it}function adjustEdge(s,a){var o=[],c=quadraticSubdivide,d=[[],[],[]],tt=[[],[]],nt=[];a/=2,s.eachEdge(function(it,st){var ut=it.getLayout(),ct=it.getVisual("fromSymbol"),ot=it.getVisual("toSymbol");ut.__original||(ut.__original=[clone$3(ut[0]),clone$3(ut[1])],ut[2]&&ut.__original.push(clone$3(ut[2])));var at=ut.__original;if(ut[2]!=null){if(copy$1(d[0],at[0]),copy$1(d[1],at[2]),copy$1(d[2],at[1]),ct&&ct!=="none"){var ht=getSymbolSize(it.node1),ft=intersectCurveCircle(d,at[0],ht*a);c(d[0][0],d[1][0],d[2][0],ft,o),d[0][0]=o[3],d[1][0]=o[4],c(d[0][1],d[1][1],d[2][1],ft,o),d[0][1]=o[3],d[1][1]=o[4]}if(ot&&ot!=="none"){var ht=getSymbolSize(it.node2),ft=intersectCurveCircle(d,at[1],ht*a);c(d[0][0],d[1][0],d[2][0],ft,o),d[1][0]=o[1],d[2][0]=o[2],c(d[0][1],d[1][1],d[2][1],ft,o),d[1][1]=o[1],d[2][1]=o[2]}copy$1(ut[0],d[0]),copy$1(ut[1],d[2]),copy$1(ut[2],d[1])}else{if(copy$1(tt[0],at[0]),copy$1(tt[1],at[1]),sub(nt,tt[1],tt[0]),normalize$3(nt,nt),ct&&ct!=="none"){var ht=getSymbolSize(it.node1);scaleAndAdd$1(tt[0],tt[0],nt,ht*a)}if(ot&&ot!=="none"){var ht=getSymbolSize(it.node2);scaleAndAdd$1(tt[1],tt[1],nt,-ht*a)}copy$1(ut[0],tt[0]),copy$1(ut[1],tt[1])}})}function isViewCoordSys(s){return s.type==="view"}var GraphView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c){var d=new SymbolDraw,tt=new LineDraw,nt=this.group;this._controller=new RoamController(c.getZr()),this._controllerHost={target:nt},nt.add(d.group),nt.add(tt.group),this._symbolDraw=d,this._lineDraw=tt,this._firstRender=!0},a.prototype.render=function(o,c,d){var tt=this,nt=o.coordinateSystem;this._model=o;var it=this._symbolDraw,st=this._lineDraw,ut=this.group;if(isViewCoordSys(nt)){var ct={x:nt.x,y:nt.y,scaleX:nt.scaleX,scaleY:nt.scaleY};this._firstRender?ut.attr(ct):updateProps$1(ut,ct,o)}adjustEdge(o.getGraph(),getNodeGlobalScale(o));var ot=o.getData();it.updateData(ot);var at=o.getEdgeData();st.updateData(at),this._updateNodeAndLinkScale(),this._updateController(o,c,d),clearTimeout(this._layoutTimeout);var ht=o.forceLayout,ft=o.get(["force","layoutAnimation"]);ht&&this._startForceLayoutIteration(ht,ft);var mt=o.get("layout");ot.graph.eachNode(function(Tt){var Ct=Tt.dataIndex,Dt=Tt.getGraphicEl(),Ot=Tt.getModel();if(Dt){Dt.off("drag").off("dragend");var $t=Ot.get("draggable");$t&&Dt.on("drag",function(kt){switch(mt){case"force":ht.warmUp(),!tt._layouting&&tt._startForceLayoutIteration(ht,ft),ht.setFixed(Ct),ot.setItemLayout(Ct,[Dt.x,Dt.y]);break;case"circular":ot.setItemLayout(Ct,[Dt.x,Dt.y]),Tt.setLayout({fixed:!0},!0),circularLayout(o,"symbolSize",Tt,[kt.offsetX,kt.offsetY]),tt.updateLayout(o);break;case"none":default:ot.setItemLayout(Ct,[Dt.x,Dt.y]),simpleLayoutEdge(o.getGraph(),o),tt.updateLayout(o);break}}).on("dragend",function(){ht&&ht.setUnfixed(Ct)}),Dt.setDraggable($t,!!Ot.get("cursor"));var Ft=Ot.get(["emphasis","focus"]);Ft==="adjacency"&&(getECData(Dt).focus=Tt.getAdjacentDataIndices())}}),ot.graph.eachEdge(function(Tt){var Ct=Tt.getGraphicEl(),Dt=Tt.getModel().get(["emphasis","focus"]);Ct&&Dt==="adjacency"&&(getECData(Ct).focus={edge:[Tt.dataIndex],node:[Tt.node1.dataIndex,Tt.node2.dataIndex]})});var yt=o.get("layout")==="circular"&&o.get(["circular","rotateLabel"]),bt=ot.getLayout("cx"),wt=ot.getLayout("cy");ot.graph.eachNode(function(Tt){rotateNodeLabel(Tt,yt,bt,wt)}),this._firstRender=!1},a.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},a.prototype._startForceLayoutIteration=function(o,c){var d=this;(function tt(){o.step(function(nt){d.updateLayout(d._model),(d._layouting=!nt)&&(c?d._layoutTimeout=setTimeout(tt,16):tt())})})()},a.prototype._updateController=function(o,c,d){var tt=this,nt=this._controller,it=this._controllerHost,st=this.group;if(nt.setPointerChecker(function(ut,ct,ot){var at=st.getBoundingRect();return at.applyTransform(st.transform),at.contain(ct,ot)&&!onIrrelevantElement(ut,d,o)}),!isViewCoordSys(o.coordinateSystem)){nt.disable();return}nt.enable(o.get("roam")),it.zoomLimit=o.get("scaleLimit"),it.zoom=o.coordinateSystem.getZoom(),nt.off("pan").off("zoom").on("pan",function(ut){updateViewOnPan(it,ut.dx,ut.dy),d.dispatchAction({seriesId:o.id,type:"graphRoam",dx:ut.dx,dy:ut.dy})}).on("zoom",function(ut){updateViewOnZoom(it,ut.scale,ut.originX,ut.originY),d.dispatchAction({seriesId:o.id,type:"graphRoam",zoom:ut.scale,originX:ut.originX,originY:ut.originY}),tt._updateNodeAndLinkScale(),adjustEdge(o.getGraph(),getNodeGlobalScale(o)),tt._lineDraw.updateLayout(),d.updateLabelLayout()})},a.prototype._updateNodeAndLinkScale=function(){var o=this._model,c=o.getData(),d=getNodeGlobalScale(o);c.eachItemGraphicEl(function(tt,nt){tt&&tt.setSymbolScale(d)})},a.prototype.updateLayout=function(o){adjustEdge(o.getGraph(),getNodeGlobalScale(o)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},a.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},a.type="graph",a}(ChartView);function generateNodeKey(s){return"_EC_"+s}var Graph=function(){function s(a){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=a||!1}return s.prototype.isDirected=function(){return this._directed},s.prototype.addNode=function(a,o){a=a==null?""+o:""+a;var c=this._nodesMap;if(!c[generateNodeKey(a)]){var d=new GraphNode(a,o);return d.hostGraph=this,this.nodes.push(d),c[generateNodeKey(a)]=d,d}},s.prototype.getNodeByIndex=function(a){var o=this.data.getRawIndex(a);return this.nodes[o]},s.prototype.getNodeById=function(a){return this._nodesMap[generateNodeKey(a)]},s.prototype.addEdge=function(a,o,c){var d=this._nodesMap,tt=this._edgesMap;if(isNumber(a)&&(a=this.nodes[a]),isNumber(o)&&(o=this.nodes[o]),a instanceof GraphNode||(a=d[generateNodeKey(a)]),o instanceof GraphNode||(o=d[generateNodeKey(o)]),!(!a||!o)){var nt=a.id+"-"+o.id,it=new GraphEdge(a,o,c);return it.hostGraph=this,this._directed&&(a.outEdges.push(it),o.inEdges.push(it)),a.edges.push(it),a!==o&&o.edges.push(it),this.edges.push(it),tt[nt]=it,it}},s.prototype.getEdgeByIndex=function(a){var o=this.edgeData.getRawIndex(a);return this.edges[o]},s.prototype.getEdge=function(a,o){a instanceof GraphNode&&(a=a.id),o instanceof GraphNode&&(o=o.id);var c=this._edgesMap;return this._directed?c[a+"-"+o]:c[a+"-"+o]||c[o+"-"+a]},s.prototype.eachNode=function(a,o){for(var c=this.nodes,d=c.length,tt=0;tt<d;tt++)c[tt].dataIndex>=0&&a.call(o,c[tt],tt)},s.prototype.eachEdge=function(a,o){for(var c=this.edges,d=c.length,tt=0;tt<d;tt++)c[tt].dataIndex>=0&&c[tt].node1.dataIndex>=0&&c[tt].node2.dataIndex>=0&&a.call(o,c[tt],tt)},s.prototype.breadthFirstTraverse=function(a,o,c,d){if(o instanceof GraphNode||(o=this._nodesMap[generateNodeKey(o)]),!!o){for(var tt=c==="out"?"outEdges":c==="in"?"inEdges":"edges",nt=0;nt<this.nodes.length;nt++)this.nodes[nt].__visited=!1;if(!a.call(d,o,null))for(var it=[o];it.length;)for(var st=it.shift(),ut=st[tt],nt=0;nt<ut.length;nt++){var ct=ut[nt],ot=ct.node1===st?ct.node2:ct.node1;if(!ot.__visited){if(a.call(d,ot,st))return;it.push(ot),ot.__visited=!0}}}},s.prototype.update=function(){for(var a=this.data,o=this.edgeData,c=this.nodes,d=this.edges,tt=0,nt=c.length;tt<nt;tt++)c[tt].dataIndex=-1;for(var tt=0,nt=a.count();tt<nt;tt++)c[a.getRawIndex(tt)].dataIndex=tt;o.filterSelf(function(it){var st=d[o.getRawIndex(it)];return st.node1.dataIndex>=0&&st.node2.dataIndex>=0});for(var tt=0,nt=d.length;tt<nt;tt++)d[tt].dataIndex=-1;for(var tt=0,nt=o.count();tt<nt;tt++)d[o.getRawIndex(tt)].dataIndex=tt},s.prototype.clone=function(){for(var a=new s(this._directed),o=this.nodes,c=this.edges,d=0;d<o.length;d++)a.addNode(o[d].id,o[d].dataIndex);for(var d=0;d<c.length;d++){var tt=c[d];a.addEdge(tt.node1.id,tt.node2.id,tt.dataIndex)}return a},s}(),GraphNode=function(){function s(a,o){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=a??"",this.dataIndex=o??-1}return s.prototype.degree=function(){return this.edges.length},s.prototype.inDegree=function(){return this.inEdges.length},s.prototype.outDegree=function(){return this.outEdges.length},s.prototype.getModel=function(a){if(!(this.dataIndex<0)){var o=this.hostGraph,c=o.data.getItemModel(this.dataIndex);return c.getModel(a)}},s.prototype.getAdjacentDataIndices=function(){for(var a={edge:[],node:[]},o=0;o<this.edges.length;o++){var c=this.edges[o];c.dataIndex<0||(a.edge.push(c.dataIndex),a.node.push(c.node1.dataIndex,c.node2.dataIndex))}return a},s.prototype.getTrajectoryDataIndices=function(){for(var a=createHashMap(),o=createHashMap(),c=0;c<this.edges.length;c++){var d=this.edges[c];if(!(d.dataIndex<0)){a.set(d.dataIndex,!0);for(var tt=[d.node1],nt=[d.node2],it=0;it<tt.length;){var st=tt[it];it++,o.set(st.dataIndex,!0);for(var ut=0;ut<st.inEdges.length;ut++)a.set(st.inEdges[ut].dataIndex,!0),tt.push(st.inEdges[ut].node1)}for(it=0;it<nt.length;){var ct=nt[it];it++,o.set(ct.dataIndex,!0);for(var ut=0;ut<ct.outEdges.length;ut++)a.set(ct.outEdges[ut].dataIndex,!0),nt.push(ct.outEdges[ut].node2)}}}return{edge:a.keys(),node:o.keys()}},s}(),GraphEdge=function(){function s(a,o,c){this.dataIndex=-1,this.node1=a,this.node2=o,this.dataIndex=c??-1}return s.prototype.getModel=function(a){if(!(this.dataIndex<0)){var o=this.hostGraph,c=o.edgeData.getItemModel(this.dataIndex);return c.getModel(a)}},s.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},s.prototype.getTrajectoryDataIndices=function(){var a=createHashMap(),o=createHashMap();a.set(this.dataIndex,!0);for(var c=[this.node1],d=[this.node2],tt=0;tt<c.length;){var nt=c[tt];tt++,o.set(nt.dataIndex,!0);for(var it=0;it<nt.inEdges.length;it++)a.set(nt.inEdges[it].dataIndex,!0),c.push(nt.inEdges[it].node1)}for(tt=0;tt<d.length;){var st=d[tt];tt++,o.set(st.dataIndex,!0);for(var it=0;it<st.outEdges.length;it++)a.set(st.outEdges[it].dataIndex,!0),d.push(st.outEdges[it].node2)}return{edge:a.keys(),node:o.keys()}},s}();function createGraphDataProxyMixin(s,a){return{getValue:function(o){var c=this[s][a];return c.getStore().get(c.getDimensionIndex(o||"value"),this.dataIndex)},setVisual:function(o,c){this.dataIndex>=0&&this[s][a].setItemVisual(this.dataIndex,o,c)},getVisual:function(o){return this[s][a].getItemVisual(this.dataIndex,o)},setLayout:function(o,c){this.dataIndex>=0&&this[s][a].setItemLayout(this.dataIndex,o,c)},getLayout:function(){return this[s][a].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[s][a].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[s][a].getRawIndex(this.dataIndex)}}}mixin(GraphNode,createGraphDataProxyMixin("hostGraph","data"));mixin(GraphEdge,createGraphDataProxyMixin("hostGraph","edgeData"));function createGraphFromNodeEdge(s,a,o,c,d){for(var tt=new Graph(c),nt=0;nt<s.length;nt++)tt.addNode(retrieve(s[nt].id,s[nt].name,nt),nt);for(var it=[],st=[],ut=0,nt=0;nt<a.length;nt++){var ct=a[nt],ot=ct.source,at=ct.target;tt.addEdge(ot,at,ut)&&(st.push(ct),it.push(retrieve(convertOptionIdName(ct.id,null),ot+" > "+at)),ut++)}var ht=o.get("coordinateSystem"),ft;if(ht==="cartesian2d"||ht==="polar")ft=createSeriesData(s,o);else{var mt=CoordinateSystemManager.get(ht),yt=mt?mt.dimensions||[]:[];indexOf(yt,"value")<0&&yt.concat(["value"]);var bt=prepareSeriesDataSchema(s,{coordDimensions:yt,encodeDefine:o.getEncode()}).dimensions;ft=new SeriesData(bt,o),ft.initData(s)}var wt=new SeriesData(["value"],o);return wt.initData(st,it),d&&d(ft,wt),linkSeriesData({mainData:ft,struct:tt,structAttr:"graph",datas:{node:ft,edge:wt},datasAttr:{node:"data",edge:"edgeData"}}),tt.update(),tt}var GraphSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o}return a.prototype.init=function(o){s.prototype.init.apply(this,arguments);var c=this;function d(){return c._categoriesData}this.legendVisualProvider=new LegendVisualProvider(d,d),this.fillDataTextStyle(o.edges||o.links),this._updateCategoriesData()},a.prototype.mergeOption=function(o){s.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(o.edges||o.links),this._updateCategoriesData()},a.prototype.mergeDefaultAndTheme=function(o){s.prototype.mergeDefaultAndTheme.apply(this,arguments),defaultEmphasis(o,"edgeLabel",["show"])},a.prototype.getInitialData=function(o,c){var d=o.edges||o.links||[],tt=o.data||o.nodes||[],nt=this;if(tt&&d){initCurvenessList(this);var it=createGraphFromNodeEdge(tt,d,this,!0,st);return each$f(it.edges,function(ut){createEdgeMapForCurveness(ut.node1,ut.node2,this,ut.dataIndex)},this),it.data}function st(ut,ct){ut.wrapMethod("getItemModel",function(ft){var mt=nt._categoriesModels,yt=ft.getShallow("category"),bt=mt[yt];return bt&&(bt.parentModel=ft.parentModel,ft.parentModel=bt),ft});var ot=Model.prototype.getModel;function at(ft,mt){var yt=ot.call(this,ft,mt);return yt.resolveParentPath=ht,yt}ct.wrapMethod("getItemModel",function(ft){return ft.resolveParentPath=ht,ft.getModel=at,ft});function ht(ft){if(ft&&(ft[0]==="label"||ft[1]==="label")){var mt=ft.slice();return ft[0]==="label"?mt[0]="edgeLabel":ft[1]==="label"&&(mt[1]="edgeLabel"),mt}return ft}}},a.prototype.getGraph=function(){return this.getData().graph},a.prototype.getEdgeData=function(){return this.getGraph().edgeData},a.prototype.getCategoriesData=function(){return this._categoriesData},a.prototype.formatTooltip=function(o,c,d){if(d==="edge"){var tt=this.getData(),nt=this.getDataParams(o,d),it=tt.graph.getEdgeByIndex(o),st=tt.getName(it.node1.dataIndex),ut=tt.getName(it.node2.dataIndex),ct=[];return st!=null&&ct.push(st),ut!=null&&ct.push(ut),createTooltipMarkup("nameValue",{name:ct.join(" > "),value:nt.value,noValue:nt.value==null})}var ot=defaultSeriesFormatTooltip({series:this,dataIndex:o,multipleSeries:c});return ot},a.prototype._updateCategoriesData=function(){var o=map$1(this.option.categories||[],function(d){return d.value!=null?d:extend({value:0},d)}),c=new SeriesData(["value"],this);c.initData(o),this._categoriesData=c,this._categoriesModels=c.mapArray(function(d){return c.getItemModel(d)})},a.prototype.setZoom=function(o){this.option.zoom=o},a.prototype.setCenter=function(o){this.option.center=o},a.prototype.isAnimationEnabled=function(){return s.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},a.type="series.graph",a.dependencies=["grid","polar","geo","singleAxis","calendar"],a.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},a}(SeriesModel),actionInfo$1={type:"graphRoam",event:"graphRoam",update:"none"};function install$F(s){s.registerChartView(GraphView),s.registerSeriesModel(GraphSeriesModel),s.registerProcessor(categoryFilter),s.registerVisual(categoryVisual),s.registerVisual(graphEdgeVisual),s.registerLayout(graphSimpleLayout),s.registerLayout(s.PRIORITY.VISUAL.POST_CHART_LAYOUT,graphCircularLayout),s.registerLayout(graphForceLayout),s.registerCoordinateSystem("graphView",{dimensions:View.dimensions,create:createViewCoordSys}),s.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},noop),s.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},noop),s.registerAction(actionInfo$1,function(a,o,c){o.eachComponent({mainType:"series",query:a},function(d){var tt=d.coordinateSystem,nt=updateCenterAndZoom(tt,a,void 0,c);d.setCenter&&d.setCenter(nt.center),d.setZoom&&d.setZoom(nt.zoom)})})}var PointerShape=function(){function s(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return s}(),PointerPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="pointer",c}return a.prototype.getDefaultShape=function(){return new PointerShape},a.prototype.buildPath=function(o,c){var d=Math.cos,tt=Math.sin,nt=c.r,it=c.width,st=c.angle,ut=c.x-d(st)*it*(it>=nt/3?1:2),ct=c.y-tt(st)*it*(it>=nt/3?1:2);st=c.angle-Math.PI/2,o.moveTo(ut,ct),o.lineTo(c.x+d(st)*it,c.y+tt(st)*it),o.lineTo(c.x+d(c.angle)*nt,c.y+tt(c.angle)*nt),o.lineTo(c.x-d(st)*it,c.y-tt(st)*it),o.lineTo(ut,ct)},a}(Path);function parsePosition(s,a){var o=s.get("center"),c=a.getWidth(),d=a.getHeight(),tt=Math.min(c,d),nt=parsePercent(o[0],a.getWidth()),it=parsePercent(o[1],a.getHeight()),st=parsePercent(s.get("radius"),tt/2);return{cx:nt,cy:it,r:st}}function formatLabel(s,a){var o=s==null?"":s+"";return a&&(isString$1(a)?o=a.replace("{value}",o):isFunction$1(a)&&(o=a(s))),o}var GaugeView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){this.group.removeAll();var tt=o.get(["axisLine","lineStyle","color"]),nt=parsePosition(o,d);this._renderMain(o,c,d,tt,nt),this._data=o.getData()},a.prototype.dispose=function(){},a.prototype._renderMain=function(o,c,d,tt,nt){var it=this.group,st=o.get("clockwise"),ut=-o.get("startAngle")/180*Math.PI,ct=-o.get("endAngle")/180*Math.PI,ot=o.getModel("axisLine"),at=ot.get("roundCap"),ht=at?SausagePath:Sector,ft=ot.get("show"),mt=ot.getModel("lineStyle"),yt=mt.get("width"),bt=[ut,ct];normalizeArcAngles(bt,!st),ut=bt[0],ct=bt[1];for(var wt=ct-ut,Tt=ut,Ct=[],Dt=0;ft&&Dt<tt.length;Dt++){var Ot=Math.min(Math.max(tt[Dt][0],0),1);ct=ut+wt*Ot;var $t=new ht({shape:{startAngle:Tt,endAngle:ct,cx:nt.cx,cy:nt.cy,clockwise:st,r0:nt.r-yt,r:nt.r},silent:!0});$t.setStyle({fill:tt[Dt][1]}),$t.setStyle(mt.getLineStyle(["color","width"])),Ct.push($t),Tt=ct}Ct.reverse(),each$f(Ct,function(kt){return it.add(kt)});var Ft=function(kt){if(kt<=0)return tt[0][1];var Vt;for(Vt=0;Vt<tt.length;Vt++)if(tt[Vt][0]>=kt&&(Vt===0?0:tt[Vt-1][0])<kt)return tt[Vt][1];return tt[Vt-1][1]};this._renderTicks(o,c,d,Ft,nt,ut,ct,st,yt),this._renderTitleAndDetail(o,c,d,Ft,nt),this._renderAnchor(o,nt),this._renderPointer(o,c,d,Ft,nt,ut,ct,st,yt)},a.prototype._renderTicks=function(o,c,d,tt,nt,it,st,ut,ct){for(var ot=this.group,at=nt.cx,ht=nt.cy,ft=nt.r,mt=+o.get("min"),yt=+o.get("max"),bt=o.getModel("splitLine"),wt=o.getModel("axisTick"),Tt=o.getModel("axisLabel"),Ct=o.get("splitNumber"),Dt=wt.get("splitNumber"),Ot=parsePercent(bt.get("length"),ft),$t=parsePercent(wt.get("length"),ft),Ft=it,kt=(st-it)/Ct,Vt=kt/Dt,Ht=bt.getModel("lineStyle").getLineStyle(),Qt=wt.getModel("lineStyle").getLineStyle(),Xt=bt.get("distance"),Zt,ar,nr=0;nr<=Ct;nr++){if(Zt=Math.cos(Ft),ar=Math.sin(Ft),bt.get("show")){var cr=Xt?Xt+ct:ct,dr=new Line$1({shape:{x1:Zt*(ft-cr)+at,y1:ar*(ft-cr)+ht,x2:Zt*(ft-Ot-cr)+at,y2:ar*(ft-Ot-cr)+ht},style:Ht,silent:!0});Ht.stroke==="auto"&&dr.setStyle({stroke:tt(nr/Ct)}),ot.add(dr)}if(Tt.get("show")){var cr=Tt.get("distance")+Xt,mr=formatLabel(round$3(nr/Ct*(yt-mt)+mt),Tt.get("formatter")),Dr=tt(nr/Ct),kr=Zt*(ft-Ot-cr)+at,Yr=ar*(ft-Ot-cr)+ht,Mr=Tt.get("rotate"),Jr=0;Mr==="radial"?(Jr=-Ft+2*Math.PI,Jr>Math.PI/2&&(Jr+=Math.PI)):Mr==="tangential"?Jr=-Ft-Math.PI/2:isNumber(Mr)&&(Jr=Mr*Math.PI/180),Jr===0?ot.add(new ZRText({style:createTextStyle$1(Tt,{text:mr,x:kr,y:Yr,verticalAlign:ar<-.8?"top":ar>.8?"bottom":"middle",align:Zt<-.4?"left":Zt>.4?"right":"center"},{inheritColor:Dr}),silent:!0})):ot.add(new ZRText({style:createTextStyle$1(Tt,{text:mr,x:kr,y:Yr,verticalAlign:"middle",align:"center"},{inheritColor:Dr}),silent:!0,originX:kr,originY:Yr,rotation:Jr}))}if(wt.get("show")&&nr!==Ct){var cr=wt.get("distance");cr=cr?cr+ct:ct;for(var an=0;an<=Dt;an++){Zt=Math.cos(Ft),ar=Math.sin(Ft);var xn=new Line$1({shape:{x1:Zt*(ft-cr)+at,y1:ar*(ft-cr)+ht,x2:Zt*(ft-$t-cr)+at,y2:ar*(ft-$t-cr)+ht},silent:!0,style:Qt});Qt.stroke==="auto"&&xn.setStyle({stroke:tt((nr+an/Dt)/Ct)}),ot.add(xn),Ft+=Vt}Ft-=Vt}else Ft+=kt}},a.prototype._renderPointer=function(o,c,d,tt,nt,it,st,ut,ct){var ot=this.group,at=this._data,ht=this._progressEls,ft=[],mt=o.get(["pointer","show"]),yt=o.getModel("progress"),bt=yt.get("show"),wt=o.getData(),Tt=wt.mapDimension("value"),Ct=+o.get("min"),Dt=+o.get("max"),Ot=[Ct,Dt],$t=[it,st];function Ft(Vt,Ht){var Qt=wt.getItemModel(Vt),Xt=Qt.getModel("pointer"),Zt=parsePercent(Xt.get("width"),nt.r),ar=parsePercent(Xt.get("length"),nt.r),nr=o.get(["pointer","icon"]),cr=Xt.get("offsetCenter"),dr=parsePercent(cr[0],nt.r),mr=parsePercent(cr[1],nt.r),Dr=Xt.get("keepAspect"),kr;return nr?kr=createSymbol$1(nr,dr-Zt/2,mr-ar,Zt,ar,null,Dr):kr=new PointerPath({shape:{angle:-Math.PI/2,width:Zt,r:ar,x:dr,y:mr}}),kr.rotation=-(Ht+Math.PI/2),kr.x=nt.cx,kr.y=nt.cy,kr}function kt(Vt,Ht){var Qt=yt.get("roundCap"),Xt=Qt?SausagePath:Sector,Zt=yt.get("overlap"),ar=Zt?yt.get("width"):ct/wt.count(),nr=Zt?nt.r-ar:nt.r-(Vt+1)*ar,cr=Zt?nt.r:nt.r-Vt*ar,dr=new Xt({shape:{startAngle:it,endAngle:Ht,cx:nt.cx,cy:nt.cy,clockwise:ut,r0:nr,r:cr}});return Zt&&(dr.z2=linearMap$2(wt.get(Tt,Vt),[Ct,Dt],[100,0],!0)),dr}(bt||mt)&&(wt.diff(at).add(function(Vt){var Ht=wt.get(Tt,Vt);if(mt){var Qt=Ft(Vt,it);initProps(Qt,{rotation:-((isNaN(+Ht)?$t[0]:linearMap$2(Ht,Ot,$t,!0))+Math.PI/2)},o),ot.add(Qt),wt.setItemGraphicEl(Vt,Qt)}if(bt){var Xt=kt(Vt,it),Zt=yt.get("clip");initProps(Xt,{shape:{endAngle:linearMap$2(Ht,Ot,$t,Zt)}},o),ot.add(Xt),setCommonECData(o.seriesIndex,wt.dataType,Vt,Xt),ft[Vt]=Xt}}).update(function(Vt,Ht){var Qt=wt.get(Tt,Vt);if(mt){var Xt=at.getItemGraphicEl(Ht),Zt=Xt?Xt.rotation:it,ar=Ft(Vt,Zt);ar.rotation=Zt,updateProps$1(ar,{rotation:-((isNaN(+Qt)?$t[0]:linearMap$2(Qt,Ot,$t,!0))+Math.PI/2)},o),ot.add(ar),wt.setItemGraphicEl(Vt,ar)}if(bt){var nr=ht[Ht],cr=nr?nr.shape.endAngle:it,dr=kt(Vt,cr),mr=yt.get("clip");updateProps$1(dr,{shape:{endAngle:linearMap$2(Qt,Ot,$t,mr)}},o),ot.add(dr),setCommonECData(o.seriesIndex,wt.dataType,Vt,dr),ft[Vt]=dr}}).execute(),wt.each(function(Vt){var Ht=wt.getItemModel(Vt),Qt=Ht.getModel("emphasis"),Xt=Qt.get("focus"),Zt=Qt.get("blurScope"),ar=Qt.get("disabled");if(mt){var nr=wt.getItemGraphicEl(Vt),cr=wt.getItemVisual(Vt,"style"),dr=cr.fill;if(nr instanceof ZRImage){var mr=nr.style;nr.useStyle(extend({image:mr.image,x:mr.x,y:mr.y,width:mr.width,height:mr.height},cr))}else nr.useStyle(cr),nr.type!=="pointer"&&nr.setColor(dr);nr.setStyle(Ht.getModel(["pointer","itemStyle"]).getItemStyle()),nr.style.fill==="auto"&&nr.setStyle("fill",tt(linearMap$2(wt.get(Tt,Vt),Ot,[0,1],!0))),nr.z2EmphasisLift=0,setStatesStylesFromModel(nr,Ht),toggleHoverEmphasis(nr,Xt,Zt,ar)}if(bt){var Dr=ft[Vt];Dr.useStyle(wt.getItemVisual(Vt,"style")),Dr.setStyle(Ht.getModel(["progress","itemStyle"]).getItemStyle()),Dr.z2EmphasisLift=0,setStatesStylesFromModel(Dr,Ht),toggleHoverEmphasis(Dr,Xt,Zt,ar)}}),this._progressEls=ft)},a.prototype._renderAnchor=function(o,c){var d=o.getModel("anchor"),tt=d.get("show");if(tt){var nt=d.get("size"),it=d.get("icon"),st=d.get("offsetCenter"),ut=d.get("keepAspect"),ct=createSymbol$1(it,c.cx-nt/2+parsePercent(st[0],c.r),c.cy-nt/2+parsePercent(st[1],c.r),nt,nt,null,ut);ct.z2=d.get("showAbove")?1:0,ct.setStyle(d.getModel("itemStyle").getItemStyle()),this.group.add(ct)}},a.prototype._renderTitleAndDetail=function(o,c,d,tt,nt){var it=this,st=o.getData(),ut=st.mapDimension("value"),ct=+o.get("min"),ot=+o.get("max"),at=new Group$3,ht=[],ft=[],mt=o.isAnimationEnabled(),yt=o.get(["pointer","showAbove"]);st.diff(this._data).add(function(bt){ht[bt]=new ZRText({silent:!0}),ft[bt]=new ZRText({silent:!0})}).update(function(bt,wt){ht[bt]=it._titleEls[wt],ft[bt]=it._detailEls[wt]}).execute(),st.each(function(bt){var wt=st.getItemModel(bt),Tt=st.get(ut,bt),Ct=new Group$3,Dt=tt(linearMap$2(Tt,[ct,ot],[0,1],!0)),Ot=wt.getModel("title");if(Ot.get("show")){var $t=Ot.get("offsetCenter"),Ft=nt.cx+parsePercent($t[0],nt.r),kt=nt.cy+parsePercent($t[1],nt.r),Vt=ht[bt];Vt.attr({z2:yt?0:2,style:createTextStyle$1(Ot,{x:Ft,y:kt,text:st.getName(bt),align:"center",verticalAlign:"middle"},{inheritColor:Dt})}),Ct.add(Vt)}var Ht=wt.getModel("detail");if(Ht.get("show")){var Qt=Ht.get("offsetCenter"),Xt=nt.cx+parsePercent(Qt[0],nt.r),Zt=nt.cy+parsePercent(Qt[1],nt.r),ar=parsePercent(Ht.get("width"),nt.r),nr=parsePercent(Ht.get("height"),nt.r),cr=o.get(["progress","show"])?st.getItemVisual(bt,"style").fill:Dt,Vt=ft[bt],dr=Ht.get("formatter");Vt.attr({z2:yt?0:2,style:createTextStyle$1(Ht,{x:Xt,y:Zt,text:formatLabel(Tt,dr),width:isNaN(ar)?null:ar,height:isNaN(nr)?null:nr,align:"center",verticalAlign:"middle"},{inheritColor:cr})}),setLabelValueAnimation(Vt,{normal:Ht},Tt,function(Dr){return formatLabel(Dr,dr)}),mt&&animateLabelValue(Vt,bt,st,o,{getFormattedLabel:function(Dr,kr,Yr,Mr,Jr,an){return formatLabel(an?an.interpolatedValue:Tt,dr)}}),Ct.add(Vt)}at.add(Ct)}),this.group.add(at),this._titleEls=ht,this._detailEls=ft},a.type="gauge",a}(ChartView),GaugeSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.visualStyleAccessPath="itemStyle",o}return a.prototype.getInitialData=function(o,c){return createSeriesDataSimply(this,["value"])},a.type="series.gauge",a.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},a}(SeriesModel);function install$E(s){s.registerChartView(GaugeView),s.registerSeriesModel(GaugeSeriesModel)}var opacityAccessPath$1=["itemStyle","opacity"],FunnelPiece=function(s){__extends$1(a,s);function a(o,c){var d=s.call(this)||this,tt=d,nt=new Polyline$1,it=new ZRText;return tt.setTextContent(it),d.setTextGuideLine(nt),d.updateData(o,c,!0),d}return a.prototype.updateData=function(o,c,d){var tt=this,nt=o.hostModel,it=o.getItemModel(c),st=o.getItemLayout(c),ut=it.getModel("emphasis"),ct=it.get(opacityAccessPath$1);ct=ct??1,d||saveOldStyle(tt),tt.useStyle(o.getItemVisual(c,"style")),tt.style.lineJoin="round",d?(tt.setShape({points:st.points}),tt.style.opacity=0,initProps(tt,{style:{opacity:ct}},nt,c)):updateProps$1(tt,{style:{opacity:ct},shape:{points:st.points}},nt,c),setStatesStylesFromModel(tt,it),this._updateLabel(o,c),toggleHoverEmphasis(this,ut.get("focus"),ut.get("blurScope"),ut.get("disabled"))},a.prototype._updateLabel=function(o,c){var d=this,tt=this.getTextGuideLine(),nt=d.getTextContent(),it=o.hostModel,st=o.getItemModel(c),ut=o.getItemLayout(c),ct=ut.label,ot=o.getItemVisual(c,"style"),at=ot.fill;setLabelStyle(nt,getLabelStatesModels(st),{labelFetcher:o.hostModel,labelDataIndex:c,defaultOpacity:ot.opacity,defaultText:o.getName(c)},{normal:{align:ct.textAlign,verticalAlign:ct.verticalAlign}}),d.setTextConfig({local:!0,inside:!!ct.inside,insideStroke:at,outsideFill:at});var ht=ct.linePoints;tt.setShape({points:ht}),d.textGuideLineConfig={anchor:ht?new Point(ht[0][0],ht[0][1]):null},updateProps$1(nt,{style:{x:ct.x,y:ct.y}},it,c),nt.attr({rotation:ct.rotation,originX:ct.x,originY:ct.y,z2:10}),setLabelLineStyle(d,getLabelLineStatesModels(st),{stroke:at})},a}(Polygon),FunnelView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.ignoreLabelLineUpdate=!0,o}return a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this._data,it=this.group;tt.diff(nt).add(function(st){var ut=new FunnelPiece(tt,st);tt.setItemGraphicEl(st,ut),it.add(ut)}).update(function(st,ut){var ct=nt.getItemGraphicEl(ut);ct.updateData(tt,st),it.add(ct),tt.setItemGraphicEl(st,ct)}).remove(function(st){var ut=nt.getItemGraphicEl(st);removeElementWithFadeOut(ut,o,st)}).execute(),this._data=tt},a.prototype.remove=function(){this.group.removeAll(),this._data=null},a.prototype.dispose=function(){},a.type="funnel",a}(ChartView),FunnelSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o){s.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$2(this.getData,this),bind$2(this.getRawData,this)),this._defaultLabelLine(o)},a.prototype.getInitialData=function(o,c){return createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)})},a.prototype._defaultLabelLine=function(o){defaultEmphasis(o,"labelLine",["show"]);var c=o.labelLine,d=o.emphasis.labelLine;c.show=c.show&&o.label.show,d.show=d.show&&o.emphasis.label.show},a.prototype.getDataParams=function(o){var c=this.getData(),d=s.prototype.getDataParams.call(this,o),tt=c.mapDimension("value"),nt=c.getSum(tt);return d.percent=nt?+(c.get(tt,o)/nt*100).toFixed(2):0,d.$vars.push("percent"),d},a.type="series.funnel",a.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},a}(SeriesModel);function getViewRect$2(s,a){return getLayoutRect(s.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})}function getSortedIndices(s,a){for(var o=s.mapDimension("value"),c=s.mapArray(o,function(st){return st}),d=[],tt=a==="ascending",nt=0,it=s.count();nt<it;nt++)d[nt]=nt;return isFunction$1(a)?d.sort(a):a!=="none"&&d.sort(function(st,ut){return tt?c[st]-c[ut]:c[ut]-c[st]}),d}function labelLayout(s){var a=s.hostModel,o=a.get("orient");s.each(function(c){var d=s.getItemModel(c),tt=d.getModel("label"),nt=tt.get("position"),it=d.getModel("labelLine"),st=s.getItemLayout(c),ut=st.points,ct=nt==="inner"||nt==="inside"||nt==="center"||nt==="insideLeft"||nt==="insideRight",ot,at,ht,ft;if(ct)nt==="insideLeft"?(at=(ut[0][0]+ut[3][0])/2+5,ht=(ut[0][1]+ut[3][1])/2,ot="left"):nt==="insideRight"?(at=(ut[1][0]+ut[2][0])/2-5,ht=(ut[1][1]+ut[2][1])/2,ot="right"):(at=(ut[0][0]+ut[1][0]+ut[2][0]+ut[3][0])/4,ht=(ut[0][1]+ut[1][1]+ut[2][1]+ut[3][1])/4,ot="center"),ft=[[at,ht],[at,ht]];else{var mt=void 0,yt=void 0,bt=void 0,wt=void 0,Tt=it.get("length");nt==="left"?(mt=(ut[3][0]+ut[0][0])/2,yt=(ut[3][1]+ut[0][1])/2,bt=mt-Tt,at=bt-5,ot="right"):nt==="right"?(mt=(ut[1][0]+ut[2][0])/2,yt=(ut[1][1]+ut[2][1])/2,bt=mt+Tt,at=bt+5,ot="left"):nt==="top"?(mt=(ut[3][0]+ut[0][0])/2,yt=(ut[3][1]+ut[0][1])/2,wt=yt-Tt,ht=wt-5,ot="center"):nt==="bottom"?(mt=(ut[1][0]+ut[2][0])/2,yt=(ut[1][1]+ut[2][1])/2,wt=yt+Tt,ht=wt+5,ot="center"):nt==="rightTop"?(mt=o==="horizontal"?ut[3][0]:ut[1][0],yt=o==="horizontal"?ut[3][1]:ut[1][1],o==="horizontal"?(wt=yt-Tt,ht=wt-5,ot="center"):(bt=mt+Tt,at=bt+5,ot="top")):nt==="rightBottom"?(mt=ut[2][0],yt=ut[2][1],o==="horizontal"?(wt=yt+Tt,ht=wt+5,ot="center"):(bt=mt+Tt,at=bt+5,ot="bottom")):nt==="leftTop"?(mt=ut[0][0],yt=o==="horizontal"?ut[0][1]:ut[1][1],o==="horizontal"?(wt=yt-Tt,ht=wt-5,ot="center"):(bt=mt-Tt,at=bt-5,ot="right")):nt==="leftBottom"?(mt=o==="horizontal"?ut[1][0]:ut[3][0],yt=o==="horizontal"?ut[1][1]:ut[2][1],o==="horizontal"?(wt=yt+Tt,ht=wt+5,ot="center"):(bt=mt-Tt,at=bt-5,ot="right")):(mt=(ut[1][0]+ut[2][0])/2,yt=(ut[1][1]+ut[2][1])/2,o==="horizontal"?(wt=yt+Tt,ht=wt+5,ot="center"):(bt=mt+Tt,at=bt+5,ot="left")),o==="horizontal"?(bt=mt,at=bt):(wt=yt,ht=wt),ft=[[mt,yt],[bt,wt]]}st.label={linePoints:ft,x:at,y:ht,verticalAlign:"middle",textAlign:ot,inside:ct}})}function funnelLayout(s,a){s.eachSeriesByType("funnel",function(o){var c=o.getData(),d=c.mapDimension("value"),tt=o.get("sort"),nt=getViewRect$2(o,a),it=o.get("orient"),st=nt.width,ut=nt.height,ct=getSortedIndices(c,tt),ot=nt.x,at=nt.y,ht=it==="horizontal"?[parsePercent(o.get("minSize"),ut),parsePercent(o.get("maxSize"),ut)]:[parsePercent(o.get("minSize"),st),parsePercent(o.get("maxSize"),st)],ft=c.getDataExtent(d),mt=o.get("min"),yt=o.get("max");mt==null&&(mt=Math.min(ft[0],0)),yt==null&&(yt=ft[1]);var bt=o.get("funnelAlign"),wt=o.get("gap"),Tt=it==="horizontal"?st:ut,Ct=(Tt-wt*(c.count()-1))/c.count(),Dt=function(Zt,ar){if(it==="horizontal"){var nr=c.get(d,Zt)||0,cr=linearMap$2(nr,[mt,yt],ht,!0),dr=void 0;switch(bt){case"top":dr=at;break;case"center":dr=at+(ut-cr)/2;break;case"bottom":dr=at+(ut-cr);break}return[[ar,dr],[ar,dr+cr]]}var mr=c.get(d,Zt)||0,Dr=linearMap$2(mr,[mt,yt],ht,!0),kr;switch(bt){case"left":kr=ot;break;case"center":kr=ot+(st-Dr)/2;break;case"right":kr=ot+st-Dr;break}return[[kr,ar],[kr+Dr,ar]]};tt==="ascending"&&(Ct=-Ct,wt=-wt,it==="horizontal"?ot+=st:at+=ut,ct=ct.reverse());for(var Ot=0;Ot<ct.length;Ot++){var $t=ct[Ot],Ft=ct[Ot+1],kt=c.getItemModel($t);if(it==="horizontal"){var Vt=kt.get(["itemStyle","width"]);Vt==null?Vt=Ct:(Vt=parsePercent(Vt,st),tt==="ascending"&&(Vt=-Vt));var Ht=Dt($t,ot),Qt=Dt(Ft,ot+Vt);ot+=Vt+wt,c.setItemLayout($t,{points:Ht.concat(Qt.slice().reverse())})}else{var Xt=kt.get(["itemStyle","height"]);Xt==null?Xt=Ct:(Xt=parsePercent(Xt,ut),tt==="ascending"&&(Xt=-Xt));var Ht=Dt($t,at),Qt=Dt(Ft,at+Xt);at+=Xt+wt,c.setItemLayout($t,{points:Ht.concat(Qt.slice().reverse())})}}labelLayout(c)})}function install$D(s){s.registerChartView(FunnelView),s.registerSeriesModel(FunnelSeriesModel),s.registerLayout(funnelLayout),s.registerProcessor(dataFilter$1("funnel"))}var DEFAULT_SMOOTH=.3,ParallelView$1=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._dataGroup=new Group$3,o._initialized=!1,o}return a.prototype.init=function(){this.group.add(this._dataGroup)},a.prototype.render=function(o,c,d,tt){this._progressiveEls=null;var nt=this._dataGroup,it=o.getData(),st=this._data,ut=o.coordinateSystem,ct=ut.dimensions,ot=makeSeriesScope(o);it.diff(st).add(at).update(ht).remove(ft).execute();function at(yt){var bt=addEl(it,nt,yt,ct,ut);updateElCommon(bt,it,yt,ot)}function ht(yt,bt){var wt=st.getItemGraphicEl(bt),Tt=createLinePoints(it,yt,ct,ut);it.setItemGraphicEl(yt,wt),updateProps$1(wt,{shape:{points:Tt}},o,yt),saveOldStyle(wt),updateElCommon(wt,it,yt,ot)}function ft(yt){var bt=st.getItemGraphicEl(yt);nt.remove(bt)}if(!this._initialized){this._initialized=!0;var mt=createGridClipShape$2(ut,o,function(){setTimeout(function(){nt.removeClipPath()})});nt.setClipPath(mt)}this._data=it},a.prototype.incrementalPrepareRender=function(o,c,d){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},a.prototype.incrementalRender=function(o,c,d){for(var tt=c.getData(),nt=c.coordinateSystem,it=nt.dimensions,st=makeSeriesScope(c),ut=this._progressiveEls=[],ct=o.start;ct<o.end;ct++){var ot=addEl(tt,this._dataGroup,ct,it,nt);ot.incremental=!0,updateElCommon(ot,tt,ct,st),ut.push(ot)}},a.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},a.type="parallel",a}(ChartView);function createGridClipShape$2(s,a,o){var c=s.model,d=s.getRect(),tt=new Rect$2({shape:{x:d.x,y:d.y,width:d.width,height:d.height}}),nt=c.get("layout")==="horizontal"?"width":"height";return tt.setShape(nt,0),initProps(tt,{shape:{width:d.width,height:d.height}},a,o),tt}function createLinePoints(s,a,o,c){for(var d=[],tt=0;tt<o.length;tt++){var nt=o[tt],it=s.get(s.mapDimension(nt),a);isEmptyValue(it,c.getAxis(nt).type)||d.push(c.dataToPoint(it,nt))}return d}function addEl(s,a,o,c,d){var tt=createLinePoints(s,o,c,d),nt=new Polyline$1({shape:{points:tt},z2:10});return a.add(nt),s.setItemGraphicEl(o,nt),nt}function makeSeriesScope(s){var a=s.get("smooth",!0);return a===!0&&(a=DEFAULT_SMOOTH),a=numericToNumber(a),eqNaN(a)&&(a=0),{smooth:a}}function updateElCommon(s,a,o,c){s.useStyle(a.getItemVisual(o,"style")),s.style.fill=null,s.setShape("smooth",c.smooth);var d=a.getItemModel(o),tt=d.getModel("emphasis");setStatesStylesFromModel(s,d,"lineStyle"),toggleHoverEmphasis(s,tt.get("focus"),tt.get("blurScope"),tt.get("disabled"))}function isEmptyValue(s,a){return a==="category"?s==null:s==null||isNaN(s)}var ParallelSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.visualStyleAccessPath="lineStyle",o.visualDrawType="stroke",o}return a.prototype.getInitialData=function(o,c){return createSeriesData(null,this,{useEncodeDefaulter:bind$2(makeDefaultEncode,null,this)})},a.prototype.getRawIndicesByActiveState=function(o){var c=this.coordinateSystem,d=this.getData(),tt=[];return c.eachActiveState(d,function(nt,it){o===nt&&tt.push(d.getRawIndex(it))}),tt},a.type="series.parallel",a.dependencies=["parallel"],a.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},a}(SeriesModel);function makeDefaultEncode(s){var a=s.ecModel.getComponent("parallel",s.get("parallelIndex"));if(a){var o={};return each$f(a.dimensions,function(c){var d=convertDimNameToNumber(c);o[c]=d}),o}}function convertDimNameToNumber(s){return+s.replace("dim","")}var opacityAccessPath=["lineStyle","opacity"],parallelVisual={seriesType:"parallel",reset:function(s,a){var o=s.coordinateSystem,c={normal:s.get(["lineStyle","opacity"]),active:s.get("activeOpacity"),inactive:s.get("inactiveOpacity")};return{progress:function(d,tt){o.eachActiveState(tt,function(nt,it){var st=c[nt];if(nt==="normal"&&tt.hasItemOption){var ut=tt.getItemModel(it).get(opacityAccessPath,!0);ut!=null&&(st=ut)}var ct=tt.ensureUniqueItemVisual(it,"style");ct.opacity=st},d.start,d.end)}}}};function parallelPreprocessor(s){createParallelIfNeeded(s),mergeAxisOptionFromParallel(s)}function createParallelIfNeeded(s){if(!s.parallel){var a=!1;each$f(s.series,function(o){o&&o.type==="parallel"&&(a=!0)}),a&&(s.parallel=[{}])}}function mergeAxisOptionFromParallel(s){var a=normalizeToArray(s.parallelAxis);each$f(a,function(o){if(isObject$3(o)){var c=o.parallelIndex||0,d=normalizeToArray(s.parallel)[c];d&&d.parallelAxisDefault&&merge(o,d.parallelAxisDefault,!1)}})}var CLICK_THRESHOLD=5,ParallelView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){this._model=o,this._api=d,this._handlers||(this._handlers={},each$f(handlers$1,function(tt,nt){d.getZr().on(nt,this._handlers[nt]=bind$2(tt,this))},this)),createOrUpdate(this,"_throttledDispatchExpand",o.get("axisExpandRate"),"fixRate")},a.prototype.dispose=function(o,c){clear$2(this,"_throttledDispatchExpand"),each$f(this._handlers,function(d,tt){c.getZr().off(tt,d)}),this._handlers=null},a.prototype._throttledDispatchExpand=function(o){this._dispatchExpand(o)},a.prototype._dispatchExpand=function(o){o&&this._api.dispatchAction(extend({type:"parallelAxisExpand"},o))},a.type="parallel",a}(ComponentView),handlers$1={mousedown:function(s){checkTrigger(this,"click")&&(this._mouseDownPoint=[s.offsetX,s.offsetY])},mouseup:function(s){var a=this._mouseDownPoint;if(checkTrigger(this,"click")&&a){var o=[s.offsetX,s.offsetY],c=Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2);if(c>CLICK_THRESHOLD)return;var d=this._model.coordinateSystem.getSlidedAxisExpandWindow([s.offsetX,s.offsetY]);d.behavior!=="none"&&this._dispatchExpand({axisExpandWindow:d.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(s){if(!(this._mouseDownPoint||!checkTrigger(this,"mousemove"))){var a=this._model,o=a.coordinateSystem.getSlidedAxisExpandWindow([s.offsetX,s.offsetY]),c=o.behavior;c==="jump"&&this._throttledDispatchExpand.debounceNextCall(a.get("axisExpandDebounce")),this._throttledDispatchExpand(c==="none"?null:{axisExpandWindow:o.axisExpandWindow,animation:c==="jump"?null:{duration:0}})}}};function checkTrigger(s,a){var o=s._model;return o.get("axisExpandable")&&o.get("axisExpandTriggerOn")===a}var ParallelModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(){s.prototype.init.apply(this,arguments),this.mergeOption({})},a.prototype.mergeOption=function(o){var c=this.option;o&&merge(c,o,!0),this._initDimensions()},a.prototype.contains=function(o,c){var d=o.get("parallelIndex");return d!=null&&c.getComponent("parallel",d)===this},a.prototype.setAxisExpand=function(o){each$f(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(c){o.hasOwnProperty(c)&&(this.option[c]=o[c])},this)},a.prototype._initDimensions=function(){var o=this.dimensions=[],c=this.parallelAxisIndex=[],d=filter(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(tt){return(tt.get("parallelIndex")||0)===this.componentIndex},this);each$f(d,function(tt){o.push("dim"+tt.get("dim")),c.push(tt.componentIndex)})},a.type="parallel",a.dependencies=["parallelAxis"],a.layoutMode="box",a.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},a}(ComponentModel),ParallelAxis=function(s){__extends$1(a,s);function a(o,c,d,tt,nt){var it=s.call(this,o,c,d)||this;return it.type=tt||"value",it.axisIndex=nt,it}return a.prototype.isHorizontal=function(){return this.coordinateSystem.getModel().get("layout")!=="horizontal"},a}(Axis);function sliderMove(s,a,o,c,d,tt){s=s||0;var nt=o[1]-o[0];if(d!=null&&(d=restrict$1(d,[0,nt])),tt!=null&&(tt=Math.max(tt,d??0)),c==="all"){var it=Math.abs(a[1]-a[0]);it=restrict$1(it,[0,nt]),d=tt=restrict$1(it,[d,tt]),c=0}a[0]=restrict$1(a[0],o),a[1]=restrict$1(a[1],o);var st=getSpanSign(a,c);a[c]+=s;var ut=d||0,ct=o.slice();st.sign<0?ct[0]+=ut:ct[1]-=ut,a[c]=restrict$1(a[c],ct);var ot;return ot=getSpanSign(a,c),d!=null&&(ot.sign!==st.sign||ot.span<d)&&(a[1-c]=a[c]+st.sign*d),ot=getSpanSign(a,c),tt!=null&&ot.span>tt&&(a[1-c]=a[c]+ot.sign*tt),a}function getSpanSign(s,a){var o=s[a]-s[1-a];return{span:Math.abs(o),sign:o>0?-1:o<0?1:a?-1:1}}function restrict$1(s,a){return Math.min(a[1]!=null?a[1]:1/0,Math.max(a[0]!=null?a[0]:-1/0,s))}var each$a=each$f,mathMin$2=Math.min,mathMax$2=Math.max,mathFloor=Math.floor,mathCeil=Math.ceil,round=round$3,PI$1=Math.PI,Parallel=function(){function s(a,o,c){this.type="parallel",this._axesMap=createHashMap(),this._axesLayout={},this.dimensions=a.dimensions,this._model=a,this._init(a,o,c)}return s.prototype._init=function(a,o,c){var d=a.dimensions,tt=a.parallelAxisIndex;each$a(d,function(nt,it){var st=tt[it],ut=o.getComponent("parallelAxis",st),ct=this._axesMap.set(nt,new ParallelAxis(nt,createScaleByModel$1(ut),[0,0],ut.get("type"),st)),ot=ct.type==="category";ct.onBand=ot&&ut.get("boundaryGap"),ct.inverse=ut.get("inverse"),ut.axis=ct,ct.model=ut,ct.coordinateSystem=ut.coordinateSystem=this},this)},s.prototype.update=function(a,o){this._updateAxesFromSeries(this._model,a)},s.prototype.containPoint=function(a){var o=this._makeLayoutInfo(),c=o.axisBase,d=o.layoutBase,tt=o.pixelDimIndex,nt=a[1-tt],it=a[tt];return nt>=c&&nt<=c+o.axisLength&&it>=d&&it<=d+o.layoutLength},s.prototype.getModel=function(){return this._model},s.prototype._updateAxesFromSeries=function(a,o){o.eachSeries(function(c){if(a.contains(c,o)){var d=c.getData();each$a(this.dimensions,function(tt){var nt=this._axesMap.get(tt);nt.scale.unionExtentFromData(d,d.mapDimension(tt)),niceScaleExtent(nt.scale,nt.model)},this)}},this)},s.prototype.resize=function(a,o){this._rect=getLayoutRect(a.getBoxLayoutParams(),{width:o.getWidth(),height:o.getHeight()}),this._layoutAxes()},s.prototype.getRect=function(){return this._rect},s.prototype._makeLayoutInfo=function(){var a=this._model,o=this._rect,c=["x","y"],d=["width","height"],tt=a.get("layout"),nt=tt==="horizontal"?0:1,it=o[d[nt]],st=[0,it],ut=this.dimensions.length,ct=restrict(a.get("axisExpandWidth"),st),ot=restrict(a.get("axisExpandCount")||0,[0,ut]),at=a.get("axisExpandable")&&ut>3&&ut>ot&&ot>1&&ct>0&&it>0,ht=a.get("axisExpandWindow"),ft;if(ht)ft=restrict(ht[1]-ht[0],st),ht[1]=ht[0]+ft;else{ft=restrict(ct*(ot-1),st);var mt=a.get("axisExpandCenter")||mathFloor(ut/2);ht=[ct*mt-ft/2],ht[1]=ht[0]+ft}var yt=(it-ft)/(ut-ot);yt<3&&(yt=0);var bt=[mathFloor(round(ht[0]/ct,1))+1,mathCeil(round(ht[1]/ct,1))-1],wt=yt/ct*ht[0];return{layout:tt,pixelDimIndex:nt,layoutBase:o[c[nt]],layoutLength:it,axisBase:o[c[1-nt]],axisLength:o[d[1-nt]],axisExpandable:at,axisExpandWidth:ct,axisCollapseWidth:yt,axisExpandWindow:ht,axisCount:ut,winInnerIndices:bt,axisExpandWindow0Pos:wt}},s.prototype._layoutAxes=function(){var a=this._rect,o=this._axesMap,c=this.dimensions,d=this._makeLayoutInfo(),tt=d.layout;o.each(function(nt){var it=[0,d.axisLength],st=nt.inverse?1:0;nt.setExtent(it[st],it[1-st])}),each$a(c,function(nt,it){var st=(d.axisExpandable?layoutAxisWithExpand:layoutAxisWithoutExpand)(it,d),ut={horizontal:{x:st.position,y:d.axisLength},vertical:{x:0,y:st.position}},ct={horizontal:PI$1/2,vertical:0},ot=[ut[tt].x+a.x,ut[tt].y+a.y],at=ct[tt],ht=create$1();rotate$1(ht,ht,at),translate(ht,ht,ot),this._axesLayout[nt]={position:ot,rotation:at,transform:ht,axisNameAvailableWidth:st.axisNameAvailableWidth,axisLabelShow:st.axisLabelShow,nameTruncateMaxWidth:st.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},s.prototype.getAxis=function(a){return this._axesMap.get(a)},s.prototype.dataToPoint=function(a,o){return this.axisCoordToPoint(this._axesMap.get(o).dataToCoord(a),o)},s.prototype.eachActiveState=function(a,o,c,d){c==null&&(c=0),d==null&&(d=a.count());var tt=this._axesMap,nt=this.dimensions,it=[],st=[];each$f(nt,function(yt){it.push(a.mapDimension(yt)),st.push(tt.get(yt).model)});for(var ut=this.hasAxisBrushed(),ct=c;ct<d;ct++){var ot=void 0;if(!ut)ot="normal";else{ot="active";for(var at=a.getValues(it,ct),ht=0,ft=nt.length;ht<ft;ht++){var mt=st[ht].getActiveState(at[ht]);if(mt==="inactive"){ot="inactive";break}}}o(ot,ct)}},s.prototype.hasAxisBrushed=function(){for(var a=this.dimensions,o=this._axesMap,c=!1,d=0,tt=a.length;d<tt;d++)o.get(a[d]).model.getActiveState()!=="normal"&&(c=!0);return c},s.prototype.axisCoordToPoint=function(a,o){var c=this._axesLayout[o];return applyTransform([a,0],c.transform)},s.prototype.getAxisLayout=function(a){return clone$4(this._axesLayout[a])},s.prototype.getSlidedAxisExpandWindow=function(a){var o=this._makeLayoutInfo(),c=o.pixelDimIndex,d=o.axisExpandWindow.slice(),tt=d[1]-d[0],nt=[0,o.axisExpandWidth*(o.axisCount-1)];if(!this.containPoint(a))return{behavior:"none",axisExpandWindow:d};var it=a[c]-o.layoutBase-o.axisExpandWindow0Pos,st,ut="slide",ct=o.axisCollapseWidth,ot=this._model.get("axisExpandSlideTriggerArea"),at=ot[0]!=null;if(ct)at&&ct&&it<tt*ot[0]?(ut="jump",st=it-tt*ot[2]):at&&ct&&it>tt*(1-ot[0])?(ut="jump",st=it-tt*(1-ot[2])):(st=it-tt*ot[1])>=0&&(st=it-tt*(1-ot[1]))<=0&&(st=0),st*=o.axisExpandWidth/ct,st?sliderMove(st,d,nt,"all"):ut="none";else{var ht=d[1]-d[0],ft=nt[1]*it/ht;d=[mathMax$2(0,ft-ht/2)],d[1]=mathMin$2(nt[1],d[0]+ht),d[0]=d[1]-ht}return{axisExpandWindow:d,behavior:ut}},s}();function restrict(s,a){return mathMin$2(mathMax$2(s,a[0]),a[1])}function layoutAxisWithoutExpand(s,a){var o=a.layoutLength/(a.axisCount-1);return{position:o*s,axisNameAvailableWidth:o,axisLabelShow:!0}}function layoutAxisWithExpand(s,a){var o=a.layoutLength,c=a.axisExpandWidth,d=a.axisCount,tt=a.axisCollapseWidth,nt=a.winInnerIndices,it,st=tt,ut=!1,ct;return s<nt[0]?(it=s*tt,ct=tt):s<=nt[1]?(it=a.axisExpandWindow0Pos+s*c-a.axisExpandWindow[0],st=c,ut=!0):(it=o-(d-1-s)*tt,ct=tt),{position:it,axisNameAvailableWidth:st,axisLabelShow:ut,nameTruncateMaxWidth:ct}}function createParallelCoordSys(s,a){var o=[];return s.eachComponent("parallel",function(c,d){var tt=new Parallel(c,s,a);tt.name="parallel_"+d,tt.resize(c,a),c.coordinateSystem=tt,tt.model=c,o.push(tt)}),s.eachSeries(function(c){if(c.get("coordinateSystem")==="parallel"){var d=c.getReferringComponents("parallel",SINGLE_REFERRING).models[0];c.coordinateSystem=d.coordinateSystem}}),o}var parallelCoordSysCreator={create:createParallelCoordSys},ParallelAxisModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.activeIntervals=[],o}return a.prototype.getAreaSelectStyle=function(){return makeStyleMapper([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},a.prototype.setActiveIntervals=function(o){var c=this.activeIntervals=clone$4(o);if(c)for(var d=c.length-1;d>=0;d--)asc$2(c[d])},a.prototype.getActiveState=function(o){var c=this.activeIntervals;if(!c.length)return"normal";if(o==null||isNaN(+o))return"inactive";if(c.length===1){var d=c[0];if(d[0]<=o&&o<=d[1])return"active"}else for(var tt=0,nt=c.length;tt<nt;tt++)if(c[tt][0]<=o&&o<=c[tt][1])return"active";return"inactive"},a}(ComponentModel);mixin(ParallelAxisModel,AxisModelCommonMixin);var BRUSH_PANEL_GLOBAL=!0,mathMin$1=Math.min,mathMax$1=Math.max,mathPow=Math.pow,COVER_Z=1e4,UNSELECT_THRESHOLD=6,MIN_RESIZE_LINE_WIDTH=6,MUTEX_RESOURCE_KEY="globalPan",DIRECTION_MAP={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},CURSOR_MAP={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},DEFAULT_BRUSH_OPT={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},baseUID=0,BrushController=function(s){__extends$1(a,s);function a(o){var c=s.call(this)||this;return c._track=[],c._covers=[],c._handlers={},c._zr=o,c.group=new Group$3,c._uid="brushController_"+baseUID++,each$f(pointerHandlers,function(d,tt){this._handlers[tt]=bind$2(d,this)},c),c}return a.prototype.enableBrush=function(o){return this._brushType&&this._doDisableBrush(),o.brushType&&this._doEnableBrush(o),this},a.prototype._doEnableBrush=function(o){var c=this._zr;this._enableGlobalPan||take(c,MUTEX_RESOURCE_KEY,this._uid),each$f(this._handlers,function(d,tt){c.on(tt,d)}),this._brushType=o.brushType,this._brushOption=merge(clone$4(DEFAULT_BRUSH_OPT),o,!0)},a.prototype._doDisableBrush=function(){var o=this._zr;release(o,MUTEX_RESOURCE_KEY,this._uid),each$f(this._handlers,function(c,d){o.off(d,c)}),this._brushType=this._brushOption=null},a.prototype.setPanels=function(o){if(o&&o.length){var c=this._panels={};each$f(o,function(d){c[d.panelId]=clone$4(d)})}else this._panels=null;return this},a.prototype.mount=function(o){o=o||{},this._enableGlobalPan=o.enableGlobalPan;var c=this.group;return this._zr.add(c),c.attr({x:o.x||0,y:o.y||0,rotation:o.rotation||0,scaleX:o.scaleX||1,scaleY:o.scaleY||1}),this._transform=c.getLocalTransform(),this},a.prototype.updateCovers=function(o){o=map$1(o,function(at){return merge(clone$4(DEFAULT_BRUSH_OPT),at,!0)});var c="\0-brush-index-",d=this._covers,tt=this._covers=[],nt=this,it=this._creatingCover;return new DataDiffer(d,o,ut,st).add(ct).update(ct).remove(ot).execute(),this;function st(at,ht){return(at.id!=null?at.id:c+ht)+"-"+at.brushType}function ut(at,ht){return st(at.__brushOption,ht)}function ct(at,ht){var ft=o[at];if(ht!=null&&d[ht]===it)tt[at]=d[ht];else{var mt=tt[at]=ht!=null?(d[ht].__brushOption=ft,d[ht]):endCreating(nt,createCover(nt,ft));updateCoverAfterCreation(nt,mt)}}function ot(at){d[at]!==it&&nt.group.remove(d[at])}},a.prototype.unmount=function(){return this.enableBrush(!1),clearCovers(this),this._zr.remove(this.group),this},a.prototype.dispose=function(){this.unmount(),this.off()},a}(Eventful);function createCover(s,a){var o=coverRenderers[a.brushType].createCover(s,a);return o.__brushOption=a,updateZ$1(o,a),s.group.add(o),o}function endCreating(s,a){var o=getCoverRenderer(a);return o.endCreating&&(o.endCreating(s,a),updateZ$1(a,a.__brushOption)),a}function updateCoverShape(s,a){var o=a.__brushOption;getCoverRenderer(a).updateCoverShape(s,a,o.range,o)}function updateZ$1(s,a){var o=a.z;o==null&&(o=COVER_Z),s.traverse(function(c){c.z=o,c.z2=o})}function updateCoverAfterCreation(s,a){getCoverRenderer(a).updateCommon(s,a),updateCoverShape(s,a)}function getCoverRenderer(s){return coverRenderers[s.__brushOption.brushType]}function getPanelByPoint(s,a,o){var c=s._panels;if(!c)return BRUSH_PANEL_GLOBAL;var d,tt=s._transform;return each$f(c,function(nt){nt.isTargetByCursor(a,o,tt)&&(d=nt)}),d}function getPanelByCover(s,a){var o=s._panels;if(!o)return BRUSH_PANEL_GLOBAL;var c=a.__brushOption.panelId;return c!=null?o[c]:BRUSH_PANEL_GLOBAL}function clearCovers(s){var a=s._covers,o=a.length;return each$f(a,function(c){s.group.remove(c)},s),a.length=0,!!o}function trigger(s,a){var o=map$1(s._covers,function(c){var d=c.__brushOption,tt=clone$4(d.range);return{brushType:d.brushType,panelId:d.panelId,range:tt}});s.trigger("brush",{areas:o,isEnd:!!a.isEnd,removeOnClick:!!a.removeOnClick})}function shouldShowCover(s){var a=s._track;if(!a.length)return!1;var o=a[a.length-1],c=a[0],d=o[0]-c[0],tt=o[1]-c[1],nt=mathPow(d*d+tt*tt,.5);return nt>UNSELECT_THRESHOLD}function getTrackEnds(s){var a=s.length-1;return a<0&&(a=0),[s[0],s[a]]}function createBaseRectCover(s,a,o,c){var d=new Group$3;return d.add(new Rect$2({name:"main",style:makeStyle(o),silent:!0,draggable:!0,cursor:"move",drift:curry$1(driftRect,s,a,d,["n","s","w","e"]),ondragend:curry$1(trigger,a,{isEnd:!0})})),each$f(c,function(tt){d.add(new Rect$2({name:tt.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:curry$1(driftRect,s,a,d,tt),ondragend:curry$1(trigger,a,{isEnd:!0})}))}),d}function updateBaseRect(s,a,o,c){var d=c.brushStyle.lineWidth||0,tt=mathMax$1(d,MIN_RESIZE_LINE_WIDTH),nt=o[0][0],it=o[1][0],st=nt-d/2,ut=it-d/2,ct=o[0][1],ot=o[1][1],at=ct-tt+d/2,ht=ot-tt+d/2,ft=ct-nt,mt=ot-it,yt=ft+d,bt=mt+d;updateRectShape(s,a,"main",nt,it,ft,mt),c.transformable&&(updateRectShape(s,a,"w",st,ut,tt,bt),updateRectShape(s,a,"e",at,ut,tt,bt),updateRectShape(s,a,"n",st,ut,yt,tt),updateRectShape(s,a,"s",st,ht,yt,tt),updateRectShape(s,a,"nw",st,ut,tt,tt),updateRectShape(s,a,"ne",at,ut,tt,tt),updateRectShape(s,a,"sw",st,ht,tt,tt),updateRectShape(s,a,"se",at,ht,tt,tt))}function updateCommon$1(s,a){var o=a.__brushOption,c=o.transformable,d=a.childAt(0);d.useStyle(makeStyle(o)),d.attr({silent:!c,cursor:c?"move":"default"}),each$f([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(tt){var nt=a.childOfName(tt.join("")),it=tt.length===1?getGlobalDirection1(s,tt[0]):getGlobalDirection2(s,tt);nt&&nt.attr({silent:!c,invisible:!c,cursor:c?CURSOR_MAP[it]+"-resize":null})})}function updateRectShape(s,a,o,c,d,tt,nt){var it=a.childOfName(o);it&&it.setShape(pointsToRect(clipByPanel(s,a,[[c,d],[c+tt,d+nt]])))}function makeStyle(s){return defaults({strokeNoScale:!0},s.brushStyle)}function formatRectRange(s,a,o,c){var d=[mathMin$1(s,o),mathMin$1(a,c)],tt=[mathMax$1(s,o),mathMax$1(a,c)];return[[d[0],tt[0]],[d[1],tt[1]]]}function getTransform(s){return getTransform$1(s.group)}function getGlobalDirection1(s,a){var o={w:"left",e:"right",n:"top",s:"bottom"},c={left:"w",right:"e",top:"n",bottom:"s"},d=transformDirection(o[a],getTransform(s));return c[d]}function getGlobalDirection2(s,a){var o=[getGlobalDirection1(s,a[0]),getGlobalDirection1(s,a[1])];return(o[0]==="e"||o[0]==="w")&&o.reverse(),o.join("")}function driftRect(s,a,o,c,d,tt){var nt=o.__brushOption,it=s.toRectRange(nt.range),st=toLocalDelta(a,d,tt);each$f(c,function(ut){var ct=DIRECTION_MAP[ut];it[ct[0]][ct[1]]+=st[ct[0]]}),nt.range=s.fromRectRange(formatRectRange(it[0][0],it[1][0],it[0][1],it[1][1])),updateCoverAfterCreation(a,o),trigger(a,{isEnd:!1})}function driftPolygon(s,a,o,c){var d=a.__brushOption.range,tt=toLocalDelta(s,o,c);each$f(d,function(nt){nt[0]+=tt[0],nt[1]+=tt[1]}),updateCoverAfterCreation(s,a),trigger(s,{isEnd:!1})}function toLocalDelta(s,a,o){var c=s.group,d=c.transformCoordToLocal(a,o),tt=c.transformCoordToLocal(0,0);return[d[0]-tt[0],d[1]-tt[1]]}function clipByPanel(s,a,o){var c=getPanelByCover(s,a);return c&&c!==BRUSH_PANEL_GLOBAL?c.clipPath(o,s._transform):clone$4(o)}function pointsToRect(s){var a=mathMin$1(s[0][0],s[1][0]),o=mathMin$1(s[0][1],s[1][1]),c=mathMax$1(s[0][0],s[1][0]),d=mathMax$1(s[0][1],s[1][1]);return{x:a,y:o,width:c-a,height:d-o}}function resetCursor(s,a,o){if(!(!s._brushType||isOutsideZrArea(s,a.offsetX,a.offsetY))){var c=s._zr,d=s._covers,tt=getPanelByPoint(s,a,o);if(!s._dragging)for(var nt=0;nt<d.length;nt++){var it=d[nt].__brushOption;if(tt&&(tt===BRUSH_PANEL_GLOBAL||it.panelId===tt.panelId)&&coverRenderers[it.brushType].contain(d[nt],o[0],o[1]))return}tt&&c.setCursorStyle("crosshair")}}function preventDefault(s){var a=s.event;a.preventDefault&&a.preventDefault()}function mainShapeContain(s,a,o){return s.childOfName("main").contain(a,o)}function updateCoverByMouse(s,a,o,c){var d=s._creatingCover,tt=s._creatingPanel,nt=s._brushOption,it;if(s._track.push(o.slice()),shouldShowCover(s)||d){if(tt&&!d){nt.brushMode==="single"&&clearCovers(s);var st=clone$4(nt);st.brushType=determineBrushType(st.brushType,tt),st.panelId=tt===BRUSH_PANEL_GLOBAL?null:tt.panelId,d=s._creatingCover=createCover(s,st),s._covers.push(d)}if(d){var ut=coverRenderers[determineBrushType(s._brushType,tt)],ct=d.__brushOption;ct.range=ut.getCreatingRange(clipByPanel(s,d,s._track)),c&&(endCreating(s,d),ut.updateCommon(s,d)),updateCoverShape(s,d),it={isEnd:c}}}else c&&nt.brushMode==="single"&&nt.removeOnClick&&getPanelByPoint(s,a,o)&&clearCovers(s)&&(it={isEnd:c,removeOnClick:!0});return it}function determineBrushType(s,a){return s==="auto"?a.defaultBrushType:s}var pointerHandlers={mousedown:function(s){if(this._dragging)handleDragEnd(this,s);else if(!s.target||!s.target.draggable){preventDefault(s);var a=this.group.transformCoordToLocal(s.offsetX,s.offsetY);this._creatingCover=null;var o=this._creatingPanel=getPanelByPoint(this,s,a);o&&(this._dragging=!0,this._track=[a.slice()])}},mousemove:function(s){var a=s.offsetX,o=s.offsetY,c=this.group.transformCoordToLocal(a,o);if(resetCursor(this,s,c),this._dragging){preventDefault(s);var d=updateCoverByMouse(this,s,c,!1);d&&trigger(this,d)}},mouseup:function(s){handleDragEnd(this,s)}};function handleDragEnd(s,a){if(s._dragging){preventDefault(a);var o=a.offsetX,c=a.offsetY,d=s.group.transformCoordToLocal(o,c),tt=updateCoverByMouse(s,a,d,!0);s._dragging=!1,s._track=[],s._creatingCover=null,tt&&trigger(s,tt)}}function isOutsideZrArea(s,a,o){var c=s._zr;return a<0||a>c.getWidth()||o<0||o>c.getHeight()}var coverRenderers={lineX:getLineRenderer(0),lineY:getLineRenderer(1),rect:{createCover:function(s,a){function o(c){return c}return createBaseRectCover({toRectRange:o,fromRectRange:o},s,a,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(s){var a=getTrackEnds(s);return formatRectRange(a[1][0],a[1][1],a[0][0],a[0][1])},updateCoverShape:function(s,a,o,c){updateBaseRect(s,a,o,c)},updateCommon:updateCommon$1,contain:mainShapeContain},polygon:{createCover:function(s,a){var o=new Group$3;return o.add(new Polyline$1({name:"main",style:makeStyle(a),silent:!0})),o},getCreatingRange:function(s){return s},endCreating:function(s,a){a.remove(a.childAt(0)),a.add(new Polygon({name:"main",draggable:!0,drift:curry$1(driftPolygon,s,a),ondragend:curry$1(trigger,s,{isEnd:!0})}))},updateCoverShape:function(s,a,o,c){a.childAt(0).setShape({points:clipByPanel(s,a,o)})},updateCommon:updateCommon$1,contain:mainShapeContain}};function getLineRenderer(s){return{createCover:function(a,o){return createBaseRectCover({toRectRange:function(c){var d=[c,[0,100]];return s&&d.reverse(),d},fromRectRange:function(c){return c[s]}},a,o,[[["w"],["e"]],[["n"],["s"]]][s])},getCreatingRange:function(a){var o=getTrackEnds(a),c=mathMin$1(o[0][s],o[1][s]),d=mathMax$1(o[0][s],o[1][s]);return[c,d]},updateCoverShape:function(a,o,c,d){var tt,nt=getPanelByCover(a,o);if(nt!==BRUSH_PANEL_GLOBAL&&nt.getLinearBrushOtherExtent)tt=nt.getLinearBrushOtherExtent(s);else{var it=a._zr;tt=[0,[it.getWidth(),it.getHeight()][1-s]]}var st=[c,tt];s&&st.reverse(),updateBaseRect(a,o,st,d)},updateCommon:updateCommon$1,contain:mainShapeContain}}function makeRectPanelClipPath(s){return s=normalizeRect(s),function(a){return clipPointsByRect(a,s)}}function makeLinearBrushOtherExtent(s,a){return s=normalizeRect(s),function(o){var c=a??o,d=c?s.width:s.height,tt=c?s.x:s.y;return[tt,tt+(d||0)]}}function makeRectIsTargetByCursor(s,a,o){var c=normalizeRect(s);return function(d,tt){return c.contain(tt[0],tt[1])&&!onIrrelevantElement(d,a,o)}}function normalizeRect(s){return BoundingRect.create(s)}var elementList$1=["axisLine","axisTickLabel","axisName"],ParallelAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c){s.prototype.init.apply(this,arguments),(this._brushController=new BrushController(c.getZr())).on("brush",bind$2(this._onBrush,this))},a.prototype.render=function(o,c,d,tt){if(!fromAxisAreaSelect(o,c,tt)){this.axisModel=o,this.api=d,this.group.removeAll();var nt=this._axisGroup;if(this._axisGroup=new Group$3,this.group.add(this._axisGroup),!!o.get("show")){var it=getCoordSysModel(o,c),st=it.coordinateSystem,ut=o.getAreaSelectStyle(),ct=ut.width,ot=o.axis.dim,at=st.getAxisLayout(ot),ht=extend({strokeContainThreshold:ct},at),ft=new AxisBuilder(o,ht);each$f(elementList$1,ft.add,ft),this._axisGroup.add(ft.getGroup()),this._refreshBrushController(ht,ut,o,it,ct,d),groupTransition(nt,this._axisGroup,o)}}},a.prototype._refreshBrushController=function(o,c,d,tt,nt,it){var st=d.axis.getExtent(),ut=st[1]-st[0],ct=Math.min(30,Math.abs(ut)*.1),ot=BoundingRect.create({x:st[0],y:-nt/2,width:ut,height:nt});ot.x-=ct,ot.width+=2*ct,this._brushController.mount({enableGlobalPan:!0,rotation:o.rotation,x:o.position[0],y:o.position[1]}).setPanels([{panelId:"pl",clipPath:makeRectPanelClipPath(ot),isTargetByCursor:makeRectIsTargetByCursor(ot,it,tt),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(ot,0)}]).enableBrush({brushType:"lineX",brushStyle:c,removeOnClick:!0}).updateCovers(getCoverInfoList(d))},a.prototype._onBrush=function(o){var c=o.areas,d=this.axisModel,tt=d.axis,nt=map$1(c,function(it){return[tt.coordToData(it.range[0],!0),tt.coordToData(it.range[1],!0)]});(!d.option.realtime===o.isEnd||o.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:d.id,intervals:nt})},a.prototype.dispose=function(){this._brushController.dispose()},a.type="parallelAxis",a}(ComponentView);function fromAxisAreaSelect(s,a,o){return o&&o.type==="axisAreaSelect"&&a.findComponents({mainType:"parallelAxis",query:o})[0]===s}function getCoverInfoList(s){var a=s.axis;return map$1(s.activeIntervals,function(o){return{brushType:"lineX",panelId:"pl",range:[a.dataToCoord(o[0],!0),a.dataToCoord(o[1],!0)]}})}function getCoordSysModel(s,a){return a.getComponent("parallel",s.get("parallelIndex"))}var actionInfo={type:"axisAreaSelect",event:"axisAreaSelected"};function installParallelActions(s){s.registerAction(actionInfo,function(a,o){o.eachComponent({mainType:"parallelAxis",query:a},function(c){c.axis.model.setActiveIntervals(a.intervals)})}),s.registerAction("parallelAxisExpand",function(a,o){o.eachComponent({mainType:"parallel",query:a},function(c){c.setAxisExpand(a)})})}var defaultAxisOption={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function install$C(s){s.registerComponentView(ParallelView),s.registerComponentModel(ParallelModel),s.registerCoordinateSystem("parallel",parallelCoordSysCreator),s.registerPreprocessor(parallelPreprocessor),s.registerComponentModel(ParallelAxisModel),s.registerComponentView(ParallelAxisView),axisModelCreator(s,"parallel",ParallelAxisModel,defaultAxisOption),installParallelActions(s)}function install$B(s){use(install$C),s.registerChartView(ParallelView$1),s.registerSeriesModel(ParallelSeriesModel),s.registerVisual(s.PRIORITY.VISUAL.BRUSH,parallelVisual)}var SankeyPathShape=function(){function s(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return s}(),SankeyPath=function(s){__extends$1(a,s);function a(o){return s.call(this,o)||this}return a.prototype.getDefaultShape=function(){return new SankeyPathShape},a.prototype.buildPath=function(o,c){var d=c.extent;o.moveTo(c.x1,c.y1),o.bezierCurveTo(c.cpx1,c.cpy1,c.cpx2,c.cpy2,c.x2,c.y2),c.orient==="vertical"?(o.lineTo(c.x2+d,c.y2),o.bezierCurveTo(c.cpx2+d,c.cpy2,c.cpx1+d,c.cpy1,c.x1+d,c.y1)):(o.lineTo(c.x2,c.y2+d),o.bezierCurveTo(c.cpx2,c.cpy2+d,c.cpx1,c.cpy1+d,c.x1,c.y1+d)),o.closePath()},a.prototype.highlight=function(){enterEmphasis(this)},a.prototype.downplay=function(){leaveEmphasis(this)},a}(Path),SankeyView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._focusAdjacencyDisabled=!1,o}return a.prototype.render=function(o,c,d){var tt=this,nt=o.getGraph(),it=this.group,st=o.layoutInfo,ut=st.width,ct=st.height,ot=o.getData(),at=o.getData("edge"),ht=o.get("orient");this._model=o,it.removeAll(),it.x=st.x,it.y=st.y,nt.eachEdge(function(ft){var mt=new SankeyPath,yt=getECData(mt);yt.dataIndex=ft.dataIndex,yt.seriesIndex=o.seriesIndex,yt.dataType="edge";var bt=ft.getModel(),wt=bt.getModel("lineStyle"),Tt=wt.get("curveness"),Ct=ft.node1.getLayout(),Dt=ft.node1.getModel(),Ot=Dt.get("localX"),$t=Dt.get("localY"),Ft=ft.node2.getLayout(),kt=ft.node2.getModel(),Vt=kt.get("localX"),Ht=kt.get("localY"),Qt=ft.getLayout(),Xt,Zt,ar,nr,cr,dr,mr,Dr;mt.shape.extent=Math.max(1,Qt.dy),mt.shape.orient=ht,ht==="vertical"?(Xt=(Ot!=null?Ot*ut:Ct.x)+Qt.sy,Zt=($t!=null?$t*ct:Ct.y)+Ct.dy,ar=(Vt!=null?Vt*ut:Ft.x)+Qt.ty,nr=Ht!=null?Ht*ct:Ft.y,cr=Xt,dr=Zt*(1-Tt)+nr*Tt,mr=ar,Dr=Zt*Tt+nr*(1-Tt)):(Xt=(Ot!=null?Ot*ut:Ct.x)+Ct.dx,Zt=($t!=null?$t*ct:Ct.y)+Qt.sy,ar=Vt!=null?Vt*ut:Ft.x,nr=(Ht!=null?Ht*ct:Ft.y)+Qt.ty,cr=Xt*(1-Tt)+ar*Tt,dr=Zt,mr=Xt*Tt+ar*(1-Tt),Dr=nr),mt.setShape({x1:Xt,y1:Zt,x2:ar,y2:nr,cpx1:cr,cpy1:dr,cpx2:mr,cpy2:Dr}),mt.useStyle(wt.getItemStyle()),applyCurveStyle(mt.style,ht,ft);var kr=""+bt.get("value"),Yr=getLabelStatesModels(bt,"edgeLabel");setLabelStyle(mt,Yr,{labelFetcher:{getFormattedLabel:function(an,xn,Rn,hn,pn,yn){return o.getFormattedLabel(an,xn,"edge",hn,retrieve3(pn,Yr.normal&&Yr.normal.get("formatter"),kr),yn)}},labelDataIndex:ft.dataIndex,defaultText:kr}),mt.setTextConfig({position:"inside"});var Mr=bt.getModel("emphasis");setStatesStylesFromModel(mt,bt,"lineStyle",function(an){var xn=an.getItemStyle();return applyCurveStyle(xn,ht,ft),xn}),it.add(mt),at.setItemGraphicEl(ft.dataIndex,mt);var Jr=Mr.get("focus");toggleHoverEmphasis(mt,Jr==="adjacency"?ft.getAdjacentDataIndices():Jr==="trajectory"?ft.getTrajectoryDataIndices():Jr,Mr.get("blurScope"),Mr.get("disabled"))}),nt.eachNode(function(ft){var mt=ft.getLayout(),yt=ft.getModel(),bt=yt.get("localX"),wt=yt.get("localY"),Tt=yt.getModel("emphasis"),Ct=yt.get(["itemStyle","borderRadius"])||0,Dt=new Rect$2({shape:{x:bt!=null?bt*ut:mt.x,y:wt!=null?wt*ct:mt.y,width:mt.dx,height:mt.dy,r:Ct},style:yt.getModel("itemStyle").getItemStyle(),z2:10});setLabelStyle(Dt,getLabelStatesModels(yt),{labelFetcher:{getFormattedLabel:function($t,Ft){return o.getFormattedLabel($t,Ft,"node")}},labelDataIndex:ft.dataIndex,defaultText:ft.id}),Dt.disableLabelAnimation=!0,Dt.setStyle("fill",ft.getVisual("color")),Dt.setStyle("decal",ft.getVisual("style").decal),setStatesStylesFromModel(Dt,yt),it.add(Dt),ot.setItemGraphicEl(ft.dataIndex,Dt),getECData(Dt).dataType="node";var Ot=Tt.get("focus");toggleHoverEmphasis(Dt,Ot==="adjacency"?ft.getAdjacentDataIndices():Ot==="trajectory"?ft.getTrajectoryDataIndices():Ot,Tt.get("blurScope"),Tt.get("disabled"))}),ot.eachItemGraphicEl(function(ft,mt){var yt=ot.getItemModel(mt);yt.get("draggable")&&(ft.drift=function(bt,wt){tt._focusAdjacencyDisabled=!0,this.shape.x+=bt,this.shape.y+=wt,this.dirty(),d.dispatchAction({type:"dragNode",seriesId:o.id,dataIndex:ot.getRawIndex(mt),localX:this.shape.x/ut,localY:this.shape.y/ct})},ft.ondragend=function(){tt._focusAdjacencyDisabled=!1},ft.draggable=!0,ft.cursor="move")}),!this._data&&o.isAnimationEnabled()&&it.setClipPath(createGridClipShape$1(it.getBoundingRect(),o,function(){it.removeClipPath()})),this._data=o.getData()},a.prototype.dispose=function(){},a.type="sankey",a}(ChartView);function applyCurveStyle(s,a,o){switch(s.fill){case"source":s.fill=o.node1.getVisual("color"),s.decal=o.node1.getVisual("style").decal;break;case"target":s.fill=o.node2.getVisual("color"),s.decal=o.node2.getVisual("style").decal;break;case"gradient":var c=o.node1.getVisual("color"),d=o.node2.getVisual("color");isString$1(c)&&isString$1(d)&&(s.fill=new LinearGradient(0,0,+(a==="horizontal"),+(a==="vertical"),[{color:c,offset:0},{color:d,offset:1}]))}}function createGridClipShape$1(s,a,o){var c=new Rect$2({shape:{x:s.x-10,y:s.y-10,width:0,height:s.height+20}});return initProps(c,{shape:{width:s.width+20}},a,o),c}var SankeySeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.getInitialData=function(o,c){var d=o.edges||o.links||[],tt=o.data||o.nodes||[],nt=o.levels||[];this.levelModels=[];for(var it=this.levelModels,st=0;st<nt.length;st++)nt[st].depth!=null&&nt[st].depth>=0&&(it[nt[st].depth]=new Model(nt[st],this,c));var ut=createGraphFromNodeEdge(tt,d,this,!0,ct);return ut.data;function ct(ot,at){ot.wrapMethod("getItemModel",function(ht,ft){var mt=ht.parentModel,yt=mt.getData().getItemLayout(ft);if(yt){var bt=yt.depth,wt=mt.levelModels[bt];wt&&(ht.parentModel=wt)}return ht}),at.wrapMethod("getItemModel",function(ht,ft){var mt=ht.parentModel,yt=mt.getGraph().getEdgeByIndex(ft),bt=yt.node1.getLayout();if(bt){var wt=bt.depth,Tt=mt.levelModels[wt];Tt&&(ht.parentModel=Tt)}return ht})}},a.prototype.setNodePosition=function(o,c){var d=this.option.data||this.option.nodes,tt=d[o];tt.localX=c[0],tt.localY=c[1]},a.prototype.getGraph=function(){return this.getData().graph},a.prototype.getEdgeData=function(){return this.getGraph().edgeData},a.prototype.formatTooltip=function(o,c,d){function tt(ht){return isNaN(ht)||ht==null}if(d==="edge"){var nt=this.getDataParams(o,d),it=nt.data,st=nt.value,ut=it.source+" -- "+it.target;return createTooltipMarkup("nameValue",{name:ut,value:st,noValue:tt(st)})}else{var ct=this.getGraph().getNodeByIndex(o),ot=ct.getLayout().value,at=this.getDataParams(o,d).data.name;return createTooltipMarkup("nameValue",{name:at!=null?at+"":null,value:ot,noValue:tt(ot)})}},a.prototype.optionUpdated=function(){},a.prototype.getDataParams=function(o,c){var d=s.prototype.getDataParams.call(this,o,c);if(d.value==null&&c==="node"){var tt=this.getGraph().getNodeByIndex(o),nt=tt.getLayout().value;d.value=nt}return d},a.type="series.sankey",a.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},a}(SeriesModel);function sankeyLayout(s,a){s.eachSeriesByType("sankey",function(o){var c=o.get("nodeWidth"),d=o.get("nodeGap"),tt=getViewRect$1(o,a);o.layoutInfo=tt;var nt=tt.width,it=tt.height,st=o.getGraph(),ut=st.nodes,ct=st.edges;computeNodeValues(ut);var ot=filter(ut,function(mt){return mt.getLayout().value===0}),at=ot.length!==0?0:o.get("layoutIterations"),ht=o.get("orient"),ft=o.get("nodeAlign");layoutSankey(ut,ct,c,d,nt,it,at,ht,ft)})}function getViewRect$1(s,a){return getLayoutRect(s.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})}function layoutSankey(s,a,o,c,d,tt,nt,it,st){computeNodeBreadths(s,a,o,d,tt,it,st),computeNodeDepths(s,a,tt,d,c,nt,it),computeEdgeDepths(s,it)}function computeNodeValues(s){each$f(s,function(a){var o=sum(a.outEdges,getEdgeValue),c=sum(a.inEdges,getEdgeValue),d=a.getValue()||0,tt=Math.max(o,c,d);a.setLayout({value:tt},!0)})}function computeNodeBreadths(s,a,o,c,d,tt,nt){for(var it=[],st=[],ut=[],ct=[],ot=0,at=0;at<a.length;at++)it[at]=1;for(var at=0;at<s.length;at++)st[at]=s[at].inEdges.length,st[at]===0&&ut.push(s[at]);for(var ht=-1;ut.length;){for(var ft=0;ft<ut.length;ft++){var mt=ut[ft],yt=mt.hostGraph.data.getRawDataItem(mt.dataIndex),bt=yt.depth!=null&&yt.depth>=0;bt&&yt.depth>ht&&(ht=yt.depth),mt.setLayout({depth:bt?yt.depth:ot},!0),tt==="vertical"?mt.setLayout({dy:o},!0):mt.setLayout({dx:o},!0);for(var wt=0;wt<mt.outEdges.length;wt++){var Tt=mt.outEdges[wt],Ct=a.indexOf(Tt);it[Ct]=0;var Dt=Tt.node2,Ot=s.indexOf(Dt);--st[Ot]===0&&ct.indexOf(Dt)<0&&ct.push(Dt)}}++ot,ut=ct,ct=[]}for(var at=0;at<it.length;at++)if(it[at]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var $t=ht>ot-1?ht:ot-1;nt&&nt!=="left"&&adjustNodeWithNodeAlign(s,nt,tt,$t);var Ft=tt==="vertical"?(d-o)/$t:(c-o)/$t;scaleNodeBreadths(s,Ft,tt)}function isNodeDepth(s){var a=s.hostGraph.data.getRawDataItem(s.dataIndex);return a.depth!=null&&a.depth>=0}function adjustNodeWithNodeAlign(s,a,o,c){if(a==="right"){for(var d=[],tt=s,nt=0;tt.length;){for(var it=0;it<tt.length;it++){var st=tt[it];st.setLayout({skNodeHeight:nt},!0);for(var ut=0;ut<st.inEdges.length;ut++){var ct=st.inEdges[ut];d.indexOf(ct.node1)<0&&d.push(ct.node1)}}tt=d,d=[],++nt}each$f(s,function(ot){isNodeDepth(ot)||ot.setLayout({depth:Math.max(0,c-ot.getLayout().skNodeHeight)},!0)})}else a==="justify"&&moveSinksRight(s,c)}function moveSinksRight(s,a){each$f(s,function(o){!isNodeDepth(o)&&!o.outEdges.length&&o.setLayout({depth:a},!0)})}function scaleNodeBreadths(s,a,o){each$f(s,function(c){var d=c.getLayout().depth*a;o==="vertical"?c.setLayout({y:d},!0):c.setLayout({x:d},!0)})}function computeNodeDepths(s,a,o,c,d,tt,nt){var it=prepareNodesByBreadth(s,nt);initializeNodeDepth(it,a,o,c,d,nt),resolveCollisions(it,d,o,c,nt);for(var st=1;tt>0;tt--)st*=.99,relaxRightToLeft(it,st,nt),resolveCollisions(it,d,o,c,nt),relaxLeftToRight(it,st,nt),resolveCollisions(it,d,o,c,nt)}function prepareNodesByBreadth(s,a){var o=[],c=a==="vertical"?"y":"x",d=groupData(s,function(tt){return tt.getLayout()[c]});return d.keys.sort(function(tt,nt){return tt-nt}),each$f(d.keys,function(tt){o.push(d.buckets.get(tt))}),o}function initializeNodeDepth(s,a,o,c,d,tt){var nt=1/0;each$f(s,function(it){var st=it.length,ut=0;each$f(it,function(ot){ut+=ot.getLayout().value});var ct=tt==="vertical"?(c-(st-1)*d)/ut:(o-(st-1)*d)/ut;ct<nt&&(nt=ct)}),each$f(s,function(it){each$f(it,function(st,ut){var ct=st.getLayout().value*nt;tt==="vertical"?(st.setLayout({x:ut},!0),st.setLayout({dx:ct},!0)):(st.setLayout({y:ut},!0),st.setLayout({dy:ct},!0))})}),each$f(a,function(it){var st=+it.getValue()*nt;it.setLayout({dy:st},!0)})}function resolveCollisions(s,a,o,c,d){var tt=d==="vertical"?"x":"y";each$f(s,function(nt){nt.sort(function(mt,yt){return mt.getLayout()[tt]-yt.getLayout()[tt]});for(var it,st,ut,ct=0,ot=nt.length,at=d==="vertical"?"dx":"dy",ht=0;ht<ot;ht++)st=nt[ht],ut=ct-st.getLayout()[tt],ut>0&&(it=st.getLayout()[tt]+ut,d==="vertical"?st.setLayout({x:it},!0):st.setLayout({y:it},!0)),ct=st.getLayout()[tt]+st.getLayout()[at]+a;var ft=d==="vertical"?c:o;if(ut=ct-a-ft,ut>0){it=st.getLayout()[tt]-ut,d==="vertical"?st.setLayout({x:it},!0):st.setLayout({y:it},!0),ct=it;for(var ht=ot-2;ht>=0;--ht)st=nt[ht],ut=st.getLayout()[tt]+st.getLayout()[at]+a-ct,ut>0&&(it=st.getLayout()[tt]-ut,d==="vertical"?st.setLayout({x:it},!0):st.setLayout({y:it},!0)),ct=st.getLayout()[tt]}})}function relaxRightToLeft(s,a,o){each$f(s.slice().reverse(),function(c){each$f(c,function(d){if(d.outEdges.length){var tt=sum(d.outEdges,weightedTarget,o)/sum(d.outEdges,getEdgeValue);if(isNaN(tt)){var nt=d.outEdges.length;tt=nt?sum(d.outEdges,centerTarget,o)/nt:0}if(o==="vertical"){var it=d.getLayout().x+(tt-center(d,o))*a;d.setLayout({x:it},!0)}else{var st=d.getLayout().y+(tt-center(d,o))*a;d.setLayout({y:st},!0)}}})})}function weightedTarget(s,a){return center(s.node2,a)*s.getValue()}function centerTarget(s,a){return center(s.node2,a)}function weightedSource(s,a){return center(s.node1,a)*s.getValue()}function centerSource(s,a){return center(s.node1,a)}function center(s,a){return a==="vertical"?s.getLayout().x+s.getLayout().dx/2:s.getLayout().y+s.getLayout().dy/2}function getEdgeValue(s){return s.getValue()}function sum(s,a,o){for(var c=0,d=s.length,tt=-1;++tt<d;){var nt=+a(s[tt],o);isNaN(nt)||(c+=nt)}return c}function relaxLeftToRight(s,a,o){each$f(s,function(c){each$f(c,function(d){if(d.inEdges.length){var tt=sum(d.inEdges,weightedSource,o)/sum(d.inEdges,getEdgeValue);if(isNaN(tt)){var nt=d.inEdges.length;tt=nt?sum(d.inEdges,centerSource,o)/nt:0}if(o==="vertical"){var it=d.getLayout().x+(tt-center(d,o))*a;d.setLayout({x:it},!0)}else{var st=d.getLayout().y+(tt-center(d,o))*a;d.setLayout({y:st},!0)}}})})}function computeEdgeDepths(s,a){var o=a==="vertical"?"x":"y";each$f(s,function(c){c.outEdges.sort(function(d,tt){return d.node2.getLayout()[o]-tt.node2.getLayout()[o]}),c.inEdges.sort(function(d,tt){return d.node1.getLayout()[o]-tt.node1.getLayout()[o]})}),each$f(s,function(c){var d=0,tt=0;each$f(c.outEdges,function(nt){nt.setLayout({sy:d},!0),d+=nt.getLayout().dy}),each$f(c.inEdges,function(nt){nt.setLayout({ty:tt},!0),tt+=nt.getLayout().dy})})}function sankeyVisual(s){s.eachSeriesByType("sankey",function(a){var o=a.getGraph(),c=o.nodes,d=o.edges;if(c.length){var tt=1/0,nt=-1/0;each$f(c,function(it){var st=it.getLayout().value;st<tt&&(tt=st),st>nt&&(nt=st)}),each$f(c,function(it){var st=new VisualMapping({type:"color",mappingMethod:"linear",dataExtent:[tt,nt],visual:a.get("color")}),ut=st.mapValueToVisual(it.getLayout().value),ct=it.getModel().get(["itemStyle","color"]);ct!=null?(it.setVisual("color",ct),it.setVisual("style",{fill:ct})):(it.setVisual("color",ut),it.setVisual("style",{fill:ut}))})}d.length&&each$f(d,function(it){var st=it.getModel().get("lineStyle");it.setVisual("style",st)})})}function install$A(s){s.registerChartView(SankeyView),s.registerSeriesModel(SankeySeriesModel),s.registerLayout(sankeyLayout),s.registerVisual(sankeyVisual),s.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(a,o){o.eachComponent({mainType:"series",subType:"sankey",query:a},function(c){c.setNodePosition(a.dataIndex,[a.localX,a.localY])})})}var WhiskerBoxCommonMixin=function(){function s(){}return s.prototype._hasEncodeRule=function(a){var o=this.getEncode();return o&&o.get(a)!=null},s.prototype.getInitialData=function(a,o){var c,d=o.getComponent("xAxis",this.get("xAxisIndex")),tt=o.getComponent("yAxis",this.get("yAxisIndex")),nt=d.get("type"),it=tt.get("type"),st;nt==="category"?(a.layout="horizontal",c=d.getOrdinalMeta(),st=!this._hasEncodeRule("x")):it==="category"?(a.layout="vertical",c=tt.getOrdinalMeta(),st=!this._hasEncodeRule("y")):a.layout=a.layout||"horizontal";var ut=["x","y"],ct=a.layout==="horizontal"?0:1,ot=this._baseAxisDim=ut[ct],at=ut[1-ct],ht=[d,tt],ft=ht[ct].get("type"),mt=ht[1-ct].get("type"),yt=a.data;if(yt&&st){var bt=[];each$f(yt,function(Ct,Dt){var Ot;isArray$1(Ct)?(Ot=Ct.slice(),Ct.unshift(Dt)):isArray$1(Ct.value)?(Ot=extend({},Ct),Ot.value=Ot.value.slice(),Ct.value.unshift(Dt)):Ot=Ct,bt.push(Ot)}),a.data=bt}var wt=this.defaultValueDimensions,Tt=[{name:ot,type:getDimensionTypeByAxis(ft),ordinalMeta:c,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:at,type:getDimensionTypeByAxis(mt),dimsDef:wt.slice()}];return createSeriesDataSimply(this,{coordDimensions:Tt,dimensionsCount:wt.length+1,encodeDefaulter:curry$1(makeSeriesEncodeForAxisCoordSys,Tt,this)})},s.prototype.getBaseAxis=function(){var a=this._baseAxisDim;return this.ecModel.getComponent(a+"Axis",this.get(a+"AxisIndex")).axis},s}(),BoxplotSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],o.visualDrawType="stroke",o}return a.type="series.boxplot",a.dependencies=["xAxis","yAxis","grid"],a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},a}(SeriesModel);mixin(BoxplotSeriesModel,WhiskerBoxCommonMixin,!0);var BoxplotView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this.group,it=this._data;this._data||nt.removeAll();var st=o.get("layout")==="horizontal"?1:0;tt.diff(it).add(function(ut){if(tt.hasValue(ut)){var ct=tt.getItemLayout(ut),ot=createNormalBox$1(ct,tt,ut,st,!0);tt.setItemGraphicEl(ut,ot),nt.add(ot)}}).update(function(ut,ct){var ot=it.getItemGraphicEl(ct);if(!tt.hasValue(ut)){nt.remove(ot);return}var at=tt.getItemLayout(ut);ot?(saveOldStyle(ot),updateNormalBoxData(at,ot,tt,ut)):ot=createNormalBox$1(at,tt,ut,st),nt.add(ot),tt.setItemGraphicEl(ut,ot)}).remove(function(ut){var ct=it.getItemGraphicEl(ut);ct&&nt.remove(ct)}).execute(),this._data=tt},a.prototype.remove=function(o){var c=this.group,d=this._data;this._data=null,d&&d.eachItemGraphicEl(function(tt){tt&&c.remove(tt)})},a.type="boxplot",a}(ChartView),BoxPathShape=function(){function s(){}return s}(),BoxPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="boxplotBoxPath",c}return a.prototype.getDefaultShape=function(){return new BoxPathShape},a.prototype.buildPath=function(o,c){var d=c.points,tt=0;for(o.moveTo(d[tt][0],d[tt][1]),tt++;tt<4;tt++)o.lineTo(d[tt][0],d[tt][1]);for(o.closePath();tt<d.length;tt++)o.moveTo(d[tt][0],d[tt][1]),tt++,o.lineTo(d[tt][0],d[tt][1])},a}(Path);function createNormalBox$1(s,a,o,c,d){var tt=s.ends,nt=new BoxPath({shape:{points:d?transInit$1(tt,c,s):tt}});return updateNormalBoxData(s,nt,a,o,d),nt}function updateNormalBoxData(s,a,o,c,d){var tt=o.hostModel,nt=graphic$1[d?"initProps":"updateProps"];nt(a,{shape:{points:s.ends}},tt,c),a.useStyle(o.getItemVisual(c,"style")),a.style.strokeNoScale=!0,a.z2=100;var it=o.getItemModel(c),st=it.getModel("emphasis");setStatesStylesFromModel(a,it),toggleHoverEmphasis(a,st.get("focus"),st.get("blurScope"),st.get("disabled"))}function transInit$1(s,a,o){return map$1(s,function(c){return c=c.slice(),c[a]=o.initBaseline,c})}var each$9=each$f;function boxplotLayout(s){var a=groupSeriesByAxis(s);each$9(a,function(o){var c=o.seriesModels;c.length&&(calculateBase(o),each$9(c,function(d,tt){layoutSingleSeries(d,o.boxOffsetList[tt],o.boxWidthList[tt])}))})}function groupSeriesByAxis(s){var a=[],o=[];return s.eachSeriesByType("boxplot",function(c){var d=c.getBaseAxis(),tt=indexOf(o,d);tt<0&&(tt=o.length,o[tt]=d,a[tt]={axis:d,seriesModels:[]}),a[tt].seriesModels.push(c)}),a}function calculateBase(s){var a=s.axis,o=s.seriesModels,c=o.length,d=s.boxWidthList=[],tt=s.boxOffsetList=[],nt=[],it;if(a.type==="category")it=a.getBandWidth();else{var st=0;each$9(o,function(ft){st=Math.max(st,ft.getData().count())});var ut=a.getExtent();it=Math.abs(ut[1]-ut[0])/st}each$9(o,function(ft){var mt=ft.get("boxWidth");isArray$1(mt)||(mt=[mt,mt]),nt.push([parsePercent(mt[0],it)||0,parsePercent(mt[1],it)||0])});var ct=it*.8-2,ot=ct/c*.3,at=(ct-ot*(c-1))/c,ht=at/2-ct/2;each$9(o,function(ft,mt){tt.push(ht),ht+=ot+at,d.push(Math.min(Math.max(at,nt[mt][0]),nt[mt][1]))})}function layoutSingleSeries(s,a,o){var c=s.coordinateSystem,d=s.getData(),tt=o/2,nt=s.get("layout")==="horizontal"?0:1,it=1-nt,st=["x","y"],ut=d.mapDimension(st[nt]),ct=d.mapDimensionsAll(st[it]);if(ut==null||ct.length<5)return;for(var ot=0;ot<d.count();ot++){var at=d.get(ut,ot),ht=Tt(at,ct[2],ot),ft=Tt(at,ct[0],ot),mt=Tt(at,ct[1],ot),yt=Tt(at,ct[3],ot),bt=Tt(at,ct[4],ot),wt=[];Ct(wt,mt,!1),Ct(wt,yt,!0),wt.push(ft,mt,bt,yt),Dt(wt,ft),Dt(wt,bt),Dt(wt,ht),d.setItemLayout(ot,{initBaseline:ht[it],ends:wt})}function Tt(Ot,$t,Ft){var kt=d.get($t,Ft),Vt=[];Vt[nt]=Ot,Vt[it]=kt;var Ht;return isNaN(Ot)||isNaN(kt)?Ht=[NaN,NaN]:(Ht=c.dataToPoint(Vt),Ht[nt]+=a),Ht}function Ct(Ot,$t,Ft){var kt=$t.slice(),Vt=$t.slice();kt[nt]+=tt,Vt[nt]-=tt,Ft?Ot.push(kt,Vt):Ot.push(Vt,kt)}function Dt(Ot,$t){var Ft=$t.slice(),kt=$t.slice();Ft[nt]-=tt,kt[nt]+=tt,Ot.push(Ft,kt)}}function prepareBoxplotData(s,a){a=a||{};for(var o=[],c=[],d=a.boundIQR,tt=d==="none"||d===0,nt=0;nt<s.length;nt++){var it=asc$2(s[nt].slice()),st=quantile(it,.25),ut=quantile(it,.5),ct=quantile(it,.75),ot=it[0],at=it[it.length-1],ht=(d??1.5)*(ct-st),ft=tt?ot:Math.max(ot,st-ht),mt=tt?at:Math.min(at,ct+ht),yt=a.itemNameFormatter,bt=isFunction$1(yt)?yt({value:nt}):isString$1(yt)?yt.replace("{value}",nt+""):nt+"";o.push([bt,ft,st,ut,ct,mt]);for(var wt=0;wt<it.length;wt++){var Tt=it[wt];if(Tt<ft||Tt>mt){var Ct=[bt,Tt];c.push(Ct)}}}return{boxData:o,outliers:c}}var boxplotTransform={type:"echarts:boxplot",transform:function s(a){var o=a.upstream;if(o.sourceFormat!==SOURCE_FORMAT_ARRAY_ROWS){var c="";throwError(c)}var d=prepareBoxplotData(o.getRawData(),a.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:d.boxData},{data:d.outliers}]}};function install$z(s){s.registerSeriesModel(BoxplotSeriesModel),s.registerChartView(BoxplotView),s.registerLayout(boxplotLayout),s.registerTransform(boxplotTransform)}var positiveBorderColorQuery=["itemStyle","borderColor"],negativeBorderColorQuery=["itemStyle","borderColor0"],dojiBorderColorQuery=["itemStyle","borderColorDoji"],positiveColorQuery=["itemStyle","color"],negativeColorQuery=["itemStyle","color0"];function getColor(s,a){return a.get(s>0?positiveColorQuery:negativeColorQuery)}function getBorderColor(s,a){return a.get(s===0?dojiBorderColorQuery:s>0?positiveBorderColorQuery:negativeBorderColorQuery)}var candlestickVisual={seriesType:"candlestick",plan:createRenderPlanner(),performRawSeries:!0,reset:function(s,a){if(!a.isSeriesFiltered(s)){var o=s.pipelineContext.large;return!o&&{progress:function(c,d){for(var tt;(tt=c.next())!=null;){var nt=d.getItemModel(tt),it=d.getItemLayout(tt).sign,st=nt.getItemStyle();st.fill=getColor(it,nt),st.stroke=getBorderColor(it,nt)||st.fill;var ut=d.ensureUniqueItemVisual(tt,"style");extend(ut,st)}}}}}},SKIP_PROPS=["color","borderColor"],CandlestickView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(o),this._isLargeDraw?this._renderLarge(o):this._renderNormal(o)},a.prototype.incrementalPrepareRender=function(o,c,d){this._clear(),this._updateDrawMode(o)},a.prototype.incrementalRender=function(o,c,d,tt){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(o,c):this._incrementalRenderNormal(o,c)},a.prototype.eachRendered=function(o){traverseElements(this._progressiveEls||this.group,o)},a.prototype._updateDrawMode=function(o){var c=o.pipelineContext.large;(this._isLargeDraw==null||c!==this._isLargeDraw)&&(this._isLargeDraw=c,this._clear())},a.prototype._renderNormal=function(o){var c=o.getData(),d=this._data,tt=this.group,nt=c.getLayout("isSimpleBox"),it=o.get("clip",!0),st=o.coordinateSystem,ut=st.getArea&&st.getArea();this._data||tt.removeAll(),c.diff(d).add(function(ct){if(c.hasValue(ct)){var ot=c.getItemLayout(ct);if(it&&isNormalBoxClipped(ut,ot))return;var at=createNormalBox(ot,ct,!0);initProps(at,{shape:{points:ot.ends}},o,ct),setBoxCommon(at,c,ct,nt),tt.add(at),c.setItemGraphicEl(ct,at)}}).update(function(ct,ot){var at=d.getItemGraphicEl(ot);if(!c.hasValue(ct)){tt.remove(at);return}var ht=c.getItemLayout(ct);if(it&&isNormalBoxClipped(ut,ht)){tt.remove(at);return}at?(updateProps$1(at,{shape:{points:ht.ends}},o,ct),saveOldStyle(at)):at=createNormalBox(ht),setBoxCommon(at,c,ct,nt),tt.add(at),c.setItemGraphicEl(ct,at)}).remove(function(ct){var ot=d.getItemGraphicEl(ct);ot&&tt.remove(ot)}).execute(),this._data=c},a.prototype._renderLarge=function(o){this._clear(),createLarge(o,this.group);var c=o.get("clip",!0)?createClipPath(o.coordinateSystem,!1,o):null;c?this.group.setClipPath(c):this.group.removeClipPath()},a.prototype._incrementalRenderNormal=function(o,c){for(var d=c.getData(),tt=d.getLayout("isSimpleBox"),nt;(nt=o.next())!=null;){var it=d.getItemLayout(nt),st=createNormalBox(it);setBoxCommon(st,d,nt,tt),st.incremental=!0,this.group.add(st),this._progressiveEls.push(st)}},a.prototype._incrementalRenderLarge=function(o,c){createLarge(c,this.group,this._progressiveEls,!0)},a.prototype.remove=function(o){this._clear()},a.prototype._clear=function(){this.group.removeAll(),this._data=null},a.type="candlestick",a}(ChartView),NormalBoxPathShape=function(){function s(){}return s}(),NormalBoxPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="normalCandlestickBox",c}return a.prototype.getDefaultShape=function(){return new NormalBoxPathShape},a.prototype.buildPath=function(o,c){var d=c.points;this.__simpleBox?(o.moveTo(d[4][0],d[4][1]),o.lineTo(d[6][0],d[6][1])):(o.moveTo(d[0][0],d[0][1]),o.lineTo(d[1][0],d[1][1]),o.lineTo(d[2][0],d[2][1]),o.lineTo(d[3][0],d[3][1]),o.closePath(),o.moveTo(d[4][0],d[4][1]),o.lineTo(d[5][0],d[5][1]),o.moveTo(d[6][0],d[6][1]),o.lineTo(d[7][0],d[7][1]))},a}(Path);function createNormalBox(s,a,o){var c=s.ends;return new NormalBoxPath({shape:{points:o?transInit(c,s):c},z2:100})}function isNormalBoxClipped(s,a){for(var o=!0,c=0;c<a.ends.length;c++)if(s.contain(a.ends[c][0],a.ends[c][1])){o=!1;break}return o}function setBoxCommon(s,a,o,c){var d=a.getItemModel(o);s.useStyle(a.getItemVisual(o,"style")),s.style.strokeNoScale=!0,s.__simpleBox=c,setStatesStylesFromModel(s,d);var tt=a.getItemLayout(o).sign;each$f(s.states,function(it,st){var ut=d.getModel(st),ct=getColor(tt,ut),ot=getBorderColor(tt,ut)||ct,at=it.style||(it.style={});ct&&(at.fill=ct),ot&&(at.stroke=ot)});var nt=d.getModel("emphasis");toggleHoverEmphasis(s,nt.get("focus"),nt.get("blurScope"),nt.get("disabled"))}function transInit(s,a){return map$1(s,function(o){return o=o.slice(),o[1]=a.initBaseline,o})}var LargeBoxPathShape=function(){function s(){}return s}(),LargeBoxPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c.type="largeCandlestickBox",c}return a.prototype.getDefaultShape=function(){return new LargeBoxPathShape},a.prototype.buildPath=function(o,c){for(var d=c.points,tt=0;tt<d.length;)if(this.__sign===d[tt++]){var nt=d[tt++];o.moveTo(nt,d[tt++]),o.lineTo(nt,d[tt++])}else tt+=3},a}(Path);function createLarge(s,a,o,c){var d=s.getData(),tt=d.getLayout("largePoints"),nt=new LargeBoxPath({shape:{points:tt},__sign:1,ignoreCoarsePointer:!0});a.add(nt);var it=new LargeBoxPath({shape:{points:tt},__sign:-1,ignoreCoarsePointer:!0});a.add(it);var st=new LargeBoxPath({shape:{points:tt},__sign:0,ignoreCoarsePointer:!0});a.add(st),setLargeStyle(1,nt,s),setLargeStyle(-1,it,s),setLargeStyle(0,st,s),c&&(nt.incremental=!0,it.incremental=!0),o&&o.push(nt,it)}function setLargeStyle(s,a,o,c){var d=getBorderColor(s,o)||getColor(s,o),tt=o.getModel("itemStyle").getItemStyle(SKIP_PROPS);a.useStyle(tt),a.style.fill=null,a.style.stroke=d}var CandlestickSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],o}return a.prototype.getShadowDim=function(){return"open"},a.prototype.brushSelector=function(o,c,d){var tt=c.getItemLayout(o);return tt&&d.rect(tt.brushRect)},a.type="series.candlestick",a.dependencies=["xAxis","yAxis","grid"],a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},a}(SeriesModel);mixin(CandlestickSeriesModel,WhiskerBoxCommonMixin,!0);function candlestickPreprocessor(s){!s||!isArray$1(s.series)||each$f(s.series,function(a){isObject$3(a)&&a.type==="k"&&(a.type="candlestick")})}var candlestickLayout={seriesType:"candlestick",plan:createRenderPlanner(),reset:function(s){var a=s.coordinateSystem,o=s.getData(),c=calculateCandleWidth(s,o),d=0,tt=1,nt=["x","y"],it=o.getDimensionIndex(o.mapDimension(nt[d])),st=map$1(o.mapDimensionsAll(nt[tt]),o.getDimensionIndex,o),ut=st[0],ct=st[1],ot=st[2],at=st[3];if(o.setLayout({candleWidth:c,isSimpleBox:c<=1.3}),it<0||st.length<4)return;return{progress:s.pipelineContext.large?ft:ht};function ht(mt,yt){for(var bt,wt=yt.getStore();(bt=mt.next())!=null;){var Tt=wt.get(it,bt),Ct=wt.get(ut,bt),Dt=wt.get(ct,bt),Ot=wt.get(ot,bt),$t=wt.get(at,bt),Ft=Math.min(Ct,Dt),kt=Math.max(Ct,Dt),Vt=cr(Ft,Tt),Ht=cr(kt,Tt),Qt=cr(Ot,Tt),Xt=cr($t,Tt),Zt=[];dr(Zt,Ht,0),dr(Zt,Vt,1),Zt.push(Dr(Xt),Dr(Ht),Dr(Qt),Dr(Vt));var ar=yt.getItemModel(bt),nr=!!ar.get(["itemStyle","borderColorDoji"]);yt.setItemLayout(bt,{sign:getSign(wt,bt,Ct,Dt,ct,nr),initBaseline:Ct>Dt?Ht[tt]:Vt[tt],ends:Zt,brushRect:mr(Ot,$t,Tt)})}function cr(kr,Yr){var Mr=[];return Mr[d]=Yr,Mr[tt]=kr,isNaN(Yr)||isNaN(kr)?[NaN,NaN]:a.dataToPoint(Mr)}function dr(kr,Yr,Mr){var Jr=Yr.slice(),an=Yr.slice();Jr[d]=subPixelOptimize(Jr[d]+c/2,1,!1),an[d]=subPixelOptimize(an[d]-c/2,1,!0),Mr?kr.push(Jr,an):kr.push(an,Jr)}function mr(kr,Yr,Mr){var Jr=cr(kr,Mr),an=cr(Yr,Mr);return Jr[d]-=c/2,an[d]-=c/2,{x:Jr[0],y:Jr[1],width:c,height:an[1]-Jr[1]}}function Dr(kr){return kr[d]=subPixelOptimize(kr[d],1),kr}}function ft(mt,yt){for(var bt=createFloat32Array(mt.count*4),wt=0,Tt,Ct=[],Dt=[],Ot,$t=yt.getStore(),Ft=!!s.get(["itemStyle","borderColorDoji"]);(Ot=mt.next())!=null;){var kt=$t.get(it,Ot),Vt=$t.get(ut,Ot),Ht=$t.get(ct,Ot),Qt=$t.get(ot,Ot),Xt=$t.get(at,Ot);if(isNaN(kt)||isNaN(Qt)||isNaN(Xt)){bt[wt++]=NaN,wt+=3;continue}bt[wt++]=getSign($t,Ot,Vt,Ht,ct,Ft),Ct[d]=kt,Ct[tt]=Qt,Tt=a.dataToPoint(Ct,null,Dt),bt[wt++]=Tt?Tt[0]:NaN,bt[wt++]=Tt?Tt[1]:NaN,Ct[tt]=Xt,Tt=a.dataToPoint(Ct,null,Dt),bt[wt++]=Tt?Tt[1]:NaN}yt.setLayout("largePoints",bt)}}};function getSign(s,a,o,c,d,tt){var nt;return o>c?nt=-1:o<c?nt=1:nt=tt?0:a>0?s.get(d,a-1)<=c?1:-1:1,nt}function calculateCandleWidth(s,a){var o=s.getBaseAxis(),c,d=o.type==="category"?o.getBandWidth():(c=o.getExtent(),Math.abs(c[1]-c[0])/a.count()),tt=parsePercent(retrieve2(s.get("barMaxWidth"),d),d),nt=parsePercent(retrieve2(s.get("barMinWidth"),1),d),it=s.get("barWidth");return it!=null?parsePercent(it,d):Math.max(Math.min(d/2,tt),nt)}function install$y(s){s.registerChartView(CandlestickView),s.registerSeriesModel(CandlestickSeriesModel),s.registerPreprocessor(candlestickPreprocessor),s.registerVisual(candlestickVisual),s.registerLayout(candlestickLayout)}function updateRipplePath(s,a){var o=a.rippleEffectColor||a.color;s.eachChild(function(c){c.attr({z:a.z,zlevel:a.zlevel,style:{stroke:a.brushType==="stroke"?o:null,fill:a.brushType==="fill"?o:null}})})}var EffectSymbol=function(s){__extends$1(a,s);function a(o,c){var d=s.call(this)||this,tt=new Symbol$1(o,c),nt=new Group$3;return d.add(tt),d.add(nt),d.updateData(o,c),d}return a.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},a.prototype.startEffectAnimation=function(o){for(var c=o.symbolType,d=o.color,tt=o.rippleNumber,nt=this.childAt(1),it=0;it<tt;it++){var st=createSymbol$1(c,-1,-1,2,2,d);st.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var ut=-it/tt*o.period+o.effectOffset;st.animate("",!0).when(o.period,{scaleX:o.rippleScale/2,scaleY:o.rippleScale/2}).delay(ut).start(),st.animateStyle(!0).when(o.period,{opacity:0}).delay(ut).start(),nt.add(st)}updateRipplePath(nt,o)},a.prototype.updateEffectAnimation=function(o){for(var c=this._effectCfg,d=this.childAt(1),tt=["symbolType","period","rippleScale","rippleNumber"],nt=0;nt<tt.length;nt++){var it=tt[nt];if(c[it]!==o[it]){this.stopEffectAnimation(),this.startEffectAnimation(o);return}}updateRipplePath(d,o)},a.prototype.highlight=function(){enterEmphasis(this)},a.prototype.downplay=function(){leaveEmphasis(this)},a.prototype.getSymbolType=function(){var o=this.childAt(0);return o&&o.getSymbolType()},a.prototype.updateData=function(o,c){var d=this,tt=o.hostModel;this.childAt(0).updateData(o,c);var nt=this.childAt(1),it=o.getItemModel(c),st=o.getItemVisual(c,"symbol"),ut=normalizeSymbolSize(o.getItemVisual(c,"symbolSize")),ct=o.getItemVisual(c,"style"),ot=ct&&ct.fill,at=it.getModel("emphasis");nt.setScale(ut),nt.traverse(function(yt){yt.setStyle("fill",ot)});var ht=normalizeSymbolOffset(o.getItemVisual(c,"symbolOffset"),ut);ht&&(nt.x=ht[0],nt.y=ht[1]);var ft=o.getItemVisual(c,"symbolRotate");nt.rotation=(ft||0)*Math.PI/180||0;var mt={};mt.showEffectOn=tt.get("showEffectOn"),mt.rippleScale=it.get(["rippleEffect","scale"]),mt.brushType=it.get(["rippleEffect","brushType"]),mt.period=it.get(["rippleEffect","period"])*1e3,mt.effectOffset=c/o.count(),mt.z=tt.getShallow("z")||0,mt.zlevel=tt.getShallow("zlevel")||0,mt.symbolType=st,mt.color=ot,mt.rippleEffectColor=it.get(["rippleEffect","color"]),mt.rippleNumber=it.get(["rippleEffect","number"]),mt.showEffectOn==="render"?(this._effectCfg?this.updateEffectAnimation(mt):this.startEffectAnimation(mt),this._effectCfg=mt):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(yt){yt==="emphasis"?mt.showEffectOn!=="render"&&d.startEffectAnimation(mt):yt==="normal"&&mt.showEffectOn!=="render"&&d.stopEffectAnimation()}),this._effectCfg=mt,toggleHoverEmphasis(this,at.get("focus"),at.get("blurScope"),at.get("disabled"))},a.prototype.fadeOut=function(o){o&&o()},a}(Group$3),EffectScatterView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(){this._symbolDraw=new SymbolDraw(EffectSymbol)},a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this._symbolDraw;nt.updateData(tt,{clipShape:this._getClipShape(o)}),this.group.add(nt.group)},a.prototype._getClipShape=function(o){var c=o.coordinateSystem,d=c&&c.getArea&&c.getArea();return o.get("clip",!0)?d:null},a.prototype.updateTransform=function(o,c,d){var tt=o.getData();this.group.dirty();var nt=pointsLayout("").reset(o,c,d);nt.progress&&nt.progress({start:0,end:tt.count(),count:tt.count()},tt),this._symbolDraw.updateLayout()},a.prototype._updateGroupTransform=function(o){var c=o.coordinateSystem;c&&c.getRoamTransform&&(this.group.transform=clone$2(c.getRoamTransform()),this.group.decomposeTransform())},a.prototype.remove=function(o,c){this._symbolDraw&&this._symbolDraw.remove(!0)},a.type="effectScatter",a}(ChartView),EffectScatterSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o}return a.prototype.getInitialData=function(o,c){return createSeriesData(null,this,{useEncodeDefaulter:!0})},a.prototype.brushSelector=function(o,c,d){return d.point(c.getItemLayout(o))},a.type="series.effectScatter",a.dependencies=["grid","polar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},a}(SeriesModel);function install$x(s){s.registerChartView(EffectScatterView),s.registerSeriesModel(EffectScatterSeriesModel),s.registerLayout(pointsLayout("effectScatter"))}var EffectLine=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this)||this;return tt.add(tt.createLine(o,c,d)),tt._updateEffectSymbol(o,c),tt}return a.prototype.createLine=function(o,c,d){return new Line(o,c,d)},a.prototype._updateEffectSymbol=function(o,c){var d=o.getItemModel(c),tt=d.getModel("effect"),nt=tt.get("symbolSize"),it=tt.get("symbol");isArray$1(nt)||(nt=[nt,nt]);var st=o.getItemVisual(c,"style"),ut=tt.get("color")||st&&st.stroke,ct=this.childAt(1);this._symbolType!==it&&(this.remove(ct),ct=createSymbol$1(it,-.5,-.5,1,1,ut),ct.z2=100,ct.culling=!0,this.add(ct)),ct&&(ct.setStyle("shadowColor",ut),ct.setStyle(tt.getItemStyle(["color"])),ct.scaleX=nt[0],ct.scaleY=nt[1],ct.setColor(ut),this._symbolType=it,this._symbolScale=nt,this._updateEffectAnimation(o,tt,c))},a.prototype._updateEffectAnimation=function(o,c,d){var tt=this.childAt(1);if(tt){var nt=o.getItemLayout(d),it=c.get("period")*1e3,st=c.get("loop"),ut=c.get("roundTrip"),ct=c.get("constantSpeed"),ot=retrieve(c.get("delay"),function(ht){return ht/o.count()*it/3});if(tt.ignore=!0,this._updateAnimationPoints(tt,nt),ct>0&&(it=this._getLineLength(tt)/ct*1e3),it!==this._period||st!==this._loop||ut!==this._roundTrip){tt.stopAnimation();var at=void 0;isFunction$1(ot)?at=ot(d):at=ot,tt.__t>0&&(at=-it*tt.__t),this._animateSymbol(tt,it,at,st,ut)}this._period=it,this._loop=st,this._roundTrip=ut}},a.prototype._animateSymbol=function(o,c,d,tt,nt){if(c>0){o.__t=0;var it=this,st=o.animate("",tt).when(nt?c*2:c,{__t:nt?2:1}).delay(d).during(function(){it._updateSymbolPosition(o)});tt||st.done(function(){it.remove(o)}),st.start()}},a.prototype._getLineLength=function(o){return dist$1(o.__p1,o.__cp1)+dist$1(o.__cp1,o.__p2)},a.prototype._updateAnimationPoints=function(o,c){o.__p1=c[0],o.__p2=c[1],o.__cp1=c[2]||[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]},a.prototype.updateData=function(o,c,d){this.childAt(0).updateData(o,c,d),this._updateEffectSymbol(o,c)},a.prototype._updateSymbolPosition=function(o){var c=o.__p1,d=o.__p2,tt=o.__cp1,nt=o.__t<1?o.__t:2-o.__t,it=[o.x,o.y],st=it.slice(),ut=quadraticAt$1,ct=quadraticDerivativeAt;it[0]=ut(c[0],tt[0],d[0],nt),it[1]=ut(c[1],tt[1],d[1],nt);var ot=o.__t<1?ct(c[0],tt[0],d[0],nt):ct(d[0],tt[0],c[0],1-nt),at=o.__t<1?ct(c[1],tt[1],d[1],nt):ct(d[1],tt[1],c[1],1-nt);o.rotation=-Math.atan2(at,ot)-Math.PI/2,(this._symbolType==="line"||this._symbolType==="rect"||this._symbolType==="roundRect")&&(o.__lastT!==void 0&&o.__lastT<o.__t?(o.scaleY=dist$1(st,it)*1.05,nt===1&&(it[0]=st[0]+(it[0]-st[0])/2,it[1]=st[1]+(it[1]-st[1])/2)):o.__lastT===1?o.scaleY=2*dist$1(c,it):o.scaleY=this._symbolScale[1]),o.__lastT=o.__t,o.ignore=!1,o.x=it[0],o.y=it[1]},a.prototype.updateLayout=function(o,c){this.childAt(0).updateLayout(o,c);var d=o.getItemModel(c).getModel("effect");this._updateEffectAnimation(o,d,c)},a}(Group$3),Polyline=function(s){__extends$1(a,s);function a(o,c,d){var tt=s.call(this)||this;return tt._createPolyline(o,c,d),tt}return a.prototype._createPolyline=function(o,c,d){var tt=o.getItemLayout(c),nt=new Polyline$1({shape:{points:tt}});this.add(nt),this._updateCommonStl(o,c,d)},a.prototype.updateData=function(o,c,d){var tt=o.hostModel,nt=this.childAt(0),it={shape:{points:o.getItemLayout(c)}};updateProps$1(nt,it,tt,c),this._updateCommonStl(o,c,d)},a.prototype._updateCommonStl=function(o,c,d){var tt=this.childAt(0),nt=o.getItemModel(c),it=d&&d.emphasisLineStyle,st=d&&d.focus,ut=d&&d.blurScope,ct=d&&d.emphasisDisabled;if(!d||o.hasItemOption){var ot=nt.getModel("emphasis");it=ot.getModel("lineStyle").getLineStyle(),ct=ot.get("disabled"),st=ot.get("focus"),ut=ot.get("blurScope")}tt.useStyle(o.getItemVisual(c,"style")),tt.style.fill=null,tt.style.strokeNoScale=!0;var at=tt.ensureState("emphasis");at.style=it,toggleHoverEmphasis(this,st,ut,ct)},a.prototype.updateLayout=function(o,c){var d=this.childAt(0);d.setShape("points",o.getItemLayout(c))},a}(Group$3),EffectPolyline=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o._lastFrame=0,o._lastFramePercent=0,o}return a.prototype.createLine=function(o,c,d){return new Polyline(o,c,d)},a.prototype._updateAnimationPoints=function(o,c){this._points=c;for(var d=[0],tt=0,nt=1;nt<c.length;nt++){var it=c[nt-1],st=c[nt];tt+=dist$1(it,st),d.push(tt)}if(tt===0){this._length=0;return}for(var nt=0;nt<d.length;nt++)d[nt]/=tt;this._offsets=d,this._length=tt},a.prototype._getLineLength=function(){return this._length},a.prototype._updateSymbolPosition=function(o){var c=o.__t<1?o.__t:2-o.__t,d=this._points,tt=this._offsets,nt=d.length;if(tt){var it=this._lastFrame,st;if(c<this._lastFramePercent){var ut=Math.min(it+1,nt-1);for(st=ut;st>=0&&!(tt[st]<=c);st--);st=Math.min(st,nt-2)}else{for(st=it;st<nt&&!(tt[st]>c);st++);st=Math.min(st-1,nt-2)}var ct=(c-tt[st])/(tt[st+1]-tt[st]),ot=d[st],at=d[st+1];o.x=ot[0]*(1-ct)+ct*at[0],o.y=ot[1]*(1-ct)+ct*at[1];var ht=o.__t<1?at[0]-ot[0]:ot[0]-at[0],ft=o.__t<1?at[1]-ot[1]:ot[1]-at[1];o.rotation=-Math.atan2(ft,ht)-Math.PI/2,this._lastFrame=st,this._lastFramePercent=c,o.ignore=!1}},a}(EffectLine),LargeLinesPathShape=function(){function s(){this.polyline=!1,this.curveness=0,this.segs=[]}return s}(),LargeLinesPath=function(s){__extends$1(a,s);function a(o){var c=s.call(this,o)||this;return c._off=0,c.hoverDataIdx=-1,c}return a.prototype.reset=function(){this.notClear=!1,this._off=0},a.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},a.prototype.getDefaultShape=function(){return new LargeLinesPathShape},a.prototype.buildPath=function(o,c){var d=c.segs,tt=c.curveness,nt;if(c.polyline)for(nt=this._off;nt<d.length;){var it=d[nt++];if(it>0){o.moveTo(d[nt++],d[nt++]);for(var st=1;st<it;st++)o.lineTo(d[nt++],d[nt++])}}else for(nt=this._off;nt<d.length;){var ut=d[nt++],ct=d[nt++],ot=d[nt++],at=d[nt++];if(o.moveTo(ut,ct),tt>0){var ht=(ut+ot)/2-(ct-at)*tt,ft=(ct+at)/2-(ot-ut)*tt;o.quadraticCurveTo(ht,ft,ot,at)}else o.lineTo(ot,at)}this.incremental&&(this._off=nt,this.notClear=!0)},a.prototype.findDataIndex=function(o,c){var d=this.shape,tt=d.segs,nt=d.curveness,it=this.style.lineWidth;if(d.polyline)for(var st=0,ut=0;ut<tt.length;){var ct=tt[ut++];if(ct>0)for(var ot=tt[ut++],at=tt[ut++],ht=1;ht<ct;ht++){var ft=tt[ut++],mt=tt[ut++];if(containStroke$4(ot,at,ft,mt,it,o,c))return st}st++}else for(var st=0,ut=0;ut<tt.length;){var ot=tt[ut++],at=tt[ut++],ft=tt[ut++],mt=tt[ut++];if(nt>0){var yt=(ot+ft)/2-(at-mt)*nt,bt=(at+mt)/2-(ft-ot)*nt;if(containStroke$2(ot,at,yt,bt,ft,mt,it,o,c))return st}else if(containStroke$4(ot,at,ft,mt,it,o,c))return st;st++}return-1},a.prototype.contain=function(o,c){var d=this.transformCoordToLocal(o,c),tt=this.getBoundingRect();if(o=d[0],c=d[1],tt.contain(o,c)){var nt=this.hoverDataIdx=this.findDataIndex(o,c);return nt>=0}return this.hoverDataIdx=-1,!1},a.prototype.getBoundingRect=function(){var o=this._rect;if(!o){for(var c=this.shape,d=c.segs,tt=1/0,nt=1/0,it=-1/0,st=-1/0,ut=0;ut<d.length;){var ct=d[ut++],ot=d[ut++];tt=Math.min(ct,tt),it=Math.max(ct,it),nt=Math.min(ot,nt),st=Math.max(ot,st)}o=this._rect=new BoundingRect(tt,nt,it,st)}return o},a}(Path),LargeLineDraw=function(){function s(){this.group=new Group$3}return s.prototype.updateData=function(a){this._clear();var o=this._create();o.setShape({segs:a.getLayout("linesPoints")}),this._setCommon(o,a)},s.prototype.incrementalPrepareUpdate=function(a){this.group.removeAll(),this._clear()},s.prototype.incrementalUpdate=function(a,o){var c=this._newAdded[0],d=o.getLayout("linesPoints"),tt=c&&c.shape.segs;if(tt&&tt.length<2e4){var nt=tt.length,it=new Float32Array(nt+d.length);it.set(tt),it.set(d,nt),c.setShape({segs:it})}else{this._newAdded=[];var st=this._create();st.incremental=!0,st.setShape({segs:d}),this._setCommon(st,o),st.__startIndex=a.start}},s.prototype.remove=function(){this._clear()},s.prototype.eachRendered=function(a){this._newAdded[0]&&a(this._newAdded[0])},s.prototype._create=function(){var a=new LargeLinesPath({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(a),this.group.add(a),a},s.prototype._setCommon=function(a,o,c){var d=o.hostModel;a.setShape({polyline:d.get("polyline"),curveness:d.get(["lineStyle","curveness"])}),a.useStyle(d.getModel("lineStyle").getLineStyle()),a.style.strokeNoScale=!0;var tt=o.getVisual("style");tt&&tt.stroke&&a.setStyle("stroke",tt.stroke),a.setStyle("fill",null);var nt=getECData(a);nt.seriesIndex=d.seriesIndex,a.on("mousemove",function(it){nt.dataIndex=null;var st=a.hoverDataIdx;st>0&&(nt.dataIndex=st+a.__startIndex)})},s.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},s}(),linesLayout={seriesType:"lines",plan:createRenderPlanner(),reset:function(s){var a=s.coordinateSystem;if(a){var o=s.get("polyline"),c=s.pipelineContext.large;return{progress:function(d,tt){var nt=[];if(c){var it=void 0,st=d.end-d.start;if(o){for(var ut=0,ct=d.start;ct<d.end;ct++)ut+=s.getLineCoordsCount(ct);it=new Float32Array(st+ut*2)}else it=new Float32Array(st*4);for(var ot=0,at=[],ct=d.start;ct<d.end;ct++){var ht=s.getLineCoords(ct,nt);o&&(it[ot++]=ht);for(var ft=0;ft<ht;ft++)at=a.dataToPoint(nt[ft],!1,at),it[ot++]=at[0],it[ot++]=at[1]}tt.setLayout("linesPoints",it)}else for(var ct=d.start;ct<d.end;ct++){var mt=tt.getItemModel(ct),ht=s.getLineCoords(ct,nt),yt=[];if(o)for(var bt=0;bt<ht;bt++)yt.push(a.dataToPoint(nt[bt]));else{yt[0]=a.dataToPoint(nt[0]),yt[1]=a.dataToPoint(nt[1]);var wt=mt.get(["lineStyle","curveness"]);+wt&&(yt[2]=[(yt[0][0]+yt[1][0])/2-(yt[0][1]-yt[1][1])*wt,(yt[0][1]+yt[1][1])/2-(yt[1][0]-yt[0][0])*wt])}tt.setItemLayout(ct,yt)}}}}}},LinesView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this._updateLineDraw(tt,o),it=o.get("zlevel"),st=o.get(["effect","trailLength"]),ut=d.getZr(),ct=ut.painter.getType()==="svg";ct||ut.painter.getLayer(it).clear(!0),this._lastZlevel!=null&&!ct&&ut.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(o)&&st>0&&(ct||ut.configLayer(it,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(st/10+.9,1),0)})),nt.updateData(tt);var ot=o.get("clip",!0)&&createClipPath(o.coordinateSystem,!1,o);ot?this.group.setClipPath(ot):this.group.removeClipPath(),this._lastZlevel=it,this._finished=!0},a.prototype.incrementalPrepareRender=function(o,c,d){var tt=o.getData(),nt=this._updateLineDraw(tt,o);nt.incrementalPrepareUpdate(tt),this._clearLayer(d),this._finished=!1},a.prototype.incrementalRender=function(o,c,d){this._lineDraw.incrementalUpdate(o,c.getData()),this._finished=o.end===c.getData().count()},a.prototype.eachRendered=function(o){this._lineDraw&&this._lineDraw.eachRendered(o)},a.prototype.updateTransform=function(o,c,d){var tt=o.getData(),nt=o.pipelineContext;if(!this._finished||nt.large||nt.progressiveRender)return{update:!0};var it=linesLayout.reset(o,c,d);it.progress&&it.progress({start:0,end:tt.count(),count:tt.count()},tt),this._lineDraw.updateLayout(),this._clearLayer(d)},a.prototype._updateLineDraw=function(o,c){var d=this._lineDraw,tt=this._showEffect(c),nt=!!c.get("polyline"),it=c.pipelineContext,st=it.large;return(!d||tt!==this._hasEffet||nt!==this._isPolyline||st!==this._isLargeDraw)&&(d&&d.remove(),d=this._lineDraw=st?new LargeLineDraw:new LineDraw(nt?tt?EffectPolyline:Polyline:tt?EffectLine:Line),this._hasEffet=tt,this._isPolyline=nt,this._isLargeDraw=st),this.group.add(d.group),d},a.prototype._showEffect=function(o){return!!o.get(["effect","show"])},a.prototype._clearLayer=function(o){var c=o.getZr(),d=c.painter.getType()==="svg";!d&&this._lastZlevel!=null&&c.painter.getLayer(this._lastZlevel).clear(!0)},a.prototype.remove=function(o,c){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(c)},a.prototype.dispose=function(o,c){this.remove(o,c)},a.type="lines",a}(ChartView),Uint32Arr=typeof Uint32Array>"u"?Array:Uint32Array,Float64Arr=typeof Float64Array>"u"?Array:Float64Array;function compatEc2(s){var a=s.data;a&&a[0]&&a[0][0]&&a[0][0].coord&&(s.data=map$1(a,function(o){var c=[o[0].coord,o[1].coord],d={coords:c};return o[0].name&&(d.fromName=o[0].name),o[1].name&&(d.toName=o[1].name),mergeAll([d,o[0],o[1]])}))}var LinesSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.visualStyleAccessPath="lineStyle",o.visualDrawType="stroke",o}return a.prototype.init=function(o){o.data=o.data||[],compatEc2(o);var c=this._processFlatCoordsArray(o.data);this._flatCoords=c.flatCoords,this._flatCoordsOffset=c.flatCoordsOffset,c.flatCoords&&(o.data=new Float32Array(c.count)),s.prototype.init.apply(this,arguments)},a.prototype.mergeOption=function(o){if(compatEc2(o),o.data){var c=this._processFlatCoordsArray(o.data);this._flatCoords=c.flatCoords,this._flatCoordsOffset=c.flatCoordsOffset,c.flatCoords&&(o.data=new Float32Array(c.count))}s.prototype.mergeOption.apply(this,arguments)},a.prototype.appendData=function(o){var c=this._processFlatCoordsArray(o.data);c.flatCoords&&(this._flatCoords?(this._flatCoords=concatArray(this._flatCoords,c.flatCoords),this._flatCoordsOffset=concatArray(this._flatCoordsOffset,c.flatCoordsOffset)):(this._flatCoords=c.flatCoords,this._flatCoordsOffset=c.flatCoordsOffset),o.data=new Float32Array(c.count)),this.getRawData().appendData(o.data)},a.prototype._getCoordsFromItemModel=function(o){var c=this.getData().getItemModel(o),d=c.option instanceof Array?c.option:c.getShallow("coords");return d},a.prototype.getLineCoordsCount=function(o){return this._flatCoordsOffset?this._flatCoordsOffset[o*2+1]:this._getCoordsFromItemModel(o).length},a.prototype.getLineCoords=function(o,c){if(this._flatCoordsOffset){for(var d=this._flatCoordsOffset[o*2],tt=this._flatCoordsOffset[o*2+1],nt=0;nt<tt;nt++)c[nt]=c[nt]||[],c[nt][0]=this._flatCoords[d+nt*2],c[nt][1]=this._flatCoords[d+nt*2+1];return tt}else{for(var it=this._getCoordsFromItemModel(o),nt=0;nt<it.length;nt++)c[nt]=c[nt]||[],c[nt][0]=it[nt][0],c[nt][1]=it[nt][1];return it.length}},a.prototype._processFlatCoordsArray=function(o){var c=0;if(this._flatCoords&&(c=this._flatCoords.length),isNumber(o[0])){for(var d=o.length,tt=new Uint32Arr(d),nt=new Float64Arr(d),it=0,st=0,ut=0,ct=0;ct<d;){ut++;var ot=o[ct++];tt[st++]=it+c,tt[st++]=ot;for(var at=0;at<ot;at++){var ht=o[ct++],ft=o[ct++];nt[it++]=ht,nt[it++]=ft}}return{flatCoordsOffset:new Uint32Array(tt.buffer,0,st),flatCoords:nt,count:ut}}return{flatCoordsOffset:null,flatCoords:null,count:o.length}},a.prototype.getInitialData=function(o,c){var d=new SeriesData(["value"],this);return d.hasItemOption=!1,d.initData(o.data,[],function(tt,nt,it,st){if(tt instanceof Array)return NaN;d.hasItemOption=!0;var ut=tt.value;if(ut!=null)return ut instanceof Array?ut[st]:ut}),d},a.prototype.formatTooltip=function(o,c,d){var tt=this.getData(),nt=tt.getItemModel(o),it=nt.get("name");if(it)return it;var st=nt.get("fromName"),ut=nt.get("toName"),ct=[];return st!=null&&ct.push(st),ut!=null&&ct.push(ut),createTooltipMarkup("nameValue",{name:ct.join(" > ")})},a.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},a.prototype.getProgressive=function(){var o=this.option.progressive;return o??(this.option.large?1e4:this.get("progressive"))},a.prototype.getProgressiveThreshold=function(){var o=this.option.progressiveThreshold;return o??(this.option.large?2e4:this.get("progressiveThreshold"))},a.prototype.getZLevelKey=function(){var o=this.getModel("effect"),c=o.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:o.get("show")&&c>0?c+"":""},a.type="series.lines",a.dependencies=["grid","polar","geo","calendar"],a.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},a}(SeriesModel);function normalize(s){return s instanceof Array||(s=[s,s]),s}var linesVisual={seriesType:"lines",reset:function(s){var a=normalize(s.get("symbol")),o=normalize(s.get("symbolSize")),c=s.getData();c.setVisual("fromSymbol",a&&a[0]),c.setVisual("toSymbol",a&&a[1]),c.setVisual("fromSymbolSize",o&&o[0]),c.setVisual("toSymbolSize",o&&o[1]);function d(tt,nt){var it=tt.getItemModel(nt),st=normalize(it.getShallow("symbol",!0)),ut=normalize(it.getShallow("symbolSize",!0));st[0]&&tt.setItemVisual(nt,"fromSymbol",st[0]),st[1]&&tt.setItemVisual(nt,"toSymbol",st[1]),ut[0]&&tt.setItemVisual(nt,"fromSymbolSize",ut[0]),ut[1]&&tt.setItemVisual(nt,"toSymbolSize",ut[1])}return{dataEach:c.hasItemOption?d:null}}};function install$w(s){s.registerChartView(LinesView),s.registerSeriesModel(LinesSeriesModel),s.registerLayout(linesLayout),s.registerVisual(linesVisual)}var GRADIENT_LEVELS=256,HeatmapLayer=function(){function s(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var a=platformApi.createCanvas();this.canvas=a}return s.prototype.update=function(a,o,c,d,tt,nt){var it=this._getBrush(),st=this._getGradient(tt,"inRange"),ut=this._getGradient(tt,"outOfRange"),ct=this.pointSize+this.blurSize,ot=this.canvas,at=ot.getContext("2d"),ht=a.length;ot.width=o,ot.height=c;for(var ft=0;ft<ht;++ft){var mt=a[ft],yt=mt[0],bt=mt[1],wt=mt[2],Tt=d(wt);at.globalAlpha=Tt,at.drawImage(it,yt-ct,bt-ct)}if(!ot.width||!ot.height)return ot;for(var Ct=at.getImageData(0,0,ot.width,ot.height),Dt=Ct.data,Ot=0,$t=Dt.length,Ft=this.minOpacity,kt=this.maxOpacity,Vt=kt-Ft;Ot<$t;){var Tt=Dt[Ot+3]/256,Ht=Math.floor(Tt*(GRADIENT_LEVELS-1))*4;if(Tt>0){var Qt=nt(Tt)?st:ut;Tt>0&&(Tt=Tt*Vt+Ft),Dt[Ot++]=Qt[Ht],Dt[Ot++]=Qt[Ht+1],Dt[Ot++]=Qt[Ht+2],Dt[Ot++]=Qt[Ht+3]*Tt*256}else Ot+=4}return at.putImageData(Ct,0,0),ot},s.prototype._getBrush=function(){var a=this._brushCanvas||(this._brushCanvas=platformApi.createCanvas()),o=this.pointSize+this.blurSize,c=o*2;a.width=c,a.height=c;var d=a.getContext("2d");return d.clearRect(0,0,c,c),d.shadowOffsetX=c,d.shadowBlur=this.blurSize,d.shadowColor="#000",d.beginPath(),d.arc(-o,o,this.pointSize,0,Math.PI*2,!0),d.closePath(),d.fill(),a},s.prototype._getGradient=function(a,o){for(var c=this._gradientPixels,d=c[o]||(c[o]=new Uint8ClampedArray(256*4)),tt=[0,0,0,0],nt=0,it=0;it<256;it++)a[o](it/255,!0,tt),d[nt++]=tt[0],d[nt++]=tt[1],d[nt++]=tt[2],d[nt++]=tt[3];return d},s}();function getIsInPiecewiseRange(s,a,o){var c=s[1]-s[0];a=map$1(a,function(nt){return{interval:[(nt.interval[0]-s[0])/c,(nt.interval[1]-s[0])/c]}});var d=a.length,tt=0;return function(nt){var it;for(it=tt;it<d;it++){var st=a[it].interval;if(st[0]<=nt&&nt<=st[1]){tt=it;break}}if(it===d)for(it=tt-1;it>=0;it--){var st=a[it].interval;if(st[0]<=nt&&nt<=st[1]){tt=it;break}}return it>=0&&it<d&&o[it]}}function getIsInContinuousRange(s,a){var o=s[1]-s[0];return a=[(a[0]-s[0])/o,(a[1]-s[0])/o],function(c){return c>=a[0]&&c<=a[1]}}function isGeoCoordSys(s){var a=s.dimensions;return a[0]==="lng"&&a[1]==="lat"}var HeatmapView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt;c.eachComponent("visualMap",function(it){it.eachTargetSeries(function(st){st===o&&(tt=it)})}),this._progressiveEls=null,this.group.removeAll();var nt=o.coordinateSystem;nt.type==="cartesian2d"||nt.type==="calendar"?this._renderOnCartesianAndCalendar(o,d,0,o.getData().count()):isGeoCoordSys(nt)&&this._renderOnGeo(nt,o,tt,d)},a.prototype.incrementalPrepareRender=function(o,c,d){this.group.removeAll()},a.prototype.incrementalRender=function(o,c,d,tt){var nt=c.coordinateSystem;nt&&(isGeoCoordSys(nt)?this.render(c,d,tt):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(c,tt,o.start,o.end,!0)))},a.prototype.eachRendered=function(o){traverseElements(this._progressiveEls||this.group,o)},a.prototype._renderOnCartesianAndCalendar=function(o,c,d,tt,nt){var it=o.coordinateSystem,st=isCoordinateSystemType(it,"cartesian2d"),ut,ct,ot,at;if(st){var ht=it.getAxis("x"),ft=it.getAxis("y");ut=ht.getBandWidth()+.5,ct=ft.getBandWidth()+.5,ot=ht.scale.getExtent(),at=ft.scale.getExtent()}for(var mt=this.group,yt=o.getData(),bt=o.getModel(["emphasis","itemStyle"]).getItemStyle(),wt=o.getModel(["blur","itemStyle"]).getItemStyle(),Tt=o.getModel(["select","itemStyle"]).getItemStyle(),Ct=o.get(["itemStyle","borderRadius"]),Dt=getLabelStatesModels(o),Ot=o.getModel("emphasis"),$t=Ot.get("focus"),Ft=Ot.get("blurScope"),kt=Ot.get("disabled"),Vt=st?[yt.mapDimension("x"),yt.mapDimension("y"),yt.mapDimension("value")]:[yt.mapDimension("time"),yt.mapDimension("value")],Ht=d;Ht<tt;Ht++){var Qt=void 0,Xt=yt.getItemVisual(Ht,"style");if(st){var Zt=yt.get(Vt[0],Ht),ar=yt.get(Vt[1],Ht);if(isNaN(yt.get(Vt[2],Ht))||isNaN(Zt)||isNaN(ar)||Zt<ot[0]||Zt>ot[1]||ar<at[0]||ar>at[1])continue;var nr=it.dataToPoint([Zt,ar]);Qt=new Rect$2({shape:{x:nr[0]-ut/2,y:nr[1]-ct/2,width:ut,height:ct},style:Xt})}else{if(isNaN(yt.get(Vt[1],Ht)))continue;Qt=new Rect$2({z2:1,shape:it.dataToRect([yt.get(Vt[0],Ht)]).contentShape,style:Xt})}if(yt.hasItemOption){var cr=yt.getItemModel(Ht),dr=cr.getModel("emphasis");bt=dr.getModel("itemStyle").getItemStyle(),wt=cr.getModel(["blur","itemStyle"]).getItemStyle(),Tt=cr.getModel(["select","itemStyle"]).getItemStyle(),Ct=cr.get(["itemStyle","borderRadius"]),$t=dr.get("focus"),Ft=dr.get("blurScope"),kt=dr.get("disabled"),Dt=getLabelStatesModels(cr)}Qt.shape.r=Ct;var mr=o.getRawValue(Ht),Dr="-";mr&&mr[2]!=null&&(Dr=mr[2]+""),setLabelStyle(Qt,Dt,{labelFetcher:o,labelDataIndex:Ht,defaultOpacity:Xt.opacity,defaultText:Dr}),Qt.ensureState("emphasis").style=bt,Qt.ensureState("blur").style=wt,Qt.ensureState("select").style=Tt,toggleHoverEmphasis(Qt,$t,Ft,kt),Qt.incremental=nt,nt&&(Qt.states.emphasis.hoverLayer=!0),mt.add(Qt),yt.setItemGraphicEl(Ht,Qt),this._progressiveEls&&this._progressiveEls.push(Qt)}},a.prototype._renderOnGeo=function(o,c,d,tt){var nt=d.targetVisuals.inRange,it=d.targetVisuals.outOfRange,st=c.getData(),ut=this._hmLayer||this._hmLayer||new HeatmapLayer;ut.blurSize=c.get("blurSize"),ut.pointSize=c.get("pointSize"),ut.minOpacity=c.get("minOpacity"),ut.maxOpacity=c.get("maxOpacity");var ct=o.getViewRect().clone(),ot=o.getRoamTransform();ct.applyTransform(ot);var at=Math.max(ct.x,0),ht=Math.max(ct.y,0),ft=Math.min(ct.width+ct.x,tt.getWidth()),mt=Math.min(ct.height+ct.y,tt.getHeight()),yt=ft-at,bt=mt-ht,wt=[st.mapDimension("lng"),st.mapDimension("lat"),st.mapDimension("value")],Tt=st.mapArray(wt,function($t,Ft,kt){var Vt=o.dataToPoint([$t,Ft]);return Vt[0]-=at,Vt[1]-=ht,Vt.push(kt),Vt}),Ct=d.getExtent(),Dt=d.type==="visualMap.continuous"?getIsInContinuousRange(Ct,d.option.range):getIsInPiecewiseRange(Ct,d.getPieceList(),d.option.selected);ut.update(Tt,yt,bt,nt.color.getNormalizer(),{inRange:nt.color.getColorMapper(),outOfRange:it.color.getColorMapper()},Dt);var Ot=new ZRImage({style:{width:yt,height:bt,x:at,y:ht,image:ut.canvas},silent:!0});this.group.add(Ot)},a.type="heatmap",a}(ChartView),HeatmapSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.getInitialData=function(o,c){return createSeriesData(null,this,{generateCoord:"value"})},a.prototype.preventIncremental=function(){var o=CoordinateSystemManager.get(this.get("coordinateSystem"));if(o&&o.dimensions)return o.dimensions[0]==="lng"&&o.dimensions[1]==="lat"},a.type="series.heatmap",a.dependencies=["grid","geo","calendar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},a}(SeriesModel);function install$v(s){s.registerChartView(HeatmapView),s.registerSeriesModel(HeatmapSeriesModel)}var BAR_BORDER_WIDTH_QUERY=["itemStyle","borderWidth"],LAYOUT_ATTRS=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],pathForLineWidth=new Circle,PictorialBarView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=this.group,nt=o.getData(),it=this._data,st=o.coordinateSystem,ut=st.getBaseAxis(),ct=ut.isHorizontal(),ot=st.master.getRect(),at={ecSize:{width:d.getWidth(),height:d.getHeight()},seriesModel:o,coordSys:st,coordSysExtent:[[ot.x,ot.x+ot.width],[ot.y,ot.y+ot.height]],isHorizontal:ct,valueDim:LAYOUT_ATTRS[+ct],categoryDim:LAYOUT_ATTRS[1-+ct]};nt.diff(it).add(function(ft){if(nt.hasValue(ft)){var mt=getItemModel(nt,ft),yt=getSymbolMeta(nt,ft,mt,at),bt=createBar(nt,at,yt);nt.setItemGraphicEl(ft,bt),tt.add(bt),updateCommon(bt,at,yt)}}).update(function(ft,mt){var yt=it.getItemGraphicEl(mt);if(!nt.hasValue(ft)){tt.remove(yt);return}var bt=getItemModel(nt,ft),wt=getSymbolMeta(nt,ft,bt,at),Tt=getShapeStr(nt,wt);yt&&Tt!==yt.__pictorialShapeStr&&(tt.remove(yt),nt.setItemGraphicEl(ft,null),yt=null),yt?updateBar(yt,at,wt):yt=createBar(nt,at,wt,!0),nt.setItemGraphicEl(ft,yt),yt.__pictorialSymbolMeta=wt,tt.add(yt),updateCommon(yt,at,wt)}).remove(function(ft){var mt=it.getItemGraphicEl(ft);mt&&removeBar(it,ft,mt.__pictorialSymbolMeta.animationModel,mt)}).execute();var ht=o.get("clip",!0)?createClipPath(o.coordinateSystem,!1,o):null;return ht?tt.setClipPath(ht):tt.removeClipPath(),this._data=nt,this.group},a.prototype.remove=function(o,c){var d=this.group,tt=this._data;o.get("animation")?tt&&tt.eachItemGraphicEl(function(nt){removeBar(tt,getECData(nt).dataIndex,o,nt)}):d.removeAll()},a.type="pictorialBar",a}(ChartView);function getSymbolMeta(s,a,o,c){var d=s.getItemLayout(a),tt=o.get("symbolRepeat"),nt=o.get("symbolClip"),it=o.get("symbolPosition")||"start",st=o.get("symbolRotate"),ut=(st||0)*Math.PI/180||0,ct=o.get("symbolPatternSize")||2,ot=o.isAnimationEnabled(),at={dataIndex:a,layout:d,itemModel:o,symbolType:s.getItemVisual(a,"symbol")||"circle",style:s.getItemVisual(a,"style"),symbolClip:nt,symbolRepeat:tt,symbolRepeatDirection:o.get("symbolRepeatDirection"),symbolPatternSize:ct,rotation:ut,animationModel:ot?o:null,hoverScale:ot&&o.get(["emphasis","scale"]),z2:o.getShallow("z",!0)||0};prepareBarLength(o,tt,d,c,at),prepareSymbolSize(s,a,d,tt,nt,at.boundingLength,at.pxSign,ct,c,at),prepareLineWidth(o,at.symbolScale,ut,c,at);var ht=at.symbolSize,ft=normalizeSymbolOffset(o.get("symbolOffset"),ht);return prepareLayoutInfo(o,ht,d,tt,nt,ft,it,at.valueLineWidth,at.boundingLength,at.repeatCutLength,c,at),at}function prepareBarLength(s,a,o,c,d){var tt=c.valueDim,nt=s.get("symbolBoundingData"),it=c.coordSys.getOtherAxis(c.coordSys.getBaseAxis()),st=it.toGlobalCoord(it.dataToCoord(0)),ut=1-+(o[tt.wh]<=0),ct;if(isArray$1(nt)){var ot=[convertToCoordOnAxis(it,nt[0])-st,convertToCoordOnAxis(it,nt[1])-st];ot[1]<ot[0]&&ot.reverse(),ct=ot[ut]}else nt!=null?ct=convertToCoordOnAxis(it,nt)-st:a?ct=c.coordSysExtent[tt.index][ut]-st:ct=o[tt.wh];d.boundingLength=ct,a&&(d.repeatCutLength=o[tt.wh]);var at=tt.xy==="x",ht=it.inverse;d.pxSign=at&&!ht||!at&&ht?ct>=0?1:-1:ct>0?1:-1}function convertToCoordOnAxis(s,a){return s.toGlobalCoord(s.dataToCoord(s.scale.parse(a)))}function prepareSymbolSize(s,a,o,c,d,tt,nt,it,st,ut){var ct=st.valueDim,ot=st.categoryDim,at=Math.abs(o[ot.wh]),ht=s.getItemVisual(a,"symbolSize"),ft;isArray$1(ht)?ft=ht.slice():ht==null?ft=["100%","100%"]:ft=[ht,ht],ft[ot.index]=parsePercent(ft[ot.index],at),ft[ct.index]=parsePercent(ft[ct.index],c?at:Math.abs(tt)),ut.symbolSize=ft;var mt=ut.symbolScale=[ft[0]/it,ft[1]/it];mt[ct.index]*=(st.isHorizontal?-1:1)*nt}function prepareLineWidth(s,a,o,c,d){var tt=s.get(BAR_BORDER_WIDTH_QUERY)||0;tt&&(pathForLineWidth.attr({scaleX:a[0],scaleY:a[1],rotation:o}),pathForLineWidth.updateTransform(),tt/=pathForLineWidth.getLineScale(),tt*=a[c.valueDim.index]),d.valueLineWidth=tt||0}function prepareLayoutInfo(s,a,o,c,d,tt,nt,it,st,ut,ct,ot){var at=ct.categoryDim,ht=ct.valueDim,ft=ot.pxSign,mt=Math.max(a[ht.index]+it,0),yt=mt;if(c){var bt=Math.abs(st),wt=retrieve(s.get("symbolMargin"),"15%")+"",Tt=!1;wt.lastIndexOf("!")===wt.length-1&&(Tt=!0,wt=wt.slice(0,wt.length-1));var Ct=parsePercent(wt,a[ht.index]),Dt=Math.max(mt+Ct*2,0),Ot=Tt?0:Ct*2,$t=isNumeric(c),Ft=$t?c:toIntTimes((bt+Ot)/Dt),kt=bt-Ft*mt;Ct=kt/2/(Tt?Ft:Math.max(Ft-1,1)),Dt=mt+Ct*2,Ot=Tt?0:Ct*2,!$t&&c!=="fixed"&&(Ft=ut?toIntTimes((Math.abs(ut)+Ot)/Dt):0),yt=Ft*Dt-Ot,ot.repeatTimes=Ft,ot.symbolMargin=Ct}var Vt=ft*(yt/2),Ht=ot.pathPosition=[];Ht[at.index]=o[at.wh]/2,Ht[ht.index]=nt==="start"?Vt:nt==="end"?st-Vt:st/2,tt&&(Ht[0]+=tt[0],Ht[1]+=tt[1]);var Qt=ot.bundlePosition=[];Qt[at.index]=o[at.xy],Qt[ht.index]=o[ht.xy];var Xt=ot.barRectShape=extend({},o);Xt[ht.wh]=ft*Math.max(Math.abs(o[ht.wh]),Math.abs(Ht[ht.index]+Vt)),Xt[at.wh]=o[at.wh];var Zt=ot.clipShape={};Zt[at.xy]=-o[at.xy],Zt[at.wh]=ct.ecSize[at.wh],Zt[ht.xy]=0,Zt[ht.wh]=o[ht.wh]}function createPath(s){var a=s.symbolPatternSize,o=createSymbol$1(s.symbolType,-a/2,-a/2,a,a);return o.attr({culling:!0}),o.type!=="image"&&o.setStyle({strokeNoScale:!0}),o}function createOrUpdateRepeatSymbols(s,a,o,c){var d=s.__pictorialBundle,tt=o.symbolSize,nt=o.valueLineWidth,it=o.pathPosition,st=a.valueDim,ut=o.repeatTimes||0,ct=0,ot=tt[a.valueDim.index]+nt+o.symbolMargin*2;for(eachPath(s,function(mt){mt.__pictorialAnimationIndex=ct,mt.__pictorialRepeatTimes=ut,ct<ut?updateAttr(mt,null,ft(ct),o,c):updateAttr(mt,null,{scaleX:0,scaleY:0},o,c,function(){d.remove(mt)}),ct++});ct<ut;ct++){var at=createPath(o);at.__pictorialAnimationIndex=ct,at.__pictorialRepeatTimes=ut,d.add(at);var ht=ft(ct);updateAttr(at,{x:ht.x,y:ht.y,scaleX:0,scaleY:0},{scaleX:ht.scaleX,scaleY:ht.scaleY,rotation:ht.rotation},o,c)}function ft(mt){var yt=it.slice(),bt=o.pxSign,wt=mt;return(o.symbolRepeatDirection==="start"?bt>0:bt<0)&&(wt=ut-1-mt),yt[st.index]=ot*(wt-ut/2+.5)+it[st.index],{x:yt[0],y:yt[1],scaleX:o.symbolScale[0],scaleY:o.symbolScale[1],rotation:o.rotation}}}function createOrUpdateSingleSymbol(s,a,o,c){var d=s.__pictorialBundle,tt=s.__pictorialMainPath;tt?updateAttr(tt,null,{x:o.pathPosition[0],y:o.pathPosition[1],scaleX:o.symbolScale[0],scaleY:o.symbolScale[1],rotation:o.rotation},o,c):(tt=s.__pictorialMainPath=createPath(o),d.add(tt),updateAttr(tt,{x:o.pathPosition[0],y:o.pathPosition[1],scaleX:0,scaleY:0,rotation:o.rotation},{scaleX:o.symbolScale[0],scaleY:o.symbolScale[1]},o,c))}function createOrUpdateBarRect(s,a,o){var c=extend({},a.barRectShape),d=s.__pictorialBarRect;d?updateAttr(d,null,{shape:c},a,o):(d=s.__pictorialBarRect=new Rect$2({z2:2,shape:c,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),d.disableMorphing=!0,s.add(d))}function createOrUpdateClip(s,a,o,c){if(o.symbolClip){var d=s.__pictorialClipPath,tt=extend({},o.clipShape),nt=a.valueDim,it=o.animationModel,st=o.dataIndex;if(d)updateProps$1(d,{shape:tt},it,st);else{tt[nt.wh]=0,d=new Rect$2({shape:tt}),s.__pictorialBundle.setClipPath(d),s.__pictorialClipPath=d;var ut={};ut[nt.wh]=o.clipShape[nt.wh],graphic$1[c?"updateProps":"initProps"](d,{shape:ut},it,st)}}}function getItemModel(s,a){var o=s.getItemModel(a);return o.getAnimationDelayParams=getAnimationDelayParams,o.isAnimationEnabled=isAnimationEnabled,o}function getAnimationDelayParams(s){return{index:s.__pictorialAnimationIndex,count:s.__pictorialRepeatTimes}}function isAnimationEnabled(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function createBar(s,a,o,c){var d=new Group$3,tt=new Group$3;return d.add(tt),d.__pictorialBundle=tt,tt.x=o.bundlePosition[0],tt.y=o.bundlePosition[1],o.symbolRepeat?createOrUpdateRepeatSymbols(d,a,o):createOrUpdateSingleSymbol(d,a,o),createOrUpdateBarRect(d,o,c),createOrUpdateClip(d,a,o,c),d.__pictorialShapeStr=getShapeStr(s,o),d.__pictorialSymbolMeta=o,d}function updateBar(s,a,o){var c=o.animationModel,d=o.dataIndex,tt=s.__pictorialBundle;updateProps$1(tt,{x:o.bundlePosition[0],y:o.bundlePosition[1]},c,d),o.symbolRepeat?createOrUpdateRepeatSymbols(s,a,o,!0):createOrUpdateSingleSymbol(s,a,o,!0),createOrUpdateBarRect(s,o,!0),createOrUpdateClip(s,a,o,!0)}function removeBar(s,a,o,c){var d=c.__pictorialBarRect;d&&d.removeTextContent();var tt=[];eachPath(c,function(nt){tt.push(nt)}),c.__pictorialMainPath&&tt.push(c.__pictorialMainPath),c.__pictorialClipPath&&(o=null),each$f(tt,function(nt){removeElement(nt,{scaleX:0,scaleY:0},o,a,function(){c.parent&&c.parent.remove(c)})}),s.setItemGraphicEl(a,null)}function getShapeStr(s,a){return[s.getItemVisual(a.dataIndex,"symbol")||"none",!!a.symbolRepeat,!!a.symbolClip].join(":")}function eachPath(s,a,o){each$f(s.__pictorialBundle.children(),function(c){c!==s.__pictorialBarRect&&a.call(o,c)})}function updateAttr(s,a,o,c,d,tt){a&&s.attr(a),c.symbolClip&&!d?o&&s.attr(o):o&&graphic$1[d?"updateProps":"initProps"](s,o,c.animationModel,c.dataIndex,tt)}function updateCommon(s,a,o){var c=o.dataIndex,d=o.itemModel,tt=d.getModel("emphasis"),nt=tt.getModel("itemStyle").getItemStyle(),it=d.getModel(["blur","itemStyle"]).getItemStyle(),st=d.getModel(["select","itemStyle"]).getItemStyle(),ut=d.getShallow("cursor"),ct=tt.get("focus"),ot=tt.get("blurScope"),at=tt.get("scale");eachPath(s,function(mt){if(mt instanceof ZRImage){var yt=mt.style;mt.useStyle(extend({image:yt.image,x:yt.x,y:yt.y,width:yt.width,height:yt.height},o.style))}else mt.useStyle(o.style);var bt=mt.ensureState("emphasis");bt.style=nt,at&&(bt.scaleX=mt.scaleX*1.1,bt.scaleY=mt.scaleY*1.1),mt.ensureState("blur").style=it,mt.ensureState("select").style=st,ut&&(mt.cursor=ut),mt.z2=o.z2});var ht=a.valueDim.posDesc[+(o.boundingLength>0)],ft=s.__pictorialBarRect;ft.ignoreClip=!0,setLabelStyle(ft,getLabelStatesModels(d),{labelFetcher:a.seriesModel,labelDataIndex:c,defaultText:getDefaultLabel(a.seriesModel.getData(),c),inheritColor:o.style.fill,defaultOpacity:o.style.opacity,defaultOutsidePosition:ht}),toggleHoverEmphasis(s,ct,ot,tt.get("disabled"))}function toIntTimes(s){var a=Math.round(s);return Math.abs(s-a)<1e-4?a:Math.ceil(s)}var PictorialBarSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.hasSymbolVisual=!0,o.defaultSymbol="roundRect",o}return a.prototype.getInitialData=function(o){return o.stack=null,s.prototype.getInitialData.apply(this,arguments)},a.type="series.pictorialBar",a.dependencies=["grid"],a.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),a}(BaseBarSeriesModel);function install$u(s){s.registerChartView(PictorialBarView),s.registerSeriesModel(PictorialBarSeriesModel),s.registerLayout(s.PRIORITY.VISUAL.LAYOUT,curry$1(layout$3,"pictorialBar")),s.registerLayout(s.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("pictorialBar"))}var ThemeRiverView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._layers=[],o}return a.prototype.render=function(o,c,d){var tt=o.getData(),nt=this,it=this.group,st=o.getLayerSeries(),ut=tt.getLayout("layoutInfo"),ct=ut.rect,ot=ut.boundaryGap;it.x=0,it.y=ct.y+ot[0];function at(yt){return yt.name}var ht=new DataDiffer(this._layersSeries||[],st,at,at),ft=[];ht.add(bind$2(mt,this,"add")).update(bind$2(mt,this,"update")).remove(bind$2(mt,this,"remove")).execute();function mt(yt,bt,wt){var Tt=nt._layers;if(yt==="remove"){it.remove(Tt[bt]);return}for(var Ct=[],Dt=[],Ot,$t=st[bt].indices,Ft=0;Ft<$t.length;Ft++){var kt=tt.getItemLayout($t[Ft]),Vt=kt.x,Ht=kt.y0,Qt=kt.y;Ct.push(Vt,Ht),Dt.push(Vt,Ht+Qt),Ot=tt.getItemVisual($t[Ft],"style")}var Xt,Zt=tt.getItemLayout($t[0]),ar=o.getModel("label"),nr=ar.get("margin"),cr=o.getModel("emphasis");if(yt==="add"){var dr=ft[bt]=new Group$3;Xt=new ECPolygon({shape:{points:Ct,stackedOnPoints:Dt,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),dr.add(Xt),it.add(dr),o.isAnimationEnabled()&&Xt.setClipPath(createGridClipShape(Xt.getBoundingRect(),o,function(){Xt.removeClipPath()}))}else{var dr=Tt[wt];Xt=dr.childAt(0),it.add(dr),ft[bt]=dr,updateProps$1(Xt,{shape:{points:Ct,stackedOnPoints:Dt}},o),saveOldStyle(Xt)}setLabelStyle(Xt,getLabelStatesModels(o),{labelDataIndex:$t[Ft-1],defaultText:tt.getName($t[Ft-1]),inheritColor:Ot.fill},{normal:{verticalAlign:"middle"}}),Xt.setTextConfig({position:null,local:!0});var mr=Xt.getTextContent();mr&&(mr.x=Zt.x-nr,mr.y=Zt.y0+Zt.y/2),Xt.useStyle(Ot),tt.setItemGraphicEl(bt,Xt),setStatesStylesFromModel(Xt,o),toggleHoverEmphasis(Xt,cr.get("focus"),cr.get("blurScope"),cr.get("disabled"))}this._layersSeries=st,this._layers=ft},a.type="themeRiver",a}(ChartView);function createGridClipShape(s,a,o){var c=new Rect$2({shape:{x:s.x-10,y:s.y-10,width:0,height:s.height+20}});return initProps(c,{shape:{x:s.x-50,width:s.width+100,height:s.height+20}},a,o),c}var DATA_NAME_INDEX=2,ThemeRiverSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o){s.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$2(this.getData,this),bind$2(this.getRawData,this))},a.prototype.fixData=function(o){var c=o.length,d={},tt=groupData(o,function(at){return d.hasOwnProperty(at[0]+"")||(d[at[0]+""]=-1),at[2]}),nt=[];tt.buckets.each(function(at,ht){nt.push({name:ht,dataList:at})});for(var it=nt.length,st=0;st<it;++st){for(var ut=nt[st].name,ct=0;ct<nt[st].dataList.length;++ct){var ot=nt[st].dataList[ct][0]+"";d[ot]=st}for(var ot in d)d.hasOwnProperty(ot)&&d[ot]!==st&&(d[ot]=st,o[c]=[ot,0,ut],c++)}return o},a.prototype.getInitialData=function(o,c){for(var d=this.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0],tt=d.get("type"),nt=filter(o.data,function(ft){return ft[2]!==void 0}),it=this.fixData(nt||[]),st=[],ut=this.nameMap=createHashMap(),ct=0,ot=0;ot<it.length;++ot)st.push(it[ot][DATA_NAME_INDEX]),ut.get(it[ot][DATA_NAME_INDEX])||(ut.set(it[ot][DATA_NAME_INDEX],ct),ct++);var at=prepareSeriesDataSchema(it,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:getDimensionTypeByAxis(tt)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,ht=new SeriesData(at,this);return ht.initData(it),ht},a.prototype.getLayerSeries=function(){for(var o=this.getData(),c=o.count(),d=[],tt=0;tt<c;++tt)d[tt]=tt;var nt=o.mapDimension("single"),it=groupData(d,function(ut){return o.get("name",ut)}),st=[];return it.buckets.each(function(ut,ct){ut.sort(function(ot,at){return o.get(nt,ot)-o.get(nt,at)}),st.push({name:ct,indices:ut})}),st},a.prototype.getAxisTooltipData=function(o,c,d){isArray$1(o)||(o=o?[o]:[]);for(var tt=this.getData(),nt=this.getLayerSeries(),it=[],st=nt.length,ut,ct=0;ct<st;++ct){for(var ot=Number.MAX_VALUE,at=-1,ht=nt[ct].indices.length,ft=0;ft<ht;++ft){var mt=tt.get(o[0],nt[ct].indices[ft]),yt=Math.abs(mt-c);yt<=ot&&(ut=mt,ot=yt,at=nt[ct].indices[ft])}it.push(at)}return{dataIndices:it,nestestValue:ut}},a.prototype.formatTooltip=function(o,c,d){var tt=this.getData(),nt=tt.getName(o),it=tt.get(tt.mapDimension("value"),o);return createTooltipMarkup("nameValue",{name:nt,value:it})},a.type="series.themeRiver",a.dependencies=["singleAxis"],a.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},a}(SeriesModel);function themeRiverLayout(s,a){s.eachSeriesByType("themeRiver",function(o){var c=o.getData(),d=o.coordinateSystem,tt={},nt=d.getRect();tt.rect=nt;var it=o.get("boundaryGap"),st=d.getAxis();if(tt.boundaryGap=it,st.orient==="horizontal"){it[0]=parsePercent(it[0],nt.height),it[1]=parsePercent(it[1],nt.height);var ut=nt.height-it[0]-it[1];doThemeRiverLayout(c,o,ut)}else{it[0]=parsePercent(it[0],nt.width),it[1]=parsePercent(it[1],nt.width);var ct=nt.width-it[0]-it[1];doThemeRiverLayout(c,o,ct)}c.setLayout("layoutInfo",tt)})}function doThemeRiverLayout(s,a,o){if(s.count())for(var c=a.coordinateSystem,d=a.getLayerSeries(),tt=s.mapDimension("single"),nt=s.mapDimension("value"),it=map$1(d,function(yt){return map$1(yt.indices,function(bt){var wt=c.dataToPoint(s.get(tt,bt));return wt[1]=s.get(nt,bt),wt})}),st=computeBaseline(it),ut=st.y0,ct=o/st.max,ot=d.length,at=d[0].indices.length,ht,ft=0;ft<at;++ft){ht=ut[ft]*ct,s.setItemLayout(d[0].indices[ft],{layerIndex:0,x:it[0][ft][0],y0:ht,y:it[0][ft][1]*ct});for(var mt=1;mt<ot;++mt)ht+=it[mt-1][ft][1]*ct,s.setItemLayout(d[mt].indices[ft],{layerIndex:mt,x:it[mt][ft][0],y0:ht,y:it[mt][ft][1]*ct})}}function computeBaseline(s){for(var a=s.length,o=s[0].length,c=[],d=[],tt=0,nt=0;nt<o;++nt){for(var it=0,st=0;st<a;++st)it+=s[st][nt][1];it>tt&&(tt=it),c.push(it)}for(var ut=0;ut<o;++ut)d[ut]=(tt-c[ut])/2;tt=0;for(var ct=0;ct<o;++ct){var ot=c[ct]+d[ct];ot>tt&&(tt=ot)}return{y0:d,max:tt}}function install$t(s){s.registerChartView(ThemeRiverView),s.registerSeriesModel(ThemeRiverSeriesModel),s.registerLayout(themeRiverLayout),s.registerProcessor(dataFilter$1("themeRiver"))}var DEFAULT_SECTOR_Z=2,DEFAULT_TEXT_Z=4,SunburstPiece=function(s){__extends$1(a,s);function a(o,c,d,tt){var nt=s.call(this)||this;nt.z2=DEFAULT_SECTOR_Z,nt.textConfig={inside:!0},getECData(nt).seriesIndex=c.seriesIndex;var it=new ZRText({z2:DEFAULT_TEXT_Z,silent:o.getModel().get(["label","silent"])});return nt.setTextContent(it),nt.updateData(!0,o,c,d,tt),nt}return a.prototype.updateData=function(o,c,d,tt,nt){this.node=c,c.piece=this,d=d||this._seriesModel,tt=tt||this._ecModel;var it=this;getECData(it).dataIndex=c.dataIndex;var st=c.getModel(),ut=st.getModel("emphasis"),ct=c.getLayout(),ot=extend({},ct);ot.label=null;var at=c.getVisual("style");at.lineJoin="bevel";var ht=c.getVisual("decal");ht&&(at.decal=createOrUpdatePatternFromDecal(ht,nt));var ft=getSectorCornerRadius(st.getModel("itemStyle"),ot,!0);extend(ot,ft),each$f(SPECIAL_STATES,function(wt){var Tt=it.ensureState(wt),Ct=st.getModel([wt,"itemStyle"]);Tt.style=Ct.getItemStyle();var Dt=getSectorCornerRadius(Ct,ot);Dt&&(Tt.shape=Dt)}),o?(it.setShape(ot),it.shape.r=ct.r0,initProps(it,{shape:{r:ct.r}},d,c.dataIndex)):(updateProps$1(it,{shape:ot},d),saveOldStyle(it)),it.useStyle(at),this._updateLabel(d);var mt=st.getShallow("cursor");mt&&it.attr("cursor",mt),this._seriesModel=d||this._seriesModel,this._ecModel=tt||this._ecModel;var yt=ut.get("focus"),bt=yt==="relative"?concatArray(c.getAncestorsIndices(),c.getDescendantIndices()):yt==="ancestor"?c.getAncestorsIndices():yt==="descendant"?c.getDescendantIndices():yt;toggleHoverEmphasis(this,bt,ut.get("blurScope"),ut.get("disabled"))},a.prototype._updateLabel=function(o){var c=this,d=this.node.getModel(),tt=d.getModel("label"),nt=this.node.getLayout(),it=nt.endAngle-nt.startAngle,st=(nt.startAngle+nt.endAngle)/2,ut=Math.cos(st),ct=Math.sin(st),ot=this,at=ot.getTextContent(),ht=this.node.dataIndex,ft=tt.get("minAngle")/180*Math.PI,mt=tt.get("show")&&!(ft!=null&&Math.abs(it)<ft);at.ignore=!mt,each$f(DISPLAY_STATES,function(bt){var wt=bt==="normal"?d.getModel("label"):d.getModel([bt,"label"]),Tt=bt==="normal",Ct=Tt?at:at.ensureState(bt),Dt=o.getFormattedLabel(ht,bt);Tt&&(Dt=Dt||c.node.name),Ct.style=createTextStyle$1(wt,{},null,bt!=="normal",!0),Dt&&(Ct.style.text=Dt);var Ot=wt.get("show");Ot!=null&&!Tt&&(Ct.ignore=!Ot);var $t=yt(wt,"position"),Ft=Tt?ot:ot.states[bt],kt=Ft.style.fill;Ft.textConfig={outsideFill:wt.get("color")==="inherit"?kt:null,inside:$t!=="outside"};var Vt,Ht=yt(wt,"distance")||0,Qt=yt(wt,"align"),Xt=yt(wt,"rotate"),Zt=Math.PI*.5,ar=Math.PI*1.5,nr=normalizeRadian(Xt==="tangential"?Math.PI/2-st:st),cr=nr>Zt&&!isRadianAroundZero(nr-Zt)&&nr<ar;$t==="outside"?(Vt=nt.r+Ht,Qt=cr?"right":"left"):!Qt||Qt==="center"?(it===2*Math.PI&&nt.r0===0?Vt=0:Vt=(nt.r+nt.r0)/2,Qt="center"):Qt==="left"?(Vt=nt.r0+Ht,Qt=cr?"right":"left"):Qt==="right"&&(Vt=nt.r-Ht,Qt=cr?"left":"right"),Ct.style.align=Qt,Ct.style.verticalAlign=yt(wt,"verticalAlign")||"middle",Ct.x=Vt*ut+nt.cx,Ct.y=Vt*ct+nt.cy;var dr=0;Xt==="radial"?dr=normalizeRadian(-st)+(cr?Math.PI:0):Xt==="tangential"?dr=normalizeRadian(Math.PI/2-st)+(cr?Math.PI:0):isNumber(Xt)&&(dr=Xt*Math.PI/180),Ct.rotation=normalizeRadian(dr)});function yt(bt,wt){var Tt=bt.get(wt);return Tt??tt.get(wt)}at.dirtyStyle()},a}(Sector),ROOT_TO_NODE_ACTION="sunburstRootToNode",HIGHLIGHT_ACTION="sunburstHighlight",UNHIGHLIGHT_ACTION="sunburstUnhighlight";function installSunburstAction(s){s.registerAction({type:ROOT_TO_NODE_ACTION,update:"updateView"},function(a,o){o.eachComponent({mainType:"series",subType:"sunburst",query:a},c);function c(d,tt){var nt=retrieveTargetInfo(a,[ROOT_TO_NODE_ACTION],d);if(nt){var it=d.getViewRoot();it&&(a.direction=aboveViewRoot(it,nt.node)?"rollUp":"drillDown"),d.resetViewRoot(nt.node)}}}),s.registerAction({type:HIGHLIGHT_ACTION,update:"none"},function(a,o,c){a=extend({},a),o.eachComponent({mainType:"series",subType:"sunburst",query:a},d);function d(tt){var nt=retrieveTargetInfo(a,[HIGHLIGHT_ACTION],tt);nt&&(a.dataIndex=nt.node.dataIndex)}c.dispatchAction(extend(a,{type:"highlight"}))}),s.registerAction({type:UNHIGHLIGHT_ACTION,update:"updateView"},function(a,o,c){a=extend({},a),c.dispatchAction(extend(a,{type:"downplay"}))})}var SunburstView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d,tt){var nt=this;this.seriesModel=o,this.api=d,this.ecModel=c;var it=o.getData(),st=it.tree.root,ut=o.getViewRoot(),ct=this.group,ot=o.get("renderLabelForZeroData"),at=[];ut.eachNode(function(wt){at.push(wt)});var ht=this._oldChildren||[];ft(at,ht),bt(st,ut),this._initEvents(),this._oldChildren=at;function ft(wt,Tt){if(wt.length===0&&Tt.length===0)return;new DataDiffer(Tt,wt,Ct,Ct).add(Dt).update(Dt).remove(curry$1(Dt,null)).execute();function Ct(Ot){return Ot.getId()}function Dt(Ot,$t){var Ft=Ot==null?null:wt[Ot],kt=$t==null?null:Tt[$t];mt(Ft,kt)}}function mt(wt,Tt){if(!ot&&wt&&!wt.getValue()&&(wt=null),wt!==st&&Tt!==st){if(Tt&&Tt.piece)wt?(Tt.piece.updateData(!1,wt,o,c,d),it.setItemGraphicEl(wt.dataIndex,Tt.piece)):yt(Tt);else if(wt){var Ct=new SunburstPiece(wt,o,c,d);ct.add(Ct),it.setItemGraphicEl(wt.dataIndex,Ct)}}}function yt(wt){wt&&wt.piece&&(ct.remove(wt.piece),wt.piece=null)}function bt(wt,Tt){Tt.depth>0?(nt.virtualPiece?nt.virtualPiece.updateData(!1,wt,o,c,d):(nt.virtualPiece=new SunburstPiece(wt,o,c,d),ct.add(nt.virtualPiece)),Tt.piece.off("click"),nt.virtualPiece.on("click",function(Ct){nt._rootToNode(Tt.parentNode)})):nt.virtualPiece&&(ct.remove(nt.virtualPiece),nt.virtualPiece=null)}},a.prototype._initEvents=function(){var o=this;this.group.off("click"),this.group.on("click",function(c){var d=!1,tt=o.seriesModel.getViewRoot();tt.eachNode(function(nt){if(!d&&nt.piece&&nt.piece===c.target){var it=nt.getModel().get("nodeClick");if(it==="rootToNode")o._rootToNode(nt);else if(it==="link"){var st=nt.getModel(),ut=st.get("link");if(ut){var ct=st.get("target",!0)||"_blank";windowOpen(ut,ct)}}d=!0}})})},a.prototype._rootToNode=function(o){o!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:ROOT_TO_NODE_ACTION,from:this.uid,seriesId:this.seriesModel.id,targetNode:o})},a.prototype.containPoint=function(o,c){var d=c.getData(),tt=d.getItemLayout(0);if(tt){var nt=o[0]-tt.cx,it=o[1]-tt.cy,st=Math.sqrt(nt*nt+it*it);return st<=tt.r&&st>=tt.r0}},a.type="sunburst",a}(ChartView),SunburstSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.ignoreStyleOnData=!0,o}return a.prototype.getInitialData=function(o,c){var d={name:o.name,children:o.data};completeTreeValue(d);var tt=this._levelModels=map$1(o.levels||[],function(st){return new Model(st,this,c)},this),nt=Tree.createTree(d,this,it);function it(st){st.wrapMethod("getItemModel",function(ut,ct){var ot=nt.getNodeByDataIndex(ct),at=tt[ot.depth];return at&&(ut.parentModel=at),ut})}return nt.data},a.prototype.optionUpdated=function(){this.resetViewRoot()},a.prototype.getDataParams=function(o){var c=s.prototype.getDataParams.apply(this,arguments),d=this.getData().tree.getNodeByDataIndex(o);return c.treePathInfo=wrapTreePathInfo(d,this),c},a.prototype.getLevelModel=function(o){return this._levelModels&&this._levelModels[o.depth]},a.prototype.getViewRoot=function(){return this._viewRoot},a.prototype.resetViewRoot=function(o){o?this._viewRoot=o:o=this._viewRoot;var c=this.getRawData().tree.root;(!o||o!==c&&!c.contains(o))&&(this._viewRoot=c)},a.prototype.enableAriaDecal=function(){enableAriaDecalForTree(this)},a.type="series.sunburst",a.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},a}(SeriesModel);function completeTreeValue(s){var a=0;each$f(s.children,function(c){completeTreeValue(c);var d=c.value;isArray$1(d)&&(d=d[0]),a+=d});var o=s.value;isArray$1(o)&&(o=o[0]),(o==null||isNaN(o))&&(o=a),o<0&&(o=0),isArray$1(s.value)?s.value[0]=o:s.value=o}var RADIAN=Math.PI/180;function sunburstLayout(s,a,o){a.eachSeriesByType(s,function(c){var d=c.get("center"),tt=c.get("radius");isArray$1(tt)||(tt=[0,tt]),isArray$1(d)||(d=[d,d]);var nt=o.getWidth(),it=o.getHeight(),st=Math.min(nt,it),ut=parsePercent(d[0],nt),ct=parsePercent(d[1],it),ot=parsePercent(tt[0],st/2),at=parsePercent(tt[1],st/2),ht=-c.get("startAngle")*RADIAN,ft=c.get("minAngle")*RADIAN,mt=c.getData().tree.root,yt=c.getViewRoot(),bt=yt.depth,wt=c.get("sort");wt!=null&&initChildren(yt,wt);var Tt=0;each$f(yt.children,function(nr){!isNaN(nr.getValue())&&Tt++});var Ct=yt.getValue(),Dt=Math.PI/(Ct||Tt)*2,Ot=yt.depth>0,$t=yt.height-(Ot?-1:1),Ft=(at-ot)/($t||1),kt=c.get("clockwise"),Vt=c.get("stillShowZeroSum"),Ht=kt?1:-1,Qt=function(nr,cr){if(nr){var dr=cr;if(nr!==mt){var mr=nr.getValue(),Dr=Ct===0&&Vt?Dt:mr*Dt;Dr<ft&&(Dr=ft),dr=cr+Ht*Dr;var kr=nr.depth-bt-(Ot?-1:1),Yr=ot+Ft*kr,Mr=ot+Ft*(kr+1),Jr=c.getLevelModel(nr);if(Jr){var an=Jr.get("r0",!0),xn=Jr.get("r",!0),Rn=Jr.get("radius",!0);Rn!=null&&(an=Rn[0],xn=Rn[1]),an!=null&&(Yr=parsePercent(an,st/2)),xn!=null&&(Mr=parsePercent(xn,st/2))}nr.setLayout({angle:Dr,startAngle:cr,endAngle:dr,clockwise:kt,cx:ut,cy:ct,r0:Yr,r:Mr})}if(nr.children&&nr.children.length){var hn=0;each$f(nr.children,function(pn){hn+=Qt(pn,cr+hn)})}return dr-cr}};if(Ot){var Xt=ot,Zt=ot+Ft,ar=Math.PI*2;mt.setLayout({angle:ar,startAngle:ht,endAngle:ht+ar,clockwise:kt,cx:ut,cy:ct,r0:Xt,r:Zt})}Qt(yt,ht)})}function initChildren(s,a){var o=s.children||[];s.children=sort(o,a),o.length&&each$f(s.children,function(c){initChildren(c,a)})}function sort(s,a){if(isFunction$1(a)){var o=map$1(s,function(d,tt){var nt=d.getValue();return{params:{depth:d.depth,height:d.height,dataIndex:d.dataIndex,getValue:function(){return nt}},index:tt}});return o.sort(function(d,tt){return a(d.params,tt.params)}),map$1(o,function(d){return s[d.index]})}else{var c=a==="asc";return s.sort(function(d,tt){var nt=(d.getValue()-tt.getValue())*(c?1:-1);return nt===0?(d.dataIndex-tt.dataIndex)*(c?-1:1):nt})}}function sunburstVisual(s){var a={};function o(c,d,tt){for(var nt=c;nt&&nt.depth>1;)nt=nt.parentNode;var it=d.getColorFromPalette(nt.name||nt.dataIndex+"",a);return c.depth>1&&isString$1(it)&&(it=lift(it,(c.depth-1)/(tt-1)*.5)),it}s.eachSeriesByType("sunburst",function(c){var d=c.getData(),tt=d.tree;tt.eachNode(function(nt){var it=nt.getModel(),st=it.getModel("itemStyle").getItemStyle();st.fill||(st.fill=o(nt,c,tt.root.height));var ut=d.ensureUniqueItemVisual(nt.dataIndex,"style");extend(ut,st)})})}function install$s(s){s.registerChartView(SunburstView),s.registerSeriesModel(SunburstSeriesModel),s.registerLayout(curry$1(sunburstLayout,"sunburst")),s.registerProcessor(curry$1(dataFilter$1,"sunburst")),s.registerVisual(sunburstVisual),installSunburstAction(s)}var STYLE_VISUAL_TYPE={color:"fill",borderColor:"stroke"},NON_STYLE_VISUAL_PROPS={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},customInnerStore=makeInner(),CustomSeriesModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},a.prototype.getInitialData=function(o,c){return createSeriesData(null,this)},a.prototype.getDataParams=function(o,c,d){var tt=s.prototype.getDataParams.call(this,o,c);return d&&(tt.info=customInnerStore(d).info),tt},a.type="series.custom",a.dependencies=["grid","polar","geo","singleAxis","calendar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},a}(SeriesModel);function dataToCoordSize$3(s,a){return a=a||[0,0],map$1(["x","y"],function(o,c){var d=this.getAxis(o),tt=a[c],nt=s[c]/2;return d.type==="category"?d.getBandWidth():Math.abs(d.dataToCoord(tt-nt)-d.dataToCoord(tt+nt))},this)}function cartesianPrepareCustom(s){var a=s.master.getRect();return{coordSys:{type:"cartesian2d",x:a.x,y:a.y,width:a.width,height:a.height},api:{coord:function(o){return s.dataToPoint(o)},size:bind$2(dataToCoordSize$3,s)}}}function dataToCoordSize$2(s,a){return a=a||[0,0],map$1([0,1],function(o){var c=a[o],d=s[o]/2,tt=[],nt=[];return tt[o]=c-d,nt[o]=c+d,tt[1-o]=nt[1-o]=a[1-o],Math.abs(this.dataToPoint(tt)[o]-this.dataToPoint(nt)[o])},this)}function geoPrepareCustom(s){var a=s.getBoundingRect();return{coordSys:{type:"geo",x:a.x,y:a.y,width:a.width,height:a.height,zoom:s.getZoom()},api:{coord:function(o){return s.dataToPoint(o)},size:bind$2(dataToCoordSize$2,s)}}}function dataToCoordSize$1(s,a){var o=this.getAxis(),c=a instanceof Array?a[0]:a,d=(s instanceof Array?s[0]:s)/2;return o.type==="category"?o.getBandWidth():Math.abs(o.dataToCoord(c-d)-o.dataToCoord(c+d))}function singlePrepareCustom(s){var a=s.getRect();return{coordSys:{type:"singleAxis",x:a.x,y:a.y,width:a.width,height:a.height},api:{coord:function(o){return s.dataToPoint(o)},size:bind$2(dataToCoordSize$1,s)}}}function dataToCoordSize(s,a){return a=a||[0,0],map$1(["Radius","Angle"],function(o,c){var d="get"+o+"Axis",tt=this[d](),nt=a[c],it=s[c]/2,st=tt.type==="category"?tt.getBandWidth():Math.abs(tt.dataToCoord(nt-it)-tt.dataToCoord(nt+it));return o==="Angle"&&(st=st*Math.PI/180),st},this)}function polarPrepareCustom(s){var a=s.getRadiusAxis(),o=s.getAngleAxis(),c=a.getExtent();return c[0]>c[1]&&c.reverse(),{coordSys:{type:"polar",cx:s.cx,cy:s.cy,r:c[1],r0:c[0]},api:{coord:function(d){var tt=a.dataToRadius(d[0]),nt=o.dataToAngle(d[1]),it=s.coordToPoint([tt,nt]);return it.push(tt,nt*Math.PI/180),it},size:bind$2(dataToCoordSize,s)}}}function calendarPrepareCustom(s){var a=s.getRect(),o=s.getRangeInfo();return{coordSys:{type:"calendar",x:a.x,y:a.y,width:a.width,height:a.height,cellWidth:s.getCellWidth(),cellHeight:s.getCellHeight(),rangeInfo:{start:o.start,end:o.end,weeks:o.weeks,dayCount:o.allDay}},api:{coord:function(c,d){return s.dataToPoint(c,d)}}}}function isEC4CompatibleStyle(s,a,o,c){return s&&(s.legacy||s.legacy!==!1&&!o&&!c&&a!=="tspan"&&(a==="text"||hasOwn(s,"text")))}function convertFromEC4CompatibleStyle(s,a,o){var c=s,d,tt,nt;if(a==="text")nt=c;else{nt={},hasOwn(c,"text")&&(nt.text=c.text),hasOwn(c,"rich")&&(nt.rich=c.rich),hasOwn(c,"textFill")&&(nt.fill=c.textFill),hasOwn(c,"textStroke")&&(nt.stroke=c.textStroke),hasOwn(c,"fontFamily")&&(nt.fontFamily=c.fontFamily),hasOwn(c,"fontSize")&&(nt.fontSize=c.fontSize),hasOwn(c,"fontStyle")&&(nt.fontStyle=c.fontStyle),hasOwn(c,"fontWeight")&&(nt.fontWeight=c.fontWeight),tt={type:"text",style:nt,silent:!0},d={};var it=hasOwn(c,"textPosition");o?d.position=it?c.textPosition:"inside":it&&(d.position=c.textPosition),hasOwn(c,"textPosition")&&(d.position=c.textPosition),hasOwn(c,"textOffset")&&(d.offset=c.textOffset),hasOwn(c,"textRotation")&&(d.rotation=c.textRotation),hasOwn(c,"textDistance")&&(d.distance=c.textDistance)}return convertEC4CompatibleRichItem(nt,s),each$f(nt.rich,function(st){convertEC4CompatibleRichItem(st,st)}),{textConfig:d,textContent:tt}}function convertEC4CompatibleRichItem(s,a){a&&(a.font=a.textFont||a.font,hasOwn(a,"textStrokeWidth")&&(s.lineWidth=a.textStrokeWidth),hasOwn(a,"textAlign")&&(s.align=a.textAlign),hasOwn(a,"textVerticalAlign")&&(s.verticalAlign=a.textVerticalAlign),hasOwn(a,"textLineHeight")&&(s.lineHeight=a.textLineHeight),hasOwn(a,"textWidth")&&(s.width=a.textWidth),hasOwn(a,"textHeight")&&(s.height=a.textHeight),hasOwn(a,"textBackgroundColor")&&(s.backgroundColor=a.textBackgroundColor),hasOwn(a,"textPadding")&&(s.padding=a.textPadding),hasOwn(a,"textBorderColor")&&(s.borderColor=a.textBorderColor),hasOwn(a,"textBorderWidth")&&(s.borderWidth=a.textBorderWidth),hasOwn(a,"textBorderRadius")&&(s.borderRadius=a.textBorderRadius),hasOwn(a,"textBoxShadowColor")&&(s.shadowColor=a.textBoxShadowColor),hasOwn(a,"textBoxShadowBlur")&&(s.shadowBlur=a.textBoxShadowBlur),hasOwn(a,"textBoxShadowOffsetX")&&(s.shadowOffsetX=a.textBoxShadowOffsetX),hasOwn(a,"textBoxShadowOffsetY")&&(s.shadowOffsetY=a.textBoxShadowOffsetY))}function convertToEC4StyleForCustomSerise(s,a,o){var c=s;c.textPosition=c.textPosition||o.position||"inside",o.offset!=null&&(c.textOffset=o.offset),o.rotation!=null&&(c.textRotation=o.rotation),o.distance!=null&&(c.textDistance=o.distance);var d=c.textPosition.indexOf("inside")>=0,tt=s.fill||"#000";convertToEC4RichItem(c,a);var nt=c.textFill==null;return d?nt&&(c.textFill=o.insideFill||"#fff",!c.textStroke&&o.insideStroke&&(c.textStroke=o.insideStroke),!c.textStroke&&(c.textStroke=tt),c.textStrokeWidth==null&&(c.textStrokeWidth=2)):(nt&&(c.textFill=s.fill||o.outsideFill||"#000"),!c.textStroke&&o.outsideStroke&&(c.textStroke=o.outsideStroke)),c.text=a.text,c.rich=a.rich,each$f(a.rich,function(it){convertToEC4RichItem(it,it)}),c}function convertToEC4RichItem(s,a){a&&(hasOwn(a,"fill")&&(s.textFill=a.fill),hasOwn(a,"stroke")&&(s.textStroke=a.fill),hasOwn(a,"lineWidth")&&(s.textStrokeWidth=a.lineWidth),hasOwn(a,"font")&&(s.font=a.font),hasOwn(a,"fontStyle")&&(s.fontStyle=a.fontStyle),hasOwn(a,"fontWeight")&&(s.fontWeight=a.fontWeight),hasOwn(a,"fontSize")&&(s.fontSize=a.fontSize),hasOwn(a,"fontFamily")&&(s.fontFamily=a.fontFamily),hasOwn(a,"align")&&(s.textAlign=a.align),hasOwn(a,"verticalAlign")&&(s.textVerticalAlign=a.verticalAlign),hasOwn(a,"lineHeight")&&(s.textLineHeight=a.lineHeight),hasOwn(a,"width")&&(s.textWidth=a.width),hasOwn(a,"height")&&(s.textHeight=a.height),hasOwn(a,"backgroundColor")&&(s.textBackgroundColor=a.backgroundColor),hasOwn(a,"padding")&&(s.textPadding=a.padding),hasOwn(a,"borderColor")&&(s.textBorderColor=a.borderColor),hasOwn(a,"borderWidth")&&(s.textBorderWidth=a.borderWidth),hasOwn(a,"borderRadius")&&(s.textBorderRadius=a.borderRadius),hasOwn(a,"shadowColor")&&(s.textBoxShadowColor=a.shadowColor),hasOwn(a,"shadowBlur")&&(s.textBoxShadowBlur=a.shadowBlur),hasOwn(a,"shadowOffsetX")&&(s.textBoxShadowOffsetX=a.shadowOffsetX),hasOwn(a,"shadowOffsetY")&&(s.textBoxShadowOffsetY=a.shadowOffsetY),hasOwn(a,"textShadowColor")&&(s.textShadowColor=a.textShadowColor),hasOwn(a,"textShadowBlur")&&(s.textShadowBlur=a.textShadowBlur),hasOwn(a,"textShadowOffsetX")&&(s.textShadowOffsetX=a.textShadowOffsetX),hasOwn(a,"textShadowOffsetY")&&(s.textShadowOffsetY=a.textShadowOffsetY))}var LEGACY_TRANSFORM_PROPS_MAP={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},LEGACY_TRANSFORM_PROPS=keys(LEGACY_TRANSFORM_PROPS_MAP);reduce(TRANSFORMABLE_PROPS,function(s,a){return s[a]=1,s},{});TRANSFORMABLE_PROPS.join(", ");var ELEMENT_ANIMATABLE_PROPS=["","style","shape","extra"],transitionInnerStore=makeInner();function getElementAnimationConfig(s,a,o,c,d){var tt=s+"Animation",nt=getAnimationConfig(s,c,d)||{},it=transitionInnerStore(a).userDuring;return nt.duration>0&&(nt.during=it?bind$2(duringCall,{el:a,userDuring:it}):null,nt.setToFinal=!0,nt.scope=s),extend(nt,o[tt]),nt}function applyUpdateTransition(s,a,o,c){c=c||{};var d=c.dataIndex,tt=c.isInit,nt=c.clearStyle,it=o.isAnimationEnabled(),st=transitionInnerStore(s),ut=a.style;st.userDuring=a.during;var ct={},ot={};if(prepareTransformAllPropsFinal(s,a,ot),prepareShapeOrExtraAllPropsFinal("shape",a,ot),prepareShapeOrExtraAllPropsFinal("extra",a,ot),!tt&&it&&(prepareTransformTransitionFrom(s,a,ct),prepareShapeOrExtraTransitionFrom("shape",s,a,ct),prepareShapeOrExtraTransitionFrom("extra",s,a,ct),prepareStyleTransitionFrom(s,a,ut,ct)),ot.style=ut,applyPropsDirectly(s,ot,nt),applyMiscProps(s,a),it)if(tt){var at={};each$f(ELEMENT_ANIMATABLE_PROPS,function(ft){var mt=ft?a[ft]:a;mt&&mt.enterFrom&&(ft&&(at[ft]=at[ft]||{}),extend(ft?at[ft]:at,mt.enterFrom))});var ht=getElementAnimationConfig("enter",s,a,o,d);ht.duration>0&&s.animateFrom(at,ht)}else applyPropsTransition(s,a,d||0,o,ct);updateLeaveTo(s,a),ut?s.dirty():s.markRedraw()}function updateLeaveTo(s,a){for(var o=transitionInnerStore(s).leaveToProps,c=0;c<ELEMENT_ANIMATABLE_PROPS.length;c++){var d=ELEMENT_ANIMATABLE_PROPS[c],tt=d?a[d]:a;tt&&tt.leaveTo&&(o||(o=transitionInnerStore(s).leaveToProps={}),d&&(o[d]=o[d]||{}),extend(d?o[d]:o,tt.leaveTo))}}function applyLeaveTransition(s,a,o,c){if(s){var d=s.parent,tt=transitionInnerStore(s).leaveToProps;if(tt){var nt=getElementAnimationConfig("update",s,a,o,0);nt.done=function(){d.remove(s)},s.animateTo(tt,nt)}else d.remove(s)}}function isTransitionAll(s){return s==="all"}function applyPropsDirectly(s,a,o){var c=a.style;if(!s.isGroup&&c){if(o){s.useStyle({});for(var d=s.animators,tt=0;tt<d.length;tt++){var nt=d[tt];nt.targetName==="style"&&nt.changeTarget(s.style)}}s.setStyle(c)}a&&(a.style=null,a&&s.attr(a),a.style=c)}function applyPropsTransition(s,a,o,c,d){if(d){var tt=getElementAnimationConfig("update",s,a,c,o);tt.duration>0&&s.animateFrom(d,tt)}}function applyMiscProps(s,a){hasOwn(a,"silent")&&(s.silent=a.silent),hasOwn(a,"ignore")&&(s.ignore=a.ignore),s instanceof Displayable&&hasOwn(a,"invisible")&&(s.invisible=a.invisible),s instanceof Path&&hasOwn(a,"autoBatch")&&(s.autoBatch=a.autoBatch)}var tmpDuringScope={},transitionDuringAPI={setTransform:function(s,a){return tmpDuringScope.el[s]=a,this},getTransform:function(s){return tmpDuringScope.el[s]},setShape:function(s,a){var o=tmpDuringScope.el,c=o.shape||(o.shape={});return c[s]=a,o.dirtyShape&&o.dirtyShape(),this},getShape:function(s){var a=tmpDuringScope.el.shape;if(a)return a[s]},setStyle:function(s,a){var o=tmpDuringScope.el,c=o.style;return c&&(c[s]=a,o.dirtyStyle&&o.dirtyStyle()),this},getStyle:function(s){var a=tmpDuringScope.el.style;if(a)return a[s]},setExtra:function(s,a){var o=tmpDuringScope.el.extra||(tmpDuringScope.el.extra={});return o[s]=a,this},getExtra:function(s){var a=tmpDuringScope.el.extra;if(a)return a[s]}};function duringCall(){var s=this,a=s.el;if(a){var o=transitionInnerStore(a).userDuring,c=s.userDuring;if(o!==c){s.el=s.userDuring=null;return}tmpDuringScope.el=a,c(transitionDuringAPI)}}function prepareShapeOrExtraTransitionFrom(s,a,o,c){var d=o[s];if(d){var tt=a[s],nt;if(tt){var it=o.transition,st=d.transition;if(st)if(!nt&&(nt=c[s]={}),isTransitionAll(st))extend(nt,tt);else for(var ut=normalizeToArray(st),ct=0;ct<ut.length;ct++){var ot=ut[ct],at=tt[ot];nt[ot]=at}else if(isTransitionAll(it)||indexOf(it,s)>=0){!nt&&(nt=c[s]={});for(var ht=keys(tt),ct=0;ct<ht.length;ct++){var ot=ht[ct],at=tt[ot];isNonStyleTransitionEnabled(d[ot],at)&&(nt[ot]=at)}}}}}function prepareShapeOrExtraAllPropsFinal(s,a,o){var c=a[s];if(c)for(var d=o[s]={},tt=keys(c),nt=0;nt<tt.length;nt++){var it=tt[nt];d[it]=cloneValue(c[it])}}function prepareTransformTransitionFrom(s,a,o){for(var c=a.transition,d=isTransitionAll(c)?TRANSFORMABLE_PROPS:normalizeToArray(c||[]),tt=0;tt<d.length;tt++){var nt=d[tt];if(!(nt==="style"||nt==="shape"||nt==="extra")){var it=s[nt];o[nt]=it}}}function prepareTransformAllPropsFinal(s,a,o){for(var c=0;c<LEGACY_TRANSFORM_PROPS.length;c++){var d=LEGACY_TRANSFORM_PROPS[c],tt=LEGACY_TRANSFORM_PROPS_MAP[d],nt=a[d];nt&&(o[tt[0]]=nt[0],o[tt[1]]=nt[1])}for(var c=0;c<TRANSFORMABLE_PROPS.length;c++){var it=TRANSFORMABLE_PROPS[c];a[it]!=null&&(o[it]=a[it])}}function prepareStyleTransitionFrom(s,a,o,c){if(o){var d=s.style,tt;if(d){var nt=o.transition,it=a.transition;if(nt&&!isTransitionAll(nt)){var st=normalizeToArray(nt);!tt&&(tt=c.style={});for(var ut=0;ut<st.length;ut++){var ct=st[ut],ot=d[ct];tt[ct]=ot}}else if(s.getAnimationStyleProps&&(isTransitionAll(it)||isTransitionAll(nt)||indexOf(it,"style")>=0)){var at=s.getAnimationStyleProps(),ht=at?at.style:null;if(ht){!tt&&(tt=c.style={});for(var ft=keys(o),ut=0;ut<ft.length;ut++){var ct=ft[ut];if(ht[ct]){var ot=d[ct];tt[ct]=ot}}}}}}}function isNonStyleTransitionEnabled(s,a){return isArrayLike(s)?s!==a:s!=null&&isFinite(s)}var getStateToRestore=makeInner(),KEYFRAME_EXCLUDE_KEYS=["percent","easing","shape","style","extra"];function stopPreviousKeyframeAnimationAndRestore(s){s.stopAnimation("keyframe"),s.attr(getStateToRestore(s))}function applyKeyframeAnimation(s,a,o){if(!(!o.isAnimationEnabled()||!a)){if(isArray$1(a)){each$f(a,function(it){applyKeyframeAnimation(s,it,o)});return}var c=a.keyframes,d=a.duration;if(o&&d==null){var tt=getAnimationConfig("enter",o,0);d=tt&&tt.duration}if(!(!c||!d)){var nt=getStateToRestore(s);each$f(ELEMENT_ANIMATABLE_PROPS,function(it){if(!(it&&!s[it])){var st;c.sort(function(ut,ct){return ut.percent-ct.percent}),each$f(c,function(ut){var ct=s.animators,ot=it?ut[it]:ut;if(ot){var at=keys(ot);if(it||(at=filter(at,function(mt){return indexOf(KEYFRAME_EXCLUDE_KEYS,mt)<0})),!!at.length){st||(st=s.animate(it,a.loop,!0),st.scope="keyframe");for(var ht=0;ht<ct.length;ht++)ct[ht]!==st&&ct[ht].targetName===st.targetName&&ct[ht].stopTracks(at);it&&(nt[it]=nt[it]||{});var ft=it?nt[it]:nt;each$f(at,function(mt){ft[mt]=((it?s[it]:s)||{})[mt]}),st.whenWithKeys(d*ut.percent,ot,at,ut.easing)}}}),st&&st.delay(a.delay||0).duration(d).start(a.easing)}})}}}var EMPHASIS="emphasis",NORMAL="normal",BLUR="blur",SELECT="select",STATES=[NORMAL,EMPHASIS,BLUR,SELECT],PATH_ITEM_STYLE={normal:["itemStyle"],emphasis:[EMPHASIS,"itemStyle"],blur:[BLUR,"itemStyle"],select:[SELECT,"itemStyle"]},PATH_LABEL={normal:["label"],emphasis:[EMPHASIS,"label"],blur:[BLUR,"label"],select:[SELECT,"label"]},DEFAULT_TRANSITION=["x","y"],GROUP_DIFF_PREFIX="e\0\0",attachedTxInfoTmp={normal:{},emphasis:{},blur:{},select:{}},prepareCustoms={cartesian2d:cartesianPrepareCustom,geo:geoPrepareCustom,single:singlePrepareCustom,polar:polarPrepareCustom,calendar:calendarPrepareCustom};function isPath(s){return s instanceof Path}function isDisplayable(s){return s instanceof Displayable}function copyElement(s,a){a.copyTransform(s),isDisplayable(a)&&isDisplayable(s)&&(a.setStyle(s.style),a.z=s.z,a.z2=s.z2,a.zlevel=s.zlevel,a.invisible=s.invisible,a.ignore=s.ignore,isPath(a)&&isPath(s)&&a.setShape(s.shape))}var CustomChartView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d,tt){this._progressiveEls=null;var nt=this._data,it=o.getData(),st=this.group,ut=makeRenderItem(o,it,c,d);nt||st.removeAll(),it.diff(nt).add(function(ot){createOrUpdateItem(d,null,ot,ut(ot,tt),o,st,it)}).remove(function(ot){var at=nt.getItemGraphicEl(ot);at&&applyLeaveTransition(at,customInnerStore(at).option,o)}).update(function(ot,at){var ht=nt.getItemGraphicEl(at);createOrUpdateItem(d,ht,ot,ut(ot,tt),o,st,it)}).execute();var ct=o.get("clip",!0)?createClipPath(o.coordinateSystem,!1,o):null;ct?st.setClipPath(ct):st.removeClipPath(),this._data=it},a.prototype.incrementalPrepareRender=function(o,c,d){this.group.removeAll(),this._data=null},a.prototype.incrementalRender=function(o,c,d,tt,nt){var it=c.getData(),st=makeRenderItem(c,it,d,tt),ut=this._progressiveEls=[];function ct(ht){ht.isGroup||(ht.incremental=!0,ht.ensureState("emphasis").hoverLayer=!0)}for(var ot=o.start;ot<o.end;ot++){var at=createOrUpdateItem(null,null,ot,st(ot,nt),c,this.group,it);at&&(at.traverse(ct),ut.push(at))}},a.prototype.eachRendered=function(o){traverseElements(this._progressiveEls||this.group,o)},a.prototype.filterForExposedEvent=function(o,c,d,tt){var nt=c.element;if(nt==null||d.name===nt)return!0;for(;(d=d.__hostTarget||d.parent)&&d!==this.group;)if(d.name===nt)return!0;return!1},a.type="custom",a}(ChartView);function createEl$1(s){var a=s.type,o;if(a==="path"){var c=s.shape,d=c.width!=null&&c.height!=null?{x:c.x||0,y:c.y||0,width:c.width,height:c.height}:null,tt=getPathData(c);o=makePath(tt,null,d,c.layout||"center"),customInnerStore(o).customPathData=tt}else if(a==="image")o=new ZRImage({}),customInnerStore(o).customImagePath=s.style.image;else if(a==="text")o=new ZRText({});else if(a==="group")o=new Group$3;else{if(a==="compoundPath")throw new Error('"compoundPath" is not supported yet.');var nt=getShapeClass(a);if(!nt){var it="";throwError(it)}o=new nt}return customInnerStore(o).customGraphicType=a,o.name=s.name,o.z2EmphasisLift=1,o.z2SelectLift=1,o}function updateElNormal(s,a,o,c,d,tt,nt){stopPreviousKeyframeAnimationAndRestore(a);var it=d&&d.normal.cfg;it&&a.setTextConfig(it),c&&c.transition==null&&(c.transition=DEFAULT_TRANSITION);var st=c&&c.style;if(st){if(a.type==="text"){var ut=st;hasOwn(ut,"textFill")&&(ut.fill=ut.textFill),hasOwn(ut,"textStroke")&&(ut.stroke=ut.textStroke)}var ct=void 0,ot=isPath(a)?st.decal:null;s&&ot&&(ot.dirty=!0,ct=createOrUpdatePatternFromDecal(ot,s)),st.__decalPattern=ct}if(isDisplayable(a)&&st){var ct=st.__decalPattern;ct&&(st.decal=ct)}applyUpdateTransition(a,c,tt,{dataIndex:o,isInit:nt,clearStyle:!0}),applyKeyframeAnimation(a,c.keyframeAnimation,tt)}function updateElOnState(s,a,o,c,d){var tt=a.isGroup?null:a,nt=d&&d[s].cfg;if(tt){var it=tt.ensureState(s);if(c===!1){var st=tt.getState(s);st&&(st.style=null)}else it.style=c||null;nt&&(it.textConfig=nt),setDefaultStateProxy(tt)}}function updateZ(s,a,o){if(!s.isGroup){var c=s,d=o.currentZ,tt=o.currentZLevel;c.z=d,c.zlevel=tt;var nt=a.z2;nt!=null&&(c.z2=nt||0);for(var it=0;it<STATES.length;it++)updateZForEachState(c,a,STATES[it])}}function updateZForEachState(s,a,o){var c=o===NORMAL,d=c?a:retrieveStateOption(a,o),tt=d?d.z2:null,nt;tt!=null&&(nt=c?s:s.ensureState(o),nt.z2=tt||0)}function makeRenderItem(s,a,o,c){var d=s.get("renderItem"),tt=s.coordinateSystem,nt={};tt&&(nt=tt.prepareCustoms?tt.prepareCustoms(tt):prepareCustoms[tt.type](tt));for(var it=defaults({getWidth:c.getWidth,getHeight:c.getHeight,getZr:c.getZr,getDevicePixelRatio:c.getDevicePixelRatio,value:Ct,style:Ot,ordinalRawValue:Dt,styleEmphasis:$t,visual:Vt,barLayout:Ht,currentSeriesIndices:Qt,font:Xt},nt.api||{}),st={context:{},seriesId:s.id,seriesName:s.name,seriesIndex:s.seriesIndex,coordSys:nt.coordSys,dataInsideLength:a.count(),encode:wrapEncodeDef(s.getData())},ut,ct,ot={},at={},ht={},ft={},mt=0;mt<STATES.length;mt++){var yt=STATES[mt];ht[yt]=s.getModel(PATH_ITEM_STYLE[yt]),ft[yt]=s.getModel(PATH_LABEL[yt])}function bt(Zt){return Zt===ut?ct||(ct=a.getItemModel(Zt)):a.getItemModel(Zt)}function wt(Zt,ar){return a.hasItemOption?Zt===ut?ot[ar]||(ot[ar]=bt(Zt).getModel(PATH_ITEM_STYLE[ar])):bt(Zt).getModel(PATH_ITEM_STYLE[ar]):ht[ar]}function Tt(Zt,ar){return a.hasItemOption?Zt===ut?at[ar]||(at[ar]=bt(Zt).getModel(PATH_LABEL[ar])):bt(Zt).getModel(PATH_LABEL[ar]):ft[ar]}return function(Zt,ar){return ut=Zt,ct=null,ot={},at={},d&&d(defaults({dataIndexInside:Zt,dataIndex:a.getRawIndex(Zt),actionType:ar?ar.type:null},st),it)};function Ct(Zt,ar){return ar==null&&(ar=ut),a.getStore().get(a.getDimensionIndex(Zt||0),ar)}function Dt(Zt,ar){ar==null&&(ar=ut),Zt=Zt||0;var nr=a.getDimensionInfo(Zt);if(!nr){var cr=a.getDimensionIndex(Zt);return cr>=0?a.getStore().get(cr,ar):void 0}var dr=a.get(nr.name,ar),mr=nr&&nr.ordinalMeta;return mr?mr.categories[dr]:dr}function Ot(Zt,ar){ar==null&&(ar=ut);var nr=a.getItemVisual(ar,"style"),cr=nr&&nr.fill,dr=nr&&nr.opacity,mr=wt(ar,NORMAL).getItemStyle();cr!=null&&(mr.fill=cr),dr!=null&&(mr.opacity=dr);var Dr={inheritColor:isString$1(cr)?cr:"#000"},kr=Tt(ar,NORMAL),Yr=createTextStyle$1(kr,null,Dr,!1,!0);Yr.text=kr.getShallow("show")?retrieve2(s.getFormattedLabel(ar,NORMAL),getDefaultLabel(a,ar)):null;var Mr=createTextConfig(kr,Dr,!1);return kt(Zt,mr),mr=convertToEC4StyleForCustomSerise(mr,Yr,Mr),Zt&&Ft(mr,Zt),mr.legacy=!0,mr}function $t(Zt,ar){ar==null&&(ar=ut);var nr=wt(ar,EMPHASIS).getItemStyle(),cr=Tt(ar,EMPHASIS),dr=createTextStyle$1(cr,null,null,!0,!0);dr.text=cr.getShallow("show")?retrieve3(s.getFormattedLabel(ar,EMPHASIS),s.getFormattedLabel(ar,NORMAL),getDefaultLabel(a,ar)):null;var mr=createTextConfig(cr,null,!0);return kt(Zt,nr),nr=convertToEC4StyleForCustomSerise(nr,dr,mr),Zt&&Ft(nr,Zt),nr.legacy=!0,nr}function Ft(Zt,ar){for(var nr in ar)hasOwn(ar,nr)&&(Zt[nr]=ar[nr])}function kt(Zt,ar){Zt&&(Zt.textFill&&(ar.textFill=Zt.textFill),Zt.textPosition&&(ar.textPosition=Zt.textPosition))}function Vt(Zt,ar){if(ar==null&&(ar=ut),hasOwn(STYLE_VISUAL_TYPE,Zt)){var nr=a.getItemVisual(ar,"style");return nr?nr[STYLE_VISUAL_TYPE[Zt]]:null}if(hasOwn(NON_STYLE_VISUAL_PROPS,Zt))return a.getItemVisual(ar,Zt)}function Ht(Zt){if(tt.type==="cartesian2d"){var ar=tt.getBaseAxis();return getLayoutOnAxis(defaults({axis:ar},Zt))}}function Qt(){return o.getCurrentSeriesIndices()}function Xt(Zt){return getFont(Zt,o)}}function wrapEncodeDef(s){var a={};return each$f(s.dimensions,function(o){var c=s.getDimensionInfo(o);if(!c.isExtraCoord){var d=c.coordDim,tt=a[d]=a[d]||[];tt[c.coordDimIndex]=s.getDimensionIndex(o)}}),a}function createOrUpdateItem(s,a,o,c,d,tt,nt){if(!c){tt.remove(a);return}var it=doCreateOrUpdateEl(s,a,o,c,d,tt);return it&&nt.setItemGraphicEl(o,it),it&&toggleHoverEmphasis(it,c.focus,c.blurScope,c.emphasisDisabled),it}function doCreateOrUpdateEl(s,a,o,c,d,tt){var nt=-1,it=a;a&&doesElNeedRecreate(a,c,d)&&(nt=indexOf(tt.childrenRef(),a),a=null);var st=!a,ut=a;ut?ut.clearStates():(ut=createEl$1(c),it&&copyElement(it,ut)),c.morph===!1?ut.disableMorphing=!0:ut.disableMorphing&&(ut.disableMorphing=!1),attachedTxInfoTmp.normal.cfg=attachedTxInfoTmp.normal.conOpt=attachedTxInfoTmp.emphasis.cfg=attachedTxInfoTmp.emphasis.conOpt=attachedTxInfoTmp.blur.cfg=attachedTxInfoTmp.blur.conOpt=attachedTxInfoTmp.select.cfg=attachedTxInfoTmp.select.conOpt=null,attachedTxInfoTmp.isLegacy=!1,doCreateOrUpdateAttachedTx(ut,o,c,d,st,attachedTxInfoTmp),doCreateOrUpdateClipPath(ut,o,c,d,st),updateElNormal(s,ut,o,c,attachedTxInfoTmp,d,st),hasOwn(c,"info")&&(customInnerStore(ut).info=c.info);for(var ct=0;ct<STATES.length;ct++){var ot=STATES[ct];if(ot!==NORMAL){var at=retrieveStateOption(c,ot),ht=retrieveStyleOptionOnState(c,at,ot);updateElOnState(ot,ut,at,ht,attachedTxInfoTmp)}}return updateZ(ut,c,d),c.type==="group"&&mergeChildren(s,ut,o,c,d),nt>=0?tt.replaceAt(ut,nt):tt.add(ut),ut}function doesElNeedRecreate(s,a,o){var c=customInnerStore(s),d=a.type,tt=a.shape,nt=a.style;return o.isUniversalTransitionEnabled()||d!=null&&d!==c.customGraphicType||d==="path"&&hasOwnPathData(tt)&&getPathData(tt)!==c.customPathData||d==="image"&&hasOwn(nt,"image")&&nt.image!==c.customImagePath}function doCreateOrUpdateClipPath(s,a,o,c,d){var tt=o.clipPath;if(tt===!1)s&&s.getClipPath()&&s.removeClipPath();else if(tt){var nt=s.getClipPath();nt&&doesElNeedRecreate(nt,tt,c)&&(nt=null),nt||(nt=createEl$1(tt),s.setClipPath(nt)),updateElNormal(null,nt,a,tt,null,c,d)}}function doCreateOrUpdateAttachedTx(s,a,o,c,d,tt){if(!s.isGroup){processTxInfo(o,null,tt),processTxInfo(o,EMPHASIS,tt);var nt=tt.normal.conOpt,it=tt.emphasis.conOpt,st=tt.blur.conOpt,ut=tt.select.conOpt;if(nt!=null||it!=null||ut!=null||st!=null){var ct=s.getTextContent();if(nt===!1)ct&&s.removeTextContent();else{nt=tt.normal.conOpt=nt||{type:"text"},ct?ct.clearStates():(ct=createEl$1(nt),s.setTextContent(ct)),updateElNormal(null,ct,a,nt,null,c,d);for(var ot=nt&&nt.style,at=0;at<STATES.length;at++){var ht=STATES[at];if(ht!==NORMAL){var ft=tt[ht].conOpt;updateElOnState(ht,ct,ft,retrieveStyleOptionOnState(nt,ft,ht),null)}}ot?ct.dirty():ct.markRedraw()}}}}function processTxInfo(s,a,o){var c=a?retrieveStateOption(s,a):s,d=a?retrieveStyleOptionOnState(s,c,EMPHASIS):s.style,tt=s.type,nt=c?c.textConfig:null,it=s.textContent,st=it?a?retrieveStateOption(it,a):it:null;if(d&&(o.isLegacy||isEC4CompatibleStyle(d,tt,!!nt,!!st))){o.isLegacy=!0;var ut=convertFromEC4CompatibleStyle(d,tt,!a);!nt&&ut.textConfig&&(nt=ut.textConfig),!st&&ut.textContent&&(st=ut.textContent)}if(!a&&st){var ct=st;!ct.type&&(ct.type="text")}var ot=a?o[a]:o.normal;ot.cfg=nt,ot.conOpt=st}function retrieveStateOption(s,a){return a?s?s[a]:null:s}function retrieveStyleOptionOnState(s,a,o){var c=a&&a.style;return c==null&&o===EMPHASIS&&s&&(c=s.styleEmphasis),c}function mergeChildren(s,a,o,c,d){var tt=c.children,nt=tt?tt.length:0,it=c.$mergeChildren,st=it==="byName"||c.diffChildrenByName,ut=it===!1;if(!(!nt&&!st&&!ut)){if(st){diffGroupChildren({api:s,oldChildren:a.children()||[],newChildren:tt||[],dataIndex:o,seriesModel:d,group:a});return}ut&&a.removeAll();for(var ct=0;ct<nt;ct++){var ot=tt[ct],at=a.childAt(ct);ot?(ot.ignore==null&&(ot.ignore=!1),doCreateOrUpdateEl(s,at,o,ot,d,a)):at.ignore=!0}for(var ht=a.childCount()-1;ht>=ct;ht--){var ft=a.childAt(ht);removeChildFromGroup(a,ft,d)}}}function removeChildFromGroup(s,a,o){a&&applyLeaveTransition(a,customInnerStore(s).option,o)}function diffGroupChildren(s){new DataDiffer(s.oldChildren,s.newChildren,getKey,getKey,s).add(processAddUpdate).update(processAddUpdate).remove(processRemove).execute()}function getKey(s,a){var o=s&&s.name;return o??GROUP_DIFF_PREFIX+a}function processAddUpdate(s,a){var o=this.context,c=s!=null?o.newChildren[s]:null,d=a!=null?o.oldChildren[a]:null;doCreateOrUpdateEl(o.api,d,o.dataIndex,c,o.seriesModel,o.group)}function processRemove(s){var a=this.context,o=a.oldChildren[s];o&&applyLeaveTransition(o,customInnerStore(o).option,a.seriesModel)}function getPathData(s){return s&&(s.pathData||s.d)}function hasOwnPathData(s){return s&&(hasOwn(s,"pathData")||hasOwn(s,"d"))}function install$r(s){s.registerChartView(CustomChartView),s.registerSeriesModel(CustomSeriesModel)}var inner$b=makeInner(),clone$1=clone$4,bind$1=bind$2,BaseAxisPointer=function(){function s(){this._dragging=!1,this.animationThreshold=15}return s.prototype.render=function(a,o,c,d){var tt=o.get("value"),nt=o.get("status");if(this._axisModel=a,this._axisPointerModel=o,this._api=c,!(!d&&this._lastValue===tt&&this._lastStatus===nt)){this._lastValue=tt,this._lastStatus=nt;var it=this._group,st=this._handle;if(!nt||nt==="hide"){it&&it.hide(),st&&st.hide();return}it&&it.show(),st&&st.show();var ut={};this.makeElOption(ut,tt,a,o,c);var ct=ut.graphicKey;ct!==this._lastGraphicKey&&this.clear(c),this._lastGraphicKey=ct;var ot=this._moveAnimation=this.determineAnimation(a,o);if(!it)it=this._group=new Group$3,this.createPointerEl(it,ut,a,o),this.createLabelEl(it,ut,a,o),c.getZr().add(it);else{var at=curry$1(updateProps,o,ot);this.updatePointerEl(it,ut,at),this.updateLabelEl(it,ut,at,o)}updateMandatoryProps(it,o,!0),this._renderHandle(tt)}},s.prototype.remove=function(a){this.clear(a)},s.prototype.dispose=function(a){this.clear(a)},s.prototype.determineAnimation=function(a,o){var c=o.get("animation"),d=a.axis,tt=d.type==="category",nt=o.get("snap");if(!nt&&!tt)return!1;if(c==="auto"||c==null){var it=this.animationThreshold;if(tt&&d.getBandWidth()>it)return!0;if(nt){var st=getAxisInfo$1(a).seriesDataCount,ut=d.getExtent();return Math.abs(ut[0]-ut[1])/st>it}return!1}return c===!0},s.prototype.makeElOption=function(a,o,c,d,tt){},s.prototype.createPointerEl=function(a,o,c,d){var tt=o.pointer;if(tt){var nt=inner$b(a).pointerEl=new graphic$1[tt.type](clone$1(o.pointer));a.add(nt)}},s.prototype.createLabelEl=function(a,o,c,d){if(o.label){var tt=inner$b(a).labelEl=new ZRText(clone$1(o.label));a.add(tt),updateLabelShowHide(tt,d)}},s.prototype.updatePointerEl=function(a,o,c){var d=inner$b(a).pointerEl;d&&o.pointer&&(d.setStyle(o.pointer.style),c(d,{shape:o.pointer.shape}))},s.prototype.updateLabelEl=function(a,o,c,d){var tt=inner$b(a).labelEl;tt&&(tt.setStyle(o.label.style),c(tt,{x:o.label.x,y:o.label.y}),updateLabelShowHide(tt,d))},s.prototype._renderHandle=function(a){if(!(this._dragging||!this.updateHandleTransform)){var o=this._axisPointerModel,c=this._api.getZr(),d=this._handle,tt=o.getModel("handle"),nt=o.get("status");if(!tt.get("show")||!nt||nt==="hide"){d&&c.remove(d),this._handle=null;return}var it;this._handle||(it=!0,d=this._handle=createIcon(tt.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(ut){stop(ut.event)},onmousedown:bind$1(this._onHandleDragMove,this,0,0),drift:bind$1(this._onHandleDragMove,this),ondragend:bind$1(this._onHandleDragEnd,this)}),c.add(d)),updateMandatoryProps(d,o,!1),d.setStyle(tt.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var st=tt.get("size");isArray$1(st)||(st=[st,st]),d.scaleX=st[0]/2,d.scaleY=st[1]/2,createOrUpdate(this,"_doDispatchAxisPointer",tt.get("throttle")||0,"fixRate"),this._moveHandleToValue(a,it)}},s.prototype._moveHandleToValue=function(a,o){updateProps(this._axisPointerModel,!o&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(a,this._axisModel,this._axisPointerModel)))},s.prototype._onHandleDragMove=function(a,o){var c=this._handle;if(c){this._dragging=!0;var d=this.updateHandleTransform(getHandleTransProps(c),[a,o],this._axisModel,this._axisPointerModel);this._payloadInfo=d,c.stopAnimation(),c.attr(getHandleTransProps(d)),inner$b(c).lastProp=null,this._doDispatchAxisPointer()}},s.prototype._doDispatchAxisPointer=function(){var a=this._handle;if(a){var o=this._payloadInfo,c=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:o.cursorPoint[0],y:o.cursorPoint[1],tooltipOption:o.tooltipOption,axesInfo:[{axisDim:c.axis.dim,axisIndex:c.componentIndex}]})}},s.prototype._onHandleDragEnd=function(){this._dragging=!1;var a=this._handle;if(a){var o=this._axisPointerModel.get("value");this._moveHandleToValue(o),this._api.dispatchAction({type:"hideTip"})}},s.prototype.clear=function(a){this._lastValue=null,this._lastStatus=null;var o=a.getZr(),c=this._group,d=this._handle;o&&c&&(this._lastGraphicKey=null,c&&o.remove(c),d&&o.remove(d),this._group=null,this._handle=null,this._payloadInfo=null),clear$2(this,"_doDispatchAxisPointer")},s.prototype.doClear=function(){},s.prototype.buildLabel=function(a,o,c){return c=c||0,{x:a[c],y:a[1-c],width:o[c],height:o[1-c]}},s}();function updateProps(s,a,o,c){propsEqual(inner$b(o).lastProp,c)||(inner$b(o).lastProp=c,a?updateProps$1(o,c,s):(o.stopAnimation(),o.attr(c)))}function propsEqual(s,a){if(isObject$3(s)&&isObject$3(a)){var o=!0;return each$f(a,function(c,d){o=o&&propsEqual(s[d],c)}),!!o}else return s===a}function updateLabelShowHide(s,a){s[a.get(["label","show"])?"show":"hide"]()}function getHandleTransProps(s){return{x:s.x||0,y:s.y||0,rotation:s.rotation||0}}function updateMandatoryProps(s,a,o){var c=a.get("z"),d=a.get("zlevel");s&&s.traverse(function(tt){tt.type!=="group"&&(c!=null&&(tt.z=c),d!=null&&(tt.zlevel=d),tt.silent=o)})}function buildElStyle(s){var a=s.get("type"),o=s.getModel(a+"Style"),c;return a==="line"?(c=o.getLineStyle(),c.fill=null):a==="shadow"&&(c=o.getAreaStyle(),c.stroke=null),c}function buildLabelElOption(s,a,o,c,d){var tt=o.get("value"),nt=getValueLabel(tt,a.axis,a.ecModel,o.get("seriesDataIndices"),{precision:o.get(["label","precision"]),formatter:o.get(["label","formatter"])}),it=o.getModel("label"),st=normalizeCssArray(it.get("padding")||0),ut=it.getFont(),ct=getBoundingRect(nt,ut),ot=d.position,at=ct.width+st[1]+st[3],ht=ct.height+st[0]+st[2],ft=d.align;ft==="right"&&(ot[0]-=at),ft==="center"&&(ot[0]-=at/2);var mt=d.verticalAlign;mt==="bottom"&&(ot[1]-=ht),mt==="middle"&&(ot[1]-=ht/2),confineInContainer(ot,at,ht,c);var yt=it.get("backgroundColor");(!yt||yt==="auto")&&(yt=a.get(["axisLine","lineStyle","color"])),s.label={x:ot[0],y:ot[1],style:createTextStyle$1(it,{text:nt,font:ut,fill:it.getTextColor(),padding:st,backgroundColor:yt}),z2:10}}function confineInContainer(s,a,o,c){var d=c.getWidth(),tt=c.getHeight();s[0]=Math.min(s[0]+a,d)-a,s[1]=Math.min(s[1]+o,tt)-o,s[0]=Math.max(s[0],0),s[1]=Math.max(s[1],0)}function getValueLabel(s,a,o,c,d){s=a.scale.parse(s);var tt=a.scale.getLabel({value:s},{precision:d.precision}),nt=d.formatter;if(nt){var it={value:getAxisRawValue(a,{value:s}),axisDimension:a.dim,axisIndex:a.index,seriesData:[]};each$f(c,function(st){var ut=o.getSeriesByIndex(st.seriesIndex),ct=st.dataIndexInside,ot=ut&&ut.getDataParams(ct);ot&&it.seriesData.push(ot)}),isString$1(nt)?tt=nt.replace("{value}",tt):isFunction$1(nt)&&(tt=nt(it))}return tt}function getTransformedPosition(s,a,o){var c=create$1();return rotate$1(c,c,o.rotation),translate(c,c,o.position),applyTransform([s.dataToCoord(a),(o.labelOffset||0)+(o.labelDirection||1)*(o.labelMargin||0)],c)}function buildCartesianSingleLabelElOption(s,a,o,c,d,tt){var nt=AxisBuilder.innerTextLayout(o.rotation,0,o.labelDirection);o.labelMargin=d.get(["label","margin"]),buildLabelElOption(a,c,d,tt,{position:getTransformedPosition(c.axis,s,o),align:nt.textAlign,verticalAlign:nt.textVerticalAlign})}function makeLineShape(s,a,o){return o=o||0,{x1:s[o],y1:s[1-o],x2:a[o],y2:a[1-o]}}function makeRectShape(s,a,o){return o=o||0,{x:s[o],y:s[1-o],width:a[o],height:a[1-o]}}function makeSectorShape(s,a,o,c,d,tt){return{cx:s,cy:a,r0:o,r:c,startAngle:d,endAngle:tt,clockwise:!0}}var CartesianAxisPointer=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.makeElOption=function(o,c,d,tt,nt){var it=d.axis,st=it.grid,ut=tt.get("type"),ct=getCartesian(st,it).getOtherAxis(it).getGlobalExtent(),ot=it.toGlobalCoord(it.dataToCoord(c,!0));if(ut&&ut!=="none"){var at=buildElStyle(tt),ht=pointerShapeBuilder$2[ut](it,ot,ct);ht.style=at,o.graphicKey=ht.type,o.pointer=ht}var ft=layout$2(st.model,d);buildCartesianSingleLabelElOption(c,o,ft,d,tt,nt)},a.prototype.getHandleTransform=function(o,c,d){var tt=layout$2(c.axis.grid.model,c,{labelInside:!1});tt.labelMargin=d.get(["handle","margin"]);var nt=getTransformedPosition(c.axis,o,tt);return{x:nt[0],y:nt[1],rotation:tt.rotation+(tt.labelDirection<0?Math.PI:0)}},a.prototype.updateHandleTransform=function(o,c,d,tt){var nt=d.axis,it=nt.grid,st=nt.getGlobalExtent(!0),ut=getCartesian(it,nt).getOtherAxis(nt).getGlobalExtent(),ct=nt.dim==="x"?0:1,ot=[o.x,o.y];ot[ct]+=c[ct],ot[ct]=Math.min(st[1],ot[ct]),ot[ct]=Math.max(st[0],ot[ct]);var at=(ut[1]+ut[0])/2,ht=[at,at];ht[ct]=ot[ct];var ft=[{verticalAlign:"middle"},{align:"center"}];return{x:ot[0],y:ot[1],rotation:o.rotation,cursorPoint:ht,tooltipOption:ft[ct]}},a}(BaseAxisPointer);function getCartesian(s,a){var o={};return o[a.dim+"AxisIndex"]=a.index,s.getCartesian(o)}var pointerShapeBuilder$2={line:function(s,a,o){var c=makeLineShape([a,o[0]],[a,o[1]],getAxisDimIndex(s));return{type:"Line",subPixelOptimize:!0,shape:c}},shadow:function(s,a,o){var c=Math.max(1,s.getBandWidth()),d=o[1]-o[0];return{type:"Rect",shape:makeRectShape([a-c/2,o[0]],[c,d],getAxisDimIndex(s))}}};function getAxisDimIndex(s){return s.dim==="x"?0:1}var AxisPointerModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="axisPointer",a.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},a}(ComponentModel),inner$a=makeInner(),each$8=each$f;function register(s,a,o){if(!env.node){var c=a.getZr();inner$a(c).records||(inner$a(c).records={}),initGlobalListeners(c,a);var d=inner$a(c).records[s]||(inner$a(c).records[s]={});d.handler=o}}function initGlobalListeners(s,a){if(inner$a(s).initialized)return;inner$a(s).initialized=!0,o("click",curry$1(doEnter,"click")),o("mousemove",curry$1(doEnter,"mousemove")),o("globalout",onLeave);function o(c,d){s.on(c,function(tt){var nt=makeDispatchAction$1(a);each$8(inner$a(s).records,function(it){it&&d(it,tt,nt.dispatchAction)}),dispatchTooltipFinally(nt.pendings,a)})}}function dispatchTooltipFinally(s,a){var o=s.showTip.length,c=s.hideTip.length,d;o?d=s.showTip[o-1]:c&&(d=s.hideTip[c-1]),d&&(d.dispatchAction=null,a.dispatchAction(d))}function onLeave(s,a,o){s.handler("leave",null,o)}function doEnter(s,a,o,c){a.handler(s,o,c)}function makeDispatchAction$1(s){var a={showTip:[],hideTip:[]},o=function(c){var d=a[c.type];d?d.push(c):(c.dispatchAction=o,s.dispatchAction(c))};return{dispatchAction:o,pendings:a}}function unregister(s,a){if(!env.node){var o=a.getZr(),c=(inner$a(o).records||{})[s];c&&(inner$a(o).records[s]=null)}}var AxisPointerView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=c.getComponent("tooltip"),nt=o.get("triggerOn")||tt&&tt.get("triggerOn")||"mousemove|click";register("axisPointer",d,function(it,st,ut){nt!=="none"&&(it==="leave"||nt.indexOf(it)>=0)&&ut({type:"updateAxisPointer",currTrigger:it,x:st&&st.offsetX,y:st&&st.offsetY})})},a.prototype.remove=function(o,c){unregister("axisPointer",c)},a.prototype.dispose=function(o,c){unregister("axisPointer",c)},a.type="axisPointer",a}(ComponentView);function findPointFromSeries(s,a){var o=[],c=s.seriesIndex,d;if(c==null||!(d=a.getSeriesByIndex(c)))return{point:[]};var tt=d.getData(),nt=queryDataIndex(tt,s);if(nt==null||nt<0||isArray$1(nt))return{point:[]};var it=tt.getItemGraphicEl(nt),st=d.coordinateSystem;if(d.getTooltipPosition)o=d.getTooltipPosition(nt)||[];else if(st&&st.dataToPoint)if(s.isStacked){var ut=st.getBaseAxis(),ct=st.getOtherAxis(ut),ot=ct.dim,at=ut.dim,ht=ot==="x"||ot==="radius"?1:0,ft=tt.mapDimension(at),mt=[];mt[ht]=tt.get(ft,nt),mt[1-ht]=tt.get(tt.getCalculationInfo("stackResultDimension"),nt),o=st.dataToPoint(mt)||[]}else o=st.dataToPoint(tt.getValues(map$1(st.dimensions,function(bt){return tt.mapDimension(bt)}),nt))||[];else if(it){var yt=it.getBoundingRect().clone();yt.applyTransform(it.transform),o=[yt.x+yt.width/2,yt.y+yt.height/2]}return{point:o,el:it}}var inner$9=makeInner();function axisTrigger(s,a,o){var c=s.currTrigger,d=[s.x,s.y],tt=s,nt=s.dispatchAction||bind$2(o.dispatchAction,o),it=a.getComponent("axisPointer").coordSysAxesInfo;if(it){illegalPoint(d)&&(d=findPointFromSeries({seriesIndex:tt.seriesIndex,dataIndex:tt.dataIndex},a).point);var st=illegalPoint(d),ut=tt.axesInfo,ct=it.axesInfo,ot=c==="leave"||illegalPoint(d),at={},ht={},ft={list:[],map:{}},mt={showPointer:curry$1(showPointer,ht),showTooltip:curry$1(showTooltip,ft)};each$f(it.coordSysMap,function(bt,wt){var Tt=st||bt.containPoint(d);each$f(it.coordSysAxesInfo[wt],function(Ct,Dt){var Ot=Ct.axis,$t=findInputAxisInfo(ut,Ct);if(!ot&&Tt&&(!ut||$t)){var Ft=$t&&$t.value;Ft==null&&!st&&(Ft=Ot.pointToData(d)),Ft!=null&&processOnAxis(Ct,Ft,mt,!1,at)}})});var yt={};return each$f(ct,function(bt,wt){var Tt=bt.linkGroup;Tt&&!ht[wt]&&each$f(Tt.axesInfo,function(Ct,Dt){var Ot=ht[Dt];if(Ct!==bt&&Ot){var $t=Ot.value;Tt.mapper&&($t=bt.axis.scale.parse(Tt.mapper($t,makeMapperParam(Ct),makeMapperParam(bt)))),yt[bt.key]=$t}})}),each$f(yt,function(bt,wt){processOnAxis(ct[wt],bt,mt,!0,at)}),updateModelActually(ht,ct,at),dispatchTooltipActually(ft,d,s,nt),dispatchHighDownActually(ct,nt,o),at}}function processOnAxis(s,a,o,c,d){var tt=s.axis;if(!(tt.scale.isBlank()||!tt.containData(a))){if(!s.involveSeries){o.showPointer(s,a);return}var nt=buildPayloadsBySeries(a,s),it=nt.payloadBatch,st=nt.snapToValue;it[0]&&d.seriesIndex==null&&extend(d,it[0]),!c&&s.snap&&tt.containData(st)&&st!=null&&(a=st),o.showPointer(s,a,it),o.showTooltip(s,nt,st)}}function buildPayloadsBySeries(s,a){var o=a.axis,c=o.dim,d=s,tt=[],nt=Number.MAX_VALUE,it=-1;return each$f(a.seriesModels,function(st,ut){var ct=st.getData().mapDimensionsAll(c),ot,at;if(st.getAxisTooltipData){var ht=st.getAxisTooltipData(ct,s,o);at=ht.dataIndices,ot=ht.nestestValue}else{if(at=st.getData().indicesOfNearest(ct[0],s,o.type==="category"?.5:null),!at.length)return;ot=st.getData().get(ct[0],at[0])}if(!(ot==null||!isFinite(ot))){var ft=s-ot,mt=Math.abs(ft);mt<=nt&&((mt<nt||ft>=0&&it<0)&&(nt=mt,it=ft,d=ot,tt.length=0),each$f(at,function(yt){tt.push({seriesIndex:st.seriesIndex,dataIndexInside:yt,dataIndex:st.getData().getRawIndex(yt)})}))}}),{payloadBatch:tt,snapToValue:d}}function showPointer(s,a,o,c){s[a.key]={value:o,payloadBatch:c}}function showTooltip(s,a,o,c){var d=o.payloadBatch,tt=a.axis,nt=tt.model,it=a.axisPointerModel;if(!(!a.triggerTooltip||!d.length)){var st=a.coordSys.model,ut=makeKey(st),ct=s.map[ut];ct||(ct=s.map[ut]={coordSysId:st.id,coordSysIndex:st.componentIndex,coordSysType:st.type,coordSysMainType:st.mainType,dataByAxis:[]},s.list.push(ct)),ct.dataByAxis.push({axisDim:tt.dim,axisIndex:nt.componentIndex,axisType:nt.type,axisId:nt.id,value:c,valueLabelOpt:{precision:it.get(["label","precision"]),formatter:it.get(["label","formatter"])},seriesDataIndices:d.slice()})}}function updateModelActually(s,a,o){var c=o.axesInfo=[];each$f(a,function(d,tt){var nt=d.axisPointerModel.option,it=s[tt];it?(!d.useHandle&&(nt.status="show"),nt.value=it.value,nt.seriesDataIndices=(it.payloadBatch||[]).slice()):!d.useHandle&&(nt.status="hide"),nt.status==="show"&&c.push({axisDim:d.axis.dim,axisIndex:d.axis.model.componentIndex,value:nt.value})})}function dispatchTooltipActually(s,a,o,c){if(illegalPoint(a)||!s.list.length){c({type:"hideTip"});return}var d=((s.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};c({type:"showTip",escapeConnect:!0,x:a[0],y:a[1],tooltipOption:o.tooltipOption,position:o.position,dataIndexInside:d.dataIndexInside,dataIndex:d.dataIndex,seriesIndex:d.seriesIndex,dataByCoordSys:s.list})}function dispatchHighDownActually(s,a,o){var c=o.getZr(),d="axisPointerLastHighlights",tt=inner$9(c)[d]||{},nt=inner$9(c)[d]={};each$f(s,function(ut,ct){var ot=ut.axisPointerModel.option;ot.status==="show"&&ut.triggerEmphasis&&each$f(ot.seriesDataIndices,function(at){var ht=at.seriesIndex+" | "+at.dataIndex;nt[ht]=at})});var it=[],st=[];each$f(tt,function(ut,ct){!nt[ct]&&st.push(ut)}),each$f(nt,function(ut,ct){!tt[ct]&&it.push(ut)}),st.length&&o.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:st}),it.length&&o.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:it})}function findInputAxisInfo(s,a){for(var o=0;o<(s||[]).length;o++){var c=s[o];if(a.axis.dim===c.axisDim&&a.axis.model.componentIndex===c.axisIndex)return c}}function makeMapperParam(s){var a=s.axis.model,o={},c=o.axisDim=s.axis.dim;return o.axisIndex=o[c+"AxisIndex"]=a.componentIndex,o.axisName=o[c+"AxisName"]=a.name,o.axisId=o[c+"AxisId"]=a.id,o}function illegalPoint(s){return!s||s[0]==null||isNaN(s[0])||s[1]==null||isNaN(s[1])}function install$q(s){AxisView.registerAxisPointerClass("CartesianAxisPointer",CartesianAxisPointer),s.registerComponentModel(AxisPointerModel),s.registerComponentView(AxisPointerView),s.registerPreprocessor(function(a){if(a){(!a.axisPointer||a.axisPointer.length===0)&&(a.axisPointer={});var o=a.axisPointer.link;o&&!isArray$1(o)&&(a.axisPointer.link=[o])}}),s.registerProcessor(s.PRIORITY.PROCESSOR.STATISTIC,function(a,o){a.getComponent("axisPointer").coordSysAxesInfo=collect(a,o)}),s.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},axisTrigger)}function install$p(s){use(install$N),use(install$q)}var PolarAxisPointer=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.makeElOption=function(o,c,d,tt,nt){var it=d.axis;it.dim==="angle"&&(this.animationThreshold=Math.PI/18);var st=it.polar,ut=st.getOtherAxis(it),ct=ut.getExtent(),ot=it.dataToCoord(c),at=tt.get("type");if(at&&at!=="none"){var ht=buildElStyle(tt),ft=pointerShapeBuilder$1[at](it,st,ot,ct);ft.style=ht,o.graphicKey=ft.type,o.pointer=ft}var mt=tt.get(["label","margin"]),yt=getLabelPosition(c,d,tt,st,mt);buildLabelElOption(o,d,tt,nt,yt)},a}(BaseAxisPointer);function getLabelPosition(s,a,o,c,d){var tt=a.axis,nt=tt.dataToCoord(s),it=c.getAngleAxis().getExtent()[0];it=it/180*Math.PI;var st=c.getRadiusAxis().getExtent(),ut,ct,ot;if(tt.dim==="radius"){var at=create$1();rotate$1(at,at,it),translate(at,at,[c.cx,c.cy]),ut=applyTransform([nt,-d],at);var ht=a.getModel("axisLabel").get("rotate")||0,ft=AxisBuilder.innerTextLayout(it,ht*Math.PI/180,-1);ct=ft.textAlign,ot=ft.textVerticalAlign}else{var mt=st[1];ut=c.coordToPoint([mt+d,nt]);var yt=c.cx,bt=c.cy;ct=Math.abs(ut[0]-yt)/mt<.3?"center":ut[0]>yt?"left":"right",ot=Math.abs(ut[1]-bt)/mt<.3?"middle":ut[1]>bt?"top":"bottom"}return{position:ut,align:ct,verticalAlign:ot}}var pointerShapeBuilder$1={line:function(s,a,o,c){return s.dim==="angle"?{type:"Line",shape:makeLineShape(a.coordToPoint([c[0],o]),a.coordToPoint([c[1],o]))}:{type:"Circle",shape:{cx:a.cx,cy:a.cy,r:o}}},shadow:function(s,a,o,c){var d=Math.max(1,s.getBandWidth()),tt=Math.PI/180;return s.dim==="angle"?{type:"Sector",shape:makeSectorShape(a.cx,a.cy,c[0],c[1],(-o-d/2)*tt,(-o+d/2)*tt)}:{type:"Sector",shape:makeSectorShape(a.cx,a.cy,o-d/2,o+d/2,0,Math.PI*2)}}},PolarModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.findAxisModel=function(o){var c,d=this.ecModel;return d.eachComponent(o,function(tt){tt.getCoordSysModel()===this&&(c=tt)},this),c},a.type="polar",a.dependencies=["radiusAxis","angleAxis"],a.defaultOption={z:0,center:["50%","50%"],radius:"80%"},a}(ComponentModel),PolarAxisModel=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",SINGLE_REFERRING).models[0]},a.type="polarAxis",a}(ComponentModel);mixin(PolarAxisModel,AxisModelCommonMixin);var AngleAxisModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="angleAxis",a}(PolarAxisModel),RadiusAxisModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="radiusAxis",a}(PolarAxisModel),RadiusAxis=function(s){__extends$1(a,s);function a(o,c){return s.call(this,"radius",o,c)||this}return a.prototype.pointToData=function(o,c){return this.polar.pointToData(o,c)[this.dim==="radius"?0:1]},a}(Axis);RadiusAxis.prototype.dataToRadius=Axis.prototype.dataToCoord;RadiusAxis.prototype.radiusToData=Axis.prototype.coordToData;var inner$8=makeInner(),AngleAxis=function(s){__extends$1(a,s);function a(o,c){return s.call(this,"angle",o,c||[0,360])||this}return a.prototype.pointToData=function(o,c){return this.polar.pointToData(o,c)[this.dim==="radius"?0:1]},a.prototype.calculateCategoryInterval=function(){var o=this,c=o.getLabelModel(),d=o.scale,tt=d.getExtent(),nt=d.count();if(tt[1]-tt[0]<1)return 0;var it=tt[0],st=o.dataToCoord(it+1)-o.dataToCoord(it),ut=Math.abs(st),ct=getBoundingRect(it==null?"":it+"",c.getFont(),"center","top"),ot=Math.max(ct.height,7),at=ot/ut;isNaN(at)&&(at=1/0);var ht=Math.max(0,Math.floor(at)),ft=inner$8(o.model),mt=ft.lastAutoInterval,yt=ft.lastTickCount;return mt!=null&&yt!=null&&Math.abs(mt-ht)<=1&&Math.abs(yt-nt)<=1&&mt>ht?ht=mt:(ft.lastTickCount=nt,ft.lastAutoInterval=ht),ht},a}(Axis);AngleAxis.prototype.dataToAngle=Axis.prototype.dataToCoord;AngleAxis.prototype.angleToData=Axis.prototype.coordToData;var polarDimensions=["radius","angle"],Polar=function(){function s(a){this.dimensions=polarDimensions,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new RadiusAxis,this._angleAxis=new AngleAxis,this.axisPointerEnabled=!0,this.name=a||"",this._radiusAxis.polar=this._angleAxis.polar=this}return s.prototype.containPoint=function(a){var o=this.pointToCoord(a);return this._radiusAxis.contain(o[0])&&this._angleAxis.contain(o[1])},s.prototype.containData=function(a){return this._radiusAxis.containData(a[0])&&this._angleAxis.containData(a[1])},s.prototype.getAxis=function(a){var o="_"+a+"Axis";return this[o]},s.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},s.prototype.getAxesByScale=function(a){var o=[],c=this._angleAxis,d=this._radiusAxis;return c.scale.type===a&&o.push(c),d.scale.type===a&&o.push(d),o},s.prototype.getAngleAxis=function(){return this._angleAxis},s.prototype.getRadiusAxis=function(){return this._radiusAxis},s.prototype.getOtherAxis=function(a){var o=this._angleAxis;return a===o?this._radiusAxis:o},s.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},s.prototype.getTooltipAxes=function(a){var o=a!=null&&a!=="auto"?this.getAxis(a):this.getBaseAxis();return{baseAxes:[o],otherAxes:[this.getOtherAxis(o)]}},s.prototype.dataToPoint=function(a,o){return this.coordToPoint([this._radiusAxis.dataToRadius(a[0],o),this._angleAxis.dataToAngle(a[1],o)])},s.prototype.pointToData=function(a,o){var c=this.pointToCoord(a);return[this._radiusAxis.radiusToData(c[0],o),this._angleAxis.angleToData(c[1],o)]},s.prototype.pointToCoord=function(a){var o=a[0]-this.cx,c=a[1]-this.cy,d=this.getAngleAxis(),tt=d.getExtent(),nt=Math.min(tt[0],tt[1]),it=Math.max(tt[0],tt[1]);d.inverse?nt=it-360:it=nt+360;var st=Math.sqrt(o*o+c*c);o/=st,c/=st;for(var ut=Math.atan2(-c,o)/Math.PI*180,ct=ut<nt?1:-1;ut<nt||ut>it;)ut+=ct*360;return[st,ut]},s.prototype.coordToPoint=function(a){var o=a[0],c=a[1]/180*Math.PI,d=Math.cos(c)*o+this.cx,tt=-Math.sin(c)*o+this.cy;return[d,tt]},s.prototype.getArea=function(){var a=this.getAngleAxis(),o=this.getRadiusAxis(),c=o.getExtent().slice();c[0]>c[1]&&c.reverse();var d=a.getExtent(),tt=Math.PI/180,nt=1e-4;return{cx:this.cx,cy:this.cy,r0:c[0],r:c[1],startAngle:-d[0]*tt,endAngle:-d[1]*tt,clockwise:a.inverse,contain:function(it,st){var ut=it-this.cx,ct=st-this.cy,ot=ut*ut+ct*ct,at=this.r,ht=this.r0;return at!==ht&&ot-nt<=at*at&&ot+nt>=ht*ht}}},s.prototype.convertToPixel=function(a,o,c){var d=getCoordSys$2(o);return d===this?this.dataToPoint(c):null},s.prototype.convertFromPixel=function(a,o,c){var d=getCoordSys$2(o);return d===this?this.pointToData(c):null},s}();function getCoordSys$2(s){var a=s.seriesModel,o=s.polarModel;return o&&o.coordinateSystem||a&&a.coordinateSystem}function resizePolar(s,a,o){var c=a.get("center"),d=o.getWidth(),tt=o.getHeight();s.cx=parsePercent(c[0],d),s.cy=parsePercent(c[1],tt);var nt=s.getRadiusAxis(),it=Math.min(d,tt)/2,st=a.get("radius");st==null?st=[0,"100%"]:isArray$1(st)||(st=[0,st]);var ut=[parsePercent(st[0],it),parsePercent(st[1],it)];nt.inverse?nt.setExtent(ut[1],ut[0]):nt.setExtent(ut[0],ut[1])}function updatePolarScale(s,a){var o=this,c=o.getAngleAxis(),d=o.getRadiusAxis();if(c.scale.setExtent(1/0,-1/0),d.scale.setExtent(1/0,-1/0),s.eachSeries(function(it){if(it.coordinateSystem===o){var st=it.getData();each$f(getDataDimensionsOnAxis(st,"radius"),function(ut){d.scale.unionExtentFromData(st,ut)}),each$f(getDataDimensionsOnAxis(st,"angle"),function(ut){c.scale.unionExtentFromData(st,ut)})}}),niceScaleExtent(c.scale,c.model),niceScaleExtent(d.scale,d.model),c.type==="category"&&!c.onBand){var tt=c.getExtent(),nt=360/c.scale.count();c.inverse?tt[1]+=nt:tt[1]-=nt,c.setExtent(tt[0],tt[1])}}function isAngleAxisModel(s){return s.mainType==="angleAxis"}function setAxis(s,a){var o;if(s.type=a.get("type"),s.scale=createScaleByModel$1(a),s.onBand=a.get("boundaryGap")&&s.type==="category",s.inverse=a.get("inverse"),isAngleAxisModel(a)){s.inverse=s.inverse!==a.get("clockwise");var c=a.get("startAngle"),d=(o=a.get("endAngle"))!==null&&o!==void 0?o:c+(s.inverse?-360:360);s.setExtent(c,d)}a.axis=s,s.model=a}var polarCreator={dimensions:polarDimensions,create:function(s,a){var o=[];return s.eachComponent("polar",function(c,d){var tt=new Polar(d+"");tt.update=updatePolarScale;var nt=tt.getRadiusAxis(),it=tt.getAngleAxis(),st=c.findAxisModel("radiusAxis"),ut=c.findAxisModel("angleAxis");setAxis(nt,st),setAxis(it,ut),resizePolar(tt,c,a),o.push(tt),c.coordinateSystem=tt,tt.model=c}),s.eachSeries(function(c){if(c.get("coordinateSystem")==="polar"){var d=c.getReferringComponents("polar",SINGLE_REFERRING).models[0];c.coordinateSystem=d.coordinateSystem}}),o}},elementList=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function getAxisLineShape(s,a,o){a[1]>a[0]&&(a=a.slice().reverse());var c=s.coordToPoint([a[0],o]),d=s.coordToPoint([a[1],o]);return{x1:c[0],y1:c[1],x2:d[0],y2:d[1]}}function getRadiusIdx(s){var a=s.getRadiusAxis();return a.inverse?0:1}function fixAngleOverlap(s){var a=s[0],o=s[s.length-1];a&&o&&Math.abs(Math.abs(a.coord-o.coord)-360)<1e-4&&s.pop()}var AngleAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.axisPointerClass="PolarAxisPointer",o}return a.prototype.render=function(o,c){if(this.group.removeAll(),!!o.get("show")){var d=o.axis,tt=d.polar,nt=tt.getRadiusAxis().getExtent(),it=d.getTicksCoords(),st=d.getMinorTicksCoords(),ut=map$1(d.getViewLabels(),function(ct){ct=clone$4(ct);var ot=d.scale,at=ot.type==="ordinal"?ot.getRawOrdinalNumber(ct.tickValue):ct.tickValue;return ct.coord=d.dataToCoord(at),ct});fixAngleOverlap(ut),fixAngleOverlap(it),each$f(elementList,function(ct){o.get([ct,"show"])&&(!d.scale.isBlank()||ct==="axisLine")&&angelAxisElementsBuilders[ct](this.group,o,tt,it,st,nt,ut)},this)}},a.type="angleAxis",a}(AxisView),angelAxisElementsBuilders={axisLine:function(s,a,o,c,d,tt){var nt=a.getModel(["axisLine","lineStyle"]),it=o.getAngleAxis(),st=Math.PI/180,ut=it.getExtent(),ct=getRadiusIdx(o),ot=ct?0:1,at,ht=Math.abs(ut[1]-ut[0])===360?"Circle":"Arc";tt[ot]===0?at=new graphic$1[ht]({shape:{cx:o.cx,cy:o.cy,r:tt[ct],startAngle:-ut[0]*st,endAngle:-ut[1]*st,clockwise:it.inverse},style:nt.getLineStyle(),z2:1,silent:!0}):at=new Ring({shape:{cx:o.cx,cy:o.cy,r:tt[ct],r0:tt[ot]},style:nt.getLineStyle(),z2:1,silent:!0}),at.style.fill=null,s.add(at)},axisTick:function(s,a,o,c,d,tt){var nt=a.getModel("axisTick"),it=(nt.get("inside")?-1:1)*nt.get("length"),st=tt[getRadiusIdx(o)],ut=map$1(c,function(ct){return new Line$1({shape:getAxisLineShape(o,[st,st+it],ct.coord)})});s.add(mergePath(ut,{style:defaults(nt.getModel("lineStyle").getLineStyle(),{stroke:a.get(["axisLine","lineStyle","color"])})}))},minorTick:function(s,a,o,c,d,tt){if(d.length){for(var nt=a.getModel("axisTick"),it=a.getModel("minorTick"),st=(nt.get("inside")?-1:1)*it.get("length"),ut=tt[getRadiusIdx(o)],ct=[],ot=0;ot<d.length;ot++)for(var at=0;at<d[ot].length;at++)ct.push(new Line$1({shape:getAxisLineShape(o,[ut,ut+st],d[ot][at].coord)}));s.add(mergePath(ct,{style:defaults(it.getModel("lineStyle").getLineStyle(),defaults(nt.getLineStyle(),{stroke:a.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(s,a,o,c,d,tt,nt){var it=a.getCategories(!0),st=a.getModel("axisLabel"),ut=st.get("margin"),ct=a.get("triggerEvent");each$f(nt,function(ot,at){var ht=st,ft=ot.tickValue,mt=tt[getRadiusIdx(o)],yt=o.coordToPoint([mt+ut,ot.coord]),bt=o.cx,wt=o.cy,Tt=Math.abs(yt[0]-bt)/mt<.3?"center":yt[0]>bt?"left":"right",Ct=Math.abs(yt[1]-wt)/mt<.3?"middle":yt[1]>wt?"top":"bottom";if(it&&it[ft]){var Dt=it[ft];isObject$3(Dt)&&Dt.textStyle&&(ht=new Model(Dt.textStyle,st,st.ecModel))}var Ot=new ZRText({silent:AxisBuilder.isLabelSilent(a),style:createTextStyle$1(ht,{x:yt[0],y:yt[1],fill:ht.getTextColor()||a.get(["axisLine","lineStyle","color"]),text:ot.formattedLabel,align:Tt,verticalAlign:Ct})});if(s.add(Ot),ct){var $t=AxisBuilder.makeAxisEventDataBase(a);$t.targetType="axisLabel",$t.value=ot.rawLabel,getECData(Ot).eventData=$t}},this)},splitLine:function(s,a,o,c,d,tt){var nt=a.getModel("splitLine"),it=nt.getModel("lineStyle"),st=it.get("color"),ut=0;st=st instanceof Array?st:[st];for(var ct=[],ot=0;ot<c.length;ot++){var at=ut++%st.length;ct[at]=ct[at]||[],ct[at].push(new Line$1({shape:getAxisLineShape(o,tt,c[ot].coord)}))}for(var ot=0;ot<ct.length;ot++)s.add(mergePath(ct[ot],{style:defaults({stroke:st[ot%st.length]},it.getLineStyle()),silent:!0,z:a.get("z")}))},minorSplitLine:function(s,a,o,c,d,tt){if(d.length){for(var nt=a.getModel("minorSplitLine"),it=nt.getModel("lineStyle"),st=[],ut=0;ut<d.length;ut++)for(var ct=0;ct<d[ut].length;ct++)st.push(new Line$1({shape:getAxisLineShape(o,tt,d[ut][ct].coord)}));s.add(mergePath(st,{style:it.getLineStyle(),silent:!0,z:a.get("z")}))}},splitArea:function(s,a,o,c,d,tt){if(c.length){var nt=a.getModel("splitArea"),it=nt.getModel("areaStyle"),st=it.get("color"),ut=0;st=st instanceof Array?st:[st];for(var ct=[],ot=Math.PI/180,at=-c[0].coord*ot,ht=Math.min(tt[0],tt[1]),ft=Math.max(tt[0],tt[1]),mt=a.get("clockwise"),yt=1,bt=c.length;yt<=bt;yt++){var wt=yt===bt?c[0].coord:c[yt].coord,Tt=ut++%st.length;ct[Tt]=ct[Tt]||[],ct[Tt].push(new Sector({shape:{cx:o.cx,cy:o.cy,r0:ht,r:ft,startAngle:at,endAngle:-wt*ot,clockwise:mt},silent:!0})),at=-wt*ot}for(var yt=0;yt<ct.length;yt++)s.add(mergePath(ct[yt],{style:defaults({fill:st[yt%st.length]},it.getAreaStyle()),silent:!0}))}}},axisBuilderAttrs$1=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs$1=["splitLine","splitArea","minorSplitLine"],RadiusAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.axisPointerClass="PolarAxisPointer",o}return a.prototype.render=function(o,c){if(this.group.removeAll(),!!o.get("show")){var d=this._axisGroup,tt=this._axisGroup=new Group$3;this.group.add(tt);var nt=o.axis,it=nt.polar,st=it.getAngleAxis(),ut=nt.getTicksCoords(),ct=nt.getMinorTicksCoords(),ot=st.getExtent()[0],at=nt.getExtent(),ht=layoutAxis(it,o,ot),ft=new AxisBuilder(o,ht);each$f(axisBuilderAttrs$1,ft.add,ft),tt.add(ft.getGroup()),groupTransition(d,tt,o),each$f(selfBuilderAttrs$1,function(mt){o.get([mt,"show"])&&!nt.scale.isBlank()&&axisElementBuilders$1[mt](this.group,o,it,ot,at,ut,ct)},this)}},a.type="radiusAxis",a}(AxisView),axisElementBuilders$1={splitLine:function(s,a,o,c,d,tt){var nt=a.getModel("splitLine"),it=nt.getModel("lineStyle"),st=it.get("color"),ut=0,ct=o.getAngleAxis(),ot=Math.PI/180,at=ct.getExtent(),ht=Math.abs(at[1]-at[0])===360?"Circle":"Arc";st=st instanceof Array?st:[st];for(var ft=[],mt=0;mt<tt.length;mt++){var yt=ut++%st.length;ft[yt]=ft[yt]||[],ft[yt].push(new graphic$1[ht]({shape:{cx:o.cx,cy:o.cy,r:Math.max(tt[mt].coord,0),startAngle:-at[0]*ot,endAngle:-at[1]*ot,clockwise:ct.inverse}}))}for(var mt=0;mt<ft.length;mt++)s.add(mergePath(ft[mt],{style:defaults({stroke:st[mt%st.length],fill:null},it.getLineStyle()),silent:!0}))},minorSplitLine:function(s,a,o,c,d,tt,nt){if(nt.length){for(var it=a.getModel("minorSplitLine"),st=it.getModel("lineStyle"),ut=[],ct=0;ct<nt.length;ct++)for(var ot=0;ot<nt[ct].length;ot++)ut.push(new Circle({shape:{cx:o.cx,cy:o.cy,r:nt[ct][ot].coord}}));s.add(mergePath(ut,{style:defaults({fill:null},st.getLineStyle()),silent:!0}))}},splitArea:function(s,a,o,c,d,tt){if(tt.length){var nt=a.getModel("splitArea"),it=nt.getModel("areaStyle"),st=it.get("color"),ut=0;st=st instanceof Array?st:[st];for(var ct=[],ot=tt[0].coord,at=1;at<tt.length;at++){var ht=ut++%st.length;ct[ht]=ct[ht]||[],ct[ht].push(new Sector({shape:{cx:o.cx,cy:o.cy,r0:ot,r:tt[at].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),ot=tt[at].coord}for(var at=0;at<ct.length;at++)s.add(mergePath(ct[at],{style:defaults({fill:st[at%st.length]},it.getAreaStyle()),silent:!0}))}}};function layoutAxis(s,a,o){return{position:[s.cx,s.cy],rotation:o/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:a.getModel("axisLabel").get("rotate"),z2:1}}function getSeriesStackId(s){return s.get("stack")||"__ec_stack_"+s.seriesIndex}function getAxisKey(s,a){return a.dim+s.model.componentIndex}function barLayoutPolar(s,a,o){var c={},d=calRadialBar(filter(a.getSeriesByType(s),function(tt){return!a.isSeriesFiltered(tt)&&tt.coordinateSystem&&tt.coordinateSystem.type==="polar"}));a.eachSeriesByType(s,function(tt){if(tt.coordinateSystem.type==="polar"){var nt=tt.getData(),it=tt.coordinateSystem,st=it.getBaseAxis(),ut=getAxisKey(it,st),ct=getSeriesStackId(tt),ot=d[ut][ct],at=ot.offset,ht=ot.width,ft=it.getOtherAxis(st),mt=tt.coordinateSystem.cx,yt=tt.coordinateSystem.cy,bt=tt.get("barMinHeight")||0,wt=tt.get("barMinAngle")||0;c[ct]=c[ct]||[];for(var Tt=nt.mapDimension(ft.dim),Ct=nt.mapDimension(st.dim),Dt=isDimensionStacked(nt,Tt),Ot=st.dim!=="radius"||!tt.get("roundCap",!0),$t=ft.model,Ft=$t.get("startValue"),kt=ft.dataToCoord(Ft||0),Vt=0,Ht=nt.count();Vt<Ht;Vt++){var Qt=nt.get(Tt,Vt),Xt=nt.get(Ct,Vt),Zt=Qt>=0?"p":"n",ar=kt;Dt&&(c[ct][Xt]||(c[ct][Xt]={p:kt,n:kt}),ar=c[ct][Xt][Zt]);var nr=void 0,cr=void 0,dr=void 0,mr=void 0;if(ft.dim==="radius"){var Dr=ft.dataToCoord(Qt)-kt,kr=st.dataToCoord(Xt);Math.abs(Dr)<bt&&(Dr=(Dr<0?-1:1)*bt),nr=ar,cr=ar+Dr,dr=kr-at,mr=dr-ht,Dt&&(c[ct][Xt][Zt]=cr)}else{var Yr=ft.dataToCoord(Qt,Ot)-kt,Mr=st.dataToCoord(Xt);Math.abs(Yr)<wt&&(Yr=(Yr<0?-1:1)*wt),nr=Mr+at,cr=nr+ht,dr=ar,mr=ar+Yr,Dt&&(c[ct][Xt][Zt]=mr)}nt.setItemLayout(Vt,{cx:mt,cy:yt,r0:nr,r:cr,startAngle:-dr*Math.PI/180,endAngle:-mr*Math.PI/180,clockwise:dr>=mr})}}})}function calRadialBar(s){var a={};each$f(s,function(c,d){var tt=c.getData(),nt=c.coordinateSystem,it=nt.getBaseAxis(),st=getAxisKey(nt,it),ut=it.getExtent(),ct=it.type==="category"?it.getBandWidth():Math.abs(ut[1]-ut[0])/tt.count(),ot=a[st]||{bandWidth:ct,remainedWidth:ct,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},at=ot.stacks;a[st]=ot;var ht=getSeriesStackId(c);at[ht]||ot.autoWidthCount++,at[ht]=at[ht]||{width:0,maxWidth:0};var ft=parsePercent(c.get("barWidth"),ct),mt=parsePercent(c.get("barMaxWidth"),ct),yt=c.get("barGap"),bt=c.get("barCategoryGap");ft&&!at[ht].width&&(ft=Math.min(ot.remainedWidth,ft),at[ht].width=ft,ot.remainedWidth-=ft),mt&&(at[ht].maxWidth=mt),yt!=null&&(ot.gap=yt),bt!=null&&(ot.categoryGap=bt)});var o={};return each$f(a,function(c,d){o[d]={};var tt=c.stacks,nt=c.bandWidth,it=parsePercent(c.categoryGap,nt),st=parsePercent(c.gap,1),ut=c.remainedWidth,ct=c.autoWidthCount,ot=(ut-it)/(ct+(ct-1)*st);ot=Math.max(ot,0),each$f(tt,function(mt,yt){var bt=mt.maxWidth;bt&&bt<ot&&(bt=Math.min(bt,ut),mt.width&&(bt=Math.min(bt,mt.width)),ut-=bt,mt.width=bt,ct--)}),ot=(ut-it)/(ct+(ct-1)*st),ot=Math.max(ot,0);var at=0,ht;each$f(tt,function(mt,yt){mt.width||(mt.width=ot),ht=mt,at+=mt.width*(1+st)}),ht&&(at-=ht.width*st);var ft=-at/2;each$f(tt,function(mt,yt){o[d][yt]=o[d][yt]||{offset:ft,width:mt.width},ft+=mt.width*(1+st)})}),o}var angleAxisExtraOption={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},radiusAxisExtraOption={splitNumber:5},PolarView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="polar",a}(ComponentView);function install$o(s){use(install$q),AxisView.registerAxisPointerClass("PolarAxisPointer",PolarAxisPointer),s.registerCoordinateSystem("polar",polarCreator),s.registerComponentModel(PolarModel),s.registerComponentView(PolarView),axisModelCreator(s,"angle",AngleAxisModel,angleAxisExtraOption),axisModelCreator(s,"radius",RadiusAxisModel,radiusAxisExtraOption),s.registerComponentView(AngleAxisView),s.registerComponentView(RadiusAxisView),s.registerLayout(curry$1(barLayoutPolar,"bar"))}function layout$1(s,a){a=a||{};var o=s.coordinateSystem,c=s.axis,d={},tt=c.position,nt=c.orient,it=o.getRect(),st=[it.x,it.x+it.width,it.y,it.y+it.height],ut={horizontal:{top:st[2],bottom:st[3]},vertical:{left:st[0],right:st[1]}};d.position=[nt==="vertical"?ut.vertical[tt]:st[0],nt==="horizontal"?ut.horizontal[tt]:st[3]];var ct={horizontal:0,vertical:1};d.rotation=Math.PI/2*ct[nt];var ot={top:-1,bottom:1,right:1,left:-1};d.labelDirection=d.tickDirection=d.nameDirection=ot[tt],s.get(["axisTick","inside"])&&(d.tickDirection=-d.tickDirection),retrieve(a.labelInside,s.get(["axisLabel","inside"]))&&(d.labelDirection=-d.labelDirection);var at=a.rotate;return at==null&&(at=s.get(["axisLabel","rotate"])),d.labelRotation=tt==="top"?-at:at,d.z2=1,d}var axisBuilderAttrs=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs=["splitArea","splitLine"],SingleAxisView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.axisPointerClass="SingleAxisPointer",o}return a.prototype.render=function(o,c,d,tt){var nt=this.group;nt.removeAll();var it=this._axisGroup;this._axisGroup=new Group$3;var st=layout$1(o),ut=new AxisBuilder(o,st);each$f(axisBuilderAttrs,ut.add,ut),nt.add(this._axisGroup),nt.add(ut.getGroup()),each$f(selfBuilderAttrs,function(ct){o.get([ct,"show"])&&axisElementBuilders[ct](this,this.group,this._axisGroup,o)},this),groupTransition(it,this._axisGroup,o),s.prototype.render.call(this,o,c,d,tt)},a.prototype.remove=function(){rectCoordAxisHandleRemove(this)},a.type="singleAxis",a}(AxisView),axisElementBuilders={splitLine:function(s,a,o,c){var d=c.axis;if(!d.scale.isBlank()){var tt=c.getModel("splitLine"),nt=tt.getModel("lineStyle"),it=nt.get("color");it=it instanceof Array?it:[it];for(var st=nt.get("width"),ut=c.coordinateSystem.getRect(),ct=d.isHorizontal(),ot=[],at=0,ht=d.getTicksCoords({tickModel:tt}),ft=[],mt=[],yt=0;yt<ht.length;++yt){var bt=d.toGlobalCoord(ht[yt].coord);ct?(ft[0]=bt,ft[1]=ut.y,mt[0]=bt,mt[1]=ut.y+ut.height):(ft[0]=ut.x,ft[1]=bt,mt[0]=ut.x+ut.width,mt[1]=bt);var wt=new Line$1({shape:{x1:ft[0],y1:ft[1],x2:mt[0],y2:mt[1]},silent:!0});subPixelOptimizeLine(wt.shape,st);var Tt=at++%it.length;ot[Tt]=ot[Tt]||[],ot[Tt].push(wt)}for(var Ct=nt.getLineStyle(["color"]),yt=0;yt<ot.length;++yt)a.add(mergePath(ot[yt],{style:defaults({stroke:it[yt%it.length]},Ct),silent:!0}))}},splitArea:function(s,a,o,c){rectCoordAxisBuildSplitArea(s,o,c,c)}},SingleAxisModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.getCoordSysModel=function(){return this},a.type="singleAxis",a.layoutMode="box",a.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},a}(ComponentModel);mixin(SingleAxisModel,AxisModelCommonMixin.prototype);var SingleAxis=function(s){__extends$1(a,s);function a(o,c,d,tt,nt){var it=s.call(this,o,c,d)||this;return it.type=tt||"value",it.position=nt||"bottom",it}return a.prototype.isHorizontal=function(){var o=this.position;return o==="top"||o==="bottom"},a.prototype.pointToData=function(o,c){return this.coordinateSystem.pointToData(o)[0]},a}(Axis),singleDimensions=["single"],Single=function(){function s(a,o,c){this.type="single",this.dimension="single",this.dimensions=singleDimensions,this.axisPointerEnabled=!0,this.model=a,this._init(a,o,c)}return s.prototype._init=function(a,o,c){var d=this.dimension,tt=new SingleAxis(d,createScaleByModel$1(a),[0,0],a.get("type"),a.get("position")),nt=tt.type==="category";tt.onBand=nt&&a.get("boundaryGap"),tt.inverse=a.get("inverse"),tt.orient=a.get("orient"),a.axis=tt,tt.model=a,tt.coordinateSystem=this,this._axis=tt},s.prototype.update=function(a,o){a.eachSeries(function(c){if(c.coordinateSystem===this){var d=c.getData();each$f(d.mapDimensionsAll(this.dimension),function(tt){this._axis.scale.unionExtentFromData(d,tt)},this),niceScaleExtent(this._axis.scale,this._axis.model)}},this)},s.prototype.resize=function(a,o){this._rect=getLayoutRect({left:a.get("left"),top:a.get("top"),right:a.get("right"),bottom:a.get("bottom"),width:a.get("width"),height:a.get("height")},{width:o.getWidth(),height:o.getHeight()}),this._adjustAxis()},s.prototype.getRect=function(){return this._rect},s.prototype._adjustAxis=function(){var a=this._rect,o=this._axis,c=o.isHorizontal(),d=c?[0,a.width]:[0,a.height],tt=o.inverse?1:0;o.setExtent(d[tt],d[1-tt]),this._updateAxisTransform(o,c?a.x:a.y)},s.prototype._updateAxisTransform=function(a,o){var c=a.getExtent(),d=c[0]+c[1],tt=a.isHorizontal();a.toGlobalCoord=tt?function(nt){return nt+o}:function(nt){return d-nt+o},a.toLocalCoord=tt?function(nt){return nt-o}:function(nt){return d-nt+o}},s.prototype.getAxis=function(){return this._axis},s.prototype.getBaseAxis=function(){return this._axis},s.prototype.getAxes=function(){return[this._axis]},s.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},s.prototype.containPoint=function(a){var o=this.getRect(),c=this.getAxis(),d=c.orient;return d==="horizontal"?c.contain(c.toLocalCoord(a[0]))&&a[1]>=o.y&&a[1]<=o.y+o.height:c.contain(c.toLocalCoord(a[1]))&&a[0]>=o.y&&a[0]<=o.y+o.height},s.prototype.pointToData=function(a){var o=this.getAxis();return[o.coordToData(o.toLocalCoord(a[o.orient==="horizontal"?0:1]))]},s.prototype.dataToPoint=function(a){var o=this.getAxis(),c=this.getRect(),d=[],tt=o.orient==="horizontal"?0:1;return a instanceof Array&&(a=a[0]),d[tt]=o.toGlobalCoord(o.dataToCoord(+a)),d[1-tt]=tt===0?c.y+c.height/2:c.x+c.width/2,d},s.prototype.convertToPixel=function(a,o,c){var d=getCoordSys$1(o);return d===this?this.dataToPoint(c):null},s.prototype.convertFromPixel=function(a,o,c){var d=getCoordSys$1(o);return d===this?this.pointToData(c):null},s}();function getCoordSys$1(s){var a=s.seriesModel,o=s.singleAxisModel;return o&&o.coordinateSystem||a&&a.coordinateSystem}function create(s,a){var o=[];return s.eachComponent("singleAxis",function(c,d){var tt=new Single(c,s,a);tt.name="single_"+d,tt.resize(c,a),c.coordinateSystem=tt,o.push(tt)}),s.eachSeries(function(c){if(c.get("coordinateSystem")==="singleAxis"){var d=c.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];c.coordinateSystem=d&&d.coordinateSystem}}),o}var singleCreator={create,dimensions:singleDimensions},XY$1=["x","y"],WH$1=["width","height"],SingleAxisPointer=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.makeElOption=function(o,c,d,tt,nt){var it=d.axis,st=it.coordinateSystem,ut=getGlobalExtent(st,1-getPointDimIndex(it)),ct=st.dataToPoint(c)[0],ot=tt.get("type");if(ot&&ot!=="none"){var at=buildElStyle(tt),ht=pointerShapeBuilder[ot](it,ct,ut);ht.style=at,o.graphicKey=ht.type,o.pointer=ht}var ft=layout$1(d);buildCartesianSingleLabelElOption(c,o,ft,d,tt,nt)},a.prototype.getHandleTransform=function(o,c,d){var tt=layout$1(c,{labelInside:!1});tt.labelMargin=d.get(["handle","margin"]);var nt=getTransformedPosition(c.axis,o,tt);return{x:nt[0],y:nt[1],rotation:tt.rotation+(tt.labelDirection<0?Math.PI:0)}},a.prototype.updateHandleTransform=function(o,c,d,tt){var nt=d.axis,it=nt.coordinateSystem,st=getPointDimIndex(nt),ut=getGlobalExtent(it,st),ct=[o.x,o.y];ct[st]+=c[st],ct[st]=Math.min(ut[1],ct[st]),ct[st]=Math.max(ut[0],ct[st]);var ot=getGlobalExtent(it,1-st),at=(ot[1]+ot[0])/2,ht=[at,at];return ht[st]=ct[st],{x:ct[0],y:ct[1],rotation:o.rotation,cursorPoint:ht,tooltipOption:{verticalAlign:"middle"}}},a}(BaseAxisPointer),pointerShapeBuilder={line:function(s,a,o){var c=makeLineShape([a,o[0]],[a,o[1]],getPointDimIndex(s));return{type:"Line",subPixelOptimize:!0,shape:c}},shadow:function(s,a,o){var c=s.getBandWidth(),d=o[1]-o[0];return{type:"Rect",shape:makeRectShape([a-c/2,o[0]],[c,d],getPointDimIndex(s))}}};function getPointDimIndex(s){return s.isHorizontal()?0:1}function getGlobalExtent(s,a){var o=s.getRect();return[o[XY$1[a]],o[XY$1[a]]+o[WH$1[a]]]}var SingleView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="single",a}(ComponentView);function install$n(s){use(install$q),AxisView.registerAxisPointerClass("SingleAxisPointer",SingleAxisPointer),s.registerComponentView(SingleView),s.registerComponentView(SingleAxisView),s.registerComponentModel(SingleAxisModel),axisModelCreator(s,"single",SingleAxisModel,SingleAxisModel.defaultOption),s.registerCoordinateSystem("single",singleCreator)}var CalendarModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c,d){var tt=getLayoutParams(o);s.prototype.init.apply(this,arguments),mergeAndNormalizeLayoutParams$1(o,tt)},a.prototype.mergeOption=function(o){s.prototype.mergeOption.apply(this,arguments),mergeAndNormalizeLayoutParams$1(this.option,o)},a.prototype.getCellSize=function(){return this.option.cellSize},a.type="calendar",a.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},a}(ComponentModel);function mergeAndNormalizeLayoutParams$1(s,a){var o=s.cellSize,c;isArray$1(o)?c=o:c=s.cellSize=[o,o],c.length===1&&(c[1]=c[0]);var d=map$1([0,1],function(tt){return sizeCalculable(a,tt)&&(c[tt]="auto"),c[tt]!=null&&c[tt]!=="auto"});mergeLayoutParam(s,a,{type:"box",ignoreSize:d})}var CalendarView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){var tt=this.group;tt.removeAll();var nt=o.coordinateSystem,it=nt.getRangeInfo(),st=nt.getOrient(),ut=c.getLocaleModel();this._renderDayRect(o,it,tt),this._renderLines(o,it,st,tt),this._renderYearText(o,it,st,tt),this._renderMonthText(o,ut,st,tt),this._renderWeekText(o,ut,it,st,tt)},a.prototype._renderDayRect=function(o,c,d){for(var tt=o.coordinateSystem,nt=o.getModel("itemStyle").getItemStyle(),it=tt.getCellWidth(),st=tt.getCellHeight(),ut=c.start.time;ut<=c.end.time;ut=tt.getNextNDay(ut,1).time){var ct=tt.dataToRect([ut],!1).tl,ot=new Rect$2({shape:{x:ct[0],y:ct[1],width:it,height:st},cursor:"default",style:nt});d.add(ot)}},a.prototype._renderLines=function(o,c,d,tt){var nt=this,it=o.coordinateSystem,st=o.getModel(["splitLine","lineStyle"]).getLineStyle(),ut=o.get(["splitLine","show"]),ct=st.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var ot=c.start,at=0;ot.time<=c.end.time;at++){ft(ot.formatedDate),at===0&&(ot=it.getDateInfo(c.start.y+"-"+c.start.m));var ht=ot.date;ht.setMonth(ht.getMonth()+1),ot=it.getDateInfo(ht)}ft(it.getNextNDay(c.end.time,1).formatedDate);function ft(mt){nt._firstDayOfMonth.push(it.getDateInfo(mt)),nt._firstDayPoints.push(it.dataToRect([mt],!1).tl);var yt=nt._getLinePointsOfOneWeek(o,mt,d);nt._tlpoints.push(yt[0]),nt._blpoints.push(yt[yt.length-1]),ut&&nt._drawSplitline(yt,st,tt)}ut&&this._drawSplitline(nt._getEdgesPoints(nt._tlpoints,ct,d),st,tt),ut&&this._drawSplitline(nt._getEdgesPoints(nt._blpoints,ct,d),st,tt)},a.prototype._getEdgesPoints=function(o,c,d){var tt=[o[0].slice(),o[o.length-1].slice()],nt=d==="horizontal"?0:1;return tt[0][nt]=tt[0][nt]-c/2,tt[1][nt]=tt[1][nt]+c/2,tt},a.prototype._drawSplitline=function(o,c,d){var tt=new Polyline$1({z2:20,shape:{points:o},style:c});d.add(tt)},a.prototype._getLinePointsOfOneWeek=function(o,c,d){for(var tt=o.coordinateSystem,nt=tt.getDateInfo(c),it=[],st=0;st<7;st++){var ut=tt.getNextNDay(nt.time,st),ct=tt.dataToRect([ut.time],!1);it[2*ut.day]=ct.tl,it[2*ut.day+1]=ct[d==="horizontal"?"bl":"tr"]}return it},a.prototype._formatterLabel=function(o,c){return isString$1(o)&&o?formatTplSimple(o,c):isFunction$1(o)?o(c):c.nameMap},a.prototype._yearTextPositionControl=function(o,c,d,tt,nt){var it=c[0],st=c[1],ut=["center","bottom"];tt==="bottom"?(st+=nt,ut=["center","top"]):tt==="left"?it-=nt:tt==="right"?(it+=nt,ut=["center","top"]):st-=nt;var ct=0;return(tt==="left"||tt==="right")&&(ct=Math.PI/2),{rotation:ct,x:it,y:st,style:{align:ut[0],verticalAlign:ut[1]}}},a.prototype._renderYearText=function(o,c,d,tt){var nt=o.getModel("yearLabel");if(nt.get("show")){var it=nt.get("margin"),st=nt.get("position");st||(st=d!=="horizontal"?"top":"left");var ut=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],ct=(ut[0][0]+ut[1][0])/2,ot=(ut[0][1]+ut[1][1])/2,at=d==="horizontal"?0:1,ht={top:[ct,ut[at][1]],bottom:[ct,ut[1-at][1]],left:[ut[1-at][0],ot],right:[ut[at][0],ot]},ft=c.start.y;+c.end.y>+c.start.y&&(ft=ft+"-"+c.end.y);var mt=nt.get("formatter"),yt={start:c.start.y,end:c.end.y,nameMap:ft},bt=this._formatterLabel(mt,yt),wt=new ZRText({z2:30,style:createTextStyle$1(nt,{text:bt}),silent:nt.get("silent")});wt.attr(this._yearTextPositionControl(wt,ht[st],d,st,it)),tt.add(wt)}},a.prototype._monthTextPositionControl=function(o,c,d,tt,nt){var it="left",st="top",ut=o[0],ct=o[1];return d==="horizontal"?(ct=ct+nt,c&&(it="center"),tt==="start"&&(st="bottom")):(ut=ut+nt,c&&(st="middle"),tt==="start"&&(it="right")),{x:ut,y:ct,align:it,verticalAlign:st}},a.prototype._renderMonthText=function(o,c,d,tt){var nt=o.getModel("monthLabel");if(nt.get("show")){var it=nt.get("nameMap"),st=nt.get("margin"),ut=nt.get("position"),ct=nt.get("align"),ot=[this._tlpoints,this._blpoints];(!it||isString$1(it))&&(it&&(c=getLocaleModel(it)||c),it=c.get(["time","monthAbbr"])||[]);var at=ut==="start"?0:1,ht=d==="horizontal"?0:1;st=ut==="start"?-st:st;for(var ft=ct==="center",mt=nt.get("silent"),yt=0;yt<ot[at].length-1;yt++){var bt=ot[at][yt].slice(),wt=this._firstDayOfMonth[yt];if(ft){var Tt=this._firstDayPoints[yt];bt[ht]=(Tt[ht]+ot[0][yt+1][ht])/2}var Ct=nt.get("formatter"),Dt=it[+wt.m-1],Ot={yyyy:wt.y,yy:(wt.y+"").slice(2),MM:wt.m,M:+wt.m,nameMap:Dt},$t=this._formatterLabel(Ct,Ot),Ft=new ZRText({z2:30,style:extend(createTextStyle$1(nt,{text:$t}),this._monthTextPositionControl(bt,ft,d,ut,st)),silent:mt});tt.add(Ft)}}},a.prototype._weekTextPositionControl=function(o,c,d,tt,nt){var it="center",st="middle",ut=o[0],ct=o[1],ot=d==="start";return c==="horizontal"?(ut=ut+tt+(ot?1:-1)*nt[0]/2,it=ot?"right":"left"):(ct=ct+tt+(ot?1:-1)*nt[1]/2,st=ot?"bottom":"top"),{x:ut,y:ct,align:it,verticalAlign:st}},a.prototype._renderWeekText=function(o,c,d,tt,nt){var it=o.getModel("dayLabel");if(it.get("show")){var st=o.coordinateSystem,ut=it.get("position"),ct=it.get("nameMap"),ot=it.get("margin"),at=st.getFirstDayOfWeek();if(!ct||isString$1(ct)){ct&&(c=getLocaleModel(ct)||c);var ht=c.get(["time","dayOfWeekShort"]);ct=ht||map$1(c.get(["time","dayOfWeekAbbr"]),function(Ot){return Ot[0]})}var ft=st.getNextNDay(d.end.time,7-d.lweek).time,mt=[st.getCellWidth(),st.getCellHeight()];ot=parsePercent(ot,Math.min(mt[1],mt[0])),ut==="start"&&(ft=st.getNextNDay(d.start.time,-(7+d.fweek)).time,ot=-ot);for(var yt=it.get("silent"),bt=0;bt<7;bt++){var wt=st.getNextNDay(ft,bt),Tt=st.dataToRect([wt.time],!1).center,Ct=bt;Ct=Math.abs((bt+at)%7);var Dt=new ZRText({z2:30,style:extend(createTextStyle$1(it,{text:ct[Ct]}),this._weekTextPositionControl(Tt,tt,ut,ot,mt)),silent:yt});nt.add(Dt)}}},a.type="calendar",a}(ComponentView),PROXIMATE_ONE_DAY=864e5,Calendar=function(){function s(a,o,c){this.type="calendar",this.dimensions=s.dimensions,this.getDimensionsInfo=s.getDimensionsInfo,this._model=a}return s.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},s.prototype.getRangeInfo=function(){return this._rangeInfo},s.prototype.getModel=function(){return this._model},s.prototype.getRect=function(){return this._rect},s.prototype.getCellWidth=function(){return this._sw},s.prototype.getCellHeight=function(){return this._sh},s.prototype.getOrient=function(){return this._orient},s.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},s.prototype.getDateInfo=function(a){a=parseDate(a);var o=a.getFullYear(),c=a.getMonth()+1,d=c<10?"0"+c:""+c,tt=a.getDate(),nt=tt<10?"0"+tt:""+tt,it=a.getDay();return it=Math.abs((it+7-this.getFirstDayOfWeek())%7),{y:o+"",m:d,d:nt,day:it,time:a.getTime(),formatedDate:o+"-"+d+"-"+nt,date:a}},s.prototype.getNextNDay=function(a,o){return o=o||0,o===0?this.getDateInfo(a):(a=new Date(this.getDateInfo(a).time),a.setDate(a.getDate()+o),this.getDateInfo(a))},s.prototype.update=function(a,o){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var c=this._rangeInfo.weeks||1,d=["width","height"],tt=this._model.getCellSize().slice(),nt=this._model.getBoxLayoutParams(),it=this._orient==="horizontal"?[c,7]:[7,c];each$f([0,1],function(ot){ct(tt,ot)&&(nt[d[ot]]=tt[ot]*it[ot])});var st={width:o.getWidth(),height:o.getHeight()},ut=this._rect=getLayoutRect(nt,st);each$f([0,1],function(ot){ct(tt,ot)||(tt[ot]=ut[d[ot]]/it[ot])});function ct(ot,at){return ot[at]!=null&&ot[at]!=="auto"}this._sw=tt[0],this._sh=tt[1]},s.prototype.dataToPoint=function(a,o){isArray$1(a)&&(a=a[0]),o==null&&(o=!0);var c=this.getDateInfo(a),d=this._rangeInfo,tt=c.formatedDate;if(o&&!(c.time>=d.start.time&&c.time<d.end.time+PROXIMATE_ONE_DAY))return[NaN,NaN];var nt=c.day,it=this._getRangeInfo([d.start.time,tt]).nthWeek;return this._orient==="vertical"?[this._rect.x+nt*this._sw+this._sw/2,this._rect.y+it*this._sh+this._sh/2]:[this._rect.x+it*this._sw+this._sw/2,this._rect.y+nt*this._sh+this._sh/2]},s.prototype.pointToData=function(a){var o=this.pointToDate(a);return o&&o.time},s.prototype.dataToRect=function(a,o){var c=this.dataToPoint(a,o);return{contentShape:{x:c[0]-(this._sw-this._lineWidth)/2,y:c[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:c,tl:[c[0]-this._sw/2,c[1]-this._sh/2],tr:[c[0]+this._sw/2,c[1]-this._sh/2],br:[c[0]+this._sw/2,c[1]+this._sh/2],bl:[c[0]-this._sw/2,c[1]+this._sh/2]}},s.prototype.pointToDate=function(a){var o=Math.floor((a[0]-this._rect.x)/this._sw)+1,c=Math.floor((a[1]-this._rect.y)/this._sh)+1,d=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(c,o-1,d):this._getDateByWeeksAndDay(o,c-1,d)},s.prototype.convertToPixel=function(a,o,c){var d=getCoordSys(o);return d===this?d.dataToPoint(c):null},s.prototype.convertFromPixel=function(a,o,c){var d=getCoordSys(o);return d===this?d.pointToData(c):null},s.prototype.containPoint=function(a){return console.warn("Not implemented."),!1},s.prototype._initRangeOption=function(){var a=this._model.get("range"),o;if(isArray$1(a)&&a.length===1&&(a=a[0]),isArray$1(a))o=a;else{var c=a.toString();if(/^\d{4}$/.test(c)&&(o=[c+"-01-01",c+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(c)){var d=this.getDateInfo(c),tt=d.date;tt.setMonth(tt.getMonth()+1);var nt=this.getNextNDay(tt,-1);o=[d.formatedDate,nt.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(c)&&(o=[c,c])}if(!o)return a;var it=this._getRangeInfo(o);return it.start.time>it.end.time&&o.reverse(),o},s.prototype._getRangeInfo=function(a){var o=[this.getDateInfo(a[0]),this.getDateInfo(a[1])],c;o[0].time>o[1].time&&(c=!0,o.reverse());var d=Math.floor(o[1].time/PROXIMATE_ONE_DAY)-Math.floor(o[0].time/PROXIMATE_ONE_DAY)+1,tt=new Date(o[0].time),nt=tt.getDate(),it=o[1].date.getDate();tt.setDate(nt+d-1);var st=tt.getDate();if(st!==it)for(var ut=tt.getTime()-o[1].time>0?1:-1;(st=tt.getDate())!==it&&(tt.getTime()-o[1].time)*ut>0;)d-=ut,tt.setDate(st-ut);var ct=Math.floor((d+o[0].day+6)/7),ot=c?-ct+1:ct-1;return c&&o.reverse(),{range:[o[0].formatedDate,o[1].formatedDate],start:o[0],end:o[1],allDay:d,weeks:ct,nthWeek:ot,fweek:o[0].day,lweek:o[1].day}},s.prototype._getDateByWeeksAndDay=function(a,o,c){var d=this._getRangeInfo(c);if(a>d.weeks||a===0&&o<d.fweek||a===d.weeks&&o>d.lweek)return null;var tt=(a-1)*7-d.fweek+o,nt=new Date(d.start.time);return nt.setDate(+d.start.d+tt),this.getDateInfo(nt)},s.create=function(a,o){var c=[];return a.eachComponent("calendar",function(d){var tt=new s(d);c.push(tt),d.coordinateSystem=tt}),a.eachSeries(function(d){d.get("coordinateSystem")==="calendar"&&(d.coordinateSystem=c[d.get("calendarIndex")||0])}),c},s.dimensions=["time","value"],s}();function getCoordSys(s){var a=s.calendarModel,o=s.seriesModel,c=a?a.coordinateSystem:o?o.coordinateSystem:null;return c}function install$m(s){s.registerComponentModel(CalendarModel),s.registerComponentView(CalendarView),s.registerCoordinateSystem("calendar",Calendar)}function setKeyInfoToNewElOption(s,a){var o=s.existing;if(a.id=s.keyInfo.id,!a.type&&o&&(a.type=o.type),a.parentId==null){var c=a.parentOption;c?a.parentId=c.id:o&&(a.parentId=o.parentId)}a.parentOption=null}function isSetLoc(s,a){var o;return each$f(a,function(c){s[c]!=null&&s[c]!=="auto"&&(o=!0)}),o}function mergeNewElOptionToExist(s,a,o){var c=extend({},o),d=s[a],tt=o.$action||"merge";tt==="merge"?d?(merge(d,c,!0),mergeLayoutParam(d,c,{ignoreSize:!0}),copyLayoutParams(o,d),copyTransitionInfo(o,d),copyTransitionInfo(o,d,"shape"),copyTransitionInfo(o,d,"style"),copyTransitionInfo(o,d,"extra"),o.clipPath=d.clipPath):s[a]=c:tt==="replace"?s[a]=c:tt==="remove"&&d&&(s[a]=null)}var TRANSITION_PROPS_TO_COPY=["transition","enterFrom","leaveTo"],ROOT_TRANSITION_PROPS_TO_COPY=TRANSITION_PROPS_TO_COPY.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function copyTransitionInfo(s,a,o){if(o&&(!s[o]&&a[o]&&(s[o]={}),s=s[o],a=a[o]),!(!s||!a))for(var c=o?TRANSITION_PROPS_TO_COPY:ROOT_TRANSITION_PROPS_TO_COPY,d=0;d<c.length;d++){var tt=c[d];s[tt]==null&&a[tt]!=null&&(s[tt]=a[tt])}}function setLayoutInfoToExist(s,a){if(s&&(s.hv=a.hv=[isSetLoc(a,["left","right"]),isSetLoc(a,["top","bottom"])],s.type==="group")){var o=s,c=a;o.width==null&&(o.width=c.width=0),o.height==null&&(o.height=c.height=0)}}var GraphicComponentModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.preventAutoZ=!0,o}return a.prototype.mergeOption=function(o,c){var d=this.option.elements;this.option.elements=null,s.prototype.mergeOption.call(this,o,c),this.option.elements=d},a.prototype.optionUpdated=function(o,c){var d=this.option,tt=(c?d:o).elements,nt=d.elements=c?[]:d.elements,it=[];this._flatten(tt,it,null);var st=mappingToExists(nt,it,"normalMerge"),ut=this._elOptionsToUpdate=[];each$f(st,function(ct,ot){var at=ct.newOption;at&&(ut.push(at),setKeyInfoToNewElOption(ct,at),mergeNewElOptionToExist(nt,ot,at),setLayoutInfoToExist(nt[ot],at))},this),d.elements=filter(nt,function(ct){return ct&&delete ct.$action,ct!=null})},a.prototype._flatten=function(o,c,d){each$f(o,function(tt){if(tt){d&&(tt.parentOption=d),c.push(tt);var nt=tt.children;nt&&nt.length&&this._flatten(nt,c,tt),delete tt.children}},this)},a.prototype.useElOptionsToUpdate=function(){var o=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,o},a.type="graphic",a.defaultOption={elements:[]},a}(ComponentModel),nonShapeGraphicElements={path:null,compoundPath:null,group:Group$3,image:ZRImage,text:ZRText},inner$7=makeInner(),GraphicComponentView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(){this._elMap=createHashMap()},a.prototype.render=function(o,c,d){o!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=o,this._updateElements(o),this._relocate(o,d)},a.prototype._updateElements=function(o){var c=o.useElOptionsToUpdate();if(c){var d=this._elMap,tt=this.group,nt=o.get("z"),it=o.get("zlevel");each$f(c,function(st){var ut=convertOptionIdName(st.id,null),ct=ut!=null?d.get(ut):null,ot=convertOptionIdName(st.parentId,null),at=ot!=null?d.get(ot):tt,ht=st.type,ft=st.style;ht==="text"&&ft&&st.hv&&st.hv[1]&&(ft.textVerticalAlign=ft.textBaseline=ft.verticalAlign=ft.align=null);var mt=st.textContent,yt=st.textConfig;if(ft&&isEC4CompatibleStyle(ft,ht,!!yt,!!mt)){var bt=convertFromEC4CompatibleStyle(ft,ht,!0);!yt&&bt.textConfig&&(yt=st.textConfig=bt.textConfig),!mt&&bt.textContent&&(mt=bt.textContent)}var wt=getCleanedElOption(st),Tt=st.$action||"merge",Ct=Tt==="merge",Dt=Tt==="replace";if(Ct){var Ot=!ct,$t=ct;Ot?$t=createEl(ut,at,st.type,d):($t&&(inner$7($t).isNew=!1),stopPreviousKeyframeAnimationAndRestore($t)),$t&&(applyUpdateTransition($t,wt,o,{isInit:Ot}),updateCommonAttrs($t,st,nt,it))}else if(Dt){removeEl$1(ct,st,d,o);var Ft=createEl(ut,at,st.type,d);Ft&&(applyUpdateTransition(Ft,wt,o,{isInit:!0}),updateCommonAttrs(Ft,st,nt,it))}else Tt==="remove"&&(updateLeaveTo(ct,st),removeEl$1(ct,st,d,o));var kt=d.get(ut);if(kt&&mt)if(Ct){var Vt=kt.getTextContent();Vt?Vt.attr(mt):kt.setTextContent(new ZRText(mt))}else Dt&&kt.setTextContent(new ZRText(mt));if(kt){var Ht=st.clipPath;if(Ht){var Qt=Ht.type,Xt=void 0,Ot=!1;if(Ct){var Zt=kt.getClipPath();Ot=!Zt||inner$7(Zt).type!==Qt,Xt=Ot?newEl(Qt):Zt}else Dt&&(Ot=!0,Xt=newEl(Qt));kt.setClipPath(Xt),applyUpdateTransition(Xt,Ht,o,{isInit:Ot}),applyKeyframeAnimation(Xt,Ht.keyframeAnimation,o)}var ar=inner$7(kt);kt.setTextConfig(yt),ar.option=st,setEventData(kt,o,st),setTooltipConfig({el:kt,componentModel:o,itemName:kt.name,itemTooltipOption:st.tooltip}),applyKeyframeAnimation(kt,st.keyframeAnimation,o)}})}},a.prototype._relocate=function(o,c){for(var d=o.option.elements,tt=this.group,nt=this._elMap,it=c.getWidth(),st=c.getHeight(),ut=["x","y"],ct=0;ct<d.length;ct++){var ot=d[ct],at=convertOptionIdName(ot.id,null),ht=at!=null?nt.get(at):null;if(!(!ht||!ht.isGroup)){var ft=ht.parent,mt=ft===tt,yt=inner$7(ht),bt=inner$7(ft);yt.width=parsePercent(yt.option.width,mt?it:bt.width)||0,yt.height=parsePercent(yt.option.height,mt?st:bt.height)||0}}for(var ct=d.length-1;ct>=0;ct--){var ot=d[ct],at=convertOptionIdName(ot.id,null),ht=at!=null?nt.get(at):null;if(ht){var ft=ht.parent,bt=inner$7(ft),wt=ft===tt?{width:it,height:st}:{width:bt.width,height:bt.height},Tt={},Ct=positionElement(ht,ot,wt,null,{hv:ot.hv,boundingMode:ot.bounding},Tt);if(!inner$7(ht).isNew&&Ct){for(var Dt=ot.transition,Ot={},$t=0;$t<ut.length;$t++){var Ft=ut[$t],kt=Tt[Ft];Dt&&(isTransitionAll(Dt)||indexOf(Dt,Ft)>=0)?Ot[Ft]=kt:ht[Ft]=kt}updateProps$1(ht,Ot,o,0)}else ht.attr(Tt)}}},a.prototype._clear=function(){var o=this,c=this._elMap;c.each(function(d){removeEl$1(d,inner$7(d).option,c,o._lastGraphicModel)}),this._elMap=createHashMap()},a.prototype.dispose=function(){this._clear()},a.type="graphic",a}(ComponentView);function newEl(s){var a=hasOwn(nonShapeGraphicElements,s)?nonShapeGraphicElements[s]:getShapeClass(s),o=new a({});return inner$7(o).type=s,o}function createEl(s,a,o,c){var d=newEl(o);return a.add(d),c.set(s,d),inner$7(d).id=s,inner$7(d).isNew=!0,d}function removeEl$1(s,a,o,c){var d=s&&s.parent;d&&(s.type==="group"&&s.traverse(function(tt){removeEl$1(tt,a,o,c)}),applyLeaveTransition(s,a,c),o.removeKey(inner$7(s).id))}function updateCommonAttrs(s,a,o,c){s.isGroup||each$f([["cursor",Displayable.prototype.cursor],["zlevel",c||0],["z",o||0],["z2",0]],function(d){var tt=d[0];hasOwn(a,tt)?s[tt]=retrieve2(a[tt],d[1]):s[tt]==null&&(s[tt]=d[1])}),each$f(keys(a),function(d){if(d.indexOf("on")===0){var tt=a[d];s[d]=isFunction$1(tt)?tt:null}}),hasOwn(a,"draggable")&&(s.draggable=a.draggable),a.name!=null&&(s.name=a.name),a.id!=null&&(s.id=a.id)}function getCleanedElOption(s){return s=extend({},s),each$f(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(LOCATION_PARAMS),function(a){delete s[a]}),s}function setEventData(s,a,o){var c=getECData(s).eventData;!s.silent&&!s.ignore&&!c&&(c=getECData(s).eventData={componentType:"graphic",componentIndex:a.componentIndex,name:s.name}),c&&(c.info=o.info)}function install$l(s){s.registerComponentModel(GraphicComponentModel),s.registerComponentView(GraphicComponentView),s.registerPreprocessor(function(a){var o=a.graphic;isArray$1(o)?!o[0]||!o[0].elements?a.graphic=[{elements:o}]:a.graphic=[a.graphic[0]]:o&&!o.elements&&(a.graphic=[{elements:[o]}])})}var DATA_ZOOM_AXIS_DIMENSIONS=["x","y","radius","angle","single"],SERIES_COORDS=["cartesian2d","polar","singleAxis"];function isCoordSupported(s){var a=s.get("coordinateSystem");return indexOf(SERIES_COORDS,a)>=0}function getAxisMainType(s){return s+"Axis"}function findEffectedDataZooms(s,a){var o=createHashMap(),c=[],d=createHashMap();s.eachComponent({mainType:"dataZoom",query:a},function(ct){d.get(ct.uid)||it(ct)});var tt;do tt=!1,s.eachComponent("dataZoom",nt);while(tt);function nt(ct){!d.get(ct.uid)&&st(ct)&&(it(ct),tt=!0)}function it(ct){d.set(ct.uid,!0),c.push(ct),ut(ct)}function st(ct){var ot=!1;return ct.eachTargetAxis(function(at,ht){var ft=o.get(at);ft&&ft[ht]&&(ot=!0)}),ot}function ut(ct){ct.eachTargetAxis(function(ot,at){(o.get(ot)||o.set(ot,[]))[at]=!0})}return c}function collectReferCoordSysModelInfo(s){var a=s.ecModel,o={infoList:[],infoMap:createHashMap()};return s.eachTargetAxis(function(c,d){var tt=a.getComponent(getAxisMainType(c),d);if(tt){var nt=tt.getCoordSysModel();if(nt){var it=nt.uid,st=o.infoMap.get(it);st||(st={model:nt,axisModels:[]},o.infoList.push(st),o.infoMap.set(it,st)),st.axisModels.push(tt)}}}),o}var DataZoomAxisInfo=function(){function s(){this.indexList=[],this.indexMap=[]}return s.prototype.add=function(a){this.indexMap[a]||(this.indexList.push(a),this.indexMap[a]=!0)},s}(),DataZoomModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._autoThrottle=!0,o._noTarget=!0,o._rangePropMode=["percent","percent"],o}return a.prototype.init=function(o,c,d){var tt=retrieveRawOption(o);this.settledOption=tt,this.mergeDefaultAndTheme(o,d),this._doInit(tt)},a.prototype.mergeOption=function(o){var c=retrieveRawOption(o);merge(this.option,o,!0),merge(this.settledOption,c,!0),this._doInit(c)},a.prototype._doInit=function(o){var c=this.option;this._setDefaultThrottle(o),this._updateRangeUse(o);var d=this.settledOption;each$f([["start","startValue"],["end","endValue"]],function(tt,nt){this._rangePropMode[nt]==="value"&&(c[tt[0]]=d[tt[0]]=null)},this),this._resetTarget()},a.prototype._resetTarget=function(){var o=this.get("orient",!0),c=this._targetAxisInfoMap=createHashMap(),d=this._fillSpecifiedTargetAxis(c);d?this._orient=o||this._makeAutoOrientByTargetAxis():(this._orient=o||"horizontal",this._fillAutoTargetAxisByOrient(c,this._orient)),this._noTarget=!0,c.each(function(tt){tt.indexList.length&&(this._noTarget=!1)},this)},a.prototype._fillSpecifiedTargetAxis=function(o){var c=!1;return each$f(DATA_ZOOM_AXIS_DIMENSIONS,function(d){var tt=this.getReferringComponents(getAxisMainType(d),MULTIPLE_REFERRING);if(tt.specified){c=!0;var nt=new DataZoomAxisInfo;each$f(tt.models,function(it){nt.add(it.componentIndex)}),o.set(d,nt)}},this),c},a.prototype._fillAutoTargetAxisByOrient=function(o,c){var d=this.ecModel,tt=!0;if(tt){var nt=c==="vertical"?"y":"x",it=d.findComponents({mainType:nt+"Axis"});st(it,nt)}if(tt){var it=d.findComponents({mainType:"singleAxis",filter:function(ct){return ct.get("orient",!0)===c}});st(it,"single")}function st(ut,ct){var ot=ut[0];if(ot){var at=new DataZoomAxisInfo;if(at.add(ot.componentIndex),o.set(ct,at),tt=!1,ct==="x"||ct==="y"){var ht=ot.getReferringComponents("grid",SINGLE_REFERRING).models[0];ht&&each$f(ut,function(ft){ot.componentIndex!==ft.componentIndex&&ht===ft.getReferringComponents("grid",SINGLE_REFERRING).models[0]&&at.add(ft.componentIndex)})}}}tt&&each$f(DATA_ZOOM_AXIS_DIMENSIONS,function(ut){if(tt){var ct=d.findComponents({mainType:getAxisMainType(ut),filter:function(at){return at.get("type",!0)==="category"}});if(ct[0]){var ot=new DataZoomAxisInfo;ot.add(ct[0].componentIndex),o.set(ut,ot),tt=!1}}},this)},a.prototype._makeAutoOrientByTargetAxis=function(){var o;return this.eachTargetAxis(function(c){!o&&(o=c)},this),o==="y"?"vertical":"horizontal"},a.prototype._setDefaultThrottle=function(o){if(o.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var c=this.ecModel.option;this.option.throttle=c.animation&&c.animationDurationUpdate>0?100:20}},a.prototype._updateRangeUse=function(o){var c=this._rangePropMode,d=this.get("rangeMode");each$f([["start","startValue"],["end","endValue"]],function(tt,nt){var it=o[tt[0]]!=null,st=o[tt[1]]!=null;it&&!st?c[nt]="percent":!it&&st?c[nt]="value":d?c[nt]=d[nt]:it&&(c[nt]="percent")})},a.prototype.noTarget=function(){return this._noTarget},a.prototype.getFirstTargetAxisModel=function(){var o;return this.eachTargetAxis(function(c,d){o==null&&(o=this.ecModel.getComponent(getAxisMainType(c),d))},this),o},a.prototype.eachTargetAxis=function(o,c){this._targetAxisInfoMap.each(function(d,tt){each$f(d.indexList,function(nt){o.call(c,tt,nt)})})},a.prototype.getAxisProxy=function(o,c){var d=this.getAxisModel(o,c);if(d)return d.__dzAxisProxy},a.prototype.getAxisModel=function(o,c){var d=this._targetAxisInfoMap.get(o);if(d&&d.indexMap[c])return this.ecModel.getComponent(getAxisMainType(o),c)},a.prototype.setRawRange=function(o){var c=this.option,d=this.settledOption;each$f([["start","startValue"],["end","endValue"]],function(tt){(o[tt[0]]!=null||o[tt[1]]!=null)&&(c[tt[0]]=d[tt[0]]=o[tt[0]],c[tt[1]]=d[tt[1]]=o[tt[1]])},this),this._updateRangeUse(o)},a.prototype.setCalculatedRange=function(o){var c=this.option;each$f(["start","startValue","end","endValue"],function(d){c[d]=o[d]})},a.prototype.getPercentRange=function(){var o=this.findRepresentativeAxisProxy();if(o)return o.getDataPercentWindow()},a.prototype.getValueRange=function(o,c){if(o==null&&c==null){var d=this.findRepresentativeAxisProxy();if(d)return d.getDataValueWindow()}else return this.getAxisProxy(o,c).getDataValueWindow()},a.prototype.findRepresentativeAxisProxy=function(o){if(o)return o.__dzAxisProxy;for(var c,d=this._targetAxisInfoMap.keys(),tt=0;tt<d.length;tt++)for(var nt=d[tt],it=this._targetAxisInfoMap.get(nt),st=0;st<it.indexList.length;st++){var ut=this.getAxisProxy(nt,it.indexList[st]);if(ut.hostedBy(this))return ut;c||(c=ut)}return c},a.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},a.prototype.getOrient=function(){return this._orient},a.type="dataZoom",a.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],a.defaultOption={z:4,filterMode:"filter",start:0,end:100},a}(ComponentModel);function retrieveRawOption(s){var a={};return each$f(["start","end","startValue","endValue","throttle"],function(o){s.hasOwnProperty(o)&&(a[o]=s[o])}),a}var SelectDataZoomModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="dataZoom.select",a}(DataZoomModel),DataZoomView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d,tt){this.dataZoomModel=o,this.ecModel=c,this.api=d},a.type="dataZoom",a}(ComponentView),SelectDataZoomView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="dataZoom.select",a}(DataZoomView),each$7=each$f,asc$1=asc$2,AxisProxy=function(){function s(a,o,c,d){this._dimName=a,this._axisIndex=o,this.ecModel=d,this._dataZoomModel=c}return s.prototype.hostedBy=function(a){return this._dataZoomModel===a},s.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},s.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},s.prototype.getTargetSeriesModels=function(){var a=[];return this.ecModel.eachSeries(function(o){if(isCoordSupported(o)){var c=getAxisMainType(this._dimName),d=o.getReferringComponents(c,SINGLE_REFERRING).models[0];d&&this._axisIndex===d.componentIndex&&a.push(o)}},this),a},s.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},s.prototype.getMinMaxSpan=function(){return clone$4(this._minMaxSpan)},s.prototype.calculateDataWindow=function(a){var o=this._dataExtent,c=this.getAxisModel(),d=c.axis.scale,tt=this._dataZoomModel.getRangePropMode(),nt=[0,100],it=[],st=[],ut;each$7(["start","end"],function(at,ht){var ft=a[at],mt=a[at+"Value"];tt[ht]==="percent"?(ft==null&&(ft=nt[ht]),mt=d.parse(linearMap$2(ft,nt,o))):(ut=!0,mt=mt==null?o[ht]:d.parse(mt),ft=linearMap$2(mt,o,nt)),st[ht]=mt==null||isNaN(mt)?o[ht]:mt,it[ht]=ft==null||isNaN(ft)?nt[ht]:ft}),asc$1(st),asc$1(it);var ct=this._minMaxSpan;ut?ot(st,it,o,nt,!1):ot(it,st,nt,o,!0);function ot(at,ht,ft,mt,yt){var bt=yt?"Span":"ValueSpan";sliderMove(0,at,ft,"all",ct["min"+bt],ct["max"+bt]);for(var wt=0;wt<2;wt++)ht[wt]=linearMap$2(at[wt],ft,mt,!0),yt&&(ht[wt]=d.parse(ht[wt]))}return{valueWindow:st,percentWindow:it}},s.prototype.reset=function(a){if(a===this._dataZoomModel){var o=this.getTargetSeriesModels();this._dataExtent=calculateDataExtent(this,this._dimName,o),this._updateMinMaxSpan();var c=this.calculateDataWindow(a.settledOption);this._valueWindow=c.valueWindow,this._percentWindow=c.percentWindow,this._setAxisModel()}},s.prototype.filterData=function(a,o){if(a!==this._dataZoomModel)return;var c=this._dimName,d=this.getTargetSeriesModels(),tt=a.get("filterMode"),nt=this._valueWindow;if(tt==="none")return;each$7(d,function(st){var ut=st.getData(),ct=ut.mapDimensionsAll(c);if(ct.length){if(tt==="weakFilter"){var ot=ut.getStore(),at=map$1(ct,function(ht){return ut.getDimensionIndex(ht)},ut);ut.filterSelf(function(ht){for(var ft,mt,yt,bt=0;bt<ct.length;bt++){var wt=ot.get(at[bt],ht),Tt=!isNaN(wt),Ct=wt<nt[0],Dt=wt>nt[1];if(Tt&&!Ct&&!Dt)return!0;Tt&&(yt=!0),Ct&&(ft=!0),Dt&&(mt=!0)}return yt&&ft&&mt})}else each$7(ct,function(ht){if(tt==="empty")st.setData(ut=ut.map(ht,function(mt){return it(mt)?mt:NaN}));else{var ft={};ft[ht]=nt,ut.selectRange(ft)}});each$7(ct,function(ht){ut.setApproximateExtent(nt,ht)})}});function it(st){return st>=nt[0]&&st<=nt[1]}},s.prototype._updateMinMaxSpan=function(){var a=this._minMaxSpan={},o=this._dataZoomModel,c=this._dataExtent;each$7(["min","max"],function(d){var tt=o.get(d+"Span"),nt=o.get(d+"ValueSpan");nt!=null&&(nt=this.getAxisModel().axis.scale.parse(nt)),nt!=null?tt=linearMap$2(c[0]+nt,c,[0,100],!0):tt!=null&&(nt=linearMap$2(tt,[0,100],c,!0)-c[0]),a[d+"Span"]=tt,a[d+"ValueSpan"]=nt},this)},s.prototype._setAxisModel=function(){var a=this.getAxisModel(),o=this._percentWindow,c=this._valueWindow;if(o){var d=getPixelPrecision(c,[0,500]);d=Math.min(d,20);var tt=a.axis.scale.rawExtentInfo;o[0]!==0&&tt.setDeterminedMinMax("min",+c[0].toFixed(d)),o[1]!==100&&tt.setDeterminedMinMax("max",+c[1].toFixed(d)),tt.freeze()}},s}();function calculateDataExtent(s,a,o){var c=[1/0,-1/0];each$7(o,function(nt){unionAxisExtentFromData(c,nt.getData(),a)});var d=s.getAxisModel(),tt=ensureScaleRawExtentInfo(d.axis.scale,d,c).calculate();return[tt.min,tt.max]}var dataZoomProcessor={getTargetSeries:function(s){function a(d){s.eachComponent("dataZoom",function(tt){tt.eachTargetAxis(function(nt,it){var st=s.getComponent(getAxisMainType(nt),it);d(nt,it,st,tt)})})}a(function(d,tt,nt,it){nt.__dzAxisProxy=null});var o=[];a(function(d,tt,nt,it){nt.__dzAxisProxy||(nt.__dzAxisProxy=new AxisProxy(d,tt,it,s),o.push(nt.__dzAxisProxy))});var c=createHashMap();return each$f(o,function(d){each$f(d.getTargetSeriesModels(),function(tt){c.set(tt.uid,tt)})}),c},overallReset:function(s,a){s.eachComponent("dataZoom",function(o){o.eachTargetAxis(function(c,d){o.getAxisProxy(c,d).reset(o)}),o.eachTargetAxis(function(c,d){o.getAxisProxy(c,d).filterData(o,a)})}),s.eachComponent("dataZoom",function(o){var c=o.findRepresentativeAxisProxy();if(c){var d=c.getDataPercentWindow(),tt=c.getDataValueWindow();o.setCalculatedRange({start:d[0],end:d[1],startValue:tt[0],endValue:tt[1]})}})}};function installDataZoomAction(s){s.registerAction("dataZoom",function(a,o){var c=findEffectedDataZooms(o,a);each$f(c,function(d){d.setRawRange({start:a.start,end:a.end,startValue:a.startValue,endValue:a.endValue})})})}var installed$1=!1;function installCommon$1(s){installed$1||(installed$1=!0,s.registerProcessor(s.PRIORITY.PROCESSOR.FILTER,dataZoomProcessor),installDataZoomAction(s),s.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function install$k(s){s.registerComponentModel(SelectDataZoomModel),s.registerComponentView(SelectDataZoomView),installCommon$1(s)}var ToolboxFeature=function(){function s(){}return s}(),features={};function registerFeature(s,a){features[s]=a}function getFeature(s){return features[s]}var ToolboxModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.optionUpdated=function(){s.prototype.optionUpdated.apply(this,arguments);var o=this.ecModel;each$f(this.option.feature,function(c,d){var tt=getFeature(d);tt&&(tt.getDefaultOption&&(tt.defaultOption=tt.getDefaultOption(o)),merge(c,tt.defaultOption))})},a.type="toolbox",a.layoutMode={type:"box",ignoreSize:!0},a.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},a}(ComponentModel);function layout(s,a,o){var c=a.getBoxLayoutParams(),d=a.get("padding"),tt={width:o.getWidth(),height:o.getHeight()},nt=getLayoutRect(c,tt,d);box(a.get("orient"),s,a.get("itemGap"),nt.width,nt.height),positionElement(s,c,tt,d)}function makeBackground(s,a){var o=normalizeCssArray(a.get("padding")),c=a.getItemStyle(["color","opacity"]);return c.fill=a.get("backgroundColor"),s=new Rect$2({shape:{x:s.x-o[3],y:s.y-o[0],width:s.width+o[1]+o[3],height:s.height+o[0]+o[2],r:a.get("borderRadius")},style:c,silent:!0,z2:-1}),s}var ToolboxView=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.render=function(o,c,d,tt){var nt=this.group;if(nt.removeAll(),!o.get("show"))return;var it=+o.get("itemSize"),st=o.get("orient")==="vertical",ut=o.get("feature")||{},ct=this._features||(this._features={}),ot=[];each$f(ut,function(ft,mt){ot.push(mt)}),new DataDiffer(this._featureNames||[],ot).add(at).update(at).remove(curry$1(at,null)).execute(),this._featureNames=ot;function at(ft,mt){var yt=ot[ft],bt=ot[mt],wt=ut[yt],Tt=new Model(wt,o,o.ecModel),Ct;if(tt&&tt.newTitle!=null&&tt.featureName===yt&&(wt.title=tt.newTitle),yt&&!bt){if(isUserFeatureName(yt))Ct={onclick:Tt.option.onclick,featureName:yt};else{var Dt=getFeature(yt);if(!Dt)return;Ct=new Dt}ct[yt]=Ct}else if(Ct=ct[bt],!Ct)return;Ct.uid=getUID("toolbox-feature"),Ct.model=Tt,Ct.ecModel=c,Ct.api=d;var Ot=Ct instanceof ToolboxFeature;if(!yt&&bt){Ot&&Ct.dispose&&Ct.dispose(c,d);return}if(!Tt.get("show")||Ot&&Ct.unusable){Ot&&Ct.remove&&Ct.remove(c,d);return}ht(Tt,Ct,yt),Tt.setIconStatus=function($t,Ft){var kt=this.option,Vt=this.iconPaths;kt.iconStatus=kt.iconStatus||{},kt.iconStatus[$t]=Ft,Vt[$t]&&(Ft==="emphasis"?enterEmphasis:leaveEmphasis)(Vt[$t])},Ct instanceof ToolboxFeature&&Ct.render&&Ct.render(Tt,c,d,tt)}function ht(ft,mt,yt){var bt=ft.getModel("iconStyle"),wt=ft.getModel(["emphasis","iconStyle"]),Tt=mt instanceof ToolboxFeature&&mt.getIcons?mt.getIcons():ft.get("icon"),Ct=ft.get("title")||{},Dt,Ot;isString$1(Tt)?(Dt={},Dt[yt]=Tt):Dt=Tt,isString$1(Ct)?(Ot={},Ot[yt]=Ct):Ot=Ct;var $t=ft.iconPaths={};each$f(Dt,function(Ft,kt){var Vt=createIcon(Ft,{},{x:-it/2,y:-it/2,width:it,height:it});Vt.setStyle(bt.getItemStyle());var Ht=Vt.ensureState("emphasis");Ht.style=wt.getItemStyle();var Qt=new ZRText({style:{text:Ot[kt],align:wt.get("textAlign"),borderRadius:wt.get("textBorderRadius"),padding:wt.get("textPadding"),fill:null,font:getFont({fontStyle:wt.get("textFontStyle"),fontFamily:wt.get("textFontFamily"),fontSize:wt.get("textFontSize"),fontWeight:wt.get("textFontWeight")},c)},ignore:!0});Vt.setTextContent(Qt),setTooltipConfig({el:Vt,componentModel:o,itemName:kt,formatterParamsExtra:{title:Ot[kt]}}),Vt.__title=Ot[kt],Vt.on("mouseover",function(){var Xt=wt.getItemStyle(),Zt=st?o.get("right")==null&&o.get("left")!=="right"?"right":"left":o.get("bottom")==null&&o.get("top")!=="bottom"?"bottom":"top";Qt.setStyle({fill:wt.get("textFill")||Xt.fill||Xt.stroke||"#000",backgroundColor:wt.get("textBackgroundColor")}),Vt.setTextConfig({position:wt.get("textPosition")||Zt}),Qt.ignore=!o.get("showTitle"),d.enterEmphasis(this)}).on("mouseout",function(){ft.get(["iconStatus",kt])!=="emphasis"&&d.leaveEmphasis(this),Qt.hide()}),(ft.get(["iconStatus",kt])==="emphasis"?enterEmphasis:leaveEmphasis)(Vt),nt.add(Vt),Vt.on("click",bind$2(mt.onclick,mt,c,d,kt)),$t[kt]=Vt})}layout(nt,o,d),nt.add(makeBackground(nt.getBoundingRect(),o)),st||nt.eachChild(function(ft){var mt=ft.__title,yt=ft.ensureState("emphasis"),bt=yt.textConfig||(yt.textConfig={}),wt=ft.getTextContent(),Tt=wt&&wt.ensureState("emphasis");if(Tt&&!isFunction$1(Tt)&&mt){var Ct=Tt.style||(Tt.style={}),Dt=getBoundingRect(mt,ZRText.makeFont(Ct)),Ot=ft.x+nt.x,$t=ft.y+nt.y+it,Ft=!1;$t+Dt.height>d.getHeight()&&(bt.position="top",Ft=!0);var kt=Ft?-5-Dt.height:it+10;Ot+Dt.width/2>d.getWidth()?(bt.position=["100%",kt],Ct.align="right"):Ot-Dt.width/2<0&&(bt.position=[0,kt],Ct.align="left")}})},a.prototype.updateView=function(o,c,d,tt){each$f(this._features,function(nt){nt instanceof ToolboxFeature&&nt.updateView&&nt.updateView(nt.model,c,d,tt)})},a.prototype.remove=function(o,c){each$f(this._features,function(d){d instanceof ToolboxFeature&&d.remove&&d.remove(o,c)}),this.group.removeAll()},a.prototype.dispose=function(o,c){each$f(this._features,function(d){d instanceof ToolboxFeature&&d.dispose&&d.dispose(o,c)})},a.type="toolbox",a}(ComponentView);function isUserFeatureName(s){return s.indexOf("my")===0}var SaveAsImage=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.onclick=function(o,c){var d=this.model,tt=d.get("name")||o.get("title.0.text")||"echarts",nt=c.getZr().painter.getType()==="svg",it=nt?"svg":d.get("type",!0)||"png",st=c.getConnectedDataURL({type:it,backgroundColor:d.get("backgroundColor",!0)||o.get("backgroundColor")||"#fff",connectedBackgroundColor:d.get("connectedBackgroundColor"),excludeComponents:d.get("excludeComponents"),pixelRatio:d.get("pixelRatio")}),ut=env.browser;if(typeof MouseEvent=="function"&&(ut.newEdge||!ut.ie&&!ut.edge)){var ct=document.createElement("a");ct.download=tt+"."+it,ct.target="_blank",ct.href=st;var ot=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});ct.dispatchEvent(ot)}else if(window.navigator.msSaveOrOpenBlob||nt){var at=st.split(","),ht=at[0].indexOf("base64")>-1,ft=nt?decodeURIComponent(at[1]):at[1];ht&&(ft=window.atob(ft));var mt=tt+"."+it;if(window.navigator.msSaveOrOpenBlob){for(var yt=ft.length,bt=new Uint8Array(yt);yt--;)bt[yt]=ft.charCodeAt(yt);var wt=new Blob([bt]);window.navigator.msSaveOrOpenBlob(wt,mt)}else{var Tt=document.createElement("iframe");document.body.appendChild(Tt);var Ct=Tt.contentWindow,Dt=Ct.document;Dt.open("image/svg+xml","replace"),Dt.write(ft),Dt.close(),Ct.focus(),Dt.execCommand("SaveAs",!0,mt),document.body.removeChild(Tt)}}else{var Ot=d.get("lang"),$t='<body style="margin:0;"><img src="'+st+'" style="max-width:100%;" title="'+(Ot&&Ot[0]||"")+'" /></body>',Ft=window.open();Ft.document.write($t),Ft.document.title=tt}},a.getDefaultOption=function(o){var c={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:o.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:o.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return c},a}(ToolboxFeature),INNER_STACK_KEYWORD="__ec_magicType_stack__",radioTypes=[["line","bar"],["stack"]],MagicType=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.getIcons=function(){var o=this.model,c=o.get("icon"),d={};return each$f(o.get("type"),function(tt){c[tt]&&(d[tt]=c[tt])}),d},a.getDefaultOption=function(o){var c={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:o.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return c},a.prototype.onclick=function(o,c,d){var tt=this.model,nt=tt.get(["seriesIndex",d]);if(seriesOptGenreator[d]){var it={series:[]},st=function(ot){var at=ot.subType,ht=ot.id,ft=seriesOptGenreator[d](at,ht,ot,tt);ft&&(defaults(ft,ot.option),it.series.push(ft));var mt=ot.coordinateSystem;if(mt&&mt.type==="cartesian2d"&&(d==="line"||d==="bar")){var yt=mt.getAxesByScale("ordinal")[0];if(yt){var bt=yt.dim,wt=bt+"Axis",Tt=ot.getReferringComponents(wt,SINGLE_REFERRING).models[0],Ct=Tt.componentIndex;it[wt]=it[wt]||[];for(var Dt=0;Dt<=Ct;Dt++)it[wt][Ct]=it[wt][Ct]||{};it[wt][Ct].boundaryGap=d==="bar"}}};each$f(radioTypes,function(ot){indexOf(ot,d)>=0&&each$f(ot,function(at){tt.setIconStatus(at,"normal")})}),tt.setIconStatus(d,"emphasis"),o.eachComponent({mainType:"series",query:nt==null?null:{seriesIndex:nt}},st);var ut,ct=d;d==="stack"&&(ut=merge({stack:tt.option.title.tiled,tiled:tt.option.title.stack},tt.option.title),tt.get(["iconStatus",d])!=="emphasis"&&(ct="tiled")),c.dispatchAction({type:"changeMagicType",currentType:ct,newOption:it,newTitle:ut,featureName:"magicType"})}},a}(ToolboxFeature),seriesOptGenreator={line:function(s,a,o,c){if(s==="bar")return merge({id:a,type:"line",data:o.get("data"),stack:o.get("stack"),markPoint:o.get("markPoint"),markLine:o.get("markLine")},c.get(["option","line"])||{},!0)},bar:function(s,a,o,c){if(s==="line")return merge({id:a,type:"bar",data:o.get("data"),stack:o.get("stack"),markPoint:o.get("markPoint"),markLine:o.get("markLine")},c.get(["option","bar"])||{},!0)},stack:function(s,a,o,c){var d=o.get("stack")===INNER_STACK_KEYWORD;if(s==="line"||s==="bar")return c.setIconStatus("stack",d?"normal":"emphasis"),merge({id:a,stack:d?"":INNER_STACK_KEYWORD},c.get(["option","stack"])||{},!0)}};registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(s,a){a.mergeOption(s.newOption)});var BLOCK_SPLITER=new Array(60).join("-"),ITEM_SPLITER="	";function groupSeries(s){var a={},o=[],c=[];return s.eachRawSeries(function(d){var tt=d.coordinateSystem;if(tt&&(tt.type==="cartesian2d"||tt.type==="polar")){var nt=tt.getBaseAxis();if(nt.type==="category"){var it=nt.dim+"_"+nt.index;a[it]||(a[it]={categoryAxis:nt,valueAxis:tt.getOtherAxis(nt),series:[]},c.push({axisDim:nt.dim,axisIndex:nt.index})),a[it].series.push(d)}else o.push(d)}else o.push(d)}),{seriesGroupByCategoryAxis:a,other:o,meta:c}}function assembleSeriesWithCategoryAxis(s){var a=[];return each$f(s,function(o,c){var d=o.categoryAxis,tt=o.valueAxis,nt=tt.dim,it=[" "].concat(map$1(o.series,function(ht){return ht.name})),st=[d.model.getCategories()];each$f(o.series,function(ht){var ft=ht.getRawData();st.push(ht.getRawData().mapArray(ft.mapDimension(nt),function(mt){return mt}))});for(var ut=[it.join(ITEM_SPLITER)],ct=0;ct<st[0].length;ct++){for(var ot=[],at=0;at<st.length;at++)ot.push(st[at][ct]);ut.push(ot.join(ITEM_SPLITER))}a.push(ut.join(`
`))}),a.join(`

`+BLOCK_SPLITER+`

`)}function assembleOtherSeries(s){return map$1(s,function(a){var o=a.getRawData(),c=[a.name],d=[];return o.each(o.dimensions,function(){for(var tt=arguments.length,nt=arguments[tt-1],it=o.getName(nt),st=0;st<tt-1;st++)d[st]=arguments[st];c.push((it?it+ITEM_SPLITER:"")+d.join(ITEM_SPLITER))}),c.join(`
`)}).join(`

`+BLOCK_SPLITER+`

`)}function getContentFromModel(s){var a=groupSeries(s);return{value:filter([assembleSeriesWithCategoryAxis(a.seriesGroupByCategoryAxis),assembleOtherSeries(a.other)],function(o){return!!o.replace(/[\n\t\s]/g,"")}).join(`

`+BLOCK_SPLITER+`

`),meta:a.meta}}function trim(s){return s.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function isTSVFormat(s){var a=s.slice(0,s.indexOf(`
`));if(a.indexOf(ITEM_SPLITER)>=0)return!0}var itemSplitRegex=new RegExp("["+ITEM_SPLITER+"]+","g");function parseTSVContents(s){for(var a=s.split(/\n+/g),o=trim(a.shift()).split(itemSplitRegex),c=[],d=map$1(o,function(st){return{name:st,data:[]}}),tt=0;tt<a.length;tt++){var nt=trim(a[tt]).split(itemSplitRegex);c.push(nt.shift());for(var it=0;it<nt.length;it++)d[it]&&(d[it].data[tt]=nt[it])}return{series:d,categories:c}}function parseListContents(s){for(var a=s.split(/\n+/g),o=trim(a.shift()),c=[],d=0;d<a.length;d++){var tt=trim(a[d]);if(tt){var nt=tt.split(itemSplitRegex),it="",st=void 0,ut=!1;isNaN(nt[0])?(ut=!0,it=nt[0],nt=nt.slice(1),c[d]={name:it,value:[]},st=c[d].value):st=c[d]=[];for(var ct=0;ct<nt.length;ct++)st.push(+nt[ct]);st.length===1&&(ut?c[d].value=st[0]:c[d]=st[0])}}return{name:o,data:c}}function parseContents(s,a){var o=s.split(new RegExp(`
*`+BLOCK_SPLITER+`
*`,"g")),c={series:[]};return each$f(o,function(d,tt){if(isTSVFormat(d)){var nt=parseTSVContents(d),it=a[tt],st=it.axisDim+"Axis";it&&(c[st]=c[st]||[],c[st][it.axisIndex]={data:nt.categories},c.series=c.series.concat(nt.series))}else{var nt=parseListContents(d);c.series.push(nt)}}),c}var DataView$1=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.onclick=function(o,c){setTimeout(function(){c.dispatchAction({type:"hideTip"})});var d=c.getDom(),tt=this.model;this._dom&&d.removeChild(this._dom);var nt=document.createElement("div");nt.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",nt.style.backgroundColor=tt.get("backgroundColor")||"#fff";var it=document.createElement("h4"),st=tt.get("lang")||[];it.innerHTML=st[0]||tt.get("title"),it.style.cssText="margin:10px 20px",it.style.color=tt.get("textColor");var ut=document.createElement("div"),ct=document.createElement("textarea");ut.style.cssText="overflow:auto";var ot=tt.get("optionToContent"),at=tt.get("contentToOption"),ht=getContentFromModel(o);if(isFunction$1(ot)){var ft=ot(c.getOption());isString$1(ft)?ut.innerHTML=ft:isDom(ft)&&ut.appendChild(ft)}else{ct.readOnly=tt.get("readOnly");var mt=ct.style;mt.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",mt.color=tt.get("textColor"),mt.borderColor=tt.get("textareaBorderColor"),mt.backgroundColor=tt.get("textareaColor"),ct.value=ht.value,ut.appendChild(ct)}var yt=ht.meta,bt=document.createElement("div");bt.style.cssText="position:absolute;bottom:5px;left:0;right:0";var wt="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",Tt=document.createElement("div"),Ct=document.createElement("div");wt+=";background-color:"+tt.get("buttonColor"),wt+=";color:"+tt.get("buttonTextColor");var Dt=this;function Ot(){d.removeChild(nt),Dt._dom=null}addEventListener$1(Tt,"click",Ot),addEventListener$1(Ct,"click",function(){if(at==null&&ot!=null||at!=null&&ot==null){Ot();return}var $t;try{isFunction$1(at)?$t=at(ut,c.getOption()):$t=parseContents(ct.value,yt)}catch(Ft){throw Ot(),new Error("Data view format error "+Ft)}$t&&c.dispatchAction({type:"changeDataView",newOption:$t}),Ot()}),Tt.innerHTML=st[1],Ct.innerHTML=st[2],Ct.style.cssText=Tt.style.cssText=wt,!tt.get("readOnly")&&bt.appendChild(Ct),bt.appendChild(Tt),nt.appendChild(it),nt.appendChild(ut),nt.appendChild(bt),ut.style.height=d.clientHeight-80+"px",d.appendChild(nt),this._dom=nt},a.prototype.remove=function(o,c){this._dom&&c.getDom().removeChild(this._dom)},a.prototype.dispose=function(o,c){this.remove(o,c)},a.getDefaultOption=function(o){var c={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:o.getLocaleModel().get(["toolbox","dataView","title"]),lang:o.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return c},a}(ToolboxFeature);function tryMergeDataOption(s,a){return map$1(s,function(o,c){var d=a&&a[c];if(isObject$3(d)&&!isArray$1(d)){var tt=isObject$3(o)&&!isArray$1(o);tt||(o={value:o});var nt=d.name!=null&&o.name==null;return o=defaults(o,d),nt&&delete o.name,o}else return o})}registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(s,a){var o=[];each$f(s.newOption.series,function(c){var d=a.getSeriesByName(c.name)[0];if(!d)o.push(extend({type:"scatter"},c));else{var tt=d.get("data");o.push({name:c.name,data:tryMergeDataOption(c.data,tt)})}}),a.mergeOption(defaults({series:o},s.newOption))});var each$6=each$f,inner$6=makeInner();function push(s,a){var o=getStoreSnapshots(s);each$6(a,function(c,d){for(var tt=o.length-1;tt>=0;tt--){var nt=o[tt];if(nt[d])break}if(tt<0){var it=s.queryComponents({mainType:"dataZoom",subType:"select",id:d})[0];if(it){var st=it.getPercentRange();o[0][d]={dataZoomId:d,start:st[0],end:st[1]}}}}),o.push(a)}function pop(s){var a=getStoreSnapshots(s),o=a[a.length-1];a.length>1&&a.pop();var c={};return each$6(o,function(d,tt){for(var nt=a.length-1;nt>=0;nt--)if(d=a[nt][tt],d){c[tt]=d;break}}),c}function clear$1(s){inner$6(s).snapshots=null}function count(s){return getStoreSnapshots(s).length}function getStoreSnapshots(s){var a=inner$6(s);return a.snapshots||(a.snapshots=[{}]),a.snapshots}var RestoreOption=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.onclick=function(o,c){clear$1(o),c.dispatchAction({type:"restore",from:this.uid})},a.getDefaultOption=function(o){var c={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:o.getLocaleModel().get(["toolbox","restore","title"])};return c},a}(ToolboxFeature);registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},function(s,a){a.resetOption("recreate")});var INCLUDE_FINDER_MAIN_TYPES=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],BrushTargetManager=function(){function s(a,o,c){var d=this;this._targetInfoList=[];var tt=parseFinder(o,a);each$f(targetInfoBuilders,function(nt,it){(!c||!c.include||indexOf(c.include,it)>=0)&&nt(tt,d._targetInfoList)})}return s.prototype.setOutputRanges=function(a,o){return this.matchOutputRanges(a,o,function(c,d,tt){if((c.coordRanges||(c.coordRanges=[])).push(d),!c.coordRange){c.coordRange=d;var nt=coordConvert[c.brushType](0,tt,d);c.__rangeOffset={offset:diffProcessor[c.brushType](nt.values,c.range,[1,1]),xyMinMax:nt.xyMinMax}}}),a},s.prototype.matchOutputRanges=function(a,o,c){each$f(a,function(d){var tt=this.findTargetInfo(d,o);tt&&tt!==!0&&each$f(tt.coordSyses,function(nt){var it=coordConvert[d.brushType](1,nt,d.range,!0);c(d,it.values,nt,o)})},this)},s.prototype.setInputRanges=function(a,o){each$f(a,function(c){var d=this.findTargetInfo(c,o);if(c.range=c.range||[],d&&d!==!0){c.panelId=d.panelId;var tt=coordConvert[c.brushType](0,d.coordSys,c.coordRange),nt=c.__rangeOffset;c.range=nt?diffProcessor[c.brushType](tt.values,nt.offset,getScales(tt.xyMinMax,nt.xyMinMax)):tt.values}},this)},s.prototype.makePanelOpts=function(a,o){return map$1(this._targetInfoList,function(c){var d=c.getPanelRect();return{panelId:c.panelId,defaultBrushType:o?o(c):null,clipPath:makeRectPanelClipPath(d),isTargetByCursor:makeRectIsTargetByCursor(d,a,c.coordSysModel),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(d)}})},s.prototype.controlSeries=function(a,o,c){var d=this.findTargetInfo(a,c);return d===!0||d&&indexOf(d.coordSyses,o.coordinateSystem)>=0},s.prototype.findTargetInfo=function(a,o){for(var c=this._targetInfoList,d=parseFinder(o,a),tt=0;tt<c.length;tt++){var nt=c[tt],it=a.panelId;if(it){if(nt.panelId===it)return nt}else for(var st=0;st<targetInfoMatchers.length;st++)if(targetInfoMatchers[st](d,nt))return nt}return!0},s}();function formatMinMax(s){return s[0]>s[1]&&s.reverse(),s}function parseFinder(s,a){return parseFinder$1(s,a,{includeMainTypes:INCLUDE_FINDER_MAIN_TYPES})}var targetInfoBuilders={grid:function(s,a){var o=s.xAxisModels,c=s.yAxisModels,d=s.gridModels,tt=createHashMap(),nt={},it={};!o&&!c&&!d||(each$f(o,function(st){var ut=st.axis.grid.model;tt.set(ut.id,ut),nt[ut.id]=!0}),each$f(c,function(st){var ut=st.axis.grid.model;tt.set(ut.id,ut),it[ut.id]=!0}),each$f(d,function(st){tt.set(st.id,st),nt[st.id]=!0,it[st.id]=!0}),tt.each(function(st){var ut=st.coordinateSystem,ct=[];each$f(ut.getCartesians(),function(ot,at){(indexOf(o,ot.getAxis("x").model)>=0||indexOf(c,ot.getAxis("y").model)>=0)&&ct.push(ot)}),a.push({panelId:"grid--"+st.id,gridModel:st,coordSysModel:st,coordSys:ct[0],coordSyses:ct,getPanelRect:panelRectBuilders.grid,xAxisDeclared:nt[st.id],yAxisDeclared:it[st.id]})}))},geo:function(s,a){each$f(s.geoModels,function(o){var c=o.coordinateSystem;a.push({panelId:"geo--"+o.id,geoModel:o,coordSysModel:o,coordSys:c,coordSyses:[c],getPanelRect:panelRectBuilders.geo})})}},targetInfoMatchers=[function(s,a){var o=s.xAxisModel,c=s.yAxisModel,d=s.gridModel;return!d&&o&&(d=o.axis.grid.model),!d&&c&&(d=c.axis.grid.model),d&&d===a.gridModel},function(s,a){var o=s.geoModel;return o&&o===a.geoModel}],panelRectBuilders={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var s=this.coordSys,a=s.getBoundingRect().clone();return a.applyTransform(getTransform$1(s)),a}},coordConvert={lineX:curry$1(axisConvert,0),lineY:curry$1(axisConvert,1),rect:function(s,a,o,c){var d=s?a.pointToData([o[0][0],o[1][0]],c):a.dataToPoint([o[0][0],o[1][0]],c),tt=s?a.pointToData([o[0][1],o[1][1]],c):a.dataToPoint([o[0][1],o[1][1]],c),nt=[formatMinMax([d[0],tt[0]]),formatMinMax([d[1],tt[1]])];return{values:nt,xyMinMax:nt}},polygon:function(s,a,o,c){var d=[[1/0,-1/0],[1/0,-1/0]],tt=map$1(o,function(nt){var it=s?a.pointToData(nt,c):a.dataToPoint(nt,c);return d[0][0]=Math.min(d[0][0],it[0]),d[1][0]=Math.min(d[1][0],it[1]),d[0][1]=Math.max(d[0][1],it[0]),d[1][1]=Math.max(d[1][1],it[1]),it});return{values:tt,xyMinMax:d}}};function axisConvert(s,a,o,c){var d=o.getAxis(["x","y"][s]),tt=formatMinMax(map$1([0,1],function(it){return a?d.coordToData(d.toLocalCoord(c[it]),!0):d.toGlobalCoord(d.dataToCoord(c[it]))})),nt=[];return nt[s]=tt,nt[1-s]=[NaN,NaN],{values:tt,xyMinMax:nt}}var diffProcessor={lineX:curry$1(axisDiffProcessor,0),lineY:curry$1(axisDiffProcessor,1),rect:function(s,a,o){return[[s[0][0]-o[0]*a[0][0],s[0][1]-o[0]*a[0][1]],[s[1][0]-o[1]*a[1][0],s[1][1]-o[1]*a[1][1]]]},polygon:function(s,a,o){return map$1(s,function(c,d){return[c[0]-o[0]*a[d][0],c[1]-o[1]*a[d][1]]})}};function axisDiffProcessor(s,a,o,c){return[a[0]-c[s]*o[0],a[1]-c[s]*o[1]]}function getScales(s,a){var o=getSize(s),c=getSize(a),d=[o[0]/c[0],o[1]/c[1]];return isNaN(d[0])&&(d[0]=1),isNaN(d[1])&&(d[1]=1),d}function getSize(s){return s?[s[0][1]-s[0][0],s[1][1]-s[1][0]]:[NaN,NaN]}var each$5=each$f,DATA_ZOOM_ID_BASE=makeInternalComponentId("toolbox-dataZoom_"),DataZoomFeature=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.render=function(o,c,d,tt){this._brushController||(this._brushController=new BrushController(d.getZr()),this._brushController.on("brush",bind$2(this._onBrush,this)).mount()),updateZoomBtnStatus(o,c,this,tt,d),updateBackBtnStatus(o,c)},a.prototype.onclick=function(o,c,d){handlers[d].call(this)},a.prototype.remove=function(o,c){this._brushController&&this._brushController.unmount()},a.prototype.dispose=function(o,c){this._brushController&&this._brushController.dispose()},a.prototype._onBrush=function(o){var c=o.areas;if(!o.isEnd||!c.length)return;var d={},tt=this.ecModel;this._brushController.updateCovers([]);var nt=new BrushTargetManager(makeAxisFinder(this.model),tt,{include:["grid"]});nt.matchOutputRanges(c,tt,function(ut,ct,ot){if(ot.type==="cartesian2d"){var at=ut.brushType;at==="rect"?(it("x",ot,ct[0]),it("y",ot,ct[1])):it({lineX:"x",lineY:"y"}[at],ot,ct)}}),push(tt,d),this._dispatchZoomAction(d);function it(ut,ct,ot){var at=ct.getAxis(ut),ht=at.model,ft=st(ut,ht,tt),mt=ft.findRepresentativeAxisProxy(ht).getMinMaxSpan();(mt.minValueSpan!=null||mt.maxValueSpan!=null)&&(ot=sliderMove(0,ot.slice(),at.scale.getExtent(),0,mt.minValueSpan,mt.maxValueSpan)),ft&&(d[ft.id]={dataZoomId:ft.id,startValue:ot[0],endValue:ot[1]})}function st(ut,ct,ot){var at;return ot.eachComponent({mainType:"dataZoom",subType:"select"},function(ht){var ft=ht.getAxisModel(ut,ct.componentIndex);ft&&(at=ht)}),at}},a.prototype._dispatchZoomAction=function(o){var c=[];each$5(o,function(d,tt){c.push(clone$4(d))}),c.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:c})},a.getDefaultOption=function(o){var c={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:o.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return c},a}(ToolboxFeature),handlers={zoom:function(){var s=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:s})},back:function(){this._dispatchZoomAction(pop(this.ecModel))}};function makeAxisFinder(s){var a={xAxisIndex:s.get("xAxisIndex",!0),yAxisIndex:s.get("yAxisIndex",!0),xAxisId:s.get("xAxisId",!0),yAxisId:s.get("yAxisId",!0)};return a.xAxisIndex==null&&a.xAxisId==null&&(a.xAxisIndex="all"),a.yAxisIndex==null&&a.yAxisId==null&&(a.yAxisIndex="all"),a}function updateBackBtnStatus(s,a){s.setIconStatus("back",count(a)>1?"emphasis":"normal")}function updateZoomBtnStatus(s,a,o,c,d){var tt=o._isZoomActive;c&&c.type==="takeGlobalCursor"&&(tt=c.key==="dataZoomSelect"?c.dataZoomSelectActive:!1),o._isZoomActive=tt,s.setIconStatus("zoom",tt?"emphasis":"normal");var nt=new BrushTargetManager(makeAxisFinder(s),a,{include:["grid"]}),it=nt.makePanelOpts(d,function(st){return st.xAxisDeclared&&!st.yAxisDeclared?"lineX":!st.xAxisDeclared&&st.yAxisDeclared?"lineY":"rect"});o._brushController.setPanels(it).enableBrush(tt&&it.length?{brushType:"auto",brushStyle:s.getModel("brushStyle").getItemStyle()}:!1)}registerInternalOptionCreator("dataZoom",function(s){var a=s.getComponent("toolbox",0),o=["feature","dataZoom"];if(!a||a.get(o)==null)return;var c=a.getModel(o),d=[],tt=makeAxisFinder(c),nt=parseFinder$1(s,tt);each$5(nt.xAxisModels,function(st){return it(st,"xAxis","xAxisIndex")}),each$5(nt.yAxisModels,function(st){return it(st,"yAxis","yAxisIndex")});function it(st,ut,ct){var ot=st.componentIndex,at={type:"select",$fromToolbox:!0,filterMode:c.get("filterMode",!0)||"filter",id:DATA_ZOOM_ID_BASE+ut+ot};at[ct]=ot,d.push(at)}return d});function install$j(s){s.registerComponentModel(ToolboxModel),s.registerComponentView(ToolboxView),registerFeature("saveAsImage",SaveAsImage),registerFeature("magicType",MagicType),registerFeature("dataView",DataView$1),registerFeature("dataZoom",DataZoomFeature),registerFeature("restore",RestoreOption),use(install$k)}var TooltipModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="tooltip",a.dependencies=["axisPointer"],a.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},a}(ComponentModel);function shouldTooltipConfine(s){var a=s.get("confine");return a!=null?!!a:s.get("renderMode")==="richText"}function testStyle(s){if(env.domSupported){for(var a=document.documentElement.style,o=0,c=s.length;o<c;o++)if(s[o]in a)return s[o]}}var TRANSFORM_VENDOR=testStyle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),TRANSITION_VENDOR=testStyle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function toCSSVendorPrefix(s,a){if(!s)return a;a=toCamelCase(a,!0);var o=s.indexOf(a);return s=o===-1?a:"-"+s.slice(0,o)+"-"+a,s.toLowerCase()}function getComputedStyle$1(s,a){var o=s.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(s);return o?o[a]:null}var CSS_TRANSITION_VENDOR=toCSSVendorPrefix(TRANSITION_VENDOR,"transition"),CSS_TRANSFORM_VENDOR=toCSSVendorPrefix(TRANSFORM_VENDOR,"transform"),gCssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(env.transform3dSupported?"will-change:transform;":"");function mirrorPos(s){return s=s==="left"?"right":s==="right"?"left":s==="top"?"bottom":"top",s}function assembleArrow(s,a,o){if(!isString$1(o)||o==="inside")return"";var c=s.get("backgroundColor"),d=s.get("borderWidth");a=convertToColorString(a);var tt=mirrorPos(o),nt=Math.max(Math.round(d)*1.5,6),it="",st=CSS_TRANSFORM_VENDOR+":",ut;indexOf(["left","right"],tt)>-1?(it+="top:50%",st+="translateY(-50%) rotate("+(ut=tt==="left"?-225:-45)+"deg)"):(it+="left:50%",st+="translateX(-50%) rotate("+(ut=tt==="top"?225:45)+"deg)");var ct=ut*Math.PI/180,ot=nt+d,at=ot*Math.abs(Math.cos(ct))+ot*Math.abs(Math.sin(ct)),ht=Math.round(((at-Math.SQRT2*d)/2+Math.SQRT2*d-(at-ot)/2)*100)/100;it+=";"+tt+":-"+ht+"px";var ft=a+" solid "+d+"px;",mt=["position:absolute;width:"+nt+"px;height:"+nt+"px;z-index:-1;",it+";"+st+";","border-bottom:"+ft,"border-right:"+ft,"background-color:"+c+";"];return'<div style="'+mt.join("")+'"></div>'}function assembleTransition(s,a){var o="cubic-bezier(0.23,1,0.32,1)",c=" "+s/2+"s "+o,d="opacity"+c+",visibility"+c;return a||(c=" "+s+"s "+o,d+=env.transformSupported?","+CSS_TRANSFORM_VENDOR+c:",left"+c+",top"+c),CSS_TRANSITION_VENDOR+":"+d}function assembleTransform(s,a,o){var c=s.toFixed(0)+"px",d=a.toFixed(0)+"px";if(!env.transformSupported)return o?"top:"+d+";left:"+c+";":[["top",d],["left",c]];var tt=env.transform3dSupported,nt="translate"+(tt?"3d":"")+"("+c+","+d+(tt?",0":"")+")";return o?"top:0;left:0;"+CSS_TRANSFORM_VENDOR+":"+nt+";":[["top",0],["left",0],[TRANSFORM_VENDOR,nt]]}function assembleFont(s){var a=[],o=s.get("fontSize"),c=s.getTextColor();c&&a.push("color:"+c),a.push("font:"+s.getFont());var d=retrieve2(s.get("lineHeight"),Math.round(o*3/2));o&&a.push("line-height:"+d+"px");var tt=s.get("textShadowColor"),nt=s.get("textShadowBlur")||0,it=s.get("textShadowOffsetX")||0,st=s.get("textShadowOffsetY")||0;return tt&&nt&&a.push("text-shadow:"+it+"px "+st+"px "+nt+"px "+tt),each$f(["decoration","align"],function(ut){var ct=s.get(ut);ct&&a.push("text-"+ut+":"+ct)}),a.join(";")}function assembleCssText(s,a,o){var c=[],d=s.get("transitionDuration"),tt=s.get("backgroundColor"),nt=s.get("shadowBlur"),it=s.get("shadowColor"),st=s.get("shadowOffsetX"),ut=s.get("shadowOffsetY"),ct=s.getModel("textStyle"),ot=getPaddingFromTooltipModel(s,"html"),at=st+"px "+ut+"px "+nt+"px "+it;return c.push("box-shadow:"+at),a&&d&&c.push(assembleTransition(d,o)),tt&&c.push("background-color:"+tt),each$f(["width","color","radius"],function(ht){var ft="border-"+ht,mt=toCamelCase(ft),yt=s.get(mt);yt!=null&&c.push(ft+":"+yt+(ht==="color"?"":"px"))}),c.push(assembleFont(ct)),ot!=null&&c.push("padding:"+normalizeCssArray(ot).join("px ")+"px"),c.join(";")+";"}function makeStyleCoord$1(s,a,o,c,d){var tt=a&&a.painter;if(o){var nt=tt&&tt.getViewportRoot();nt&&transformLocalCoord(s,nt,o,c,d)}else{s[0]=c,s[1]=d;var it=tt&&tt.getViewportRootOffset();it&&(s[0]+=it.offsetLeft,s[1]+=it.offsetTop)}s[2]=s[0]/a.getWidth(),s[3]=s[1]/a.getHeight()}var TooltipHTMLContent=function(){function s(a,o){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,env.wxa)return null;var c=document.createElement("div");c.domBelongToZr=!0,this.el=c;var d=this._zr=a.getZr(),tt=o.appendTo,nt=tt&&(isString$1(tt)?document.querySelector(tt):isDom(tt)?tt:isFunction$1(tt)&&tt(a.getDom()));makeStyleCoord$1(this._styleCoord,d,nt,a.getWidth()/2,a.getHeight()/2),(nt||a.getDom()).appendChild(c),this._api=a,this._container=nt;var it=this;c.onmouseenter=function(){it._enterable&&(clearTimeout(it._hideTimeout),it._show=!0),it._inContent=!0},c.onmousemove=function(st){if(st=st||window.event,!it._enterable){var ut=d.handler,ct=d.painter.getViewportRoot();normalizeEvent(ct,st,!0),ut.dispatch("mousemove",st)}},c.onmouseleave=function(){it._inContent=!1,it._enterable&&it._show&&it.hideLater(it._hideDelay)}}return s.prototype.update=function(a){if(!this._container){var o=this._api.getDom(),c=getComputedStyle$1(o,"position"),d=o.style;d.position!=="absolute"&&c!=="absolute"&&(d.position="relative")}var tt=a.get("alwaysShowContent");tt&&this._moveIfResized(),this._alwaysShowContent=tt,this.el.className=a.get("className")||""},s.prototype.show=function(a,o){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var c=this.el,d=c.style,tt=this._styleCoord;c.innerHTML?d.cssText=gCssText+assembleCssText(a,!this._firstShow,this._longHide)+assembleTransform(tt[0],tt[1],!0)+("border-color:"+convertToColorString(o)+";")+(a.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):d.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},s.prototype.setContent=function(a,o,c,d,tt){var nt=this.el;if(a==null){nt.innerHTML="";return}var it="";if(isString$1(tt)&&c.get("trigger")==="item"&&!shouldTooltipConfine(c)&&(it=assembleArrow(c,d,tt)),isString$1(a))nt.innerHTML=a+it;else if(a){nt.innerHTML="",isArray$1(a)||(a=[a]);for(var st=0;st<a.length;st++)isDom(a[st])&&a[st].parentNode!==nt&&nt.appendChild(a[st]);if(it&&nt.childNodes.length){var ut=document.createElement("div");ut.innerHTML=it,nt.appendChild(ut)}}},s.prototype.setEnterable=function(a){this._enterable=a},s.prototype.getSize=function(){var a=this.el;return a?[a.offsetWidth,a.offsetHeight]:[0,0]},s.prototype.moveTo=function(a,o){if(this.el){var c=this._styleCoord;if(makeStyleCoord$1(c,this._zr,this._container,a,o),c[0]!=null&&c[1]!=null){var d=this.el.style,tt=assembleTransform(c[0],c[1]);each$f(tt,function(nt){d[nt[0]]=nt[1]})}}},s.prototype._moveIfResized=function(){var a=this._styleCoord[2],o=this._styleCoord[3];this.moveTo(a*this._zr.getWidth(),o*this._zr.getHeight())},s.prototype.hide=function(){var a=this,o=this.el.style;o.visibility="hidden",o.opacity="0",env.transform3dSupported&&(o.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return a._longHide=!0},500)},s.prototype.hideLater=function(a){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(a?(this._hideDelay=a,this._show=!1,this._hideTimeout=setTimeout(bind$2(this.hide,this),a)):this.hide())},s.prototype.isShow=function(){return this._show},s.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var a=this.el.parentNode;a&&a.removeChild(this.el),this.el=this._container=null},s}(),TooltipRichContent=function(){function s(a){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=a.getZr(),makeStyleCoord(this._styleCoord,this._zr,a.getWidth()/2,a.getHeight()/2)}return s.prototype.update=function(a){var o=a.get("alwaysShowContent");o&&this._moveIfResized(),this._alwaysShowContent=o},s.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},s.prototype.setContent=function(a,o,c,d,tt){var nt=this;isObject$3(a)&&throwError(""),this.el&&this._zr.remove(this.el);var it=c.getModel("textStyle");this.el=new ZRText({style:{rich:o.richTextStyles,text:a,lineHeight:22,borderWidth:1,borderColor:d,textShadowColor:it.get("textShadowColor"),fill:c.get(["textStyle","color"]),padding:getPaddingFromTooltipModel(c,"richText"),verticalAlign:"top",align:"left"},z:c.get("z")}),each$f(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(ut){nt.el.style[ut]=c.get(ut)}),each$f(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(ut){nt.el.style[ut]=it.get(ut)||0}),this._zr.add(this.el);var st=this;this.el.on("mouseover",function(){st._enterable&&(clearTimeout(st._hideTimeout),st._show=!0),st._inContent=!0}),this.el.on("mouseout",function(){st._enterable&&st._show&&st.hideLater(st._hideDelay),st._inContent=!1})},s.prototype.setEnterable=function(a){this._enterable=a},s.prototype.getSize=function(){var a=this.el,o=this.el.getBoundingRect(),c=calcShadowOuterSize(a.style);return[o.width+c.left+c.right,o.height+c.top+c.bottom]},s.prototype.moveTo=function(a,o){var c=this.el;if(c){var d=this._styleCoord;makeStyleCoord(d,this._zr,a,o),a=d[0],o=d[1];var tt=c.style,nt=mathMaxWith0(tt.borderWidth||0),it=calcShadowOuterSize(tt);c.x=a+nt+it.left,c.y=o+nt+it.top,c.markRedraw()}},s.prototype._moveIfResized=function(){var a=this._styleCoord[2],o=this._styleCoord[3];this.moveTo(a*this._zr.getWidth(),o*this._zr.getHeight())},s.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},s.prototype.hideLater=function(a){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(a?(this._hideDelay=a,this._show=!1,this._hideTimeout=setTimeout(bind$2(this.hide,this),a)):this.hide())},s.prototype.isShow=function(){return this._show},s.prototype.dispose=function(){this._zr.remove(this.el)},s}();function mathMaxWith0(s){return Math.max(0,s)}function calcShadowOuterSize(s){var a=mathMaxWith0(s.shadowBlur||0),o=mathMaxWith0(s.shadowOffsetX||0),c=mathMaxWith0(s.shadowOffsetY||0);return{left:mathMaxWith0(a-o),right:mathMaxWith0(a+o),top:mathMaxWith0(a-c),bottom:mathMaxWith0(a+c)}}function makeStyleCoord(s,a,o,c){s[0]=o,s[1]=c,s[2]=s[0]/a.getWidth(),s[3]=s[1]/a.getHeight()}var proxyRect=new Rect$2({shape:{x:-1,y:-1,width:2,height:2}}),TooltipView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c){if(!(env.node||!c.getDom())){var d=o.getComponent("tooltip"),tt=this._renderMode=getTooltipRenderMode(d.get("renderMode"));this._tooltipContent=tt==="richText"?new TooltipRichContent(c):new TooltipHTMLContent(c,{appendTo:d.get("appendToBody",!0)?"body":d.get("appendTo",!0)})}},a.prototype.render=function(o,c,d){if(!(env.node||!d.getDom())){this.group.removeAll(),this._tooltipModel=o,this._ecModel=c,this._api=d;var tt=this._tooltipContent;tt.update(o),tt.setEnterable(o.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&o.get("transitionDuration")?createOrUpdate(this,"_updatePosition",50,"fixRate"):clear$2(this,"_updatePosition")}},a.prototype._initGlobalListener=function(){var o=this._tooltipModel,c=o.get("triggerOn");register("itemTooltip",this._api,bind$2(function(d,tt,nt){c!=="none"&&(c.indexOf(d)>=0?this._tryShow(tt,nt):d==="leave"&&this._hide(nt))},this))},a.prototype._keepShow=function(){var o=this._tooltipModel,c=this._ecModel,d=this._api,tt=o.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&tt!=="none"&&tt!=="click"){var nt=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!d.isDisposed()&&nt.manuallyShowTip(o,c,d,{x:nt._lastX,y:nt._lastY,dataByCoordSys:nt._lastDataByCoordSys})})}},a.prototype.manuallyShowTip=function(o,c,d,tt){if(!(tt.from===this.uid||env.node||!d.getDom())){var nt=makeDispatchAction(tt,d);this._ticket="";var it=tt.dataByCoordSys,st=findComponentReference(tt,c,d);if(st){var ut=st.el.getBoundingRect().clone();ut.applyTransform(st.el.transform),this._tryShow({offsetX:ut.x+ut.width/2,offsetY:ut.y+ut.height/2,target:st.el,position:tt.position,positionDefault:"bottom"},nt)}else if(tt.tooltip&&tt.x!=null&&tt.y!=null){var ct=proxyRect;ct.x=tt.x,ct.y=tt.y,ct.update(),getECData(ct).tooltipConfig={name:null,option:tt.tooltip},this._tryShow({offsetX:tt.x,offsetY:tt.y,target:ct},nt)}else if(it)this._tryShow({offsetX:tt.x,offsetY:tt.y,position:tt.position,dataByCoordSys:it,tooltipOption:tt.tooltipOption},nt);else if(tt.seriesIndex!=null){if(this._manuallyAxisShowTip(o,c,d,tt))return;var ot=findPointFromSeries(tt,c),at=ot.point[0],ht=ot.point[1];at!=null&&ht!=null&&this._tryShow({offsetX:at,offsetY:ht,target:ot.el,position:tt.position,positionDefault:"bottom"},nt)}else tt.x!=null&&tt.y!=null&&(d.dispatchAction({type:"updateAxisPointer",x:tt.x,y:tt.y}),this._tryShow({offsetX:tt.x,offsetY:tt.y,position:tt.position,target:d.getZr().findHover(tt.x,tt.y).target},nt))}},a.prototype.manuallyHideTip=function(o,c,d,tt){var nt=this._tooltipContent;this._tooltipModel&&nt.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,tt.from!==this.uid&&this._hide(makeDispatchAction(tt,d))},a.prototype._manuallyAxisShowTip=function(o,c,d,tt){var nt=tt.seriesIndex,it=tt.dataIndex,st=c.getComponent("axisPointer").coordSysAxesInfo;if(!(nt==null||it==null||st==null)){var ut=c.getSeriesByIndex(nt);if(ut){var ct=ut.getData(),ot=buildTooltipModel([ct.getItemModel(it),ut,(ut.coordinateSystem||{}).model],this._tooltipModel);if(ot.get("trigger")==="axis")return d.dispatchAction({type:"updateAxisPointer",seriesIndex:nt,dataIndex:it,position:tt.position}),!0}}},a.prototype._tryShow=function(o,c){var d=o.target,tt=this._tooltipModel;if(tt){this._lastX=o.offsetX,this._lastY=o.offsetY;var nt=o.dataByCoordSys;if(nt&&nt.length)this._showAxisTooltip(nt,o);else if(d){var it=getECData(d);if(it.ssrType==="legend")return;this._lastDataByCoordSys=null;var st,ut;findEventDispatcher(d,function(ct){if(getECData(ct).dataIndex!=null)return st=ct,!0;if(getECData(ct).tooltipConfig!=null)return ut=ct,!0},!0),st?this._showSeriesItemTooltip(o,st,c):ut?this._showComponentItemTooltip(o,ut,c):this._hide(c)}else this._lastDataByCoordSys=null,this._hide(c)}},a.prototype._showOrMove=function(o,c){var d=o.get("showDelay");c=bind$2(c,this),clearTimeout(this._showTimout),d>0?this._showTimout=setTimeout(c,d):c()},a.prototype._showAxisTooltip=function(o,c){var d=this._ecModel,tt=this._tooltipModel,nt=[c.offsetX,c.offsetY],it=buildTooltipModel([c.tooltipOption],tt),st=this._renderMode,ut=[],ct=createTooltipMarkup("section",{blocks:[],noHeader:!0}),ot=[],at=new TooltipMarkupStyleCreator;each$f(o,function(wt){each$f(wt.dataByAxis,function(Tt){var Ct=d.getComponent(Tt.axisDim+"Axis",Tt.axisIndex),Dt=Tt.value;if(!(!Ct||Dt==null)){var Ot=getValueLabel(Dt,Ct.axis,d,Tt.seriesDataIndices,Tt.valueLabelOpt),$t=createTooltipMarkup("section",{header:Ot,noHeader:!trim$1(Ot),sortBlocks:!0,blocks:[]});ct.blocks.push($t),each$f(Tt.seriesDataIndices,function(Ft){var kt=d.getSeriesByIndex(Ft.seriesIndex),Vt=Ft.dataIndexInside,Ht=kt.getDataParams(Vt);if(!(Ht.dataIndex<0)){Ht.axisDim=Tt.axisDim,Ht.axisIndex=Tt.axisIndex,Ht.axisType=Tt.axisType,Ht.axisId=Tt.axisId,Ht.axisValue=getAxisRawValue(Ct.axis,{value:Dt}),Ht.axisValueLabel=Ot,Ht.marker=at.makeTooltipMarker("item",convertToColorString(Ht.color),st);var Qt=normalizeTooltipFormatResult(kt.formatTooltip(Vt,!0,null)),Xt=Qt.frag;if(Xt){var Zt=buildTooltipModel([kt],tt).get("valueFormatter");$t.blocks.push(Zt?extend({valueFormatter:Zt},Xt):Xt)}Qt.text&&ot.push(Qt.text),ut.push(Ht)}})}})}),ct.blocks.reverse(),ot.reverse();var ht=c.position,ft=it.get("order"),mt=buildTooltipMarkup(ct,at,st,ft,d.get("useUTC"),it.get("textStyle"));mt&&ot.unshift(mt);var yt=st==="richText"?`

`:"<br/>",bt=ot.join(yt);this._showOrMove(it,function(){this._updateContentNotChangedOnAxis(o,ut)?this._updatePosition(it,ht,nt[0],nt[1],this._tooltipContent,ut):this._showTooltipContent(it,bt,ut,Math.random()+"",nt[0],nt[1],ht,null,at)})},a.prototype._showSeriesItemTooltip=function(o,c,d){var tt=this._ecModel,nt=getECData(c),it=nt.seriesIndex,st=tt.getSeriesByIndex(it),ut=nt.dataModel||st,ct=nt.dataIndex,ot=nt.dataType,at=ut.getData(ot),ht=this._renderMode,ft=o.positionDefault,mt=buildTooltipModel([at.getItemModel(ct),ut,st&&(st.coordinateSystem||{}).model],this._tooltipModel,ft?{position:ft}:null),yt=mt.get("trigger");if(!(yt!=null&&yt!=="item")){var bt=ut.getDataParams(ct,ot),wt=new TooltipMarkupStyleCreator;bt.marker=wt.makeTooltipMarker("item",convertToColorString(bt.color),ht);var Tt=normalizeTooltipFormatResult(ut.formatTooltip(ct,!1,ot)),Ct=mt.get("order"),Dt=mt.get("valueFormatter"),Ot=Tt.frag,$t=Ot?buildTooltipMarkup(Dt?extend({valueFormatter:Dt},Ot):Ot,wt,ht,Ct,tt.get("useUTC"),mt.get("textStyle")):Tt.text,Ft="item_"+ut.name+"_"+ct;this._showOrMove(mt,function(){this._showTooltipContent(mt,$t,bt,Ft,o.offsetX,o.offsetY,o.position,o.target,wt)}),d({type:"showTip",dataIndexInside:ct,dataIndex:at.getRawIndex(ct),seriesIndex:it,from:this.uid})}},a.prototype._showComponentItemTooltip=function(o,c,d){var tt=this._renderMode==="html",nt=getECData(c),it=nt.tooltipConfig,st=it.option||{},ut=st.encodeHTMLContent;if(isString$1(st)){var ct=st;st={content:ct,formatter:ct},ut=!0}ut&&tt&&st.content&&(st=clone$4(st),st.content=encodeHTML(st.content));var ot=[st],at=this._ecModel.getComponent(nt.componentMainType,nt.componentIndex);at&&ot.push(at),ot.push({formatter:st.content});var ht=o.positionDefault,ft=buildTooltipModel(ot,this._tooltipModel,ht?{position:ht}:null),mt=ft.get("content"),yt=Math.random()+"",bt=new TooltipMarkupStyleCreator;this._showOrMove(ft,function(){var wt=clone$4(ft.get("formatterParams")||{});this._showTooltipContent(ft,mt,wt,yt,o.offsetX,o.offsetY,o.position,c,bt)}),d({type:"showTip",from:this.uid})},a.prototype._showTooltipContent=function(o,c,d,tt,nt,it,st,ut,ct){if(this._ticket="",!(!o.get("showContent")||!o.get("show"))){var ot=this._tooltipContent;ot.setEnterable(o.get("enterable"));var at=o.get("formatter");st=st||o.get("position");var ht=c,ft=this._getNearestPoint([nt,it],d,o.get("trigger"),o.get("borderColor")),mt=ft.color;if(at)if(isString$1(at)){var yt=o.ecModel.get("useUTC"),bt=isArray$1(d)?d[0]:d,wt=bt&&bt.axisType&&bt.axisType.indexOf("time")>=0;ht=at,wt&&(ht=format$1(bt.axisValue,ht,yt)),ht=formatTpl(ht,d,!0)}else if(isFunction$1(at)){var Tt=bind$2(function(Ct,Dt){Ct===this._ticket&&(ot.setContent(Dt,ct,o,mt,st),this._updatePosition(o,st,nt,it,ot,d,ut))},this);this._ticket=tt,ht=at(d,tt,Tt)}else ht=at;ot.setContent(ht,ct,o,mt,st),ot.show(o,mt),this._updatePosition(o,st,nt,it,ot,d,ut)}},a.prototype._getNearestPoint=function(o,c,d,tt){if(d==="axis"||isArray$1(c))return{color:tt||(this._renderMode==="html"?"#fff":"none")};if(!isArray$1(c))return{color:tt||c.color||c.borderColor}},a.prototype._updatePosition=function(o,c,d,tt,nt,it,st){var ut=this._api.getWidth(),ct=this._api.getHeight();c=c||o.get("position");var ot=nt.getSize(),at=o.get("align"),ht=o.get("verticalAlign"),ft=st&&st.getBoundingRect().clone();if(st&&ft.applyTransform(st.transform),isFunction$1(c)&&(c=c([d,tt],it,nt.el,ft,{viewSize:[ut,ct],contentSize:ot.slice()})),isArray$1(c))d=parsePercent(c[0],ut),tt=parsePercent(c[1],ct);else if(isObject$3(c)){var mt=c;mt.width=ot[0],mt.height=ot[1];var yt=getLayoutRect(mt,{width:ut,height:ct});d=yt.x,tt=yt.y,at=null,ht=null}else if(isString$1(c)&&st){var bt=calcTooltipPosition(c,ft,ot,o.get("borderWidth"));d=bt[0],tt=bt[1]}else{var bt=refixTooltipPosition(d,tt,nt,ut,ct,at?null:20,ht?null:20);d=bt[0],tt=bt[1]}if(at&&(d-=isCenterAlign(at)?ot[0]/2:at==="right"?ot[0]:0),ht&&(tt-=isCenterAlign(ht)?ot[1]/2:ht==="bottom"?ot[1]:0),shouldTooltipConfine(o)){var bt=confineTooltipPosition(d,tt,nt,ut,ct);d=bt[0],tt=bt[1]}nt.moveTo(d,tt)},a.prototype._updateContentNotChangedOnAxis=function(o,c){var d=this._lastDataByCoordSys,tt=this._cbParamsList,nt=!!d&&d.length===o.length;return nt&&each$f(d,function(it,st){var ut=it.dataByAxis||[],ct=o[st]||{},ot=ct.dataByAxis||[];nt=nt&&ut.length===ot.length,nt&&each$f(ut,function(at,ht){var ft=ot[ht]||{},mt=at.seriesDataIndices||[],yt=ft.seriesDataIndices||[];nt=nt&&at.value===ft.value&&at.axisType===ft.axisType&&at.axisId===ft.axisId&&mt.length===yt.length,nt&&each$f(mt,function(bt,wt){var Tt=yt[wt];nt=nt&&bt.seriesIndex===Tt.seriesIndex&&bt.dataIndex===Tt.dataIndex}),tt&&each$f(at.seriesDataIndices,function(bt){var wt=bt.seriesIndex,Tt=c[wt],Ct=tt[wt];Tt&&Ct&&Ct.data!==Tt.data&&(nt=!1)})})}),this._lastDataByCoordSys=o,this._cbParamsList=c,!!nt},a.prototype._hide=function(o){this._lastDataByCoordSys=null,o({type:"hideTip",from:this.uid})},a.prototype.dispose=function(o,c){env.node||!c.getDom()||(clear$2(this,"_updatePosition"),this._tooltipContent.dispose(),unregister("itemTooltip",c))},a.type="tooltip",a}(ComponentView);function buildTooltipModel(s,a,o){var c=a.ecModel,d;o?(d=new Model(o,c,c),d=new Model(a.option,d,c)):d=a;for(var tt=s.length-1;tt>=0;tt--){var nt=s[tt];nt&&(nt instanceof Model&&(nt=nt.get("tooltip",!0)),isString$1(nt)&&(nt={formatter:nt}),nt&&(d=new Model(nt,d,c)))}return d}function makeDispatchAction(s,a){return s.dispatchAction||bind$2(a.dispatchAction,a)}function refixTooltipPosition(s,a,o,c,d,tt,nt){var it=o.getSize(),st=it[0],ut=it[1];return tt!=null&&(s+st+tt+2>c?s-=st+tt:s+=tt),nt!=null&&(a+ut+nt>d?a-=ut+nt:a+=nt),[s,a]}function confineTooltipPosition(s,a,o,c,d){var tt=o.getSize(),nt=tt[0],it=tt[1];return s=Math.min(s+nt,c)-nt,a=Math.min(a+it,d)-it,s=Math.max(s,0),a=Math.max(a,0),[s,a]}function calcTooltipPosition(s,a,o,c){var d=o[0],tt=o[1],nt=Math.ceil(Math.SQRT2*c)+8,it=0,st=0,ut=a.width,ct=a.height;switch(s){case"inside":it=a.x+ut/2-d/2,st=a.y+ct/2-tt/2;break;case"top":it=a.x+ut/2-d/2,st=a.y-tt-nt;break;case"bottom":it=a.x+ut/2-d/2,st=a.y+ct+nt;break;case"left":it=a.x-d-nt,st=a.y+ct/2-tt/2;break;case"right":it=a.x+ut+nt,st=a.y+ct/2-tt/2}return[it,st]}function isCenterAlign(s){return s==="center"||s==="middle"}function findComponentReference(s,a,o){var c=preParseFinder(s).queryOptionMap,d=c.keys()[0];if(!(!d||d==="series")){var tt=queryReferringComponents(a,d,c.get(d),{useDefault:!1,enableAll:!1,enableNone:!1}),nt=tt.models[0];if(nt){var it=o.getViewOfComponentModel(nt),st;if(it.group.traverse(function(ut){var ct=getECData(ut).tooltipConfig;if(ct&&ct.name===s.name)return st=ut,!0}),st)return{componentMainType:d,componentIndex:nt.componentIndex,el:st}}}}function install$i(s){use(install$q),s.registerComponentModel(TooltipModel),s.registerComponentView(TooltipView),s.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},noop),s.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},noop)}var DEFAULT_TOOLBOX_BTNS=["rect","polygon","keep","clear"];function brushPreprocessor(s,a){var o=normalizeToArray(s?s.brush:[]);if(o.length){var c=[];each$f(o,function(st){var ut=st.hasOwnProperty("toolbox")?st.toolbox:[];ut instanceof Array&&(c=c.concat(ut))});var d=s&&s.toolbox;isArray$1(d)&&(d=d[0]),d||(d={feature:{}},s.toolbox=[d]);var tt=d.feature||(d.feature={}),nt=tt.brush||(tt.brush={}),it=nt.type||(nt.type=[]);it.push.apply(it,c),removeDuplicate(it),a&&!it.length&&it.push.apply(it,DEFAULT_TOOLBOX_BTNS)}}function removeDuplicate(s){var a={};each$f(s,function(o){a[o]=1}),s.length=0,each$f(a,function(o,c){s.push(c)})}var each$4=each$f;function hasKeys(s){if(s){for(var a in s)if(s.hasOwnProperty(a))return!0}}function createVisualMappings(s,a,o){var c={};return each$4(a,function(tt){var nt=c[tt]=d();each$4(s[tt],function(it,st){if(VisualMapping.isValidType(st)){var ut={type:st,visual:it};o&&o(ut,tt),nt[st]=new VisualMapping(ut),st==="opacity"&&(ut=clone$4(ut),ut.type="colorAlpha",nt.__hidden.__alphaForOpacity=new VisualMapping(ut))}})}),c;function d(){var tt=function(){};tt.prototype.__hidden=tt.prototype;var nt=new tt;return nt}}function replaceVisualOption(s,a,o){var c;each$f(o,function(d){a.hasOwnProperty(d)&&hasKeys(a[d])&&(c=!0)}),c&&each$f(o,function(d){a.hasOwnProperty(d)&&hasKeys(a[d])?s[d]=clone$4(a[d]):delete s[d]})}function applyVisual(s,a,o,c,d,tt){var nt={};each$f(s,function(ot){var at=VisualMapping.prepareVisualTypes(a[ot]);nt[ot]=at});var it;function st(ot){return getItemVisualFromData(o,it,ot)}function ut(ot,at){setItemVisualFromData(o,it,ot,at)}o.each(ct);function ct(ot,at){it=ot;var ht=o.getRawDataItem(it);if(!(ht&&ht.visualMap===!1))for(var ft=c.call(d,ot),mt=a[ft],yt=nt[ft],bt=0,wt=yt.length;bt<wt;bt++){var Tt=yt[bt];mt[Tt]&&mt[Tt].applyVisual(ot,st,ut)}}}function incrementalApplyVisual(s,a,o,c){var d={};return each$f(s,function(tt){var nt=VisualMapping.prepareVisualTypes(a[tt]);d[tt]=nt}),{progress:function(nt,it){var st;c!=null&&(st=it.getDimensionIndex(c));function ut(Dt){return getItemVisualFromData(it,ot,Dt)}function ct(Dt,Ot){setItemVisualFromData(it,ot,Dt,Ot)}for(var ot,at=it.getStore();(ot=nt.next())!=null;){var ht=it.getRawDataItem(ot);if(!(ht&&ht.visualMap===!1))for(var ft=c!=null?at.get(st,ot):ot,mt=o(ft),yt=a[mt],bt=d[mt],wt=0,Tt=bt.length;wt<Tt;wt++){var Ct=bt[wt];yt[Ct]&&yt[Ct].applyVisual(ft,ut,ct)}}}}}function makeBrushCommonSelectorForSeries(s){var a=s.brushType,o={point:function(c){return selector[a].point(c,o,s)},rect:function(c){return selector[a].rect(c,o,s)}};return o}var selector={lineX:getLineSelectors(0),lineY:getLineSelectors(1),rect:{point:function(s,a,o){return s&&o.boundingRect.contain(s[0],s[1])},rect:function(s,a,o){return s&&o.boundingRect.intersect(s)}},polygon:{point:function(s,a,o){return s&&o.boundingRect.contain(s[0],s[1])&&contain(o.range,s[0],s[1])},rect:function(s,a,o){var c=o.range;if(!s||c.length<=1)return!1;var d=s.x,tt=s.y,nt=s.width,it=s.height,st=c[0];if(contain(c,d,tt)||contain(c,d+nt,tt)||contain(c,d,tt+it)||contain(c,d+nt,tt+it)||BoundingRect.create(s).contain(st[0],st[1])||linePolygonIntersect(d,tt,d+nt,tt,c)||linePolygonIntersect(d,tt,d,tt+it,c)||linePolygonIntersect(d+nt,tt,d+nt,tt+it,c)||linePolygonIntersect(d,tt+it,d+nt,tt+it,c))return!0}}};function getLineSelectors(s){var a=["x","y"],o=["width","height"];return{point:function(c,d,tt){if(c){var nt=tt.range,it=c[s];return inLineRange(it,nt)}},rect:function(c,d,tt){if(c){var nt=tt.range,it=[c[a[s]],c[a[s]]+c[o[s]]];return it[1]<it[0]&&it.reverse(),inLineRange(it[0],nt)||inLineRange(it[1],nt)||inLineRange(nt[0],it)||inLineRange(nt[1],it)}}}}function inLineRange(s,a){return a[0]<=s&&s<=a[1]}var STATE_LIST=["inBrush","outOfBrush"],DISPATCH_METHOD="__ecBrushSelect",DISPATCH_FLAG="__ecInBrushSelectEvent";function layoutCovers(s){s.eachComponent({mainType:"brush"},function(a){var o=a.brushTargetManager=new BrushTargetManager(a.option,s);o.setInputRanges(a.areas,s)})}function brushVisual(s,a,o){var c=[],d,tt;s.eachComponent({mainType:"brush"},function(nt){o&&o.type==="takeGlobalCursor"&&nt.setBrushOption(o.key==="brush"?o.brushOption:{brushType:!1})}),layoutCovers(s),s.eachComponent({mainType:"brush"},function(nt,it){var st={brushId:nt.id,brushIndex:it,brushName:nt.name,areas:clone$4(nt.areas),selected:[]};c.push(st);var ut=nt.option,ct=ut.brushLink,ot=[],at=[],ht=[],ft=!1;it||(d=ut.throttleType,tt=ut.throttleDelay);var mt=map$1(nt.areas,function(Dt){var Ot=boundingRectBuilders[Dt.brushType],$t=defaults({boundingRect:Ot?Ot(Dt):void 0},Dt);return $t.selectors=makeBrushCommonSelectorForSeries($t),$t}),yt=createVisualMappings(nt.option,STATE_LIST,function(Dt){Dt.mappingMethod="fixed"});isArray$1(ct)&&each$f(ct,function(Dt){ot[Dt]=1});function bt(Dt){return ct==="all"||!!ot[Dt]}function wt(Dt){return!!Dt.length}s.eachSeries(function(Dt,Ot){var $t=ht[Ot]=[];Dt.subType==="parallel"?Tt(Dt,Ot):Ct(Dt,Ot,$t)});function Tt(Dt,Ot){var $t=Dt.coordinateSystem;ft=ft||$t.hasAxisBrushed(),bt(Ot)&&$t.eachActiveState(Dt.getData(),function(Ft,kt){Ft==="active"&&(at[kt]=1)})}function Ct(Dt,Ot,$t){if(!(!Dt.brushSelector||brushModelNotControll(nt,Ot))&&(each$f(mt,function(kt){nt.brushTargetManager.controlSeries(kt,Dt,s)&&$t.push(kt),ft=ft||wt($t)}),bt(Ot)&&wt($t))){var Ft=Dt.getData();Ft.each(function(kt){checkInRange(Dt,$t,Ft,kt)&&(at[kt]=1)})}}s.eachSeries(function(Dt,Ot){var $t={seriesId:Dt.id,seriesIndex:Ot,seriesName:Dt.name,dataIndex:[]};st.selected.push($t);var Ft=ht[Ot],kt=Dt.getData(),Vt=bt(Ot)?function(Ht){return at[Ht]?($t.dataIndex.push(kt.getRawIndex(Ht)),"inBrush"):"outOfBrush"}:function(Ht){return checkInRange(Dt,Ft,kt,Ht)?($t.dataIndex.push(kt.getRawIndex(Ht)),"inBrush"):"outOfBrush"};(bt(Ot)?ft:wt(Ft))&&applyVisual(STATE_LIST,yt,kt,Vt)})}),dispatchAction$1(a,d,tt,c,o)}function dispatchAction$1(s,a,o,c,d){if(d){var tt=s.getZr();if(!tt[DISPATCH_FLAG]){tt[DISPATCH_METHOD]||(tt[DISPATCH_METHOD]=doDispatch);var nt=createOrUpdate(tt,DISPATCH_METHOD,o,a);nt(s,c)}}}function doDispatch(s,a){if(!s.isDisposed()){var o=s.getZr();o[DISPATCH_FLAG]=!0,s.dispatchAction({type:"brushSelect",batch:a}),o[DISPATCH_FLAG]=!1}}function checkInRange(s,a,o,c){for(var d=0,tt=a.length;d<tt;d++){var nt=a[d];if(s.brushSelector(c,o,nt.selectors,nt))return!0}}function brushModelNotControll(s,a){var o=s.option.seriesIndex;return o!=null&&o!=="all"&&(isArray$1(o)?indexOf(o,a)<0:a!==o)}var boundingRectBuilders={rect:function(s){return getBoundingRectFromMinMax(s.range)},polygon:function(s){for(var a,o=s.range,c=0,d=o.length;c<d;c++){a=a||[[1/0,-1/0],[1/0,-1/0]];var tt=o[c];tt[0]<a[0][0]&&(a[0][0]=tt[0]),tt[0]>a[0][1]&&(a[0][1]=tt[0]),tt[1]<a[1][0]&&(a[1][0]=tt[1]),tt[1]>a[1][1]&&(a[1][1]=tt[1])}return a&&getBoundingRectFromMinMax(a)}};function getBoundingRectFromMinMax(s){return new BoundingRect(s[0][0],s[1][0],s[0][1]-s[0][0],s[1][1]-s[1][0])}var BrushView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c){this.ecModel=o,this.api=c,this.model,(this._brushController=new BrushController(c.getZr())).on("brush",bind$2(this._onBrush,this)).mount()},a.prototype.render=function(o,c,d,tt){this.model=o,this._updateController(o,c,d,tt)},a.prototype.updateTransform=function(o,c,d,tt){layoutCovers(c),this._updateController(o,c,d,tt)},a.prototype.updateVisual=function(o,c,d,tt){this.updateTransform(o,c,d,tt)},a.prototype.updateView=function(o,c,d,tt){this._updateController(o,c,d,tt)},a.prototype._updateController=function(o,c,d,tt){(!tt||tt.$from!==o.id)&&this._brushController.setPanels(o.brushTargetManager.makePanelOpts(d)).enableBrush(o.brushOption).updateCovers(o.areas.slice())},a.prototype.dispose=function(){this._brushController.dispose()},a.prototype._onBrush=function(o){var c=this.model.id,d=this.model.brushTargetManager.setOutputRanges(o.areas,this.ecModel);(!o.isEnd||o.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:c,areas:clone$4(d),$from:c}),o.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:c,areas:clone$4(d),$from:c})},a.type="brush",a}(ComponentView),DEFAULT_OUT_OF_BRUSH_COLOR="#ddd",BrushModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.areas=[],o.brushOption={},o}return a.prototype.optionUpdated=function(o,c){var d=this.option;!c&&replaceVisualOption(d,o,["inBrush","outOfBrush"]);var tt=d.inBrush=d.inBrush||{};d.outOfBrush=d.outOfBrush||{color:DEFAULT_OUT_OF_BRUSH_COLOR},tt.hasOwnProperty("liftZ")||(tt.liftZ=5)},a.prototype.setAreas=function(o){o&&(this.areas=map$1(o,function(c){return generateBrushOption(this.option,c)},this))},a.prototype.setBrushOption=function(o){this.brushOption=generateBrushOption(this.option,o),this.brushType=this.brushOption.brushType},a.type="brush",a.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],a.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},a}(ComponentModel);function generateBrushOption(s,a){return merge({brushType:s.brushType,brushMode:s.brushMode,transformable:s.transformable,brushStyle:new Model(s.brushStyle).getItemStyle(),removeOnClick:s.removeOnClick,z:s.z},a,!0)}var ICON_TYPES=["rect","polygon","lineX","lineY","keep","clear"],BrushFeature=function(s){__extends$1(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.render=function(o,c,d){var tt,nt,it;c.eachComponent({mainType:"brush"},function(st){tt=st.brushType,nt=st.brushOption.brushMode||"single",it=it||!!st.areas.length}),this._brushType=tt,this._brushMode=nt,each$f(o.get("type",!0),function(st){o.setIconStatus(st,(st==="keep"?nt==="multiple":st==="clear"?it:st===tt)?"emphasis":"normal")})},a.prototype.updateView=function(o,c,d){this.render(o,c,d)},a.prototype.getIcons=function(){var o=this.model,c=o.get("icon",!0),d={};return each$f(o.get("type",!0),function(tt){c[tt]&&(d[tt]=c[tt])}),d},a.prototype.onclick=function(o,c,d){var tt=this._brushType,nt=this._brushMode;d==="clear"?(c.dispatchAction({type:"axisAreaSelect",intervals:[]}),c.dispatchAction({type:"brush",command:"clear",areas:[]})):c.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:d==="keep"?tt:tt===d?!1:d,brushMode:d==="keep"?nt==="multiple"?"single":"multiple":nt}})},a.getDefaultOption=function(o){var c={show:!0,type:ICON_TYPES.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:o.getLocaleModel().get(["toolbox","brush","title"])};return c},a}(ToolboxFeature);function install$h(s){s.registerComponentView(BrushView),s.registerComponentModel(BrushModel),s.registerPreprocessor(brushPreprocessor),s.registerVisual(s.PRIORITY.VISUAL.BRUSH,brushVisual),s.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(a,o){o.eachComponent({mainType:"brush",query:a},function(c){c.setAreas(a.areas)})}),s.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},noop),s.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},noop),registerFeature("brush",BrushFeature)}var TitleModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.layoutMode={type:"box",ignoreSize:!0},o}return a.type="title",a.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},a}(ComponentModel),TitleView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.render=function(o,c,d){if(this.group.removeAll(),!!o.get("show")){var tt=this.group,nt=o.getModel("textStyle"),it=o.getModel("subtextStyle"),st=o.get("textAlign"),ut=retrieve2(o.get("textBaseline"),o.get("textVerticalAlign")),ct=new ZRText({style:createTextStyle$1(nt,{text:o.get("text"),fill:nt.getTextColor()},{disableBox:!0}),z2:10}),ot=ct.getBoundingRect(),at=o.get("subtext"),ht=new ZRText({style:createTextStyle$1(it,{text:at,fill:it.getTextColor(),y:ot.height+o.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),ft=o.get("link"),mt=o.get("sublink"),yt=o.get("triggerEvent",!0);ct.silent=!ft&&!yt,ht.silent=!mt&&!yt,ft&&ct.on("click",function(){windowOpen(ft,"_"+o.get("target"))}),mt&&ht.on("click",function(){windowOpen(mt,"_"+o.get("subtarget"))}),getECData(ct).eventData=getECData(ht).eventData=yt?{componentType:"title",componentIndex:o.componentIndex}:null,tt.add(ct),at&&tt.add(ht);var bt=tt.getBoundingRect(),wt=o.getBoxLayoutParams();wt.width=bt.width,wt.height=bt.height;var Tt=getLayoutRect(wt,{width:d.getWidth(),height:d.getHeight()},o.get("padding"));st||(st=o.get("left")||o.get("right"),st==="middle"&&(st="center"),st==="right"?Tt.x+=Tt.width:st==="center"&&(Tt.x+=Tt.width/2)),ut||(ut=o.get("top")||o.get("bottom"),ut==="center"&&(ut="middle"),ut==="bottom"?Tt.y+=Tt.height:ut==="middle"&&(Tt.y+=Tt.height/2),ut=ut||"top"),tt.x=Tt.x,tt.y=Tt.y,tt.markRedraw();var Ct={align:st,verticalAlign:ut};ct.setStyle(Ct),ht.setStyle(Ct),bt=tt.getBoundingRect();var Dt=Tt.margin,Ot=o.getItemStyle(["color","opacity"]);Ot.fill=o.get("backgroundColor");var $t=new Rect$2({shape:{x:bt.x-Dt[3],y:bt.y-Dt[0],width:bt.width+Dt[1]+Dt[3],height:bt.height+Dt[0]+Dt[2],r:o.get("borderRadius")},style:Ot,subPixelOptimize:!0,silent:!0});tt.add($t)}},a.type="title",a}(ComponentView);function install$g(s){s.registerComponentModel(TitleModel),s.registerComponentView(TitleView)}var TimelineModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.layoutMode="box",o}return a.prototype.init=function(o,c,d){this.mergeDefaultAndTheme(o,d),this._initData()},a.prototype.mergeOption=function(o){s.prototype.mergeOption.apply(this,arguments),this._initData()},a.prototype.setCurrentIndex=function(o){o==null&&(o=this.option.currentIndex);var c=this._data.count();this.option.loop?o=(o%c+c)%c:(o>=c&&(o=c-1),o<0&&(o=0)),this.option.currentIndex=o},a.prototype.getCurrentIndex=function(){return this.option.currentIndex},a.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},a.prototype.setPlayState=function(o){this.option.autoPlay=!!o},a.prototype.getPlayState=function(){return!!this.option.autoPlay},a.prototype._initData=function(){var o=this.option,c=o.data||[],d=o.axisType,tt=this._names=[],nt;d==="category"?(nt=[],each$f(c,function(ut,ct){var ot=convertOptionIdName(getDataItemValue(ut),""),at;isObject$3(ut)?(at=clone$4(ut),at.value=ct):at=ct,nt.push(at),tt.push(ot)})):nt=c;var it={category:"ordinal",time:"time",value:"number"}[d]||"number",st=this._data=new SeriesData([{name:"value",type:it}],this);st.initData(nt,tt)},a.prototype.getData=function(){return this._data},a.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},a.type="timeline",a.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},a}(ComponentModel),SliderTimelineModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="timeline.slider",a.defaultOption=inheritDefaultOption(TimelineModel.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),a}(TimelineModel);mixin(SliderTimelineModel,DataFormatMixin.prototype);var TimelineView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="timeline",a}(ComponentView),TimelineAxis=function(s){__extends$1(a,s);function a(o,c,d,tt){var nt=s.call(this,o,c,d)||this;return nt.type=tt||"value",nt}return a.prototype.getLabelModel=function(){return this.model.getModel("label")},a.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},a}(Axis),PI=Math.PI,labelDataIndexStore=makeInner(),SliderTimelineView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(o,c){this.api=c},a.prototype.render=function(o,c,d){if(this.model=o,this.api=d,this.ecModel=c,this.group.removeAll(),o.get("show",!0)){var tt=this._layout(o,d),nt=this._createGroup("_mainGroup"),it=this._createGroup("_labelGroup"),st=this._axis=this._createAxis(tt,o);o.formatTooltip=function(ut){var ct=st.scale.getLabel({value:ut});return createTooltipMarkup("nameValue",{noName:!0,value:ct})},each$f(["AxisLine","AxisTick","Control","CurrentPointer"],function(ut){this["_render"+ut](tt,nt,st,o)},this),this._renderAxisLabel(tt,it,st,o),this._position(tt,o)}this._doPlayStop(),this._updateTicksStatus()},a.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},a.prototype.dispose=function(){this._clearTimer()},a.prototype._layout=function(o,c){var d=o.get(["label","position"]),tt=o.get("orient"),nt=getViewRect(o,c),it;d==null||d==="auto"?it=tt==="horizontal"?nt.y+nt.height/2<c.getHeight()/2?"-":"+":nt.x+nt.width/2<c.getWidth()/2?"+":"-":isString$1(d)?it={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[tt][d]:it=d;var st={horizontal:"center",vertical:it>=0||it==="+"?"left":"right"},ut={horizontal:it>=0||it==="+"?"top":"bottom",vertical:"middle"},ct={horizontal:0,vertical:PI/2},ot=tt==="vertical"?nt.height:nt.width,at=o.getModel("controlStyle"),ht=at.get("show",!0),ft=ht?at.get("itemSize"):0,mt=ht?at.get("itemGap"):0,yt=ft+mt,bt=o.get(["label","rotate"])||0;bt=bt*PI/180;var wt,Tt,Ct,Dt=at.get("position",!0),Ot=ht&&at.get("showPlayBtn",!0),$t=ht&&at.get("showPrevBtn",!0),Ft=ht&&at.get("showNextBtn",!0),kt=0,Vt=ot;Dt==="left"||Dt==="bottom"?(Ot&&(wt=[0,0],kt+=yt),$t&&(Tt=[kt,0],kt+=yt),Ft&&(Ct=[Vt-ft,0],Vt-=yt)):(Ot&&(wt=[Vt-ft,0],Vt-=yt),$t&&(Tt=[0,0],kt+=yt),Ft&&(Ct=[Vt-ft,0],Vt-=yt));var Ht=[kt,Vt];return o.get("inverse")&&Ht.reverse(),{viewRect:nt,mainLength:ot,orient:tt,rotation:ct[tt],labelRotation:bt,labelPosOpt:it,labelAlign:o.get(["label","align"])||st[tt],labelBaseline:o.get(["label","verticalAlign"])||o.get(["label","baseline"])||ut[tt],playPosition:wt,prevBtnPosition:Tt,nextBtnPosition:Ct,axisExtent:Ht,controlSize:ft,controlGap:mt}},a.prototype._position=function(o,c){var d=this._mainGroup,tt=this._labelGroup,nt=o.viewRect;if(o.orient==="vertical"){var it=create$1(),st=nt.x,ut=nt.y+nt.height;translate(it,it,[-st,-ut]),rotate$1(it,it,-PI/2),translate(it,it,[st,ut]),nt=nt.clone(),nt.applyTransform(it)}var ct=wt(nt),ot=wt(d.getBoundingRect()),at=wt(tt.getBoundingRect()),ht=[d.x,d.y],ft=[tt.x,tt.y];ft[0]=ht[0]=ct[0][0];var mt=o.labelPosOpt;if(mt==null||isString$1(mt)){var yt=mt==="+"?0:1;Tt(ht,ot,ct,1,yt),Tt(ft,at,ct,1,1-yt)}else{var yt=mt>=0?0:1;Tt(ht,ot,ct,1,yt),ft[1]=ht[1]+mt}d.setPosition(ht),tt.setPosition(ft),d.rotation=tt.rotation=o.rotation,bt(d),bt(tt);function bt(Ct){Ct.originX=ct[0][0]-Ct.x,Ct.originY=ct[1][0]-Ct.y}function wt(Ct){return[[Ct.x,Ct.x+Ct.width],[Ct.y,Ct.y+Ct.height]]}function Tt(Ct,Dt,Ot,$t,Ft){Ct[$t]+=Ot[$t][Ft]-Dt[$t][Ft]}},a.prototype._createAxis=function(o,c){var d=c.getData(),tt=c.get("axisType"),nt=createScaleByModel(c,tt);nt.getTicks=function(){return d.mapArray(["value"],function(ut){return{value:ut}})};var it=d.getDataExtent("value");nt.setExtent(it[0],it[1]),nt.calcNiceTicks();var st=new TimelineAxis("value",nt,o.axisExtent,tt);return st.model=c,st},a.prototype._createGroup=function(o){var c=this[o]=new Group$3;return this.group.add(c),c},a.prototype._renderAxisLine=function(o,c,d,tt){var nt=d.getExtent();if(tt.get(["lineStyle","show"])){var it=new Line$1({shape:{x1:nt[0],y1:0,x2:nt[1],y2:0},style:extend({lineCap:"round"},tt.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});c.add(it);var st=this._progressLine=new Line$1({shape:{x1:nt[0],x2:this._currentPointer?this._currentPointer.x:nt[0],y1:0,y2:0},style:defaults({lineCap:"round",lineWidth:it.style.lineWidth},tt.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});c.add(st)}},a.prototype._renderAxisTick=function(o,c,d,tt){var nt=this,it=tt.getData(),st=d.scale.getTicks();this._tickSymbols=[],each$f(st,function(ut){var ct=d.dataToCoord(ut.value),ot=it.getItemModel(ut.value),at=ot.getModel("itemStyle"),ht=ot.getModel(["emphasis","itemStyle"]),ft=ot.getModel(["progress","itemStyle"]),mt={x:ct,y:0,onclick:bind$2(nt._changeTimeline,nt,ut.value)},yt=giveSymbol(ot,at,c,mt);yt.ensureState("emphasis").style=ht.getItemStyle(),yt.ensureState("progress").style=ft.getItemStyle(),enableHoverEmphasis(yt);var bt=getECData(yt);ot.get("tooltip")?(bt.dataIndex=ut.value,bt.dataModel=tt):bt.dataIndex=bt.dataModel=null,nt._tickSymbols.push(yt)})},a.prototype._renderAxisLabel=function(o,c,d,tt){var nt=this,it=d.getLabelModel();if(it.get("show")){var st=tt.getData(),ut=d.getViewLabels();this._tickLabels=[],each$f(ut,function(ct){var ot=ct.tickValue,at=st.getItemModel(ot),ht=at.getModel("label"),ft=at.getModel(["emphasis","label"]),mt=at.getModel(["progress","label"]),yt=d.dataToCoord(ct.tickValue),bt=new ZRText({x:yt,y:0,rotation:o.labelRotation-o.rotation,onclick:bind$2(nt._changeTimeline,nt,ot),silent:!1,style:createTextStyle$1(ht,{text:ct.formattedLabel,align:o.labelAlign,verticalAlign:o.labelBaseline})});bt.ensureState("emphasis").style=createTextStyle$1(ft),bt.ensureState("progress").style=createTextStyle$1(mt),c.add(bt),enableHoverEmphasis(bt),labelDataIndexStore(bt).dataIndex=ot,nt._tickLabels.push(bt)})}},a.prototype._renderControl=function(o,c,d,tt){var nt=o.controlSize,it=o.rotation,st=tt.getModel("controlStyle").getItemStyle(),ut=tt.getModel(["emphasis","controlStyle"]).getItemStyle(),ct=tt.getPlayState(),ot=tt.get("inverse",!0);at(o.nextBtnPosition,"next",bind$2(this._changeTimeline,this,ot?"-":"+")),at(o.prevBtnPosition,"prev",bind$2(this._changeTimeline,this,ot?"+":"-")),at(o.playPosition,ct?"stop":"play",bind$2(this._handlePlayClick,this,!ct),!0);function at(ht,ft,mt,yt){if(ht){var bt=parsePercent$1(retrieve2(tt.get(["controlStyle",ft+"BtnSize"]),nt),nt),wt=[0,-bt/2,bt,bt],Tt=makeControlIcon(tt,ft+"Icon",wt,{x:ht[0],y:ht[1],originX:nt/2,originY:0,rotation:yt?-it:0,rectHover:!0,style:st,onclick:mt});Tt.ensureState("emphasis").style=ut,c.add(Tt),enableHoverEmphasis(Tt)}}},a.prototype._renderCurrentPointer=function(o,c,d,tt){var nt=tt.getData(),it=tt.getCurrentIndex(),st=nt.getItemModel(it).getModel("checkpointStyle"),ut=this,ct={onCreate:function(ot){ot.draggable=!0,ot.drift=bind$2(ut._handlePointerDrag,ut),ot.ondragend=bind$2(ut._handlePointerDragend,ut),pointerMoveTo(ot,ut._progressLine,it,d,tt,!0)},onUpdate:function(ot){pointerMoveTo(ot,ut._progressLine,it,d,tt)}};this._currentPointer=giveSymbol(st,st,this._mainGroup,{},this._currentPointer,ct)},a.prototype._handlePlayClick=function(o){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:o,from:this.uid})},a.prototype._handlePointerDrag=function(o,c,d){this._clearTimer(),this._pointerChangeTimeline([d.offsetX,d.offsetY])},a.prototype._handlePointerDragend=function(o){this._pointerChangeTimeline([o.offsetX,o.offsetY],!0)},a.prototype._pointerChangeTimeline=function(o,c){var d=this._toAxisCoord(o)[0],tt=this._axis,nt=asc$2(tt.getExtent().slice());d>nt[1]&&(d=nt[1]),d<nt[0]&&(d=nt[0]),this._currentPointer.x=d,this._currentPointer.markRedraw();var it=this._progressLine;it&&(it.shape.x2=d,it.dirty());var st=this._findNearestTick(d),ut=this.model;(c||st!==ut.getCurrentIndex()&&ut.get("realtime"))&&this._changeTimeline(st)},a.prototype._doPlayStop=function(){var o=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var c=o.model;o._changeTimeline(c.getCurrentIndex()+(c.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},a.prototype._toAxisCoord=function(o){var c=this._mainGroup.getLocalTransform();return applyTransform(o,c,!0)},a.prototype._findNearestTick=function(o){var c=this.model.getData(),d=1/0,tt,nt=this._axis;return c.each(["value"],function(it,st){var ut=nt.dataToCoord(it),ct=Math.abs(ut-o);ct<d&&(d=ct,tt=st)}),tt},a.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},a.prototype._changeTimeline=function(o){var c=this.model.getCurrentIndex();o==="+"?o=c+1:o==="-"&&(o=c-1),this.api.dispatchAction({type:"timelineChange",currentIndex:o,from:this.uid})},a.prototype._updateTicksStatus=function(){var o=this.model.getCurrentIndex(),c=this._tickSymbols,d=this._tickLabels;if(c)for(var tt=0;tt<c.length;tt++)c&&c[tt]&&c[tt].toggleState("progress",tt<o);if(d)for(var tt=0;tt<d.length;tt++)d&&d[tt]&&d[tt].toggleState("progress",labelDataIndexStore(d[tt]).dataIndex<=o)},a.type="timeline.slider",a}(TimelineView);function createScaleByModel(s,a){if(a=a||s.get("type"),a)switch(a){case"category":return new OrdinalScale({ordinalMeta:s.getCategories(),extent:[1/0,-1/0]});case"time":return new TimeScale({locale:s.ecModel.getLocaleModel(),useUTC:s.ecModel.get("useUTC")});default:return new IntervalScale}}function getViewRect(s,a){return getLayoutRect(s.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()},s.get("padding"))}function makeControlIcon(s,a,o,c){var d=c.style,tt=createIcon(s.get(["controlStyle",a]),c||{},new BoundingRect(o[0],o[1],o[2],o[3]));return d&&tt.setStyle(d),tt}function giveSymbol(s,a,o,c,d,tt){var nt=a.get("color");if(d)d.setColor(nt),o.add(d),tt&&tt.onUpdate(d);else{var it=s.get("symbol");d=createSymbol$1(it,-1,-1,2,2,nt),d.setStyle("strokeNoScale",!0),o.add(d),tt&&tt.onCreate(d)}var st=a.getItemStyle(["color"]);d.setStyle(st),c=merge({rectHover:!0,z2:100},c,!0);var ut=normalizeSymbolSize(s.get("symbolSize"));c.scaleX=ut[0]/2,c.scaleY=ut[1]/2;var ct=normalizeSymbolOffset(s.get("symbolOffset"),ut);ct&&(c.x=(c.x||0)+ct[0],c.y=(c.y||0)+ct[1]);var ot=s.get("symbolRotate");return c.rotation=(ot||0)*Math.PI/180||0,d.attr(c),d.updateTransform(),d}function pointerMoveTo(s,a,o,c,d,tt){if(!s.dragging){var nt=d.getModel("checkpointStyle"),it=c.dataToCoord(d.getData().get("value",o));if(tt||!nt.get("animation",!0))s.attr({x:it,y:0}),a&&a.attr({shape:{x2:it}});else{var st={duration:nt.get("animationDuration",!0),easing:nt.get("animationEasing",!0)};s.stopAnimation(null,!0),s.animateTo({x:it,y:0},st),a&&a.animateTo({shape:{x2:it}},st)}}}function installTimelineAction(s){s.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(a,o,c){var d=o.getComponent("timeline");return d&&a.currentIndex!=null&&(d.setCurrentIndex(a.currentIndex),!d.get("loop",!0)&&d.isIndexMax()&&d.getPlayState()&&(d.setPlayState(!1),c.dispatchAction({type:"timelinePlayChange",playState:!1,from:a.from}))),o.resetOption("timeline",{replaceMerge:d.get("replaceMerge",!0)}),defaults({currentIndex:d.option.currentIndex},a)}),s.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(a,o){var c=o.getComponent("timeline");c&&a.playState!=null&&c.setPlayState(a.playState)})}function timelinePreprocessor(s){var a=s&&s.timeline;isArray$1(a)||(a=a?[a]:[]),each$f(a,function(o){o&&compatibleEC2(o)})}function compatibleEC2(s){var a=s.type,o={number:"value",time:"time"};if(o[a]&&(s.axisType=o[a],delete s.type),transferItem(s),has$1(s,"controlPosition")){var c=s.controlStyle||(s.controlStyle={});has$1(c,"position")||(c.position=s.controlPosition),c.position==="none"&&!has$1(c,"show")&&(c.show=!1,delete c.position),delete s.controlPosition}each$f(s.data||[],function(d){isObject$3(d)&&!isArray$1(d)&&(!has$1(d,"value")&&has$1(d,"name")&&(d.value=d.name),transferItem(d))})}function transferItem(s){var a=s.itemStyle||(s.itemStyle={}),o=a.emphasis||(a.emphasis={}),c=s.label||s.label||{},d=c.normal||(c.normal={}),tt={normal:1,emphasis:1};each$f(c,function(nt,it){!tt[it]&&!has$1(d,it)&&(d[it]=nt)}),o.label&&!has$1(c,"emphasis")&&(c.emphasis=o.label,delete o.label)}function has$1(s,a){return s.hasOwnProperty(a)}function install$f(s){s.registerComponentModel(SliderTimelineModel),s.registerComponentView(SliderTimelineView),s.registerSubTypeDefaulter("timeline",function(){return"slider"}),installTimelineAction(s),s.registerPreprocessor(timelinePreprocessor)}function checkMarkerInSeries(s,a){if(!s)return!1;for(var o=isArray$1(s)?s:[s],c=0;c<o.length;c++)if(o[c]&&o[c][a])return!0;return!1}function fillLabel(s){defaultEmphasis(s,"label",["show"])}var inner$5=makeInner(),MarkerModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.createdBySelf=!1,o}return a.prototype.init=function(o,c,d){this.mergeDefaultAndTheme(o,d),this._mergeOption(o,d,!1,!0)},a.prototype.isAnimationEnabled=function(){if(env.node)return!1;var o=this.__hostSeries;return this.getShallow("animation")&&o&&o.isAnimationEnabled()},a.prototype.mergeOption=function(o,c){this._mergeOption(o,c,!1,!1)},a.prototype._mergeOption=function(o,c,d,tt){var nt=this.mainType;d||c.eachSeries(function(it){var st=it.get(this.mainType,!0),ut=inner$5(it)[nt];if(!st||!st.data){inner$5(it)[nt]=null;return}ut?ut._mergeOption(st,c,!0):(tt&&fillLabel(st),each$f(st.data,function(ct){ct instanceof Array?(fillLabel(ct[0]),fillLabel(ct[1])):fillLabel(ct)}),ut=this.createMarkerModelFromSeries(st,this,c),extend(ut,{mainType:this.mainType,seriesIndex:it.seriesIndex,name:it.name,createdBySelf:!0}),ut.__hostSeries=it),inner$5(it)[nt]=ut},this)},a.prototype.formatTooltip=function(o,c,d){var tt=this.getData(),nt=this.getRawValue(o),it=tt.getName(o);return createTooltipMarkup("section",{header:this.name,blocks:[createTooltipMarkup("nameValue",{name:it,value:nt,noName:!it,noValue:nt==null})]})},a.prototype.getData=function(){return this._data},a.prototype.setData=function(o){this._data=o},a.prototype.getDataParams=function(o,c){var d=DataFormatMixin.prototype.getDataParams.call(this,o,c),tt=this.__hostSeries;return tt&&(d.seriesId=tt.id,d.seriesName=tt.name,d.seriesType=tt.subType),d},a.getMarkerModelFromSeries=function(o,c){return inner$5(o)[c]},a.type="marker",a.dependencies=["series","grid","polar","geo"],a}(ComponentModel);mixin(MarkerModel,DataFormatMixin.prototype);var MarkPointModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.createMarkerModelFromSeries=function(o,c,d){return new a(o,c,d)},a.type="markPoint",a.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},a}(MarkerModel);function hasXOrY(s){return!(isNaN(parseFloat(s.x))&&isNaN(parseFloat(s.y)))}function hasXAndY(s){return!isNaN(parseFloat(s.x))&&!isNaN(parseFloat(s.y))}function markerTypeCalculatorWithExtent(s,a,o,c,d,tt){var nt=[],it=isDimensionStacked(a,c),st=it?a.getCalculationInfo("stackResultDimension"):c,ut=numCalculate(a,st,s),ct=a.indicesOfNearest(st,ut)[0];nt[d]=a.get(o,ct),nt[tt]=a.get(st,ct);var ot=a.get(c,ct),at=getPrecision(a.get(c,ct));return at=Math.min(at,20),at>=0&&(nt[tt]=+nt[tt].toFixed(at)),[nt,ot]}var markerTypeCalculator={min:curry$1(markerTypeCalculatorWithExtent,"min"),max:curry$1(markerTypeCalculatorWithExtent,"max"),average:curry$1(markerTypeCalculatorWithExtent,"average"),median:curry$1(markerTypeCalculatorWithExtent,"median")};function dataTransform(s,a){if(a){var o=s.getData(),c=s.coordinateSystem,d=c&&c.dimensions;if(!hasXAndY(a)&&!isArray$1(a.coord)&&isArray$1(d)){var tt=getAxisInfo(a,o,c,s);if(a=clone$4(a),a.type&&markerTypeCalculator[a.type]&&tt.baseAxis&&tt.valueAxis){var nt=indexOf(d,tt.baseAxis.dim),it=indexOf(d,tt.valueAxis.dim),st=markerTypeCalculator[a.type](o,tt.baseDataDim,tt.valueDataDim,nt,it);a.coord=st[0],a.value=st[1]}else a.coord=[a.xAxis!=null?a.xAxis:a.radiusAxis,a.yAxis!=null?a.yAxis:a.angleAxis]}if(a.coord==null||!isArray$1(d))a.coord=[];else for(var ut=a.coord,ct=0;ct<2;ct++)markerTypeCalculator[ut[ct]]&&(ut[ct]=numCalculate(o,o.mapDimension(d[ct]),ut[ct]));return a}}function getAxisInfo(s,a,o,c){var d={};return s.valueIndex!=null||s.valueDim!=null?(d.valueDataDim=s.valueIndex!=null?a.getDimension(s.valueIndex):s.valueDim,d.valueAxis=o.getAxis(dataDimToCoordDim(c,d.valueDataDim)),d.baseAxis=o.getOtherAxis(d.valueAxis),d.baseDataDim=a.mapDimension(d.baseAxis.dim)):(d.baseAxis=c.getBaseAxis(),d.valueAxis=o.getOtherAxis(d.baseAxis),d.baseDataDim=a.mapDimension(d.baseAxis.dim),d.valueDataDim=a.mapDimension(d.valueAxis.dim)),d}function dataDimToCoordDim(s,a){var o=s.getData().getDimensionInfo(a);return o&&o.coordDim}function dataFilter(s,a){return s&&s.containData&&a.coord&&!hasXOrY(a)?s.containData(a.coord):!0}function zoneFilter(s,a,o){return s&&s.containZone&&a.coord&&o.coord&&!hasXOrY(a)&&!hasXOrY(o)?s.containZone(a.coord,o.coord):!0}function createMarkerDimValueGetter(s,a){return s?function(o,c,d,tt){var nt=tt<2?o.coord&&o.coord[tt]:o.value;return parseDataValue(nt,a[tt])}:function(o,c,d,tt){return parseDataValue(o.value,a[tt])}}function numCalculate(s,a,o){if(o==="average"){var c=0,d=0;return s.each(a,function(tt,nt){isNaN(tt)||(c+=tt,d++)}),c/d}else return o==="median"?s.getMedian(a):s.getDataExtent(a)[o==="max"?1:0]}var inner$4=makeInner(),MarkerView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.init=function(){this.markerGroupMap=createHashMap()},a.prototype.render=function(o,c,d){var tt=this,nt=this.markerGroupMap;nt.each(function(it){inner$4(it).keep=!1}),c.eachSeries(function(it){var st=MarkerModel.getMarkerModelFromSeries(it,tt.type);st&&tt.renderSeries(it,st,c,d)}),nt.each(function(it){!inner$4(it).keep&&tt.group.remove(it.group)})},a.prototype.markKeep=function(o){inner$4(o).keep=!0},a.prototype.toggleBlurSeries=function(o,c){var d=this;each$f(o,function(tt){var nt=MarkerModel.getMarkerModelFromSeries(tt,d.type);if(nt){var it=nt.getData();it.eachItemGraphicEl(function(st){st&&(c?enterBlur(st):leaveBlur(st))})}})},a.type="marker",a}(ComponentView);function updateMarkerLayout(s,a,o){var c=a.coordinateSystem;s.each(function(d){var tt=s.getItemModel(d),nt,it=parsePercent(tt.get("x"),o.getWidth()),st=parsePercent(tt.get("y"),o.getHeight());if(!isNaN(it)&&!isNaN(st))nt=[it,st];else if(a.getMarkerPosition)nt=a.getMarkerPosition(s.getValues(s.dimensions,d));else if(c){var ut=s.get(c.dimensions[0],d),ct=s.get(c.dimensions[1],d);nt=c.dataToPoint([ut,ct])}isNaN(it)||(nt[0]=it),isNaN(st)||(nt[1]=st),s.setItemLayout(d,nt)})}var MarkPointView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.updateTransform=function(o,c,d){c.eachSeries(function(tt){var nt=MarkerModel.getMarkerModelFromSeries(tt,"markPoint");nt&&(updateMarkerLayout(nt.getData(),tt,d),this.markerGroupMap.get(tt.id).updateLayout())},this)},a.prototype.renderSeries=function(o,c,d,tt){var nt=o.coordinateSystem,it=o.id,st=o.getData(),ut=this.markerGroupMap,ct=ut.get(it)||ut.set(it,new SymbolDraw),ot=createData(nt,o,c);c.setData(ot),updateMarkerLayout(c.getData(),o,tt),ot.each(function(at){var ht=ot.getItemModel(at),ft=ht.getShallow("symbol"),mt=ht.getShallow("symbolSize"),yt=ht.getShallow("symbolRotate"),bt=ht.getShallow("symbolOffset"),wt=ht.getShallow("symbolKeepAspect");if(isFunction$1(ft)||isFunction$1(mt)||isFunction$1(yt)||isFunction$1(bt)){var Tt=c.getRawValue(at),Ct=c.getDataParams(at);isFunction$1(ft)&&(ft=ft(Tt,Ct)),isFunction$1(mt)&&(mt=mt(Tt,Ct)),isFunction$1(yt)&&(yt=yt(Tt,Ct)),isFunction$1(bt)&&(bt=bt(Tt,Ct))}var Dt=ht.getModel("itemStyle").getItemStyle(),Ot=getVisualFromData(st,"color");Dt.fill||(Dt.fill=Ot),ot.setItemVisual(at,{symbol:ft,symbolSize:mt,symbolRotate:yt,symbolOffset:bt,symbolKeepAspect:wt,style:Dt})}),ct.updateData(ot),this.group.add(ct.group),ot.eachItemGraphicEl(function(at){at.traverse(function(ht){getECData(ht).dataModel=c})}),this.markKeep(ct),ct.group.silent=c.get("silent")||o.get("silent")},a.type="markPoint",a}(MarkerView);function createData(s,a,o){var c;s?c=map$1(s&&s.dimensions,function(it){var st=a.getData().getDimensionInfo(a.getData().mapDimension(it))||{};return extend(extend({},st),{name:it,ordinalMeta:null})}):c=[{name:"value",type:"float"}];var d=new SeriesData(c,o),tt=map$1(o.get("data"),curry$1(dataTransform,a));s&&(tt=filter(tt,curry$1(dataFilter,s)));var nt=createMarkerDimValueGetter(!!s,c);return d.initData(tt,null,nt),d}function install$e(s){s.registerComponentModel(MarkPointModel),s.registerComponentView(MarkPointView),s.registerPreprocessor(function(a){checkMarkerInSeries(a.series,"markPoint")&&(a.markPoint=a.markPoint||{})})}var MarkLineModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.createMarkerModelFromSeries=function(o,c,d){return new a(o,c,d)},a.type="markLine",a.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},a}(MarkerModel),inner$3=makeInner(),markLineTransform=function(s,a,o,c){var d=s.getData(),tt;if(isArray$1(c))tt=c;else{var nt=c.type;if(nt==="min"||nt==="max"||nt==="average"||nt==="median"||c.xAxis!=null||c.yAxis!=null){var it=void 0,st=void 0;if(c.yAxis!=null||c.xAxis!=null)it=a.getAxis(c.yAxis!=null?"y":"x"),st=retrieve(c.yAxis,c.xAxis);else{var ut=getAxisInfo(c,d,a,s);it=ut.valueAxis;var ct=getStackedDimension(d,ut.valueDataDim);st=numCalculate(d,ct,nt)}var ot=it.dim==="x"?0:1,at=1-ot,ht=clone$4(c),ft={coord:[]};ht.type=null,ht.coord=[],ht.coord[at]=-1/0,ft.coord[at]=1/0;var mt=o.get("precision");mt>=0&&isNumber(st)&&(st=+st.toFixed(Math.min(mt,20))),ht.coord[ot]=ft.coord[ot]=st,tt=[ht,ft,{type:nt,valueIndex:c.valueIndex,value:st}]}else tt=[]}var yt=[dataTransform(s,tt[0]),dataTransform(s,tt[1]),extend({},tt[2])];return yt[2].type=yt[2].type||null,merge(yt[2],yt[0]),merge(yt[2],yt[1]),yt};function isInfinity$1(s){return!isNaN(s)&&!isFinite(s)}function ifMarkLineHasOnlyDim(s,a,o,c){var d=1-s,tt=c.dimensions[s];return isInfinity$1(a[d])&&isInfinity$1(o[d])&&a[s]===o[s]&&c.getAxis(tt).containData(a[s])}function markLineFilter(s,a){if(s.type==="cartesian2d"){var o=a[0].coord,c=a[1].coord;if(o&&c&&(ifMarkLineHasOnlyDim(1,o,c,s)||ifMarkLineHasOnlyDim(0,o,c,s)))return!0}return dataFilter(s,a[0])&&dataFilter(s,a[1])}function updateSingleMarkerEndLayout(s,a,o,c,d){var tt=c.coordinateSystem,nt=s.getItemModel(a),it,st=parsePercent(nt.get("x"),d.getWidth()),ut=parsePercent(nt.get("y"),d.getHeight());if(!isNaN(st)&&!isNaN(ut))it=[st,ut];else{if(c.getMarkerPosition)it=c.getMarkerPosition(s.getValues(s.dimensions,a));else{var ct=tt.dimensions,ot=s.get(ct[0],a),at=s.get(ct[1],a);it=tt.dataToPoint([ot,at])}if(isCoordinateSystemType(tt,"cartesian2d")){var ht=tt.getAxis("x"),ft=tt.getAxis("y"),ct=tt.dimensions;isInfinity$1(s.get(ct[0],a))?it[0]=ht.toGlobalCoord(ht.getExtent()[o?0:1]):isInfinity$1(s.get(ct[1],a))&&(it[1]=ft.toGlobalCoord(ft.getExtent()[o?0:1]))}isNaN(st)||(it[0]=st),isNaN(ut)||(it[1]=ut)}s.setItemLayout(a,it)}var MarkLineView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.updateTransform=function(o,c,d){c.eachSeries(function(tt){var nt=MarkerModel.getMarkerModelFromSeries(tt,"markLine");if(nt){var it=nt.getData(),st=inner$3(nt).from,ut=inner$3(nt).to;st.each(function(ct){updateSingleMarkerEndLayout(st,ct,!0,tt,d),updateSingleMarkerEndLayout(ut,ct,!1,tt,d)}),it.each(function(ct){it.setItemLayout(ct,[st.getItemLayout(ct),ut.getItemLayout(ct)])}),this.markerGroupMap.get(tt.id).updateLayout()}},this)},a.prototype.renderSeries=function(o,c,d,tt){var nt=o.coordinateSystem,it=o.id,st=o.getData(),ut=this.markerGroupMap,ct=ut.get(it)||ut.set(it,new LineDraw);this.group.add(ct.group);var ot=createList$1(nt,o,c),at=ot.from,ht=ot.to,ft=ot.line;inner$3(c).from=at,inner$3(c).to=ht,c.setData(ft);var mt=c.get("symbol"),yt=c.get("symbolSize"),bt=c.get("symbolRotate"),wt=c.get("symbolOffset");isArray$1(mt)||(mt=[mt,mt]),isArray$1(yt)||(yt=[yt,yt]),isArray$1(bt)||(bt=[bt,bt]),isArray$1(wt)||(wt=[wt,wt]),ot.from.each(function(Ct){Tt(at,Ct,!0),Tt(ht,Ct,!1)}),ft.each(function(Ct){var Dt=ft.getItemModel(Ct).getModel("lineStyle").getLineStyle();ft.setItemLayout(Ct,[at.getItemLayout(Ct),ht.getItemLayout(Ct)]),Dt.stroke==null&&(Dt.stroke=at.getItemVisual(Ct,"style").fill),ft.setItemVisual(Ct,{fromSymbolKeepAspect:at.getItemVisual(Ct,"symbolKeepAspect"),fromSymbolOffset:at.getItemVisual(Ct,"symbolOffset"),fromSymbolRotate:at.getItemVisual(Ct,"symbolRotate"),fromSymbolSize:at.getItemVisual(Ct,"symbolSize"),fromSymbol:at.getItemVisual(Ct,"symbol"),toSymbolKeepAspect:ht.getItemVisual(Ct,"symbolKeepAspect"),toSymbolOffset:ht.getItemVisual(Ct,"symbolOffset"),toSymbolRotate:ht.getItemVisual(Ct,"symbolRotate"),toSymbolSize:ht.getItemVisual(Ct,"symbolSize"),toSymbol:ht.getItemVisual(Ct,"symbol"),style:Dt})}),ct.updateData(ft),ot.line.eachItemGraphicEl(function(Ct){getECData(Ct).dataModel=c,Ct.traverse(function(Dt){getECData(Dt).dataModel=c})});function Tt(Ct,Dt,Ot){var $t=Ct.getItemModel(Dt);updateSingleMarkerEndLayout(Ct,Dt,Ot,o,tt);var Ft=$t.getModel("itemStyle").getItemStyle();Ft.fill==null&&(Ft.fill=getVisualFromData(st,"color")),Ct.setItemVisual(Dt,{symbolKeepAspect:$t.get("symbolKeepAspect"),symbolOffset:retrieve2($t.get("symbolOffset",!0),wt[Ot?0:1]),symbolRotate:retrieve2($t.get("symbolRotate",!0),bt[Ot?0:1]),symbolSize:retrieve2($t.get("symbolSize"),yt[Ot?0:1]),symbol:retrieve2($t.get("symbol",!0),mt[Ot?0:1]),style:Ft})}this.markKeep(ct),ct.group.silent=c.get("silent")||o.get("silent")},a.type="markLine",a}(MarkerView);function createList$1(s,a,o){var c;s?c=map$1(s&&s.dimensions,function(ut){var ct=a.getData().getDimensionInfo(a.getData().mapDimension(ut))||{};return extend(extend({},ct),{name:ut,ordinalMeta:null})}):c=[{name:"value",type:"float"}];var d=new SeriesData(c,o),tt=new SeriesData(c,o),nt=new SeriesData([],o),it=map$1(o.get("data"),curry$1(markLineTransform,a,s,o));s&&(it=filter(it,curry$1(markLineFilter,s)));var st=createMarkerDimValueGetter(!!s,c);return d.initData(map$1(it,function(ut){return ut[0]}),null,st),tt.initData(map$1(it,function(ut){return ut[1]}),null,st),nt.initData(map$1(it,function(ut){return ut[2]})),nt.hasItemOption=!0,{from:d,to:tt,line:nt}}function install$d(s){s.registerComponentModel(MarkLineModel),s.registerComponentView(MarkLineView),s.registerPreprocessor(function(a){checkMarkerInSeries(a.series,"markLine")&&(a.markLine=a.markLine||{})})}var MarkAreaModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.createMarkerModelFromSeries=function(o,c,d){return new a(o,c,d)},a.type="markArea",a.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},a}(MarkerModel),inner$2=makeInner(),markAreaTransform=function(s,a,o,c){var d=c[0],tt=c[1];if(!(!d||!tt)){var nt=dataTransform(s,d),it=dataTransform(s,tt),st=nt.coord,ut=it.coord;st[0]=retrieve(st[0],-1/0),st[1]=retrieve(st[1],-1/0),ut[0]=retrieve(ut[0],1/0),ut[1]=retrieve(ut[1],1/0);var ct=mergeAll([{},nt,it]);return ct.coord=[nt.coord,it.coord],ct.x0=nt.x,ct.y0=nt.y,ct.x1=it.x,ct.y1=it.y,ct}};function isInfinity(s){return!isNaN(s)&&!isFinite(s)}function ifMarkAreaHasOnlyDim(s,a,o,c){var d=1-s;return isInfinity(a[d])&&isInfinity(o[d])}function markAreaFilter(s,a){var o=a.coord[0],c=a.coord[1],d={coord:o,x:a.x0,y:a.y0},tt={coord:c,x:a.x1,y:a.y1};return isCoordinateSystemType(s,"cartesian2d")?o&&c&&(ifMarkAreaHasOnlyDim(1,o,c)||ifMarkAreaHasOnlyDim(0,o,c))?!0:zoneFilter(s,d,tt):dataFilter(s,d)||dataFilter(s,tt)}function getSingleMarkerEndPoint(s,a,o,c,d){var tt=c.coordinateSystem,nt=s.getItemModel(a),it,st=parsePercent(nt.get(o[0]),d.getWidth()),ut=parsePercent(nt.get(o[1]),d.getHeight());if(!isNaN(st)&&!isNaN(ut))it=[st,ut];else{if(c.getMarkerPosition){var ct=s.getValues(["x0","y0"],a),ot=s.getValues(["x1","y1"],a),at=tt.clampData(ct),ht=tt.clampData(ot),ft=[];o[0]==="x0"?ft[0]=at[0]>ht[0]?ot[0]:ct[0]:ft[0]=at[0]>ht[0]?ct[0]:ot[0],o[1]==="y0"?ft[1]=at[1]>ht[1]?ot[1]:ct[1]:ft[1]=at[1]>ht[1]?ct[1]:ot[1],it=c.getMarkerPosition(ft,o,!0)}else{var mt=s.get(o[0],a),yt=s.get(o[1],a),bt=[mt,yt];tt.clampData&&tt.clampData(bt,bt),it=tt.dataToPoint(bt,!0)}if(isCoordinateSystemType(tt,"cartesian2d")){var wt=tt.getAxis("x"),Tt=tt.getAxis("y"),mt=s.get(o[0],a),yt=s.get(o[1],a);isInfinity(mt)?it[0]=wt.toGlobalCoord(wt.getExtent()[o[0]==="x0"?0:1]):isInfinity(yt)&&(it[1]=Tt.toGlobalCoord(Tt.getExtent()[o[1]==="y0"?0:1]))}isNaN(st)||(it[0]=st),isNaN(ut)||(it[1]=ut)}return it}var dimPermutations=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],MarkAreaView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.updateTransform=function(o,c,d){c.eachSeries(function(tt){var nt=MarkerModel.getMarkerModelFromSeries(tt,"markArea");if(nt){var it=nt.getData();it.each(function(st){var ut=map$1(dimPermutations,function(ot){return getSingleMarkerEndPoint(it,st,ot,tt,d)});it.setItemLayout(st,ut);var ct=it.getItemGraphicEl(st);ct.setShape("points",ut)})}},this)},a.prototype.renderSeries=function(o,c,d,tt){var nt=o.coordinateSystem,it=o.id,st=o.getData(),ut=this.markerGroupMap,ct=ut.get(it)||ut.set(it,{group:new Group$3});this.group.add(ct.group),this.markKeep(ct);var ot=createList(nt,o,c);c.setData(ot),ot.each(function(at){var ht=map$1(dimPermutations,function(Ft){return getSingleMarkerEndPoint(ot,at,Ft,o,tt)}),ft=nt.getAxis("x").scale,mt=nt.getAxis("y").scale,yt=ft.getExtent(),bt=mt.getExtent(),wt=[ft.parse(ot.get("x0",at)),ft.parse(ot.get("x1",at))],Tt=[mt.parse(ot.get("y0",at)),mt.parse(ot.get("y1",at))];asc$2(wt),asc$2(Tt);var Ct=!(yt[0]>wt[1]||yt[1]<wt[0]||bt[0]>Tt[1]||bt[1]<Tt[0]),Dt=!Ct;ot.setItemLayout(at,{points:ht,allClipped:Dt});var Ot=ot.getItemModel(at).getModel("itemStyle").getItemStyle(),$t=getVisualFromData(st,"color");Ot.fill||(Ot.fill=$t,isString$1(Ot.fill)&&(Ot.fill=modifyAlpha(Ot.fill,.4))),Ot.stroke||(Ot.stroke=$t),ot.setItemVisual(at,"style",Ot)}),ot.diff(inner$2(ct).data).add(function(at){var ht=ot.getItemLayout(at);if(!ht.allClipped){var ft=new Polygon({shape:{points:ht.points}});ot.setItemGraphicEl(at,ft),ct.group.add(ft)}}).update(function(at,ht){var ft=inner$2(ct).data.getItemGraphicEl(ht),mt=ot.getItemLayout(at);mt.allClipped?ft&&ct.group.remove(ft):(ft?updateProps$1(ft,{shape:{points:mt.points}},c,at):ft=new Polygon({shape:{points:mt.points}}),ot.setItemGraphicEl(at,ft),ct.group.add(ft))}).remove(function(at){var ht=inner$2(ct).data.getItemGraphicEl(at);ct.group.remove(ht)}).execute(),ot.eachItemGraphicEl(function(at,ht){var ft=ot.getItemModel(ht),mt=ot.getItemVisual(ht,"style");at.useStyle(ot.getItemVisual(ht,"style")),setLabelStyle(at,getLabelStatesModels(ft),{labelFetcher:c,labelDataIndex:ht,defaultText:ot.getName(ht)||"",inheritColor:isString$1(mt.fill)?modifyAlpha(mt.fill,1):"#000"}),setStatesStylesFromModel(at,ft),toggleHoverEmphasis(at,null,null,ft.get(["emphasis","disabled"])),getECData(at).dataModel=c}),inner$2(ct).data=ot,ct.group.silent=c.get("silent")||o.get("silent")},a.type="markArea",a}(MarkerView);function createList(s,a,o){var c,d,tt=["x0","y0","x1","y1"];if(s){var nt=map$1(s&&s.dimensions,function(ut){var ct=a.getData(),ot=ct.getDimensionInfo(ct.mapDimension(ut))||{};return extend(extend({},ot),{name:ut,ordinalMeta:null})});d=map$1(tt,function(ut,ct){return{name:ut,type:nt[ct%2].type}}),c=new SeriesData(d,o)}else d=[{name:"value",type:"float"}],c=new SeriesData(d,o);var it=map$1(o.get("data"),curry$1(markAreaTransform,a,s,o));s&&(it=filter(it,curry$1(markAreaFilter,s)));var st=s?function(ut,ct,ot,at){var ht=ut.coord[Math.floor(at/2)][at%2];return parseDataValue(ht,d[at])}:function(ut,ct,ot,at){return parseDataValue(ut.value,d[at])};return c.initData(it,null,st),c.hasItemOption=!0,c}function install$c(s){s.registerComponentModel(MarkAreaModel),s.registerComponentView(MarkAreaView),s.registerPreprocessor(function(a){checkMarkerInSeries(a.series,"markArea")&&(a.markArea=a.markArea||{})})}var getDefaultSelectorOptions=function(s,a){if(a==="all")return{type:"all",title:s.getLocaleModel().get(["legend","selector","all"])};if(a==="inverse")return{type:"inverse",title:s.getLocaleModel().get(["legend","selector","inverse"])}},LegendModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.layoutMode={type:"box",ignoreSize:!0},o}return a.prototype.init=function(o,c,d){this.mergeDefaultAndTheme(o,d),o.selected=o.selected||{},this._updateSelector(o)},a.prototype.mergeOption=function(o,c){s.prototype.mergeOption.call(this,o,c),this._updateSelector(o)},a.prototype._updateSelector=function(o){var c=o.selector,d=this.ecModel;c===!0&&(c=o.selector=["all","inverse"]),isArray$1(c)&&each$f(c,function(tt,nt){isString$1(tt)&&(tt={type:tt}),c[nt]=merge(tt,getDefaultSelectorOptions(d,tt.type))})},a.prototype.optionUpdated=function(){this._updateData(this.ecModel);var o=this._data;if(o[0]&&this.get("selectedMode")==="single"){for(var c=!1,d=0;d<o.length;d++){var tt=o[d].get("name");if(this.isSelected(tt)){this.select(tt),c=!0;break}}!c&&this.select(o[0].get("name"))}},a.prototype._updateData=function(o){var c=[],d=[];o.eachRawSeries(function(st){var ut=st.name;d.push(ut);var ct;if(st.legendVisualProvider){var ot=st.legendVisualProvider,at=ot.getAllNames();o.isSeriesFiltered(st)||(d=d.concat(at)),at.length?c=c.concat(at):ct=!0}else ct=!0;ct&&isNameSpecified(st)&&c.push(st.name)}),this._availableNames=d;var tt=this.get("data")||c,nt=createHashMap(),it=map$1(tt,function(st){return(isString$1(st)||isNumber(st))&&(st={name:st}),nt.get(st.name)?null:(nt.set(st.name,!0),new Model(st,this,this.ecModel))},this);this._data=filter(it,function(st){return!!st})},a.prototype.getData=function(){return this._data},a.prototype.select=function(o){var c=this.option.selected,d=this.get("selectedMode");if(d==="single"){var tt=this._data;each$f(tt,function(nt){c[nt.get("name")]=!1})}c[o]=!0},a.prototype.unSelect=function(o){this.get("selectedMode")!=="single"&&(this.option.selected[o]=!1)},a.prototype.toggleSelected=function(o){var c=this.option.selected;c.hasOwnProperty(o)||(c[o]=!0),this[c[o]?"unSelect":"select"](o)},a.prototype.allSelect=function(){var o=this._data,c=this.option.selected;each$f(o,function(d){c[d.get("name",!0)]=!0})},a.prototype.inverseSelect=function(){var o=this._data,c=this.option.selected;each$f(o,function(d){var tt=d.get("name",!0);c.hasOwnProperty(tt)||(c[tt]=!0),c[tt]=!c[tt]})},a.prototype.isSelected=function(o){var c=this.option.selected;return!(c.hasOwnProperty(o)&&!c[o])&&indexOf(this._availableNames,o)>=0},a.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},a.type="legend.plain",a.dependencies=["series"],a.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},a}(ComponentModel),curry=curry$1,each$3=each$f,Group$1=Group$3,LegendView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.newlineDisabled=!1,o}return a.prototype.init=function(){this.group.add(this._contentGroup=new Group$1),this.group.add(this._selectorGroup=new Group$1),this._isFirstRender=!0},a.prototype.getContentGroup=function(){return this._contentGroup},a.prototype.getSelectorGroup=function(){return this._selectorGroup},a.prototype.render=function(o,c,d){var tt=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!o.get("show",!0)){var nt=o.get("align"),it=o.get("orient");(!nt||nt==="auto")&&(nt=o.get("left")==="right"&&it==="vertical"?"right":"left");var st=o.get("selector",!0),ut=o.get("selectorPosition",!0);st&&(!ut||ut==="auto")&&(ut=it==="horizontal"?"end":"start"),this.renderInner(nt,o,c,d,st,it,ut);var ct=o.getBoxLayoutParams(),ot={width:d.getWidth(),height:d.getHeight()},at=o.get("padding"),ht=getLayoutRect(ct,ot,at),ft=this.layoutInner(o,nt,ht,tt,st,ut),mt=getLayoutRect(defaults({width:ft.width,height:ft.height},ct),ot,at);this.group.x=mt.x-ft.x,this.group.y=mt.y-ft.y,this.group.markRedraw(),this.group.add(this._backgroundEl=makeBackground(ft,o))}},a.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},a.prototype.renderInner=function(o,c,d,tt,nt,it,st){var ut=this.getContentGroup(),ct=createHashMap(),ot=c.get("selectedMode"),at=[];d.eachRawSeries(function(ht){!ht.get("legendHoverLink")&&at.push(ht.id)}),each$3(c.getData(),function(ht,ft){var mt=ht.get("name");if(!this.newlineDisabled&&(mt===""||mt===`
`)){var yt=new Group$1;yt.newline=!0,ut.add(yt);return}var bt=d.getSeriesByName(mt)[0];if(!ct.get(mt))if(bt){var wt=bt.getData(),Tt=wt.getVisual("legendLineStyle")||{},Ct=wt.getVisual("legendIcon"),Dt=wt.getVisual("style"),Ot=this._createItem(bt,mt,ft,ht,c,o,Tt,Dt,Ct,ot,tt);Ot.on("click",curry(dispatchSelectAction,mt,null,tt,at)).on("mouseover",curry(dispatchHighlightAction,bt.name,null,tt,at)).on("mouseout",curry(dispatchDownplayAction,bt.name,null,tt,at)),d.ssr&&Ot.eachChild(function($t){var Ft=getECData($t);Ft.seriesIndex=bt.seriesIndex,Ft.dataIndex=ft,Ft.ssrType="legend"}),ct.set(mt,!0)}else d.eachRawSeries(function($t){if(!ct.get(mt)&&$t.legendVisualProvider){var Ft=$t.legendVisualProvider;if(!Ft.containName(mt))return;var kt=Ft.indexOfName(mt),Vt=Ft.getItemVisual(kt,"style"),Ht=Ft.getItemVisual(kt,"legendIcon"),Qt=parse(Vt.fill);Qt&&Qt[3]===0&&(Qt[3]=.2,Vt=extend(extend({},Vt),{fill:stringify(Qt,"rgba")}));var Xt=this._createItem($t,mt,ft,ht,c,o,{},Vt,Ht,ot,tt);Xt.on("click",curry(dispatchSelectAction,null,mt,tt,at)).on("mouseover",curry(dispatchHighlightAction,null,mt,tt,at)).on("mouseout",curry(dispatchDownplayAction,null,mt,tt,at)),d.ssr&&Xt.eachChild(function(Zt){var ar=getECData(Zt);ar.seriesIndex=$t.seriesIndex,ar.dataIndex=ft,ar.ssrType="legend"}),ct.set(mt,!0)}},this)},this),nt&&this._createSelector(nt,c,tt,it,st)},a.prototype._createSelector=function(o,c,d,tt,nt){var it=this.getSelectorGroup();each$3(o,function(ut){var ct=ut.type,ot=new ZRText({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){d.dispatchAction({type:ct==="all"?"legendAllSelect":"legendInverseSelect",legendId:c.id})}});it.add(ot);var at=c.getModel("selectorLabel"),ht=c.getModel(["emphasis","selectorLabel"]);setLabelStyle(ot,{normal:at,emphasis:ht},{defaultText:ut.title}),enableHoverEmphasis(ot)})},a.prototype._createItem=function(o,c,d,tt,nt,it,st,ut,ct,ot,at){var ht=o.visualDrawType,ft=nt.get("itemWidth"),mt=nt.get("itemHeight"),yt=nt.isSelected(c),bt=tt.get("symbolRotate"),wt=tt.get("symbolKeepAspect"),Tt=tt.get("icon");ct=Tt||ct||"roundRect";var Ct=getLegendStyle(ct,tt,st,ut,ht,yt,at),Dt=new Group$1,Ot=tt.getModel("textStyle");if(isFunction$1(o.getLegendIcon)&&(!Tt||Tt==="inherit"))Dt.add(o.getLegendIcon({itemWidth:ft,itemHeight:mt,icon:ct,iconRotate:bt,itemStyle:Ct.itemStyle,lineStyle:Ct.lineStyle,symbolKeepAspect:wt}));else{var $t=Tt==="inherit"&&o.getData().getVisual("symbol")?bt==="inherit"?o.getData().getVisual("symbolRotate"):bt:0;Dt.add(getDefaultLegendIcon({itemWidth:ft,itemHeight:mt,icon:ct,iconRotate:$t,itemStyle:Ct.itemStyle,symbolKeepAspect:wt}))}var Ft=it==="left"?ft+5:-5,kt=it,Vt=nt.get("formatter"),Ht=c;isString$1(Vt)&&Vt?Ht=Vt.replace("{name}",c??""):isFunction$1(Vt)&&(Ht=Vt(c));var Qt=yt?Ot.getTextColor():tt.get("inactiveColor");Dt.add(new ZRText({style:createTextStyle$1(Ot,{text:Ht,x:Ft,y:mt/2,fill:Qt,align:kt,verticalAlign:"middle"},{inheritColor:Qt})}));var Xt=new Rect$2({shape:Dt.getBoundingRect(),style:{fill:"transparent"}}),Zt=tt.getModel("tooltip");return Zt.get("show")&&setTooltipConfig({el:Xt,componentModel:nt,itemName:c,itemTooltipOption:Zt.option}),Dt.add(Xt),Dt.eachChild(function(ar){ar.silent=!0}),Xt.silent=!ot,this.getContentGroup().add(Dt),enableHoverEmphasis(Dt),Dt.__legendDataIndex=d,Dt},a.prototype.layoutInner=function(o,c,d,tt,nt,it){var st=this.getContentGroup(),ut=this.getSelectorGroup();box(o.get("orient"),st,o.get("itemGap"),d.width,d.height);var ct=st.getBoundingRect(),ot=[-ct.x,-ct.y];if(ut.markRedraw(),st.markRedraw(),nt){box("horizontal",ut,o.get("selectorItemGap",!0));var at=ut.getBoundingRect(),ht=[-at.x,-at.y],ft=o.get("selectorButtonGap",!0),mt=o.getOrient().index,yt=mt===0?"width":"height",bt=mt===0?"height":"width",wt=mt===0?"y":"x";it==="end"?ht[mt]+=ct[yt]+ft:ot[mt]+=at[yt]+ft,ht[1-mt]+=ct[bt]/2-at[bt]/2,ut.x=ht[0],ut.y=ht[1],st.x=ot[0],st.y=ot[1];var Tt={x:0,y:0};return Tt[yt]=ct[yt]+ft+at[yt],Tt[bt]=Math.max(ct[bt],at[bt]),Tt[wt]=Math.min(0,at[wt]+ht[1-mt]),Tt}else return st.x=ot[0],st.y=ot[1],this.group.getBoundingRect()},a.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},a.type="legend.plain",a}(ComponentView);function getLegendStyle(s,a,o,c,d,tt,nt){function it(yt,bt){yt.lineWidth==="auto"&&(yt.lineWidth=bt.lineWidth>0?2:0),each$3(yt,function(wt,Tt){yt[Tt]==="inherit"&&(yt[Tt]=bt[Tt])})}var st=a.getModel("itemStyle"),ut=st.getItemStyle(),ct=s.lastIndexOf("empty",0)===0?"fill":"stroke",ot=st.getShallow("decal");ut.decal=!ot||ot==="inherit"?c.decal:createOrUpdatePatternFromDecal(ot,nt),ut.fill==="inherit"&&(ut.fill=c[d]),ut.stroke==="inherit"&&(ut.stroke=c[ct]),ut.opacity==="inherit"&&(ut.opacity=(d==="fill"?c:o).opacity),it(ut,c);var at=a.getModel("lineStyle"),ht=at.getLineStyle();if(it(ht,o),ut.fill==="auto"&&(ut.fill=c.fill),ut.stroke==="auto"&&(ut.stroke=c.fill),ht.stroke==="auto"&&(ht.stroke=c.fill),!tt){var ft=a.get("inactiveBorderWidth"),mt=ut[ct];ut.lineWidth=ft==="auto"?c.lineWidth>0&&mt?2:0:ut.lineWidth,ut.fill=a.get("inactiveColor"),ut.stroke=a.get("inactiveBorderColor"),ht.stroke=at.get("inactiveColor"),ht.lineWidth=at.get("inactiveWidth")}return{itemStyle:ut,lineStyle:ht}}function getDefaultLegendIcon(s){var a=s.icon||"roundRect",o=createSymbol$1(a,0,0,s.itemWidth,s.itemHeight,s.itemStyle.fill,s.symbolKeepAspect);return o.setStyle(s.itemStyle),o.rotation=(s.iconRotate||0)*Math.PI/180,o.setOrigin([s.itemWidth/2,s.itemHeight/2]),a.indexOf("empty")>-1&&(o.style.stroke=o.style.fill,o.style.fill="#fff",o.style.lineWidth=2),o}function dispatchSelectAction(s,a,o,c){dispatchDownplayAction(s,a,o,c),o.dispatchAction({type:"legendToggleSelect",name:s??a}),dispatchHighlightAction(s,a,o,c)}function isUseHoverLayer(s){for(var a=s.getZr().storage.getDisplayList(),o,c=0,d=a.length;c<d&&!(o=a[c].states.emphasis);)c++;return o&&o.hoverLayer}function dispatchHighlightAction(s,a,o,c){isUseHoverLayer(o)||o.dispatchAction({type:"highlight",seriesName:s,name:a,excludeSeriesId:c})}function dispatchDownplayAction(s,a,o,c){isUseHoverLayer(o)||o.dispatchAction({type:"downplay",seriesName:s,name:a,excludeSeriesId:c})}function legendFilter(s){var a=s.findComponents({mainType:"legend"});a&&a.length&&s.filterSeries(function(o){for(var c=0;c<a.length;c++)if(!a[c].isSelected(o.name))return!1;return!0})}function legendSelectActionHandler(s,a,o){var c=s==="allSelect"||s==="inverseSelect",d={},tt=[];o.eachComponent({mainType:"legend",query:a},function(it){c?it[s]():it[s](a.name),makeSelectedMap(it,d),tt.push(it.componentIndex)});var nt={};return o.eachComponent("legend",function(it){each$f(d,function(st,ut){it[st?"select":"unSelect"](ut)}),makeSelectedMap(it,nt)}),c?{selected:nt,legendIndex:tt}:{name:a.name,selected:nt}}function makeSelectedMap(s,a){var o=a||{};return each$f(s.getData(),function(c){var d=c.get("name");if(!(d===`
`||d==="")){var tt=s.isSelected(d);hasOwn(o,d)?o[d]=o[d]&&tt:o[d]=tt}}),o}function installLegendAction(s){s.registerAction("legendToggleSelect","legendselectchanged",curry$1(legendSelectActionHandler,"toggleSelected")),s.registerAction("legendAllSelect","legendselectall",curry$1(legendSelectActionHandler,"allSelect")),s.registerAction("legendInverseSelect","legendinverseselect",curry$1(legendSelectActionHandler,"inverseSelect")),s.registerAction("legendSelect","legendselected",curry$1(legendSelectActionHandler,"select")),s.registerAction("legendUnSelect","legendunselected",curry$1(legendSelectActionHandler,"unSelect"))}function install$b(s){s.registerComponentModel(LegendModel),s.registerComponentView(LegendView),s.registerProcessor(s.PRIORITY.PROCESSOR.SERIES_FILTER,legendFilter),s.registerSubTypeDefaulter("legend",function(){return"plain"}),installLegendAction(s)}var ScrollableLegendModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.setScrollDataIndex=function(o){this.option.scrollDataIndex=o},a.prototype.init=function(o,c,d){var tt=getLayoutParams(o);s.prototype.init.call(this,o,c,d),mergeAndNormalizeLayoutParams(this,o,tt)},a.prototype.mergeOption=function(o,c){s.prototype.mergeOption.call(this,o,c),mergeAndNormalizeLayoutParams(this,this.option,o)},a.type="legend.scroll",a.defaultOption=inheritDefaultOption(LegendModel.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),a}(LegendModel);function mergeAndNormalizeLayoutParams(s,a,o){var c=s.getOrient(),d=[1,1];d[c.index]=0,mergeLayoutParam(a,o,{type:"box",ignoreSize:!!d})}var Group=Group$3,WH=["width","height"],XY=["x","y"],ScrollableLegendView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.newlineDisabled=!0,o._currentIndex=0,o}return a.prototype.init=function(){s.prototype.init.call(this),this.group.add(this._containerGroup=new Group),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Group)},a.prototype.resetInner=function(){s.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},a.prototype.renderInner=function(o,c,d,tt,nt,it,st){var ut=this;s.prototype.renderInner.call(this,o,c,d,tt,nt,it,st);var ct=this._controllerGroup,ot=c.get("pageIconSize",!0),at=isArray$1(ot)?ot:[ot,ot];ft("pagePrev",0);var ht=c.getModel("pageTextStyle");ct.add(new ZRText({name:"pageText",style:{text:"xx/xx",fill:ht.getTextColor(),font:ht.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),ft("pageNext",1);function ft(mt,yt){var bt=mt+"DataIndex",wt=createIcon(c.get("pageIcons",!0)[c.getOrient().name][yt],{onclick:bind$2(ut._pageGo,ut,bt,c,tt)},{x:-at[0]/2,y:-at[1]/2,width:at[0],height:at[1]});wt.name=mt,ct.add(wt)}},a.prototype.layoutInner=function(o,c,d,tt,nt,it){var st=this.getSelectorGroup(),ut=o.getOrient().index,ct=WH[ut],ot=XY[ut],at=WH[1-ut],ht=XY[1-ut];nt&&box("horizontal",st,o.get("selectorItemGap",!0));var ft=o.get("selectorButtonGap",!0),mt=st.getBoundingRect(),yt=[-mt.x,-mt.y],bt=clone$4(d);nt&&(bt[ct]=d[ct]-mt[ct]-ft);var wt=this._layoutContentAndController(o,tt,bt,ut,ct,at,ht,ot);if(nt){if(it==="end")yt[ut]+=wt[ct]+ft;else{var Tt=mt[ct]+ft;yt[ut]-=Tt,wt[ot]-=Tt}wt[ct]+=mt[ct]+ft,yt[1-ut]+=wt[ht]+wt[at]/2-mt[at]/2,wt[at]=Math.max(wt[at],mt[at]),wt[ht]=Math.min(wt[ht],mt[ht]+yt[1-ut]),st.x=yt[0],st.y=yt[1],st.markRedraw()}return wt},a.prototype._layoutContentAndController=function(o,c,d,tt,nt,it,st,ut){var ct=this.getContentGroup(),ot=this._containerGroup,at=this._controllerGroup;box(o.get("orient"),ct,o.get("itemGap"),tt?d.width:null,tt?null:d.height),box("horizontal",at,o.get("pageButtonItemGap",!0));var ht=ct.getBoundingRect(),ft=at.getBoundingRect(),mt=this._showController=ht[nt]>d[nt],yt=[-ht.x,-ht.y];c||(yt[tt]=ct[ut]);var bt=[0,0],wt=[-ft.x,-ft.y],Tt=retrieve2(o.get("pageButtonGap",!0),o.get("itemGap",!0));if(mt){var Ct=o.get("pageButtonPosition",!0);Ct==="end"?wt[tt]+=d[nt]-ft[nt]:bt[tt]+=ft[nt]+Tt}wt[1-tt]+=ht[it]/2-ft[it]/2,ct.setPosition(yt),ot.setPosition(bt),at.setPosition(wt);var Dt={x:0,y:0};if(Dt[nt]=mt?d[nt]:ht[nt],Dt[it]=Math.max(ht[it],ft[it]),Dt[st]=Math.min(0,ft[st]+wt[1-tt]),ot.__rectSize=d[nt],mt){var Ot={x:0,y:0};Ot[nt]=Math.max(d[nt]-ft[nt]-Tt,0),Ot[it]=Dt[it],ot.setClipPath(new Rect$2({shape:Ot})),ot.__rectSize=Ot[nt]}else at.eachChild(function(Ft){Ft.attr({invisible:!0,silent:!0})});var $t=this._getPageInfo(o);return $t.pageIndex!=null&&updateProps$1(ct,{x:$t.contentPosition[0],y:$t.contentPosition[1]},mt?o:null),this._updatePageInfoView(o,$t),Dt},a.prototype._pageGo=function(o,c,d){var tt=this._getPageInfo(c)[o];tt!=null&&d.dispatchAction({type:"legendScroll",scrollDataIndex:tt,legendId:c.id})},a.prototype._updatePageInfoView=function(o,c){var d=this._controllerGroup;each$f(["pagePrev","pageNext"],function(ct){var ot=ct+"DataIndex",at=c[ot]!=null,ht=d.childOfName(ct);ht&&(ht.setStyle("fill",at?o.get("pageIconColor",!0):o.get("pageIconInactiveColor",!0)),ht.cursor=at?"pointer":"default")});var tt=d.childOfName("pageText"),nt=o.get("pageFormatter"),it=c.pageIndex,st=it!=null?it+1:0,ut=c.pageCount;tt&&nt&&tt.setStyle("text",isString$1(nt)?nt.replace("{current}",st==null?"":st+"").replace("{total}",ut==null?"":ut+""):nt({current:st,total:ut}))},a.prototype._getPageInfo=function(o){var c=o.get("scrollDataIndex",!0),d=this.getContentGroup(),tt=this._containerGroup.__rectSize,nt=o.getOrient().index,it=WH[nt],st=XY[nt],ut=this._findTargetItemIndex(c),ct=d.children(),ot=ct[ut],at=ct.length,ht=at?1:0,ft={contentPosition:[d.x,d.y],pageCount:ht,pageIndex:ht-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!ot)return ft;var mt=Ct(ot);ft.contentPosition[nt]=-mt.s;for(var yt=ut+1,bt=mt,wt=mt,Tt=null;yt<=at;++yt)Tt=Ct(ct[yt]),(!Tt&&wt.e>bt.s+tt||Tt&&!Dt(Tt,bt.s))&&(wt.i>bt.i?bt=wt:bt=Tt,bt&&(ft.pageNextDataIndex==null&&(ft.pageNextDataIndex=bt.i),++ft.pageCount)),wt=Tt;for(var yt=ut-1,bt=mt,wt=mt,Tt=null;yt>=-1;--yt)Tt=Ct(ct[yt]),(!Tt||!Dt(wt,Tt.s))&&bt.i<wt.i&&(wt=bt,ft.pagePrevDataIndex==null&&(ft.pagePrevDataIndex=bt.i),++ft.pageCount,++ft.pageIndex),bt=Tt;return ft;function Ct(Ot){if(Ot){var $t=Ot.getBoundingRect(),Ft=$t[st]+Ot[st];return{s:Ft,e:Ft+$t[it],i:Ot.__legendDataIndex}}}function Dt(Ot,$t){return Ot.e>=$t&&Ot.s<=$t+tt}},a.prototype._findTargetItemIndex=function(o){if(!this._showController)return 0;var c,d=this.getContentGroup(),tt;return d.eachChild(function(nt,it){var st=nt.__legendDataIndex;tt==null&&st!=null&&(tt=it),st===o&&(c=it)}),c??tt},a.type="legend.scroll",a}(LegendView);function installScrollableLegendAction(s){s.registerAction("legendScroll","legendscroll",function(a,o){var c=a.scrollDataIndex;c!=null&&o.eachComponent({mainType:"legend",subType:"scroll",query:a},function(d){d.setScrollDataIndex(c)})})}function install$a(s){use(install$b),s.registerComponentModel(ScrollableLegendModel),s.registerComponentView(ScrollableLegendView),installScrollableLegendAction(s)}function install$9(s){use(install$b),use(install$a)}var InsideZoomModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="dataZoom.inside",a.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),a}(DataZoomModel),inner$1=makeInner();function setViewInfoToCoordSysRecord(s,a,o){inner$1(s).coordSysRecordMap.each(function(c){var d=c.dataZoomInfoMap.get(a.uid);d&&(d.getRange=o)})}function disposeCoordSysRecordIfNeeded(s,a){for(var o=inner$1(s).coordSysRecordMap,c=o.keys(),d=0;d<c.length;d++){var tt=c[d],nt=o.get(tt),it=nt.dataZoomInfoMap;if(it){var st=a.uid,ut=it.get(st);ut&&(it.removeKey(st),it.keys().length||disposeCoordSysRecord(o,nt))}}}function disposeCoordSysRecord(s,a){if(a){s.removeKey(a.model.uid);var o=a.controller;o&&o.dispose()}}function createCoordSysRecord(s,a){var o={model:a,containsPoint:curry$1(containsPoint,a),dispatchAction:curry$1(dispatchAction,s),dataZoomInfoMap:null,controller:null},c=o.controller=new RoamController(s.getZr());return each$f(["pan","zoom","scrollMove"],function(d){c.on(d,function(tt){var nt=[];o.dataZoomInfoMap.each(function(it){if(tt.isAvailableBehavior(it.model.option)){var st=(it.getRange||{})[d],ut=st&&st(it.dzReferCoordSysInfo,o.model.mainType,o.controller,tt);!it.model.get("disabled",!0)&&ut&&nt.push({dataZoomId:it.model.id,start:ut[0],end:ut[1]})}}),nt.length&&o.dispatchAction(nt)})}),o}function dispatchAction(s,a){s.isDisposed()||s.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:a})}function containsPoint(s,a,o,c){return s.coordinateSystem.containPoint([o,c])}function mergeControllerParams(s){var a,o="type_",c={type_true:2,type_move:1,type_false:0,type_undefined:-1},d=!0;return s.each(function(tt){var nt=tt.model,it=nt.get("disabled",!0)?!1:nt.get("zoomLock",!0)?"move":!0;c[o+it]>c[o+a]&&(a=it),d=d&&nt.get("preventDefaultMouseMove",!0)}),{controlType:a,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!d}}}function installDataZoomRoamProcessor(s){s.registerProcessor(s.PRIORITY.PROCESSOR.FILTER,function(a,o){var c=inner$1(o),d=c.coordSysRecordMap||(c.coordSysRecordMap=createHashMap());d.each(function(tt){tt.dataZoomInfoMap=null}),a.eachComponent({mainType:"dataZoom",subType:"inside"},function(tt){var nt=collectReferCoordSysModelInfo(tt);each$f(nt.infoList,function(it){var st=it.model.uid,ut=d.get(st)||d.set(st,createCoordSysRecord(o,it.model)),ct=ut.dataZoomInfoMap||(ut.dataZoomInfoMap=createHashMap());ct.set(tt.uid,{dzReferCoordSysInfo:it,model:tt,getRange:null})})}),d.each(function(tt){var nt=tt.controller,it,st=tt.dataZoomInfoMap;if(st){var ut=st.keys()[0];ut!=null&&(it=st.get(ut))}if(!it){disposeCoordSysRecord(d,tt);return}var ct=mergeControllerParams(st);nt.enable(ct.controlType,ct.opt),nt.setPointerChecker(tt.containsPoint),createOrUpdate(tt,"dispatchAction",it.model.get("throttle",!0),"fixRate")})})}var InsideZoomView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="dataZoom.inside",o}return a.prototype.render=function(o,c,d){if(s.prototype.render.apply(this,arguments),o.noTarget()){this._clear();return}this.range=o.getPercentRange(),setViewInfoToCoordSysRecord(d,o,{pan:bind$2(getRangeHandlers.pan,this),zoom:bind$2(getRangeHandlers.zoom,this),scrollMove:bind$2(getRangeHandlers.scrollMove,this)})},a.prototype.dispose=function(){this._clear(),s.prototype.dispose.apply(this,arguments)},a.prototype._clear=function(){disposeCoordSysRecordIfNeeded(this.api,this.dataZoomModel),this.range=null},a.type="dataZoom.inside",a}(DataZoomView),getRangeHandlers={zoom:function(s,a,o,c){var d=this.range,tt=d.slice(),nt=s.axisModels[0];if(nt){var it=getDirectionInfo[a](null,[c.originX,c.originY],nt,o,s),st=(it.signal>0?it.pixelStart+it.pixelLength-it.pixel:it.pixel-it.pixelStart)/it.pixelLength*(tt[1]-tt[0])+tt[0],ut=Math.max(1/c.scale,0);tt[0]=(tt[0]-st)*ut+st,tt[1]=(tt[1]-st)*ut+st;var ct=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(sliderMove(0,tt,[0,100],0,ct.minSpan,ct.maxSpan),this.range=tt,d[0]!==tt[0]||d[1]!==tt[1])return tt}},pan:makeMover(function(s,a,o,c,d,tt){var nt=getDirectionInfo[c]([tt.oldX,tt.oldY],[tt.newX,tt.newY],a,d,o);return nt.signal*(s[1]-s[0])*nt.pixel/nt.pixelLength}),scrollMove:makeMover(function(s,a,o,c,d,tt){var nt=getDirectionInfo[c]([0,0],[tt.scrollDelta,tt.scrollDelta],a,d,o);return nt.signal*(s[1]-s[0])*tt.scrollDelta})};function makeMover(s){return function(a,o,c,d){var tt=this.range,nt=tt.slice(),it=a.axisModels[0];if(it){var st=s(nt,it,a,o,c,d);if(sliderMove(st,nt,[0,100],"all"),this.range=nt,tt[0]!==nt[0]||tt[1]!==nt[1])return nt}}}var getDirectionInfo={grid:function(s,a,o,c,d){var tt=o.axis,nt={},it=d.model.coordinateSystem.getRect();return s=s||[0,0],tt.dim==="x"?(nt.pixel=a[0]-s[0],nt.pixelLength=it.width,nt.pixelStart=it.x,nt.signal=tt.inverse?1:-1):(nt.pixel=a[1]-s[1],nt.pixelLength=it.height,nt.pixelStart=it.y,nt.signal=tt.inverse?-1:1),nt},polar:function(s,a,o,c,d){var tt=o.axis,nt={},it=d.model.coordinateSystem,st=it.getRadiusAxis().getExtent(),ut=it.getAngleAxis().getExtent();return s=s?it.pointToCoord(s):[0,0],a=it.pointToCoord(a),o.mainType==="radiusAxis"?(nt.pixel=a[0]-s[0],nt.pixelLength=st[1]-st[0],nt.pixelStart=st[0],nt.signal=tt.inverse?1:-1):(nt.pixel=a[1]-s[1],nt.pixelLength=ut[1]-ut[0],nt.pixelStart=ut[0],nt.signal=tt.inverse?-1:1),nt},singleAxis:function(s,a,o,c,d){var tt=o.axis,nt=d.model.coordinateSystem.getRect(),it={};return s=s||[0,0],tt.orient==="horizontal"?(it.pixel=a[0]-s[0],it.pixelLength=nt.width,it.pixelStart=nt.x,it.signal=tt.inverse?1:-1):(it.pixel=a[1]-s[1],it.pixelLength=nt.height,it.pixelStart=nt.y,it.signal=tt.inverse?-1:1),it}};function install$8(s){installCommon$1(s),s.registerComponentModel(InsideZoomModel),s.registerComponentView(InsideZoomView),installDataZoomRoamProcessor(s)}var SliderZoomModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.type="dataZoom.slider",a.layoutMode="box",a.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),a}(DataZoomModel),Rect=Rect$2,DEFAULT_LOCATION_EDGE_GAP=7,DEFAULT_FRAME_BORDER_WIDTH=1,DEFAULT_FILLER_SIZE=30,DEFAULT_MOVE_HANDLE_SIZE=7,HORIZONTAL="horizontal",VERTICAL="vertical",LABEL_GAP=5,SHOW_DATA_SHADOW_SERIES_TYPE=["line","bar","candlestick","scatter"],REALTIME_ANIMATION_CONFIG={easing:"cubicOut",duration:100,delay:0},SliderZoomView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._displayables={},o}return a.prototype.init=function(o,c){this.api=c,this._onBrush=bind$2(this._onBrush,this),this._onBrushEnd=bind$2(this._onBrushEnd,this)},a.prototype.render=function(o,c,d,tt){if(s.prototype.render.apply(this,arguments),createOrUpdate(this,"_dispatchZoomAction",o.get("throttle"),"fixRate"),this._orient=o.getOrient(),o.get("show")===!1){this.group.removeAll();return}if(o.noTarget()){this._clear(),this.group.removeAll();return}(!tt||tt.type!=="dataZoom"||tt.from!==this.uid)&&this._buildView(),this._updateView()},a.prototype.dispose=function(){this._clear(),s.prototype.dispose.apply(this,arguments)},a.prototype._clear=function(){clear$2(this,"_dispatchZoomAction");var o=this.api.getZr();o.off("mousemove",this._onBrush),o.off("mouseup",this._onBrushEnd)},a.prototype._buildView=function(){var o=this.group;o.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var c=this._displayables.sliderGroup=new Group$3;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),o.add(c),this._positionGroup()},a.prototype._resetLocation=function(){var o=this.dataZoomModel,c=this.api,d=o.get("brushSelect"),tt=d?DEFAULT_MOVE_HANDLE_SIZE:0,nt=this._findCoordRect(),it={width:c.getWidth(),height:c.getHeight()},st=this._orient===HORIZONTAL?{right:it.width-nt.x-nt.width,top:it.height-DEFAULT_FILLER_SIZE-DEFAULT_LOCATION_EDGE_GAP-tt,width:nt.width,height:DEFAULT_FILLER_SIZE}:{right:DEFAULT_LOCATION_EDGE_GAP,top:nt.y,width:DEFAULT_FILLER_SIZE,height:nt.height},ut=getLayoutParams(o.option);each$f(["right","top","width","height"],function(ot){ut[ot]==="ph"&&(ut[ot]=st[ot])});var ct=getLayoutRect(ut,it);this._location={x:ct.x,y:ct.y},this._size=[ct.width,ct.height],this._orient===VERTICAL&&this._size.reverse()},a.prototype._positionGroup=function(){var o=this.group,c=this._location,d=this._orient,tt=this.dataZoomModel.getFirstTargetAxisModel(),nt=tt&&tt.get("inverse"),it=this._displayables.sliderGroup,st=(this._dataShadowInfo||{}).otherAxisInverse;it.attr(d===HORIZONTAL&&!nt?{scaleY:st?1:-1,scaleX:1}:d===HORIZONTAL&&nt?{scaleY:st?1:-1,scaleX:-1}:d===VERTICAL&&!nt?{scaleY:st?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:st?-1:1,scaleX:-1,rotation:Math.PI/2});var ut=o.getBoundingRect([it]);o.x=c.x-ut.x,o.y=c.y-ut.y,o.markRedraw()},a.prototype._getViewExtent=function(){return[0,this._size[0]]},a.prototype._renderBackground=function(){var o=this.dataZoomModel,c=this._size,d=this._displayables.sliderGroup,tt=o.get("brushSelect");d.add(new Rect({silent:!0,shape:{x:0,y:0,width:c[0],height:c[1]},style:{fill:o.get("backgroundColor")},z2:-40}));var nt=new Rect({shape:{x:0,y:0,width:c[0],height:c[1]},style:{fill:"transparent"},z2:0,onclick:bind$2(this._onClickPanel,this)}),it=this.api.getZr();tt?(nt.on("mousedown",this._onBrushStart,this),nt.cursor="crosshair",it.on("mousemove",this._onBrush),it.on("mouseup",this._onBrushEnd)):(it.off("mousemove",this._onBrush),it.off("mouseup",this._onBrushEnd)),d.add(nt)},a.prototype._renderDataShadow=function(){var o=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!o)return;var c=this._size,d=this._shadowSize||[],tt=o.series,nt=tt.getRawData(),it=tt.getShadowDim&&tt.getShadowDim(),st=it&&nt.getDimensionInfo(it)?tt.getShadowDim():o.otherDim;if(st==null)return;var ut=this._shadowPolygonPts,ct=this._shadowPolylinePts;if(nt!==this._shadowData||st!==this._shadowDim||c[0]!==d[0]||c[1]!==d[1]){var ot=nt.getDataExtent(st),at=(ot[1]-ot[0])*.3;ot=[ot[0]-at,ot[1]+at];var ht=[0,c[1]],ft=[0,c[0]],mt=[[c[0],0],[0,0]],yt=[],bt=ft[1]/(nt.count()-1),wt=0,Tt=Math.round(nt.count()/c[0]),Ct;nt.each([st],function(kt,Vt){if(Tt>0&&Vt%Tt){wt+=bt;return}var Ht=kt==null||isNaN(kt)||kt==="",Qt=Ht?0:linearMap$2(kt,ot,ht,!0);Ht&&!Ct&&Vt?(mt.push([mt[mt.length-1][0],0]),yt.push([yt[yt.length-1][0],0])):!Ht&&Ct&&(mt.push([wt,0]),yt.push([wt,0])),mt.push([wt,Qt]),yt.push([wt,Qt]),wt+=bt,Ct=Ht}),ut=this._shadowPolygonPts=mt,ct=this._shadowPolylinePts=yt}this._shadowData=nt,this._shadowDim=st,this._shadowSize=[c[0],c[1]];var Dt=this.dataZoomModel;function Ot(kt){var Vt=Dt.getModel(kt?"selectedDataBackground":"dataBackground"),Ht=new Group$3,Qt=new Polygon({shape:{points:ut},segmentIgnoreThreshold:1,style:Vt.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),Xt=new Polyline$1({shape:{points:ct},segmentIgnoreThreshold:1,style:Vt.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return Ht.add(Qt),Ht.add(Xt),Ht}for(var $t=0;$t<3;$t++){var Ft=Ot($t===1);this._displayables.sliderGroup.add(Ft),this._displayables.dataShadowSegs.push(Ft)}},a.prototype._prepareDataShadowInfo=function(){var o=this.dataZoomModel,c=o.get("showDataShadow");if(c!==!1){var d,tt=this.ecModel;return o.eachTargetAxis(function(nt,it){var st=o.getAxisProxy(nt,it).getTargetSeriesModels();each$f(st,function(ut){if(!d&&!(c!==!0&&indexOf(SHOW_DATA_SHADOW_SERIES_TYPE,ut.get("type"))<0)){var ct=tt.getComponent(getAxisMainType(nt),it).axis,ot=getOtherDim(nt),at,ht=ut.coordinateSystem;ot!=null&&ht.getOtherAxis&&(at=ht.getOtherAxis(ct).inverse),ot=ut.getData().mapDimension(ot),d={thisAxis:ct,series:ut,thisDim:nt,otherDim:ot,otherAxisInverse:at}}},this)},this),d}},a.prototype._renderHandle=function(){var o=this.group,c=this._displayables,d=c.handles=[null,null],tt=c.handleLabels=[null,null],nt=this._displayables.sliderGroup,it=this._size,st=this.dataZoomModel,ut=this.api,ct=st.get("borderRadius")||0,ot=st.get("brushSelect"),at=c.filler=new Rect({silent:ot,style:{fill:st.get("fillerColor")},textConfig:{position:"inside"}});nt.add(at),nt.add(new Rect({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:it[0],height:it[1],r:ct},style:{stroke:st.get("dataBackgroundColor")||st.get("borderColor"),lineWidth:DEFAULT_FRAME_BORDER_WIDTH,fill:"rgba(0,0,0,0)"}})),each$f([0,1],function(Tt){var Ct=st.get("handleIcon");!symbolBuildProxies[Ct]&&Ct.indexOf("path://")<0&&Ct.indexOf("image://")<0&&(Ct="path://"+Ct);var Dt=createSymbol$1(Ct,-1,0,2,2,null,!0);Dt.attr({cursor:getCursor$1(this._orient),draggable:!0,drift:bind$2(this._onDragMove,this,Tt),ondragend:bind$2(this._onDragEnd,this),onmouseover:bind$2(this._showDataInfo,this,!0),onmouseout:bind$2(this._showDataInfo,this,!1),z2:5});var Ot=Dt.getBoundingRect(),$t=st.get("handleSize");this._handleHeight=parsePercent($t,this._size[1]),this._handleWidth=Ot.width/Ot.height*this._handleHeight,Dt.setStyle(st.getModel("handleStyle").getItemStyle()),Dt.style.strokeNoScale=!0,Dt.rectHover=!0,Dt.ensureState("emphasis").style=st.getModel(["emphasis","handleStyle"]).getItemStyle(),enableHoverEmphasis(Dt);var Ft=st.get("handleColor");Ft!=null&&(Dt.style.fill=Ft),nt.add(d[Tt]=Dt);var kt=st.getModel("textStyle"),Vt=st.get("handleLabel")||{},Ht=Vt.show||!1;o.add(tt[Tt]=new ZRText({silent:!0,invisible:!Ht,style:createTextStyle$1(kt,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:kt.getTextColor(),font:kt.getFont()}),z2:10}))},this);var ht=at;if(ot){var ft=parsePercent(st.get("moveHandleSize"),it[1]),mt=c.moveHandle=new Rect$2({style:st.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:it[1]-.5,height:ft}}),yt=ft*.8,bt=c.moveHandleIcon=createSymbol$1(st.get("moveHandleIcon"),-yt/2,-yt/2,yt,yt,"#fff",!0);bt.silent=!0,bt.y=it[1]+ft/2-.5,mt.ensureState("emphasis").style=st.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var wt=Math.min(it[1]/2,Math.max(ft,10));ht=c.moveZone=new Rect$2({invisible:!0,shape:{y:it[1]-wt,height:ft+wt}}),ht.on("mouseover",function(){ut.enterEmphasis(mt)}).on("mouseout",function(){ut.leaveEmphasis(mt)}),nt.add(mt),nt.add(bt),nt.add(ht)}ht.attr({draggable:!0,cursor:getCursor$1(this._orient),drift:bind$2(this._onDragMove,this,"all"),ondragstart:bind$2(this._showDataInfo,this,!0),ondragend:bind$2(this._onDragEnd,this),onmouseover:bind$2(this._showDataInfo,this,!0),onmouseout:bind$2(this._showDataInfo,this,!1)})},a.prototype._resetInterval=function(){var o=this._range=this.dataZoomModel.getPercentRange(),c=this._getViewExtent();this._handleEnds=[linearMap$2(o[0],[0,100],c,!0),linearMap$2(o[1],[0,100],c,!0)]},a.prototype._updateInterval=function(o,c){var d=this.dataZoomModel,tt=this._handleEnds,nt=this._getViewExtent(),it=d.findRepresentativeAxisProxy().getMinMaxSpan(),st=[0,100];sliderMove(c,tt,nt,d.get("zoomLock")?"all":o,it.minSpan!=null?linearMap$2(it.minSpan,st,nt,!0):null,it.maxSpan!=null?linearMap$2(it.maxSpan,st,nt,!0):null);var ut=this._range,ct=this._range=asc$2([linearMap$2(tt[0],nt,st,!0),linearMap$2(tt[1],nt,st,!0)]);return!ut||ut[0]!==ct[0]||ut[1]!==ct[1]},a.prototype._updateView=function(o){var c=this._displayables,d=this._handleEnds,tt=asc$2(d.slice()),nt=this._size;each$f([0,1],function(ht){var ft=c.handles[ht],mt=this._handleHeight;ft.attr({scaleX:mt/2,scaleY:mt/2,x:d[ht]+(ht?-1:1),y:nt[1]/2-mt/2})},this),c.filler.setShape({x:tt[0],y:0,width:tt[1]-tt[0],height:nt[1]});var it={x:tt[0],width:tt[1]-tt[0]};c.moveHandle&&(c.moveHandle.setShape(it),c.moveZone.setShape(it),c.moveZone.getBoundingRect(),c.moveHandleIcon&&c.moveHandleIcon.attr("x",it.x+it.width/2));for(var st=c.dataShadowSegs,ut=[0,tt[0],tt[1],nt[0]],ct=0;ct<st.length;ct++){var ot=st[ct],at=ot.getClipPath();at||(at=new Rect$2,ot.setClipPath(at)),at.setShape({x:ut[ct],y:0,width:ut[ct+1]-ut[ct],height:nt[1]})}this._updateDataInfo(o)},a.prototype._updateDataInfo=function(o){var c=this.dataZoomModel,d=this._displayables,tt=d.handleLabels,nt=this._orient,it=["",""];if(c.get("showDetail")){var st=c.findRepresentativeAxisProxy();if(st){var ut=st.getAxisModel().axis,ct=this._range,ot=o?st.calculateDataWindow({start:ct[0],end:ct[1]}).valueWindow:st.getDataValueWindow();it=[this._formatLabel(ot[0],ut),this._formatLabel(ot[1],ut)]}}var at=asc$2(this._handleEnds.slice());ht.call(this,0),ht.call(this,1);function ht(ft){var mt=getTransform$1(d.handles[ft].parent,this.group),yt=transformDirection(ft===0?"right":"left",mt),bt=this._handleWidth/2+LABEL_GAP,wt=applyTransform([at[ft]+(ft===0?-bt:bt),this._size[1]/2],mt);tt[ft].setStyle({x:wt[0],y:wt[1],verticalAlign:nt===HORIZONTAL?"middle":yt,align:nt===HORIZONTAL?yt:"center",text:it[ft]})}},a.prototype._formatLabel=function(o,c){var d=this.dataZoomModel,tt=d.get("labelFormatter"),nt=d.get("labelPrecision");(nt==null||nt==="auto")&&(nt=c.getPixelPrecision());var it=o==null||isNaN(o)?"":c.type==="category"||c.type==="time"?c.scale.getLabel({value:Math.round(o)}):o.toFixed(Math.min(nt,20));return isFunction$1(tt)?tt(o,it):isString$1(tt)?tt.replace("{value}",it):it},a.prototype._showDataInfo=function(o){var c=this.dataZoomModel.get("handleLabel")||{},d=c.show||!1,tt=this.dataZoomModel.getModel(["emphasis","handleLabel"]),nt=tt.get("show")||!1,it=o||this._dragging?nt:d,st=this._displayables,ut=st.handleLabels;ut[0].attr("invisible",!it),ut[1].attr("invisible",!it),st.moveHandle&&this.api[it?"enterEmphasis":"leaveEmphasis"](st.moveHandle,1)},a.prototype._onDragMove=function(o,c,d,tt){this._dragging=!0,stop(tt.event);var nt=this._displayables.sliderGroup.getLocalTransform(),it=applyTransform([c,d],nt,!0),st=this._updateInterval(o,it[0]),ut=this.dataZoomModel.get("realtime");this._updateView(!ut),st&&ut&&this._dispatchZoomAction(!0)},a.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var o=this.dataZoomModel.get("realtime");!o&&this._dispatchZoomAction(!1)},a.prototype._onClickPanel=function(o){var c=this._size,d=this._displayables.sliderGroup.transformCoordToLocal(o.offsetX,o.offsetY);if(!(d[0]<0||d[0]>c[0]||d[1]<0||d[1]>c[1])){var tt=this._handleEnds,nt=(tt[0]+tt[1])/2,it=this._updateInterval("all",d[0]-nt);this._updateView(),it&&this._dispatchZoomAction(!1)}},a.prototype._onBrushStart=function(o){var c=o.offsetX,d=o.offsetY;this._brushStart=new Point(c,d),this._brushing=!0,this._brushStartTime=+new Date},a.prototype._onBrushEnd=function(o){if(this._brushing){var c=this._displayables.brushRect;if(this._brushing=!1,!!c){c.attr("ignore",!0);var d=c.shape,tt=+new Date;if(!(tt-this._brushStartTime<200&&Math.abs(d.width)<5)){var nt=this._getViewExtent(),it=[0,100];this._range=asc$2([linearMap$2(d.x,nt,it,!0),linearMap$2(d.x+d.width,nt,it,!0)]),this._handleEnds=[d.x,d.x+d.width],this._updateView(),this._dispatchZoomAction(!1)}}}},a.prototype._onBrush=function(o){this._brushing&&(stop(o.event),this._updateBrushRect(o.offsetX,o.offsetY))},a.prototype._updateBrushRect=function(o,c){var d=this._displayables,tt=this.dataZoomModel,nt=d.brushRect;nt||(nt=d.brushRect=new Rect({silent:!0,style:tt.getModel("brushStyle").getItemStyle()}),d.sliderGroup.add(nt)),nt.attr("ignore",!1);var it=this._brushStart,st=this._displayables.sliderGroup,ut=st.transformCoordToLocal(o,c),ct=st.transformCoordToLocal(it.x,it.y),ot=this._size;ut[0]=Math.max(Math.min(ot[0],ut[0]),0),nt.setShape({x:ct[0],y:0,width:ut[0]-ct[0],height:ot[1]})},a.prototype._dispatchZoomAction=function(o){var c=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:o?REALTIME_ANIMATION_CONFIG:null,start:c[0],end:c[1]})},a.prototype._findCoordRect=function(){var o,c=collectReferCoordSysModelInfo(this.dataZoomModel).infoList;if(!o&&c.length){var d=c[0].model.coordinateSystem;o=d.getRect&&d.getRect()}if(!o){var tt=this.api.getWidth(),nt=this.api.getHeight();o={x:tt*.2,y:nt*.2,width:tt*.6,height:nt*.6}}return o},a.type="dataZoom.slider",a}(DataZoomView);function getOtherDim(s){var a={x:"y",y:"x",radius:"angle",angle:"radius"};return a[s]}function getCursor$1(s){return s==="vertical"?"ns-resize":"ew-resize"}function install$7(s){s.registerComponentModel(SliderZoomModel),s.registerComponentView(SliderZoomView),installCommon$1(s)}function install$6(s){use(install$8),use(install$7)}var visualDefault={get:function(s,a,o){var c=clone$4((defaultOption[s]||{})[a]);return o&&isArray$1(c)?c[c.length-1]:c}},defaultOption={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},mapVisual=VisualMapping.mapVisual,eachVisual=VisualMapping.eachVisual,isArray=isArray$1,each$2=each$f,asc=asc$2,linearMap$1=linearMap$2,VisualMapModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.stateList=["inRange","outOfRange"],o.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],o.layoutMode={type:"box",ignoreSize:!0},o.dataBound=[-1/0,1/0],o.targetVisuals={},o.controllerVisuals={},o}return a.prototype.init=function(o,c,d){this.mergeDefaultAndTheme(o,d)},a.prototype.optionUpdated=function(o,c){var d=this.option;!c&&replaceVisualOption(d,o,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},a.prototype.resetVisual=function(o){var c=this.stateList;o=bind$2(o,this),this.controllerVisuals=createVisualMappings(this.option.controller,c,o),this.targetVisuals=createVisualMappings(this.option.target,c,o)},a.prototype.getItemSymbol=function(){return null},a.prototype.getTargetSeriesIndices=function(){var o=this.option.seriesIndex,c=[];return o==null||o==="all"?this.ecModel.eachSeries(function(d,tt){c.push(tt)}):c=normalizeToArray(o),c},a.prototype.eachTargetSeries=function(o,c){each$f(this.getTargetSeriesIndices(),function(d){var tt=this.ecModel.getSeriesByIndex(d);tt&&o.call(c,tt)},this)},a.prototype.isTargetSeries=function(o){var c=!1;return this.eachTargetSeries(function(d){d===o&&(c=!0)}),c},a.prototype.formatValueText=function(o,c,d){var tt=this.option,nt=tt.precision,it=this.dataBound,st=tt.formatter,ut;d=d||["<",">"],isArray$1(o)&&(o=o.slice(),ut=!0);var ct=c?o:ut?[ot(o[0]),ot(o[1])]:ot(o);if(isString$1(st))return st.replace("{value}",ut?ct[0]:ct).replace("{value2}",ut?ct[1]:ct);if(isFunction$1(st))return ut?st(o[0],o[1]):st(o);if(ut)return o[0]===it[0]?d[0]+" "+ct[1]:o[1]===it[1]?d[1]+" "+ct[0]:ct[0]+" - "+ct[1];return ct;function ot(at){return at===it[0]?"min":at===it[1]?"max":(+at).toFixed(Math.min(nt,20))}},a.prototype.resetExtent=function(){var o=this.option,c=asc([o.min,o.max]);this._dataExtent=c},a.prototype.getDataDimensionIndex=function(o){var c=this.option.dimension;if(c!=null)return o.getDimensionIndex(c);for(var d=o.dimensions,tt=d.length-1;tt>=0;tt--){var nt=d[tt],it=o.getDimensionInfo(nt);if(!it.isCalculationCoord)return it.storeDimIndex}},a.prototype.getExtent=function(){return this._dataExtent.slice()},a.prototype.completeVisualOption=function(){var o=this.ecModel,c=this.option,d={inRange:c.inRange,outOfRange:c.outOfRange},tt=c.target||(c.target={}),nt=c.controller||(c.controller={});merge(tt,d),merge(nt,d);var it=this.isCategory();st.call(this,tt),st.call(this,nt),ut.call(this,tt,"inRange","outOfRange"),ct.call(this,nt);function st(ot){isArray(c.color)&&!ot.inRange&&(ot.inRange={color:c.color.slice().reverse()}),ot.inRange=ot.inRange||{color:o.get("gradientColor")}}function ut(ot,at,ht){var ft=ot[at],mt=ot[ht];ft&&!mt&&(mt=ot[ht]={},each$2(ft,function(yt,bt){if(VisualMapping.isValidType(bt)){var wt=visualDefault.get(bt,"inactive",it);wt!=null&&(mt[bt]=wt,bt==="color"&&!mt.hasOwnProperty("opacity")&&!mt.hasOwnProperty("colorAlpha")&&(mt.opacity=[0,0]))}}))}function ct(ot){var at=(ot.inRange||{}).symbol||(ot.outOfRange||{}).symbol,ht=(ot.inRange||{}).symbolSize||(ot.outOfRange||{}).symbolSize,ft=this.get("inactiveColor"),mt=this.getItemSymbol(),yt=mt||"roundRect";each$2(this.stateList,function(bt){var wt=this.itemSize,Tt=ot[bt];Tt||(Tt=ot[bt]={color:it?ft:[ft]}),Tt.symbol==null&&(Tt.symbol=at&&clone$4(at)||(it?yt:[yt])),Tt.symbolSize==null&&(Tt.symbolSize=ht&&clone$4(ht)||(it?wt[0]:[wt[0],wt[0]])),Tt.symbol=mapVisual(Tt.symbol,function(Ot){return Ot==="none"?yt:Ot});var Ct=Tt.symbolSize;if(Ct!=null){var Dt=-1/0;eachVisual(Ct,function(Ot){Ot>Dt&&(Dt=Ot)}),Tt.symbolSize=mapVisual(Ct,function(Ot){return linearMap$1(Ot,[0,Dt],[0,wt[0]],!0)})}},this)}},a.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},a.prototype.isCategory=function(){return!!this.option.categories},a.prototype.setSelected=function(o){},a.prototype.getSelected=function(){return null},a.prototype.getValueState=function(o){return null},a.prototype.getVisualMeta=function(o){return null},a.type="visualMap",a.dependencies=["series"],a.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},a}(ComponentModel),DEFAULT_BAR_BOUND=[20,140],ContinuousModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.optionUpdated=function(o,c){s.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(d){d.mappingMethod="linear",d.dataExtent=this.getExtent()}),this._resetRange()},a.prototype.resetItemSize=function(){s.prototype.resetItemSize.apply(this,arguments);var o=this.itemSize;(o[0]==null||isNaN(o[0]))&&(o[0]=DEFAULT_BAR_BOUND[0]),(o[1]==null||isNaN(o[1]))&&(o[1]=DEFAULT_BAR_BOUND[1])},a.prototype._resetRange=function(){var o=this.getExtent(),c=this.option.range;!c||c.auto?(o.auto=1,this.option.range=o):isArray$1(c)&&(c[0]>c[1]&&c.reverse(),c[0]=Math.max(c[0],o[0]),c[1]=Math.min(c[1],o[1]))},a.prototype.completeVisualOption=function(){s.prototype.completeVisualOption.apply(this,arguments),each$f(this.stateList,function(o){var c=this.option.controller[o].symbolSize;c&&c[0]!==c[1]&&(c[0]=c[1]/3)},this)},a.prototype.setSelected=function(o){this.option.range=o.slice(),this._resetRange()},a.prototype.getSelected=function(){var o=this.getExtent(),c=asc$2((this.get("range")||[]).slice());return c[0]>o[1]&&(c[0]=o[1]),c[1]>o[1]&&(c[1]=o[1]),c[0]<o[0]&&(c[0]=o[0]),c[1]<o[0]&&(c[1]=o[0]),c},a.prototype.getValueState=function(o){var c=this.option.range,d=this.getExtent();return(c[0]<=d[0]||c[0]<=o)&&(c[1]>=d[1]||o<=c[1])?"inRange":"outOfRange"},a.prototype.findTargetDataIndices=function(o){var c=[];return this.eachTargetSeries(function(d){var tt=[],nt=d.getData();nt.each(this.getDataDimensionIndex(nt),function(it,st){o[0]<=it&&it<=o[1]&&tt.push(st)},this),c.push({seriesId:d.id,dataIndex:tt})},this),c},a.prototype.getVisualMeta=function(o){var c=getColorStopValues(this,"outOfRange",this.getExtent()),d=getColorStopValues(this,"inRange",this.option.range.slice()),tt=[];function nt(ht,ft){tt.push({value:ht,color:o(ht,ft)})}for(var it=0,st=0,ut=d.length,ct=c.length;st<ct&&(!d.length||c[st]<=d[0]);st++)c[st]<d[it]&&nt(c[st],"outOfRange");for(var ot=1;it<ut;it++,ot=0)ot&&tt.length&&nt(d[it],"outOfRange"),nt(d[it],"inRange");for(var ot=1;st<ct;st++)(!d.length||d[d.length-1]<c[st])&&(ot&&(tt.length&&nt(tt[tt.length-1].value,"outOfRange"),ot=0),nt(c[st],"outOfRange"));var at=tt.length;return{stops:tt,outerColors:[at?tt[0].color:"transparent",at?tt[at-1].color:"transparent"]}},a.type="visualMap.continuous",a.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),a}(VisualMapModel);function getColorStopValues(s,a,o){if(o[0]===o[1])return o.slice();for(var c=200,d=(o[1]-o[0])/c,tt=o[0],nt=[],it=0;it<=c&&tt<o[1];it++)nt.push(tt),tt+=d;return nt.push(o[1]),nt}var VisualMapView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o.autoPositionValues={left:1,right:1,top:1,bottom:1},o}return a.prototype.init=function(o,c){this.ecModel=o,this.api=c},a.prototype.render=function(o,c,d,tt){if(this.visualMapModel=o,o.get("show")===!1){this.group.removeAll();return}this.doRender(o,c,d,tt)},a.prototype.renderBackground=function(o){var c=this.visualMapModel,d=normalizeCssArray(c.get("padding")||0),tt=o.getBoundingRect();o.add(new Rect$2({z2:-1,silent:!0,shape:{x:tt.x-d[3],y:tt.y-d[0],width:tt.width+d[3]+d[1],height:tt.height+d[0]+d[2]},style:{fill:c.get("backgroundColor"),stroke:c.get("borderColor"),lineWidth:c.get("borderWidth")}}))},a.prototype.getControllerVisual=function(o,c,d){d=d||{};var tt=d.forceState,nt=this.visualMapModel,it={};if(c==="color"){var st=nt.get("contentColor");it.color=st}function ut(ht){return it[ht]}function ct(ht,ft){it[ht]=ft}var ot=nt.controllerVisuals[tt||nt.getValueState(o)],at=VisualMapping.prepareVisualTypes(ot);return each$f(at,function(ht){var ft=ot[ht];d.convertOpacityToAlpha&&ht==="opacity"&&(ht="colorAlpha",ft=ot.__alphaForOpacity),VisualMapping.dependsOn(ht,c)&&ft&&ft.applyVisual(o,ut,ct)}),it[c]},a.prototype.positionGroup=function(o){var c=this.visualMapModel,d=this.api;positionElement(o,c.getBoxLayoutParams(),{width:d.getWidth(),height:d.getHeight()})},a.prototype.doRender=function(o,c,d,tt){},a.type="visualMap",a}(ComponentView),paramsSet=[["left","right","width"],["top","bottom","height"]];function getItemAlign(s,a,o){var c=s.option,d=c.align;if(d!=null&&d!=="auto")return d;for(var tt={width:a.getWidth(),height:a.getHeight()},nt=c.orient==="horizontal"?1:0,it=paramsSet[nt],st=[0,null,10],ut={},ct=0;ct<3;ct++)ut[paramsSet[1-nt][ct]]=st[ct],ut[it[ct]]=ct===2?o[0]:c[it[ct]];var ot=[["x","width",3],["y","height",0]][nt],at=getLayoutRect(ut,tt,c.padding);return it[(at.margin[ot[2]]||0)+at[ot[0]]+at[ot[1]]*.5<tt[ot[1]]*.5?0:1]}function makeHighDownBatch(s,a){return each$f(s||[],function(o){o.dataIndex!=null&&(o.dataIndexInside=o.dataIndex,o.dataIndex=null),o.highlightKey="visualMap"+(a?a.componentIndex:"")}),s}var linearMap=linearMap$2,each$1=each$f,mathMin=Math.min,mathMax=Math.max,HOVER_LINK_SIZE=12,HOVER_LINK_OUT=6,ContinuousView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._shapes={},o._dataInterval=[],o._handleEnds=[],o._hoverLinkDataIndices=[],o}return a.prototype.init=function(o,c){s.prototype.init.call(this,o,c),this._hoverLinkFromSeriesMouseOver=bind$2(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=bind$2(this._hideIndicator,this)},a.prototype.doRender=function(o,c,d,tt){(!tt||tt.type!=="selectDataRange"||tt.from!==this.uid)&&this._buildView()},a.prototype._buildView=function(){this.group.removeAll();var o=this.visualMapModel,c=this.group;this._orient=o.get("orient"),this._useHandle=o.get("calculable"),this._resetInterval(),this._renderBar(c);var d=o.get("text");this._renderEndsText(c,d,0),this._renderEndsText(c,d,1),this._updateView(!0),this.renderBackground(c),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(c)},a.prototype._renderEndsText=function(o,c,d){if(c){var tt=c[1-d];tt=tt!=null?tt+"":"";var nt=this.visualMapModel,it=nt.get("textGap"),st=nt.itemSize,ut=this._shapes.mainGroup,ct=this._applyTransform([st[0]/2,d===0?-it:st[1]+it],ut),ot=this._applyTransform(d===0?"bottom":"top",ut),at=this._orient,ht=this.visualMapModel.textStyleModel;this.group.add(new ZRText({style:createTextStyle$1(ht,{x:ct[0],y:ct[1],verticalAlign:at==="horizontal"?"middle":ot,align:at==="horizontal"?ot:"center",text:tt})}))}},a.prototype._renderBar=function(o){var c=this.visualMapModel,d=this._shapes,tt=c.itemSize,nt=this._orient,it=this._useHandle,st=getItemAlign(c,this.api,tt),ut=d.mainGroup=this._createBarGroup(st),ct=new Group$3;ut.add(ct),ct.add(d.outOfRange=createPolygon()),ct.add(d.inRange=createPolygon(null,it?getCursor(this._orient):null,bind$2(this._dragHandle,this,"all",!1),bind$2(this._dragHandle,this,"all",!0))),ct.setClipPath(new Rect$2({shape:{x:0,y:0,width:tt[0],height:tt[1],r:3}}));var ot=c.textStyleModel.getTextRect("国"),at=mathMax(ot.width,ot.height);it&&(d.handleThumbs=[],d.handleLabels=[],d.handleLabelPoints=[],this._createHandle(c,ut,0,tt,at,nt),this._createHandle(c,ut,1,tt,at,nt)),this._createIndicator(c,ut,tt,at,nt),o.add(ut)},a.prototype._createHandle=function(o,c,d,tt,nt,it){var st=bind$2(this._dragHandle,this,d,!1),ut=bind$2(this._dragHandle,this,d,!0),ct=parsePercent$1(o.get("handleSize"),tt[0]),ot=createSymbol$1(o.get("handleIcon"),-ct/2,-ct/2,ct,ct,null,!0),at=getCursor(this._orient);ot.attr({cursor:at,draggable:!0,drift:st,ondragend:ut,onmousemove:function(bt){stop(bt.event)}}),ot.x=tt[0]/2,ot.useStyle(o.getModel("handleStyle").getItemStyle()),ot.setStyle({strokeNoScale:!0,strokeFirst:!0}),ot.style.lineWidth*=2,ot.ensureState("emphasis").style=o.getModel(["emphasis","handleStyle"]).getItemStyle(),setAsHighDownDispatcher(ot,!0),c.add(ot);var ht=this.visualMapModel.textStyleModel,ft=new ZRText({cursor:at,draggable:!0,drift:st,onmousemove:function(bt){stop(bt.event)},ondragend:ut,style:createTextStyle$1(ht,{x:0,y:0,text:""})});ft.ensureState("blur").style={opacity:.1},ft.stateTransition={duration:200},this.group.add(ft);var mt=[ct,0],yt=this._shapes;yt.handleThumbs[d]=ot,yt.handleLabelPoints[d]=mt,yt.handleLabels[d]=ft},a.prototype._createIndicator=function(o,c,d,tt,nt){var it=parsePercent$1(o.get("indicatorSize"),d[0]),st=createSymbol$1(o.get("indicatorIcon"),-it/2,-it/2,it,it,null,!0);st.attr({cursor:"move",invisible:!0,silent:!0,x:d[0]/2});var ut=o.getModel("indicatorStyle").getItemStyle();if(st instanceof ZRImage){var ct=st.style;st.useStyle(extend({image:ct.image,x:ct.x,y:ct.y,width:ct.width,height:ct.height},ut))}else st.useStyle(ut);c.add(st);var ot=this.visualMapModel.textStyleModel,at=new ZRText({silent:!0,invisible:!0,style:createTextStyle$1(ot,{x:0,y:0,text:""})});this.group.add(at);var ht=[(nt==="horizontal"?tt/2:HOVER_LINK_OUT)+d[0]/2,0],ft=this._shapes;ft.indicator=st,ft.indicatorLabel=at,ft.indicatorLabelPoint=ht,this._firstShowIndicator=!0},a.prototype._dragHandle=function(o,c,d,tt){if(this._useHandle){if(this._dragging=!c,!c){var nt=this._applyTransform([d,tt],this._shapes.mainGroup,!0);this._updateInterval(o,nt[1]),this._hideIndicator(),this._updateView()}c===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),c?!this._hovering&&this._clearHoverLinkToSeries():useHoverLinkOnHandle(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[o],!1)}},a.prototype._resetInterval=function(){var o=this.visualMapModel,c=this._dataInterval=o.getSelected(),d=o.getExtent(),tt=[0,o.itemSize[1]];this._handleEnds=[linearMap(c[0],d,tt,!0),linearMap(c[1],d,tt,!0)]},a.prototype._updateInterval=function(o,c){c=c||0;var d=this.visualMapModel,tt=this._handleEnds,nt=[0,d.itemSize[1]];sliderMove(c,tt,nt,o,0);var it=d.getExtent();this._dataInterval=[linearMap(tt[0],nt,it,!0),linearMap(tt[1],nt,it,!0)]},a.prototype._updateView=function(o){var c=this.visualMapModel,d=c.getExtent(),tt=this._shapes,nt=[0,c.itemSize[1]],it=o?nt:this._handleEnds,st=this._createBarVisual(this._dataInterval,d,it,"inRange"),ut=this._createBarVisual(d,d,nt,"outOfRange");tt.inRange.setStyle({fill:st.barColor}).setShape("points",st.barPoints),tt.outOfRange.setStyle({fill:ut.barColor}).setShape("points",ut.barPoints),this._updateHandle(it,st)},a.prototype._createBarVisual=function(o,c,d,tt){var nt={forceState:tt,convertOpacityToAlpha:!0},it=this._makeColorGradient(o,nt),st=[this.getControllerVisual(o[0],"symbolSize",nt),this.getControllerVisual(o[1],"symbolSize",nt)],ut=this._createBarPoints(d,st);return{barColor:new LinearGradient(0,0,0,1,it),barPoints:ut,handlesColor:[it[0].color,it[it.length-1].color]}},a.prototype._makeColorGradient=function(o,c){var d=100,tt=[],nt=(o[1]-o[0])/d;tt.push({color:this.getControllerVisual(o[0],"color",c),offset:0});for(var it=1;it<d;it++){var st=o[0]+nt*it;if(st>o[1])break;tt.push({color:this.getControllerVisual(st,"color",c),offset:it/d})}return tt.push({color:this.getControllerVisual(o[1],"color",c),offset:1}),tt},a.prototype._createBarPoints=function(o,c){var d=this.visualMapModel.itemSize;return[[d[0]-c[0],o[0]],[d[0],o[0]],[d[0],o[1]],[d[0]-c[1],o[1]]]},a.prototype._createBarGroup=function(o){var c=this._orient,d=this.visualMapModel.get("inverse");return new Group$3(c==="horizontal"&&!d?{scaleX:o==="bottom"?1:-1,rotation:Math.PI/2}:c==="horizontal"&&d?{scaleX:o==="bottom"?-1:1,rotation:-Math.PI/2}:c==="vertical"&&!d?{scaleX:o==="left"?1:-1,scaleY:-1}:{scaleX:o==="left"?1:-1})},a.prototype._updateHandle=function(o,c){if(this._useHandle){var d=this._shapes,tt=this.visualMapModel,nt=d.handleThumbs,it=d.handleLabels,st=tt.itemSize,ut=tt.getExtent(),ct=this._applyTransform("left",d.mainGroup);each$1([0,1],function(ot){var at=nt[ot];at.setStyle("fill",c.handlesColor[ot]),at.y=o[ot];var ht=linearMap(o[ot],[0,st[1]],ut,!0),ft=this.getControllerVisual(ht,"symbolSize");at.scaleX=at.scaleY=ft/st[0],at.x=st[0]-ft/2;var mt=applyTransform(d.handleLabelPoints[ot],getTransform$1(at,this.group));if(this._orient==="horizontal"){var yt=ct==="left"||ct==="top"?(st[0]-ft)/2:(st[0]-ft)/-2;mt[1]+=yt}it[ot].setStyle({x:mt[0],y:mt[1],text:tt.formatValueText(this._dataInterval[ot]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",d.mainGroup):"center"})},this)}},a.prototype._showIndicator=function(o,c,d,tt){var nt=this.visualMapModel,it=nt.getExtent(),st=nt.itemSize,ut=[0,st[1]],ct=this._shapes,ot=ct.indicator;if(ot){ot.attr("invisible",!1);var at={convertOpacityToAlpha:!0},ht=this.getControllerVisual(o,"color",at),ft=this.getControllerVisual(o,"symbolSize"),mt=linearMap(o,it,ut,!0),yt=st[0]-ft/2,bt={x:ot.x,y:ot.y};ot.y=mt,ot.x=yt;var wt=applyTransform(ct.indicatorLabelPoint,getTransform$1(ot,this.group)),Tt=ct.indicatorLabel;Tt.attr("invisible",!1);var Ct=this._applyTransform("left",ct.mainGroup),Dt=this._orient,Ot=Dt==="horizontal";Tt.setStyle({text:(d||"")+nt.formatValueText(c),verticalAlign:Ot?Ct:"middle",align:Ot?"center":Ct});var $t={x:yt,y:mt,style:{fill:ht}},Ft={style:{x:wt[0],y:wt[1]}};if(nt.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var kt={duration:100,easing:"cubicInOut",additive:!0};ot.x=bt.x,ot.y=bt.y,ot.animateTo($t,kt),Tt.animateTo(Ft,kt)}else ot.attr($t),Tt.attr(Ft);this._firstShowIndicator=!1;var Vt=this._shapes.handleLabels;if(Vt)for(var Ht=0;Ht<Vt.length;Ht++)this.api.enterBlur(Vt[Ht])}},a.prototype._enableHoverLinkToSeries=function(){var o=this;this._shapes.mainGroup.on("mousemove",function(c){if(o._hovering=!0,!o._dragging){var d=o.visualMapModel.itemSize,tt=o._applyTransform([c.offsetX,c.offsetY],o._shapes.mainGroup,!0,!0);tt[1]=mathMin(mathMax(0,tt[1]),d[1]),o._doHoverLinkToSeries(tt[1],0<=tt[0]&&tt[0]<=d[0])}}).on("mouseout",function(){o._hovering=!1,!o._dragging&&o._clearHoverLinkToSeries()})},a.prototype._enableHoverLinkFromSeries=function(){var o=this.api.getZr();this.visualMapModel.option.hoverLink?(o.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),o.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},a.prototype._doHoverLinkToSeries=function(o,c){var d=this.visualMapModel,tt=d.itemSize;if(d.option.hoverLink){var nt=[0,tt[1]],it=d.getExtent();o=mathMin(mathMax(nt[0],o),nt[1]);var st=getHalfHoverLinkSize(d,it,nt),ut=[o-st,o+st],ct=linearMap(o,nt,it,!0),ot=[linearMap(ut[0],nt,it,!0),linearMap(ut[1],nt,it,!0)];ut[0]<nt[0]&&(ot[0]=-1/0),ut[1]>nt[1]&&(ot[1]=1/0),c&&(ot[0]===-1/0?this._showIndicator(ct,ot[1],"< ",st):ot[1]===1/0?this._showIndicator(ct,ot[0],"> ",st):this._showIndicator(ct,ct,"≈ ",st));var at=this._hoverLinkDataIndices,ht=[];(c||useHoverLinkOnHandle(d))&&(ht=this._hoverLinkDataIndices=d.findTargetDataIndices(ot));var ft=compressBatches(at,ht);this._dispatchHighDown("downplay",makeHighDownBatch(ft[0],d)),this._dispatchHighDown("highlight",makeHighDownBatch(ft[1],d))}},a.prototype._hoverLinkFromSeriesMouseOver=function(o){var c;if(findEventDispatcher(o.target,function(st){var ut=getECData(st);if(ut.dataIndex!=null)return c=ut,!0},!0),!!c){var d=this.ecModel.getSeriesByIndex(c.seriesIndex),tt=this.visualMapModel;if(tt.isTargetSeries(d)){var nt=d.getData(c.dataType),it=nt.getStore().get(tt.getDataDimensionIndex(nt),c.dataIndex);isNaN(it)||this._showIndicator(it,it)}}},a.prototype._hideIndicator=function(){var o=this._shapes;o.indicator&&o.indicator.attr("invisible",!0),o.indicatorLabel&&o.indicatorLabel.attr("invisible",!0);var c=this._shapes.handleLabels;if(c)for(var d=0;d<c.length;d++)this.api.leaveBlur(c[d])},a.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var o=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",makeHighDownBatch(o,this.visualMapModel)),o.length=0},a.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var o=this.api.getZr();o.off("mouseover",this._hoverLinkFromSeriesMouseOver),o.off("mouseout",this._hideIndicator)},a.prototype._applyTransform=function(o,c,d,tt){var nt=getTransform$1(c,tt?null:this.group);return isArray$1(o)?applyTransform(o,nt,d):transformDirection(o,nt,d)},a.prototype._dispatchHighDown=function(o,c){c&&c.length&&this.api.dispatchAction({type:o,batch:c})},a.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},a.type="visualMap.continuous",a}(VisualMapView);function createPolygon(s,a,o,c){return new Polygon({shape:{points:s},draggable:!!o,cursor:a,drift:o,onmousemove:function(d){stop(d.event)},ondragend:c})}function getHalfHoverLinkSize(s,a,o){var c=HOVER_LINK_SIZE/2,d=s.get("hoverLinkDataSize");return d&&(c=linearMap(d,a,o,!0)/2),c}function useHoverLinkOnHandle(s){var a=s.get("hoverLinkOnHandle");return!!(a??s.get("realtime"))}function getCursor(s){return s==="vertical"?"ns-resize":"ew-resize"}var visualMapActionInfo={type:"selectDataRange",event:"dataRangeSelected",update:"update"},visualMapActionHander=function(s,a){a.eachComponent({mainType:"visualMap",query:s},function(o){o.setSelected(s.selected)})},visualMapEncodingHandlers=[{createOnAllSeries:!0,reset:function(s,a){var o=[];return a.eachComponent("visualMap",function(c){var d=s.pipelineContext;!c.isTargetSeries(s)||d&&d.large||o.push(incrementalApplyVisual(c.stateList,c.targetVisuals,bind$2(c.getValueState,c),c.getDataDimensionIndex(s.getData())))}),o}},{createOnAllSeries:!0,reset:function(s,a){var o=s.getData(),c=[];a.eachComponent("visualMap",function(d){if(d.isTargetSeries(s)){var tt=d.getVisualMeta(bind$2(getColorVisual,null,s,d))||{stops:[],outerColors:[]},nt=d.getDataDimensionIndex(o);nt>=0&&(tt.dimension=nt,c.push(tt))}}),s.getData().setVisual("visualMeta",c)}}];function getColorVisual(s,a,o,c){for(var d=a.targetVisuals[c],tt=VisualMapping.prepareVisualTypes(d),nt={color:getVisualFromData(s.getData(),"color")},it=0,st=tt.length;it<st;it++){var ut=tt[it],ct=d[ut==="opacity"?"__alphaForOpacity":ut];ct&&ct.applyVisual(o,ot,at)}return nt.color;function ot(ht){return nt[ht]}function at(ht,ft){nt[ht]=ft}}var each=each$f;function visualMapPreprocessor(s){var a=s&&s.visualMap;isArray$1(a)||(a=a?[a]:[]),each(a,function(o){if(o){has(o,"splitList")&&!has(o,"pieces")&&(o.pieces=o.splitList,delete o.splitList);var c=o.pieces;c&&isArray$1(c)&&each(c,function(d){isObject$3(d)&&(has(d,"start")&&!has(d,"min")&&(d.min=d.start),has(d,"end")&&!has(d,"max")&&(d.max=d.end))})}})}function has(s,a){return s&&s.hasOwnProperty&&s.hasOwnProperty(a)}var installed=!1;function installCommon(s){installed||(installed=!0,s.registerSubTypeDefaulter("visualMap",function(a){return!a.categories&&(!(a.pieces?a.pieces.length>0:a.splitNumber>0)||a.calculable)?"continuous":"piecewise"}),s.registerAction(visualMapActionInfo,visualMapActionHander),each$f(visualMapEncodingHandlers,function(a){s.registerVisual(s.PRIORITY.VISUAL.COMPONENT,a)}),s.registerPreprocessor(visualMapPreprocessor))}function install$5(s){s.registerComponentModel(ContinuousModel),s.registerComponentView(ContinuousView),installCommon(s)}var PiecewiseModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o._pieceList=[],o}return a.prototype.optionUpdated=function(o,c){s.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var d=this._mode=this._determineMode();this._pieceList=[],resetMethods[this._mode].call(this,this._pieceList),this._resetSelected(o,c);var tt=this.option.categories;this.resetVisual(function(nt,it){d==="categories"?(nt.mappingMethod="category",nt.categories=clone$4(tt)):(nt.dataExtent=this.getExtent(),nt.mappingMethod="piecewise",nt.pieceList=map$1(this._pieceList,function(st){return st=clone$4(st),it!=="inRange"&&(st.visual=null),st}))})},a.prototype.completeVisualOption=function(){var o=this.option,c={},d=VisualMapping.listVisualTypes(),tt=this.isCategory();each$f(o.pieces,function(it){each$f(d,function(st){it.hasOwnProperty(st)&&(c[st]=1)})}),each$f(c,function(it,st){var ut=!1;each$f(this.stateList,function(ct){ut=ut||nt(o,ct,st)||nt(o.target,ct,st)},this),!ut&&each$f(this.stateList,function(ct){(o[ct]||(o[ct]={}))[st]=visualDefault.get(st,ct==="inRange"?"active":"inactive",tt)})},this);function nt(it,st,ut){return it&&it[st]&&it[st].hasOwnProperty(ut)}s.prototype.completeVisualOption.apply(this,arguments)},a.prototype._resetSelected=function(o,c){var d=this.option,tt=this._pieceList,nt=(c?d:o).selected||{};if(d.selected=nt,each$f(tt,function(st,ut){var ct=this.getSelectedMapKey(st);nt.hasOwnProperty(ct)||(nt[ct]=!0)},this),d.selectedMode==="single"){var it=!1;each$f(tt,function(st,ut){var ct=this.getSelectedMapKey(st);nt[ct]&&(it?nt[ct]=!1:it=!0)},this)}},a.prototype.getItemSymbol=function(){return this.get("itemSymbol")},a.prototype.getSelectedMapKey=function(o){return this._mode==="categories"?o.value+"":o.index+""},a.prototype.getPieceList=function(){return this._pieceList},a.prototype._determineMode=function(){var o=this.option;return o.pieces&&o.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},a.prototype.setSelected=function(o){this.option.selected=clone$4(o)},a.prototype.getValueState=function(o){var c=VisualMapping.findPieceIndex(o,this._pieceList);return c!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[c])]?"inRange":"outOfRange"},a.prototype.findTargetDataIndices=function(o){var c=[],d=this._pieceList;return this.eachTargetSeries(function(tt){var nt=[],it=tt.getData();it.each(this.getDataDimensionIndex(it),function(st,ut){var ct=VisualMapping.findPieceIndex(st,d);ct===o&&nt.push(ut)},this),c.push({seriesId:tt.id,dataIndex:nt})},this),c},a.prototype.getRepresentValue=function(o){var c;if(this.isCategory())c=o.value;else if(o.value!=null)c=o.value;else{var d=o.interval||[];c=d[0]===-1/0&&d[1]===1/0?0:(d[0]+d[1])/2}return c},a.prototype.getVisualMeta=function(o){if(this.isCategory())return;var c=[],d=["",""],tt=this;function nt(ct,ot){var at=tt.getRepresentValue({interval:ct});ot||(ot=tt.getValueState(at));var ht=o(at,ot);ct[0]===-1/0?d[0]=ht:ct[1]===1/0?d[1]=ht:c.push({value:ct[0],color:ht},{value:ct[1],color:ht})}var it=this._pieceList.slice();if(!it.length)it.push({interval:[-1/0,1/0]});else{var st=it[0].interval[0];st!==-1/0&&it.unshift({interval:[-1/0,st]}),st=it[it.length-1].interval[1],st!==1/0&&it.push({interval:[st,1/0]})}var ut=-1/0;return each$f(it,function(ct){var ot=ct.interval;ot&&(ot[0]>ut&&nt([ut,ot[0]],"outOfRange"),nt(ot.slice()),ut=ot[1])},this),{stops:c,outerColors:d}},a.type="visualMap.piecewise",a.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),a}(VisualMapModel),resetMethods={splitNumber:function(s){var a=this.option,o=Math.min(a.precision,20),c=this.getExtent(),d=a.splitNumber;d=Math.max(parseInt(d,10),1),a.splitNumber=d;for(var tt=(c[1]-c[0])/d;+tt.toFixed(o)!==tt&&o<5;)o++;a.precision=o,tt=+tt.toFixed(o),a.minOpen&&s.push({interval:[-1/0,c[0]],close:[0,0]});for(var nt=0,it=c[0];nt<d;it+=tt,nt++){var st=nt===d-1?c[1]:it+tt;s.push({interval:[it,st],close:[1,1]})}a.maxOpen&&s.push({interval:[c[1],1/0],close:[0,0]}),reformIntervals(s),each$f(s,function(ut,ct){ut.index=ct,ut.text=this.formatValueText(ut.interval)},this)},categories:function(s){var a=this.option;each$f(a.categories,function(o){s.push({text:this.formatValueText(o,!0),value:o})},this),normalizeReverse(a,s)},pieces:function(s){var a=this.option;each$f(a.pieces,function(o,c){isObject$3(o)||(o={value:o});var d={text:"",index:c};if(o.label!=null&&(d.text=o.label),o.hasOwnProperty("value")){var tt=d.value=o.value;d.interval=[tt,tt],d.close=[1,1]}else{for(var nt=d.interval=[],it=d.close=[0,0],st=[1,0,1],ut=[-1/0,1/0],ct=[],ot=0;ot<2;ot++){for(var at=[["gte","gt","min"],["lte","lt","max"]][ot],ht=0;ht<3&&nt[ot]==null;ht++)nt[ot]=o[at[ht]],it[ot]=st[ht],ct[ot]=ht===2;nt[ot]==null&&(nt[ot]=ut[ot])}ct[0]&&nt[1]===1/0&&(it[0]=0),ct[1]&&nt[0]===-1/0&&(it[1]=0),nt[0]===nt[1]&&it[0]&&it[1]&&(d.value=nt[0])}d.visual=VisualMapping.retrieveVisuals(o),s.push(d)},this),normalizeReverse(a,s),reformIntervals(s),each$f(s,function(o){var c=o.close,d=[["<","≤"][c[1]],[">","≥"][c[0]]];o.text=o.text||this.formatValueText(o.value!=null?o.value:o.interval,!1,d)},this)}};function normalizeReverse(s,a){var o=s.inverse;(s.orient==="vertical"?!o:o)&&a.reverse()}var PiecewiseVisualMapView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type=a.type,o}return a.prototype.doRender=function(){var o=this.group;o.removeAll();var c=this.visualMapModel,d=c.get("textGap"),tt=c.textStyleModel,nt=tt.getFont(),it=tt.getTextColor(),st=this._getItemAlign(),ut=c.itemSize,ct=this._getViewData(),ot=ct.endsText,at=retrieve(c.get("showLabel",!0),!ot),ht=!c.get("selectedMode");ot&&this._renderEndsText(o,ot[0],ut,at,st),each$f(ct.viewPieceList,function(ft){var mt=ft.piece,yt=new Group$3;yt.onclick=bind$2(this._onItemClick,this,mt),this._enableHoverLink(yt,ft.indexInModelPieceList);var bt=c.getRepresentValue(mt);if(this._createItemSymbol(yt,bt,[0,0,ut[0],ut[1]],ht),at){var wt=this.visualMapModel.getValueState(bt);yt.add(new ZRText({style:{x:st==="right"?-d:ut[0]+d,y:ut[1]/2,text:mt.text,verticalAlign:"middle",align:st,font:nt,fill:it,opacity:wt==="outOfRange"?.5:1},silent:ht}))}o.add(yt)},this),ot&&this._renderEndsText(o,ot[1],ut,at,st),box(c.get("orient"),o,c.get("itemGap")),this.renderBackground(o),this.positionGroup(o)},a.prototype._enableHoverLink=function(o,c){var d=this;o.on("mouseover",function(){return tt("highlight")}).on("mouseout",function(){return tt("downplay")});var tt=function(nt){var it=d.visualMapModel;it.option.hoverLink&&d.api.dispatchAction({type:nt,batch:makeHighDownBatch(it.findTargetDataIndices(c),it)})}},a.prototype._getItemAlign=function(){var o=this.visualMapModel,c=o.option;if(c.orient==="vertical")return getItemAlign(o,this.api,o.itemSize);var d=c.align;return(!d||d==="auto")&&(d="left"),d},a.prototype._renderEndsText=function(o,c,d,tt,nt){if(c){var it=new Group$3,st=this.visualMapModel.textStyleModel;it.add(new ZRText({style:createTextStyle$1(st,{x:tt?nt==="right"?d[0]:0:d[0]/2,y:d[1]/2,verticalAlign:"middle",align:tt?nt:"center",text:c})})),o.add(it)}},a.prototype._getViewData=function(){var o=this.visualMapModel,c=map$1(o.getPieceList(),function(it,st){return{piece:it,indexInModelPieceList:st}}),d=o.get("text"),tt=o.get("orient"),nt=o.get("inverse");return(tt==="horizontal"?nt:!nt)?c.reverse():d&&(d=d.slice().reverse()),{viewPieceList:c,endsText:d}},a.prototype._createItemSymbol=function(o,c,d,tt){var nt=createSymbol$1(this.getControllerVisual(c,"symbol"),d[0],d[1],d[2],d[3],this.getControllerVisual(c,"color"));nt.silent=tt,o.add(nt)},a.prototype._onItemClick=function(o){var c=this.visualMapModel,d=c.option,tt=d.selectedMode;if(tt){var nt=clone$4(d.selected),it=c.getSelectedMapKey(o);tt==="single"||tt===!0?(nt[it]=!0,each$f(nt,function(st,ut){nt[ut]=ut===it})):nt[it]=!nt[it],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:nt})}},a.type="visualMap.piecewise",a}(VisualMapView);function install$4(s){s.registerComponentModel(PiecewiseModel),s.registerComponentView(PiecewiseVisualMapView),installCommon(s)}function install$3(s){use(install$5),use(install$4)}var DEFAULT_OPTION={label:{enabled:!0},decal:{show:!1}},inner=makeInner(),decalPaletteScope={};function ariaVisual(s,a){var o=s.getModel("aria");if(!o.get("enabled"))return;var c=clone$4(DEFAULT_OPTION);merge(c.label,s.getLocaleModel().get("aria"),!1),merge(o.option,c,!1),d(),tt();function d(){var ut=o.getModel("decal"),ct=ut.get("show");if(ct){var ot=createHashMap();s.eachSeries(function(at){if(!at.isColorBySeries()){var ht=ot.get(at.type);ht||(ht={},ot.set(at.type,ht)),inner(at).scope=ht}}),s.eachRawSeries(function(at){if(s.isSeriesFiltered(at))return;if(isFunction$1(at.enableAriaDecal)){at.enableAriaDecal();return}var ht=at.getData();if(at.isColorBySeries()){var wt=getDecalFromPalette(at.ecModel,at.name,decalPaletteScope,s.getSeriesCount()),Tt=ht.getVisual("decal");ht.setVisual("decal",Ct(Tt,wt))}else{var ft=at.getRawData(),mt={},yt=inner(at).scope;ht.each(function(Dt){var Ot=ht.getRawIndex(Dt);mt[Ot]=Dt});var bt=ft.count();ft.each(function(Dt){var Ot=mt[Dt],$t=ft.getName(Dt)||Dt+"",Ft=getDecalFromPalette(at.ecModel,$t,yt,bt),kt=ht.getItemVisual(Ot,"decal");ht.setItemVisual(Ot,"decal",Ct(kt,Ft))})}function Ct(Dt,Ot){var $t=Dt?extend(extend({},Ot),Dt):Ot;return $t.dirty=!0,$t}})}}function tt(){var ut=a.getZr().dom;if(ut){var ct=s.getLocaleModel().get("aria"),ot=o.getModel("label");if(ot.option=defaults(ot.option,ct),!!ot.get("enabled")){if(ut.setAttribute("role","img"),ot.get("description")){ut.setAttribute("aria-label",ot.get("description"));return}var at=s.getSeriesCount(),ht=ot.get(["data","maxCount"])||10,ft=ot.get(["series","maxCount"])||10,mt=Math.min(at,ft),yt;if(!(at<1)){var bt=it();if(bt){var wt=ot.get(["general","withTitle"]);yt=nt(wt,{title:bt})}else yt=ot.get(["general","withoutTitle"]);var Tt=[],Ct=at>1?ot.get(["series","multiple","prefix"]):ot.get(["series","single","prefix"]);yt+=nt(Ct,{seriesCount:at}),s.eachSeries(function(Ft,kt){if(kt<mt){var Vt=void 0,Ht=Ft.get("name"),Qt=Ht?"withName":"withoutName";Vt=at>1?ot.get(["series","multiple",Qt]):ot.get(["series","single",Qt]),Vt=nt(Vt,{seriesId:Ft.seriesIndex,seriesName:Ft.get("name"),seriesType:st(Ft.subType)});var Xt=Ft.getData();if(Xt.count()>ht){var Zt=ot.get(["data","partialData"]);Vt+=nt(Zt,{displayCnt:ht})}else Vt+=ot.get(["data","allData"]);for(var ar=ot.get(["data","separator","middle"]),nr=ot.get(["data","separator","end"]),cr=ot.get(["data","excludeDimensionId"]),dr=[],mr=0;mr<Xt.count();mr++)if(mr<ht){var Dr=Xt.getName(mr),kr=cr?filter(Xt.getValues(mr),function(Mr,Jr){return indexOf(cr,Jr)===-1}):Xt.getValues(mr),Yr=ot.get(["data",Dr?"withName":"withoutName"]);dr.push(nt(Yr,{name:Dr,value:kr.join(ar)}))}Vt+=dr.join(ar)+nr,Tt.push(Vt)}});var Dt=ot.getModel(["series","multiple","separator"]),Ot=Dt.get("middle"),$t=Dt.get("end");yt+=Tt.join(Ot)+$t,ut.setAttribute("aria-label",yt)}}}}function nt(ut,ct){if(!isString$1(ut))return ut;var ot=ut;return each$f(ct,function(at,ht){ot=ot.replace(new RegExp("\\{\\s*"+ht+"\\s*\\}","g"),at)}),ot}function it(){var ut=s.get("title");return ut&&ut.length&&(ut=ut[0]),ut&&ut.text}function st(ut){var ct=s.getLocaleModel().get(["series","typeNames"]);return ct[ut]||ct.chart}}function ariaPreprocessor(s){if(!(!s||!s.aria)){var a=s.aria;a.show!=null&&(a.enabled=a.show),a.label=a.label||{},each$f(["description","general","series","data"],function(o){a[o]!=null&&(a.label[o]=a[o])})}}function install$2(s){s.registerPreprocessor(ariaPreprocessor),s.registerVisual(s.PRIORITY.VISUAL.ARIA,ariaVisual)}var RELATIONAL_EXPRESSION_OP_ALIAS_MAP={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},RegExpEvaluator=function(){function s(a){var o=this._condVal=isString$1(a)?new RegExp(a):isRegExp(a)?a:null;if(o==null){var c="";throwError(c)}}return s.prototype.evaluate=function(a){var o=typeof a;return isString$1(o)?this._condVal.test(a):isNumber(o)?this._condVal.test(a+""):!1},s}(),ConstConditionInternal=function(){function s(){}return s.prototype.evaluate=function(){return this.value},s}(),AndConditionInternal=function(){function s(){}return s.prototype.evaluate=function(){for(var a=this.children,o=0;o<a.length;o++)if(!a[o].evaluate())return!1;return!0},s}(),OrConditionInternal=function(){function s(){}return s.prototype.evaluate=function(){for(var a=this.children,o=0;o<a.length;o++)if(a[o].evaluate())return!0;return!1},s}(),NotConditionInternal=function(){function s(){}return s.prototype.evaluate=function(){return!this.child.evaluate()},s}(),RelationalConditionInternal=function(){function s(){}return s.prototype.evaluate=function(){for(var a=!!this.valueParser,o=this.getValue,c=o(this.valueGetterParam),d=a?this.valueParser(c):null,tt=0;tt<this.subCondList.length;tt++)if(!this.subCondList[tt].evaluate(a?d:c))return!1;return!0},s}();function parseOption(s,a){if(s===!0||s===!1){var o=new ConstConditionInternal;return o.value=s,o}var c="";return isObjectNotArray(s)||throwError(c),s.and?parseAndOrOption("and",s,a):s.or?parseAndOrOption("or",s,a):s.not?parseNotOption(s,a):parseRelationalOption(s,a)}function parseAndOrOption(s,a,o){var c=a[s],d="";isArray$1(c)||throwError(d),c.length||throwError(d);var tt=s==="and"?new AndConditionInternal:new OrConditionInternal;return tt.children=map$1(c,function(nt){return parseOption(nt,o)}),tt.children.length||throwError(d),tt}function parseNotOption(s,a){var o=s.not,c="";isObjectNotArray(o)||throwError(c);var d=new NotConditionInternal;return d.child=parseOption(o,a),d.child||throwError(c),d}function parseRelationalOption(s,a){for(var o="",c=a.prepareGetValue(s),d=[],tt=keys(s),nt=s.parser,it=nt?getRawValueParser(nt):null,st=0;st<tt.length;st++){var ut=tt[st];if(!(ut==="parser"||a.valueGetterAttrMap.get(ut))){var ct=hasOwn(RELATIONAL_EXPRESSION_OP_ALIAS_MAP,ut)?RELATIONAL_EXPRESSION_OP_ALIAS_MAP[ut]:ut,ot=s[ut],at=it?it(ot):ot,ht=createFilterComparator(ct,at)||ct==="reg"&&new RegExpEvaluator(at);ht||throwError(o),d.push(ht)}}d.length||throwError(o);var ft=new RelationalConditionInternal;return ft.valueGetterParam=c,ft.valueParser=it,ft.getValue=a.getValue,ft.subCondList=d,ft}function isObjectNotArray(s){return isObject$3(s)&&!isArrayLike(s)}var ConditionalExpressionParsed=function(){function s(a,o){this._cond=parseOption(a,o)}return s.prototype.evaluate=function(){return this._cond.evaluate()},s}();function parseConditionalExpression(s,a){return new ConditionalExpressionParsed(s,a)}var filterTransform={type:"echarts:filter",transform:function(s){for(var a=s.upstream,o,c=parseConditionalExpression(s.config,{valueGetterAttrMap:createHashMap({dimension:!0}),prepareGetValue:function(it){var st="",ut=it.dimension;hasOwn(it,"dimension")||throwError(st);var ct=a.getDimensionInfo(ut);return ct||throwError(st),{dimIdx:ct.index}},getValue:function(it){return a.retrieveValueFromItem(o,it.dimIdx)}}),d=[],tt=0,nt=a.count();tt<nt;tt++)o=a.getRawDataItem(tt),c.evaluate()&&d.push(o);return{data:d}}},sortTransform={type:"echarts:sort",transform:function(s){var a=s.upstream,o=s.config,c="",d=normalizeToArray(o);d.length||throwError(c);var tt=[];each$f(d,function(ct){var ot=ct.dimension,at=ct.order,ht=ct.parser,ft=ct.incomparable;if(ot==null&&throwError(c),at!=="asc"&&at!=="desc"&&throwError(c),ft&&ft!=="min"&&ft!=="max"){var mt="";throwError(mt)}if(at!=="asc"&&at!=="desc"){var yt="";throwError(yt)}var bt=a.getDimensionInfo(ot);bt||throwError(c);var wt=ht?getRawValueParser(ht):null;ht&&!wt&&throwError(c),tt.push({dimIdx:bt.index,parser:wt,comparator:new SortOrderComparator(at,ft)})});var nt=a.sourceFormat;nt!==SOURCE_FORMAT_ARRAY_ROWS&&nt!==SOURCE_FORMAT_OBJECT_ROWS&&throwError(c);for(var it=[],st=0,ut=a.count();st<ut;st++)it.push(a.getRawDataItem(st));return it.sort(function(ct,ot){for(var at=0;at<tt.length;at++){var ht=tt[at],ft=a.retrieveValueFromItem(ct,ht.dimIdx),mt=a.retrieveValueFromItem(ot,ht.dimIdx);ht.parser&&(ft=ht.parser(ft),mt=ht.parser(mt));var yt=ht.comparator.evaluate(ft,mt);if(yt!==0)return yt}return 0}),{data:it}}};function install$1(s){s.registerTransform(filterTransform),s.registerTransform(sortTransform)}var DatasetModel=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="dataset",o}return a.prototype.init=function(o,c,d){s.prototype.init.call(this,o,c,d),this._sourceManager=new SourceManager(this),disableTransformOptionMerge(this)},a.prototype.mergeOption=function(o,c){s.prototype.mergeOption.call(this,o,c),disableTransformOptionMerge(this)},a.prototype.optionUpdated=function(){this._sourceManager.dirty()},a.prototype.getSourceManager=function(){return this._sourceManager},a.type="dataset",a.defaultOption={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN},a}(ComponentModel),DatasetView=function(s){__extends$1(a,s);function a(){var o=s!==null&&s.apply(this,arguments)||this;return o.type="dataset",o}return a.type="dataset",a}(ComponentView);function install(s){s.registerComponentModel(DatasetModel),s.registerComponentView(DatasetView)}var CMD=PathProxy.CMD;function aroundEqual(s,a){return Math.abs(s-a)<1e-5}function pathToBezierCurves(s){var a=s.data,o=s.len(),c=[],d,tt=0,nt=0,it=0,st=0;function ut(Xt,Zt){d&&d.length>2&&c.push(d),d=[Xt,Zt]}function ct(Xt,Zt,ar,nr){aroundEqual(Xt,ar)&&aroundEqual(Zt,nr)||d.push(Xt,Zt,ar,nr,ar,nr)}function ot(Xt,Zt,ar,nr,cr,dr){var mr=Math.abs(Zt-Xt),Dr=Math.tan(mr/4)*4/3,kr=Zt<Xt?-1:1,Yr=Math.cos(Xt),Mr=Math.sin(Xt),Jr=Math.cos(Zt),an=Math.sin(Zt),xn=Yr*cr+ar,Rn=Mr*dr+nr,hn=Jr*cr+ar,pn=an*dr+nr,yn=cr*Dr*kr,un=dr*Dr*kr;d.push(xn-yn*Mr,Rn+un*Yr,hn+yn*an,pn-un*Jr,hn,pn)}for(var at,ht,ft,mt,yt=0;yt<o;){var bt=a[yt++],wt=yt===1;switch(wt&&(tt=a[yt],nt=a[yt+1],it=tt,st=nt,(bt===CMD.L||bt===CMD.C||bt===CMD.Q)&&(d=[it,st])),bt){case CMD.M:tt=it=a[yt++],nt=st=a[yt++],ut(it,st);break;case CMD.L:at=a[yt++],ht=a[yt++],ct(tt,nt,at,ht),tt=at,nt=ht;break;case CMD.C:d.push(a[yt++],a[yt++],a[yt++],a[yt++],tt=a[yt++],nt=a[yt++]);break;case CMD.Q:at=a[yt++],ht=a[yt++],ft=a[yt++],mt=a[yt++],d.push(tt+2/3*(at-tt),nt+2/3*(ht-nt),ft+2/3*(at-ft),mt+2/3*(ht-mt),ft,mt),tt=ft,nt=mt;break;case CMD.A:var Tt=a[yt++],Ct=a[yt++],Dt=a[yt++],Ot=a[yt++],$t=a[yt++],Ft=a[yt++]+$t;yt+=1;var kt=!a[yt++];at=Math.cos($t)*Dt+Tt,ht=Math.sin($t)*Ot+Ct,wt?(it=at,st=ht,ut(it,st)):ct(tt,nt,at,ht),tt=Math.cos(Ft)*Dt+Tt,nt=Math.sin(Ft)*Ot+Ct;for(var Vt=(kt?-1:1)*Math.PI/2,Ht=$t;kt?Ht>Ft:Ht<Ft;Ht+=Vt){var Qt=kt?Math.max(Ht+Vt,Ft):Math.min(Ht+Vt,Ft);ot(Ht,Qt,Tt,Ct,Dt,Ot)}break;case CMD.R:it=tt=a[yt++],st=nt=a[yt++],at=it+a[yt++],ht=st+a[yt++],ut(at,st),ct(at,st,at,ht),ct(at,ht,it,ht),ct(it,ht,it,st),ct(it,st,at,st);break;case CMD.Z:d&&ct(tt,nt,it,st),tt=it,nt=st;break}}return d&&d.length>2&&c.push(d),c}function adpativeBezier(s,a,o,c,d,tt,nt,it,st,ut){if(aroundEqual(s,o)&&aroundEqual(a,c)&&aroundEqual(d,nt)&&aroundEqual(tt,it)){st.push(nt,it);return}var ct=2/ut,ot=ct*ct,at=nt-s,ht=it-a,ft=Math.sqrt(at*at+ht*ht);at/=ft,ht/=ft;var mt=o-s,yt=c-a,bt=d-nt,wt=tt-it,Tt=mt*mt+yt*yt,Ct=bt*bt+wt*wt;if(Tt<ot&&Ct<ot){st.push(nt,it);return}var Dt=at*mt+ht*yt,Ot=-at*bt-ht*wt,$t=Tt-Dt*Dt,Ft=Ct-Ot*Ot;if($t<ot&&Dt>=0&&Ft<ot&&Ot>=0){st.push(nt,it);return}var kt=[],Vt=[];cubicSubdivide(s,o,d,nt,.5,kt),cubicSubdivide(a,c,tt,it,.5,Vt),adpativeBezier(kt[0],Vt[0],kt[1],Vt[1],kt[2],Vt[2],kt[3],Vt[3],st,ut),adpativeBezier(kt[4],Vt[4],kt[5],Vt[5],kt[6],Vt[6],kt[7],Vt[7],st,ut)}function pathToPolygons(s,a){var o=pathToBezierCurves(s),c=[];a=a||1;for(var d=0;d<o.length;d++){var tt=o[d],nt=[],it=tt[0],st=tt[1];nt.push(it,st);for(var ut=2;ut<tt.length;){var ct=tt[ut++],ot=tt[ut++],at=tt[ut++],ht=tt[ut++],ft=tt[ut++],mt=tt[ut++];adpativeBezier(it,st,ct,ot,at,ht,ft,mt,nt,a),it=ft,st=mt}c.push(nt)}return c}function getDividingGrids(s,a,o){var c=s[a],d=s[1-a],tt=Math.abs(c/d),nt=Math.ceil(Math.sqrt(tt*o)),it=Math.floor(o/nt);it===0&&(it=1,nt=o);for(var st=[],ut=0;ut<nt;ut++)st.push(it);var ct=nt*it,ot=o-ct;if(ot>0)for(var ut=0;ut<ot;ut++)st[ut%nt]+=1;return st}function divideSector(s,a,o){for(var c=s.r0,d=s.r,tt=s.startAngle,nt=s.endAngle,it=Math.abs(nt-tt),st=it*d,ut=d-c,ct=st>Math.abs(ut),ot=getDividingGrids([st,ut],ct?0:1,a),at=(ct?it:ut)/ot.length,ht=0;ht<ot.length;ht++)for(var ft=(ct?ut:it)/ot[ht],mt=0;mt<ot[ht];mt++){var yt={};ct?(yt.startAngle=tt+at*ht,yt.endAngle=tt+at*(ht+1),yt.r0=c+ft*mt,yt.r=c+ft*(mt+1)):(yt.startAngle=tt+ft*mt,yt.endAngle=tt+ft*(mt+1),yt.r0=c+at*ht,yt.r=c+at*(ht+1)),yt.clockwise=s.clockwise,yt.cx=s.cx,yt.cy=s.cy,o.push(yt)}}function divideRect(s,a,o){for(var c=s.width,d=s.height,tt=c>d,nt=getDividingGrids([c,d],tt?0:1,a),it=tt?"width":"height",st=tt?"height":"width",ut=tt?"x":"y",ct=tt?"y":"x",ot=s[it]/nt.length,at=0;at<nt.length;at++)for(var ht=s[st]/nt[at],ft=0;ft<nt[at];ft++){var mt={};mt[ut]=at*ot,mt[ct]=ft*ht,mt[it]=ot,mt[st]=ht,mt.x+=s.x,mt.y+=s.y,o.push(mt)}}function crossProduct2d(s,a,o,c){return s*c-o*a}function lineLineIntersect(s,a,o,c,d,tt,nt,it){var st=o-s,ut=c-a,ct=nt-d,ot=it-tt,at=crossProduct2d(ct,ot,st,ut);if(Math.abs(at)<1e-6)return null;var ht=s-d,ft=a-tt,mt=crossProduct2d(ht,ft,ct,ot)/at;return mt<0||mt>1?null:new Point(mt*st+s,mt*ut+a)}function projPtOnLine(s,a,o){var c=new Point;Point.sub(c,o,a),c.normalize();var d=new Point;Point.sub(d,s,a);var tt=d.dot(c);return tt}function addToPoly(s,a){var o=s[s.length-1];o&&o[0]===a[0]&&o[1]===a[1]||s.push(a)}function splitPolygonByLine(s,a,o){for(var c=s.length,d=[],tt=0;tt<c;tt++){var nt=s[tt],it=s[(tt+1)%c],st=lineLineIntersect(nt[0],nt[1],it[0],it[1],a.x,a.y,o.x,o.y);st&&d.push({projPt:projPtOnLine(st,a,o),pt:st,idx:tt})}if(d.length<2)return[{points:s},{points:s}];d.sort(function(yt,bt){return yt.projPt-bt.projPt});var ut=d[0],ct=d[d.length-1];if(ct.idx<ut.idx){var ot=ut;ut=ct,ct=ot}for(var at=[ut.pt.x,ut.pt.y],ht=[ct.pt.x,ct.pt.y],ft=[at],mt=[ht],tt=ut.idx+1;tt<=ct.idx;tt++)addToPoly(ft,s[tt].slice());addToPoly(ft,ht),addToPoly(ft,at);for(var tt=ct.idx+1;tt<=ut.idx+c;tt++)addToPoly(mt,s[tt%c].slice());return addToPoly(mt,at),addToPoly(mt,ht),[{points:ft},{points:mt}]}function binaryDividePolygon(s){var a=s.points,o=[],c=[];fromPoints(a,o,c);var d=new BoundingRect(o[0],o[1],c[0]-o[0],c[1]-o[1]),tt=d.width,nt=d.height,it=d.x,st=d.y,ut=new Point,ct=new Point;return tt>nt?(ut.x=ct.x=it+tt/2,ut.y=st,ct.y=st+nt):(ut.y=ct.y=st+nt/2,ut.x=it,ct.x=it+tt),splitPolygonByLine(a,ut,ct)}function binaryDivideRecursive(s,a,o,c){if(o===1)c.push(a);else{var d=Math.floor(o/2),tt=s(a);binaryDivideRecursive(s,tt[0],d,c),binaryDivideRecursive(s,tt[1],o-d,c)}return c}function clone(s,a){for(var o=[],c=0;c<a;c++)o.push(clonePath(s));return o}function copyPathProps(s,a){a.setStyle(s.style),a.z=s.z,a.z2=s.z2,a.zlevel=s.zlevel}function polygonConvert(s){for(var a=[],o=0;o<s.length;)a.push([s[o++],s[o++]]);return a}function split(s,a){var o=[],c=s.shape,d;switch(s.type){case"rect":divideRect(c,a,o),d=Rect$2;break;case"sector":divideSector(c,a,o),d=Sector;break;case"circle":divideSector({r0:0,r:c.r,startAngle:0,endAngle:Math.PI*2,cx:c.cx,cy:c.cy},a,o),d=Sector;break;default:var tt=s.getComputedTransform(),nt=tt?Math.sqrt(Math.max(tt[0]*tt[0]+tt[1]*tt[1],tt[2]*tt[2]+tt[3]*tt[3])):1,it=map$1(pathToPolygons(s.getUpdatedPathProxy(),nt),function(bt){return polygonConvert(bt)}),st=it.length;if(st===0)binaryDivideRecursive(binaryDividePolygon,{points:it[0]},a,o);else if(st===a)for(var ut=0;ut<st;ut++)o.push({points:it[ut]});else{var ct=0,ot=map$1(it,function(bt){var wt=[],Tt=[];fromPoints(bt,wt,Tt);var Ct=(Tt[1]-wt[1])*(Tt[0]-wt[0]);return ct+=Ct,{poly:bt,area:Ct}});ot.sort(function(bt,wt){return wt.area-bt.area});for(var at=a,ut=0;ut<st;ut++){var ht=ot[ut];if(at<=0)break;var ft=ut===st-1?at:Math.ceil(ht.area/ct*a);ft<0||(binaryDivideRecursive(binaryDividePolygon,{points:ht.poly},ft,o),at-=ft)}}d=Polygon;break}if(!d)return clone(s,a);for(var mt=[],ut=0;ut<o.length;ut++){var yt=new d;yt.setShape(o[ut]),copyPathProps(s,yt),mt.push(yt)}return mt}function alignSubpath(s,a){var o=s.length,c=a.length;if(o===c)return[s,a];for(var d=[],tt=[],nt=o<c?s:a,it=Math.min(o,c),st=Math.abs(c-o)/6,ut=(it-2)/6,ct=Math.ceil(st/ut)+1,ot=[nt[0],nt[1]],at=st,ht=2;ht<it;){var ft=nt[ht-2],mt=nt[ht-1],yt=nt[ht++],bt=nt[ht++],wt=nt[ht++],Tt=nt[ht++],Ct=nt[ht++],Dt=nt[ht++];if(at<=0){ot.push(yt,bt,wt,Tt,Ct,Dt);continue}for(var Ot=Math.min(at,ct-1)+1,$t=1;$t<=Ot;$t++){var Ft=$t/Ot;cubicSubdivide(ft,yt,wt,Ct,Ft,d),cubicSubdivide(mt,bt,Tt,Dt,Ft,tt),ft=d[3],mt=tt[3],ot.push(d[1],tt[1],d[2],tt[2],ft,mt),yt=d[5],bt=tt[5],wt=d[6],Tt=tt[6]}at-=Ot-1}return nt===s?[ot,a]:[s,ot]}function createSubpath(s,a){for(var o=s.length,c=s[o-2],d=s[o-1],tt=[],nt=0;nt<a.length;)tt[nt++]=c,tt[nt++]=d;return tt}function alignBezierCurves(s,a){for(var o,c,d,tt=[],nt=[],it=0;it<Math.max(s.length,a.length);it++){var st=s[it],ut=a[it],ct=void 0,ot=void 0;st?ut?(o=alignSubpath(st,ut),ct=o[0],ot=o[1],c=ct,d=ot):(ot=createSubpath(d||st,st),ct=st):(ct=createSubpath(c||ut,ut),ot=ut),tt.push(ct),nt.push(ot)}return[tt,nt]}function centroid(s){for(var a=0,o=0,c=0,d=s.length,tt=0,nt=d-2;tt<d;nt=tt,tt+=2){var it=s[nt],st=s[nt+1],ut=s[tt],ct=s[tt+1],ot=it*ct-ut*st;a+=ot,o+=(it+ut)*ot,c+=(st+ct)*ot}return a===0?[s[0]||0,s[1]||0]:[o/a/3,c/a/3,a]}function findBestRingOffset(s,a,o,c){for(var d=(s.length-2)/6,tt=1/0,nt=0,it=s.length,st=it-2,ut=0;ut<d;ut++){for(var ct=ut*6,ot=0,at=0;at<it;at+=2){var ht=at===0?ct:(ct+at-2)%st+2,ft=s[ht]-o[0],mt=s[ht+1]-o[1],yt=a[at]-c[0],bt=a[at+1]-c[1],wt=yt-ft,Tt=bt-mt;ot+=wt*wt+Tt*Tt}ot<tt&&(tt=ot,nt=ut)}return nt}function reverse(s){for(var a=[],o=s.length,c=0;c<o;c+=2)a[c]=s[o-c-2],a[c+1]=s[o-c-1];return a}function findBestMorphingRotation(s,a,o,c){for(var d=[],tt,nt=0;nt<s.length;nt++){var it=s[nt],st=a[nt],ut=centroid(it),ct=centroid(st);tt==null&&(tt=ut[2]<0!=ct[2]<0);var ot=[],at=[],ht=0,ft=1/0,mt=[],yt=it.length;tt&&(it=reverse(it));for(var bt=findBestRingOffset(it,st,ut,ct)*6,wt=yt-2,Tt=0;Tt<wt;Tt+=2){var Ct=(bt+Tt)%wt+2;ot[Tt+2]=it[Ct]-ut[0],ot[Tt+3]=it[Ct+1]-ut[1]}ot[0]=it[bt]-ut[0],ot[1]=it[bt+1]-ut[1];for(var Dt=c/o,Ot=-c/2;Ot<=c/2;Ot+=Dt){for(var $t=Math.sin(Ot),Ft=Math.cos(Ot),kt=0,Tt=0;Tt<it.length;Tt+=2){var Vt=ot[Tt],Ht=ot[Tt+1],Qt=st[Tt]-ct[0],Xt=st[Tt+1]-ct[1],Zt=Qt*Ft-Xt*$t,ar=Qt*$t+Xt*Ft;mt[Tt]=Zt,mt[Tt+1]=ar;var nr=Zt-Vt,cr=ar-Ht;kt+=nr*nr+cr*cr}if(kt<ft){ft=kt,ht=Ot;for(var dr=0;dr<mt.length;dr++)at[dr]=mt[dr]}}d.push({from:ot,to:at,fromCp:ut,toCp:ct,rotation:-ht})}return d}function isCombineMorphing(s){return s.__isCombineMorphing}var SAVED_METHOD_PREFIX="__mOriginal_";function saveAndModifyMethod(s,a,o){var c=SAVED_METHOD_PREFIX+a,d=s[c]||s[a];s[c]||(s[c]=s[a]);var tt=o.replace,nt=o.after,it=o.before;s[a]=function(){var st=arguments,ut;return it&&it.apply(this,st),tt?ut=tt.apply(this,st):ut=d.apply(this,st),nt&&nt.apply(this,st),ut}}function restoreMethod(s,a){var o=SAVED_METHOD_PREFIX+a;s[o]&&(s[a]=s[o],s[o]=null)}function applyTransformOnBeziers(s,a){for(var o=0;o<s.length;o++)for(var c=s[o],d=0;d<c.length;){var tt=c[d],nt=c[d+1];c[d++]=a[0]*tt+a[2]*nt+a[4],c[d++]=a[1]*tt+a[3]*nt+a[5]}}function prepareMorphPath(s,a){var o=s.getUpdatedPathProxy(),c=a.getUpdatedPathProxy(),d=alignBezierCurves(pathToBezierCurves(o),pathToBezierCurves(c)),tt=d[0],nt=d[1],it=s.getComputedTransform(),st=a.getComputedTransform();function ut(){this.transform=null}it&&applyTransformOnBeziers(tt,it),st&&applyTransformOnBeziers(nt,st),saveAndModifyMethod(a,"updateTransform",{replace:ut}),a.transform=null;var ct=findBestMorphingRotation(tt,nt,10,Math.PI),ot=[];saveAndModifyMethod(a,"buildPath",{replace:function(at){for(var ht=a.__morphT,ft=1-ht,mt=[],yt=0;yt<ct.length;yt++){var bt=ct[yt],wt=bt.from,Tt=bt.to,Ct=bt.rotation*ht,Dt=bt.fromCp,Ot=bt.toCp,$t=Math.sin(Ct),Ft=Math.cos(Ct);lerp$1(mt,Dt,Ot,ht);for(var kt=0;kt<wt.length;kt+=2){var Vt=wt[kt],Ht=wt[kt+1],Qt=Tt[kt],Xt=Tt[kt+1],Zt=Vt*ft+Qt*ht,ar=Ht*ft+Xt*ht;ot[kt]=Zt*Ft-ar*$t+mt[0],ot[kt+1]=Zt*$t+ar*Ft+mt[1]}var nr=ot[0],cr=ot[1];at.moveTo(nr,cr);for(var kt=2;kt<wt.length;){var Qt=ot[kt++],Xt=ot[kt++],dr=ot[kt++],mr=ot[kt++],Dr=ot[kt++],kr=ot[kt++];nr===Qt&&cr===Xt&&dr===Dr&&mr===kr?at.lineTo(Dr,kr):at.bezierCurveTo(Qt,Xt,dr,mr,Dr,kr),nr=Dr,cr=kr}}}})}function morphPath(s,a,o){if(!s||!a)return a;var c=o.done,d=o.during;prepareMorphPath(s,a),a.__morphT=0;function tt(){restoreMethod(a,"buildPath"),restoreMethod(a,"updateTransform"),a.__morphT=-1,a.createPathProxy(),a.dirtyShape()}return a.animateTo({__morphT:1},defaults({during:function(nt){a.dirtyShape(),d&&d(nt)},done:function(){tt(),c&&c()}},o)),a}function hilbert(s,a,o,c,d,tt){var nt=16;s=d===o?0:Math.round(32767*(s-o)/(d-o)),a=tt===c?0:Math.round(32767*(a-c)/(tt-c));for(var it=0,st,ut=(1<<nt)/2;ut>0;ut/=2){var ct=0,ot=0;(s&ut)>0&&(ct=1),(a&ut)>0&&(ot=1),it+=ut*ut*(3*ct^ot),ot===0&&(ct===1&&(s=ut-1-s,a=ut-1-a),st=s,s=a,a=st)}return it}function sortPaths(s){var a=1/0,o=1/0,c=-1/0,d=-1/0,tt=map$1(s,function(it){var st=it.getBoundingRect(),ut=it.getComputedTransform(),ct=st.x+st.width/2+(ut?ut[4]:0),ot=st.y+st.height/2+(ut?ut[5]:0);return a=Math.min(ct,a),o=Math.min(ot,o),c=Math.max(ct,c),d=Math.max(ot,d),[ct,ot]}),nt=map$1(tt,function(it,st){return{cp:it,z:hilbert(it[0],it[1],a,o,c,d),path:s[st]}});return nt.sort(function(it,st){return it.z-st.z}).map(function(it){return it.path})}function defaultDividePath(s){return split(s.path,s.count)}function createEmptyReturn(){return{fromIndividuals:[],toIndividuals:[],count:0}}function combineMorph(s,a,o){var c=[];function d(Dt){for(var Ot=0;Ot<Dt.length;Ot++){var $t=Dt[Ot];isCombineMorphing($t)?d($t.childrenRef()):$t instanceof Path&&c.push($t)}}d(s);var tt=c.length;if(!tt)return createEmptyReturn();var nt=o.dividePath||defaultDividePath,it=nt({path:a,count:tt});if(it.length!==tt)return console.error("Invalid morphing: unmatched splitted path"),createEmptyReturn();c=sortPaths(c),it=sortPaths(it);for(var st=o.done,ut=o.during,ct=o.individualDelay,ot=new Transformable,at=0;at<tt;at++){var ht=c[at],ft=it[at];ft.parent=a,ft.copyTransform(ot),ct||prepareMorphPath(ht,ft)}a.__isCombineMorphing=!0,a.childrenRef=function(){return it};function mt(Dt){for(var Ot=0;Ot<it.length;Ot++)it[Ot].addSelfToZr(Dt)}saveAndModifyMethod(a,"addSelfToZr",{after:function(Dt){mt(Dt)}}),saveAndModifyMethod(a,"removeSelfFromZr",{after:function(Dt){for(var Ot=0;Ot<it.length;Ot++)it[Ot].removeSelfFromZr(Dt)}});function yt(){a.__isCombineMorphing=!1,a.__morphT=-1,a.childrenRef=null,restoreMethod(a,"addSelfToZr"),restoreMethod(a,"removeSelfFromZr")}var bt=it.length;if(ct)for(var wt=bt,Tt=function(){wt--,wt===0&&(yt(),st&&st())},at=0;at<bt;at++){var Ct=ct?defaults({delay:(o.delay||0)+ct(at,bt,c[at],it[at]),done:Tt},o):o;morphPath(c[at],it[at],Ct)}else a.__morphT=0,a.animateTo({__morphT:1},defaults({during:function(Dt){for(var Ot=0;Ot<bt;Ot++){var $t=it[Ot];$t.__morphT=a.__morphT,$t.dirtyShape()}ut&&ut(Dt)},done:function(){yt();for(var Dt=0;Dt<s.length;Dt++)restoreMethod(s[Dt],"updateTransform");st&&st()}},o));return a.__zr&&mt(a.__zr),{fromIndividuals:c,toIndividuals:it,count:bt}}function separateMorph(s,a,o){var c=a.length,d=[],tt=o.dividePath||defaultDividePath;function nt(ht){for(var ft=0;ft<ht.length;ft++){var mt=ht[ft];isCombineMorphing(mt)?nt(mt.childrenRef()):mt instanceof Path&&d.push(mt)}}if(isCombineMorphing(s)){nt(s.childrenRef());var it=d.length;if(it<c)for(var st=0,ut=it;ut<c;ut++)d.push(clonePath(d[st++%it]));d.length=c}else{d=tt({path:s,count:c});for(var ct=s.getComputedTransform(),ut=0;ut<d.length;ut++)d[ut].setLocalTransform(ct);if(d.length!==c)return console.error("Invalid morphing: unmatched splitted path"),createEmptyReturn()}d=sortPaths(d),a=sortPaths(a);for(var ot=o.individualDelay,ut=0;ut<c;ut++){var at=ot?defaults({delay:(o.delay||0)+ot(ut,c,d[ut],a[ut])},o):o;morphPath(d[ut],a[ut],at)}return{fromIndividuals:d,toIndividuals:a,count:a.length}}function isMultiple(s){return isArray$1(s[0])}function prepareMorphBatches(s,a){for(var o=[],c=s.length,d=0;d<c;d++)o.push({one:s[d],many:[]});for(var d=0;d<a.length;d++){var tt=a[d].length,nt=void 0;for(nt=0;nt<tt;nt++)o[nt%c].many.push(a[d][nt])}for(var it=0,d=c-1;d>=0;d--)if(!o[d].many.length){var st=o[it].many;if(st.length<=1)if(it)it=0;else return o;var tt=st.length,ut=Math.ceil(tt/2);o[d].many=st.slice(ut,tt),o[it].many=st.slice(0,ut),it++}return o}var pathDividers={clone:function(s){for(var a=[],o=1-Math.pow(1-s.path.style.opacity,1/s.count),c=0;c<s.count;c++){var d=clonePath(s.path);d.setStyle("opacity",o),a.push(d)}return a},split:null};function applyMorphAnimation(s,a,o,c,d,tt){if(!s.length||!a.length)return;var nt=getAnimationConfig("update",c,d);if(!(nt&&nt.duration>0))return;var it=c.getModel("universalTransition").get("delay"),st=Object.assign({setToFinal:!0},nt),ut,ct;isMultiple(s)&&(ut=s,ct=a),isMultiple(a)&&(ut=a,ct=s);function ot(bt,wt,Tt,Ct,Dt){var Ot=bt.many,$t=bt.one;if(Ot.length===1&&!Dt){var Ft=wt?Ot[0]:$t,kt=wt?$t:Ot[0];if(isCombineMorphing(Ft))ot({many:[Ft],one:kt},!0,Tt,Ct,!0);else{var Vt=it?defaults({delay:it(Tt,Ct)},st):st;morphPath(Ft,kt,Vt),tt(Ft,kt,Ft,kt,Vt)}}else for(var Ht=defaults({dividePath:pathDividers[o],individualDelay:it&&function(cr,dr,mr,Dr){return it(cr+Tt,Ct)}},st),Qt=wt?combineMorph(Ot,$t,Ht):separateMorph($t,Ot,Ht),Xt=Qt.fromIndividuals,Zt=Qt.toIndividuals,ar=Xt.length,nr=0;nr<ar;nr++){var Vt=it?defaults({delay:it(nr,ar)},st):st;tt(Xt[nr],Zt[nr],wt?Ot[nr]:bt.one,wt?bt.one:Ot[nr],Vt)}}for(var at=ut?ut===s:s.length>a.length,ht=ut?prepareMorphBatches(ct,ut):prepareMorphBatches(at?a:s,[at?s:a]),ft=0,mt=0;mt<ht.length;mt++)ft+=ht[mt].many.length;for(var yt=0,mt=0;mt<ht.length;mt++)ot(ht[mt],at,yt,ft),yt+=ht[mt].many.length}function getPathList(s){if(!s)return[];if(isArray$1(s)){for(var a=[],o=0;o<s.length;o++)a.push(getPathList(s[o]));return a}var c=[];return s.traverse(function(d){d instanceof Path&&!d.disableMorphing&&!d.invisible&&!d.ignore&&c.push(d)}),c}var DATA_COUNT_THRESHOLD=1e4,TRANSITION_NONE=0,TRANSITION_P2C=1,TRANSITION_C2P=2,getUniversalTransitionGlobalStore=makeInner();function getDimension(s,a){for(var o=s.dimensions,c=0;c<o.length;c++){var d=s.getDimensionInfo(o[c]);if(d&&d.otherDims[a]===0)return o[c]}}function getValueByDimension(s,a,o){var c=s.getDimensionInfo(o),d=c&&c.ordinalMeta;if(c){var tt=s.get(c.name,a);return d&&d.categories[tt]||tt+""}}function getGroupId(s,a,o,c){var d=c?"itemChildGroupId":"itemGroupId",tt=getDimension(s,d);if(tt){var nt=getValueByDimension(s,a,tt);return nt}var it=s.getRawDataItem(a),st=c?"childGroupId":"groupId";if(it&&it[st])return it[st]+"";if(!c)return o||s.getId(a)}function flattenDataDiffItems(s){var a=[];return each$f(s,function(o){var c=o.data,d=o.dataGroupId;if(!(c.count()>DATA_COUNT_THRESHOLD))for(var tt=c.getIndices(),nt=0;nt<tt.length;nt++)a.push({data:c,groupId:getGroupId(c,nt,d,!1),childGroupId:getGroupId(c,nt,d,!0),divide:o.divide,dataIndex:nt})}),a}function fadeInElement(s,a,o){s.traverse(function(c){c instanceof Path&&initProps(c,{style:{opacity:0}},a,{dataIndex:o,isFrom:!0})})}function removeEl(s){if(s.parent){var a=s.getComputedTransform();s.setLocalTransform(a),s.parent.remove(s)}}function stopAnimation(s){s.stopAnimation(),s.isGroup&&s.traverse(function(a){a.stopAnimation()})}function animateElementStyles(s,a,o){var c=getAnimationConfig("update",o,a);c&&s.traverse(function(d){if(d instanceof Displayable){var tt=getOldStyle(d);tt&&d.animateFrom({style:tt},c)}})}function isAllIdSame(s,a){var o=s.length;if(o!==a.length)return!1;for(var c=0;c<o;c++){var d=s[c],tt=a[c];if(d.data.getId(d.dataIndex)!==tt.data.getId(tt.dataIndex))return!1}return!0}function transitionBetween(s,a,o){var c=flattenDataDiffItems(s),d=flattenDataDiffItems(a);function tt(Tt,Ct,Dt,Ot,$t){(Dt||Tt)&&Ct.animateFrom({style:Dt&&Dt!==Tt?extend(extend({},Dt.style),Tt.style):Tt.style},$t)}var nt=!1,it=TRANSITION_NONE,st=createHashMap(),ut=createHashMap();c.forEach(function(Tt){Tt.groupId&&st.set(Tt.groupId,!0),Tt.childGroupId&&ut.set(Tt.childGroupId,!0)});for(var ct=0;ct<d.length;ct++){var ot=d[ct].groupId;if(ut.get(ot)){it=TRANSITION_P2C;break}var at=d[ct].childGroupId;if(at&&st.get(at)){it=TRANSITION_C2P;break}}function ht(Tt,Ct){return function(Dt){var Ot=Dt.data,$t=Dt.dataIndex;return Ct?Ot.getId($t):Tt?it===TRANSITION_P2C?Dt.childGroupId:Dt.groupId:it===TRANSITION_C2P?Dt.childGroupId:Dt.groupId}}var ft=isAllIdSame(c,d),mt={};if(!ft)for(var ct=0;ct<d.length;ct++){var yt=d[ct],bt=yt.data.getItemGraphicEl(yt.dataIndex);bt&&(mt[bt.id]=!0)}function wt(Tt,Ct){var Dt=c[Ct],Ot=d[Tt],$t=Ot.data.hostModel,Ft=Dt.data.getItemGraphicEl(Dt.dataIndex),kt=Ot.data.getItemGraphicEl(Ot.dataIndex);if(Ft===kt){kt&&animateElementStyles(kt,Ot.dataIndex,$t);return}Ft&&mt[Ft.id]||kt&&(stopAnimation(kt),Ft?(stopAnimation(Ft),removeEl(Ft),nt=!0,applyMorphAnimation(getPathList(Ft),getPathList(kt),Ot.divide,$t,Tt,tt)):fadeInElement(kt,$t,Tt))}new DataDiffer(c,d,ht(!0,ft),ht(!1,ft),null,"multiple").update(wt).updateManyToOne(function(Tt,Ct){var Dt=d[Tt],Ot=Dt.data,$t=Ot.hostModel,Ft=Ot.getItemGraphicEl(Dt.dataIndex),kt=filter(map$1(Ct,function(Vt){return c[Vt].data.getItemGraphicEl(c[Vt].dataIndex)}),function(Vt){return Vt&&Vt!==Ft&&!mt[Vt.id]});Ft&&(stopAnimation(Ft),kt.length?(each$f(kt,function(Vt){stopAnimation(Vt),removeEl(Vt)}),nt=!0,applyMorphAnimation(getPathList(kt),getPathList(Ft),Dt.divide,$t,Tt,tt)):fadeInElement(Ft,$t,Dt.dataIndex))}).updateOneToMany(function(Tt,Ct){var Dt=c[Ct],Ot=Dt.data.getItemGraphicEl(Dt.dataIndex);if(!(Ot&&mt[Ot.id])){var $t=filter(map$1(Tt,function(kt){return d[kt].data.getItemGraphicEl(d[kt].dataIndex)}),function(kt){return kt&&kt!==Ot}),Ft=d[Tt[0]].data.hostModel;$t.length&&(each$f($t,function(kt){return stopAnimation(kt)}),Ot?(stopAnimation(Ot),removeEl(Ot),nt=!0,applyMorphAnimation(getPathList(Ot),getPathList($t),Dt.divide,Ft,Tt[0],tt)):each$f($t,function(kt){return fadeInElement(kt,Ft,Tt[0])}))}}).updateManyToMany(function(Tt,Ct){new DataDiffer(Ct,Tt,function(Dt){return c[Dt].data.getId(c[Dt].dataIndex)},function(Dt){return d[Dt].data.getId(d[Dt].dataIndex)}).update(function(Dt,Ot){wt(Tt[Dt],Ct[Ot])}).execute()}).execute(),nt&&each$f(a,function(Tt){var Ct=Tt.data,Dt=Ct.hostModel,Ot=Dt&&o.getViewOfSeriesModel(Dt),$t=getAnimationConfig("update",Dt,0);Ot&&Dt.isAnimationEnabled()&&$t&&$t.duration>0&&Ot.group.traverse(function(Ft){Ft instanceof Path&&!Ft.animators.length&&Ft.animateFrom({style:{opacity:0}},$t)})})}function getSeriesTransitionKey(s){var a=s.getModel("universalTransition").get("seriesKey");return a||s.id}function convertArraySeriesKeyToString(s){return isArray$1(s)?s.sort().join(","):s}function getDivideShapeFromData(s){if(s.hostModel)return s.hostModel.getModel("universalTransition").get("divideShape")}function findTransitionSeriesBatches(s,a){var o=createHashMap(),c=createHashMap(),d=createHashMap();return each$f(s.oldSeries,function(tt,nt){var it=s.oldDataGroupIds[nt],st=s.oldData[nt],ut=getSeriesTransitionKey(tt),ct=convertArraySeriesKeyToString(ut);c.set(ct,{dataGroupId:it,data:st}),isArray$1(ut)&&each$f(ut,function(ot){d.set(ot,{key:ct,dataGroupId:it,data:st})})}),each$f(a.updatedSeries,function(tt){if(tt.isUniversalTransitionEnabled()&&tt.isAnimationEnabled()){var nt=tt.get("dataGroupId"),it=tt.getData(),st=getSeriesTransitionKey(tt),ut=convertArraySeriesKeyToString(st),ct=c.get(ut);if(ct)o.set(ut,{oldSeries:[{dataGroupId:ct.dataGroupId,divide:getDivideShapeFromData(ct.data),data:ct.data}],newSeries:[{dataGroupId:nt,divide:getDivideShapeFromData(it),data:it}]});else if(isArray$1(st)){var ot=[];each$f(st,function(ft){var mt=c.get(ft);mt.data&&ot.push({dataGroupId:mt.dataGroupId,divide:getDivideShapeFromData(mt.data),data:mt.data})}),ot.length&&o.set(ut,{oldSeries:ot,newSeries:[{dataGroupId:nt,data:it,divide:getDivideShapeFromData(it)}]})}else{var at=d.get(st);if(at){var ht=o.get(at.key);ht||(ht={oldSeries:[{dataGroupId:at.dataGroupId,data:at.data,divide:getDivideShapeFromData(at.data)}],newSeries:[]},o.set(at.key,ht)),ht.newSeries.push({dataGroupId:nt,data:it,divide:getDivideShapeFromData(it)})}}}}),o}function querySeries(s,a){for(var o=0;o<s.length;o++){var c=a.seriesIndex!=null&&a.seriesIndex===s[o].seriesIndex||a.seriesId!=null&&a.seriesId===s[o].id;if(c)return o}}function transitionSeriesFromOpt(s,a,o,c){var d=[],tt=[];each$f(normalizeToArray(s.from),function(nt){var it=querySeries(a.oldSeries,nt);it>=0&&d.push({dataGroupId:a.oldDataGroupIds[it],data:a.oldData[it],divide:getDivideShapeFromData(a.oldData[it]),groupIdDim:nt.dimension})}),each$f(normalizeToArray(s.to),function(nt){var it=querySeries(o.updatedSeries,nt);if(it>=0){var st=o.updatedSeries[it].getData();tt.push({dataGroupId:a.oldDataGroupIds[it],data:st,divide:getDivideShapeFromData(st),groupIdDim:nt.dimension})}}),d.length>0&&tt.length>0&&transitionBetween(d,tt,c)}function installUniversalTransition(s){s.registerUpdateLifecycle("series:beforeupdate",function(a,o,c){each$f(normalizeToArray(c.seriesTransition),function(d){each$f(normalizeToArray(d.to),function(tt){for(var nt=c.updatedSeries,it=0;it<nt.length;it++)(tt.seriesIndex!=null&&tt.seriesIndex===nt[it].seriesIndex||tt.seriesId!=null&&tt.seriesId===nt[it].id)&&(nt[it][SERIES_UNIVERSAL_TRANSITION_PROP]=!0)})})}),s.registerUpdateLifecycle("series:transition",function(a,o,c){var d=getUniversalTransitionGlobalStore(o);if(d.oldSeries&&c.updatedSeries&&c.optionChanged){var tt=c.seriesTransition;if(tt)each$f(normalizeToArray(tt),function(ht){transitionSeriesFromOpt(ht,d,c,o)});else{var nt=findTransitionSeriesBatches(d,c);each$f(nt.keys(),function(ht){var ft=nt.get(ht);transitionBetween(ft.oldSeries,ft.newSeries,o)})}each$f(c.updatedSeries,function(ht){ht[SERIES_UNIVERSAL_TRANSITION_PROP]&&(ht[SERIES_UNIVERSAL_TRANSITION_PROP]=!1)})}for(var it=a.getSeries(),st=d.oldSeries=[],ut=d.oldDataGroupIds=[],ct=d.oldData=[],ot=0;ot<it.length;ot++){var at=it[ot].getData();at.count()<DATA_COUNT_THRESHOLD&&(st.push(it[ot]),ut.push(it[ot].get("dataGroupId")),ct.push(at))}})}use([install$R]);use([install$S]);use([install$Q,install$P,install$O,install$M,install$K,install$I,install$H,install$G,install$F,install$E,install$D,install$B,install$A,install$z,install$y,install$x,install$w,install$v,install$u,install$t,install$s,install$r]);use(install$p);use(install$o);use(install$J);use(install$n);use(install$C);use(install$m);use(install$l);use(install$j);use(install$i);use(install$q);use(install$h);use(install$g);use(install$f);use(install$e);use(install$d);use(install$c);use(install$9);use(install$6);use(install$8);use(install$7);use(install$3);use(install$5);use(install$4);use(install$2);use(install$1);use(install);use(installUniversalTransition);use(installLabelLayout);const echarts=Object.freeze(Object.defineProperty({__proto__:null,Axis,ChartView,ComponentModel,ComponentView,List:SeriesData,Model,PRIORITY,SeriesModel,color,connect,dataTool,dependencies,disConnect,disconnect,dispose,env,extendChartView,extendComponentModel,extendComponentView,extendSeriesModel,format,getCoordinateSystemDimensions,getInstanceByDom,getInstanceById,getMap,graphic,helper,init:init$1,innerDrawElementOnCanvas:brushSingle,matrix,number,parseGeoJSON,parseGeoJson:parseGeoJSON,registerAction,registerCoordinateSystem,registerLayout,registerLoading,registerLocale,registerMap:registerMap$1,registerPostInit,registerPostUpdate,registerPreprocessor,registerProcessor,registerTheme,registerTransform,registerUpdateLifecycle,registerVisual,setCanvasCreator,setPlatformAPI,throttle,time,use,util,vector,version,zrUtil:util$1,zrender},Symbol.toStringTag,{value:"Module"}));var lib={},sensorPool={},id={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=1,o=function(){return"".concat(a++)};s.default=o})(id);var sensors={},object={},debounce={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,tt=null;return function(){for(var nt=this,it=arguments.length,st=new Array(it),ut=0;ut<it;ut++)st[ut]=arguments[ut];clearTimeout(tt),tt=setTimeout(function(){c.apply(nt,st)},d)}};s.default=a})(debounce);var constant={};Object.defineProperty(constant,"__esModule",{value:!0});constant.SizeSensorId=constant.SensorTabIndex=constant.SensorClassName=void 0;var SizeSensorId="size-sensor-id";constant.SizeSensorId=SizeSensorId;var SensorClassName="size-sensor-object";constant.SensorClassName=SensorClassName;var SensorTabIndex="-1";constant.SensorTabIndex=SensorTabIndex;Object.defineProperty(object,"__esModule",{value:!0});object.createSensor=void 0;var _debounce$1=_interopRequireDefault$2(debounce),_constant$2=constant;function _interopRequireDefault$2(s){return s&&s.__esModule?s:{default:s}}var createSensor$2=function s(a,o){var c=void 0,d=[],tt=function(){getComputedStyle(a).position==="static"&&(a.style.position="relative");var ot=document.createElement("object");return ot.onload=function(){ot.contentDocument.defaultView.addEventListener("resize",nt),nt()},ot.style.display="block",ot.style.position="absolute",ot.style.top="0",ot.style.left="0",ot.style.height="100%",ot.style.width="100%",ot.style.overflow="hidden",ot.style.pointerEvents="none",ot.style.zIndex="-1",ot.style.opacity="0",ot.setAttribute("class",_constant$2.SensorClassName),ot.setAttribute("tabindex",_constant$2.SensorTabIndex),ot.type="text/html",a.appendChild(ot),ot.data="about:blank",ot},nt=(0,_debounce$1.default)(function(){d.forEach(function(ct){ct(a)})}),it=function(ot){c||(c=tt()),d.indexOf(ot)===-1&&d.push(ot)},st=function(){c&&c.parentNode&&(c.contentDocument&&c.contentDocument.defaultView.removeEventListener("resize",nt),c.parentNode.removeChild(c),a.removeAttribute(_constant$2.SizeSensorId),c=void 0,d=[],o&&o())},ut=function(ot){var at=d.indexOf(ot);at!==-1&&d.splice(at,1),d.length===0&&c&&st()};return{element:a,bind:it,destroy:st,unbind:ut}};object.createSensor=createSensor$2;var resizeObserver={};Object.defineProperty(resizeObserver,"__esModule",{value:!0});resizeObserver.createSensor=void 0;var _constant$1=constant,_debounce=_interopRequireDefault$1(debounce);function _interopRequireDefault$1(s){return s&&s.__esModule?s:{default:s}}var createSensor$1=function s(a,o){var c=void 0,d=[],tt=(0,_debounce.default)(function(){d.forEach(function(ct){ct(a)})}),nt=function(){var ot=new ResizeObserver(tt);return ot.observe(a),tt(),ot},it=function(ot){c||(c=nt()),d.indexOf(ot)===-1&&d.push(ot)},st=function(){c.disconnect(),d=[],c=void 0,a.removeAttribute(_constant$1.SizeSensorId),o&&o()},ut=function(ot){var at=d.indexOf(ot);at!==-1&&d.splice(at,1),d.length===0&&c&&st()};return{element:a,bind:it,destroy:st,unbind:ut}};resizeObserver.createSensor=createSensor$1;Object.defineProperty(sensors,"__esModule",{value:!0});sensors.createSensor=void 0;var _object=object,_resizeObserver=resizeObserver,createSensor=typeof ResizeObserver<"u"?_resizeObserver.createSensor:_object.createSensor;sensors.createSensor=createSensor;Object.defineProperty(sensorPool,"__esModule",{value:!0});sensorPool.removeSensor=sensorPool.getSensor=sensorPool.Sensors=void 0;var _id=_interopRequireDefault(id),_sensors=sensors,_constant=constant;function _interopRequireDefault(s){return s&&s.__esModule?s:{default:s}}var Sensors={};sensorPool.Sensors=Sensors;function clean(s){s&&Sensors[s]&&delete Sensors[s]}var getSensor=function s(a){var o=a.getAttribute(_constant.SizeSensorId);if(o&&Sensors[o])return Sensors[o];var c=(0,_id.default)();a.setAttribute(_constant.SizeSensorId,c);var d=(0,_sensors.createSensor)(a,function(){return clean(c)});return Sensors[c]=d,d};sensorPool.getSensor=getSensor;var removeSensor=function s(a){var o=a.element.getAttribute(_constant.SizeSensorId);a.destroy(),clean(o)};sensorPool.removeSensor=removeSensor;Object.defineProperty(lib,"__esModule",{value:!0});lib.ver=clear_1=lib.clear=bind_1=lib.bind=void 0;var _sensorPool=sensorPool,bind=function s(a,o){var c=(0,_sensorPool.getSensor)(a);return c.bind(o),function(){c.unbind(o)}},bind_1=lib.bind=bind,clear=function s(a){var o=(0,_sensorPool.getSensor)(a);(0,_sensorPool.removeSensor)(o)},clear_1=lib.clear=clear,ver="1.0.2";lib.ver=ver;function pick(s,a){var o={};return a.forEach(function(c){o[c]=s[c]}),o}function isFunction(s){return typeof s=="function"}function isString(s){return typeof s=="string"}var fastDeepEqual=function s(a,o){if(a===o)return!0;if(a&&o&&typeof a=="object"&&typeof o=="object"){if(a.constructor!==o.constructor)return!1;var c,d,tt;if(Array.isArray(a)){if(c=a.length,c!=o.length)return!1;for(d=c;d--!==0;)if(!s(a[d],o[d]))return!1;return!0}if(a.constructor===RegExp)return a.source===o.source&&a.flags===o.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===o.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===o.toString();if(tt=Object.keys(a),c=tt.length,c!==Object.keys(o).length)return!1;for(d=c;d--!==0;)if(!Object.prototype.hasOwnProperty.call(o,tt[d]))return!1;for(d=c;d--!==0;){var nt=tt[d];if(!s(a[nt],o[nt]))return!1}return!0}return a!==a&&o!==o};const isEqual=getDefaultExportFromCjs(fastDeepEqual);var EChartsReactCore=function(s){__extends$2(a,s);function a(o){var c=s.call(this,o)||this;return c.echarts=o.echarts,c.ele=null,c.isInitialResize=!0,c}return a.prototype.componentDidMount=function(){this.renderNewEcharts()},a.prototype.componentDidUpdate=function(o){var c=this.props.shouldSetOption;if(!(isFunction(c)&&!c(o,this.props))){if(!isEqual(o.theme,this.props.theme)||!isEqual(o.opts,this.props.opts)||!isEqual(o.onEvents,this.props.onEvents)){this.dispose(),this.renderNewEcharts();return}var d=["option","notMerge","lazyUpdate","showLoading","loadingOption"];isEqual(pick(this.props,d),pick(o,d))||this.updateEChartsOption(),(!isEqual(o.style,this.props.style)||!isEqual(o.className,this.props.className))&&this.resize()}},a.prototype.componentWillUnmount=function(){this.dispose()},a.prototype.getEchartsInstance=function(){return this.echarts.getInstanceByDom(this.ele)||this.echarts.init(this.ele,this.props.theme,this.props.opts)},a.prototype.dispose=function(){if(this.ele){try{clear_1(this.ele)}catch(o){console.warn(o)}this.echarts.dispose(this.ele)}},a.prototype.renderNewEcharts=function(){var o=this,c=this.props,d=c.onEvents,tt=c.onChartReady,nt=this.updateEChartsOption();this.bindEvents(nt,d||{}),isFunction(tt)&&tt(nt),this.ele&&bind_1(this.ele,function(){o.resize()})},a.prototype.bindEvents=function(o,c){function d(nt,it){isString(nt)&&isFunction(it)&&o.on(nt,function(st){it(st,o)})}for(var tt in c)Object.prototype.hasOwnProperty.call(c,tt)&&d(tt,c[tt])},a.prototype.updateEChartsOption=function(){var o=this.props,c=o.option,d=o.notMerge,tt=d===void 0?!1:d,nt=o.lazyUpdate,it=nt===void 0?!1:nt,st=o.showLoading,ut=o.loadingOption,ct=ut===void 0?null:ut,ot=this.getEchartsInstance();return ot.setOption(c,tt,it),st?ot.showLoading(ct):ot.hideLoading(),ot},a.prototype.resize=function(){var o=this.getEchartsInstance();if(!this.isInitialResize)try{o.resize()}catch(c){console.warn(c)}this.isInitialResize=!1},a.prototype.render=function(){var o=this,c=this.props,d=c.style,tt=c.className,nt=tt===void 0?"":tt,it=__assign({height:300},d);return React$2.createElement("div",{ref:function(st){o.ele=st},style:it,className:"echarts-for-react "+nt})},a}(reactExports.PureComponent),EChartsReact=function(s){__extends$2(a,s);function a(o){var c=s.call(this,o)||this;return c.echarts=echarts,c}return a}(EChartsReactCore);const qstr$2=s=>!s||s.length===0?"":s.map(a=>typeof a=="number"?a:`'${String(a)}'`).join(",");function Block1Trend(){const{filters:s}=useFilters(),[a,o]=reactExports.useState([]),[c,d]=reactExports.useState({mode:"monthly"}),tt=reactExports.useMemo(()=>{const it=[];return s.years?.length&&it.push(`AN IN (${qstr$2(s.years)})`),s.months?.length&&it.push(`month IN (${qstr$2(s.months)})`),s.quarters?.length&&it.push(`quarter IN (${qstr$2(s.quarters)})`),s.dows?.length&&it.push(`CAST(JR_SEMN_ACCDN AS VARCHAR) IN (${qstr$2(s.dows)})`),s.severities?.length&&it.push(`GRAVITE IN (${qstr$2(s.severities)})`),s.quartiers?.length&&it.push(`no_qr IN (${qstr$2(s.quartiers)})`),s.arrs?.length&&it.push(`no_arr IN (${qstr$2(s.arrs)})`),it.length?"WHERE "+it.join(" AND "):""},[s]);reactExports.useEffect(()=>{let it=!1;async function st(){const ut=["date","DATE","dt_accdn","DT_ACCDN"];let ct,ot=null;for(const ft of ut)try{const mt=await parquetQuery(`
            SELECT CAST(${ft} AS DATE) AS d, COUNT(*)::INT AS n
            FROM read_parquet('${PARQUET.incidentVars}')
            ${tt}
            GROUP BY d
            ORDER BY d
          `);if(mt&&mt.length){ot=mt.map(yt=>({t:yt.d,n:yt.n})),ct=ft;break}}catch{}if(!ot){const mt=(await parquetQuery(`
          SELECT AN AS y, month AS m, COUNT(*)::INT AS n
          FROM read_parquet('${PARQUET.incidentVars}')
          ${tt}
          GROUP BY y, m
          ORDER BY y, m
        `)).map(wt=>({t:`${wt.y}-${String(wt.m).padStart(2,"0")}-01`,n:wt.n})),yt=rolling(mt,3),bt=rolling(mt,12);it||(o([{label:"Monthly total (proxy for Daily)",data:mt.map(wt=>[wt.t,wt.n])},{label:"Monthly avg (3m)",data:yt.map(wt=>[wt.t,wt.n])},{label:"Yearly avg (12m)",data:bt.map(wt=>[wt.t,wt.n])}]),d({mode:"monthly"}),window.__DBG_TREND={mode:"monthly",count:mt.length,first:mt[0],last:mt.at(-1)});return}const at=rolling(ot,30),ht=rolling(ot,365);it||(o([{label:"Daily",data:ot.map(ft=>[ft.t,ft.n])},{label:"Monthly avg (~30d)",data:at.map(ft=>[ft.t,ft.n])},{label:"Yearly avg (~365d)",data:ht.map(ft=>[ft.t,ft.n])}]),d({mode:"daily",dailyCol:ct}),window.__DBG_TREND={mode:"daily",dailyCol:ct,count:ot.length,first:ot[0],last:ot.at(-1)})}return st(),()=>{it=!0}},[tt]);const nt=reactExports.useMemo(()=>({tooltip:{trigger:"axis"},legend:{top:0,data:a.map(it=>it.label)},grid:{left:50,right:20,top:40,bottom:50,containLabel:!0},xAxis:{type:"time",axisLabel:{formatter:it=>new Date(it).toISOString().slice(0,10)}},yAxis:{type:"value"},series:a.map(it=>({name:it.label,type:"line",showSymbol:!1,data:it.data}))}),[a]);return jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsx("div",{className:"card-body",children:jsxRuntimeExports.jsx(EChartsReact,{option:nt,theme:"noir",style:{width:"100%",height:440},notMerge:!0,opts:{renderer:"canvas"}})})})}function rolling(s,a){const o=[];let c=0;const d=[];return s.forEach(tt=>{d.push(tt.n),c+=tt.n,d.length>a&&(c-=d.shift());const nt=Math.round(c/d.length);o.push({t:tt.t,n:nt})}),o}const qstr$1=s=>!s||s.length===0?"":s.map(a=>typeof a=="number"?a:`'${String(a)}'`).join(","),DOW_LABEL=s=>{const a=String(s),o=Number(a);if(!Number.isNaN(o)){const c=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];if(o>=1&&o<=7)return c[(o-1)%7];if(o>=0&&o<=6)return c[o]}return a};function Block2Heatmap(){const{filters:s}=useFilters(),[a,o]=reactExports.useState("hour"),[c,d]=reactExports.useState([]),[tt,nt]=reactExports.useState(null),it=reactExports.useMemo(()=>{const ht=[];return s.years?.length&&ht.push(`AN IN (${qstr$1(s.years)})`),s.severities?.length&&ht.push(`GRAVITE IN (${qstr$1(s.severities)})`),s.quartiers?.length&&ht.push(`no_qr IN (${qstr$1(s.quartiers)})`),s.arrs?.length&&ht.push(`no_arr IN (${qstr$1(s.arrs)})`),ht.length?"WHERE "+ht.join(" AND "):""},[s]);reactExports.useEffect(()=>{let ht=!1;async function ft(){nt(null);const mt=a==="hour"?"hour":"month",yt=a==="hour"?"hour IS NOT NULL":"month IS NOT NULL";try{const bt=await parquetQuery(`
          SELECT JR_SEMN_ACCDN AS dow,
                 ${mt} AS col,
                 CAST(COUNT(*) AS INT) AS value
          FROM read_parquet('${PARQUET.incidentVars}')
          ${it}
          ${it?"AND":"WHERE"} ${yt}
          GROUP BY dow, col
          ORDER BY dow, col
        `);ht||d(bt)}catch(bt){nt(bt?.message||String(bt)),ht||d([])}window.__DBG_HEAT={mode:a,where:it,count:c.length,sample:c.slice(0,5),error:tt}}return ft(),()=>{ht=!0}},[a,it]);const st=reactExports.useMemo(()=>Array.from(new Set(c.map(ht=>Number(ht.col)))).sort((ht,ft)=>ht-ft),[c]),ut=reactExports.useMemo(()=>Array.from(new Set(c.map(ht=>ht.dow))),[c]),ct=reactExports.useMemo(()=>ut.map(DOW_LABEL),[ut]),ot=reactExports.useMemo(()=>c.map(ht=>[st.indexOf(Number(ht.col)),ct.indexOf(DOW_LABEL(ht.dow)),ht.value]),[c,st,ct]),at=reactExports.useMemo(()=>({tooltip:{position:"top",formatter:ht=>`${ct[ht.value[1]]} × ${st[ht.value[0]]}: ${ht.value[2]}`},grid:{left:60,right:20,top:40,bottom:64,containLabel:!0},xAxis:{type:"category",data:st,name:a==="hour"?"Hour":"Month",nameGap:10},yAxis:{type:"category",data:ct,name:"Day of week",nameGap:10},visualMap:{min:0,max:Math.max(1,...c.map(ht=>ht.value)),calculable:!0,orient:"horizontal",left:"center",bottom:8,textStyle:{color:"#EDEDED"}},series:c.length?[{type:"heatmap",data:ot,progressive:0,emphasis:{itemStyle:{borderColor:"#333"}}}]:[]}),[st,ct,ot,c,a]);return jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsxs("div",{className:"card-body",children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"radio",checked:a==="hour",onChange:()=>o("hour")})," DoW × Hour"]}),jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"radio",checked:a==="month",onChange:()=>o("month")})," DoW × Month"]})]}),tt&&jsxRuntimeExports.jsxs("div",{style:{color:"#b71c1c",marginBottom:8},children:["Heatmap error: ",String(tt)]}),jsxRuntimeExports.jsx(EChartsReact,{option:at,theme:"noir",style:{width:"100%",height:400},notMerge:!0,opts:{renderer:"canvas"}})]})})}var maplibreGl={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(s,a){(function(o,c){s.exports=c()})(commonjsGlobal,function(){var o={},c={};function d(nt,it,st){if(c[nt]=st,nt==="index"){var ut="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",ct={};return c.shared(ct),c.index(o,ct),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([ut],{type:"text/javascript"}))),o}}d("shared",["exports"],function(nt){function it(gt,pt,vt,St){return new(vt||(vt=Promise))(function(Et,Rt){function Lt(jt){try{zt(St.next(jt))}catch(Wt){Rt(Wt)}}function Nt(jt){try{zt(St.throw(jt))}catch(Wt){Rt(Wt)}}function zt(jt){var Wt;jt.done?Et(jt.value):(Wt=jt.value,Wt instanceof vt?Wt:new vt(function(qt){qt(Wt)})).then(Lt,Nt)}zt((St=St.apply(gt,pt||[])).next())})}function st(gt){return gt&&gt.__esModule&&Object.prototype.hasOwnProperty.call(gt,"default")?gt.default:gt}typeof SuppressedError=="function"&&SuppressedError;var ut=ct;function ct(gt,pt){this.x=gt,this.y=pt}ct.prototype={clone:function(){return new ct(this.x,this.y)},add:function(gt){return this.clone()._add(gt)},sub:function(gt){return this.clone()._sub(gt)},multByPoint:function(gt){return this.clone()._multByPoint(gt)},divByPoint:function(gt){return this.clone()._divByPoint(gt)},mult:function(gt){return this.clone()._mult(gt)},div:function(gt){return this.clone()._div(gt)},rotate:function(gt){return this.clone()._rotate(gt)},rotateAround:function(gt,pt){return this.clone()._rotateAround(gt,pt)},matMult:function(gt){return this.clone()._matMult(gt)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(gt){return this.x===gt.x&&this.y===gt.y},dist:function(gt){return Math.sqrt(this.distSqr(gt))},distSqr:function(gt){var pt=gt.x-this.x,vt=gt.y-this.y;return pt*pt+vt*vt},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(gt){return Math.atan2(this.y-gt.y,this.x-gt.x)},angleWith:function(gt){return this.angleWithSep(gt.x,gt.y)},angleWithSep:function(gt,pt){return Math.atan2(this.x*pt-this.y*gt,this.x*gt+this.y*pt)},_matMult:function(gt){var pt=gt[2]*this.x+gt[3]*this.y;return this.x=gt[0]*this.x+gt[1]*this.y,this.y=pt,this},_add:function(gt){return this.x+=gt.x,this.y+=gt.y,this},_sub:function(gt){return this.x-=gt.x,this.y-=gt.y,this},_mult:function(gt){return this.x*=gt,this.y*=gt,this},_div:function(gt){return this.x/=gt,this.y/=gt,this},_multByPoint:function(gt){return this.x*=gt.x,this.y*=gt.y,this},_divByPoint:function(gt){return this.x/=gt.x,this.y/=gt.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var gt=this.y;return this.y=this.x,this.x=-gt,this},_rotate:function(gt){var pt=Math.cos(gt),vt=Math.sin(gt),St=vt*this.x+pt*this.y;return this.x=pt*this.x-vt*this.y,this.y=St,this},_rotateAround:function(gt,pt){var vt=Math.cos(gt),St=Math.sin(gt),Et=pt.y+St*(this.x-pt.x)+vt*(this.y-pt.y);return this.x=pt.x+vt*(this.x-pt.x)-St*(this.y-pt.y),this.y=Et,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ct.convert=function(gt){return gt instanceof ct?gt:Array.isArray(gt)?new ct(gt[0],gt[1]):gt};var ot=st(ut),at=ht;function ht(gt,pt,vt,St){this.cx=3*gt,this.bx=3*(vt-gt)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*pt,this.by=3*(St-pt)-this.cy,this.ay=1-this.cy-this.by,this.p1x=gt,this.p1y=pt,this.p2x=vt,this.p2y=St}ht.prototype={sampleCurveX:function(gt){return((this.ax*gt+this.bx)*gt+this.cx)*gt},sampleCurveY:function(gt){return((this.ay*gt+this.by)*gt+this.cy)*gt},sampleCurveDerivativeX:function(gt){return(3*this.ax*gt+2*this.bx)*gt+this.cx},solveCurveX:function(gt,pt){if(pt===void 0&&(pt=1e-6),gt<0)return 0;if(gt>1)return 1;for(var vt=gt,St=0;St<8;St++){var Et=this.sampleCurveX(vt)-gt;if(Math.abs(Et)<pt)return vt;var Rt=this.sampleCurveDerivativeX(vt);if(Math.abs(Rt)<1e-6)break;vt-=Et/Rt}var Lt=0,Nt=1;for(vt=gt,St=0;St<20&&(Et=this.sampleCurveX(vt),!(Math.abs(Et-gt)<pt));St++)gt>Et?Lt=vt:Nt=vt,vt=.5*(Nt-Lt)+Lt;return vt},solve:function(gt,pt){return this.sampleCurveY(this.solveCurveX(gt,pt))}};var ft=st(at);let mt,yt;function bt(){return mt==null&&(mt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),mt}function wt(){if(yt==null&&(yt=!1,bt())){const pt=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(pt){for(let St=0;St<5*5;St++){const Et=4*St;pt.fillStyle=`rgb(${Et},${Et+1},${Et+2})`,pt.fillRect(St%5,Math.floor(St/5),1,1)}const vt=pt.getImageData(0,0,5,5).data;for(let St=0;St<5*5*4;St++)if(St%4!=3&&vt[St]!==St){yt=!0;break}}}return yt||!1}function Tt(gt,pt,vt,St){const Et=new ft(gt,pt,vt,St);return Rt=>Et.solve(Rt)}const Ct=Tt(.25,.1,.25,1);function Dt(gt,pt,vt){return Math.min(vt,Math.max(pt,gt))}function Ot(gt,pt,vt){const St=vt-pt,Et=((gt-pt)%St+St)%St+pt;return Et===pt?vt:Et}function $t(gt,...pt){for(const vt of pt)for(const St in vt)gt[St]=vt[St];return gt}let Ft=1;function kt(gt,pt,vt){const St={};for(const Et in gt)St[Et]=pt.call(this,gt[Et],Et,gt);return St}function Vt(gt,pt,vt){const St={};for(const Et in gt)pt.call(this,gt[Et],Et,gt)&&(St[Et]=gt[Et]);return St}function Ht(gt){return Array.isArray(gt)?gt.map(Ht):typeof gt=="object"&&gt?kt(gt,Ht):gt}const Qt={};function Xt(gt){Qt[gt]||(typeof console<"u"&&console.warn(gt),Qt[gt]=!0)}function Zt(gt,pt,vt){return(vt.y-gt.y)*(pt.x-gt.x)>(pt.y-gt.y)*(vt.x-gt.x)}function ar(gt){return typeof WorkerGlobalScope<"u"&&gt!==void 0&&gt instanceof WorkerGlobalScope}let nr=null;function cr(gt){return typeof ImageBitmap<"u"&&gt instanceof ImageBitmap}const dr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function mr(gt,pt,vt,St,Et){return it(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const Rt=new VideoFrame(gt,{timestamp:0});try{const Lt=Rt?.format;if(!Lt||!Lt.startsWith("BGR")&&!Lt.startsWith("RGB"))throw new Error(`Unrecognized format ${Lt}`);const Nt=Lt.startsWith("BGR"),zt=new Uint8ClampedArray(St*Et*4);if(yield Rt.copyTo(zt,function(jt,Wt,qt,ir,or){const lr=4*Math.max(-Wt,0),pr=(Math.max(0,qt)-qt)*ir*4+lr,Tr=4*ir,Ir=Math.max(0,Wt),Wr=Math.max(0,qt);return{rect:{x:Ir,y:Wr,width:Math.min(jt.width,Wt+ir)-Ir,height:Math.min(jt.height,qt+or)-Wr},layout:[{offset:pr,stride:Tr}]}}(gt,pt,vt,St,Et)),Nt)for(let jt=0;jt<zt.length;jt+=4){const Wt=zt[jt];zt[jt]=zt[jt+2],zt[jt+2]=Wt}return zt}finally{Rt.close()}})}let Dr,kr;const Yr="AbortError";function Mr(){return new Error(Yr)}const Jr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function an(gt){return Jr.REGISTERED_PROTOCOLS[gt.substring(0,gt.indexOf("://"))]}const xn="global-dispatcher";class Rn extends Error{constructor(pt,vt,St,Et){super(`AJAXError: ${vt} (${pt}): ${St}`),this.status=pt,this.statusText=vt,this.url=St,this.body=Et}}const hn=()=>ar(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,pn=function(gt,pt){if(/:\/\//.test(gt.url)&&!/^https?:|^file:/.test(gt.url)){const St=an(gt.url);if(St)return St(gt,pt);if(ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:gt,targetMapId:xn},pt)}if(!(/^file:/.test(vt=gt.url)||/^file:/.test(hn())&&!/^\w+:/.test(vt))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(St,Et){return it(this,void 0,void 0,function*(){const Rt=new Request(St.url,{method:St.method||"GET",body:St.body,credentials:St.credentials,headers:St.headers,cache:St.cache,referrer:hn(),signal:Et.signal});St.type!=="json"||Rt.headers.has("Accept")||Rt.headers.set("Accept","application/json");const Lt=yield fetch(Rt);if(!Lt.ok){const jt=yield Lt.blob();throw new Rn(Lt.status,Lt.statusText,St.url,jt)}let Nt;Nt=St.type==="arrayBuffer"||St.type==="image"?Lt.arrayBuffer():St.type==="json"?Lt.json():Lt.text();const zt=yield Nt;if(Et.signal.aborted)throw Mr();return{data:zt,cacheControl:Lt.headers.get("Cache-Control"),expires:Lt.headers.get("Expires")}})}(gt,pt);if(ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:gt,mustQueue:!0,targetMapId:xn},pt)}var vt;return function(St,Et){return new Promise((Rt,Lt)=>{var Nt;const zt=new XMLHttpRequest;zt.open(St.method||"GET",St.url,!0),St.type!=="arrayBuffer"&&St.type!=="image"||(zt.responseType="arraybuffer");for(const jt in St.headers)zt.setRequestHeader(jt,St.headers[jt]);St.type==="json"&&(zt.responseType="text",!((Nt=St.headers)===null||Nt===void 0)&&Nt.Accept||zt.setRequestHeader("Accept","application/json")),zt.withCredentials=St.credentials==="include",zt.onerror=()=>{Lt(new Error(zt.statusText))},zt.onload=()=>{if(!Et.signal.aborted)if((zt.status>=200&&zt.status<300||zt.status===0)&&zt.response!==null){let jt=zt.response;if(St.type==="json")try{jt=JSON.parse(zt.response)}catch(Wt){return void Lt(Wt)}Rt({data:jt,cacheControl:zt.getResponseHeader("Cache-Control"),expires:zt.getResponseHeader("Expires")})}else{const jt=new Blob([zt.response],{type:zt.getResponseHeader("Content-Type")});Lt(new Rn(zt.status,zt.statusText,St.url,jt))}},Et.signal.addEventListener("abort",()=>{zt.abort(),Lt(Mr())}),zt.send(St.body)})}(gt,pt)};function yn(gt){if(!gt||gt.indexOf("://")<=0||gt.indexOf("data:image/")===0||gt.indexOf("blob:")===0)return!0;const pt=new URL(gt),vt=window.location;return pt.protocol===vt.protocol&&pt.host===vt.host}function un(gt,pt,vt){vt[gt]&&vt[gt].indexOf(pt)!==-1||(vt[gt]=vt[gt]||[],vt[gt].push(pt))}function fn(gt,pt,vt){if(vt&&vt[gt]){const St=vt[gt].indexOf(pt);St!==-1&&vt[gt].splice(St,1)}}class Bn{constructor(pt,vt={}){$t(this,vt),this.type=pt}}class Dn extends Bn{constructor(pt,vt={}){super("error",$t({error:pt},vt))}}class Qn{on(pt,vt){return this._listeners=this._listeners||{},un(pt,vt,this._listeners),this}off(pt,vt){return fn(pt,vt,this._listeners),fn(pt,vt,this._oneTimeListeners),this}once(pt,vt){return vt?(this._oneTimeListeners=this._oneTimeListeners||{},un(pt,vt,this._oneTimeListeners),this):new Promise(St=>this.once(pt,St))}fire(pt,vt){typeof pt=="string"&&(pt=new Bn(pt,vt||{}));const St=pt.type;if(this.listens(St)){pt.target=this;const Et=this._listeners&&this._listeners[St]?this._listeners[St].slice():[];for(const Nt of Et)Nt.call(this,pt);const Rt=this._oneTimeListeners&&this._oneTimeListeners[St]?this._oneTimeListeners[St].slice():[];for(const Nt of Rt)fn(St,Nt,this._oneTimeListeners),Nt.call(this,pt);const Lt=this._eventedParent;Lt&&($t(pt,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Lt.fire(pt))}else pt instanceof Dn&&console.error(pt.error);return this}listens(pt){return this._listeners&&this._listeners[pt]&&this._listeners[pt].length>0||this._oneTimeListeners&&this._oneTimeListeners[pt]&&this._oneTimeListeners[pt].length>0||this._eventedParent&&this._eventedParent.listens(pt)}setEventedParent(pt,vt){return this._eventedParent=pt,this._eventedParentData=vt,this}}var zr={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ao=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oo(gt,pt){const vt={};for(const St in gt)St!=="ref"&&(vt[St]=gt[St]);return ao.forEach(St=>{St in pt&&(vt[St]=pt[St])}),vt}function Wn(gt,pt){if(Array.isArray(gt)){if(!Array.isArray(pt)||gt.length!==pt.length)return!1;for(let vt=0;vt<gt.length;vt++)if(!Wn(gt[vt],pt[vt]))return!1;return!0}if(typeof gt=="object"&&gt!==null&&pt!==null){if(typeof pt!="object"||Object.keys(gt).length!==Object.keys(pt).length)return!1;for(const vt in gt)if(!Wn(gt[vt],pt[vt]))return!1;return!0}return gt===pt}function no(gt,pt){gt.push(pt)}function Eo(gt,pt,vt){no(vt,{command:"addSource",args:[gt,pt[gt]]})}function xo(gt,pt,vt){no(pt,{command:"removeSource",args:[gt]}),vt[gt]=!0}function Mo(gt,pt,vt,St){xo(gt,vt,St),Eo(gt,pt,vt)}function ls(gt,pt,vt){let St;for(St in gt[vt])if(Object.prototype.hasOwnProperty.call(gt[vt],St)&&St!=="data"&&!Wn(gt[vt][St],pt[vt][St]))return!1;for(St in pt[vt])if(Object.prototype.hasOwnProperty.call(pt[vt],St)&&St!=="data"&&!Wn(gt[vt][St],pt[vt][St]))return!1;return!0}function eo(gt,pt,vt,St,Et,Rt){gt=gt||{},pt=pt||{};for(const Lt in gt)Object.prototype.hasOwnProperty.call(gt,Lt)&&(Wn(gt[Lt],pt[Lt])||vt.push({command:Rt,args:[St,Lt,pt[Lt],Et]}));for(const Lt in pt)Object.prototype.hasOwnProperty.call(pt,Lt)&&!Object.prototype.hasOwnProperty.call(gt,Lt)&&(Wn(gt[Lt],pt[Lt])||vt.push({command:Rt,args:[St,Lt,pt[Lt],Et]}))}function wl(gt){return gt.id}function qs(gt,pt){return gt[pt.id]=pt,gt}class gn{constructor(pt,vt,St,Et){this.message=(pt?`${pt}: `:"")+St,Et&&(this.identifier=Et),vt!=null&&vt.__line__&&(this.line=vt.__line__)}}function Jo(gt,...pt){for(const vt of pt)for(const St in vt)gt[St]=vt[St];return gt}class Wo extends Error{constructor(pt,vt){super(vt),this.message=vt,this.key=pt}}class us{constructor(pt,vt=[]){this.parent=pt,this.bindings={};for(const[St,Et]of vt)this.bindings[St]=Et}concat(pt){return new us(this,pt)}get(pt){if(this.bindings[pt])return this.bindings[pt];if(this.parent)return this.parent.get(pt);throw new Error(`${pt} not found in scope.`)}has(pt){return!!this.bindings[pt]||!!this.parent&&this.parent.has(pt)}}const ko={kind:"null"},_n={kind:"number"},bn={kind:"string"},Zn={kind:"boolean"},ts={kind:"color"},ms={kind:"object"},Kn={kind:"value"},co={kind:"collator"},cs={kind:"formatted"},Ms={kind:"padding"},ns={kind:"resolvedImage"},yr={kind:"variableAnchorOffsetCollection"};function er(gt,pt){return{kind:"array",itemType:gt,N:pt}}function tr(gt){if(gt.kind==="array"){const pt=tr(gt.itemType);return typeof gt.N=="number"?`array<${pt}, ${gt.N}>`:gt.itemType.kind==="value"?"array":`array<${pt}>`}return gt.kind}const fr=[ko,_n,bn,Zn,ts,cs,ms,er(Kn),Ms,ns,yr];function wr(gt,pt){if(pt.kind==="error")return null;if(gt.kind==="array"){if(pt.kind==="array"&&(pt.N===0&&pt.itemType.kind==="value"||!wr(gt.itemType,pt.itemType))&&(typeof gt.N!="number"||gt.N===pt.N))return null}else{if(gt.kind===pt.kind)return null;if(gt.kind==="value"){for(const vt of fr)if(!wr(vt,pt))return null}}return`Expected ${tr(gt)} but found ${tr(pt)} instead.`}function Lr(gt,pt){return pt.some(vt=>vt.kind===gt.kind)}function Fr(gt,pt){return pt.some(vt=>vt==="null"?gt===null:vt==="array"?Array.isArray(gt):vt==="object"?gt&&!Array.isArray(gt)&&typeof gt=="object":vt===typeof gt)}function Hr(gt,pt){return gt.kind==="array"&&pt.kind==="array"?gt.itemType.kind===pt.itemType.kind&&typeof gt.N=="number":gt.kind===pt.kind}const Pr=.96422,Qr=.82521,sn=4/29,Kr=6/29,vn=3*Kr*Kr,zn=Kr*Kr*Kr,Yn=Math.PI/180,po=180/Math.PI;function ga(gt){return(gt%=360)<0&&(gt+=360),gt}function ur([gt,pt,vt,St]){let Et,Rt;const Lt=Nr((.2225045*(gt=br(gt))+.7168786*(pt=br(pt))+.0606169*(vt=br(vt)))/1);gt===pt&&pt===vt?Et=Rt=Lt:(Et=Nr((.4360747*gt+.3850649*pt+.1430804*vt)/Pr),Rt=Nr((.0139322*gt+.0971045*pt+.7141733*vt)/Qr));const Nt=116*Lt-16;return[Nt<0?0:Nt,500*(Et-Lt),200*(Lt-Rt),St]}function br(gt){return gt<=.04045?gt/12.92:Math.pow((gt+.055)/1.055,2.4)}function Nr(gt){return gt>zn?Math.pow(gt,1/3):gt/vn+sn}function Ur([gt,pt,vt,St]){let Et=(gt+16)/116,Rt=isNaN(pt)?Et:Et+pt/500,Lt=isNaN(vt)?Et:Et-vt/200;return Et=1*Xr(Et),Rt=Pr*Xr(Rt),Lt=Qr*Xr(Lt),[Vr(3.1338561*Rt-1.6168667*Et-.4906146*Lt),Vr(-.9787684*Rt+1.9161415*Et+.033454*Lt),Vr(.0719453*Rt-.2289914*Et+1.4052427*Lt),St]}function Vr(gt){return(gt=gt<=.00304?12.92*gt:1.055*Math.pow(gt,1/2.4)-.055)<0?0:gt>1?1:gt}function Xr(gt){return gt>Kr?gt*gt*gt:vn*(gt-sn)}function cn(gt){return parseInt(gt.padEnd(2,gt),16)/255}function $n(gt,pt){return An(pt?gt/100:gt,0,1)}function An(gt,pt,vt){return Math.min(Math.max(pt,gt),vt)}function na(gt){return!gt.some(Number.isNaN)}const wo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ro{constructor(pt,vt,St,Et=1,Rt=!0){this.r=pt,this.g=vt,this.b=St,this.a=Et,Rt||(this.r*=Et,this.g*=Et,this.b*=Et,Et||this.overwriteGetter("rgb",[pt,vt,St,Et]))}static parse(pt){if(pt instanceof ro)return pt;if(typeof pt!="string")return;const vt=function(St){if((St=St.toLowerCase().trim())==="transparent")return[0,0,0,0];const Et=wo[St];if(Et){const[Lt,Nt,zt]=Et;return[Lt/255,Nt/255,zt/255,1]}if(St.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(St)){const Lt=St.length<6?1:2;let Nt=1;return[cn(St.slice(Nt,Nt+=Lt)),cn(St.slice(Nt,Nt+=Lt)),cn(St.slice(Nt,Nt+=Lt)),cn(St.slice(Nt,Nt+Lt)||"ff")]}if(St.startsWith("rgb")){const Lt=St.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Lt){const[Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir,Wr]=Lt,$r=[Wt||" ",or||" ",Tr].join("");if($r==="  "||$r==="  /"||$r===",,"||$r===",,,"){const jr=[jt,ir,pr].join(""),en=jr==="%%%"?100:jr===""?255:0;if(en){const dn=[An(+zt/en,0,1),An(+qt/en,0,1),An(+lr/en,0,1),Ir?$n(+Ir,Wr):1];if(na(dn))return dn}}return}}const Rt=St.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(Rt){const[Lt,Nt,zt,jt,Wt,qt,ir,or,lr]=Rt,pr=[zt||" ",Wt||" ",ir].join("");if(pr==="  "||pr==="  /"||pr===",,"||pr===",,,"){const Tr=[+Nt,An(+jt,0,100),An(+qt,0,100),or?$n(+or,lr):1];if(na(Tr))return function([Ir,Wr,$r,jr]){function en(dn){const Ln=(dn+Ir/30)%12,Jn=Wr*Math.min($r,1-$r);return $r-Jn*Math.max(-1,Math.min(Ln-3,9-Ln,1))}return Ir=ga(Ir),Wr/=100,$r/=100,[en(0),en(8),en(4),jr]}(Tr)}}}(pt);return vt?new ro(...vt,!1):void 0}get rgb(){const{r:pt,g:vt,b:St,a:Et}=this,Rt=Et||1/0;return this.overwriteGetter("rgb",[pt/Rt,vt/Rt,St/Rt,Et])}get hcl(){return this.overwriteGetter("hcl",function(pt){const[vt,St,Et,Rt]=ur(pt),Lt=Math.sqrt(St*St+Et*Et);return[Math.round(1e4*Lt)?ga(Math.atan2(Et,St)*po):NaN,Lt,vt,Rt]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ur(this.rgb))}overwriteGetter(pt,vt){return Object.defineProperty(this,pt,{value:vt}),vt}toString(){const[pt,vt,St,Et]=this.rgb;return`rgba(${[pt,vt,St].map(Rt=>Math.round(255*Rt)).join(",")},${Et})`}}ro.black=new ro(0,0,0,1),ro.white=new ro(1,1,1,1),ro.transparent=new ro(0,0,0,0),ro.red=new ro(1,0,0,1);class jo{constructor(pt,vt,St){this.sensitivity=pt?vt?"variant":"case":vt?"accent":"base",this.locale=St,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(pt,vt){return this.collator.compare(pt,vt)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class nn{constructor(pt,vt,St,Et,Rt){this.text=pt,this.image=vt,this.scale=St,this.fontStack=Et,this.textColor=Rt}}class to{constructor(pt){this.sections=pt}static fromString(pt){return new to([new nn(pt,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(pt=>pt.text.length!==0||pt.image&&pt.image.name.length!==0)}static factory(pt){return pt instanceof to?pt:to.fromString(pt)}toString(){return this.sections.length===0?"":this.sections.map(pt=>pt.text).join("")}}class mo{constructor(pt){this.values=pt.slice()}static parse(pt){if(pt instanceof mo)return pt;if(typeof pt=="number")return new mo([pt,pt,pt,pt]);if(Array.isArray(pt)&&!(pt.length<1||pt.length>4)){for(const vt of pt)if(typeof vt!="number")return;switch(pt.length){case 1:pt=[pt[0],pt[0],pt[0],pt[0]];break;case 2:pt=[pt[0],pt[1],pt[0],pt[1]];break;case 3:pt=[pt[0],pt[1],pt[2],pt[1]]}return new mo(pt)}}toString(){return JSON.stringify(this.values)}}const Rs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Yo{constructor(pt){this.values=pt.slice()}static parse(pt){if(pt instanceof Yo)return pt;if(Array.isArray(pt)&&!(pt.length<1)&&pt.length%2==0){for(let vt=0;vt<pt.length;vt+=2){const St=pt[vt],Et=pt[vt+1];if(typeof St!="string"||!Rs.has(St)||!Array.isArray(Et)||Et.length!==2||typeof Et[0]!="number"||typeof Et[1]!="number")return}return new Yo(pt)}}toString(){return JSON.stringify(this.values)}}class hs{constructor(pt){this.name=pt.name,this.available=pt.available}toString(){return this.name}static fromString(pt){return pt?new hs({name:pt,available:!1}):null}}function Ol(gt,pt,vt,St){return typeof gt=="number"&&gt>=0&&gt<=255&&typeof pt=="number"&&pt>=0&&pt<=255&&typeof vt=="number"&&vt>=0&&vt<=255?St===void 0||typeof St=="number"&&St>=0&&St<=1?null:`Invalid rgba value [${[gt,pt,vt,St].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof St=="number"?[gt,pt,vt,St]:[gt,pt,vt]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function $l(gt){if(gt===null||typeof gt=="string"||typeof gt=="boolean"||typeof gt=="number"||gt instanceof ro||gt instanceof jo||gt instanceof to||gt instanceof mo||gt instanceof Yo||gt instanceof hs)return!0;if(Array.isArray(gt)){for(const pt of gt)if(!$l(pt))return!1;return!0}if(typeof gt=="object"){for(const pt in gt)if(!$l(gt[pt]))return!1;return!0}return!1}function To(gt){if(gt===null)return ko;if(typeof gt=="string")return bn;if(typeof gt=="boolean")return Zn;if(typeof gt=="number")return _n;if(gt instanceof ro)return ts;if(gt instanceof jo)return co;if(gt instanceof to)return cs;if(gt instanceof mo)return Ms;if(gt instanceof Yo)return yr;if(gt instanceof hs)return ns;if(Array.isArray(gt)){const pt=gt.length;let vt;for(const St of gt){const Et=To(St);if(vt){if(vt===Et)continue;vt=Kn;break}vt=Et}return er(vt||Kn,pt)}return ms}function Nl(gt){const pt=typeof gt;return gt===null?"":pt==="string"||pt==="number"||pt==="boolean"?String(gt):gt instanceof ro||gt instanceof to||gt instanceof mo||gt instanceof Yo||gt instanceof hs?gt.toString():JSON.stringify(gt)}class Ls{constructor(pt,vt){this.type=pt,this.value=vt}static parse(pt,vt){if(pt.length!==2)return vt.error(`'literal' expression requires exactly one argument, but found ${pt.length-1} instead.`);if(!$l(pt[1]))return vt.error("invalid value");const St=pt[1];let Et=To(St);const Rt=vt.expectedType;return Et.kind!=="array"||Et.N!==0||!Rt||Rt.kind!=="array"||typeof Rt.N=="number"&&Rt.N!==0||(Et=Rt),new Ls(Et,St)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Uo{constructor(pt){this.name="ExpressionEvaluationError",this.message=pt}toJSON(){return this.message}}const uu={string:bn,number:_n,boolean:Zn,object:ms};class Vs{constructor(pt,vt){this.type=pt,this.args=vt}static parse(pt,vt){if(pt.length<2)return vt.error("Expected at least one argument.");let St,Et=1;const Rt=pt[0];if(Rt==="array"){let Nt,zt;if(pt.length>2){const jt=pt[1];if(typeof jt!="string"||!(jt in uu)||jt==="object")return vt.error('The item type argument of "array" must be one of string, number, boolean',1);Nt=uu[jt],Et++}else Nt=Kn;if(pt.length>3){if(pt[2]!==null&&(typeof pt[2]!="number"||pt[2]<0||pt[2]!==Math.floor(pt[2])))return vt.error('The length argument to "array" must be a positive integer literal',2);zt=pt[2],Et++}St=er(Nt,zt)}else{if(!uu[Rt])throw new Error(`Types doesn't contain name = ${Rt}`);St=uu[Rt]}const Lt=[];for(;Et<pt.length;Et++){const Nt=vt.parse(pt[Et],Et,Kn);if(!Nt)return null;Lt.push(Nt)}return new Vs(St,Lt)}evaluate(pt){for(let vt=0;vt<this.args.length;vt++){const St=this.args[vt].evaluate(pt);if(!wr(this.type,To(St)))return St;if(vt===this.args.length-1)throw new Uo(`Expected value to be of type ${tr(this.type)}, but found ${tr(To(St))} instead.`)}throw new Error}eachChild(pt){this.args.forEach(pt)}outputDefined(){return this.args.every(pt=>pt.outputDefined())}}const lp={"to-boolean":Zn,"to-color":ts,"to-number":_n,"to-string":bn};class vs{constructor(pt,vt){this.type=pt,this.args=vt}static parse(pt,vt){if(pt.length<2)return vt.error("Expected at least one argument.");const St=pt[0];if(!lp[St])throw new Error(`Can't parse ${St} as it is not part of the known types`);if((St==="to-boolean"||St==="to-string")&&pt.length!==2)return vt.error("Expected one argument.");const Et=lp[St],Rt=[];for(let Lt=1;Lt<pt.length;Lt++){const Nt=vt.parse(pt[Lt],Lt,Kn);if(!Nt)return null;Rt.push(Nt)}return new vs(Et,Rt)}evaluate(pt){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(pt);case"color":{let vt,St;for(const Et of this.args){if(vt=Et.evaluate(pt),St=null,vt instanceof ro)return vt;if(typeof vt=="string"){const Rt=pt.parseColor(vt);if(Rt)return Rt}else if(Array.isArray(vt)&&(St=vt.length<3||vt.length>4?`Invalid rbga value ${JSON.stringify(vt)}: expected an array containing either three or four numeric values.`:Ol(vt[0],vt[1],vt[2],vt[3]),!St))return new ro(vt[0]/255,vt[1]/255,vt[2]/255,vt[3])}throw new Uo(St||`Could not parse color from value '${typeof vt=="string"?vt:JSON.stringify(vt)}'`)}case"padding":{let vt;for(const St of this.args){vt=St.evaluate(pt);const Et=mo.parse(vt);if(Et)return Et}throw new Uo(`Could not parse padding from value '${typeof vt=="string"?vt:JSON.stringify(vt)}'`)}case"variableAnchorOffsetCollection":{let vt;for(const St of this.args){vt=St.evaluate(pt);const Et=Yo.parse(vt);if(Et)return Et}throw new Uo(`Could not parse variableAnchorOffsetCollection from value '${typeof vt=="string"?vt:JSON.stringify(vt)}'`)}case"number":{let vt=null;for(const St of this.args){if(vt=St.evaluate(pt),vt===null)return 0;const Et=Number(vt);if(!isNaN(Et))return Et}throw new Uo(`Could not convert ${JSON.stringify(vt)} to number.`)}case"formatted":return to.fromString(Nl(this.args[0].evaluate(pt)));case"resolvedImage":return hs.fromString(Nl(this.args[0].evaluate(pt)));default:return Nl(this.args[0].evaluate(pt))}}eachChild(pt){this.args.forEach(pt)}outputDefined(){return this.args.every(pt=>pt.outputDefined())}}const up=["Unknown","Point","LineString","Polygon"];class cu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?up[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(pt){let vt=this._parseColorCache[pt];return vt||(vt=this._parseColorCache[pt]=ro.parse(pt)),vt}}class Fl{constructor(pt,vt,St=[],Et,Rt=new us,Lt=[]){this.registry=pt,this.path=St,this.key=St.map(Nt=>`[${Nt}]`).join(""),this.scope=Rt,this.errors=Lt,this.expectedType=Et,this._isConstant=vt}parse(pt,vt,St,Et,Rt={}){return vt?this.concat(vt,St,Et)._parse(pt,Rt):this._parse(pt,Rt)}_parse(pt,vt){function St(Et,Rt,Lt){return Lt==="assert"?new Vs(Rt,[Et]):Lt==="coerce"?new vs(Rt,[Et]):Et}if(pt!==null&&typeof pt!="string"&&typeof pt!="boolean"&&typeof pt!="number"||(pt=["literal",pt]),Array.isArray(pt)){if(pt.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const Et=pt[0];if(typeof Et!="string")return this.error(`Expression name must be a string, but found ${typeof Et} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const Rt=this.registry[Et];if(Rt){let Lt=Rt.parse(pt,this);if(!Lt)return null;if(this.expectedType){const Nt=this.expectedType,zt=Lt.type;if(Nt.kind!=="string"&&Nt.kind!=="number"&&Nt.kind!=="boolean"&&Nt.kind!=="object"&&Nt.kind!=="array"||zt.kind!=="value")if(Nt.kind!=="color"&&Nt.kind!=="formatted"&&Nt.kind!=="resolvedImage"||zt.kind!=="value"&&zt.kind!=="string")if(Nt.kind!=="padding"||zt.kind!=="value"&&zt.kind!=="number"&&zt.kind!=="array")if(Nt.kind!=="variableAnchorOffsetCollection"||zt.kind!=="value"&&zt.kind!=="array"){if(this.checkSubtype(Nt,zt))return null}else Lt=St(Lt,Nt,vt.typeAnnotation||"coerce");else Lt=St(Lt,Nt,vt.typeAnnotation||"coerce");else Lt=St(Lt,Nt,vt.typeAnnotation||"coerce");else Lt=St(Lt,Nt,vt.typeAnnotation||"assert")}if(!(Lt instanceof Ls)&&Lt.type.kind!=="resolvedImage"&&this._isConstant(Lt)){const Nt=new cu;try{Lt=new Ls(Lt.type,Lt.evaluate(Nt))}catch(zt){return this.error(zt.message),null}}return Lt}return this.error(`Unknown expression "${Et}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(pt===void 0?"'undefined' value invalid. Use null instead.":typeof pt=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof pt} instead.`)}concat(pt,vt,St){const Et=typeof pt=="number"?this.path.concat(pt):this.path,Rt=St?this.scope.concat(St):this.scope;return new Fl(this.registry,this._isConstant,Et,vt||null,Rt,this.errors)}error(pt,...vt){const St=`${this.key}${vt.map(Et=>`[${Et}]`).join("")}`;this.errors.push(new Wo(St,pt))}checkSubtype(pt,vt){const St=wr(pt,vt);return St&&this.error(St),St}}class Sl{constructor(pt,vt){this.type=vt.type,this.bindings=[].concat(pt),this.result=vt}evaluate(pt){return this.result.evaluate(pt)}eachChild(pt){for(const vt of this.bindings)pt(vt[1]);pt(this.result)}static parse(pt,vt){if(pt.length<4)return vt.error(`Expected at least 3 arguments, but found ${pt.length-1} instead.`);const St=[];for(let Rt=1;Rt<pt.length-1;Rt+=2){const Lt=pt[Rt];if(typeof Lt!="string")return vt.error(`Expected string, but found ${typeof Lt} instead.`,Rt);if(/[^a-zA-Z0-9_]/.test(Lt))return vt.error("Variable names must contain only alphanumeric characters or '_'.",Rt);const Nt=vt.parse(pt[Rt+1],Rt+1);if(!Nt)return null;St.push([Lt,Nt])}const Et=vt.parse(pt[pt.length-1],pt.length-1,vt.expectedType,St);return Et?new Sl(St,Et):null}outputDefined(){return this.result.outputDefined()}}class So{constructor(pt,vt){this.type=vt.type,this.name=pt,this.boundExpression=vt}static parse(pt,vt){if(pt.length!==2||typeof pt[1]!="string")return vt.error("'var' expression requires exactly one string literal argument.");const St=pt[1];return vt.scope.has(St)?new So(St,vt.scope.get(St)):vt.error(`Unknown variable "${St}". Make sure "${St}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(pt){return this.boundExpression.evaluate(pt)}eachChild(){}outputDefined(){return!1}}class eu{constructor(pt,vt,St){this.type=pt,this.index=vt,this.input=St}static parse(pt,vt){if(pt.length!==3)return vt.error(`Expected 2 arguments, but found ${pt.length-1} instead.`);const St=vt.parse(pt[1],1,_n),Et=vt.parse(pt[2],2,er(vt.expectedType||Kn));return St&&Et?new eu(Et.type.itemType,St,Et):null}evaluate(pt){const vt=this.index.evaluate(pt),St=this.input.evaluate(pt);if(vt<0)throw new Uo(`Array index out of bounds: ${vt} < 0.`);if(vt>=St.length)throw new Uo(`Array index out of bounds: ${vt} > ${St.length-1}.`);if(vt!==Math.floor(vt))throw new Uo(`Array index must be an integer, but found ${vt} instead.`);return St[vt]}eachChild(pt){pt(this.index),pt(this.input)}outputDefined(){return!1}}class Lu{constructor(pt,vt){this.type=Zn,this.needle=pt,this.haystack=vt}static parse(pt,vt){if(pt.length!==3)return vt.error(`Expected 2 arguments, but found ${pt.length-1} instead.`);const St=vt.parse(pt[1],1,Kn),Et=vt.parse(pt[2],2,Kn);return St&&Et?Lr(St.type,[Zn,bn,_n,ko,Kn])?new Lu(St,Et):vt.error(`Expected first argument to be of type boolean, string, number or null, but found ${tr(St.type)} instead`):null}evaluate(pt){const vt=this.needle.evaluate(pt),St=this.haystack.evaluate(pt);if(!St)return!1;if(!Fr(vt,["boolean","string","number","null"]))throw new Uo(`Expected first argument to be of type boolean, string, number or null, but found ${tr(To(vt))} instead.`);if(!Fr(St,["string","array"]))throw new Uo(`Expected second argument to be of type array or string, but found ${tr(To(St))} instead.`);return St.indexOf(vt)>=0}eachChild(pt){pt(this.needle),pt(this.haystack)}outputDefined(){return!0}}class Wl{constructor(pt,vt,St){this.type=_n,this.needle=pt,this.haystack=vt,this.fromIndex=St}static parse(pt,vt){if(pt.length<=2||pt.length>=5)return vt.error(`Expected 3 or 4 arguments, but found ${pt.length-1} instead.`);const St=vt.parse(pt[1],1,Kn),Et=vt.parse(pt[2],2,Kn);if(!St||!Et)return null;if(!Lr(St.type,[Zn,bn,_n,ko,Kn]))return vt.error(`Expected first argument to be of type boolean, string, number or null, but found ${tr(St.type)} instead`);if(pt.length===4){const Rt=vt.parse(pt[3],3,_n);return Rt?new Wl(St,Et,Rt):null}return new Wl(St,Et)}evaluate(pt){const vt=this.needle.evaluate(pt),St=this.haystack.evaluate(pt);if(!Fr(vt,["boolean","string","number","null"]))throw new Uo(`Expected first argument to be of type boolean, string, number or null, but found ${tr(To(vt))} instead.`);let Et;if(this.fromIndex&&(Et=this.fromIndex.evaluate(pt)),Fr(St,["string"])){const Rt=St.indexOf(vt,Et);return Rt===-1?-1:[...St.slice(0,Rt)].length}if(Fr(St,["array"]))return St.indexOf(vt,Et);throw new Uo(`Expected second argument to be of type array or string, but found ${tr(To(St))} instead.`)}eachChild(pt){pt(this.needle),pt(this.haystack),this.fromIndex&&pt(this.fromIndex)}outputDefined(){return!1}}class hu{constructor(pt,vt,St,Et,Rt,Lt){this.inputType=pt,this.type=vt,this.input=St,this.cases=Et,this.outputs=Rt,this.otherwise=Lt}static parse(pt,vt){if(pt.length<5)return vt.error(`Expected at least 4 arguments, but found only ${pt.length-1}.`);if(pt.length%2!=1)return vt.error("Expected an even number of arguments.");let St,Et;vt.expectedType&&vt.expectedType.kind!=="value"&&(Et=vt.expectedType);const Rt={},Lt=[];for(let jt=2;jt<pt.length-1;jt+=2){let Wt=pt[jt];const qt=pt[jt+1];Array.isArray(Wt)||(Wt=[Wt]);const ir=vt.concat(jt);if(Wt.length===0)return ir.error("Expected at least one branch label.");for(const lr of Wt){if(typeof lr!="number"&&typeof lr!="string")return ir.error("Branch labels must be numbers or strings.");if(typeof lr=="number"&&Math.abs(lr)>Number.MAX_SAFE_INTEGER)return ir.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof lr=="number"&&Math.floor(lr)!==lr)return ir.error("Numeric branch labels must be integer values.");if(St){if(ir.checkSubtype(St,To(lr)))return null}else St=To(lr);if(Rt[String(lr)]!==void 0)return ir.error("Branch labels must be unique.");Rt[String(lr)]=Lt.length}const or=vt.parse(qt,jt,Et);if(!or)return null;Et=Et||or.type,Lt.push(or)}const Nt=vt.parse(pt[1],1,Kn);if(!Nt)return null;const zt=vt.parse(pt[pt.length-1],pt.length-1,Et);return zt?Nt.type.kind!=="value"&&vt.concat(1).checkSubtype(St,Nt.type)?null:new hu(St,Et,Nt,Rt,Lt,zt):null}evaluate(pt){const vt=this.input.evaluate(pt);return(To(vt)===this.inputType&&this.outputs[this.cases[vt]]||this.otherwise).evaluate(pt)}eachChild(pt){pt(this.input),this.outputs.forEach(pt),pt(this.otherwise)}outputDefined(){return this.outputs.every(pt=>pt.outputDefined())&&this.otherwise.outputDefined()}}class fu{constructor(pt,vt,St){this.type=pt,this.branches=vt,this.otherwise=St}static parse(pt,vt){if(pt.length<4)return vt.error(`Expected at least 3 arguments, but found only ${pt.length-1}.`);if(pt.length%2!=0)return vt.error("Expected an odd number of arguments.");let St;vt.expectedType&&vt.expectedType.kind!=="value"&&(St=vt.expectedType);const Et=[];for(let Lt=1;Lt<pt.length-1;Lt+=2){const Nt=vt.parse(pt[Lt],Lt,Zn);if(!Nt)return null;const zt=vt.parse(pt[Lt+1],Lt+1,St);if(!zt)return null;Et.push([Nt,zt]),St=St||zt.type}const Rt=vt.parse(pt[pt.length-1],pt.length-1,St);if(!Rt)return null;if(!St)throw new Error("Can't infer output type");return new fu(St,Et,Rt)}evaluate(pt){for(const[vt,St]of this.branches)if(vt.evaluate(pt))return St.evaluate(pt);return this.otherwise.evaluate(pt)}eachChild(pt){for(const[vt,St]of this.branches)pt(vt),pt(St);pt(this.otherwise)}outputDefined(){return this.branches.every(([pt,vt])=>vt.outputDefined())&&this.otherwise.outputDefined()}}class lo{constructor(pt,vt,St,Et){this.type=pt,this.input=vt,this.beginIndex=St,this.endIndex=Et}static parse(pt,vt){if(pt.length<=2||pt.length>=5)return vt.error(`Expected 3 or 4 arguments, but found ${pt.length-1} instead.`);const St=vt.parse(pt[1],1,Kn),Et=vt.parse(pt[2],2,_n);if(!St||!Et)return null;if(!Lr(St.type,[er(Kn),bn,Kn]))return vt.error(`Expected first argument to be of type array or string, but found ${tr(St.type)} instead`);if(pt.length===4){const Rt=vt.parse(pt[3],3,_n);return Rt?new lo(St.type,St,Et,Rt):null}return new lo(St.type,St,Et)}evaluate(pt){const vt=this.input.evaluate(pt),St=this.beginIndex.evaluate(pt);let Et;if(this.endIndex&&(Et=this.endIndex.evaluate(pt)),Fr(vt,["string"]))return[...vt].slice(St,Et).join("");if(Fr(vt,["array"]))return vt.slice(St,Et);throw new Uo(`Expected first argument to be of type array or string, but found ${tr(To(vt))} instead.`)}eachChild(pt){pt(this.input),pt(this.beginIndex),this.endIndex&&pt(this.endIndex)}outputDefined(){return!1}}function du(gt,pt){const vt=gt.length-1;let St,Et,Rt=0,Lt=vt,Nt=0;for(;Rt<=Lt;)if(Nt=Math.floor((Rt+Lt)/2),St=gt[Nt],Et=gt[Nt+1],St<=pt){if(Nt===vt||pt<Et)return Nt;Rt=Nt+1}else{if(!(St>pt))throw new Uo("Input is not a number.");Lt=Nt-1}return 0}class so{constructor(pt,vt,St){this.type=pt,this.input=vt,this.labels=[],this.outputs=[];for(const[Et,Rt]of St)this.labels.push(Et),this.outputs.push(Rt)}static parse(pt,vt){if(pt.length-1<4)return vt.error(`Expected at least 4 arguments, but found only ${pt.length-1}.`);if((pt.length-1)%2!=0)return vt.error("Expected an even number of arguments.");const St=vt.parse(pt[1],1,_n);if(!St)return null;const Et=[];let Rt=null;vt.expectedType&&vt.expectedType.kind!=="value"&&(Rt=vt.expectedType);for(let Lt=1;Lt<pt.length;Lt+=2){const Nt=Lt===1?-1/0:pt[Lt],zt=pt[Lt+1],jt=Lt,Wt=Lt+1;if(typeof Nt!="number")return vt.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',jt);if(Et.length&&Et[Et.length-1][0]>=Nt)return vt.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',jt);const qt=vt.parse(zt,Wt,Rt);if(!qt)return null;Rt=Rt||qt.type,Et.push([Nt,qt])}return new so(Rt,St,Et)}evaluate(pt){const vt=this.labels,St=this.outputs;if(vt.length===1)return St[0].evaluate(pt);const Et=this.input.evaluate(pt);if(Et<=vt[0])return St[0].evaluate(pt);const Rt=vt.length;return Et>=vt[Rt-1]?St[Rt-1].evaluate(pt):St[du(vt,Et)].evaluate(pt)}eachChild(pt){pt(this.input);for(const vt of this.outputs)pt(vt)}outputDefined(){return this.outputs.every(pt=>pt.outputDefined())}}function ho(gt){return gt&&gt.__esModule&&Object.prototype.hasOwnProperty.call(gt,"default")?gt.default:gt}var cp=pu;function pu(gt,pt,vt,St){this.cx=3*gt,this.bx=3*(vt-gt)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*pt,this.by=3*(St-pt)-this.cy,this.ay=1-this.cy-this.by,this.p1x=gt,this.p1y=pt,this.p2x=vt,this.p2y=St}pu.prototype={sampleCurveX:function(gt){return((this.ax*gt+this.bx)*gt+this.cx)*gt},sampleCurveY:function(gt){return((this.ay*gt+this.by)*gt+this.cy)*gt},sampleCurveDerivativeX:function(gt){return(3*this.ax*gt+2*this.bx)*gt+this.cx},solveCurveX:function(gt,pt){if(pt===void 0&&(pt=1e-6),gt<0)return 0;if(gt>1)return 1;for(var vt=gt,St=0;St<8;St++){var Et=this.sampleCurveX(vt)-gt;if(Math.abs(Et)<pt)return vt;var Rt=this.sampleCurveDerivativeX(vt);if(Math.abs(Rt)<1e-6)break;vt-=Et/Rt}var Lt=0,Nt=1;for(vt=gt,St=0;St<20&&(Et=this.sampleCurveX(vt),!(Math.abs(Et-gt)<pt));St++)gt>Et?Lt=vt:Nt=vt,vt=.5*(Nt-Lt)+Lt;return vt},solve:function(gt,pt){return this.sampleCurveY(this.solveCurveX(gt,pt))}};var Fp=ho(cp);function Bl(gt,pt,vt){return gt+vt*(pt-gt)}function tu(gt,pt,vt){return gt.map((St,Et)=>Bl(St,pt[Et],vt))}const fs={number:Bl,color:function(gt,pt,vt,St="rgb"){switch(St){case"rgb":{const[Et,Rt,Lt,Nt]=tu(gt.rgb,pt.rgb,vt);return new ro(Et,Rt,Lt,Nt,!1)}case"hcl":{const[Et,Rt,Lt,Nt]=gt.hcl,[zt,jt,Wt,qt]=pt.hcl;let ir,or;if(isNaN(Et)||isNaN(zt))isNaN(Et)?isNaN(zt)?ir=NaN:(ir=zt,Lt!==1&&Lt!==0||(or=jt)):(ir=Et,Wt!==1&&Wt!==0||(or=Rt));else{let Wr=zt-Et;zt>Et&&Wr>180?Wr-=360:zt<Et&&Et-zt>180&&(Wr+=360),ir=Et+vt*Wr}const[lr,pr,Tr,Ir]=function([Wr,$r,jr,en]){return Wr=isNaN(Wr)?0:Wr*Yn,Ur([jr,Math.cos(Wr)*$r,Math.sin(Wr)*$r,en])}([ir,or??Bl(Rt,jt,vt),Bl(Lt,Wt,vt),Bl(Nt,qt,vt)]);return new ro(lr,pr,Tr,Ir,!1)}case"lab":{const[Et,Rt,Lt,Nt]=Ur(tu(gt.lab,pt.lab,vt));return new ro(Et,Rt,Lt,Nt,!1)}}},array:tu,padding:function(gt,pt,vt){return new mo(tu(gt.values,pt.values,vt))},variableAnchorOffsetCollection:function(gt,pt,vt){const St=gt.values,Et=pt.values;if(St.length!==Et.length)throw new Uo(`Cannot interpolate values of different length. from: ${gt.toString()}, to: ${pt.toString()}`);const Rt=[];for(let Lt=0;Lt<St.length;Lt+=2){if(St[Lt]!==Et[Lt])throw new Uo(`Cannot interpolate values containing mismatched anchors. from[${Lt}]: ${St[Lt]}, to[${Lt}]: ${Et[Lt]}`);Rt.push(St[Lt]);const[Nt,zt]=St[Lt+1],[jt,Wt]=Et[Lt+1];Rt.push([Bl(Nt,jt,vt),Bl(zt,Wt,vt)])}return new Yo(Rt)}};class ds{constructor(pt,vt,St,Et,Rt){this.type=pt,this.operator=vt,this.interpolation=St,this.input=Et,this.labels=[],this.outputs=[];for(const[Lt,Nt]of Rt)this.labels.push(Lt),this.outputs.push(Nt)}static interpolationFactor(pt,vt,St,Et){let Rt=0;if(pt.name==="exponential")Rt=gu(vt,pt.base,St,Et);else if(pt.name==="linear")Rt=gu(vt,1,St,Et);else if(pt.name==="cubic-bezier"){const Lt=pt.controlPoints;Rt=new Fp(Lt[0],Lt[1],Lt[2],Lt[3]).solve(gu(vt,1,St,Et))}return Rt}static parse(pt,vt){let[St,Et,Rt,...Lt]=pt;if(!Array.isArray(Et)||Et.length===0)return vt.error("Expected an interpolation type expression.",1);if(Et[0]==="linear")Et={name:"linear"};else if(Et[0]==="exponential"){const jt=Et[1];if(typeof jt!="number")return vt.error("Exponential interpolation requires a numeric base.",1,1);Et={name:"exponential",base:jt}}else{if(Et[0]!=="cubic-bezier")return vt.error(`Unknown interpolation type ${String(Et[0])}`,1,0);{const jt=Et.slice(1);if(jt.length!==4||jt.some(Wt=>typeof Wt!="number"||Wt<0||Wt>1))return vt.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);Et={name:"cubic-bezier",controlPoints:jt}}}if(pt.length-1<4)return vt.error(`Expected at least 4 arguments, but found only ${pt.length-1}.`);if((pt.length-1)%2!=0)return vt.error("Expected an even number of arguments.");if(Rt=vt.parse(Rt,2,_n),!Rt)return null;const Nt=[];let zt=null;St==="interpolate-hcl"||St==="interpolate-lab"?zt=ts:vt.expectedType&&vt.expectedType.kind!=="value"&&(zt=vt.expectedType);for(let jt=0;jt<Lt.length;jt+=2){const Wt=Lt[jt],qt=Lt[jt+1],ir=jt+3,or=jt+4;if(typeof Wt!="number")return vt.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ir);if(Nt.length&&Nt[Nt.length-1][0]>=Wt)return vt.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ir);const lr=vt.parse(qt,or,zt);if(!lr)return null;zt=zt||lr.type,Nt.push([Wt,lr])}return Hr(zt,_n)||Hr(zt,ts)||Hr(zt,Ms)||Hr(zt,yr)||Hr(zt,er(_n))?new ds(zt,St,Et,Rt,Nt):vt.error(`Type ${tr(zt)} is not interpolatable.`)}evaluate(pt){const vt=this.labels,St=this.outputs;if(vt.length===1)return St[0].evaluate(pt);const Et=this.input.evaluate(pt);if(Et<=vt[0])return St[0].evaluate(pt);const Rt=vt.length;if(Et>=vt[Rt-1])return St[Rt-1].evaluate(pt);const Lt=du(vt,Et),Nt=ds.interpolationFactor(this.interpolation,Et,vt[Lt],vt[Lt+1]),zt=St[Lt].evaluate(pt),jt=St[Lt+1].evaluate(pt);switch(this.operator){case"interpolate":return fs[this.type.kind](zt,jt,Nt);case"interpolate-hcl":return fs.color(zt,jt,Nt,"hcl");case"interpolate-lab":return fs.color(zt,jt,Nt,"lab")}}eachChild(pt){pt(this.input);for(const vt of this.outputs)pt(vt)}outputDefined(){return this.outputs.every(pt=>pt.outputDefined())}}function gu(gt,pt,vt,St){const Et=St-vt,Rt=gt-vt;return Et===0?0:pt===1?Rt/Et:(Math.pow(pt,Rt)-1)/(Math.pow(pt,Et)-1)}class mu{constructor(pt,vt){this.type=pt,this.args=vt}static parse(pt,vt){if(pt.length<2)return vt.error("Expectected at least one argument.");let St=null;const Et=vt.expectedType;Et&&Et.kind!=="value"&&(St=Et);const Rt=[];for(const Nt of pt.slice(1)){const zt=vt.parse(Nt,1+Rt.length,St,void 0,{typeAnnotation:"omit"});if(!zt)return null;St=St||zt.type,Rt.push(zt)}if(!St)throw new Error("No output type");const Lt=Et&&Rt.some(Nt=>wr(Et,Nt.type));return new mu(Lt?Kn:St,Rt)}evaluate(pt){let vt,St=null,Et=0;for(const Rt of this.args)if(Et++,St=Rt.evaluate(pt),St&&St instanceof hs&&!St.available&&(vt||(vt=St.name),St=null,Et===this.args.length&&(St=vt)),St!==null)break;return St}eachChild(pt){this.args.forEach(pt)}outputDefined(){return this.args.every(pt=>pt.outputDefined())}}function vu(gt,pt){return gt==="=="||gt==="!="?pt.kind==="boolean"||pt.kind==="string"||pt.kind==="number"||pt.kind==="null"||pt.kind==="value":pt.kind==="string"||pt.kind==="number"||pt.kind==="value"}function hp(gt,pt,vt,St){return St.compare(pt,vt)===0}function Yl(gt,pt,vt){const St=gt!=="=="&&gt!=="!=";return class P1{constructor(Rt,Lt,Nt){this.type=Zn,this.lhs=Rt,this.rhs=Lt,this.collator=Nt,this.hasUntypedArgument=Rt.type.kind==="value"||Lt.type.kind==="value"}static parse(Rt,Lt){if(Rt.length!==3&&Rt.length!==4)return Lt.error("Expected two or three arguments.");const Nt=Rt[0];let zt=Lt.parse(Rt[1],1,Kn);if(!zt)return null;if(!vu(Nt,zt.type))return Lt.concat(1).error(`"${Nt}" comparisons are not supported for type '${tr(zt.type)}'.`);let jt=Lt.parse(Rt[2],2,Kn);if(!jt)return null;if(!vu(Nt,jt.type))return Lt.concat(2).error(`"${Nt}" comparisons are not supported for type '${tr(jt.type)}'.`);if(zt.type.kind!==jt.type.kind&&zt.type.kind!=="value"&&jt.type.kind!=="value")return Lt.error(`Cannot compare types '${tr(zt.type)}' and '${tr(jt.type)}'.`);St&&(zt.type.kind==="value"&&jt.type.kind!=="value"?zt=new Vs(jt.type,[zt]):zt.type.kind!=="value"&&jt.type.kind==="value"&&(jt=new Vs(zt.type,[jt])));let Wt=null;if(Rt.length===4){if(zt.type.kind!=="string"&&jt.type.kind!=="string"&&zt.type.kind!=="value"&&jt.type.kind!=="value")return Lt.error("Cannot use collator to compare non-string types.");if(Wt=Lt.parse(Rt[3],3,co),!Wt)return null}return new P1(zt,jt,Wt)}evaluate(Rt){const Lt=this.lhs.evaluate(Rt),Nt=this.rhs.evaluate(Rt);if(St&&this.hasUntypedArgument){const zt=To(Lt),jt=To(Nt);if(zt.kind!==jt.kind||zt.kind!=="string"&&zt.kind!=="number")throw new Uo(`Expected arguments for "${gt}" to be (string, string) or (number, number), but found (${zt.kind}, ${jt.kind}) instead.`)}if(this.collator&&!St&&this.hasUntypedArgument){const zt=To(Lt),jt=To(Nt);if(zt.kind!=="string"||jt.kind!=="string")return pt(Rt,Lt,Nt)}return this.collator?vt(Rt,Lt,Nt,this.collator.evaluate(Rt)):pt(Rt,Lt,Nt)}eachChild(Rt){Rt(this.lhs),Rt(this.rhs),this.collator&&Rt(this.collator)}outputDefined(){return!0}}}const Bp=Yl("==",function(gt,pt,vt){return pt===vt},hp),fp=Yl("!=",function(gt,pt,vt){return pt!==vt},function(gt,pt,vt,St){return!hp(0,pt,vt,St)}),rr=Yl("<",function(gt,pt,vt){return pt<vt},function(gt,pt,vt,St){return St.compare(pt,vt)<0}),hr=Yl(">",function(gt,pt,vt){return pt>vt},function(gt,pt,vt,St){return St.compare(pt,vt)>0}),xr=Yl("<=",function(gt,pt,vt){return pt<=vt},function(gt,pt,vt,St){return St.compare(pt,vt)<=0}),Or=Yl(">=",function(gt,pt,vt){return pt>=vt},function(gt,pt,vt,St){return St.compare(pt,vt)>=0});class Zr{constructor(pt,vt,St){this.type=co,this.locale=St,this.caseSensitive=pt,this.diacriticSensitive=vt}static parse(pt,vt){if(pt.length!==2)return vt.error("Expected one argument.");const St=pt[1];if(typeof St!="object"||Array.isArray(St))return vt.error("Collator options argument must be an object.");const Et=vt.parse(St["case-sensitive"]!==void 0&&St["case-sensitive"],1,Zn);if(!Et)return null;const Rt=vt.parse(St["diacritic-sensitive"]!==void 0&&St["diacritic-sensitive"],1,Zn);if(!Rt)return null;let Lt=null;return St.locale&&(Lt=vt.parse(St.locale,1,bn),!Lt)?null:new Zr(Et,Rt,Lt)}evaluate(pt){return new jo(this.caseSensitive.evaluate(pt),this.diacriticSensitive.evaluate(pt),this.locale?this.locale.evaluate(pt):null)}eachChild(pt){pt(this.caseSensitive),pt(this.diacriticSensitive),this.locale&&pt(this.locale)}outputDefined(){return!1}}class rn{constructor(pt,vt,St,Et,Rt){this.type=bn,this.number=pt,this.locale=vt,this.currency=St,this.minFractionDigits=Et,this.maxFractionDigits=Rt}static parse(pt,vt){if(pt.length!==3)return vt.error("Expected two arguments.");const St=vt.parse(pt[1],1,_n);if(!St)return null;const Et=pt[2];if(typeof Et!="object"||Array.isArray(Et))return vt.error("NumberFormat options argument must be an object.");let Rt=null;if(Et.locale&&(Rt=vt.parse(Et.locale,1,bn),!Rt))return null;let Lt=null;if(Et.currency&&(Lt=vt.parse(Et.currency,1,bn),!Lt))return null;let Nt=null;if(Et["min-fraction-digits"]&&(Nt=vt.parse(Et["min-fraction-digits"],1,_n),!Nt))return null;let zt=null;return Et["max-fraction-digits"]&&(zt=vt.parse(Et["max-fraction-digits"],1,_n),!zt)?null:new rn(St,Rt,Lt,Nt,zt)}evaluate(pt){return new Intl.NumberFormat(this.locale?this.locale.evaluate(pt):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(pt):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(pt):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(pt):void 0}).format(this.number.evaluate(pt))}eachChild(pt){pt(this.number),this.locale&&pt(this.locale),this.currency&&pt(this.currency),this.minFractionDigits&&pt(this.minFractionDigits),this.maxFractionDigits&&pt(this.maxFractionDigits)}outputDefined(){return!1}}class wn{constructor(pt){this.type=cs,this.sections=pt}static parse(pt,vt){if(pt.length<2)return vt.error("Expected at least one argument.");const St=pt[1];if(!Array.isArray(St)&&typeof St=="object")return vt.error("First argument must be an image or text section.");const Et=[];let Rt=!1;for(let Lt=1;Lt<=pt.length-1;++Lt){const Nt=pt[Lt];if(Rt&&typeof Nt=="object"&&!Array.isArray(Nt)){Rt=!1;let zt=null;if(Nt["font-scale"]&&(zt=vt.parse(Nt["font-scale"],1,_n),!zt))return null;let jt=null;if(Nt["text-font"]&&(jt=vt.parse(Nt["text-font"],1,er(bn)),!jt))return null;let Wt=null;if(Nt["text-color"]&&(Wt=vt.parse(Nt["text-color"],1,ts),!Wt))return null;const qt=Et[Et.length-1];qt.scale=zt,qt.font=jt,qt.textColor=Wt}else{const zt=vt.parse(pt[Lt],1,Kn);if(!zt)return null;const jt=zt.type.kind;if(jt!=="string"&&jt!=="value"&&jt!=="null"&&jt!=="resolvedImage")return vt.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");Rt=!0,Et.push({content:zt,scale:null,font:null,textColor:null})}}return new wn(Et)}evaluate(pt){return new to(this.sections.map(vt=>{const St=vt.content.evaluate(pt);return To(St)===ns?new nn("",St,null,null,null):new nn(Nl(St),null,vt.scale?vt.scale.evaluate(pt):null,vt.font?vt.font.evaluate(pt).join(","):null,vt.textColor?vt.textColor.evaluate(pt):null)}))}eachChild(pt){for(const vt of this.sections)pt(vt.content),vt.scale&&pt(vt.scale),vt.font&&pt(vt.font),vt.textColor&&pt(vt.textColor)}outputDefined(){return!1}}class Xn{constructor(pt){this.type=ns,this.input=pt}static parse(pt,vt){if(pt.length!==2)return vt.error("Expected two arguments.");const St=vt.parse(pt[1],1,bn);return St?new Xn(St):vt.error("No image name provided.")}evaluate(pt){const vt=this.input.evaluate(pt),St=hs.fromString(vt);return St&&pt.availableImages&&(St.available=pt.availableImages.indexOf(vt)>-1),St}eachChild(pt){pt(this.input)}outputDefined(){return!1}}class fo{constructor(pt){this.type=_n,this.input=pt}static parse(pt,vt){if(pt.length!==2)return vt.error(`Expected 1 argument, but found ${pt.length-1} instead.`);const St=vt.parse(pt[1],1);return St?St.type.kind!=="array"&&St.type.kind!=="string"&&St.type.kind!=="value"?vt.error(`Expected argument of type string or array, but found ${tr(St.type)} instead.`):new fo(St):null}evaluate(pt){const vt=this.input.evaluate(pt);if(typeof vt=="string")return[...vt].length;if(Array.isArray(vt))return vt.length;throw new Uo(`Expected value to be of type string or array, but found ${tr(To(vt))} instead.`)}eachChild(pt){pt(this.input)}outputDefined(){return!1}}const io=8192;function Go(gt,pt){const vt=(180+gt[0])/360,St=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+gt[1]*Math.PI/360)))/360,Et=Math.pow(2,pt.z);return[Math.round(vt*Et*io),Math.round(St*Et*io)]}function Os(gt,pt){const vt=Math.pow(2,pt.z);return[(Et=(gt[0]/io+pt.x)/vt,360*Et-180),(St=(gt[1]/io+pt.y)/vt,360/Math.PI*Math.atan(Math.exp((180-360*St)*Math.PI/180))-90)];var St,Et}function Qo(gt,pt){gt[0]=Math.min(gt[0],pt[0]),gt[1]=Math.min(gt[1],pt[1]),gt[2]=Math.max(gt[2],pt[0]),gt[3]=Math.max(gt[3],pt[1])}function tn(gt,pt){return!(gt[0]<=pt[0]||gt[2]>=pt[2]||gt[1]<=pt[1]||gt[3]>=pt[3])}function Gn(gt,pt,vt){const St=gt[0]-pt[0],Et=gt[1]-pt[1],Rt=gt[0]-vt[0],Lt=gt[1]-vt[1];return St*Lt-Rt*Et==0&&St*Rt<=0&&Et*Lt<=0}function Ro(gt,pt,vt,St){return(Et=[St[0]-vt[0],St[1]-vt[1]])[0]*(Rt=[pt[0]-gt[0],pt[1]-gt[1]])[1]-Et[1]*Rt[0]!=0&&!(!Bv(gt,pt,vt,St)||!Bv(vt,St,gt,pt));var Et,Rt}function Tl(gt,pt,vt){for(const St of vt)for(let Et=0;Et<St.length-1;++Et)if(Ro(gt,pt,St[Et],St[Et+1]))return!0;return!1}function Us(gt,pt,vt=!1){let St=!1;for(const Nt of pt)for(let zt=0;zt<Nt.length-1;zt++){if(Gn(gt,Nt[zt],Nt[zt+1]))return vt;(Rt=Nt[zt])[1]>(Et=gt)[1]!=(Lt=Nt[zt+1])[1]>Et[1]&&Et[0]<(Lt[0]-Rt[0])*(Et[1]-Rt[1])/(Lt[1]-Rt[1])+Rt[0]&&(St=!St)}var Et,Rt,Lt;return St}function $y(gt,pt){for(const vt of pt)if(Us(gt,vt))return!0;return!1}function Fv(gt,pt){for(const vt of gt)if(!Us(vt,pt))return!1;for(let vt=0;vt<gt.length-1;++vt)if(Tl(gt[vt],gt[vt+1],pt))return!1;return!0}function ky(gt,pt){for(const vt of pt)if(Fv(gt,vt))return!0;return!1}function Bv(gt,pt,vt,St){const Et=St[0]-vt[0],Rt=St[1]-vt[1],Lt=(gt[0]-vt[0])*Rt-Et*(gt[1]-vt[1]),Nt=(pt[0]-vt[0])*Rt-Et*(pt[1]-vt[1]);return Lt>0&&Nt<0||Lt<0&&Nt>0}function Mm(gt,pt,vt){const St=[];for(let Et=0;Et<gt.length;Et++){const Rt=[];for(let Lt=0;Lt<gt[Et].length;Lt++){const Nt=Go(gt[Et][Lt],vt);Qo(pt,Nt),Rt.push(Nt)}St.push(Rt)}return St}function zv(gt,pt,vt){const St=[];for(let Et=0;Et<gt.length;Et++){const Rt=Mm(gt[Et],pt,vt);St.push(Rt)}return St}function Vv(gt,pt,vt,St){if(gt[0]<vt[0]||gt[0]>vt[2]){const Et=.5*St;let Rt=gt[0]-vt[0]>Et?-St:vt[0]-gt[0]>Et?St:0;Rt===0&&(Rt=gt[0]-vt[2]>Et?-St:vt[2]-gt[0]>Et?St:0),gt[0]+=Rt}Qo(pt,gt)}function Uv(gt,pt,vt,St){const Et=Math.pow(2,St.z)*io,Rt=[St.x*io,St.y*io],Lt=[];for(const Nt of gt)for(const zt of Nt){const jt=[zt.x+Rt[0],zt.y+Rt[1]];Vv(jt,pt,vt,Et),Lt.push(jt)}return Lt}function Gv(gt,pt,vt,St){const Et=Math.pow(2,St.z)*io,Rt=[St.x*io,St.y*io],Lt=[];for(const zt of gt){const jt=[];for(const Wt of zt){const qt=[Wt.x+Rt[0],Wt.y+Rt[1]];Qo(pt,qt),jt.push(qt)}Lt.push(jt)}if(pt[2]-pt[0]<=Et/2){(Nt=pt)[0]=Nt[1]=1/0,Nt[2]=Nt[3]=-1/0;for(const zt of Lt)for(const jt of zt)Vv(jt,pt,vt,Et)}var Nt;return Lt}class yu{constructor(pt,vt){this.type=Zn,this.geojson=pt,this.geometries=vt}static parse(pt,vt){if(pt.length!==2)return vt.error(`'within' expression requires exactly one argument, but found ${pt.length-1} instead.`);if($l(pt[1])){const St=pt[1];if(St.type==="FeatureCollection"){const Et=[];for(const Rt of St.features){const{type:Lt,coordinates:Nt}=Rt.geometry;Lt==="Polygon"&&Et.push(Nt),Lt==="MultiPolygon"&&Et.push(...Nt)}if(Et.length)return new yu(St,{type:"MultiPolygon",coordinates:Et})}else if(St.type==="Feature"){const Et=St.geometry.type;if(Et==="Polygon"||Et==="MultiPolygon")return new yu(St,St.geometry)}else if(St.type==="Polygon"||St.type==="MultiPolygon")return new yu(St,St)}return vt.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(pt){if(pt.geometry()!=null&&pt.canonicalID()!=null){if(pt.geometryType()==="Point")return function(vt,St){const Et=[1/0,1/0,-1/0,-1/0],Rt=[1/0,1/0,-1/0,-1/0],Lt=vt.canonicalID();if(St.type==="Polygon"){const Nt=Mm(St.coordinates,Rt,Lt),zt=Uv(vt.geometry(),Et,Rt,Lt);if(!tn(Et,Rt))return!1;for(const jt of zt)if(!Us(jt,Nt))return!1}if(St.type==="MultiPolygon"){const Nt=zv(St.coordinates,Rt,Lt),zt=Uv(vt.geometry(),Et,Rt,Lt);if(!tn(Et,Rt))return!1;for(const jt of zt)if(!$y(jt,Nt))return!1}return!0}(pt,this.geometries);if(pt.geometryType()==="LineString")return function(vt,St){const Et=[1/0,1/0,-1/0,-1/0],Rt=[1/0,1/0,-1/0,-1/0],Lt=vt.canonicalID();if(St.type==="Polygon"){const Nt=Mm(St.coordinates,Rt,Lt),zt=Gv(vt.geometry(),Et,Rt,Lt);if(!tn(Et,Rt))return!1;for(const jt of zt)if(!Fv(jt,Nt))return!1}if(St.type==="MultiPolygon"){const Nt=zv(St.coordinates,Rt,Lt),zt=Gv(vt.geometry(),Et,Rt,Lt);if(!tn(Et,Rt))return!1;for(const jt of zt)if(!ky(jt,Nt))return!1}return!0}(pt,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let jv=class{constructor(gt=[],pt=(vt,St)=>vt<St?-1:vt>St?1:0){if(this.data=gt,this.length=this.data.length,this.compare=pt,this.length>0)for(let vt=(this.length>>1)-1;vt>=0;vt--)this._down(vt)}push(gt){this.data.push(gt),this._up(this.length++)}pop(){if(this.length===0)return;const gt=this.data[0],pt=this.data.pop();return--this.length>0&&(this.data[0]=pt,this._down(0)),gt}peek(){return this.data[0]}_up(gt){const{data:pt,compare:vt}=this,St=pt[gt];for(;gt>0;){const Et=gt-1>>1,Rt=pt[Et];if(vt(St,Rt)>=0)break;pt[gt]=Rt,gt=Et}pt[gt]=St}_down(gt){const{data:pt,compare:vt}=this,St=this.length>>1,Et=pt[gt];for(;gt<St;){let Rt=1+(gt<<1);const Lt=Rt+1;if(Lt<this.length&&vt(pt[Lt],pt[Rt])<0&&(Rt=Lt),vt(pt[Rt],Et)>=0)break;pt[gt]=pt[Rt],gt=Rt}pt[gt]=Et}};function Ny(gt,pt,vt,St,Et){Hv(gt,pt,vt,St||gt.length-1,Et||Fy)}function Hv(gt,pt,vt,St,Et){for(;St>vt;){if(St-vt>600){var Rt=St-vt+1,Lt=pt-vt+1,Nt=Math.log(Rt),zt=.5*Math.exp(2*Nt/3),jt=.5*Math.sqrt(Nt*zt*(Rt-zt)/Rt)*(Lt-Rt/2<0?-1:1);Hv(gt,pt,Math.max(vt,Math.floor(pt-Lt*zt/Rt+jt)),Math.min(St,Math.floor(pt+(Rt-Lt)*zt/Rt+jt)),Et)}var Wt=gt[pt],qt=vt,ir=St;for(dp(gt,vt,pt),Et(gt[St],Wt)>0&&dp(gt,vt,St);qt<ir;){for(dp(gt,qt,ir),qt++,ir--;Et(gt[qt],Wt)<0;)qt++;for(;Et(gt[ir],Wt)>0;)ir--}Et(gt[vt],Wt)===0?dp(gt,vt,ir):dp(gt,++ir,St),ir<=pt&&(vt=ir+1),pt<=ir&&(St=ir-1)}}function dp(gt,pt,vt){var St=gt[pt];gt[pt]=gt[vt],gt[vt]=St}function Fy(gt,pt){return gt<pt?-1:gt>pt?1:0}function zp(gt,pt){if(gt.length<=1)return[gt];const vt=[];let St,Et;for(const Rt of gt){const Lt=zy(Rt);Lt!==0&&(Rt.area=Math.abs(Lt),Et===void 0&&(Et=Lt<0),Et===Lt<0?(St&&vt.push(St),St=[Rt]):St.push(Rt))}if(St&&vt.push(St),pt>1)for(let Rt=0;Rt<vt.length;Rt++)vt[Rt].length<=pt||(Ny(vt[Rt],pt,1,vt[Rt].length-1,By),vt[Rt]=vt[Rt].slice(0,pt));return vt}function By(gt,pt){return pt.area-gt.area}function zy(gt){let pt=0;for(let vt,St,Et=0,Rt=gt.length,Lt=Rt-1;Et<Rt;Lt=Et++)vt=gt[Et],St=gt[Lt],pt+=(St.x-vt.x)*(vt.y+St.y);return pt}const Wv=1/298.257223563,Yv=Wv*(2-Wv),qv=Math.PI/180;class Rm{constructor(pt){const vt=6378.137*qv*1e3,St=Math.cos(pt*qv),Et=1/(1-Yv*(1-St*St)),Rt=Math.sqrt(Et);this.kx=vt*Rt*St,this.ky=vt*Rt*Et*(1-Yv)}distance(pt,vt){const St=this.wrap(pt[0]-vt[0])*this.kx,Et=(pt[1]-vt[1])*this.ky;return Math.sqrt(St*St+Et*Et)}pointOnLine(pt,vt){let St,Et,Rt,Lt,Nt=1/0;for(let zt=0;zt<pt.length-1;zt++){let jt=pt[zt][0],Wt=pt[zt][1],qt=this.wrap(pt[zt+1][0]-jt)*this.kx,ir=(pt[zt+1][1]-Wt)*this.ky,or=0;qt===0&&ir===0||(or=(this.wrap(vt[0]-jt)*this.kx*qt+(vt[1]-Wt)*this.ky*ir)/(qt*qt+ir*ir),or>1?(jt=pt[zt+1][0],Wt=pt[zt+1][1]):or>0&&(jt+=qt/this.kx*or,Wt+=ir/this.ky*or)),qt=this.wrap(vt[0]-jt)*this.kx,ir=(vt[1]-Wt)*this.ky;const lr=qt*qt+ir*ir;lr<Nt&&(Nt=lr,St=jt,Et=Wt,Rt=zt,Lt=or)}return{point:[St,Et],index:Rt,t:Math.max(0,Math.min(1,Lt))}}wrap(pt){for(;pt<-180;)pt+=360;for(;pt>180;)pt-=360;return pt}}function Zv(gt,pt){return pt[0]-gt[0]}function Vp(gt){return gt[1]-gt[0]+1}function Zl(gt,pt){return gt[1]>=gt[0]&&gt[1]<pt}function Lm(gt,pt){if(gt[0]>gt[1])return[null,null];const vt=Vp(gt);if(pt){if(vt===2)return[gt,null];const Et=Math.floor(vt/2);return[[gt[0],gt[0]+Et],[gt[0]+Et,gt[1]]]}if(vt===1)return[gt,null];const St=Math.floor(vt/2)-1;return[[gt[0],gt[0]+St],[gt[0]+St+1,gt[1]]]}function Om(gt,pt){if(!Zl(pt,gt.length))return[1/0,1/0,-1/0,-1/0];const vt=[1/0,1/0,-1/0,-1/0];for(let St=pt[0];St<=pt[1];++St)Qo(vt,gt[St]);return vt}function $m(gt){const pt=[1/0,1/0,-1/0,-1/0];for(const vt of gt)for(const St of vt)Qo(pt,St);return pt}function Up(gt){return gt[0]!==-1/0&&gt[1]!==-1/0&&gt[2]!==1/0&&gt[3]!==1/0}function km(gt,pt,vt){if(!Up(gt)||!Up(pt))return NaN;let St=0,Et=0;return gt[2]<pt[0]&&(St=pt[0]-gt[2]),gt[0]>pt[2]&&(St=gt[0]-pt[2]),gt[1]>pt[3]&&(Et=gt[1]-pt[3]),gt[3]<pt[1]&&(Et=pt[1]-gt[3]),vt.distance([0,0],[St,Et])}function bu(gt,pt,vt){const St=vt.pointOnLine(pt,gt);return vt.distance(gt,St.point)}function Nm(gt,pt,vt,St,Et){const Rt=Math.min(bu(gt,[vt,St],Et),bu(pt,[vt,St],Et)),Lt=Math.min(bu(vt,[gt,pt],Et),bu(St,[gt,pt],Et));return Math.min(Rt,Lt)}function Vy(gt,pt,vt,St,Et){if(!Zl(pt,gt.length)||!Zl(St,vt.length))return 1/0;let Rt=1/0;for(let Lt=pt[0];Lt<pt[1];++Lt){const Nt=gt[Lt],zt=gt[Lt+1];for(let jt=St[0];jt<St[1];++jt){const Wt=vt[jt],qt=vt[jt+1];if(Ro(Nt,zt,Wt,qt))return 0;Rt=Math.min(Rt,Nm(Nt,zt,Wt,qt,Et))}}return Rt}function qo(gt,pt,vt,St,Et){if(!Zl(pt,gt.length)||!Zl(St,vt.length))return NaN;let Rt=1/0;for(let Lt=pt[0];Lt<=pt[1];++Lt)for(let Nt=St[0];Nt<=St[1];++Nt)if(Rt=Math.min(Rt,Et.distance(gt[Lt],vt[Nt])),Rt===0)return Rt;return Rt}function Uy(gt,pt,vt){if(Us(gt,pt,!0))return 0;let St=1/0;for(const Et of pt){const Rt=Et[0],Lt=Et[Et.length-1];if(Rt!==Lt&&(St=Math.min(St,bu(gt,[Lt,Rt],vt)),St===0))return St;const Nt=vt.pointOnLine(Et,gt);if(St=Math.min(St,vt.distance(gt,Nt.point)),St===0)return St}return St}function go(gt,pt,vt,St){if(!Zl(pt,gt.length))return NaN;for(let Rt=pt[0];Rt<=pt[1];++Rt)if(Us(gt[Rt],vt,!0))return 0;let Et=1/0;for(let Rt=pt[0];Rt<pt[1];++Rt){const Lt=gt[Rt],Nt=gt[Rt+1];for(const zt of vt)for(let jt=0,Wt=zt.length,qt=Wt-1;jt<Wt;qt=jt++){const ir=zt[qt],or=zt[jt];if(Ro(Lt,Nt,ir,or))return 0;Et=Math.min(Et,Nm(Lt,Nt,ir,or,St))}}return Et}function Gp(gt,pt){for(const vt of gt)for(const St of vt)if(Us(St,pt,!0))return!0;return!1}function Oo(gt,pt,vt,St=1/0){const Et=$m(gt),Rt=$m(pt);if(St!==1/0&&km(Et,Rt,vt)>=St)return St;if(tn(Et,Rt)){if(Gp(gt,pt))return 0}else if(Gp(pt,gt))return 0;let Lt=1/0;for(const Nt of gt)for(let zt=0,jt=Nt.length,Wt=jt-1;zt<jt;Wt=zt++){const qt=Nt[Wt],ir=Nt[zt];for(const or of pt)for(let lr=0,pr=or.length,Tr=pr-1;lr<pr;Tr=lr++){const Ir=or[Tr],Wr=or[lr];if(Ro(qt,ir,Ir,Wr))return 0;Lt=Math.min(Lt,Nm(qt,ir,Ir,Wr,vt))}}return Lt}function Co(gt,pt,vt,St,Et,Rt){if(!Rt)return;const Lt=km(Om(St,Rt),Et,vt);Lt<pt&&gt.push([Lt,Rt,[0,0]])}function xu(gt,pt,vt,St,Et,Rt,Lt){if(!Rt||!Lt)return;const Nt=km(Om(St,Rt),Om(Et,Lt),vt);Nt<pt&&gt.push([Nt,Rt,Lt])}function pp(gt,pt,vt,St,Et=1/0){let Rt=Math.min(St.distance(gt[0],vt[0][0]),Et);if(Rt===0)return Rt;const Lt=new jv([[0,[0,gt.length-1],[0,0]]],Zv),Nt=$m(vt);for(;Lt.length>0;){const zt=Lt.pop();if(zt[0]>=Rt)continue;const jt=zt[1],Wt=pt?50:100;if(Vp(jt)<=Wt){if(!Zl(jt,gt.length))return NaN;if(pt){const qt=go(gt,jt,vt,St);if(isNaN(qt)||qt===0)return qt;Rt=Math.min(Rt,qt)}else for(let qt=jt[0];qt<=jt[1];++qt){const ir=Uy(gt[qt],vt,St);if(Rt=Math.min(Rt,ir),Rt===0)return 0}}else{const qt=Lm(jt,pt);Co(Lt,Rt,St,gt,Nt,qt[0]),Co(Lt,Rt,St,gt,Nt,qt[1])}}return Rt}function gp(gt,pt,vt,St,Et,Rt=1/0){let Lt=Math.min(Rt,Et.distance(gt[0],vt[0]));if(Lt===0)return Lt;const Nt=new jv([[0,[0,gt.length-1],[0,vt.length-1]]],Zv);for(;Nt.length>0;){const zt=Nt.pop();if(zt[0]>=Lt)continue;const jt=zt[1],Wt=zt[2],qt=pt?50:100,ir=St?50:100;if(Vp(jt)<=qt&&Vp(Wt)<=ir){if(!Zl(jt,gt.length)&&Zl(Wt,vt.length))return NaN;let or;if(pt&&St)or=Vy(gt,jt,vt,Wt,Et),Lt=Math.min(Lt,or);else if(pt&&!St){const lr=gt.slice(jt[0],jt[1]+1);for(let pr=Wt[0];pr<=Wt[1];++pr)if(or=bu(vt[pr],lr,Et),Lt=Math.min(Lt,or),Lt===0)return Lt}else if(!pt&&St){const lr=vt.slice(Wt[0],Wt[1]+1);for(let pr=jt[0];pr<=jt[1];++pr)if(or=bu(gt[pr],lr,Et),Lt=Math.min(Lt,or),Lt===0)return Lt}else or=qo(gt,jt,vt,Wt,Et),Lt=Math.min(Lt,or)}else{const or=Lm(jt,pt),lr=Lm(Wt,St);xu(Nt,Lt,Et,gt,vt,or[0],lr[0]),xu(Nt,Lt,Et,gt,vt,or[0],lr[1]),xu(Nt,Lt,Et,gt,vt,or[1],lr[0]),xu(Nt,Lt,Et,gt,vt,or[1],lr[1])}}return Lt}function Fm(gt){return gt.type==="MultiPolygon"?gt.coordinates.map(pt=>({type:"Polygon",coordinates:pt})):gt.type==="MultiLineString"?gt.coordinates.map(pt=>({type:"LineString",coordinates:pt})):gt.type==="MultiPoint"?gt.coordinates.map(pt=>({type:"Point",coordinates:pt})):[gt]}class wu{constructor(pt,vt){this.type=_n,this.geojson=pt,this.geometries=vt}static parse(pt,vt){if(pt.length!==2)return vt.error(`'distance' expression requires exactly one argument, but found ${pt.length-1} instead.`);if($l(pt[1])){const St=pt[1];if(St.type==="FeatureCollection")return new wu(St,St.features.map(Et=>Fm(Et.geometry)).flat());if(St.type==="Feature")return new wu(St,Fm(St.geometry));if("type"in St&&"coordinates"in St)return new wu(St,Fm(St))}return vt.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(pt){if(pt.geometry()!=null&&pt.canonicalID()!=null){if(pt.geometryType()==="Point")return function(vt,St){const Et=vt.geometry(),Rt=Et.flat().map(zt=>Os([zt.x,zt.y],vt.canonical));if(Et.length===0)return NaN;const Lt=new Rm(Rt[0][1]);let Nt=1/0;for(const zt of St){switch(zt.type){case"Point":Nt=Math.min(Nt,gp(Rt,!1,[zt.coordinates],!1,Lt,Nt));break;case"LineString":Nt=Math.min(Nt,gp(Rt,!1,zt.coordinates,!0,Lt,Nt));break;case"Polygon":Nt=Math.min(Nt,pp(Rt,!1,zt.coordinates,Lt,Nt))}if(Nt===0)return Nt}return Nt}(pt,this.geometries);if(pt.geometryType()==="LineString")return function(vt,St){const Et=vt.geometry(),Rt=Et.flat().map(zt=>Os([zt.x,zt.y],vt.canonical));if(Et.length===0)return NaN;const Lt=new Rm(Rt[0][1]);let Nt=1/0;for(const zt of St){switch(zt.type){case"Point":Nt=Math.min(Nt,gp(Rt,!0,[zt.coordinates],!1,Lt,Nt));break;case"LineString":Nt=Math.min(Nt,gp(Rt,!0,zt.coordinates,!0,Lt,Nt));break;case"Polygon":Nt=Math.min(Nt,pp(Rt,!0,zt.coordinates,Lt,Nt))}if(Nt===0)return Nt}return Nt}(pt,this.geometries);if(pt.geometryType()==="Polygon")return function(vt,St){const Et=vt.geometry();if(Et.length===0||Et[0].length===0)return NaN;const Rt=zp(Et,0).map(zt=>zt.map(jt=>jt.map(Wt=>Os([Wt.x,Wt.y],vt.canonical)))),Lt=new Rm(Rt[0][0][0][1]);let Nt=1/0;for(const zt of St)for(const jt of Rt){switch(zt.type){case"Point":Nt=Math.min(Nt,pp([zt.coordinates],!1,jt,Lt,Nt));break;case"LineString":Nt=Math.min(Nt,pp(zt.coordinates,!0,jt,Lt,Nt));break;case"Polygon":Nt=Math.min(Nt,Oo(jt,zt.coordinates,Lt,Nt))}if(Nt===0)return Nt}return Nt}(pt,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ou={"==":Bp,"!=":fp,">":hr,"<":rr,">=":Or,"<=":xr,array:Vs,at:eu,boolean:Vs,case:fu,coalesce:mu,collator:Zr,format:wn,image:Xn,in:Lu,"index-of":Wl,interpolate:ds,"interpolate-hcl":ds,"interpolate-lab":ds,length:fo,let:Sl,literal:Ls,match:hu,number:Vs,"number-format":rn,object:Vs,slice:lo,step:so,string:Vs,"to-boolean":vs,"to-color":vs,"to-number":vs,"to-string":vs,var:So,within:yu,distance:wu};class Zs{constructor(pt,vt,St,Et){this.name=pt,this.type=vt,this._evaluate=St,this.args=Et}evaluate(pt){return this._evaluate(pt,this.args)}eachChild(pt){this.args.forEach(pt)}outputDefined(){return!1}static parse(pt,vt){const St=pt[0],Et=Zs.definitions[St];if(!Et)return vt.error(`Unknown expression "${St}". If you wanted a literal array, use ["literal", [...]].`,0);const Rt=Array.isArray(Et)?Et[0]:Et.type,Lt=Array.isArray(Et)?[[Et[1],Et[2]]]:Et.overloads,Nt=Lt.filter(([jt])=>!Array.isArray(jt)||jt.length===pt.length-1);let zt=null;for(const[jt,Wt]of Nt){zt=new Fl(vt.registry,mp,vt.path,null,vt.scope);const qt=[];let ir=!1;for(let or=1;or<pt.length;or++){const lr=pt[or],pr=Array.isArray(jt)?jt[or-1]:jt.type,Tr=zt.parse(lr,1+qt.length,pr);if(!Tr){ir=!0;break}qt.push(Tr)}if(!ir)if(Array.isArray(jt)&&jt.length!==qt.length)zt.error(`Expected ${jt.length} arguments, but found ${qt.length} instead.`);else{for(let or=0;or<qt.length;or++){const lr=Array.isArray(jt)?jt[or]:jt.type,pr=qt[or];zt.concat(or+1).checkSubtype(lr,pr.type)}if(zt.errors.length===0)return new Zs(St,Rt,Wt,qt)}}if(Nt.length===1)vt.errors.push(...zt.errors);else{const jt=(Nt.length?Nt:Lt).map(([qt])=>{return ir=qt,Array.isArray(ir)?`(${ir.map(tr).join(", ")})`:`(${tr(ir.type)}...)`;var ir}).join(" | "),Wt=[];for(let qt=1;qt<pt.length;qt++){const ir=vt.parse(pt[qt],1+Wt.length);if(!ir)return null;Wt.push(tr(ir.type))}vt.error(`Expected arguments of type ${jt}, but found (${Wt.join(", ")}) instead.`)}return null}static register(pt,vt){Zs.definitions=vt;for(const St in vt)pt[St]=Zs}}function Bm(gt,[pt,vt,St,Et]){pt=pt.evaluate(gt),vt=vt.evaluate(gt),St=St.evaluate(gt);const Rt=Et?Et.evaluate(gt):1,Lt=Ol(pt,vt,St,Rt);if(Lt)throw new Uo(Lt);return new ro(pt/255,vt/255,St/255,Rt,!1)}function zm(gt,pt){return gt in pt}function Vm(gt,pt){const vt=pt[gt];return vt===void 0?null:vt}function Su(gt){return{type:gt}}function mp(gt){if(gt instanceof So)return mp(gt.boundExpression);if(gt instanceof Zs&&gt.name==="error"||gt instanceof Zr||gt instanceof yu||gt instanceof wu)return!1;const pt=gt instanceof vs||gt instanceof Vs;let vt=!0;return gt.eachChild(St=>{vt=pt?vt&&mp(St):vt&&St instanceof Ls}),!!vt&&vp(gt)&&yp(gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function vp(gt){if(gt instanceof Zs&&(gt.name==="get"&&gt.args.length===1||gt.name==="feature-state"||gt.name==="has"&&gt.args.length===1||gt.name==="properties"||gt.name==="geometry-type"||gt.name==="id"||/^filter-/.test(gt.name))||gt instanceof yu||gt instanceof wu)return!1;let pt=!0;return gt.eachChild(vt=>{pt&&!vp(vt)&&(pt=!1)}),pt}function $u(gt){if(gt instanceof Zs&&gt.name==="feature-state")return!1;let pt=!0;return gt.eachChild(vt=>{pt&&!$u(vt)&&(pt=!1)}),pt}function yp(gt,pt){if(gt instanceof Zs&&pt.indexOf(gt.name)>=0)return!1;let vt=!0;return gt.eachChild(St=>{vt&&!yp(St,pt)&&(vt=!1)}),vt}function jp(gt){return{result:"success",value:gt}}function ku(gt){return{result:"error",value:gt}}function Nu(gt){return gt["property-type"]==="data-driven"||gt["property-type"]==="cross-faded-data-driven"}function Xv(gt){return!!gt.expression&&gt.expression.parameters.indexOf("zoom")>-1}function Um(gt){return!!gt.expression&&gt.expression.interpolated}function Ao(gt){return gt instanceof Number?"number":gt instanceof String?"string":gt instanceof Boolean?"boolean":Array.isArray(gt)?"array":gt===null?"null":typeof gt}function Hp(gt){return typeof gt=="object"&&gt!==null&&!Array.isArray(gt)}function Gy(gt){return gt}function Kv(gt,pt){const vt=pt.type==="color",St=gt.stops&&typeof gt.stops[0][0]=="object",Et=St||!(St||gt.property!==void 0),Rt=gt.type||(Um(pt)?"exponential":"interval");if(vt||pt.type==="padding"){const Wt=vt?ro.parse:mo.parse;(gt=Jo({},gt)).stops&&(gt.stops=gt.stops.map(qt=>[qt[0],Wt(qt[1])])),gt.default=Wt(gt.default?gt.default:pt.default)}if(gt.colorSpace&&(Lt=gt.colorSpace)!=="rgb"&&Lt!=="hcl"&&Lt!=="lab")throw new Error(`Unknown color space: "${gt.colorSpace}"`);var Lt;let Nt,zt,jt;if(Rt==="exponential")Nt=Qv;else if(Rt==="interval")Nt=Wp;else if(Rt==="categorical"){Nt=Jv,zt=Object.create(null);for(const Wt of gt.stops)zt[Wt[0]]=Wt[1];jt=typeof gt.stops[0][0]}else{if(Rt!=="identity")throw new Error(`Unknown function type "${Rt}"`);Nt=ey}if(St){const Wt={},qt=[];for(let lr=0;lr<gt.stops.length;lr++){const pr=gt.stops[lr],Tr=pr[0].zoom;Wt[Tr]===void 0&&(Wt[Tr]={zoom:Tr,type:gt.type,property:gt.property,default:gt.default,stops:[]},qt.push(Tr)),Wt[Tr].stops.push([pr[0].value,pr[1]])}const ir=[];for(const lr of qt)ir.push([Wt[lr].zoom,Kv(Wt[lr],pt)]);const or={name:"linear"};return{kind:"composite",interpolationType:or,interpolationFactor:ds.interpolationFactor.bind(void 0,or),zoomStops:ir.map(lr=>lr[0]),evaluate:({zoom:lr},pr)=>Qv({stops:ir,base:gt.base},pt,lr).evaluate(lr,pr)}}if(Et){const Wt=Rt==="exponential"?{name:"exponential",base:gt.base!==void 0?gt.base:1}:null;return{kind:"camera",interpolationType:Wt,interpolationFactor:ds.interpolationFactor.bind(void 0,Wt),zoomStops:gt.stops.map(qt=>qt[0]),evaluate:({zoom:qt})=>Nt(gt,pt,qt,zt,jt)}}return{kind:"source",evaluate(Wt,qt){const ir=qt&&qt.properties?qt.properties[gt.property]:void 0;return ir===void 0?Fu(gt.default,pt.default):Nt(gt,pt,ir,zt,jt)}}}function Fu(gt,pt,vt){return gt!==void 0?gt:pt!==void 0?pt:vt!==void 0?vt:void 0}function Jv(gt,pt,vt,St,Et){return Fu(typeof vt===Et?St[vt]:void 0,gt.default,pt.default)}function Wp(gt,pt,vt){if(Ao(vt)!=="number")return Fu(gt.default,pt.default);const St=gt.stops.length;if(St===1||vt<=gt.stops[0][0])return gt.stops[0][1];if(vt>=gt.stops[St-1][0])return gt.stops[St-1][1];const Et=du(gt.stops.map(Rt=>Rt[0]),vt);return gt.stops[Et][1]}function Qv(gt,pt,vt){const St=gt.base!==void 0?gt.base:1;if(Ao(vt)!=="number")return Fu(gt.default,pt.default);const Et=gt.stops.length;if(Et===1||vt<=gt.stops[0][0])return gt.stops[0][1];if(vt>=gt.stops[Et-1][0])return gt.stops[Et-1][1];const Rt=du(gt.stops.map(Wt=>Wt[0]),vt),Lt=function(Wt,qt,ir,or){const lr=or-ir,pr=Wt-ir;return lr===0?0:qt===1?pr/lr:(Math.pow(qt,pr)-1)/(Math.pow(qt,lr)-1)}(vt,St,gt.stops[Rt][0],gt.stops[Rt+1][0]),Nt=gt.stops[Rt][1],zt=gt.stops[Rt+1][1],jt=fs[pt.type]||Gy;return typeof Nt.evaluate=="function"?{evaluate(...Wt){const qt=Nt.evaluate.apply(void 0,Wt),ir=zt.evaluate.apply(void 0,Wt);if(qt!==void 0&&ir!==void 0)return jt(qt,ir,Lt,gt.colorSpace)}}:jt(Nt,zt,Lt,gt.colorSpace)}function ey(gt,pt,vt){switch(pt.type){case"color":vt=ro.parse(vt);break;case"formatted":vt=to.fromString(vt.toString());break;case"resolvedImage":vt=hs.fromString(vt.toString());break;case"padding":vt=mo.parse(vt);break;default:Ao(vt)===pt.type||pt.type==="enum"&&pt.values[vt]||(vt=void 0)}return Fu(vt,gt.default,pt.default)}Zs.register(Ou,{error:[{kind:"error"},[bn],(gt,[pt])=>{throw new Uo(pt.evaluate(gt))}],typeof:[bn,[Kn],(gt,[pt])=>tr(To(pt.evaluate(gt)))],"to-rgba":[er(_n,4),[ts],(gt,[pt])=>{const[vt,St,Et,Rt]=pt.evaluate(gt).rgb;return[255*vt,255*St,255*Et,Rt]}],rgb:[ts,[_n,_n,_n],Bm],rgba:[ts,[_n,_n,_n,_n],Bm],has:{type:Zn,overloads:[[[bn],(gt,[pt])=>zm(pt.evaluate(gt),gt.properties())],[[bn,ms],(gt,[pt,vt])=>zm(pt.evaluate(gt),vt.evaluate(gt))]]},get:{type:Kn,overloads:[[[bn],(gt,[pt])=>Vm(pt.evaluate(gt),gt.properties())],[[bn,ms],(gt,[pt,vt])=>Vm(pt.evaluate(gt),vt.evaluate(gt))]]},"feature-state":[Kn,[bn],(gt,[pt])=>Vm(pt.evaluate(gt),gt.featureState||{})],properties:[ms,[],gt=>gt.properties()],"geometry-type":[bn,[],gt=>gt.geometryType()],id:[Kn,[],gt=>gt.id()],zoom:[_n,[],gt=>gt.globals.zoom],"heatmap-density":[_n,[],gt=>gt.globals.heatmapDensity||0],"line-progress":[_n,[],gt=>gt.globals.lineProgress||0],accumulated:[Kn,[],gt=>gt.globals.accumulated===void 0?null:gt.globals.accumulated],"+":[_n,Su(_n),(gt,pt)=>{let vt=0;for(const St of pt)vt+=St.evaluate(gt);return vt}],"*":[_n,Su(_n),(gt,pt)=>{let vt=1;for(const St of pt)vt*=St.evaluate(gt);return vt}],"-":{type:_n,overloads:[[[_n,_n],(gt,[pt,vt])=>pt.evaluate(gt)-vt.evaluate(gt)],[[_n],(gt,[pt])=>-pt.evaluate(gt)]]},"/":[_n,[_n,_n],(gt,[pt,vt])=>pt.evaluate(gt)/vt.evaluate(gt)],"%":[_n,[_n,_n],(gt,[pt,vt])=>pt.evaluate(gt)%vt.evaluate(gt)],ln2:[_n,[],()=>Math.LN2],pi:[_n,[],()=>Math.PI],e:[_n,[],()=>Math.E],"^":[_n,[_n,_n],(gt,[pt,vt])=>Math.pow(pt.evaluate(gt),vt.evaluate(gt))],sqrt:[_n,[_n],(gt,[pt])=>Math.sqrt(pt.evaluate(gt))],log10:[_n,[_n],(gt,[pt])=>Math.log(pt.evaluate(gt))/Math.LN10],ln:[_n,[_n],(gt,[pt])=>Math.log(pt.evaluate(gt))],log2:[_n,[_n],(gt,[pt])=>Math.log(pt.evaluate(gt))/Math.LN2],sin:[_n,[_n],(gt,[pt])=>Math.sin(pt.evaluate(gt))],cos:[_n,[_n],(gt,[pt])=>Math.cos(pt.evaluate(gt))],tan:[_n,[_n],(gt,[pt])=>Math.tan(pt.evaluate(gt))],asin:[_n,[_n],(gt,[pt])=>Math.asin(pt.evaluate(gt))],acos:[_n,[_n],(gt,[pt])=>Math.acos(pt.evaluate(gt))],atan:[_n,[_n],(gt,[pt])=>Math.atan(pt.evaluate(gt))],min:[_n,Su(_n),(gt,pt)=>Math.min(...pt.map(vt=>vt.evaluate(gt)))],max:[_n,Su(_n),(gt,pt)=>Math.max(...pt.map(vt=>vt.evaluate(gt)))],abs:[_n,[_n],(gt,[pt])=>Math.abs(pt.evaluate(gt))],round:[_n,[_n],(gt,[pt])=>{const vt=pt.evaluate(gt);return vt<0?-Math.round(-vt):Math.round(vt)}],floor:[_n,[_n],(gt,[pt])=>Math.floor(pt.evaluate(gt))],ceil:[_n,[_n],(gt,[pt])=>Math.ceil(pt.evaluate(gt))],"filter-==":[Zn,[bn,Kn],(gt,[pt,vt])=>gt.properties()[pt.value]===vt.value],"filter-id-==":[Zn,[Kn],(gt,[pt])=>gt.id()===pt.value],"filter-type-==":[Zn,[bn],(gt,[pt])=>gt.geometryType()===pt.value],"filter-<":[Zn,[bn,Kn],(gt,[pt,vt])=>{const St=gt.properties()[pt.value],Et=vt.value;return typeof St==typeof Et&&St<Et}],"filter-id-<":[Zn,[Kn],(gt,[pt])=>{const vt=gt.id(),St=pt.value;return typeof vt==typeof St&&vt<St}],"filter->":[Zn,[bn,Kn],(gt,[pt,vt])=>{const St=gt.properties()[pt.value],Et=vt.value;return typeof St==typeof Et&&St>Et}],"filter-id->":[Zn,[Kn],(gt,[pt])=>{const vt=gt.id(),St=pt.value;return typeof vt==typeof St&&vt>St}],"filter-<=":[Zn,[bn,Kn],(gt,[pt,vt])=>{const St=gt.properties()[pt.value],Et=vt.value;return typeof St==typeof Et&&St<=Et}],"filter-id-<=":[Zn,[Kn],(gt,[pt])=>{const vt=gt.id(),St=pt.value;return typeof vt==typeof St&&vt<=St}],"filter->=":[Zn,[bn,Kn],(gt,[pt,vt])=>{const St=gt.properties()[pt.value],Et=vt.value;return typeof St==typeof Et&&St>=Et}],"filter-id->=":[Zn,[Kn],(gt,[pt])=>{const vt=gt.id(),St=pt.value;return typeof vt==typeof St&&vt>=St}],"filter-has":[Zn,[Kn],(gt,[pt])=>pt.value in gt.properties()],"filter-has-id":[Zn,[],gt=>gt.id()!==null&&gt.id()!==void 0],"filter-type-in":[Zn,[er(bn)],(gt,[pt])=>pt.value.indexOf(gt.geometryType())>=0],"filter-id-in":[Zn,[er(Kn)],(gt,[pt])=>pt.value.indexOf(gt.id())>=0],"filter-in-small":[Zn,[bn,er(Kn)],(gt,[pt,vt])=>vt.value.indexOf(gt.properties()[pt.value])>=0],"filter-in-large":[Zn,[bn,er(Kn)],(gt,[pt,vt])=>function(St,Et,Rt,Lt){for(;Rt<=Lt;){const Nt=Rt+Lt>>1;if(Et[Nt]===St)return!0;Et[Nt]>St?Lt=Nt-1:Rt=Nt+1}return!1}(gt.properties()[pt.value],vt.value,0,vt.value.length-1)],all:{type:Zn,overloads:[[[Zn,Zn],(gt,[pt,vt])=>pt.evaluate(gt)&&vt.evaluate(gt)],[Su(Zn),(gt,pt)=>{for(const vt of pt)if(!vt.evaluate(gt))return!1;return!0}]]},any:{type:Zn,overloads:[[[Zn,Zn],(gt,[pt,vt])=>pt.evaluate(gt)||vt.evaluate(gt)],[Su(Zn),(gt,pt)=>{for(const vt of pt)if(vt.evaluate(gt))return!0;return!1}]]},"!":[Zn,[Zn],(gt,[pt])=>!pt.evaluate(gt)],"is-supported-script":[Zn,[bn],(gt,[pt])=>{const vt=gt.globals&&gt.globals.isSupportedScript;return!vt||vt(pt.evaluate(gt))}],upcase:[bn,[bn],(gt,[pt])=>pt.evaluate(gt).toUpperCase()],downcase:[bn,[bn],(gt,[pt])=>pt.evaluate(gt).toLowerCase()],concat:[bn,Su(Kn),(gt,pt)=>pt.map(vt=>Nl(vt.evaluate(gt))).join("")],"resolved-locale":[bn,[co],(gt,[pt])=>pt.evaluate(gt).resolvedLocale()]});class Yp{constructor(pt,vt){var St;this.expression=pt,this._warningHistory={},this._evaluator=new cu,this._defaultValue=vt?(St=vt).type==="color"&&Hp(St.default)?new ro(0,0,0,0):St.type==="color"?ro.parse(St.default)||null:St.type==="padding"?mo.parse(St.default)||null:St.type==="variableAnchorOffsetCollection"?Yo.parse(St.default)||null:St.default===void 0?null:St.default:null,this._enumValues=vt&&vt.type==="enum"?vt.values:null}evaluateWithoutErrorHandling(pt,vt,St,Et,Rt,Lt){return this._evaluator.globals=pt,this._evaluator.feature=vt,this._evaluator.featureState=St,this._evaluator.canonical=Et,this._evaluator.availableImages=Rt||null,this._evaluator.formattedSection=Lt,this.expression.evaluate(this._evaluator)}evaluate(pt,vt,St,Et,Rt,Lt){this._evaluator.globals=pt,this._evaluator.feature=vt||null,this._evaluator.featureState=St||null,this._evaluator.canonical=Et,this._evaluator.availableImages=Rt||null,this._evaluator.formattedSection=Lt||null;try{const Nt=this.expression.evaluate(this._evaluator);if(Nt==null||typeof Nt=="number"&&Nt!=Nt)return this._defaultValue;if(this._enumValues&&!(Nt in this._enumValues))throw new Uo(`Expected value to be one of ${Object.keys(this._enumValues).map(zt=>JSON.stringify(zt)).join(", ")}, but found ${JSON.stringify(Nt)} instead.`);return Nt}catch(Nt){return this._warningHistory[Nt.message]||(this._warningHistory[Nt.message]=!0,typeof console<"u"&&console.warn(Nt.message)),this._defaultValue}}}function qp(gt){return Array.isArray(gt)&&gt.length>0&&typeof gt[0]=="string"&&gt[0]in Ou}function Bu(gt,pt){const vt=new Fl(Ou,mp,[],pt?function(Et){const Rt={color:ts,string:bn,number:_n,enum:bn,boolean:Zn,formatted:cs,padding:Ms,resolvedImage:ns,variableAnchorOffsetCollection:yr};return Et.type==="array"?er(Rt[Et.value]||Kn,Et.length):Rt[Et.type]}(pt):void 0),St=vt.parse(gt,void 0,void 0,void 0,pt&&pt.type==="string"?{typeAnnotation:"coerce"}:void 0);return St?jp(new Yp(St,pt)):ku(vt.errors)}class zu{constructor(pt,vt){this.kind=pt,this._styleExpression=vt,this.isStateDependent=pt!=="constant"&&!$u(vt.expression)}evaluateWithoutErrorHandling(pt,vt,St,Et,Rt,Lt){return this._styleExpression.evaluateWithoutErrorHandling(pt,vt,St,Et,Rt,Lt)}evaluate(pt,vt,St,Et,Rt,Lt){return this._styleExpression.evaluate(pt,vt,St,Et,Rt,Lt)}}class Vu{constructor(pt,vt,St,Et){this.kind=pt,this.zoomStops=St,this._styleExpression=vt,this.isStateDependent=pt!=="camera"&&!$u(vt.expression),this.interpolationType=Et}evaluateWithoutErrorHandling(pt,vt,St,Et,Rt,Lt){return this._styleExpression.evaluateWithoutErrorHandling(pt,vt,St,Et,Rt,Lt)}evaluate(pt,vt,St,Et,Rt,Lt){return this._styleExpression.evaluate(pt,vt,St,Et,Rt,Lt)}interpolationFactor(pt,vt,St){return this.interpolationType?ds.interpolationFactor(this.interpolationType,pt,vt,St):0}}function Gm(gt,pt){const vt=Bu(gt,pt);if(vt.result==="error")return vt;const St=vt.value.expression,Et=vp(St);if(!Et&&!Nu(pt))return ku([new Wo("","data expressions not supported")]);const Rt=yp(St,["zoom"]);if(!Rt&&!Xv(pt))return ku([new Wo("","zoom expressions not supported")]);const Lt=bp(St);return Lt||Rt?Lt instanceof Wo?ku([Lt]):Lt instanceof ds&&!Um(pt)?ku([new Wo("",'"interpolate" expressions cannot be used with this property')]):jp(Lt?new Vu(Et?"camera":"composite",vt.value,Lt.labels,Lt instanceof ds?Lt.interpolation:void 0):new zu(Et?"constant":"source",vt.value)):ku([new Wo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Uu{constructor(pt,vt){this._parameters=pt,this._specification=vt,Jo(this,Kv(this._parameters,this._specification))}static deserialize(pt){return new Uu(pt._parameters,pt._specification)}static serialize(pt){return{_parameters:pt._parameters,_specification:pt._specification}}}function bp(gt){let pt=null;if(gt instanceof Sl)pt=bp(gt.result);else if(gt instanceof mu){for(const vt of gt.args)if(pt=bp(vt),pt)break}else(gt instanceof so||gt instanceof ds)&&gt.input instanceof Zs&&gt.input.name==="zoom"&&(pt=gt);return pt instanceof Wo||gt.eachChild(vt=>{const St=bp(vt);St instanceof Wo?pt=St:!pt&&St?pt=new Wo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):pt&&St&&pt!==St&&(pt=new Wo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),pt}function Zp(gt){if(gt===!0||gt===!1)return!0;if(!Array.isArray(gt)||gt.length===0)return!1;switch(gt[0]){case"has":return gt.length>=2&&gt[1]!=="$id"&&gt[1]!=="$type";case"in":return gt.length>=3&&(typeof gt[1]!="string"||Array.isArray(gt[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return gt.length!==3||Array.isArray(gt[1])||Array.isArray(gt[2]);case"any":case"all":for(const pt of gt.slice(1))if(!Zp(pt)&&typeof pt!="boolean")return!1;return!0;default:return!0}}const Xp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function jm(gt){if(gt==null)return{filter:()=>!0,needGeometry:!1};Zp(gt)||(gt=Kp(gt));const pt=Bu(gt,Xp);if(pt.result==="error")throw new Error(pt.value.map(vt=>`${vt.key}: ${vt.message}`).join(", "));return{filter:(vt,St,Et)=>pt.value.evaluate(vt,St,{},Et),needGeometry:ty(gt)}}function jy(gt,pt){return gt<pt?-1:gt>pt?1:0}function ty(gt){if(!Array.isArray(gt))return!1;if(gt[0]==="within"||gt[0]==="distance")return!0;for(let pt=1;pt<gt.length;pt++)if(ty(gt[pt]))return!0;return!1}function Kp(gt){if(!gt)return!0;const pt=gt[0];return gt.length<=1?pt!=="any":pt==="=="?Hm(gt[1],gt[2],"=="):pt==="!="?ys(Hm(gt[1],gt[2],"==")):pt==="<"||pt===">"||pt==="<="||pt===">="?Hm(gt[1],gt[2],pt):pt==="any"?(vt=gt.slice(1),["any"].concat(vt.map(Kp))):pt==="all"?["all"].concat(gt.slice(1).map(Kp)):pt==="none"?["all"].concat(gt.slice(1).map(Kp).map(ys)):pt==="in"?xp(gt[1],gt.slice(2)):pt==="!in"?ys(xp(gt[1],gt.slice(2))):pt==="has"?wp(gt[1]):pt!=="!has"||ys(wp(gt[1]));var vt}function Hm(gt,pt,vt){switch(gt){case"$type":return[`filter-type-${vt}`,pt];case"$id":return[`filter-id-${vt}`,pt];default:return[`filter-${vt}`,gt,pt]}}function xp(gt,pt){if(pt.length===0)return!1;switch(gt){case"$type":return["filter-type-in",["literal",pt]];case"$id":return["filter-id-in",["literal",pt]];default:return pt.length>200&&!pt.some(vt=>typeof vt!=typeof pt[0])?["filter-in-large",gt,["literal",pt.sort(jy)]]:["filter-in-small",gt,["literal",pt]]}}function wp(gt){switch(gt){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",gt]}}function ys(gt){return["!",gt]}function Tu(gt){const pt=typeof gt;if(pt==="number"||pt==="boolean"||pt==="string"||gt==null)return JSON.stringify(gt);if(Array.isArray(gt)){let Et="[";for(const Rt of gt)Et+=`${Tu(Rt)},`;return`${Et}]`}const vt=Object.keys(gt).sort();let St="{";for(let Et=0;Et<vt.length;Et++)St+=`${JSON.stringify(vt[Et])}:${Tu(gt[vt[Et]])},`;return`${St}}`}function ry(gt){let pt="";for(const vt of ao)pt+=`/${Tu(gt[vt])}`;return pt}function ny(gt){const pt=gt.value;return pt?[new gn(gt.key,pt,"constants have been deprecated as of v8")]:[]}function Zo(gt){return gt instanceof Number||gt instanceof String||gt instanceof Boolean?gt.valueOf():gt}function Al(gt){if(Array.isArray(gt))return gt.map(Al);if(gt instanceof Object&&!(gt instanceof Number||gt instanceof String||gt instanceof Boolean)){const pt={};for(const vt in gt)pt[vt]=Al(gt[vt]);return pt}return Zo(gt)}function Gs(gt){const pt=gt.key,vt=gt.value,St=gt.valueSpec||{},Et=gt.objectElementValidators||{},Rt=gt.style,Lt=gt.styleSpec,Nt=gt.validateSpec;let zt=[];const jt=Ao(vt);if(jt!=="object")return[new gn(pt,vt,`object expected, ${jt} found`)];for(const Wt in vt){const qt=Wt.split(".")[0],ir=St[qt]||St["*"];let or;if(Et[qt])or=Et[qt];else if(St[qt])or=Nt;else if(Et["*"])or=Et["*"];else{if(!St["*"]){zt.push(new gn(pt,vt[Wt],`unknown property "${Wt}"`));continue}or=Nt}zt=zt.concat(or({key:(pt&&`${pt}.`)+Wt,value:vt[Wt],valueSpec:ir,style:Rt,styleSpec:Lt,object:vt,objectKey:Wt,validateSpec:Nt},vt))}for(const Wt in St)Et[Wt]||St[Wt].required&&St[Wt].default===void 0&&vt[Wt]===void 0&&zt.push(new gn(pt,vt,`missing required property "${Wt}"`));return zt}function Sp(gt){const pt=gt.value,vt=gt.valueSpec,St=gt.style,Et=gt.styleSpec,Rt=gt.key,Lt=gt.arrayElementValidator||gt.validateSpec;if(Ao(pt)!=="array")return[new gn(Rt,pt,`array expected, ${Ao(pt)} found`)];if(vt.length&&pt.length!==vt.length)return[new gn(Rt,pt,`array length ${vt.length} expected, length ${pt.length} found`)];if(vt["min-length"]&&pt.length<vt["min-length"])return[new gn(Rt,pt,`array length at least ${vt["min-length"]} expected, length ${pt.length} found`)];let Nt={type:vt.value,values:vt.values};Et.$version<7&&(Nt.function=vt.function),Ao(vt.value)==="object"&&(Nt=vt.value);let zt=[];for(let jt=0;jt<pt.length;jt++)zt=zt.concat(Lt({array:pt,arrayIndex:jt,value:pt[jt],valueSpec:Nt,validateSpec:gt.validateSpec,style:St,styleSpec:Et,key:`${Rt}[${jt}]`}));return zt}function Wm(gt){const pt=gt.key,vt=gt.value,St=gt.valueSpec;let Et=Ao(vt);return Et==="number"&&vt!=vt&&(Et="NaN"),Et!=="number"?[new gn(pt,vt,`number expected, ${Et} found`)]:"minimum"in St&&vt<St.minimum?[new gn(pt,vt,`${vt} is less than the minimum value ${St.minimum}`)]:"maximum"in St&&vt>St.maximum?[new gn(pt,vt,`${vt} is greater than the maximum value ${St.maximum}`)]:[]}function Jp(gt){const pt=gt.valueSpec,vt=Zo(gt.value.type);let St,Et,Rt,Lt={};const Nt=vt!=="categorical"&&gt.value.property===void 0,zt=!Nt,jt=Ao(gt.value.stops)==="array"&&Ao(gt.value.stops[0])==="array"&&Ao(gt.value.stops[0][0])==="object",Wt=Gs({key:gt.key,value:gt.value,valueSpec:gt.styleSpec.function,validateSpec:gt.validateSpec,style:gt.style,styleSpec:gt.styleSpec,objectElementValidators:{stops:function(or){if(vt==="identity")return[new gn(or.key,or.value,'identity function may not have a "stops" property')];let lr=[];const pr=or.value;return lr=lr.concat(Sp({key:or.key,value:pr,valueSpec:or.valueSpec,validateSpec:or.validateSpec,style:or.style,styleSpec:or.styleSpec,arrayElementValidator:qt})),Ao(pr)==="array"&&pr.length===0&&lr.push(new gn(or.key,pr,"array must have at least one stop")),lr},default:function(or){return or.validateSpec({key:or.key,value:or.value,valueSpec:pt,validateSpec:or.validateSpec,style:or.style,styleSpec:or.styleSpec})}}});return vt==="identity"&&Nt&&Wt.push(new gn(gt.key,gt.value,'missing required property "property"')),vt==="identity"||gt.value.stops||Wt.push(new gn(gt.key,gt.value,'missing required property "stops"')),vt==="exponential"&&gt.valueSpec.expression&&!Um(gt.valueSpec)&&Wt.push(new gn(gt.key,gt.value,"exponential functions not supported")),gt.styleSpec.$version>=8&&(zt&&!Nu(gt.valueSpec)?Wt.push(new gn(gt.key,gt.value,"property functions not supported")):Nt&&!Xv(gt.valueSpec)&&Wt.push(new gn(gt.key,gt.value,"zoom functions not supported"))),vt!=="categorical"&&!jt||gt.value.property!==void 0||Wt.push(new gn(gt.key,gt.value,'"property" property is required')),Wt;function qt(or){let lr=[];const pr=or.value,Tr=or.key;if(Ao(pr)!=="array")return[new gn(Tr,pr,`array expected, ${Ao(pr)} found`)];if(pr.length!==2)return[new gn(Tr,pr,`array length 2 expected, length ${pr.length} found`)];if(jt){if(Ao(pr[0])!=="object")return[new gn(Tr,pr,`object expected, ${Ao(pr[0])} found`)];if(pr[0].zoom===void 0)return[new gn(Tr,pr,"object stop key must have zoom")];if(pr[0].value===void 0)return[new gn(Tr,pr,"object stop key must have value")];if(Rt&&Rt>Zo(pr[0].zoom))return[new gn(Tr,pr[0].zoom,"stop zoom values must appear in ascending order")];Zo(pr[0].zoom)!==Rt&&(Rt=Zo(pr[0].zoom),Et=void 0,Lt={}),lr=lr.concat(Gs({key:`${Tr}[0]`,value:pr[0],valueSpec:{zoom:{}},validateSpec:or.validateSpec,style:or.style,styleSpec:or.styleSpec,objectElementValidators:{zoom:Wm,value:ir}}))}else lr=lr.concat(ir({key:`${Tr}[0]`,value:pr[0],validateSpec:or.validateSpec,style:or.style,styleSpec:or.styleSpec},pr));return qp(Al(pr[1]))?lr.concat([new gn(`${Tr}[1]`,pr[1],"expressions are not allowed in function stops.")]):lr.concat(or.validateSpec({key:`${Tr}[1]`,value:pr[1],valueSpec:pt,validateSpec:or.validateSpec,style:or.style,styleSpec:or.styleSpec}))}function ir(or,lr){const pr=Ao(or.value),Tr=Zo(or.value),Ir=or.value!==null?or.value:lr;if(St){if(pr!==St)return[new gn(or.key,Ir,`${pr} stop domain type must match previous stop domain type ${St}`)]}else St=pr;if(pr!=="number"&&pr!=="string"&&pr!=="boolean")return[new gn(or.key,Ir,"stop domain value must be a number, string, or boolean")];if(pr!=="number"&&vt!=="categorical"){let Wr=`number expected, ${pr} found`;return Nu(pt)&&vt===void 0&&(Wr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gn(or.key,Ir,Wr)]}return vt!=="categorical"||pr!=="number"||isFinite(Tr)&&Math.floor(Tr)===Tr?vt!=="categorical"&&pr==="number"&&Et!==void 0&&Tr<Et?[new gn(or.key,Ir,"stop domain values must appear in ascending order")]:(Et=Tr,vt==="categorical"&&Tr in Lt?[new gn(or.key,Ir,"stop domain values must be unique")]:(Lt[Tr]=!0,[])):[new gn(or.key,Ir,`integer expected, found ${Tr}`)]}}function Gu(gt){const pt=(gt.expressionContext==="property"?Gm:Bu)(Al(gt.value),gt.valueSpec);if(pt.result==="error")return pt.value.map(St=>new gn(`${gt.key}${St.key}`,gt.value,St.message));const vt=pt.value.expression||pt.value._styleExpression.expression;if(gt.expressionContext==="property"&&gt.propertyKey==="text-font"&&!vt.outputDefined())return[new gn(gt.key,gt.value,`Invalid data expression for "${gt.propertyKey}". Output values must be contained as literals within the expression.`)];if(gt.expressionContext==="property"&&gt.propertyType==="layout"&&!$u(vt))return[new gn(gt.key,gt.value,'"feature-state" data expressions are not supported with layout properties.')];if(gt.expressionContext==="filter"&&!$u(vt))return[new gn(gt.key,gt.value,'"feature-state" data expressions are not supported with filters.')];if(gt.expressionContext&&gt.expressionContext.indexOf("cluster")===0){if(!yp(vt,["zoom","feature-state"]))return[new gn(gt.key,gt.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(gt.expressionContext==="cluster-initial"&&!vp(vt))return[new gn(gt.key,gt.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xl(gt){const pt=gt.key,vt=gt.value,St=gt.valueSpec,Et=[];return Array.isArray(St.values)?St.values.indexOf(Zo(vt))===-1&&Et.push(new gn(pt,vt,`expected one of [${St.values.join(", ")}], ${JSON.stringify(vt)} found`)):Object.keys(St.values).indexOf(Zo(vt))===-1&&Et.push(new gn(pt,vt,`expected one of [${Object.keys(St.values).join(", ")}], ${JSON.stringify(vt)} found`)),Et}function Ym(gt){return Zp(Al(gt.value))?Gu(Jo({},gt,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Qp(gt)}function Qp(gt){const pt=gt.value,vt=gt.key;if(Ao(pt)!=="array")return[new gn(vt,pt,`array expected, ${Ao(pt)} found`)];const St=gt.styleSpec;let Et,Rt=[];if(pt.length<1)return[new gn(vt,pt,"filter array must have at least 1 element")];switch(Rt=Rt.concat(Xl({key:`${vt}[0]`,value:pt[0],valueSpec:St.filter_operator,style:gt.style,styleSpec:gt.styleSpec})),Zo(pt[0])){case"<":case"<=":case">":case">=":pt.length>=2&&Zo(pt[1])==="$type"&&Rt.push(new gn(vt,pt,`"$type" cannot be use with operator "${pt[0]}"`));case"==":case"!=":pt.length!==3&&Rt.push(new gn(vt,pt,`filter array for operator "${pt[0]}" must have 3 elements`));case"in":case"!in":pt.length>=2&&(Et=Ao(pt[1]),Et!=="string"&&Rt.push(new gn(`${vt}[1]`,pt[1],`string expected, ${Et} found`)));for(let Lt=2;Lt<pt.length;Lt++)Et=Ao(pt[Lt]),Zo(pt[1])==="$type"?Rt=Rt.concat(Xl({key:`${vt}[${Lt}]`,value:pt[Lt],valueSpec:St.geometry_type,style:gt.style,styleSpec:gt.styleSpec})):Et!=="string"&&Et!=="number"&&Et!=="boolean"&&Rt.push(new gn(`${vt}[${Lt}]`,pt[Lt],`string, number, or boolean expected, ${Et} found`));break;case"any":case"all":case"none":for(let Lt=1;Lt<pt.length;Lt++)Rt=Rt.concat(Qp({key:`${vt}[${Lt}]`,value:pt[Lt],style:gt.style,styleSpec:gt.styleSpec}));break;case"has":case"!has":Et=Ao(pt[1]),pt.length!==2?Rt.push(new gn(vt,pt,`filter array for "${pt[0]}" operator must have 2 elements`)):Et!=="string"&&Rt.push(new gn(`${vt}[1]`,pt[1],`string expected, ${Et} found`))}return Rt}function qm(gt,pt){const vt=gt.key,St=gt.validateSpec,Et=gt.style,Rt=gt.styleSpec,Lt=gt.value,Nt=gt.objectKey,zt=Rt[`${pt}_${gt.layerType}`];if(!zt)return[];const jt=Nt.match(/^(.*)-transition$/);if(pt==="paint"&&jt&&zt[jt[1]]&&zt[jt[1]].transition)return St({key:vt,value:Lt,valueSpec:Rt.transition,style:Et,styleSpec:Rt});const Wt=gt.valueSpec||zt[Nt];if(!Wt)return[new gn(vt,Lt,`unknown property "${Nt}"`)];let qt;if(Ao(Lt)==="string"&&Nu(Wt)&&!Wt.tokens&&(qt=/^{([^}]+)}$/.exec(Lt)))return[new gn(vt,Lt,`"${Nt}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(qt[1])} }\`.`)];const ir=[];return gt.layerType==="symbol"&&(Nt==="text-field"&&Et&&!Et.glyphs&&ir.push(new gn(vt,Lt,'use of "text-field" requires a style "glyphs" property')),Nt==="text-font"&&Hp(Al(Lt))&&Zo(Lt.type)==="identity"&&ir.push(new gn(vt,Lt,'"text-font" does not support identity functions'))),ir.concat(St({key:gt.key,value:Lt,valueSpec:Wt,style:Et,styleSpec:Rt,expressionContext:"property",propertyType:pt,propertyKey:Nt}))}function em(gt){return qm(gt,"paint")}function Zm(gt){return qm(gt,"layout")}function Xm(gt){let pt=[];const vt=gt.value,St=gt.key,Et=gt.style,Rt=gt.styleSpec;vt.type||vt.ref||pt.push(new gn(St,vt,'either "type" or "ref" is required'));let Lt=Zo(vt.type);const Nt=Zo(vt.ref);if(vt.id){const zt=Zo(vt.id);for(let jt=0;jt<gt.arrayIndex;jt++){const Wt=Et.layers[jt];Zo(Wt.id)===zt&&pt.push(new gn(St,vt.id,`duplicate layer id "${vt.id}", previously used at line ${Wt.id.__line__}`))}}if("ref"in vt){let zt;["type","source","source-layer","filter","layout"].forEach(jt=>{jt in vt&&pt.push(new gn(St,vt[jt],`"${jt}" is prohibited for ref layers`))}),Et.layers.forEach(jt=>{Zo(jt.id)===Nt&&(zt=jt)}),zt?zt.ref?pt.push(new gn(St,vt.ref,"ref cannot reference another ref layer")):Lt=Zo(zt.type):pt.push(new gn(St,vt.ref,`ref layer "${Nt}" not found`))}else if(Lt!=="background")if(vt.source){const zt=Et.sources&&Et.sources[vt.source],jt=zt&&Zo(zt.type);zt?jt==="vector"&&Lt==="raster"?pt.push(new gn(St,vt.source,`layer "${vt.id}" requires a raster source`)):jt!=="raster-dem"&&Lt==="hillshade"?pt.push(new gn(St,vt.source,`layer "${vt.id}" requires a raster-dem source`)):jt==="raster"&&Lt!=="raster"?pt.push(new gn(St,vt.source,`layer "${vt.id}" requires a vector source`)):jt!=="vector"||vt["source-layer"]?jt==="raster-dem"&&Lt!=="hillshade"?pt.push(new gn(St,vt.source,"raster-dem source can only be used with layer type 'hillshade'.")):Lt!=="line"||!vt.paint||!vt.paint["line-gradient"]||jt==="geojson"&&zt.lineMetrics||pt.push(new gn(St,vt,`layer "${vt.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):pt.push(new gn(St,vt,`layer "${vt.id}" must specify a "source-layer"`)):pt.push(new gn(St,vt.source,`source "${vt.source}" not found`))}else pt.push(new gn(St,vt,'missing required property "source"'));return pt=pt.concat(Gs({key:St,value:vt,valueSpec:Rt.layer,style:gt.style,styleSpec:gt.styleSpec,validateSpec:gt.validateSpec,objectElementValidators:{"*":()=>[],type:()=>gt.validateSpec({key:`${St}.type`,value:vt.type,valueSpec:Rt.layer.type,style:gt.style,styleSpec:gt.styleSpec,validateSpec:gt.validateSpec,object:vt,objectKey:"type"}),filter:Ym,layout:zt=>Gs({layer:vt,key:zt.key,value:zt.value,style:zt.style,styleSpec:zt.styleSpec,validateSpec:zt.validateSpec,objectElementValidators:{"*":jt=>Zm(Jo({layerType:Lt},jt))}}),paint:zt=>Gs({layer:vt,key:zt.key,value:zt.value,style:zt.style,styleSpec:zt.styleSpec,validateSpec:zt.validateSpec,objectElementValidators:{"*":jt=>em(Jo({layerType:Lt},jt))}})}})),pt}function Au(gt){const pt=gt.value,vt=gt.key,St=Ao(pt);return St!=="string"?[new gn(vt,pt,`string expected, ${St} found`)]:[]}const tm={promoteId:function({key:gt,value:pt}){if(Ao(pt)==="string")return Au({key:gt,value:pt});{const vt=[];for(const St in pt)vt.push(...Au({key:`${gt}.${St}`,value:pt[St]}));return vt}}};function Tp(gt){const pt=gt.value,vt=gt.key,St=gt.styleSpec,Et=gt.style,Rt=gt.validateSpec;if(!pt.type)return[new gn(vt,pt,'"type" is required')];const Lt=Zo(pt.type);let Nt;switch(Lt){case"vector":case"raster":return Nt=Gs({key:vt,value:pt,valueSpec:St[`source_${Lt.replace("-","_")}`],style:gt.style,styleSpec:St,objectElementValidators:tm,validateSpec:Rt}),Nt;case"raster-dem":return Nt=function(zt){var jt;const Wt=(jt=zt.sourceName)!==null&&jt!==void 0?jt:"",qt=zt.value,ir=zt.styleSpec,or=ir.source_raster_dem,lr=zt.style;let pr=[];const Tr=Ao(qt);if(qt===void 0)return pr;if(Tr!=="object")return pr.push(new gn("source_raster_dem",qt,`object expected, ${Tr} found`)),pr;const Ir=Zo(qt.encoding)==="custom",Wr=["redFactor","greenFactor","blueFactor","baseShift"],$r=zt.value.encoding?`"${zt.value.encoding}"`:"Default";for(const jr in qt)!Ir&&Wr.includes(jr)?pr.push(new gn(jr,qt[jr],`In "${Wt}": "${jr}" is only valid when "encoding" is set to "custom". ${$r} encoding found`)):or[jr]?pr=pr.concat(zt.validateSpec({key:jr,value:qt[jr],valueSpec:or[jr],validateSpec:zt.validateSpec,style:lr,styleSpec:ir})):pr.push(new gn(jr,qt[jr],`unknown property "${jr}"`));return pr}({sourceName:vt,value:pt,style:gt.style,styleSpec:St,validateSpec:Rt}),Nt;case"geojson":if(Nt=Gs({key:vt,value:pt,valueSpec:St.source_geojson,style:Et,styleSpec:St,validateSpec:Rt,objectElementValidators:tm}),pt.cluster)for(const zt in pt.clusterProperties){const[jt,Wt]=pt.clusterProperties[zt],qt=typeof jt=="string"?[jt,["accumulated"],["get",zt]]:jt;Nt.push(...Gu({key:`${vt}.${zt}.map`,value:Wt,expressionContext:"cluster-map"})),Nt.push(...Gu({key:`${vt}.${zt}.reduce`,value:qt,expressionContext:"cluster-reduce"}))}return Nt;case"video":return Gs({key:vt,value:pt,valueSpec:St.source_video,style:Et,validateSpec:Rt,styleSpec:St});case"image":return Gs({key:vt,value:pt,valueSpec:St.source_image,style:Et,validateSpec:Rt,styleSpec:St});case"canvas":return[new gn(vt,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xl({key:`${vt}.type`,value:pt.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Km(gt){const pt=gt.value,vt=gt.styleSpec,St=vt.light,Et=gt.style;let Rt=[];const Lt=Ao(pt);if(pt===void 0)return Rt;if(Lt!=="object")return Rt=Rt.concat([new gn("light",pt,`object expected, ${Lt} found`)]),Rt;for(const Nt in pt){const zt=Nt.match(/^(.*)-transition$/);Rt=Rt.concat(zt&&St[zt[1]]&&St[zt[1]].transition?gt.validateSpec({key:Nt,value:pt[Nt],valueSpec:vt.transition,validateSpec:gt.validateSpec,style:Et,styleSpec:vt}):St[Nt]?gt.validateSpec({key:Nt,value:pt[Nt],valueSpec:St[Nt],validateSpec:gt.validateSpec,style:Et,styleSpec:vt}):[new gn(Nt,pt[Nt],`unknown property "${Nt}"`)])}return Rt}function Jm(gt){const pt=gt.value,vt=gt.styleSpec,St=vt.sky,Et=gt.style,Rt=Ao(pt);if(pt===void 0)return[];if(Rt!=="object")return[new gn("sky",pt,`object expected, ${Rt} found`)];let Lt=[];for(const Nt in pt)Lt=Lt.concat(St[Nt]?gt.validateSpec({key:Nt,value:pt[Nt],valueSpec:St[Nt],style:Et,styleSpec:vt}):[new gn(Nt,pt[Nt],`unknown property "${Nt}"`)]);return Lt}function Qm(gt){const pt=gt.value,vt=gt.styleSpec,St=vt.terrain,Et=gt.style;let Rt=[];const Lt=Ao(pt);if(pt===void 0)return Rt;if(Lt!=="object")return Rt=Rt.concat([new gn("terrain",pt,`object expected, ${Lt} found`)]),Rt;for(const Nt in pt)Rt=Rt.concat(St[Nt]?gt.validateSpec({key:Nt,value:pt[Nt],valueSpec:St[Nt],validateSpec:gt.validateSpec,style:Et,styleSpec:vt}):[new gn(Nt,pt[Nt],`unknown property "${Nt}"`)]);return Rt}function ev(gt){let pt=[];const vt=gt.value,St=gt.key;if(Array.isArray(vt)){const Et=[],Rt=[];for(const Lt in vt)vt[Lt].id&&Et.includes(vt[Lt].id)&&pt.push(new gn(St,vt,`all the sprites' ids must be unique, but ${vt[Lt].id} is duplicated`)),Et.push(vt[Lt].id),vt[Lt].url&&Rt.includes(vt[Lt].url)&&pt.push(new gn(St,vt,`all the sprites' URLs must be unique, but ${vt[Lt].url} is duplicated`)),Rt.push(vt[Lt].url),pt=pt.concat(Gs({key:`${St}[${Lt}]`,value:vt[Lt],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:gt.validateSpec}));return pt}return Au({key:St,value:vt})}const rm={"*":()=>[],array:Sp,boolean:function(gt){const pt=gt.value,vt=gt.key,St=Ao(pt);return St!=="boolean"?[new gn(vt,pt,`boolean expected, ${St} found`)]:[]},number:Wm,color:function(gt){const pt=gt.key,vt=gt.value,St=Ao(vt);return St!=="string"?[new gn(pt,vt,`color expected, ${St} found`)]:ro.parse(String(vt))?[]:[new gn(pt,vt,`color expected, "${vt}" found`)]},constants:ny,enum:Xl,filter:Ym,function:Jp,layer:Xm,object:Gs,source:Tp,light:Km,sky:Jm,terrain:Qm,projection:function(gt){const pt=gt.value,vt=gt.styleSpec,St=vt.projection,Et=gt.style,Rt=Ao(pt);if(pt===void 0)return[];if(Rt!=="object")return[new gn("projection",pt,`object expected, ${Rt} found`)];let Lt=[];for(const Nt in pt)Lt=Lt.concat(St[Nt]?gt.validateSpec({key:Nt,value:pt[Nt],valueSpec:St[Nt],style:Et,styleSpec:vt}):[new gn(Nt,pt[Nt],`unknown property "${Nt}"`)]);return Lt},string:Au,formatted:function(gt){return Au(gt).length===0?[]:Gu(gt)},resolvedImage:function(gt){return Au(gt).length===0?[]:Gu(gt)},padding:function(gt){const pt=gt.key,vt=gt.value;if(Ao(vt)==="array"){if(vt.length<1||vt.length>4)return[new gn(pt,vt,`padding requires 1 to 4 values; ${vt.length} values found`)];const St={type:"number"};let Et=[];for(let Rt=0;Rt<vt.length;Rt++)Et=Et.concat(gt.validateSpec({key:`${pt}[${Rt}]`,value:vt[Rt],validateSpec:gt.validateSpec,valueSpec:St}));return Et}return Wm({key:pt,value:vt,valueSpec:{}})},variableAnchorOffsetCollection:function(gt){const pt=gt.key,vt=gt.value,St=Ao(vt),Et=gt.styleSpec;if(St!=="array"||vt.length<1||vt.length%2!=0)return[new gn(pt,vt,"variableAnchorOffsetCollection requires a non-empty array of even length")];let Rt=[];for(let Lt=0;Lt<vt.length;Lt+=2)Rt=Rt.concat(Xl({key:`${pt}[${Lt}]`,value:vt[Lt],valueSpec:Et.layout_symbol["text-anchor"]})),Rt=Rt.concat(Sp({key:`${pt}[${Lt+1}]`,value:vt[Lt+1],valueSpec:{length:2,value:"number"},validateSpec:gt.validateSpec,style:gt.style,styleSpec:Et}));return Rt},sprite:ev};function Ap(gt){const pt=gt.value,vt=gt.valueSpec,St=gt.styleSpec;return gt.validateSpec=Ap,vt.expression&&Hp(Zo(pt))?Jp(gt):vt.expression&&qp(Al(pt))?Gu(gt):vt.type&&rm[vt.type]?rm[vt.type](gt):Gs(Jo({},gt,{valueSpec:vt.type?St[vt.type]:vt}))}function iy(gt){const pt=gt.value,vt=gt.key,St=Au(gt);return St.length||(pt.indexOf("{fontstack}")===-1&&St.push(new gn(vt,pt,'"glyphs" url must include a "{fontstack}" token')),pt.indexOf("{range}")===-1&&St.push(new gn(vt,pt,'"glyphs" url must include a "{range}" token'))),St}function Xs(gt,pt=zr){let vt=[];return vt=vt.concat(Ap({key:"",value:gt,valueSpec:pt.$root,styleSpec:pt,style:gt,validateSpec:Ap,objectElementValidators:{glyphs:iy,"*":()=>[]}})),gt.constants&&(vt=vt.concat(ny({key:"constants",value:gt.constants}))),tv(vt)}function zl(gt){return function(pt){return gt({...pt,validateSpec:Ap})}}function tv(gt){return[].concat(gt).sort((pt,vt)=>pt.line-vt.line)}function Il(gt){return function(...pt){return tv(gt.apply(this,pt))}}Xs.source=Il(zl(Tp)),Xs.sprite=Il(zl(ev)),Xs.glyphs=Il(zl(iy)),Xs.light=Il(zl(Km)),Xs.sky=Il(zl(Jm)),Xs.terrain=Il(zl(Qm)),Xs.layer=Il(zl(Xm)),Xs.filter=Il(zl(Ym)),Xs.paintProperty=Il(zl(em)),Xs.layoutProperty=Il(zl(Zm));const Iu=Xs,Hy=Iu.light,Wy=Iu.sky,ay=Iu.paintProperty,oy=Iu.layoutProperty;function rv(gt,pt){let vt=!1;if(pt&&pt.length)for(const St of pt)gt.fire(new Dn(new Error(St.message))),vt=!0;return vt}class ju{constructor(pt,vt,St){const Et=this.cells=[];if(pt instanceof ArrayBuffer){this.arrayBuffer=pt;const Lt=new Int32Array(this.arrayBuffer);pt=Lt[0],this.d=(vt=Lt[1])+2*(St=Lt[2]);for(let zt=0;zt<this.d*this.d;zt++){const jt=Lt[3+zt],Wt=Lt[3+zt+1];Et.push(jt===Wt?null:Lt.subarray(jt,Wt))}const Nt=Lt[3+Et.length+1];this.keys=Lt.subarray(Lt[3+Et.length],Nt),this.bboxes=Lt.subarray(Nt),this.insert=this._insertReadonly}else{this.d=vt+2*St;for(let Lt=0;Lt<this.d*this.d;Lt++)Et.push([]);this.keys=[],this.bboxes=[]}this.n=vt,this.extent=pt,this.padding=St,this.scale=vt/pt,this.uid=0;const Rt=St/vt*pt;this.min=-Rt,this.max=pt+Rt}insert(pt,vt,St,Et,Rt){this._forEachCell(vt,St,Et,Rt,this._insertCell,this.uid++,void 0,void 0),this.keys.push(pt),this.bboxes.push(vt),this.bboxes.push(St),this.bboxes.push(Et),this.bboxes.push(Rt)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(pt,vt,St,Et,Rt,Lt){this.cells[Rt].push(Lt)}query(pt,vt,St,Et,Rt){const Lt=this.min,Nt=this.max;if(pt<=Lt&&vt<=Lt&&Nt<=St&&Nt<=Et&&!Rt)return Array.prototype.slice.call(this.keys);{const zt=[];return this._forEachCell(pt,vt,St,Et,this._queryCell,zt,{},Rt),zt}}_queryCell(pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=this.cells[Rt];if(jt!==null){const Wt=this.keys,qt=this.bboxes;for(let ir=0;ir<jt.length;ir++){const or=jt[ir];if(Nt[or]===void 0){const lr=4*or;(zt?zt(qt[lr+0],qt[lr+1],qt[lr+2],qt[lr+3]):pt<=qt[lr+2]&&vt<=qt[lr+3]&&St>=qt[lr+0]&&Et>=qt[lr+1])?(Nt[or]=!0,Lt.push(Wt[or])):Nt[or]=!1}}}}_forEachCell(pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=this._convertToCellCoord(pt),Wt=this._convertToCellCoord(vt),qt=this._convertToCellCoord(St),ir=this._convertToCellCoord(Et);for(let or=jt;or<=qt;or++)for(let lr=Wt;lr<=ir;lr++){const pr=this.d*lr+or;if((!zt||zt(this._convertFromCellCoord(or),this._convertFromCellCoord(lr),this._convertFromCellCoord(or+1),this._convertFromCellCoord(lr+1)))&&Rt.call(this,pt,vt,St,Et,pr,Lt,Nt,zt))return}}_convertFromCellCoord(pt){return(pt-this.padding)/this.scale}_convertToCellCoord(pt){return Math.max(0,Math.min(this.d-1,Math.floor(pt*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const pt=this.cells,vt=3+this.cells.length+1+1;let St=0;for(let Lt=0;Lt<this.cells.length;Lt++)St+=this.cells[Lt].length;const Et=new Int32Array(vt+St+this.keys.length+this.bboxes.length);Et[0]=this.extent,Et[1]=this.n,Et[2]=this.padding;let Rt=vt;for(let Lt=0;Lt<pt.length;Lt++){const Nt=pt[Lt];Et[3+Lt]=Rt,Et.set(Nt,Rt),Rt+=Nt.length}return Et[3+pt.length]=Rt,Et.set(this.keys,Rt),Rt+=this.keys.length,Et[3+pt.length+1]=Rt,Et.set(this.bboxes,Rt),Rt+=this.bboxes.length,Et.buffer}static serialize(pt,vt){const St=pt.toArrayBuffer();return vt&&vt.push(St),{buffer:St}}static deserialize(pt){return new ju(pt.buffer)}}const Ks={};function Nn(gt,pt,vt={}){if(Ks[gt])throw new Error(`${gt} is already registered.`);Object.defineProperty(pt,"_classRegistryKey",{value:gt,writeable:!1}),Ks[gt]={klass:pt,omit:vt.omit||[],shallow:vt.shallow||[]}}Nn("Object",Object),Nn("TransferableGridIndex",ju),Nn("Color",ro),Nn("Error",Error),Nn("AJAXError",Rn),Nn("ResolvedImage",hs),Nn("StylePropertyFunction",Uu),Nn("StyleExpression",Yp,{omit:["_evaluator"]}),Nn("ZoomDependentExpression",Vu),Nn("ZoomConstantExpression",zu),Nn("CompoundExpression",Zs,{omit:["_evaluate"]});for(const gt in Ou)Ou[gt]._classRegistryKey||Nn(`Expression_${gt}`,Ou[gt]);function nm(gt){return gt&&typeof ArrayBuffer<"u"&&(gt instanceof ArrayBuffer||gt.constructor&&gt.constructor.name==="ArrayBuffer")}function nv(gt){return gt.$name||gt.constructor._classRegistryKey}function sy(gt){return!function(pt){if(pt===null||typeof pt!="object")return!1;const vt=nv(pt);return!(!vt||vt==="Object")}(gt)&&(gt==null||typeof gt=="boolean"||typeof gt=="number"||typeof gt=="string"||gt instanceof Boolean||gt instanceof Number||gt instanceof String||gt instanceof Date||gt instanceof RegExp||gt instanceof Blob||gt instanceof Error||nm(gt)||cr(gt)||ArrayBuffer.isView(gt)||gt instanceof ImageData)}function Hu(gt,pt){if(sy(gt))return(nm(gt)||cr(gt))&&pt&&pt.push(gt),ArrayBuffer.isView(gt)&&pt&&pt.push(gt.buffer),gt instanceof ImageData&&pt&&pt.push(gt.data.buffer),gt;if(Array.isArray(gt)){const Rt=[];for(const Lt of gt)Rt.push(Hu(Lt,pt));return Rt}if(typeof gt!="object")throw new Error("can't serialize object of type "+typeof gt);const vt=nv(gt);if(!vt)throw new Error(`can't serialize object of unregistered class ${gt.constructor.name}`);if(!Ks[vt])throw new Error(`${vt} is not registered.`);const{klass:St}=Ks[vt],Et=St.serialize?St.serialize(gt,pt):{};if(St.serialize){if(pt&&Et===pt[pt.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const Rt in gt){if(!gt.hasOwnProperty(Rt)||Ks[vt].omit.indexOf(Rt)>=0)continue;const Lt=gt[Rt];Et[Rt]=Ks[vt].shallow.indexOf(Rt)>=0?Lt:Hu(Lt,pt)}gt instanceof Error&&(Et.message=gt.message)}if(Et.$name)throw new Error("$name property is reserved for worker serialization logic.");return vt!=="Object"&&(Et.$name=vt),Et}function Wu(gt){if(sy(gt))return gt;if(Array.isArray(gt))return gt.map(Wu);if(typeof gt!="object")throw new Error("can't deserialize object of type "+typeof gt);const pt=nv(gt)||"Object";if(!Ks[pt])throw new Error(`can't deserialize unregistered class ${pt}`);const{klass:vt}=Ks[pt];if(!vt)throw new Error(`can't deserialize unregistered class ${pt}`);if(vt.deserialize)return vt.deserialize(gt);const St=Object.create(vt.prototype);for(const Et of Object.keys(gt)){if(Et==="$name")continue;const Rt=gt[Et];St[Et]=Ks[pt].shallow.indexOf(Et)>=0?Rt:Wu(Rt)}return St}class iv{constructor(){this.first=!0}update(pt,vt){const St=Math.floor(pt);return this.first?(this.first=!1,this.lastIntegerZoom=St,this.lastIntegerZoomTime=0,this.lastZoom=pt,this.lastFloorZoom=St,!0):(this.lastFloorZoom>St?(this.lastIntegerZoom=St+1,this.lastIntegerZoomTime=vt):this.lastFloorZoom<St&&(this.lastIntegerZoom=St,this.lastIntegerZoomTime=vt),pt!==this.lastZoom&&(this.lastZoom=pt,this.lastFloorZoom=St,!0))}}const yo={"Latin-1 Supplement":gt=>gt>=128&&gt<=255,"Hangul Jamo":gt=>gt>=4352&&gt<=4607,Khmer:gt=>gt>=6016&&gt<=6143,"General Punctuation":gt=>gt>=8192&&gt<=8303,"Letterlike Symbols":gt=>gt>=8448&&gt<=8527,"Number Forms":gt=>gt>=8528&&gt<=8591,"Miscellaneous Technical":gt=>gt>=8960&&gt<=9215,"Control Pictures":gt=>gt>=9216&&gt<=9279,"Optical Character Recognition":gt=>gt>=9280&&gt<=9311,"Enclosed Alphanumerics":gt=>gt>=9312&&gt<=9471,"Geometric Shapes":gt=>gt>=9632&&gt<=9727,"Miscellaneous Symbols":gt=>gt>=9728&&gt<=9983,"Miscellaneous Symbols and Arrows":gt=>gt>=11008&&gt<=11263,"Ideographic Description Characters":gt=>gt>=12272&&gt<=12287,"CJK Symbols and Punctuation":gt=>gt>=12288&&gt<=12351,Katakana:gt=>gt>=12448&&gt<=12543,Kanbun:gt=>gt>=12688&&gt<=12703,"CJK Strokes":gt=>gt>=12736&&gt<=12783,"Enclosed CJK Letters and Months":gt=>gt>=12800&&gt<=13055,"CJK Compatibility":gt=>gt>=13056&&gt<=13311,"Yijing Hexagram Symbols":gt=>gt>=19904&&gt<=19967,"Private Use Area":gt=>gt>=57344&&gt<=63743,"Vertical Forms":gt=>gt>=65040&&gt<=65055,"CJK Compatibility Forms":gt=>gt>=65072&&gt<=65103,"Small Form Variants":gt=>gt>=65104&&gt<=65135,"Halfwidth and Fullwidth Forms":gt=>gt>=65280&&gt<=65519};function av(gt){for(const pt of gt)if(sv(pt.charCodeAt(0)))return!0;return!1}function Yy(gt){for(const pt of gt)if(!Yu(pt.charCodeAt(0)))return!1;return!0}function ov(gt){const pt=gt.map(vt=>{try{return new RegExp(`\\p{sc=${vt}}`,"u").source}catch{return null}}).filter(vt=>vt);return new RegExp(pt.join("|"),"u")}const qy=ov(["Arab","Dupl","Mong","Ougr","Syrc"]);function Yu(gt){return!qy.test(String.fromCodePoint(gt))}const ly=ov(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function sv(gt){return!(gt!==746&&gt!==747&&(gt<4352||!(yo["CJK Compatibility Forms"](gt)&&!(gt>=65097&&gt<=65103)||yo["CJK Compatibility"](gt)||yo["CJK Strokes"](gt)||!(!yo["CJK Symbols and Punctuation"](gt)||gt>=12296&&gt<=12305||gt>=12308&&gt<=12319||gt===12336)||yo["Enclosed CJK Letters and Months"](gt)||yo["Ideographic Description Characters"](gt)||yo.Kanbun(gt)||yo.Katakana(gt)&&gt!==12540||!(!yo["Halfwidth and Fullwidth Forms"](gt)||gt===65288||gt===65289||gt===65293||gt>=65306&&gt<=65310||gt===65339||gt===65341||gt===65343||gt>=65371&&gt<=65503||gt===65507||gt>=65512&&gt<=65519)||!(!yo["Small Form Variants"](gt)||gt>=65112&&gt<=65118||gt>=65123&&gt<=65126)||yo["Vertical Forms"](gt)||yo["Yijing Hexagram Symbols"](gt)||/\p{sc=Cans}/u.test(String.fromCodePoint(gt))||/\p{sc=Hang}/u.test(String.fromCodePoint(gt))||ly.test(String.fromCodePoint(gt)))))}function uy(gt){return!(sv(gt)||function(pt){return!!(yo["Latin-1 Supplement"](pt)&&(pt===167||pt===169||pt===174||pt===177||pt===188||pt===189||pt===190||pt===215||pt===247)||yo["General Punctuation"](pt)&&(pt===8214||pt===8224||pt===8225||pt===8240||pt===8241||pt===8251||pt===8252||pt===8258||pt===8263||pt===8264||pt===8265||pt===8273)||yo["Letterlike Symbols"](pt)||yo["Number Forms"](pt)||yo["Miscellaneous Technical"](pt)&&(pt>=8960&&pt<=8967||pt>=8972&&pt<=8991||pt>=8996&&pt<=9e3||pt===9003||pt>=9085&&pt<=9114||pt>=9150&&pt<=9165||pt===9167||pt>=9169&&pt<=9179||pt>=9186&&pt<=9215)||yo["Control Pictures"](pt)&&pt!==9251||yo["Optical Character Recognition"](pt)||yo["Enclosed Alphanumerics"](pt)||yo["Geometric Shapes"](pt)||yo["Miscellaneous Symbols"](pt)&&!(pt>=9754&&pt<=9759)||yo["Miscellaneous Symbols and Arrows"](pt)&&(pt>=11026&&pt<=11055||pt>=11088&&pt<=11097||pt>=11192&&pt<=11243)||yo["CJK Symbols and Punctuation"](pt)||yo.Katakana(pt)||yo["Private Use Area"](pt)||yo["CJK Compatibility Forms"](pt)||yo["Small Form Variants"](pt)||yo["Halfwidth and Fullwidth Forms"](pt)||pt===8734||pt===8756||pt===8757||pt>=9984&&pt<=10087||pt>=10102&&pt<=10131||pt===65532||pt===65533)}(gt))}const Zy=ov(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function lv(gt){return Zy.test(String.fromCodePoint(gt))}function Xy(gt,pt){return!(!pt&&lv(gt)||gt>=2304&&gt<=3583||gt>=3840&&gt<=4255||yo.Khmer(gt))}function Ky(gt){for(const pt of gt)if(lv(pt.charCodeAt(0)))return!0;return!1}const js=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(gt){this.pluginStatus=gt.pluginStatus,this.pluginURL=gt.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(gt){this.applyArabicShaping=gt.applyArabicShaping,this.processBidirectionalText=gt.processBidirectionalText,this.processStyledBidirectionalText=gt.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class No{constructor(pt,vt){this.zoom=pt,vt?(this.now=vt.now,this.fadeDuration=vt.fadeDuration,this.zoomHistory=vt.zoomHistory,this.transition=vt.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new iv,this.transition={})}isSupportedScript(pt){return function(vt,St){for(const Et of vt)if(!Xy(Et.charCodeAt(0),St))return!1;return!0}(pt,js.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const pt=this.zoom,vt=pt-Math.floor(pt),St=this.crossFadingFactor();return pt>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:vt+(1-vt)*St}:{fromScale:.5,toScale:1,t:1-(1-St)*vt}}}class qu{constructor(pt,vt){this.property=pt,this.value=vt,this.expression=function(St,Et){if(Hp(St))return new Uu(St,Et);if(qp(St)){const Rt=Gm(St,Et);if(Rt.result==="error")throw new Error(Rt.value.map(Lt=>`${Lt.key}: ${Lt.message}`).join(", "));return Rt.value}{let Rt=St;return Et.type==="color"&&typeof St=="string"?Rt=ro.parse(St):Et.type!=="padding"||typeof St!="number"&&!Array.isArray(St)?Et.type==="variableAnchorOffsetCollection"&&Array.isArray(St)&&(Rt=Yo.parse(St)):Rt=mo.parse(St),{kind:"constant",evaluate:()=>Rt}}}(vt===void 0?pt.specification.default:vt,pt.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(pt,vt,St){return this.property.possiblyEvaluate(this,pt,vt,St)}}class im{constructor(pt){this.property=pt,this.value=new qu(pt,void 0)}transitioned(pt,vt){return new cy(this.property,this.value,vt,$t({},pt.transition,this.transition),pt.now)}untransitioned(){return new cy(this.property,this.value,null,{},0)}}class am{constructor(pt){this._properties=pt,this._values=Object.create(pt.defaultTransitionablePropertyValues)}getValue(pt){return Ht(this._values[pt].value.value)}setValue(pt,vt){Object.prototype.hasOwnProperty.call(this._values,pt)||(this._values[pt]=new im(this._values[pt].property)),this._values[pt].value=new qu(this._values[pt].property,vt===null?void 0:Ht(vt))}getTransition(pt){return Ht(this._values[pt].transition)}setTransition(pt,vt){Object.prototype.hasOwnProperty.call(this._values,pt)||(this._values[pt]=new im(this._values[pt].property)),this._values[pt].transition=Ht(vt)||void 0}serialize(){const pt={};for(const vt of Object.keys(this._values)){const St=this.getValue(vt);St!==void 0&&(pt[vt]=St);const Et=this.getTransition(vt);Et!==void 0&&(pt[`${vt}-transition`]=Et)}return pt}transitioned(pt,vt){const St=new Ip(this._properties);for(const Et of Object.keys(this._values))St._values[Et]=this._values[Et].transitioned(pt,vt._values[Et]);return St}untransitioned(){const pt=new Ip(this._properties);for(const vt of Object.keys(this._values))pt._values[vt]=this._values[vt].untransitioned();return pt}}class cy{constructor(pt,vt,St,Et,Rt){this.property=pt,this.value=vt,this.begin=Rt+Et.delay||0,this.end=this.begin+Et.duration||0,pt.specification.transition&&(Et.delay||Et.duration)&&(this.prior=St)}possiblyEvaluate(pt,vt,St){const Et=pt.now||0,Rt=this.value.possiblyEvaluate(pt,vt,St),Lt=this.prior;if(Lt){if(Et>this.end)return this.prior=null,Rt;if(this.value.isDataDriven())return this.prior=null,Rt;if(Et<this.begin)return Lt.possiblyEvaluate(pt,vt,St);{const Nt=(Et-this.begin)/(this.end-this.begin);return this.property.interpolate(Lt.possiblyEvaluate(pt,vt,St),Rt,function(zt){if(zt<=0)return 0;if(zt>=1)return 1;const jt=zt*zt,Wt=jt*zt;return 4*(zt<.5?Wt:3*(zt-jt)+Wt-.75)}(Nt))}}return Rt}}class Ip{constructor(pt){this._properties=pt,this._values=Object.create(pt.defaultTransitioningPropertyValues)}possiblyEvaluate(pt,vt,St){const Et=new Cp(this._properties);for(const Rt of Object.keys(this._values))Et._values[Rt]=this._values[Rt].possiblyEvaluate(pt,vt,St);return Et}hasTransition(){for(const pt of Object.keys(this._values))if(this._values[pt].prior)return!0;return!1}}class Ep{constructor(pt){this._properties=pt,this._values=Object.create(pt.defaultPropertyValues)}hasValue(pt){return this._values[pt].value!==void 0}getValue(pt){return Ht(this._values[pt].value)}setValue(pt,vt){this._values[pt]=new qu(this._values[pt].property,vt===null?void 0:Ht(vt))}serialize(){const pt={};for(const vt of Object.keys(this._values)){const St=this.getValue(vt);St!==void 0&&(pt[vt]=St)}return pt}possiblyEvaluate(pt,vt,St){const Et=new Cp(this._properties);for(const Rt of Object.keys(this._values))Et._values[Rt]=this._values[Rt].possiblyEvaluate(pt,vt,St);return Et}}class Vl{constructor(pt,vt,St){this.property=pt,this.value=vt,this.parameters=St}isConstant(){return this.value.kind==="constant"}constantOr(pt){return this.value.kind==="constant"?this.value.value:pt}evaluate(pt,vt,St,Et){return this.property.evaluate(this.value,this.parameters,pt,vt,St,Et)}}class Cp{constructor(pt){this._properties=pt,this._values=Object.create(pt.defaultPossiblyEvaluatedValues)}get(pt){return this._values[pt]}}class Vn{constructor(pt){this.specification=pt}possiblyEvaluate(pt,vt){if(pt.isDataDriven())throw new Error("Value should not be data driven");return pt.expression.evaluate(vt)}interpolate(pt,vt,St){const Et=fs[this.specification.type];return Et?Et(pt,vt,St):pt}}class _i{constructor(pt,vt){this.specification=pt,this.overrides=vt}possiblyEvaluate(pt,vt,St,Et){return new Vl(this,pt.expression.kind==="constant"||pt.expression.kind==="camera"?{kind:"constant",value:pt.expression.evaluate(vt,null,{},St,Et)}:pt.expression,vt)}interpolate(pt,vt,St){if(pt.value.kind!=="constant"||vt.value.kind!=="constant")return pt;if(pt.value.value===void 0||vt.value.value===void 0)return new Vl(this,{kind:"constant",value:void 0},pt.parameters);const Et=fs[this.specification.type];if(Et){const Rt=Et(pt.value.value,vt.value.value,St);return new Vl(this,{kind:"constant",value:Rt},pt.parameters)}return pt}evaluate(pt,vt,St,Et,Rt,Lt){return pt.kind==="constant"?pt.value:pt.evaluate(vt,St,Et,Rt,Lt)}}class om extends _i{possiblyEvaluate(pt,vt,St,Et){if(pt.value===void 0)return new Vl(this,{kind:"constant",value:void 0},vt);if(pt.expression.kind==="constant"){const Rt=pt.expression.evaluate(vt,null,{},St,Et),Lt=pt.property.specification.type==="resolvedImage"&&typeof Rt!="string"?Rt.name:Rt,Nt=this._calculate(Lt,Lt,Lt,vt);return new Vl(this,{kind:"constant",value:Nt},vt)}if(pt.expression.kind==="camera"){const Rt=this._calculate(pt.expression.evaluate({zoom:vt.zoom-1}),pt.expression.evaluate({zoom:vt.zoom}),pt.expression.evaluate({zoom:vt.zoom+1}),vt);return new Vl(this,{kind:"constant",value:Rt},vt)}return new Vl(this,pt.expression,vt)}evaluate(pt,vt,St,Et,Rt,Lt){if(pt.kind==="source"){const Nt=pt.evaluate(vt,St,Et,Rt,Lt);return this._calculate(Nt,Nt,Nt,vt)}return pt.kind==="composite"?this._calculate(pt.evaluate({zoom:Math.floor(vt.zoom)-1},St,Et),pt.evaluate({zoom:Math.floor(vt.zoom)},St,Et),pt.evaluate({zoom:Math.floor(vt.zoom)+1},St,Et),vt):pt.value}_calculate(pt,vt,St,Et){return Et.zoom>Et.zoomHistory.lastIntegerZoom?{from:pt,to:vt}:{from:St,to:vt}}interpolate(pt){return pt}}class sm{constructor(pt){this.specification=pt}possiblyEvaluate(pt,vt,St,Et){if(pt.value!==void 0){if(pt.expression.kind==="constant"){const Rt=pt.expression.evaluate(vt,null,{},St,Et);return this._calculate(Rt,Rt,Rt,vt)}return this._calculate(pt.expression.evaluate(new No(Math.floor(vt.zoom-1),vt)),pt.expression.evaluate(new No(Math.floor(vt.zoom),vt)),pt.expression.evaluate(new No(Math.floor(vt.zoom+1),vt)),vt)}}_calculate(pt,vt,St,Et){return Et.zoom>Et.zoomHistory.lastIntegerZoom?{from:pt,to:vt}:{from:St,to:vt}}interpolate(pt){return pt}}class uv{constructor(pt){this.specification=pt}possiblyEvaluate(pt,vt,St,Et){return!!pt.expression.evaluate(vt,null,{},St,Et)}interpolate(){return!1}}class Mt{constructor(pt){this.properties=pt,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const vt in pt){const St=pt[vt];St.specification.overridable&&this.overridableProperties.push(vt);const Et=this.defaultPropertyValues[vt]=new qu(St,void 0),Rt=this.defaultTransitionablePropertyValues[vt]=new im(St);this.defaultTransitioningPropertyValues[vt]=Rt.untransitioned(),this.defaultPossiblyEvaluatedValues[vt]=Et.possiblyEvaluate({})}}}Nn("DataDrivenProperty",_i),Nn("DataConstantProperty",Vn),Nn("CrossFadedDataDrivenProperty",om),Nn("CrossFadedProperty",sm),Nn("ColorRampProperty",uv);const dt="-transition";class xt extends Qn{constructor(pt,vt){if(super(),this.id=pt.id,this.type=pt.type,this._featureFilter={filter:()=>!0,needGeometry:!1},pt.type!=="custom"&&(this.metadata=pt.metadata,this.minzoom=pt.minzoom,this.maxzoom=pt.maxzoom,pt.type!=="background"&&(this.source=pt.source,this.sourceLayer=pt["source-layer"],this.filter=pt.filter),vt.layout&&(this._unevaluatedLayout=new Ep(vt.layout)),vt.paint)){this._transitionablePaint=new am(vt.paint);for(const St in pt.paint)this.setPaintProperty(St,pt.paint[St],{validate:!1});for(const St in pt.layout)this.setLayoutProperty(St,pt.layout[St],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Cp(vt.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(pt){return pt==="visibility"?this.visibility:this._unevaluatedLayout.getValue(pt)}setLayoutProperty(pt,vt,St={}){vt!=null&&this._validate(oy,`layers.${this.id}.layout.${pt}`,pt,vt,St)||(pt!=="visibility"?this._unevaluatedLayout.setValue(pt,vt):this.visibility=vt)}getPaintProperty(pt){return pt.endsWith(dt)?this._transitionablePaint.getTransition(pt.slice(0,-11)):this._transitionablePaint.getValue(pt)}setPaintProperty(pt,vt,St={}){if(vt!=null&&this._validate(ay,`layers.${this.id}.paint.${pt}`,pt,vt,St))return!1;if(pt.endsWith(dt))return this._transitionablePaint.setTransition(pt.slice(0,-11),vt||void 0),!1;{const Et=this._transitionablePaint._values[pt],Rt=Et.property.specification["property-type"]==="cross-faded-data-driven",Lt=Et.value.isDataDriven(),Nt=Et.value;this._transitionablePaint.setValue(pt,vt),this._handleSpecialPaintPropertyUpdate(pt);const zt=this._transitionablePaint._values[pt].value;return zt.isDataDriven()||Lt||Rt||this._handleOverridablePaintPropertyUpdate(pt,Nt,zt)}}_handleSpecialPaintPropertyUpdate(pt){}_handleOverridablePaintPropertyUpdate(pt,vt,St){return!1}isHidden(pt){return!!(this.minzoom&&pt<this.minzoom)||!!(this.maxzoom&&pt>=this.maxzoom)||this.visibility==="none"}updateTransitions(pt){this._transitioningPaint=this._transitionablePaint.transitioned(pt,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(pt,vt){pt.getCrossfadeParameters&&(this._crossfadeParameters=pt.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(pt,void 0,vt)),this.paint=this._transitioningPaint.possiblyEvaluate(pt,void 0,vt)}serialize(){const pt={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(pt.layout=pt.layout||{},pt.layout.visibility=this.visibility),Vt(pt,(vt,St)=>!(vt===void 0||St==="layout"&&!Object.keys(vt).length||St==="paint"&&!Object.keys(vt).length))}_validate(pt,vt,St,Et,Rt={}){return(!Rt||Rt.validate!==!1)&&rv(this,pt.call(Iu,{key:vt,layerType:this.type,objectKey:St,value:Et,styleSpec:zr,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const pt in this.paint._values){const vt=this.paint.get(pt);if(vt instanceof Vl&&Nu(vt.property.specification)&&(vt.value.kind==="source"||vt.value.kind==="composite")&&vt.value.isStateDependent)return!0}return!1}}const At={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class It{constructor(pt,vt){this._structArray=pt,this._pos1=vt*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(pt,vt){return pt._trim(),vt&&(pt.isTransferred=!0,vt.push(pt.arrayBuffer)),{length:pt.length,arrayBuffer:pt.arrayBuffer}}static deserialize(pt){const vt=Object.create(this.prototype);return vt.arrayBuffer=pt.arrayBuffer,vt.length=pt.length,vt.capacity=pt.arrayBuffer.byteLength/vt.bytesPerElement,vt._refreshViews(),vt}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(pt){this.reserve(pt),this.length=pt}reserve(pt){if(pt>this.capacity){this.capacity=Math.max(pt,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const vt=this.uint8;this._refreshViews(),vt&&this.uint8.set(vt)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Bt(gt,pt=1){let vt=0,St=0;return{members:gt.map(Et=>{const Rt=At[Et.type].BYTES_PER_ELEMENT,Lt=vt=Ut(vt,Math.max(pt,Rt)),Nt=Et.components||1;return St=Math.max(St,Rt),vt+=Rt*Nt,{name:Et.name,type:Et.type,components:Nt,offset:Lt}}),size:Ut(vt,Math.max(St,pt)),alignment:pt}}function Ut(gt,pt){return Math.ceil(gt/pt)*pt}class Gt extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt){const St=this.length;return this.resize(St+1),this.emplace(St,pt,vt)}emplace(pt,vt,St){const Et=2*pt;return this.int16[Et+0]=vt,this.int16[Et+1]=St,pt}}Gt.prototype.bytesPerElement=4,Nn("StructArrayLayout2i4",Gt);class Yt extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St){const Et=this.length;return this.resize(Et+1),this.emplace(Et,pt,vt,St)}emplace(pt,vt,St,Et){const Rt=3*pt;return this.int16[Rt+0]=vt,this.int16[Rt+1]=St,this.int16[Rt+2]=Et,pt}}Yt.prototype.bytesPerElement=6,Nn("StructArrayLayout3i6",Yt);class Kt extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et){const Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,pt,vt,St,Et)}emplace(pt,vt,St,Et,Rt){const Lt=4*pt;return this.int16[Lt+0]=vt,this.int16[Lt+1]=St,this.int16[Lt+2]=Et,this.int16[Lt+3]=Rt,pt}}Kt.prototype.bytesPerElement=8,Nn("StructArrayLayout4i8",Kt);class Jt extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,pt,vt,St,Et,Rt,Lt)}emplace(pt,vt,St,Et,Rt,Lt,Nt){const zt=6*pt;return this.int16[zt+0]=vt,this.int16[zt+1]=St,this.int16[zt+2]=Et,this.int16[zt+3]=Rt,this.int16[zt+4]=Lt,this.int16[zt+5]=Nt,pt}}Jt.prototype.bytesPerElement=12,Nn("StructArrayLayout2i4i12",Jt);class sr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,pt,vt,St,Et,Rt,Lt)}emplace(pt,vt,St,Et,Rt,Lt,Nt){const zt=4*pt,jt=8*pt;return this.int16[zt+0]=vt,this.int16[zt+1]=St,this.uint8[jt+4]=Et,this.uint8[jt+5]=Rt,this.uint8[jt+6]=Lt,this.uint8[jt+7]=Nt,pt}}sr.prototype.bytesPerElement=8,Nn("StructArrayLayout2i4ub8",sr);class gr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt){const St=this.length;return this.resize(St+1),this.emplace(St,pt,vt)}emplace(pt,vt,St){const Et=2*pt;return this.float32[Et+0]=vt,this.float32[Et+1]=St,pt}}gr.prototype.bytesPerElement=8,Nn("StructArrayLayout2f8",gr);class vr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt){const qt=this.length;return this.resize(qt+1),this.emplace(qt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt)}emplace(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt){const ir=10*pt;return this.uint16[ir+0]=vt,this.uint16[ir+1]=St,this.uint16[ir+2]=Et,this.uint16[ir+3]=Rt,this.uint16[ir+4]=Lt,this.uint16[ir+5]=Nt,this.uint16[ir+6]=zt,this.uint16[ir+7]=jt,this.uint16[ir+8]=Wt,this.uint16[ir+9]=qt,pt}}vr.prototype.bytesPerElement=20,Nn("StructArrayLayout10ui20",vr);class Ar extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir){const or=this.length;return this.resize(or+1),this.emplace(or,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir)}emplace(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or){const lr=12*pt;return this.int16[lr+0]=vt,this.int16[lr+1]=St,this.int16[lr+2]=Et,this.int16[lr+3]=Rt,this.uint16[lr+4]=Lt,this.uint16[lr+5]=Nt,this.uint16[lr+6]=zt,this.uint16[lr+7]=jt,this.int16[lr+8]=Wt,this.int16[lr+9]=qt,this.int16[lr+10]=ir,this.int16[lr+11]=or,pt}}Ar.prototype.bytesPerElement=24,Nn("StructArrayLayout4i4ui4i24",Ar);class Er extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt,St){const Et=this.length;return this.resize(Et+1),this.emplace(Et,pt,vt,St)}emplace(pt,vt,St,Et){const Rt=3*pt;return this.float32[Rt+0]=vt,this.float32[Rt+1]=St,this.float32[Rt+2]=Et,pt}}Er.prototype.bytesPerElement=12,Nn("StructArrayLayout3f12",Er);class Cr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(pt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,pt)}emplace(pt,vt){return this.uint32[1*pt+0]=vt,pt}}Cr.prototype.bytesPerElement=4,Nn("StructArrayLayout1ul4",Cr);class Rr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt,Nt,zt,jt){const Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt)}emplace(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt){const qt=10*pt,ir=5*pt;return this.int16[qt+0]=vt,this.int16[qt+1]=St,this.int16[qt+2]=Et,this.int16[qt+3]=Rt,this.int16[qt+4]=Lt,this.int16[qt+5]=Nt,this.uint32[ir+3]=zt,this.uint16[qt+8]=jt,this.uint16[qt+9]=Wt,pt}}Rr.prototype.bytesPerElement=20,Nn("StructArrayLayout6i1ul2ui20",Rr);class Sr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,pt,vt,St,Et,Rt,Lt)}emplace(pt,vt,St,Et,Rt,Lt,Nt){const zt=6*pt;return this.int16[zt+0]=vt,this.int16[zt+1]=St,this.int16[zt+2]=Et,this.int16[zt+3]=Rt,this.int16[zt+4]=Lt,this.int16[zt+5]=Nt,pt}}Sr.prototype.bytesPerElement=12,Nn("StructArrayLayout2i2i2i12",Sr);class Br extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,pt,vt,St,Et,Rt)}emplace(pt,vt,St,Et,Rt,Lt){const Nt=4*pt,zt=8*pt;return this.float32[Nt+0]=vt,this.float32[Nt+1]=St,this.float32[Nt+2]=Et,this.int16[zt+6]=Rt,this.int16[zt+7]=Lt,pt}}Br.prototype.bytesPerElement=16,Nn("StructArrayLayout2f1f2i16",Br);class Gr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,pt,vt,St,Et,Rt,Lt)}emplace(pt,vt,St,Et,Rt,Lt,Nt){const zt=16*pt,jt=4*pt,Wt=8*pt;return this.uint8[zt+0]=vt,this.uint8[zt+1]=St,this.float32[jt+1]=Et,this.float32[jt+2]=Rt,this.int16[Wt+6]=Lt,this.int16[Wt+7]=Nt,pt}}Gr.prototype.bytesPerElement=16,Nn("StructArrayLayout2ub2f2i16",Gr);class qr extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt,St){const Et=this.length;return this.resize(Et+1),this.emplace(Et,pt,vt,St)}emplace(pt,vt,St,Et){const Rt=3*pt;return this.uint16[Rt+0]=vt,this.uint16[Rt+1]=St,this.uint16[Rt+2]=Et,pt}}qr.prototype.bytesPerElement=6,Nn("StructArrayLayout3ui6",qr);class ln extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir){const Wr=this.length;return this.resize(Wr+1),this.emplace(Wr,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir)}emplace(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir,Wr){const $r=24*pt,jr=12*pt,en=48*pt;return this.int16[$r+0]=vt,this.int16[$r+1]=St,this.uint16[$r+2]=Et,this.uint16[$r+3]=Rt,this.uint32[jr+2]=Lt,this.uint32[jr+3]=Nt,this.uint32[jr+4]=zt,this.uint16[$r+10]=jt,this.uint16[$r+11]=Wt,this.uint16[$r+12]=qt,this.float32[jr+7]=ir,this.float32[jr+8]=or,this.uint8[en+36]=lr,this.uint8[en+37]=pr,this.uint8[en+38]=Tr,this.uint32[jr+10]=Ir,this.int16[$r+22]=Wr,pt}}ln.prototype.bytesPerElement=48,Nn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ln);class mn extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir,Wr,$r,jr,en,dn,Ln,Jn,Pn,En,Hn,Fn){const kn=this.length;return this.resize(kn+1),this.emplace(kn,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir,Wr,$r,jr,en,dn,Ln,Jn,Pn,En,Hn,Fn)}emplace(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr,Tr,Ir,Wr,$r,jr,en,dn,Ln,Jn,Pn,En,Hn,Fn,kn){const on=32*pt,qn=16*pt;return this.int16[on+0]=vt,this.int16[on+1]=St,this.int16[on+2]=Et,this.int16[on+3]=Rt,this.int16[on+4]=Lt,this.int16[on+5]=Nt,this.int16[on+6]=zt,this.int16[on+7]=jt,this.uint16[on+8]=Wt,this.uint16[on+9]=qt,this.uint16[on+10]=ir,this.uint16[on+11]=or,this.uint16[on+12]=lr,this.uint16[on+13]=pr,this.uint16[on+14]=Tr,this.uint16[on+15]=Ir,this.uint16[on+16]=Wr,this.uint16[on+17]=$r,this.uint16[on+18]=jr,this.uint16[on+19]=en,this.uint16[on+20]=dn,this.uint16[on+21]=Ln,this.uint16[on+22]=Jn,this.uint32[qn+12]=Pn,this.float32[qn+13]=En,this.float32[qn+14]=Hn,this.uint16[on+30]=Fn,this.uint16[on+31]=kn,pt}}mn.prototype.bytesPerElement=64,Nn("StructArrayLayout8i15ui1ul2f2ui64",mn);class Cn extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,pt)}emplace(pt,vt){return this.float32[1*pt+0]=vt,pt}}Cn.prototype.bytesPerElement=4,Nn("StructArrayLayout1f4",Cn);class On extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt,St){const Et=this.length;return this.resize(Et+1),this.emplace(Et,pt,vt,St)}emplace(pt,vt,St,Et){const Rt=3*pt;return this.uint16[6*pt+0]=vt,this.float32[Rt+1]=St,this.float32[Rt+2]=Et,pt}}On.prototype.bytesPerElement=12,Nn("StructArrayLayout1ui2f12",On);class Tn extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt,St){const Et=this.length;return this.resize(Et+1),this.emplace(Et,pt,vt,St)}emplace(pt,vt,St,Et){const Rt=4*pt;return this.uint32[2*pt+0]=vt,this.uint16[Rt+2]=St,this.uint16[Rt+3]=Et,pt}}Tn.prototype.bytesPerElement=8,Nn("StructArrayLayout1ul2ui8",Tn);class Sn extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt,vt){const St=this.length;return this.resize(St+1),this.emplace(St,pt,vt)}emplace(pt,vt,St){const Et=2*pt;return this.uint16[Et+0]=vt,this.uint16[Et+1]=St,pt}}Sn.prototype.bytesPerElement=4,Nn("StructArrayLayout2ui4",Sn);class Un extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(pt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,pt)}emplace(pt,vt){return this.uint16[1*pt+0]=vt,pt}}Un.prototype.bytesPerElement=2,Nn("StructArrayLayout1ui2",Un);class $a extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(pt,vt,St,Et){const Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,pt,vt,St,Et)}emplace(pt,vt,St,Et,Rt){const Lt=4*pt;return this.float32[Lt+0]=vt,this.float32[Lt+1]=St,this.float32[Lt+2]=Et,this.float32[Lt+3]=Rt,pt}}$a.prototype.bytesPerElement=16,Nn("StructArrayLayout4f16",$a);class In extends It{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ot(this.anchorPointX,this.anchorPointY)}}In.prototype.size=20;class Mn extends Rr{get(pt){return new In(this,pt)}}Nn("CollisionBoxArray",Mn);class ba extends It{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(pt){this._structArray.uint8[this._pos1+37]=pt}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(pt){this._structArray.uint8[this._pos1+38]=pt}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(pt){this._structArray.uint32[this._pos4+10]=pt}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ba.prototype.size=48;class Fo extends ln{get(pt){return new ba(this,pt)}}Nn("PlacedSymbolArray",Fo);class uo extends It{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(pt){this._structArray.uint32[this._pos4+12]=pt}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}uo.prototype.size=64;class vo extends mn{get(pt){return new uo(this,pt)}}Nn("SymbolInstanceArray",vo);class Bo extends Cn{getoffsetX(pt){return this.float32[1*pt+0]}}Nn("GlyphOffsetArray",Bo);class bs extends Yt{getx(pt){return this.int16[3*pt+0]}gety(pt){return this.int16[3*pt+1]}gettileUnitDistanceFromAnchor(pt){return this.int16[3*pt+2]}}Nn("SymbolLineVertexArray",bs);class El extends It{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}El.prototype.size=12;class zo extends On{get(pt){return new El(this,pt)}}Nn("TextAnchorOffsetArray",zo);class $s extends It{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}$s.prototype.size=8;class Es extends Tn{get(pt){return new $s(this,pt)}}Nn("FeatureIndexArray",Es);class xs extends Gt{}class Cs extends Gt{}class Ul extends Gt{}class Zu extends Jt{}class lm extends sr{}class Xu extends gr{}class Js extends vr{}class um extends Ar{}class cv extends Er{}class Qs extends Cr{}class yl extends Sr{}class ru extends Gr{}class Cl extends qr{}class ps extends Sn{}const ws=Bt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Hs}=ws;class bo{constructor(pt=[]){this.segments=pt}prepareSegment(pt,vt,St,Et){let Rt=this.segments[this.segments.length-1];return pt>bo.MAX_VERTEX_ARRAY_LENGTH&&Xt(`Max vertices per segment is ${bo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${pt}`),(!Rt||Rt.vertexLength+pt>bo.MAX_VERTEX_ARRAY_LENGTH||Rt.sortKey!==Et)&&(Rt={vertexOffset:vt.length,primitiveOffset:St.length,vertexLength:0,primitiveLength:0},Et!==void 0&&(Rt.sortKey=Et),this.segments.push(Rt)),Rt}get(){return this.segments}destroy(){for(const pt of this.segments)for(const vt in pt.vaos)pt.vaos[vt].destroy()}static simpleSegment(pt,vt,St,Et){return new bo([{vertexOffset:pt,primitiveOffset:vt,vertexLength:St,primitiveLength:Et,vaos:{},sortKey:0}])}}function Eu(gt,pt){return 256*(gt=Dt(Math.floor(gt),0,255))+Dt(Math.floor(pt),0,255)}bo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn("SegmentVector",bo);const Ku=Bt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ju={exports:{}},hy={exports:{}};hy.exports=function(gt,pt){var vt,St,Et,Rt,Lt,Nt,zt,jt;for(St=gt.length-(vt=3&gt.length),Et=pt,Lt=3432918353,Nt=461845907,jt=0;jt<St;)zt=255&gt.charCodeAt(jt)|(255&gt.charCodeAt(++jt))<<8|(255&gt.charCodeAt(++jt))<<16|(255&gt.charCodeAt(++jt))<<24,++jt,Et=27492+(65535&(Rt=5*(65535&(Et=(Et^=zt=(65535&(zt=(zt=(65535&zt)*Lt+(((zt>>>16)*Lt&65535)<<16)&4294967295)<<15|zt>>>17))*Nt+(((zt>>>16)*Nt&65535)<<16)&4294967295)<<13|Et>>>19))+((5*(Et>>>16)&65535)<<16)&4294967295))+((58964+(Rt>>>16)&65535)<<16);switch(zt=0,vt){case 3:zt^=(255&gt.charCodeAt(jt+2))<<16;case 2:zt^=(255&gt.charCodeAt(jt+1))<<8;case 1:Et^=zt=(65535&(zt=(zt=(65535&(zt^=255&gt.charCodeAt(jt)))*Lt+(((zt>>>16)*Lt&65535)<<16)&4294967295)<<15|zt>>>17))*Nt+(((zt>>>16)*Nt&65535)<<16)&4294967295}return Et^=gt.length,Et=2246822507*(65535&(Et^=Et>>>16))+((2246822507*(Et>>>16)&65535)<<16)&4294967295,Et=3266489909*(65535&(Et^=Et>>>13))+((3266489909*(Et>>>16)&65535)<<16)&4294967295,(Et^=Et>>>16)>>>0};var Jy=hy.exports,fy={exports:{}};fy.exports=function(gt,pt){for(var vt,St=gt.length,Et=pt^St,Rt=0;St>=4;)vt=1540483477*(65535&(vt=255&gt.charCodeAt(Rt)|(255&gt.charCodeAt(++Rt))<<8|(255&gt.charCodeAt(++Rt))<<16|(255&gt.charCodeAt(++Rt))<<24))+((1540483477*(vt>>>16)&65535)<<16),Et=1540483477*(65535&Et)+((1540483477*(Et>>>16)&65535)<<16)^(vt=1540483477*(65535&(vt^=vt>>>24))+((1540483477*(vt>>>16)&65535)<<16)),St-=4,++Rt;switch(St){case 3:Et^=(255&gt.charCodeAt(Rt+2))<<16;case 2:Et^=(255&gt.charCodeAt(Rt+1))<<8;case 1:Et=1540483477*(65535&(Et^=255&gt.charCodeAt(Rt)))+((1540483477*(Et>>>16)&65535)<<16)}return Et=1540483477*(65535&(Et^=Et>>>13))+((1540483477*(Et>>>16)&65535)<<16),(Et^=Et>>>15)>>>0};var nu=Jy,dy=fy.exports;Ju.exports=nu,Ju.exports.murmur3=nu,Ju.exports.murmur2=dy;var cm=st(Ju.exports);class Dp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(pt,vt,St,Et){this.ids.push(hm(pt)),this.positions.push(vt,St,Et)}getPositions(pt){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const vt=hm(pt);let St=0,Et=this.ids.length-1;for(;St<Et;){const Lt=St+Et>>1;this.ids[Lt]>=vt?Et=Lt:St=Lt+1}const Rt=[];for(;this.ids[St]===vt;)Rt.push({index:this.positions[3*St],start:this.positions[3*St+1],end:this.positions[3*St+2]}),St++;return Rt}static serialize(pt,vt){const St=new Float64Array(pt.ids),Et=new Uint32Array(pt.positions);return fm(St,Et,0,St.length-1),vt&&vt.push(St.buffer,Et.buffer),{ids:St,positions:Et}}static deserialize(pt){const vt=new Dp;return vt.ids=pt.ids,vt.positions=pt.positions,vt.indexed=!0,vt}}function hm(gt){const pt=+gt;return!isNaN(pt)&&pt<=Number.MAX_SAFE_INTEGER?pt:cm(String(gt))}function fm(gt,pt,vt,St){for(;vt<St;){const Et=gt[vt+St>>1];let Rt=vt-1,Lt=St+1;for(;;){do Rt++;while(gt[Rt]<Et);do Lt--;while(gt[Lt]>Et);if(Rt>=Lt)break;Qu(gt,Rt,Lt),Qu(pt,3*Rt,3*Lt),Qu(pt,3*Rt+1,3*Lt+1),Qu(pt,3*Rt+2,3*Lt+2)}Lt-vt<St-Lt?(fm(gt,pt,vt,Lt),vt=Lt+1):(fm(gt,pt,Lt+1,St),St=Lt)}}function Qu(gt,pt,vt){const St=gt[pt];gt[pt]=gt[vt],gt[vt]=St}Nn("FeaturePositionMap",Dp);class Pp{constructor(pt,vt){this.gl=pt.gl,this.location=vt}}class py extends Pp{constructor(pt,vt){super(pt,vt),this.current=0}set(pt){this.current!==pt&&(this.current=pt,this.gl.uniform1f(this.location,pt))}}class G_ extends Pp{constructor(pt,vt){super(pt,vt),this.current=[0,0,0,0]}set(pt){pt[0]===this.current[0]&&pt[1]===this.current[1]&&pt[2]===this.current[2]&&pt[3]===this.current[3]||(this.current=pt,this.gl.uniform4f(this.location,pt[0],pt[1],pt[2],pt[3]))}}class j_ extends Pp{constructor(pt,vt){super(pt,vt),this.current=ro.transparent}set(pt){pt.r===this.current.r&&pt.g===this.current.g&&pt.b===this.current.b&&pt.a===this.current.a||(this.current=pt,this.gl.uniform4f(this.location,pt.r,pt.g,pt.b,pt.a))}}const M1=new Float32Array(16);function Qy(gt){return[Eu(255*gt.r,255*gt.g),Eu(255*gt.b,255*gt.a)]}class hv{constructor(pt,vt,St){this.value=pt,this.uniformNames=vt.map(Et=>`u_${Et}`),this.type=St}setUniform(pt,vt,St){pt.set(St.constantOr(this.value))}getBinding(pt,vt,St){return this.type==="color"?new j_(pt,vt):new py(pt,vt)}}class dm{constructor(pt,vt){this.uniformNames=vt.map(St=>`u_${St}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(pt,vt){this.pixelRatioFrom=vt.pixelRatio,this.pixelRatioTo=pt.pixelRatio,this.patternFrom=vt.tlbr,this.patternTo=pt.tlbr}setUniform(pt,vt,St,Et){const Rt=Et==="u_pattern_to"?this.patternTo:Et==="u_pattern_from"?this.patternFrom:Et==="u_pixel_ratio_to"?this.pixelRatioTo:Et==="u_pixel_ratio_from"?this.pixelRatioFrom:null;Rt&&pt.set(Rt)}getBinding(pt,vt,St){return St.substr(0,9)==="u_pattern"?new G_(pt,vt):new py(pt,vt)}}class Cu{constructor(pt,vt,St,Et){this.expression=pt,this.type=St,this.maxValue=0,this.paintVertexAttributes=vt.map(Rt=>({name:`a_${Rt}`,type:"Float32",components:St==="color"?2:1,offset:0})),this.paintVertexArray=new Et}populatePaintArray(pt,vt,St,Et,Rt){const Lt=this.paintVertexArray.length,Nt=this.expression.evaluate(new No(0),vt,{},Et,[],Rt);this.paintVertexArray.resize(pt),this._setPaintValue(Lt,pt,Nt)}updatePaintArray(pt,vt,St,Et){const Rt=this.expression.evaluate({zoom:0},St,Et);this._setPaintValue(pt,vt,Rt)}_setPaintValue(pt,vt,St){if(this.type==="color"){const Et=Qy(St);for(let Rt=pt;Rt<vt;Rt++)this.paintVertexArray.emplace(Rt,Et[0],Et[1])}else{for(let Et=pt;Et<vt;Et++)this.paintVertexArray.emplace(Et,St);this.maxValue=Math.max(this.maxValue,Math.abs(St))}}upload(pt){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=pt.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kl{constructor(pt,vt,St,Et,Rt,Lt){this.expression=pt,this.uniformNames=vt.map(Nt=>`u_${Nt}_t`),this.type=St,this.useIntegerZoom=Et,this.zoom=Rt,this.maxValue=0,this.paintVertexAttributes=vt.map(Nt=>({name:`a_${Nt}`,type:"Float32",components:St==="color"?4:2,offset:0})),this.paintVertexArray=new Lt}populatePaintArray(pt,vt,St,Et,Rt){const Lt=this.expression.evaluate(new No(this.zoom),vt,{},Et,[],Rt),Nt=this.expression.evaluate(new No(this.zoom+1),vt,{},Et,[],Rt),zt=this.paintVertexArray.length;this.paintVertexArray.resize(pt),this._setPaintValue(zt,pt,Lt,Nt)}updatePaintArray(pt,vt,St,Et){const Rt=this.expression.evaluate({zoom:this.zoom},St,Et),Lt=this.expression.evaluate({zoom:this.zoom+1},St,Et);this._setPaintValue(pt,vt,Rt,Lt)}_setPaintValue(pt,vt,St,Et){if(this.type==="color"){const Rt=Qy(St),Lt=Qy(Et);for(let Nt=pt;Nt<vt;Nt++)this.paintVertexArray.emplace(Nt,Rt[0],Rt[1],Lt[0],Lt[1])}else{for(let Rt=pt;Rt<vt;Rt++)this.paintVertexArray.emplace(Rt,St,Et);this.maxValue=Math.max(this.maxValue,Math.abs(St),Math.abs(Et))}}upload(pt){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=pt.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(pt,vt){const St=this.useIntegerZoom?Math.floor(vt.zoom):vt.zoom,Et=Dt(this.expression.interpolationFactor(St,this.zoom,this.zoom+1),0,1);pt.set(Et)}getBinding(pt,vt,St){return new py(pt,vt)}}class ep{constructor(pt,vt,St,Et,Rt,Lt){this.expression=pt,this.type=vt,this.useIntegerZoom=St,this.zoom=Et,this.layerId=Lt,this.zoomInPaintVertexArray=new Rt,this.zoomOutPaintVertexArray=new Rt}populatePaintArray(pt,vt,St){const Et=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(pt),this.zoomOutPaintVertexArray.resize(pt),this._setPaintValues(Et,pt,vt.patterns&&vt.patterns[this.layerId],St)}updatePaintArray(pt,vt,St,Et,Rt){this._setPaintValues(pt,vt,St.patterns&&St.patterns[this.layerId],Rt)}_setPaintValues(pt,vt,St,Et){if(!Et||!St)return;const{min:Rt,mid:Lt,max:Nt}=St,zt=Et[Rt],jt=Et[Lt],Wt=Et[Nt];if(zt&&jt&&Wt)for(let qt=pt;qt<vt;qt++)this.zoomInPaintVertexArray.emplace(qt,jt.tl[0],jt.tl[1],jt.br[0],jt.br[1],zt.tl[0],zt.tl[1],zt.br[0],zt.br[1],jt.pixelRatio,zt.pixelRatio),this.zoomOutPaintVertexArray.emplace(qt,jt.tl[0],jt.tl[1],jt.br[0],jt.br[1],Wt.tl[0],Wt.tl[1],Wt.br[0],Wt.br[1],jt.pixelRatio,Wt.pixelRatio)}upload(pt){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=pt.createVertexBuffer(this.zoomInPaintVertexArray,Ku.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=pt.createVertexBuffer(this.zoomOutPaintVertexArray,Ku.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class H_{constructor(pt,vt,St){this.binders={},this._buffers=[];const Et=[];for(const Rt in pt.paint._values){if(!St(Rt))continue;const Lt=pt.paint.get(Rt);if(!(Lt instanceof Vl&&Nu(Lt.property.specification)))continue;const Nt=R1(Rt,pt.type),zt=Lt.value,jt=Lt.property.specification.type,Wt=Lt.property.useIntegerZoom,qt=Lt.property.specification["property-type"],ir=qt==="cross-faded"||qt==="cross-faded-data-driven";if(zt.kind==="constant")this.binders[Rt]=ir?new dm(zt.value,Nt):new hv(zt.value,Nt,jt),Et.push(`/u_${Rt}`);else if(zt.kind==="source"||ir){const or=W_(Rt,jt,"source");this.binders[Rt]=ir?new ep(zt,jt,Wt,vt,or,pt.id):new Cu(zt,Nt,jt,or),Et.push(`/a_${Rt}`)}else{const or=W_(Rt,jt,"composite");this.binders[Rt]=new Kl(zt,Nt,jt,Wt,vt,or),Et.push(`/z_${Rt}`)}}this.cacheKey=Et.sort().join("")}getMaxValue(pt){const vt=this.binders[pt];return vt instanceof Cu||vt instanceof Kl?vt.maxValue:0}populatePaintArrays(pt,vt,St,Et,Rt){for(const Lt in this.binders){const Nt=this.binders[Lt];(Nt instanceof Cu||Nt instanceof Kl||Nt instanceof ep)&&Nt.populatePaintArray(pt,vt,St,Et,Rt)}}setConstantPatternPositions(pt,vt){for(const St in this.binders){const Et=this.binders[St];Et instanceof dm&&Et.setConstantPatternPositions(pt,vt)}}updatePaintArrays(pt,vt,St,Et,Rt){let Lt=!1;for(const Nt in pt){const zt=vt.getPositions(Nt);for(const jt of zt){const Wt=St.feature(jt.index);for(const qt in this.binders){const ir=this.binders[qt];if((ir instanceof Cu||ir instanceof Kl||ir instanceof ep)&&ir.expression.isStateDependent===!0){const or=Et.paint.get(qt);ir.expression=or.value,ir.updatePaintArray(jt.start,jt.end,Wt,pt[Nt],Rt),Lt=!0}}}}return Lt}defines(){const pt=[];for(const vt in this.binders){const St=this.binders[vt];(St instanceof hv||St instanceof dm)&&pt.push(...St.uniformNames.map(Et=>`#define HAS_UNIFORM_${Et}`))}return pt}getBinderAttributes(){const pt=[];for(const vt in this.binders){const St=this.binders[vt];if(St instanceof Cu||St instanceof Kl)for(let Et=0;Et<St.paintVertexAttributes.length;Et++)pt.push(St.paintVertexAttributes[Et].name);else if(St instanceof ep)for(let Et=0;Et<Ku.members.length;Et++)pt.push(Ku.members[Et].name)}return pt}getBinderUniforms(){const pt=[];for(const vt in this.binders){const St=this.binders[vt];if(St instanceof hv||St instanceof dm||St instanceof Kl)for(const Et of St.uniformNames)pt.push(Et)}return pt}getPaintVertexBuffers(){return this._buffers}getUniforms(pt,vt){const St=[];for(const Et in this.binders){const Rt=this.binders[Et];if(Rt instanceof hv||Rt instanceof dm||Rt instanceof Kl){for(const Lt of Rt.uniformNames)if(vt[Lt]){const Nt=Rt.getBinding(pt,vt[Lt],Lt);St.push({name:Lt,property:Et,binding:Nt})}}}return St}setUniforms(pt,vt,St,Et){for(const{name:Rt,property:Lt,binding:Nt}of vt)this.binders[Lt].setUniform(Nt,Et,St.get(Lt),Rt)}updatePaintBuffers(pt){this._buffers=[];for(const vt in this.binders){const St=this.binders[vt];if(pt&&St instanceof ep){const Et=pt.fromScale===2?St.zoomInPaintVertexBuffer:St.zoomOutPaintVertexBuffer;Et&&this._buffers.push(Et)}else(St instanceof Cu||St instanceof Kl)&&St.paintVertexBuffer&&this._buffers.push(St.paintVertexBuffer)}}upload(pt){for(const vt in this.binders){const St=this.binders[vt];(St instanceof Cu||St instanceof Kl||St instanceof ep)&&St.upload(pt)}this.updatePaintBuffers()}destroy(){for(const pt in this.binders){const vt=this.binders[pt];(vt instanceof Cu||vt instanceof Kl||vt instanceof ep)&&vt.destroy()}}}class Mp{constructor(pt,vt,St=()=>!0){this.programConfigurations={};for(const Et of pt)this.programConfigurations[Et.id]=new H_(Et,vt,St);this.needsUpload=!1,this._featureMap=new Dp,this._bufferOffset=0}populatePaintArrays(pt,vt,St,Et,Rt,Lt){for(const Nt in this.programConfigurations)this.programConfigurations[Nt].populatePaintArrays(pt,vt,Et,Rt,Lt);vt.id!==void 0&&this._featureMap.add(vt.id,St,this._bufferOffset,pt),this._bufferOffset=pt,this.needsUpload=!0}updatePaintArrays(pt,vt,St,Et){for(const Rt of St)this.needsUpload=this.programConfigurations[Rt.id].updatePaintArrays(pt,this._featureMap,vt,Rt,Et)||this.needsUpload}get(pt){return this.programConfigurations[pt]}upload(pt){if(this.needsUpload){for(const vt in this.programConfigurations)this.programConfigurations[vt].upload(pt);this.needsUpload=!1}}destroy(){for(const pt in this.programConfigurations)this.programConfigurations[pt].destroy()}}function R1(gt,pt){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[gt]||[gt.replace(`${pt}-`,"").replace(/-/g,"_")]}function W_(gt,pt,vt){const St={color:{source:gr,composite:$a},number:{source:Cn,composite:gr}},Et=function(Rt){return{"line-pattern":{source:Js,composite:Js},"fill-pattern":{source:Js,composite:Js},"fill-extrusion-pattern":{source:Js,composite:Js}}[Rt]}(gt);return Et&&Et[vt]||St[pt][vt]}Nn("ConstantBinder",hv),Nn("CrossFadedConstantBinder",dm),Nn("SourceExpressionBinder",Cu),Nn("CrossFadedCompositeBinder",ep),Nn("CompositeExpressionBinder",Kl),Nn("ProgramConfiguration",H_,{omit:["_buffers"]}),Nn("ProgramConfigurationSet",Mp);const es=8192,e_=Math.pow(2,14)-1,Y_=-e_-1;function Rp(gt){const pt=es/gt.extent,vt=gt.loadGeometry();for(let St=0;St<vt.length;St++){const Et=vt[St];for(let Rt=0;Rt<Et.length;Rt++){const Lt=Et[Rt],Nt=Math.round(Lt.x*pt),zt=Math.round(Lt.y*pt);Lt.x=Dt(Nt,Y_,e_),Lt.y=Dt(zt,Y_,e_),(Nt<Lt.x||Nt>Lt.x+1||zt<Lt.y||zt>Lt.y+1)&&Xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return vt}function Lp(gt,pt){return{type:gt.type,id:gt.id,properties:gt.properties,geometry:pt?Rp(gt):[]}}function gy(gt,pt,vt,St,Et){gt.emplaceBack(2*pt+(St+1)/2,2*vt+(Et+1)/2)}class t_{constructor(pt){this.zoom=pt.zoom,this.overscaling=pt.overscaling,this.layers=pt.layers,this.layerIds=this.layers.map(vt=>vt.id),this.index=pt.index,this.hasPattern=!1,this.layoutVertexArray=new Cs,this.indexArray=new Cl,this.segments=new bo,this.programConfigurations=new Mp(pt.layers,pt.zoom),this.stateDependentLayerIds=this.layers.filter(vt=>vt.isStateDependent()).map(vt=>vt.id)}populate(pt,vt,St){const Et=this.layers[0],Rt=[];let Lt=null,Nt=!1;Et.type==="circle"&&(Lt=Et.layout.get("circle-sort-key"),Nt=!Lt.isConstant());for(const{feature:zt,id:jt,index:Wt,sourceLayerIndex:qt}of pt){const ir=this.layers[0]._featureFilter.needGeometry,or=Lp(zt,ir);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),or,St))continue;const lr=Nt?Lt.evaluate(or,{},St):void 0,pr={id:jt,properties:zt.properties,type:zt.type,sourceLayerIndex:qt,index:Wt,geometry:ir?or.geometry:Rp(zt),patterns:{},sortKey:lr};Rt.push(pr)}Nt&&Rt.sort((zt,jt)=>zt.sortKey-jt.sortKey);for(const zt of Rt){const{geometry:jt,index:Wt,sourceLayerIndex:qt}=zt,ir=pt[Wt].feature;this.addFeature(zt,jt,Wt,St),vt.featureIndex.insert(ir,jt,Wt,qt,this.index)}}update(pt,vt,St){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(pt,vt,this.stateDependentLayers,St)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(pt){this.uploaded||(this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,Hs),this.indexBuffer=pt.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(pt),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(pt,vt,St,Et){for(const Rt of vt)for(const Lt of Rt){const Nt=Lt.x,zt=Lt.y;if(Nt<0||Nt>=es||zt<0||zt>=es)continue;const jt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,pt.sortKey),Wt=jt.vertexLength;gy(this.layoutVertexArray,Nt,zt,-1,-1),gy(this.layoutVertexArray,Nt,zt,1,-1),gy(this.layoutVertexArray,Nt,zt,1,1),gy(this.layoutVertexArray,Nt,zt,-1,1),this.indexArray.emplaceBack(Wt,Wt+1,Wt+2),this.indexArray.emplaceBack(Wt,Wt+3,Wt+2),jt.vertexLength+=4,jt.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,pt,St,{},Et)}}function q_(gt,pt){for(let vt=0;vt<gt.length;vt++)if(pm(pt,gt[vt]))return!0;for(let vt=0;vt<pt.length;vt++)if(pm(gt,pt[vt]))return!0;return!!r_(gt,pt)}function L1(gt,pt,vt){return!!pm(gt,pt)||!!n_(pt,gt,vt)}function Z_(gt,pt){if(gt.length===1)return K_(pt,gt[0]);for(let vt=0;vt<pt.length;vt++){const St=pt[vt];for(let Et=0;Et<St.length;Et++)if(pm(gt,St[Et]))return!0}for(let vt=0;vt<gt.length;vt++)if(K_(pt,gt[vt]))return!0;for(let vt=0;vt<pt.length;vt++)if(r_(gt,pt[vt]))return!0;return!1}function O1(gt,pt,vt){if(gt.length>1){if(r_(gt,pt))return!0;for(let St=0;St<pt.length;St++)if(n_(pt[St],gt,vt))return!0}for(let St=0;St<gt.length;St++)if(n_(gt[St],pt,vt))return!0;return!1}function r_(gt,pt){if(gt.length===0||pt.length===0)return!1;for(let vt=0;vt<gt.length-1;vt++){const St=gt[vt],Et=gt[vt+1];for(let Rt=0;Rt<pt.length-1;Rt++)if($1(St,Et,pt[Rt],pt[Rt+1]))return!0}return!1}function $1(gt,pt,vt,St){return Zt(gt,vt,St)!==Zt(pt,vt,St)&&Zt(gt,pt,vt)!==Zt(gt,pt,St)}function n_(gt,pt,vt){const St=vt*vt;if(pt.length===1)return gt.distSqr(pt[0])<St;for(let Et=1;Et<pt.length;Et++)if(X_(gt,pt[Et-1],pt[Et])<St)return!0;return!1}function X_(gt,pt,vt){const St=pt.distSqr(vt);if(St===0)return gt.distSqr(pt);const Et=((gt.x-pt.x)*(vt.x-pt.x)+(gt.y-pt.y)*(vt.y-pt.y))/St;return gt.distSqr(Et<0?pt:Et>1?vt:vt.sub(pt)._mult(Et)._add(pt))}function K_(gt,pt){let vt,St,Et,Rt=!1;for(let Lt=0;Lt<gt.length;Lt++){vt=gt[Lt];for(let Nt=0,zt=vt.length-1;Nt<vt.length;zt=Nt++)St=vt[Nt],Et=vt[zt],St.y>pt.y!=Et.y>pt.y&&pt.x<(Et.x-St.x)*(pt.y-St.y)/(Et.y-St.y)+St.x&&(Rt=!Rt)}return Rt}function pm(gt,pt){let vt=!1;for(let St=0,Et=gt.length-1;St<gt.length;Et=St++){const Rt=gt[St],Lt=gt[Et];Rt.y>pt.y!=Lt.y>pt.y&&pt.x<(Lt.x-Rt.x)*(pt.y-Rt.y)/(Lt.y-Rt.y)+Rt.x&&(vt=!vt)}return vt}function k1(gt,pt,vt){const St=vt[0],Et=vt[2];if(gt.x<St.x&&pt.x<St.x||gt.x>Et.x&&pt.x>Et.x||gt.y<St.y&&pt.y<St.y||gt.y>Et.y&&pt.y>Et.y)return!1;const Rt=Zt(gt,pt,vt[0]);return Rt!==Zt(gt,pt,vt[1])||Rt!==Zt(gt,pt,vt[2])||Rt!==Zt(gt,pt,vt[3])}function fv(gt,pt,vt){const St=pt.paint.get(gt).value;return St.kind==="constant"?St.value:vt.programConfigurations.get(pt.id).getMaxValue(gt)}function my(gt){return Math.sqrt(gt[0]*gt[0]+gt[1]*gt[1])}function vy(gt,pt,vt,St,Et){if(!pt[0]&&!pt[1])return gt;const Rt=ot.convert(pt)._mult(Et);vt==="viewport"&&Rt._rotate(-St);const Lt=[];for(let Nt=0;Nt<gt.length;Nt++)Lt.push(gt[Nt].sub(Rt));return Lt}let J_,Q_;Nn("CircleBucket",t_,{omit:["layers"]});var N1={get paint(){return Q_=Q_||new Mt({"circle-radius":new _i(zr.paint_circle["circle-radius"]),"circle-color":new _i(zr.paint_circle["circle-color"]),"circle-blur":new _i(zr.paint_circle["circle-blur"]),"circle-opacity":new _i(zr.paint_circle["circle-opacity"]),"circle-translate":new Vn(zr.paint_circle["circle-translate"]),"circle-translate-anchor":new Vn(zr.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vn(zr.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vn(zr.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _i(zr.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _i(zr.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _i(zr.paint_circle["circle-stroke-opacity"])})},get layout(){return J_=J_||new Mt({"circle-sort-key":new _i(zr.layout_circle["circle-sort-key"])})}},ks=1e-6,gm=typeof Float32Array<"u"?Float32Array:Array;function i_(gt){return gt[0]=1,gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[5]=1,gt[6]=0,gt[7]=0,gt[8]=0,gt[9]=0,gt[10]=1,gt[11]=0,gt[12]=0,gt[13]=0,gt[14]=0,gt[15]=1,gt}function e0(gt,pt,vt){var St=pt[0],Et=pt[1],Rt=pt[2],Lt=pt[3],Nt=pt[4],zt=pt[5],jt=pt[6],Wt=pt[7],qt=pt[8],ir=pt[9],or=pt[10],lr=pt[11],pr=pt[12],Tr=pt[13],Ir=pt[14],Wr=pt[15],$r=vt[0],jr=vt[1],en=vt[2],dn=vt[3];return gt[0]=$r*St+jr*Nt+en*qt+dn*pr,gt[1]=$r*Et+jr*zt+en*ir+dn*Tr,gt[2]=$r*Rt+jr*jt+en*or+dn*Ir,gt[3]=$r*Lt+jr*Wt+en*lr+dn*Wr,gt[4]=($r=vt[4])*St+(jr=vt[5])*Nt+(en=vt[6])*qt+(dn=vt[7])*pr,gt[5]=$r*Et+jr*zt+en*ir+dn*Tr,gt[6]=$r*Rt+jr*jt+en*or+dn*Ir,gt[7]=$r*Lt+jr*Wt+en*lr+dn*Wr,gt[8]=($r=vt[8])*St+(jr=vt[9])*Nt+(en=vt[10])*qt+(dn=vt[11])*pr,gt[9]=$r*Et+jr*zt+en*ir+dn*Tr,gt[10]=$r*Rt+jr*jt+en*or+dn*Ir,gt[11]=$r*Lt+jr*Wt+en*lr+dn*Wr,gt[12]=($r=vt[12])*St+(jr=vt[13])*Nt+(en=vt[14])*qt+(dn=vt[15])*pr,gt[13]=$r*Et+jr*zt+en*ir+dn*Tr,gt[14]=$r*Rt+jr*jt+en*or+dn*Ir,gt[15]=$r*Lt+jr*Wt+en*lr+dn*Wr,gt}Math.hypot||(Math.hypot=function(){for(var gt=0,pt=arguments.length;pt--;)gt+=arguments[pt]*arguments[pt];return Math.sqrt(gt)});var dv,F1=e0;function yy(gt,pt,vt){var St=pt[0],Et=pt[1],Rt=pt[2],Lt=pt[3];return gt[0]=vt[0]*St+vt[4]*Et+vt[8]*Rt+vt[12]*Lt,gt[1]=vt[1]*St+vt[5]*Et+vt[9]*Rt+vt[13]*Lt,gt[2]=vt[2]*St+vt[6]*Et+vt[10]*Rt+vt[14]*Lt,gt[3]=vt[3]*St+vt[7]*Et+vt[11]*Rt+vt[15]*Lt,gt}dv=new gm(4),gm!=Float32Array&&(dv[0]=0,dv[1]=0,dv[2]=0,dv[3]=0);class B1 extends xt{constructor(pt){super(pt,N1)}createBucket(pt){return new t_(pt)}queryRadius(pt){const vt=pt;return fv("circle-radius",this,vt)+fv("circle-stroke-width",this,vt)+my(this.paint.get("circle-translate"))}queryIntersectsFeature(pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=vy(pt,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Lt.angle,Nt),Wt=this.paint.get("circle-radius").evaluate(vt,St)+this.paint.get("circle-stroke-width").evaluate(vt,St),qt=this.paint.get("circle-pitch-alignment")==="map",ir=qt?jt:function(lr,pr){return lr.map(Tr=>t0(Tr,pr))}(jt,zt),or=qt?Wt*Nt:Wt;for(const lr of Et)for(const pr of lr){const Tr=qt?pr:t0(pr,zt);let Ir=or;const Wr=yy([],[pr.x,pr.y,0,1],zt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ir*=Wr[3]/Lt.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ir*=Lt.cameraToCenterDistance/Wr[3]),L1(ir,Tr,Ir))return!0}return!1}}function t0(gt,pt){const vt=yy([],[gt.x,gt.y,0,1],pt);return new ot(vt[0]/vt[3],vt[1]/vt[3])}class r0 extends t_{}let n0;Nn("HeatmapBucket",r0,{omit:["layers"]});var z1={get paint(){return n0=n0||new Mt({"heatmap-radius":new _i(zr.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _i(zr.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vn(zr.paint_heatmap["heatmap-intensity"]),"heatmap-color":new uv(zr.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vn(zr.paint_heatmap["heatmap-opacity"])})}};function a_(gt,{width:pt,height:vt},St,Et){if(Et){if(Et instanceof Uint8ClampedArray)Et=new Uint8Array(Et.buffer);else if(Et.length!==pt*vt*St)throw new RangeError(`mismatched image size. expected: ${Et.length} but got: ${pt*vt*St}`)}else Et=new Uint8Array(pt*vt*St);return gt.width=pt,gt.height=vt,gt.data=Et,gt}function i0(gt,{width:pt,height:vt},St){if(pt===gt.width&&vt===gt.height)return;const Et=a_({},{width:pt,height:vt},St);o_(gt,Et,{x:0,y:0},{x:0,y:0},{width:Math.min(gt.width,pt),height:Math.min(gt.height,vt)},St),gt.width=pt,gt.height=vt,gt.data=Et.data}function o_(gt,pt,vt,St,Et,Rt){if(Et.width===0||Et.height===0)return pt;if(Et.width>gt.width||Et.height>gt.height||vt.x>gt.width-Et.width||vt.y>gt.height-Et.height)throw new RangeError("out of range source coordinates for image copy");if(Et.width>pt.width||Et.height>pt.height||St.x>pt.width-Et.width||St.y>pt.height-Et.height)throw new RangeError("out of range destination coordinates for image copy");const Lt=gt.data,Nt=pt.data;if(Lt===Nt)throw new Error("srcData equals dstData, so image is already copied");for(let zt=0;zt<Et.height;zt++){const jt=((vt.y+zt)*gt.width+vt.x)*Rt,Wt=((St.y+zt)*pt.width+St.x)*Rt;for(let qt=0;qt<Et.width*Rt;qt++)Nt[Wt+qt]=Lt[jt+qt]}return pt}class pv{constructor(pt,vt){a_(this,pt,1,vt)}resize(pt){i0(this,pt,1)}clone(){return new pv({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(pt,vt,St,Et,Rt){o_(pt,vt,St,Et,Rt,1)}}class Dl{constructor(pt,vt){a_(this,pt,4,vt)}resize(pt){i0(this,pt,4)}replace(pt,vt){vt?this.data.set(pt):this.data=pt instanceof Uint8ClampedArray?new Uint8Array(pt.buffer):pt}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(pt,vt,St,Et,Rt){o_(pt,vt,St,Et,Rt,4)}}function a0(gt){const pt={},vt=gt.resolution||256,St=gt.clips?gt.clips.length:1,Et=gt.image||new Dl({width:vt,height:St});if(Math.log(vt)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${vt}`);const Rt=(Lt,Nt,zt)=>{pt[gt.evaluationKey]=zt;const jt=gt.expression.evaluate(pt);Et.data[Lt+Nt+0]=Math.floor(255*jt.r/jt.a),Et.data[Lt+Nt+1]=Math.floor(255*jt.g/jt.a),Et.data[Lt+Nt+2]=Math.floor(255*jt.b/jt.a),Et.data[Lt+Nt+3]=Math.floor(255*jt.a)};if(gt.clips)for(let Lt=0,Nt=0;Lt<St;++Lt,Nt+=4*vt)for(let zt=0,jt=0;zt<vt;zt++,jt+=4){const Wt=zt/(vt-1),{start:qt,end:ir}=gt.clips[Lt];Rt(Nt,jt,qt*(1-Wt)+ir*Wt)}else for(let Lt=0,Nt=0;Lt<vt;Lt++,Nt+=4)Rt(0,Nt,Lt/(vt-1));return Et}Nn("AlphaImage",pv),Nn("RGBAImage",Dl);const s_="big-fb";class V1 extends xt{createBucket(pt){return new r0(pt)}constructor(pt){super(pt,z1),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(pt){pt==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=a0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(s_)&&this.heatmapFbos.delete(s_)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let o0;var U1={get paint(){return o0=o0||new Mt({"hillshade-illumination-direction":new Vn(zr.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Vn(zr.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vn(zr.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vn(zr.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vn(zr.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vn(zr.paint_hillshade["hillshade-accent-color"])})}};class G1 extends xt{constructor(pt){super(pt,U1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const j1=Bt([{name:"a_pos",components:2,type:"Int16"}],4),{members:H1}=j1;function s0(gt,pt,vt=2){const St=pt&&pt.length,Et=St?pt[0]*vt:gt.length;let Rt=l0(gt,0,Et,vt,!0);const Lt=[];if(!Rt||Rt.next===Rt.prev)return Lt;let Nt,zt,jt;if(St&&(Rt=function(Wt,qt,ir,or){const lr=[];for(let pr=0,Tr=qt.length;pr<Tr;pr++){const Ir=l0(Wt,qt[pr]*or,pr<Tr-1?qt[pr+1]*or:Wt.length,or,!1);Ir===Ir.next&&(Ir.steiner=!0),lr.push(Q1(Ir))}lr.sort(X1);for(let pr=0;pr<lr.length;pr++)ir=K1(lr[pr],ir);return ir}(gt,pt,Rt,vt)),gt.length>80*vt){Nt=1/0,zt=1/0;let Wt=-1/0,qt=-1/0;for(let ir=vt;ir<Et;ir+=vt){const or=gt[ir],lr=gt[ir+1];or<Nt&&(Nt=or),lr<zt&&(zt=lr),or>Wt&&(Wt=or),lr>qt&&(qt=lr)}jt=Math.max(Wt-Nt,qt-zt),jt=jt!==0?32767/jt:0}return gv(Rt,Lt,vt,Nt,zt,jt,0),Lt}function l0(gt,pt,vt,St,Et){let Rt;if(Et===function(Lt,Nt,zt,jt){let Wt=0;for(let qt=Nt,ir=zt-jt;qt<zt;qt+=jt)Wt+=(Lt[ir]-Lt[qt])*(Lt[qt+1]+Lt[ir+1]),ir=qt;return Wt}(gt,pt,vt,St)>0)for(let Lt=pt;Lt<vt;Lt+=St)Rt=h0(Lt/St|0,gt[Lt],gt[Lt+1],Rt);else for(let Lt=vt-St;Lt>=pt;Lt-=St)Rt=h0(Lt/St|0,gt[Lt],gt[Lt+1],Rt);return Rt&&_y(Rt,Rt.next)&&(vv(Rt),Rt=Rt.next),Rt}function Op(gt,pt){if(!gt)return gt;pt||(pt=gt);let vt,St=gt;do if(vt=!1,St.steiner||!_y(St,St.next)&&Ko(St.prev,St,St.next)!==0)St=St.next;else{if(vv(St),St=pt=St.prev,St===St.next)break;vt=!0}while(vt||St!==pt);return pt}function gv(gt,pt,vt,St,Et,Rt,Lt){if(!gt)return;!Lt&&Rt&&function(zt,jt,Wt,qt){let ir=zt;do ir.z===0&&(ir.z=l_(ir.x,ir.y,jt,Wt,qt)),ir.prevZ=ir.prev,ir.nextZ=ir.next,ir=ir.next;while(ir!==zt);ir.prevZ.nextZ=null,ir.prevZ=null,function(or){let lr,pr=1;do{let Tr,Ir=or;or=null;let Wr=null;for(lr=0;Ir;){lr++;let $r=Ir,jr=0;for(let dn=0;dn<pr&&(jr++,$r=$r.nextZ,$r);dn++);let en=pr;for(;jr>0||en>0&&$r;)jr!==0&&(en===0||!$r||Ir.z<=$r.z)?(Tr=Ir,Ir=Ir.nextZ,jr--):(Tr=$r,$r=$r.nextZ,en--),Wr?Wr.nextZ=Tr:or=Tr,Tr.prevZ=Wr,Wr=Tr;Ir=$r}Wr.nextZ=null,pr*=2}while(lr>1)}(ir)}(gt,St,Et,Rt);let Nt=gt;for(;gt.prev!==gt.next;){const zt=gt.prev,jt=gt.next;if(Rt?Y1(gt,St,Et,Rt):W1(gt))pt.push(zt.i,gt.i,jt.i),vv(gt),gt=jt.next,Nt=jt.next;else if((gt=jt)===Nt){Lt?Lt===1?gv(gt=q1(Op(gt),pt),pt,vt,St,Et,Rt,2):Lt===2&&Z1(gt,pt,vt,St,Et,Rt):gv(Op(gt),pt,vt,St,Et,Rt,1);break}}}function W1(gt){const pt=gt.prev,vt=gt,St=gt.next;if(Ko(pt,vt,St)>=0)return!1;const Et=pt.x,Rt=vt.x,Lt=St.x,Nt=pt.y,zt=vt.y,jt=St.y,Wt=Et<Rt?Et<Lt?Et:Lt:Rt<Lt?Rt:Lt,qt=Nt<zt?Nt<jt?Nt:jt:zt<jt?zt:jt,ir=Et>Rt?Et>Lt?Et:Lt:Rt>Lt?Rt:Lt,or=Nt>zt?Nt>jt?Nt:jt:zt>jt?zt:jt;let lr=St.next;for(;lr!==pt;){if(lr.x>=Wt&&lr.x<=ir&&lr.y>=qt&&lr.y<=or&&mm(Et,Nt,Rt,zt,Lt,jt,lr.x,lr.y)&&Ko(lr.prev,lr,lr.next)>=0)return!1;lr=lr.next}return!0}function Y1(gt,pt,vt,St){const Et=gt.prev,Rt=gt,Lt=gt.next;if(Ko(Et,Rt,Lt)>=0)return!1;const Nt=Et.x,zt=Rt.x,jt=Lt.x,Wt=Et.y,qt=Rt.y,ir=Lt.y,or=Nt<zt?Nt<jt?Nt:jt:zt<jt?zt:jt,lr=Wt<qt?Wt<ir?Wt:ir:qt<ir?qt:ir,pr=Nt>zt?Nt>jt?Nt:jt:zt>jt?zt:jt,Tr=Wt>qt?Wt>ir?Wt:ir:qt>ir?qt:ir,Ir=l_(or,lr,pt,vt,St),Wr=l_(pr,Tr,pt,vt,St);let $r=gt.prevZ,jr=gt.nextZ;for(;$r&&$r.z>=Ir&&jr&&jr.z<=Wr;){if($r.x>=or&&$r.x<=pr&&$r.y>=lr&&$r.y<=Tr&&$r!==Et&&$r!==Lt&&mm(Nt,Wt,zt,qt,jt,ir,$r.x,$r.y)&&Ko($r.prev,$r,$r.next)>=0||($r=$r.prevZ,jr.x>=or&&jr.x<=pr&&jr.y>=lr&&jr.y<=Tr&&jr!==Et&&jr!==Lt&&mm(Nt,Wt,zt,qt,jt,ir,jr.x,jr.y)&&Ko(jr.prev,jr,jr.next)>=0))return!1;jr=jr.nextZ}for(;$r&&$r.z>=Ir;){if($r.x>=or&&$r.x<=pr&&$r.y>=lr&&$r.y<=Tr&&$r!==Et&&$r!==Lt&&mm(Nt,Wt,zt,qt,jt,ir,$r.x,$r.y)&&Ko($r.prev,$r,$r.next)>=0)return!1;$r=$r.prevZ}for(;jr&&jr.z<=Wr;){if(jr.x>=or&&jr.x<=pr&&jr.y>=lr&&jr.y<=Tr&&jr!==Et&&jr!==Lt&&mm(Nt,Wt,zt,qt,jt,ir,jr.x,jr.y)&&Ko(jr.prev,jr,jr.next)>=0)return!1;jr=jr.nextZ}return!0}function q1(gt,pt){let vt=gt;do{const St=vt.prev,Et=vt.next.next;!_y(St,Et)&&u0(St,vt,vt.next,Et)&&mv(St,Et)&&mv(Et,St)&&(pt.push(St.i,vt.i,Et.i),vv(vt),vv(vt.next),vt=gt=Et),vt=vt.next}while(vt!==gt);return Op(vt)}function Z1(gt,pt,vt,St,Et,Rt){let Lt=gt;do{let Nt=Lt.next.next;for(;Nt!==Lt.prev;){if(Lt.i!==Nt.i&&ex(Lt,Nt)){let zt=c0(Lt,Nt);return Lt=Op(Lt,Lt.next),zt=Op(zt,zt.next),gv(Lt,pt,vt,St,Et,Rt,0),void gv(zt,pt,vt,St,Et,Rt,0)}Nt=Nt.next}Lt=Lt.next}while(Lt!==gt)}function X1(gt,pt){return gt.x-pt.x}function K1(gt,pt){const vt=function(Et,Rt){let Lt=Rt;const Nt=Et.x,zt=Et.y;let jt,Wt=-1/0;do{if(zt<=Lt.y&&zt>=Lt.next.y&&Lt.next.y!==Lt.y){const pr=Lt.x+(zt-Lt.y)*(Lt.next.x-Lt.x)/(Lt.next.y-Lt.y);if(pr<=Nt&&pr>Wt&&(Wt=pr,jt=Lt.x<Lt.next.x?Lt:Lt.next,pr===Nt))return jt}Lt=Lt.next}while(Lt!==Rt);if(!jt)return null;const qt=jt,ir=jt.x,or=jt.y;let lr=1/0;Lt=jt;do{if(Nt>=Lt.x&&Lt.x>=ir&&Nt!==Lt.x&&mm(zt<or?Nt:Wt,zt,ir,or,zt<or?Wt:Nt,zt,Lt.x,Lt.y)){const pr=Math.abs(zt-Lt.y)/(Nt-Lt.x);mv(Lt,Et)&&(pr<lr||pr===lr&&(Lt.x>jt.x||Lt.x===jt.x&&J1(jt,Lt)))&&(jt=Lt,lr=pr)}Lt=Lt.next}while(Lt!==qt);return jt}(gt,pt);if(!vt)return pt;const St=c0(vt,gt);return Op(St,St.next),Op(vt,vt.next)}function J1(gt,pt){return Ko(gt.prev,gt,pt.prev)<0&&Ko(pt.next,gt,gt.next)<0}function l_(gt,pt,vt,St,Et){return(gt=1431655765&((gt=858993459&((gt=252645135&((gt=16711935&((gt=(gt-vt)*Et|0)|gt<<8))|gt<<4))|gt<<2))|gt<<1))|(pt=1431655765&((pt=858993459&((pt=252645135&((pt=16711935&((pt=(pt-St)*Et|0)|pt<<8))|pt<<4))|pt<<2))|pt<<1))<<1}function Q1(gt){let pt=gt,vt=gt;do(pt.x<vt.x||pt.x===vt.x&&pt.y<vt.y)&&(vt=pt),pt=pt.next;while(pt!==gt);return vt}function mm(gt,pt,vt,St,Et,Rt,Lt,Nt){return(Et-Lt)*(pt-Nt)>=(gt-Lt)*(Rt-Nt)&&(gt-Lt)*(St-Nt)>=(vt-Lt)*(pt-Nt)&&(vt-Lt)*(Rt-Nt)>=(Et-Lt)*(St-Nt)}function ex(gt,pt){return gt.next.i!==pt.i&&gt.prev.i!==pt.i&&!function(vt,St){let Et=vt;do{if(Et.i!==vt.i&&Et.next.i!==vt.i&&Et.i!==St.i&&Et.next.i!==St.i&&u0(Et,Et.next,vt,St))return!0;Et=Et.next}while(Et!==vt);return!1}(gt,pt)&&(mv(gt,pt)&&mv(pt,gt)&&function(vt,St){let Et=vt,Rt=!1;const Lt=(vt.x+St.x)/2,Nt=(vt.y+St.y)/2;do Et.y>Nt!=Et.next.y>Nt&&Et.next.y!==Et.y&&Lt<(Et.next.x-Et.x)*(Nt-Et.y)/(Et.next.y-Et.y)+Et.x&&(Rt=!Rt),Et=Et.next;while(Et!==vt);return Rt}(gt,pt)&&(Ko(gt.prev,gt,pt.prev)||Ko(gt,pt.prev,pt))||_y(gt,pt)&&Ko(gt.prev,gt,gt.next)>0&&Ko(pt.prev,pt,pt.next)>0)}function Ko(gt,pt,vt){return(pt.y-gt.y)*(vt.x-pt.x)-(pt.x-gt.x)*(vt.y-pt.y)}function _y(gt,pt){return gt.x===pt.x&&gt.y===pt.y}function u0(gt,pt,vt,St){const Et=xy(Ko(gt,pt,vt)),Rt=xy(Ko(gt,pt,St)),Lt=xy(Ko(vt,St,gt)),Nt=xy(Ko(vt,St,pt));return Et!==Rt&&Lt!==Nt||!(Et!==0||!by(gt,vt,pt))||!(Rt!==0||!by(gt,St,pt))||!(Lt!==0||!by(vt,gt,St))||!(Nt!==0||!by(vt,pt,St))}function by(gt,pt,vt){return pt.x<=Math.max(gt.x,vt.x)&&pt.x>=Math.min(gt.x,vt.x)&&pt.y<=Math.max(gt.y,vt.y)&&pt.y>=Math.min(gt.y,vt.y)}function xy(gt){return gt>0?1:gt<0?-1:0}function mv(gt,pt){return Ko(gt.prev,gt,gt.next)<0?Ko(gt,pt,gt.next)>=0&&Ko(gt,gt.prev,pt)>=0:Ko(gt,pt,gt.prev)<0||Ko(gt,gt.next,pt)<0}function c0(gt,pt){const vt=u_(gt.i,gt.x,gt.y),St=u_(pt.i,pt.x,pt.y),Et=gt.next,Rt=pt.prev;return gt.next=pt,pt.prev=gt,vt.next=Et,Et.prev=vt,St.next=vt,vt.prev=St,Rt.next=St,St.prev=Rt,St}function h0(gt,pt,vt,St){const Et=u_(gt,pt,vt);return St?(Et.next=St.next,Et.prev=St,St.next.prev=Et,St.next=Et):(Et.prev=Et,Et.next=Et),Et}function vv(gt){gt.next.prev=gt.prev,gt.prev.next=gt.next,gt.prevZ&&(gt.prevZ.nextZ=gt.nextZ),gt.nextZ&&(gt.nextZ.prevZ=gt.prevZ)}function u_(gt,pt,vt){return{i:gt,x:pt,y:vt,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function c_(gt,pt,vt){const St=vt.patternDependencies;let Et=!1;for(const Rt of pt){const Lt=Rt.paint.get(`${gt}-pattern`);Lt.isConstant()||(Et=!0);const Nt=Lt.constantOr(null);Nt&&(Et=!0,St[Nt.to]=!0,St[Nt.from]=!0)}return Et}function h_(gt,pt,vt,St,Et){const Rt=Et.patternDependencies;for(const Lt of pt){const Nt=Lt.paint.get(`${gt}-pattern`).value;if(Nt.kind!=="constant"){let zt=Nt.evaluate({zoom:St-1},vt,{},Et.availableImages),jt=Nt.evaluate({zoom:St},vt,{},Et.availableImages),Wt=Nt.evaluate({zoom:St+1},vt,{},Et.availableImages);zt=zt&&zt.name?zt.name:zt,jt=jt&&jt.name?jt.name:jt,Wt=Wt&&Wt.name?Wt.name:Wt,Rt[zt]=!0,Rt[jt]=!0,Rt[Wt]=!0,vt.patterns[Lt.id]={min:zt,mid:jt,max:Wt}}}return vt}class f_{constructor(pt){this.zoom=pt.zoom,this.overscaling=pt.overscaling,this.layers=pt.layers,this.layerIds=this.layers.map(vt=>vt.id),this.index=pt.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ul,this.indexArray=new Cl,this.indexArray2=new ps,this.programConfigurations=new Mp(pt.layers,pt.zoom),this.segments=new bo,this.segments2=new bo,this.stateDependentLayerIds=this.layers.filter(vt=>vt.isStateDependent()).map(vt=>vt.id)}populate(pt,vt,St){this.hasPattern=c_("fill",this.layers,vt);const Et=this.layers[0].layout.get("fill-sort-key"),Rt=!Et.isConstant(),Lt=[];for(const{feature:Nt,id:zt,index:jt,sourceLayerIndex:Wt}of pt){const qt=this.layers[0]._featureFilter.needGeometry,ir=Lp(Nt,qt);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),ir,St))continue;const or=Rt?Et.evaluate(ir,{},St,vt.availableImages):void 0,lr={id:zt,properties:Nt.properties,type:Nt.type,sourceLayerIndex:Wt,index:jt,geometry:qt?ir.geometry:Rp(Nt),patterns:{},sortKey:or};Lt.push(lr)}Rt&&Lt.sort((Nt,zt)=>Nt.sortKey-zt.sortKey);for(const Nt of Lt){const{geometry:zt,index:jt,sourceLayerIndex:Wt}=Nt;if(this.hasPattern){const qt=h_("fill",this.layers,Nt,this.zoom,vt);this.patternFeatures.push(qt)}else this.addFeature(Nt,zt,jt,St,{});vt.featureIndex.insert(pt[jt].feature,zt,jt,Wt,this.index)}}update(pt,vt,St){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(pt,vt,this.stateDependentLayers,St)}addFeatures(pt,vt,St){for(const Et of this.patternFeatures)this.addFeature(Et,Et.geometry,Et.index,vt,St)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(pt){this.uploaded||(this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,H1),this.indexBuffer=pt.createIndexBuffer(this.indexArray),this.indexBuffer2=pt.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(pt),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(pt,vt,St,Et,Rt){for(const Lt of zp(vt,500)){let Nt=0;for(const or of Lt)Nt+=or.length;const zt=this.segments.prepareSegment(Nt,this.layoutVertexArray,this.indexArray),jt=zt.vertexLength,Wt=[],qt=[];for(const or of Lt){if(or.length===0)continue;or!==Lt[0]&&qt.push(Wt.length/2);const lr=this.segments2.prepareSegment(or.length,this.layoutVertexArray,this.indexArray2),pr=lr.vertexLength;this.layoutVertexArray.emplaceBack(or[0].x,or[0].y),this.indexArray2.emplaceBack(pr+or.length-1,pr),Wt.push(or[0].x),Wt.push(or[0].y);for(let Tr=1;Tr<or.length;Tr++)this.layoutVertexArray.emplaceBack(or[Tr].x,or[Tr].y),this.indexArray2.emplaceBack(pr+Tr-1,pr+Tr),Wt.push(or[Tr].x),Wt.push(or[Tr].y);lr.vertexLength+=or.length,lr.primitiveLength+=or.length}const ir=s0(Wt,qt);for(let or=0;or<ir.length;or+=3)this.indexArray.emplaceBack(jt+ir[or],jt+ir[or+1],jt+ir[or+2]);zt.vertexLength+=Nt,zt.primitiveLength+=ir.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,pt,St,Rt,Et)}}let f0,d0;Nn("FillBucket",f_,{omit:["layers","patternFeatures"]});var tx={get paint(){return d0=d0||new Mt({"fill-antialias":new Vn(zr.paint_fill["fill-antialias"]),"fill-opacity":new _i(zr.paint_fill["fill-opacity"]),"fill-color":new _i(zr.paint_fill["fill-color"]),"fill-outline-color":new _i(zr.paint_fill["fill-outline-color"]),"fill-translate":new Vn(zr.paint_fill["fill-translate"]),"fill-translate-anchor":new Vn(zr.paint_fill["fill-translate-anchor"]),"fill-pattern":new om(zr.paint_fill["fill-pattern"])})},get layout(){return f0=f0||new Mt({"fill-sort-key":new _i(zr.layout_fill["fill-sort-key"])})}};class rx extends xt{constructor(pt){super(pt,tx)}recalculate(pt,vt){super.recalculate(pt,vt);const St=this.paint._values["fill-outline-color"];St.value.kind==="constant"&&St.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(pt){return new f_(pt)}queryRadius(){return my(this.paint.get("fill-translate"))}queryIntersectsFeature(pt,vt,St,Et,Rt,Lt,Nt){return Z_(vy(pt,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Lt.angle,Nt),Et)}isTileClipped(){return!0}}const nx=Bt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ix=Bt([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ax}=nx;var tp={},ox=ut,p0=vm;function vm(gt,pt,vt,St,Et){this.properties={},this.extent=vt,this.type=0,this._pbf=gt,this._geometry=-1,this._keys=St,this._values=Et,gt.readFields(sx,this,pt)}function sx(gt,pt,vt){gt==1?pt.id=vt.readVarint():gt==2?function(St,Et){for(var Rt=St.readVarint()+St.pos;St.pos<Rt;){var Lt=Et._keys[St.readVarint()],Nt=Et._values[St.readVarint()];Et.properties[Lt]=Nt}}(vt,pt):gt==3?pt.type=vt.readVarint():gt==4&&(pt._geometry=vt.pos)}function lx(gt){for(var pt,vt,St=0,Et=0,Rt=gt.length,Lt=Rt-1;Et<Rt;Lt=Et++)St+=((vt=gt[Lt]).x-(pt=gt[Et]).x)*(pt.y+vt.y);return St}vm.types=["Unknown","Point","LineString","Polygon"],vm.prototype.loadGeometry=function(){var gt=this._pbf;gt.pos=this._geometry;for(var pt,vt=gt.readVarint()+gt.pos,St=1,Et=0,Rt=0,Lt=0,Nt=[];gt.pos<vt;){if(Et<=0){var zt=gt.readVarint();St=7&zt,Et=zt>>3}if(Et--,St===1||St===2)Rt+=gt.readSVarint(),Lt+=gt.readSVarint(),St===1&&(pt&&Nt.push(pt),pt=[]),pt.push(new ox(Rt,Lt));else{if(St!==7)throw new Error("unknown command "+St);pt&&pt.push(pt[0].clone())}}return pt&&Nt.push(pt),Nt},vm.prototype.bbox=function(){var gt=this._pbf;gt.pos=this._geometry;for(var pt=gt.readVarint()+gt.pos,vt=1,St=0,Et=0,Rt=0,Lt=1/0,Nt=-1/0,zt=1/0,jt=-1/0;gt.pos<pt;){if(St<=0){var Wt=gt.readVarint();vt=7&Wt,St=Wt>>3}if(St--,vt===1||vt===2)(Et+=gt.readSVarint())<Lt&&(Lt=Et),Et>Nt&&(Nt=Et),(Rt+=gt.readSVarint())<zt&&(zt=Rt),Rt>jt&&(jt=Rt);else if(vt!==7)throw new Error("unknown command "+vt)}return[Lt,zt,Nt,jt]},vm.prototype.toGeoJSON=function(gt,pt,vt){var St,Et,Rt=this.extent*Math.pow(2,vt),Lt=this.extent*gt,Nt=this.extent*pt,zt=this.loadGeometry(),jt=vm.types[this.type];function Wt(or){for(var lr=0;lr<or.length;lr++){var pr=or[lr];or[lr]=[360*(pr.x+Lt)/Rt-180,360/Math.PI*Math.atan(Math.exp((180-360*(pr.y+Nt)/Rt)*Math.PI/180))-90]}}switch(this.type){case 1:var qt=[];for(St=0;St<zt.length;St++)qt[St]=zt[St][0];Wt(zt=qt);break;case 2:for(St=0;St<zt.length;St++)Wt(zt[St]);break;case 3:for(zt=function(or){var lr=or.length;if(lr<=1)return[or];for(var pr,Tr,Ir=[],Wr=0;Wr<lr;Wr++){var $r=lx(or[Wr]);$r!==0&&(Tr===void 0&&(Tr=$r<0),Tr===$r<0?(pr&&Ir.push(pr),pr=[or[Wr]]):pr.push(or[Wr]))}return pr&&Ir.push(pr),Ir}(zt),St=0;St<zt.length;St++)for(Et=0;Et<zt[St].length;Et++)Wt(zt[St][Et])}zt.length===1?zt=zt[0]:jt="Multi"+jt;var ir={type:"Feature",geometry:{type:jt,coordinates:zt},properties:this.properties};return"id"in this&&(ir.id=this.id),ir};var ux=p0,g0=m0;function m0(gt,pt){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=gt,this._keys=[],this._values=[],this._features=[],gt.readFields(cx,this,pt),this.length=this._features.length}function cx(gt,pt,vt){gt===15?pt.version=vt.readVarint():gt===1?pt.name=vt.readString():gt===5?pt.extent=vt.readVarint():gt===2?pt._features.push(vt.pos):gt===3?pt._keys.push(vt.readString()):gt===4&&pt._values.push(function(St){for(var Et=null,Rt=St.readVarint()+St.pos;St.pos<Rt;){var Lt=St.readVarint()>>3;Et=Lt===1?St.readString():Lt===2?St.readFloat():Lt===3?St.readDouble():Lt===4?St.readVarint64():Lt===5?St.readVarint():Lt===6?St.readSVarint():Lt===7?St.readBoolean():null}return Et}(vt))}m0.prototype.feature=function(gt){if(gt<0||gt>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[gt];var pt=this._pbf.readVarint()+this._pbf.pos;return new ux(this._pbf,pt,this.extent,this._keys,this._values)};var hx=g0;function fx(gt,pt,vt){if(gt===3){var St=new hx(vt,vt.readVarint()+vt.pos);St.length&&(pt[St.name]=St)}}tp.VectorTile=function(gt,pt){this.layers=gt.readFields(fx,{},pt)},tp.VectorTileFeature=p0,tp.VectorTileLayer=g0;const dx=tp.VectorTileFeature.types,d_=Math.pow(2,13);function yv(gt,pt,vt,St,Et,Rt,Lt,Nt){gt.emplaceBack(pt,vt,2*Math.floor(St*d_)+Lt,Et*d_*2,Rt*d_*2,Math.round(Nt))}class p_{constructor(pt){this.zoom=pt.zoom,this.overscaling=pt.overscaling,this.layers=pt.layers,this.layerIds=this.layers.map(vt=>vt.id),this.index=pt.index,this.hasPattern=!1,this.layoutVertexArray=new Zu,this.centroidVertexArray=new xs,this.indexArray=new Cl,this.programConfigurations=new Mp(pt.layers,pt.zoom),this.segments=new bo,this.stateDependentLayerIds=this.layers.filter(vt=>vt.isStateDependent()).map(vt=>vt.id)}populate(pt,vt,St){this.features=[],this.hasPattern=c_("fill-extrusion",this.layers,vt);for(const{feature:Et,id:Rt,index:Lt,sourceLayerIndex:Nt}of pt){const zt=this.layers[0]._featureFilter.needGeometry,jt=Lp(Et,zt);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),jt,St))continue;const Wt={id:Rt,sourceLayerIndex:Nt,index:Lt,geometry:zt?jt.geometry:Rp(Et),properties:Et.properties,type:Et.type,patterns:{}};this.hasPattern?this.features.push(h_("fill-extrusion",this.layers,Wt,this.zoom,vt)):this.addFeature(Wt,Wt.geometry,Lt,St,{}),vt.featureIndex.insert(Et,Wt.geometry,Lt,Nt,this.index,!0)}}addFeatures(pt,vt,St){for(const Et of this.features){const{geometry:Rt}=Et;this.addFeature(Et,Rt,Et.index,vt,St)}}update(pt,vt,St){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(pt,vt,this.stateDependentLayers,St)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(pt){this.uploaded||(this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,ax),this.centroidVertexBuffer=pt.createVertexBuffer(this.centroidVertexArray,ix.members,!0),this.indexBuffer=pt.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(pt),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(pt,vt,St,Et,Rt){for(const Lt of zp(vt,500)){const Nt={x:0,y:0,vertexCount:0};let zt=0;for(const lr of Lt)zt+=lr.length;let jt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const lr of Lt){if(lr.length===0||gx(lr))continue;let pr=0;for(let Tr=0;Tr<lr.length;Tr++){const Ir=lr[Tr];if(Tr>=1){const Wr=lr[Tr-1];if(!px(Ir,Wr)){jt.vertexLength+4>bo.MAX_VERTEX_ARRAY_LENGTH&&(jt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const $r=Ir.sub(Wr)._perp()._unit(),jr=Wr.dist(Ir);pr+jr>32768&&(pr=0),yv(this.layoutVertexArray,Ir.x,Ir.y,$r.x,$r.y,0,0,pr),yv(this.layoutVertexArray,Ir.x,Ir.y,$r.x,$r.y,0,1,pr),Nt.x+=2*Ir.x,Nt.y+=2*Ir.y,Nt.vertexCount+=2,pr+=jr,yv(this.layoutVertexArray,Wr.x,Wr.y,$r.x,$r.y,0,0,pr),yv(this.layoutVertexArray,Wr.x,Wr.y,$r.x,$r.y,0,1,pr),Nt.x+=2*Wr.x,Nt.y+=2*Wr.y,Nt.vertexCount+=2;const en=jt.vertexLength;this.indexArray.emplaceBack(en,en+2,en+1),this.indexArray.emplaceBack(en+1,en+2,en+3),jt.vertexLength+=4,jt.primitiveLength+=2}}}}if(jt.vertexLength+zt>bo.MAX_VERTEX_ARRAY_LENGTH&&(jt=this.segments.prepareSegment(zt,this.layoutVertexArray,this.indexArray)),dx[pt.type]!=="Polygon")continue;const Wt=[],qt=[],ir=jt.vertexLength;for(const lr of Lt)if(lr.length!==0){lr!==Lt[0]&&qt.push(Wt.length/2);for(let pr=0;pr<lr.length;pr++){const Tr=lr[pr];yv(this.layoutVertexArray,Tr.x,Tr.y,0,0,1,1,0),Nt.x+=Tr.x,Nt.y+=Tr.y,Nt.vertexCount+=1,Wt.push(Tr.x),Wt.push(Tr.y)}}const or=s0(Wt,qt);for(let lr=0;lr<or.length;lr+=3)this.indexArray.emplaceBack(ir+or[lr],ir+or[lr+2],ir+or[lr+1]);jt.primitiveLength+=or.length/3,jt.vertexLength+=zt;for(let lr=0;lr<Nt.vertexCount;lr++){const pr=Math.floor(Nt.x/Nt.vertexCount),Tr=Math.floor(Nt.y/Nt.vertexCount);this.centroidVertexArray.emplaceBack(pr,Tr)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,pt,St,Rt,Et)}}function px(gt,pt){return gt.x===pt.x&&(gt.x<0||gt.x>es)||gt.y===pt.y&&(gt.y<0||gt.y>es)}function gx(gt){return gt.every(pt=>pt.x<0)||gt.every(pt=>pt.x>es)||gt.every(pt=>pt.y<0)||gt.every(pt=>pt.y>es)}let v0;Nn("FillExtrusionBucket",p_,{omit:["layers","features"]});var mx={get paint(){return v0=v0||new Mt({"fill-extrusion-opacity":new Vn(zr["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _i(zr["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vn(zr["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vn(zr["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new om(zr["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _i(zr["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _i(zr["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Vn(zr["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class vx extends xt{constructor(pt){super(pt,mx)}createBucket(pt){return new p_(pt)}queryRadius(){return my(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=vy(pt,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Lt.angle,Nt),Wt=this.paint.get("fill-extrusion-height").evaluate(vt,St),qt=this.paint.get("fill-extrusion-base").evaluate(vt,St),ir=function(lr,pr,Tr,Ir){const Wr=[];for(const $r of lr){const jr=[$r.x,$r.y,0,1];yy(jr,jr,pr),Wr.push(new ot(jr[0]/jr[3],jr[1]/jr[3]))}return Wr}(jt,zt),or=function(lr,pr,Tr,Ir){const Wr=[],$r=[],jr=Ir[8]*pr,en=Ir[9]*pr,dn=Ir[10]*pr,Ln=Ir[11]*pr,Jn=Ir[8]*Tr,Pn=Ir[9]*Tr,En=Ir[10]*Tr,Hn=Ir[11]*Tr;for(const Fn of lr){const kn=[],on=[];for(const qn of Fn){const jn=qn.x,xa=qn.y,Lo=Ir[0]*jn+Ir[4]*xa+Ir[12],Po=Ir[1]*jn+Ir[5]*xa+Ir[13],as=Ir[2]*jn+Ir[6]*xa+Ir[14],Gl=Ir[3]*jn+Ir[7]*xa+Ir[15],Ts=as+dn,os=Gl+Ln,Ns=Lo+Jn,Fs=Po+Pn,Bs=as+En,Xo=Gl+Hn,ss=new ot((Lo+jr)/os,(Po+en)/os);ss.z=Ts/os,kn.push(ss);const Ds=new ot(Ns/Xo,Fs/Xo);Ds.z=Bs/Xo,on.push(Ds)}Wr.push(kn),$r.push(on)}return[Wr,$r]}(Et,qt,Wt,zt);return function(lr,pr,Tr){let Ir=1/0;Z_(Tr,pr)&&(Ir=y0(Tr,pr[0]));for(let Wr=0;Wr<pr.length;Wr++){const $r=pr[Wr],jr=lr[Wr];for(let en=0;en<$r.length-1;en++){const dn=$r[en],Ln=[dn,$r[en+1],jr[en+1],jr[en],dn];q_(Tr,Ln)&&(Ir=Math.min(Ir,y0(Tr,Ln)))}}return Ir!==1/0&&Ir}(or[0],or[1],ir)}}function bv(gt,pt){return gt.x*pt.x+gt.y*pt.y}function y0(gt,pt){if(gt.length===1){let vt=0;const St=pt[vt++];let Et;for(;!Et||St.equals(Et);)if(Et=pt[vt++],!Et)return 1/0;for(;vt<pt.length;vt++){const Rt=pt[vt],Lt=gt[0],Nt=Et.sub(St),zt=Rt.sub(St),jt=Lt.sub(St),Wt=bv(Nt,Nt),qt=bv(Nt,zt),ir=bv(zt,zt),or=bv(jt,Nt),lr=bv(jt,zt),pr=Wt*ir-qt*qt,Tr=(ir*or-qt*lr)/pr,Ir=(Wt*lr-qt*or)/pr,Wr=St.z*(1-Tr-Ir)+Et.z*Tr+Rt.z*Ir;if(isFinite(Wr))return Wr}return 1/0}{let vt=1/0;for(const St of pt)vt=Math.min(vt,St.z);return vt}}const yx=Bt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:bx}=yx,xx=Bt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Sx}=xx,Tx=tp.VectorTileFeature.types,Ax=Math.cos(Math.PI/180*37.5),_0=Math.pow(2,14)/.5;class g_{constructor(pt){this.zoom=pt.zoom,this.overscaling=pt.overscaling,this.layers=pt.layers,this.layerIds=this.layers.map(vt=>vt.id),this.index=pt.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(vt=>{this.gradients[vt.id]={}}),this.layoutVertexArray=new lm,this.layoutVertexArray2=new Xu,this.indexArray=new Cl,this.programConfigurations=new Mp(pt.layers,pt.zoom),this.segments=new bo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(vt=>vt.isStateDependent()).map(vt=>vt.id)}populate(pt,vt,St){this.hasPattern=c_("line",this.layers,vt);const Et=this.layers[0].layout.get("line-sort-key"),Rt=!Et.isConstant(),Lt=[];for(const{feature:Nt,id:zt,index:jt,sourceLayerIndex:Wt}of pt){const qt=this.layers[0]._featureFilter.needGeometry,ir=Lp(Nt,qt);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),ir,St))continue;const or=Rt?Et.evaluate(ir,{},St):void 0,lr={id:zt,properties:Nt.properties,type:Nt.type,sourceLayerIndex:Wt,index:jt,geometry:qt?ir.geometry:Rp(Nt),patterns:{},sortKey:or};Lt.push(lr)}Rt&&Lt.sort((Nt,zt)=>Nt.sortKey-zt.sortKey);for(const Nt of Lt){const{geometry:zt,index:jt,sourceLayerIndex:Wt}=Nt;if(this.hasPattern){const qt=h_("line",this.layers,Nt,this.zoom,vt);this.patternFeatures.push(qt)}else this.addFeature(Nt,zt,jt,St,{});vt.featureIndex.insert(pt[jt].feature,zt,jt,Wt,this.index)}}update(pt,vt,St){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(pt,vt,this.stateDependentLayers,St)}addFeatures(pt,vt,St){for(const Et of this.patternFeatures)this.addFeature(Et,Et.geometry,Et.index,vt,St)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(pt){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=pt.createVertexBuffer(this.layoutVertexArray2,Sx)),this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,bx),this.indexBuffer=pt.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(pt),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(pt){if(pt.properties&&Object.prototype.hasOwnProperty.call(pt.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(pt.properties,"mapbox_clip_end"))return{start:+pt.properties.mapbox_clip_start,end:+pt.properties.mapbox_clip_end}}addFeature(pt,vt,St,Et,Rt){const Lt=this.layers[0].layout,Nt=Lt.get("line-join").evaluate(pt,{}),zt=Lt.get("line-cap"),jt=Lt.get("line-miter-limit"),Wt=Lt.get("line-round-limit");this.lineClips=this.lineFeatureClips(pt);for(const qt of vt)this.addLine(qt,pt,Nt,zt,jt,Wt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,pt,St,Rt,Et)}addLine(pt,vt,St,Et,Rt,Lt){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ir=0;Ir<pt.length-1;Ir++)this.totalDistance+=pt[Ir].dist(pt[Ir+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const Nt=Tx[vt.type]==="Polygon";let zt=pt.length;for(;zt>=2&&pt[zt-1].equals(pt[zt-2]);)zt--;let jt=0;for(;jt<zt-1&&pt[jt].equals(pt[jt+1]);)jt++;if(zt<(Nt?3:2))return;St==="bevel"&&(Rt=1.05);const Wt=this.overscaling<=16?15*es/(512*this.overscaling):0,qt=this.segments.prepareSegment(10*zt,this.layoutVertexArray,this.indexArray);let ir,or,lr,pr,Tr;this.e1=this.e2=-1,Nt&&(ir=pt[zt-2],Tr=pt[jt].sub(ir)._unit()._perp());for(let Ir=jt;Ir<zt;Ir++){if(lr=Ir===zt-1?Nt?pt[jt+1]:void 0:pt[Ir+1],lr&&pt[Ir].equals(lr))continue;Tr&&(pr=Tr),ir&&(or=ir),ir=pt[Ir],Tr=lr?lr.sub(ir)._unit()._perp():pr,pr=pr||Tr;let Wr=pr.add(Tr);Wr.x===0&&Wr.y===0||Wr._unit();const $r=pr.x*Tr.x+pr.y*Tr.y,jr=Wr.x*Tr.x+Wr.y*Tr.y,en=jr!==0?1/jr:1/0,dn=2*Math.sqrt(2-2*jr),Ln=jr<Ax&&or&&lr,Jn=pr.x*Tr.y-pr.y*Tr.x>0;if(Ln&&Ir>jt){const Hn=ir.dist(or);if(Hn>2*Wt){const Fn=ir.sub(ir.sub(or)._mult(Wt/Hn)._round());this.updateDistance(or,Fn),this.addCurrentVertex(Fn,pr,0,0,qt),or=Fn}}const Pn=or&&lr;let En=Pn?St:Nt?"butt":Et;if(Pn&&En==="round"&&(en<Lt?En="miter":en<=2&&(En="fakeround")),En==="miter"&&en>Rt&&(En="bevel"),En==="bevel"&&(en>2&&(En="flipbevel"),en<Rt&&(En="miter")),or&&this.updateDistance(or,ir),En==="miter")Wr._mult(en),this.addCurrentVertex(ir,Wr,0,0,qt);else if(En==="flipbevel"){if(en>100)Wr=Tr.mult(-1);else{const Hn=en*pr.add(Tr).mag()/pr.sub(Tr).mag();Wr._perp()._mult(Hn*(Jn?-1:1))}this.addCurrentVertex(ir,Wr,0,0,qt),this.addCurrentVertex(ir,Wr.mult(-1),0,0,qt)}else if(En==="bevel"||En==="fakeround"){const Hn=-Math.sqrt(en*en-1),Fn=Jn?Hn:0,kn=Jn?0:Hn;if(or&&this.addCurrentVertex(ir,pr,Fn,kn,qt),En==="fakeround"){const on=Math.round(180*dn/Math.PI/20);for(let qn=1;qn<on;qn++){let jn=qn/on;if(jn!==.5){const Lo=jn-.5;jn+=jn*Lo*(jn-1)*((1.0904+$r*($r*(3.55645-1.43519*$r)-3.2452))*Lo*Lo+(.848013+$r*(.215638*$r-1.06021)))}const xa=Tr.sub(pr)._mult(jn)._add(pr)._unit()._mult(Jn?-1:1);this.addHalfVertex(ir,xa.x,xa.y,!1,Jn,0,qt)}}lr&&this.addCurrentVertex(ir,Tr,-Fn,-kn,qt)}else if(En==="butt")this.addCurrentVertex(ir,Wr,0,0,qt);else if(En==="square"){const Hn=or?1:-1;this.addCurrentVertex(ir,Wr,Hn,Hn,qt)}else En==="round"&&(or&&(this.addCurrentVertex(ir,pr,0,0,qt),this.addCurrentVertex(ir,pr,1,1,qt,!0)),lr&&(this.addCurrentVertex(ir,Tr,-1,-1,qt,!0),this.addCurrentVertex(ir,Tr,0,0,qt)));if(Ln&&Ir<zt-1){const Hn=ir.dist(lr);if(Hn>2*Wt){const Fn=ir.add(lr.sub(ir)._mult(Wt/Hn)._round());this.updateDistance(ir,Fn),this.addCurrentVertex(Fn,Tr,0,0,qt),ir=Fn}}}}addCurrentVertex(pt,vt,St,Et,Rt,Lt=!1){const Nt=vt.y*Et-vt.x,zt=-vt.y-vt.x*Et;this.addHalfVertex(pt,vt.x+vt.y*St,vt.y-vt.x*St,Lt,!1,St,Rt),this.addHalfVertex(pt,Nt,zt,Lt,!0,-Et,Rt),this.distance>_0/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(pt,vt,St,Et,Rt,Lt))}addHalfVertex({x:pt,y:vt},St,Et,Rt,Lt,Nt,zt){const jt=.5*(this.lineClips?this.scaledDistance*(_0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((pt<<1)+(Rt?1:0),(vt<<1)+(Lt?1:0),Math.round(63*St)+128,Math.round(63*Et)+128,1+(Nt===0?0:Nt<0?-1:1)|(63&jt)<<2,jt>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Wt=zt.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Wt),zt.primitiveLength++),Lt?this.e2=Wt:this.e1=Wt}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(pt,vt){this.distance+=pt.dist(vt),this.updateScaledDistance()}}let b0,x0;Nn("LineBucket",g_,{omit:["layers","patternFeatures"]});var w0={get paint(){return x0=x0||new Mt({"line-opacity":new _i(zr.paint_line["line-opacity"]),"line-color":new _i(zr.paint_line["line-color"]),"line-translate":new Vn(zr.paint_line["line-translate"]),"line-translate-anchor":new Vn(zr.paint_line["line-translate-anchor"]),"line-width":new _i(zr.paint_line["line-width"]),"line-gap-width":new _i(zr.paint_line["line-gap-width"]),"line-offset":new _i(zr.paint_line["line-offset"]),"line-blur":new _i(zr.paint_line["line-blur"]),"line-dasharray":new sm(zr.paint_line["line-dasharray"]),"line-pattern":new om(zr.paint_line["line-pattern"]),"line-gradient":new uv(zr.paint_line["line-gradient"])})},get layout(){return b0=b0||new Mt({"line-cap":new Vn(zr.layout_line["line-cap"]),"line-join":new _i(zr.layout_line["line-join"]),"line-miter-limit":new Vn(zr.layout_line["line-miter-limit"]),"line-round-limit":new Vn(zr.layout_line["line-round-limit"]),"line-sort-key":new _i(zr.layout_line["line-sort-key"])})}};class Ix extends _i{possiblyEvaluate(pt,vt){return vt=new No(Math.floor(vt.zoom),{now:vt.now,fadeDuration:vt.fadeDuration,zoomHistory:vt.zoomHistory,transition:vt.transition}),super.possiblyEvaluate(pt,vt)}evaluate(pt,vt,St,Et){return vt=$t({},vt,{zoom:Math.floor(vt.zoom)}),super.evaluate(pt,vt,St,Et)}}let wy;class Ex extends xt{constructor(pt){super(pt,w0),this.gradientVersion=0,wy||(wy=new Ix(w0.paint.properties["line-width"].specification),wy.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(pt){if(pt==="line-gradient"){const vt=this.gradientExpression();this.stepInterpolant=!!function(St){return St._styleExpression!==void 0}(vt)&&vt._styleExpression.expression instanceof so,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(pt,vt){super.recalculate(pt,vt),this.paint._values["line-floorwidth"]=wy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,pt)}createBucket(pt){return new g_(pt)}queryRadius(pt){const vt=pt,St=S0(fv("line-width",this,vt),fv("line-gap-width",this,vt)),Et=fv("line-offset",this,vt);return St/2+Math.abs(Et)+my(this.paint.get("line-translate"))}queryIntersectsFeature(pt,vt,St,Et,Rt,Lt,Nt){const zt=vy(pt,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Lt.angle,Nt),jt=Nt/2*S0(this.paint.get("line-width").evaluate(vt,St),this.paint.get("line-gap-width").evaluate(vt,St)),Wt=this.paint.get("line-offset").evaluate(vt,St);return Wt&&(Et=function(qt,ir){const or=[];for(let lr=0;lr<qt.length;lr++){const pr=qt[lr],Tr=[];for(let Ir=0;Ir<pr.length;Ir++){const Wr=pr[Ir-1],$r=pr[Ir],jr=pr[Ir+1],en=Ir===0?new ot(0,0):$r.sub(Wr)._unit()._perp(),dn=Ir===pr.length-1?new ot(0,0):jr.sub($r)._unit()._perp(),Ln=en._add(dn)._unit(),Jn=Ln.x*dn.x+Ln.y*dn.y;Jn!==0&&Ln._mult(1/Jn),Tr.push(Ln._mult(ir)._add($r))}or.push(Tr)}return or}(Et,Wt*Nt)),function(qt,ir,or){for(let lr=0;lr<ir.length;lr++){const pr=ir[lr];if(qt.length>=3){for(let Tr=0;Tr<pr.length;Tr++)if(pm(qt,pr[Tr]))return!0}if(O1(qt,pr,or))return!0}return!1}(zt,Et,jt)}isTileClipped(){return!0}}function S0(gt,pt){return pt>0?pt+2*gt:gt}const Cx=Bt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Dx=Bt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Bt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Px=Bt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Bt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const T0=Bt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Mx=Bt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Rx(gt,pt,vt){return gt.sections.forEach(St=>{St.text=function(Et,Rt,Lt){const Nt=Rt.layout.get("text-transform").evaluate(Lt,{});return Nt==="uppercase"?Et=Et.toLocaleUpperCase():Nt==="lowercase"&&(Et=Et.toLocaleLowerCase()),js.applyArabicShaping&&(Et=js.applyArabicShaping(Et)),Et}(St.text,pt,vt)}),gt}Bt([{name:"triangle",components:3,type:"Uint16"}]),Bt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Bt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Bt([{type:"Float32",name:"offsetX"}]),Bt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Bt([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const xv={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var rs=24,A0=Do,I0=function(gt,pt,vt,St,Et){var Rt,Lt,Nt=8*Et-St-1,zt=(1<<Nt)-1,jt=zt>>1,Wt=-7,qt=Et-1,ir=-1,or=gt[pt+qt];for(qt+=ir,Rt=or&(1<<-Wt)-1,or>>=-Wt,Wt+=Nt;Wt>0;Rt=256*Rt+gt[pt+qt],qt+=ir,Wt-=8);for(Lt=Rt&(1<<-Wt)-1,Rt>>=-Wt,Wt+=St;Wt>0;Lt=256*Lt+gt[pt+qt],qt+=ir,Wt-=8);if(Rt===0)Rt=1-jt;else{if(Rt===zt)return Lt?NaN:1/0*(or?-1:1);Lt+=Math.pow(2,St),Rt-=jt}return(or?-1:1)*Lt*Math.pow(2,Rt-St)},E0=function(gt,pt,vt,St,Et,Rt){var Lt,Nt,zt,jt=8*Rt-Et-1,Wt=(1<<jt)-1,qt=Wt>>1,ir=Et===23?Math.pow(2,-24)-Math.pow(2,-77):0,or=0,lr=1,pr=pt<0||pt===0&&1/pt<0?1:0;for(pt=Math.abs(pt),isNaN(pt)||pt===1/0?(Nt=isNaN(pt)?1:0,Lt=Wt):(Lt=Math.floor(Math.log(pt)/Math.LN2),pt*(zt=Math.pow(2,-Lt))<1&&(Lt--,zt*=2),(pt+=Lt+qt>=1?ir/zt:ir*Math.pow(2,1-qt))*zt>=2&&(Lt++,zt/=2),Lt+qt>=Wt?(Nt=0,Lt=Wt):Lt+qt>=1?(Nt=(pt*zt-1)*Math.pow(2,Et),Lt+=qt):(Nt=pt*Math.pow(2,qt-1)*Math.pow(2,Et),Lt=0));Et>=8;gt[vt+or]=255&Nt,or+=lr,Nt/=256,Et-=8);for(Lt=Lt<<Et|Nt,jt+=Et;jt>0;gt[vt+or]=255&Lt,or+=lr,Lt/=256,jt-=8);gt[vt+or-lr]|=128*pr};function Do(gt){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(gt)?gt:new Uint8Array(gt||0),this.pos=0,this.type=0,this.length=this.buf.length}Do.Varint=0,Do.Fixed64=1,Do.Bytes=2,Do.Fixed32=5;var m_=4294967296,C0=1/m_,D0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Du(gt){return gt.type===Do.Bytes?gt.readVarint()+gt.pos:gt.pos+1}function ym(gt,pt,vt){return vt?4294967296*pt+(gt>>>0):4294967296*(pt>>>0)+(gt>>>0)}function P0(gt,pt,vt){var St=pt<=16383?1:pt<=2097151?2:pt<=268435455?3:Math.floor(Math.log(pt)/(7*Math.LN2));vt.realloc(St);for(var Et=vt.pos-1;Et>=gt;Et--)vt.buf[Et+St]=vt.buf[Et]}function Lx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeVarint(gt[vt])}function Ox(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeSVarint(gt[vt])}function $x(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeFloat(gt[vt])}function kx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeDouble(gt[vt])}function Nx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeBoolean(gt[vt])}function Fx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeFixed32(gt[vt])}function Bx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeSFixed32(gt[vt])}function zx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeFixed64(gt[vt])}function Vx(gt,pt){for(var vt=0;vt<gt.length;vt++)pt.writeSFixed64(gt[vt])}function Sy(gt,pt){return(gt[pt]|gt[pt+1]<<8|gt[pt+2]<<16)+16777216*gt[pt+3]}function bm(gt,pt,vt){gt[vt]=pt,gt[vt+1]=pt>>>8,gt[vt+2]=pt>>>16,gt[vt+3]=pt>>>24}function M0(gt,pt){return(gt[pt]|gt[pt+1]<<8|gt[pt+2]<<16)+(gt[pt+3]<<24)}Do.prototype={destroy:function(){this.buf=null},readFields:function(gt,pt,vt){for(vt=vt||this.length;this.pos<vt;){var St=this.readVarint(),Et=St>>3,Rt=this.pos;this.type=7&St,gt(Et,pt,this),this.pos===Rt&&this.skip(St)}return pt},readMessage:function(gt,pt){return this.readFields(gt,pt,this.readVarint()+this.pos)},readFixed32:function(){var gt=Sy(this.buf,this.pos);return this.pos+=4,gt},readSFixed32:function(){var gt=M0(this.buf,this.pos);return this.pos+=4,gt},readFixed64:function(){var gt=Sy(this.buf,this.pos)+Sy(this.buf,this.pos+4)*m_;return this.pos+=8,gt},readSFixed64:function(){var gt=Sy(this.buf,this.pos)+M0(this.buf,this.pos+4)*m_;return this.pos+=8,gt},readFloat:function(){var gt=I0(this.buf,this.pos,!0,23,4);return this.pos+=4,gt},readDouble:function(){var gt=I0(this.buf,this.pos,!0,52,8);return this.pos+=8,gt},readVarint:function(gt){var pt,vt,St=this.buf;return pt=127&(vt=St[this.pos++]),vt<128?pt:(pt|=(127&(vt=St[this.pos++]))<<7,vt<128?pt:(pt|=(127&(vt=St[this.pos++]))<<14,vt<128?pt:(pt|=(127&(vt=St[this.pos++]))<<21,vt<128?pt:function(Et,Rt,Lt){var Nt,zt,jt=Lt.buf;if(Nt=(112&(zt=jt[Lt.pos++]))>>4,zt<128||(Nt|=(127&(zt=jt[Lt.pos++]))<<3,zt<128)||(Nt|=(127&(zt=jt[Lt.pos++]))<<10,zt<128)||(Nt|=(127&(zt=jt[Lt.pos++]))<<17,zt<128)||(Nt|=(127&(zt=jt[Lt.pos++]))<<24,zt<128)||(Nt|=(1&(zt=jt[Lt.pos++]))<<31,zt<128))return ym(Et,Nt,Rt);throw new Error("Expected varint not more than 10 bytes")}(pt|=(15&(vt=St[this.pos]))<<28,gt,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var gt=this.readVarint();return gt%2==1?(gt+1)/-2:gt/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var gt=this.readVarint()+this.pos,pt=this.pos;return this.pos=gt,gt-pt>=12&&D0?function(vt,St,Et){return D0.decode(vt.subarray(St,Et))}(this.buf,pt,gt):function(vt,St,Et){for(var Rt="",Lt=St;Lt<Et;){var Nt,zt,jt,Wt=vt[Lt],qt=null,ir=Wt>239?4:Wt>223?3:Wt>191?2:1;if(Lt+ir>Et)break;ir===1?Wt<128&&(qt=Wt):ir===2?(192&(Nt=vt[Lt+1]))==128&&(qt=(31&Wt)<<6|63&Nt)<=127&&(qt=null):ir===3?(zt=vt[Lt+2],(192&(Nt=vt[Lt+1]))==128&&(192&zt)==128&&((qt=(15&Wt)<<12|(63&Nt)<<6|63&zt)<=2047||qt>=55296&&qt<=57343)&&(qt=null)):ir===4&&(zt=vt[Lt+2],jt=vt[Lt+3],(192&(Nt=vt[Lt+1]))==128&&(192&zt)==128&&(192&jt)==128&&((qt=(15&Wt)<<18|(63&Nt)<<12|(63&zt)<<6|63&jt)<=65535||qt>=1114112)&&(qt=null)),qt===null?(qt=65533,ir=1):qt>65535&&(qt-=65536,Rt+=String.fromCharCode(qt>>>10&1023|55296),qt=56320|1023&qt),Rt+=String.fromCharCode(qt),Lt+=ir}return Rt}(this.buf,pt,gt)},readBytes:function(){var gt=this.readVarint()+this.pos,pt=this.buf.subarray(this.pos,gt);return this.pos=gt,pt},readPackedVarint:function(gt,pt){if(this.type!==Do.Bytes)return gt.push(this.readVarint(pt));var vt=Du(this);for(gt=gt||[];this.pos<vt;)gt.push(this.readVarint(pt));return gt},readPackedSVarint:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readSVarint());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readSVarint());return gt},readPackedBoolean:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readBoolean());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readBoolean());return gt},readPackedFloat:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readFloat());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readFloat());return gt},readPackedDouble:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readDouble());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readDouble());return gt},readPackedFixed32:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readFixed32());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readFixed32());return gt},readPackedSFixed32:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readSFixed32());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readSFixed32());return gt},readPackedFixed64:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readFixed64());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readFixed64());return gt},readPackedSFixed64:function(gt){if(this.type!==Do.Bytes)return gt.push(this.readSFixed64());var pt=Du(this);for(gt=gt||[];this.pos<pt;)gt.push(this.readSFixed64());return gt},skip:function(gt){var pt=7&gt;if(pt===Do.Varint)for(;this.buf[this.pos++]>127;);else if(pt===Do.Bytes)this.pos=this.readVarint()+this.pos;else if(pt===Do.Fixed32)this.pos+=4;else{if(pt!==Do.Fixed64)throw new Error("Unimplemented type: "+pt);this.pos+=8}},writeTag:function(gt,pt){this.writeVarint(gt<<3|pt)},realloc:function(gt){for(var pt=this.length||16;pt<this.pos+gt;)pt*=2;if(pt!==this.length){var vt=new Uint8Array(pt);vt.set(this.buf),this.buf=vt,this.length=pt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(gt){this.realloc(4),bm(this.buf,gt,this.pos),this.pos+=4},writeSFixed32:function(gt){this.realloc(4),bm(this.buf,gt,this.pos),this.pos+=4},writeFixed64:function(gt){this.realloc(8),bm(this.buf,-1&gt,this.pos),bm(this.buf,Math.floor(gt*C0),this.pos+4),this.pos+=8},writeSFixed64:function(gt){this.realloc(8),bm(this.buf,-1&gt,this.pos),bm(this.buf,Math.floor(gt*C0),this.pos+4),this.pos+=8},writeVarint:function(gt){(gt=+gt||0)>268435455||gt<0?function(pt,vt){var St,Et;if(pt>=0?(St=pt%4294967296|0,Et=pt/4294967296|0):(Et=~(-pt/4294967296),4294967295^(St=~(-pt%4294967296))?St=St+1|0:(St=0,Et=Et+1|0)),pt>=18446744073709552e3||pt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");vt.realloc(10),function(Rt,Lt,Nt){Nt.buf[Nt.pos++]=127&Rt|128,Rt>>>=7,Nt.buf[Nt.pos++]=127&Rt|128,Rt>>>=7,Nt.buf[Nt.pos++]=127&Rt|128,Rt>>>=7,Nt.buf[Nt.pos++]=127&Rt|128,Nt.buf[Nt.pos]=127&(Rt>>>=7)}(St,0,vt),function(Rt,Lt){var Nt=(7&Rt)<<4;Lt.buf[Lt.pos++]|=Nt|((Rt>>>=3)?128:0),Rt&&(Lt.buf[Lt.pos++]=127&Rt|((Rt>>>=7)?128:0),Rt&&(Lt.buf[Lt.pos++]=127&Rt|((Rt>>>=7)?128:0),Rt&&(Lt.buf[Lt.pos++]=127&Rt|((Rt>>>=7)?128:0),Rt&&(Lt.buf[Lt.pos++]=127&Rt|((Rt>>>=7)?128:0),Rt&&(Lt.buf[Lt.pos++]=127&Rt)))))}(Et,vt)}(gt,this):(this.realloc(4),this.buf[this.pos++]=127&gt|(gt>127?128:0),gt<=127||(this.buf[this.pos++]=127&(gt>>>=7)|(gt>127?128:0),gt<=127||(this.buf[this.pos++]=127&(gt>>>=7)|(gt>127?128:0),gt<=127||(this.buf[this.pos++]=gt>>>7&127))))},writeSVarint:function(gt){this.writeVarint(gt<0?2*-gt-1:2*gt)},writeBoolean:function(gt){this.writeVarint(!!gt)},writeString:function(gt){gt=String(gt),this.realloc(4*gt.length),this.pos++;var pt=this.pos;this.pos=function(St,Et,Rt){for(var Lt,Nt,zt=0;zt<Et.length;zt++){if((Lt=Et.charCodeAt(zt))>55295&&Lt<57344){if(!Nt){Lt>56319||zt+1===Et.length?(St[Rt++]=239,St[Rt++]=191,St[Rt++]=189):Nt=Lt;continue}if(Lt<56320){St[Rt++]=239,St[Rt++]=191,St[Rt++]=189,Nt=Lt;continue}Lt=Nt-55296<<10|Lt-56320|65536,Nt=null}else Nt&&(St[Rt++]=239,St[Rt++]=191,St[Rt++]=189,Nt=null);Lt<128?St[Rt++]=Lt:(Lt<2048?St[Rt++]=Lt>>6|192:(Lt<65536?St[Rt++]=Lt>>12|224:(St[Rt++]=Lt>>18|240,St[Rt++]=Lt>>12&63|128),St[Rt++]=Lt>>6&63|128),St[Rt++]=63&Lt|128)}return Rt}(this.buf,gt,this.pos);var vt=this.pos-pt;vt>=128&&P0(pt,vt,this),this.pos=pt-1,this.writeVarint(vt),this.pos+=vt},writeFloat:function(gt){this.realloc(4),E0(this.buf,gt,this.pos,!0,23,4),this.pos+=4},writeDouble:function(gt){this.realloc(8),E0(this.buf,gt,this.pos,!0,52,8),this.pos+=8},writeBytes:function(gt){var pt=gt.length;this.writeVarint(pt),this.realloc(pt);for(var vt=0;vt<pt;vt++)this.buf[this.pos++]=gt[vt]},writeRawMessage:function(gt,pt){this.pos++;var vt=this.pos;gt(pt,this);var St=this.pos-vt;St>=128&&P0(vt,St,this),this.pos=vt-1,this.writeVarint(St),this.pos+=St},writeMessage:function(gt,pt,vt){this.writeTag(gt,Do.Bytes),this.writeRawMessage(pt,vt)},writePackedVarint:function(gt,pt){pt.length&&this.writeMessage(gt,Lx,pt)},writePackedSVarint:function(gt,pt){pt.length&&this.writeMessage(gt,Ox,pt)},writePackedBoolean:function(gt,pt){pt.length&&this.writeMessage(gt,Nx,pt)},writePackedFloat:function(gt,pt){pt.length&&this.writeMessage(gt,$x,pt)},writePackedDouble:function(gt,pt){pt.length&&this.writeMessage(gt,kx,pt)},writePackedFixed32:function(gt,pt){pt.length&&this.writeMessage(gt,Fx,pt)},writePackedSFixed32:function(gt,pt){pt.length&&this.writeMessage(gt,Bx,pt)},writePackedFixed64:function(gt,pt){pt.length&&this.writeMessage(gt,zx,pt)},writePackedSFixed64:function(gt,pt){pt.length&&this.writeMessage(gt,Vx,pt)},writeBytesField:function(gt,pt){this.writeTag(gt,Do.Bytes),this.writeBytes(pt)},writeFixed32Field:function(gt,pt){this.writeTag(gt,Do.Fixed32),this.writeFixed32(pt)},writeSFixed32Field:function(gt,pt){this.writeTag(gt,Do.Fixed32),this.writeSFixed32(pt)},writeFixed64Field:function(gt,pt){this.writeTag(gt,Do.Fixed64),this.writeFixed64(pt)},writeSFixed64Field:function(gt,pt){this.writeTag(gt,Do.Fixed64),this.writeSFixed64(pt)},writeVarintField:function(gt,pt){this.writeTag(gt,Do.Varint),this.writeVarint(pt)},writeSVarintField:function(gt,pt){this.writeTag(gt,Do.Varint),this.writeSVarint(pt)},writeStringField:function(gt,pt){this.writeTag(gt,Do.Bytes),this.writeString(pt)},writeFloatField:function(gt,pt){this.writeTag(gt,Do.Fixed32),this.writeFloat(pt)},writeDoubleField:function(gt,pt){this.writeTag(gt,Do.Fixed64),this.writeDouble(pt)},writeBooleanField:function(gt,pt){this.writeVarintField(gt,!!pt)}};var v_=st(A0);const y_=3;function Ux(gt,pt,vt){gt===1&&vt.readMessage(Gx,pt)}function Gx(gt,pt,vt){if(gt===3){const{id:St,bitmap:Et,width:Rt,height:Lt,left:Nt,top:zt,advance:jt}=vt.readMessage(jx,{});pt.push({id:St,bitmap:new pv({width:Rt+2*y_,height:Lt+2*y_},Et),metrics:{width:Rt,height:Lt,left:Nt,top:zt,advance:jt}})}}function jx(gt,pt,vt){gt===1?pt.id=vt.readVarint():gt===2?pt.bitmap=vt.readBytes():gt===3?pt.width=vt.readVarint():gt===4?pt.height=vt.readVarint():gt===5?pt.left=vt.readSVarint():gt===6?pt.top=vt.readSVarint():gt===7&&(pt.advance=vt.readVarint())}const R0=y_;function L0(gt){let pt=0,vt=0;for(const Lt of gt)pt+=Lt.w*Lt.h,vt=Math.max(vt,Lt.w);gt.sort((Lt,Nt)=>Nt.h-Lt.h);const St=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(pt/.95)),vt),h:1/0}];let Et=0,Rt=0;for(const Lt of gt)for(let Nt=St.length-1;Nt>=0;Nt--){const zt=St[Nt];if(!(Lt.w>zt.w||Lt.h>zt.h)){if(Lt.x=zt.x,Lt.y=zt.y,Rt=Math.max(Rt,Lt.y+Lt.h),Et=Math.max(Et,Lt.x+Lt.w),Lt.w===zt.w&&Lt.h===zt.h){const jt=St.pop();Nt<St.length&&(St[Nt]=jt)}else Lt.h===zt.h?(zt.x+=Lt.w,zt.w-=Lt.w):Lt.w===zt.w?(zt.y+=Lt.h,zt.h-=Lt.h):(St.push({x:zt.x+Lt.w,y:zt.y,w:zt.w-Lt.w,h:Lt.h}),zt.y+=Lt.h,zt.h-=Lt.h);break}}return{w:Et,h:Rt,fill:pt/(Et*Rt)||0}}const Ws=1;class __{constructor(pt,{pixelRatio:vt,version:St,stretchX:Et,stretchY:Rt,content:Lt,textFitWidth:Nt,textFitHeight:zt}){this.paddedRect=pt,this.pixelRatio=vt,this.stretchX=Et,this.stretchY=Rt,this.content=Lt,this.version=St,this.textFitWidth=Nt,this.textFitHeight=zt}get tl(){return[this.paddedRect.x+Ws,this.paddedRect.y+Ws]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ws,this.paddedRect.y+this.paddedRect.h-Ws]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ws)/this.pixelRatio,(this.paddedRect.h-2*Ws)/this.pixelRatio]}}class O0{constructor(pt,vt){const St={},Et={};this.haveRenderCallbacks=[];const Rt=[];this.addImages(pt,St,Rt),this.addImages(vt,Et,Rt);const{w:Lt,h:Nt}=L0(Rt),zt=new Dl({width:Lt||1,height:Nt||1});for(const jt in pt){const Wt=pt[jt],qt=St[jt].paddedRect;Dl.copy(Wt.data,zt,{x:0,y:0},{x:qt.x+Ws,y:qt.y+Ws},Wt.data)}for(const jt in vt){const Wt=vt[jt],qt=Et[jt].paddedRect,ir=qt.x+Ws,or=qt.y+Ws,lr=Wt.data.width,pr=Wt.data.height;Dl.copy(Wt.data,zt,{x:0,y:0},{x:ir,y:or},Wt.data),Dl.copy(Wt.data,zt,{x:0,y:pr-1},{x:ir,y:or-1},{width:lr,height:1}),Dl.copy(Wt.data,zt,{x:0,y:0},{x:ir,y:or+pr},{width:lr,height:1}),Dl.copy(Wt.data,zt,{x:lr-1,y:0},{x:ir-1,y:or},{width:1,height:pr}),Dl.copy(Wt.data,zt,{x:0,y:0},{x:ir+lr,y:or},{width:1,height:pr})}this.image=zt,this.iconPositions=St,this.patternPositions=Et}addImages(pt,vt,St){for(const Et in pt){const Rt=pt[Et],Lt={x:0,y:0,w:Rt.data.width+2*Ws,h:Rt.data.height+2*Ws};St.push(Lt),vt[Et]=new __(Lt,Rt),Rt.hasRenderCallback&&this.haveRenderCallbacks.push(Et)}}patchUpdatedImages(pt,vt){pt.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const St in pt.updatedImages)this.patchUpdatedImage(this.iconPositions[St],pt.getImage(St),vt),this.patchUpdatedImage(this.patternPositions[St],pt.getImage(St),vt)}patchUpdatedImage(pt,vt,St){if(!pt||!vt||pt.version===vt.version)return;pt.version=vt.version;const[Et,Rt]=pt.tl;St.update(vt.data,void 0,{x:Et,y:Rt})}}var rp;Nn("ImagePosition",__),Nn("ImageAtlas",O0),nt.ah=void 0,(rp=nt.ah||(nt.ah={}))[rp.none=0]="none",rp[rp.horizontal=1]="horizontal",rp[rp.vertical=2]="vertical",rp[rp.horizontalOnly=3]="horizontalOnly";const wv=-17;class Sv{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(pt,vt){const St=new Sv;return St.scale=pt||1,St.fontStack=vt,St}static forImage(pt){const vt=new Sv;return vt.imageName=pt,vt}}class xm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(pt,vt){const St=new xm;for(let Et=0;Et<pt.sections.length;Et++){const Rt=pt.sections[Et];Rt.image?St.addImageSection(Rt):St.addTextSection(Rt,vt)}return St}length(){return this.text.length}getSection(pt){return this.sections[this.sectionIndex[pt]]}getSectionIndex(pt){return this.sectionIndex[pt]}getCharCode(pt){return this.text.charCodeAt(pt)}verticalizePunctuation(){this.text=function(pt){let vt="";for(let St=0;St<pt.length;St++){const Et=pt.charCodeAt(St+1)||null,Rt=pt.charCodeAt(St-1)||null;vt+=Et&&uy(Et)&&!xv[pt[St+1]]||Rt&&uy(Rt)&&!xv[pt[St-1]]||!xv[pt[St]]?pt[St]:xv[pt[St]]}return vt}(this.text)}trim(){let pt=0;for(let St=0;St<this.text.length&&Ay[this.text.charCodeAt(St)];St++)pt++;let vt=this.text.length;for(let St=this.text.length-1;St>=0&&St>=pt&&Ay[this.text.charCodeAt(St)];St--)vt--;this.text=this.text.substring(pt,vt),this.sectionIndex=this.sectionIndex.slice(pt,vt)}substring(pt,vt){const St=new xm;return St.text=this.text.substring(pt,vt),St.sectionIndex=this.sectionIndex.slice(pt,vt),St.sections=this.sections,St}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((pt,vt)=>Math.max(pt,this.sections[vt].scale),0)}addTextSection(pt,vt){this.text+=pt.text,this.sections.push(Sv.forText(pt.scale,pt.fontStack||vt));const St=this.sections.length-1;for(let Et=0;Et<pt.text.length;++Et)this.sectionIndex.push(St)}addImageSection(pt){const vt=pt.image?pt.image.name:"";if(vt.length===0)return void Xt("Can't add FormattedSection with an empty image.");const St=this.getNextImageSectionCharCode();St?(this.text+=String.fromCharCode(St),this.sections.push(Sv.forImage(vt)),this.sectionIndex.push(this.sections.length-1)):Xt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ty(gt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr){const pr=xm.fromFeature(gt,Et);let Tr;qt===nt.ah.vertical&&pr.verticalizePunctuation();const{processBidirectionalText:Ir,processStyledBidirectionalText:Wr}=js;if(Ir&&pr.sections.length===1){Tr=[];const en=Ir(pr.toString(),b_(pr,jt,Rt,pt,St,or));for(const dn of en){const Ln=new xm;Ln.text=dn,Ln.sections=pr.sections;for(let Jn=0;Jn<dn.length;Jn++)Ln.sectionIndex.push(0);Tr.push(Ln)}}else if(Wr){Tr=[];const en=Wr(pr.text,pr.sectionIndex,b_(pr,jt,Rt,pt,St,or));for(const dn of en){const Ln=new xm;Ln.text=dn[0],Ln.sectionIndex=dn[1],Ln.sections=pr.sections,Tr.push(Ln)}}else Tr=function(en,dn){const Ln=[],Jn=en.text;let Pn=0;for(const En of dn)Ln.push(en.substring(Pn,En)),Pn=En;return Pn<Jn.length&&Ln.push(en.substring(Pn,Jn.length)),Ln}(pr,b_(pr,jt,Rt,pt,St,or));const $r=[],jr={positionedLines:$r,text:pr.toString(),top:Wt[1],bottom:Wt[1],left:Wt[0],right:Wt[0],writingMode:qt,iconsInText:!1,verticalizable:!1};return function(en,dn,Ln,Jn,Pn,En,Hn,Fn,kn,on,qn,jn){let xa=0,Lo=wv,Po=0,as=0;const Gl=Fn==="right"?1:Fn==="left"?0:.5;let Ts=0;for(const Xo of Pn){Xo.trim();const ss=Xo.getMaxScale(),Ds=(ss-1)*rs,As={positionedGlyphs:[],lineOffset:0};en.positionedLines[Ts]=As;const zs=As.positionedGlyphs;let Is=0;if(!Xo.length()){Lo+=En,++Ts;continue}for(let Ys=0;Ys<Xo.length();Ys++){const Io=Xo.getSection(Ys),$o=Xo.getSectionIndex(Ys),Vo=Xo.getCharCode(Ys);let xl=0,Ho=null,Am=null,au=null,ou=rs;const Hl=!(kn===nt.ah.horizontal||!qn&&!sv(Vo)||qn&&(Ay[Vo]||(os=Vo,/\p{sc=Arab}/u.test(String.fromCodePoint(os)))));if(Io.imageName){const Rl=Jn[Io.imageName];if(!Rl)continue;au=Io.imageName,en.iconsInText=en.iconsInText||!0,Am=Rl.paddedRect;const gs=Rl.displaySize;Io.scale=Io.scale*rs/jn,Ho={width:gs[0],height:gs[1],left:Ws,top:-R0,advance:Hl?gs[1]:gs[0]},xl=Ds+(rs-gs[1]*Io.scale),ou=Ho.advance;const Pu=Hl?gs[0]*Io.scale-rs*ss:gs[1]*Io.scale-rs*ss;Pu>0&&Pu>Is&&(Is=Pu)}else{const Rl=Ln[Io.fontStack],gs=Rl&&Rl[Vo];if(gs&&gs.rect)Am=gs.rect,Ho=gs.metrics;else{const Pu=dn[Io.fontStack],Dv=Pu&&Pu[Vo];if(!Dv)continue;Ho=Dv.metrics}xl=(ss-Io.scale)*rs}Hl?(en.verticalizable=!0,zs.push({glyph:Vo,imageName:au,x:xa,y:Lo+xl,vertical:Hl,scale:Io.scale,fontStack:Io.fontStack,sectionIndex:$o,metrics:Ho,rect:Am}),xa+=ou*Io.scale+on):(zs.push({glyph:Vo,imageName:au,x:xa,y:Lo+xl,vertical:Hl,scale:Io.scale,fontStack:Io.fontStack,sectionIndex:$o,metrics:Ho,rect:Am}),xa+=Ho.advance*Io.scale+on)}zs.length!==0&&(Po=Math.max(xa-on,Po),qx(zs,0,zs.length-1,Gl,Is)),xa=0;const Ml=En*ss+Is;As.lineOffset=Math.max(Is,Ds),Lo+=Ml,as=Math.max(Ml,as),++Ts}var os;const Ns=Lo-wv,{horizontalAlign:Fs,verticalAlign:Bs}=x_(Hn);(function(Xo,ss,Ds,As,zs,Is,Ml,Ys,Io){const $o=(ss-Ds)*zs;let Vo=0;Vo=Is!==Ml?-Ys*As-wv:(-As*Io+.5)*Ml;for(const xl of Xo)for(const Ho of xl.positionedGlyphs)Ho.x+=$o,Ho.y+=Vo})(en.positionedLines,Gl,Fs,Bs,Po,as,En,Ns,Pn.length),en.top+=-Bs*Ns,en.bottom=en.top+Ns,en.left+=-Fs*Po,en.right=en.left+Po}(jr,pt,vt,St,Tr,Lt,Nt,zt,qt,jt,ir,lr),!function(en){for(const dn of en)if(dn.positionedGlyphs.length!==0)return!1;return!0}($r)&&jr}const Ay={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hx={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Wx={40:!0};function $0(gt,pt,vt,St,Et,Rt){if(pt.imageName){const Lt=St[pt.imageName];return Lt?Lt.displaySize[0]*pt.scale*rs/Rt+Et:0}{const Lt=vt[pt.fontStack],Nt=Lt&&Lt[gt];return Nt?Nt.metrics.advance*pt.scale+Et:0}}function k0(gt,pt,vt,St){const Et=Math.pow(gt-pt,2);return St?gt<pt?Et/2:2*Et:Et+Math.abs(vt)*vt}function Yx(gt,pt,vt){let St=0;return gt===10&&(St-=1e4),vt&&(St+=150),gt!==40&&gt!==65288||(St+=50),pt!==41&&pt!==65289||(St+=50),St}function N0(gt,pt,vt,St,Et,Rt){let Lt=null,Nt=k0(pt,vt,Et,Rt);for(const zt of St){const jt=k0(pt-zt.x,vt,Et,Rt)+zt.badness;jt<=Nt&&(Lt=zt,Nt=jt)}return{index:gt,x:pt,priorBreak:Lt,badness:Nt}}function F0(gt){return gt?F0(gt.priorBreak).concat(gt.index):[]}function b_(gt,pt,vt,St,Et,Rt){if(!gt)return[];const Lt=[],Nt=function(qt,ir,or,lr,pr,Tr){let Ir=0;for(let Wr=0;Wr<qt.length();Wr++){const $r=qt.getSection(Wr);Ir+=$0(qt.getCharCode(Wr),$r,lr,pr,ir,Tr)}return Ir/Math.max(1,Math.ceil(Ir/or))}(gt,pt,vt,St,Et,Rt),zt=gt.text.indexOf("​")>=0;let jt=0;for(let qt=0;qt<gt.length();qt++){const ir=gt.getSection(qt),or=gt.getCharCode(qt);if(Ay[or]||(jt+=$0(or,ir,St,Et,pt,Rt)),qt<gt.length()-1){const lr=!((Wt=or)<11904)&&(!!yo["CJK Compatibility Forms"](Wt)||!!yo["CJK Compatibility"](Wt)||!!yo["CJK Strokes"](Wt)||!!yo["CJK Symbols and Punctuation"](Wt)||!!yo["Enclosed CJK Letters and Months"](Wt)||!!yo["Halfwidth and Fullwidth Forms"](Wt)||!!yo["Ideographic Description Characters"](Wt)||!!yo["Vertical Forms"](Wt)||ly.test(String.fromCodePoint(Wt)));(Hx[or]||lr||ir.imageName||qt!==gt.length()-2&&Wx[gt.getCharCode(qt+1)])&&Lt.push(N0(qt+1,jt,Nt,Lt,Yx(or,gt.getCharCode(qt+1),lr&&zt),!1))}}var Wt;return F0(N0(gt.length(),jt,Nt,Lt,0,!0))}function x_(gt){let pt=.5,vt=.5;switch(gt){case"right":case"top-right":case"bottom-right":pt=1;break;case"left":case"top-left":case"bottom-left":pt=0}switch(gt){case"bottom":case"bottom-right":case"bottom-left":vt=1;break;case"top":case"top-right":case"top-left":vt=0}return{horizontalAlign:pt,verticalAlign:vt}}function qx(gt,pt,vt,St,Et){if(!St&&!Et)return;const Rt=gt[vt],Lt=(gt[vt].x+Rt.metrics.advance*Rt.scale)*St;for(let Nt=pt;Nt<=vt;Nt++)gt[Nt].x-=Lt,gt[Nt].y+=Et}function Zx(gt,pt,vt){const{horizontalAlign:St,verticalAlign:Et}=x_(vt),Rt=pt[0]-gt.displaySize[0]*St,Lt=pt[1]-gt.displaySize[1]*Et;return{image:gt,top:Lt,bottom:Lt+gt.displaySize[1],left:Rt,right:Rt+gt.displaySize[0]}}function B0(gt){var pt,vt;let St=gt.left,Et=gt.top,Rt=gt.right-St,Lt=gt.bottom-Et;const Nt=(pt=gt.image.textFitWidth)!==null&&pt!==void 0?pt:"stretchOrShrink",zt=(vt=gt.image.textFitHeight)!==null&&vt!==void 0?vt:"stretchOrShrink",jt=(gt.image.content[2]-gt.image.content[0])/(gt.image.content[3]-gt.image.content[1]);if(zt==="proportional"){if(Nt==="stretchOnly"&&Rt/Lt<jt||Nt==="proportional"){const Wt=Math.ceil(Lt*jt);St*=Wt/Rt,Rt=Wt}}else if(Nt==="proportional"&&zt==="stretchOnly"&&jt!==0&&Rt/Lt>jt){const Wt=Math.ceil(Rt/jt);Et*=Wt/Lt,Lt=Wt}return{x1:St,y1:Et,x2:St+Rt,y2:Et+Lt}}function z0(gt,pt,vt,St,Et,Rt){const Lt=gt.image;let Nt;if(Lt.content){const Tr=Lt.content,Ir=Lt.pixelRatio||1;Nt=[Tr[0]/Ir,Tr[1]/Ir,Lt.displaySize[0]-Tr[2]/Ir,Lt.displaySize[1]-Tr[3]/Ir]}const zt=pt.left*Rt,jt=pt.right*Rt;let Wt,qt,ir,or;vt==="width"||vt==="both"?(or=Et[0]+zt-St[3],qt=Et[0]+jt+St[1]):(or=Et[0]+(zt+jt-Lt.displaySize[0])/2,qt=or+Lt.displaySize[0]);const lr=pt.top*Rt,pr=pt.bottom*Rt;return vt==="height"||vt==="both"?(Wt=Et[1]+lr-St[0],ir=Et[1]+pr+St[2]):(Wt=Et[1]+(lr+pr-Lt.displaySize[1])/2,ir=Wt+Lt.displaySize[1]),{image:Lt,top:Wt,right:qt,bottom:ir,left:or,collisionPadding:Nt}}const Tv=255,iu=128,np=Tv*iu;function V0(gt,pt){const{expression:vt}=pt;if(vt.kind==="constant")return{kind:"constant",layoutSize:vt.evaluate(new No(gt+1))};if(vt.kind==="source")return{kind:"source"};{const{zoomStops:St,interpolationType:Et}=vt;let Rt=0;for(;Rt<St.length&&St[Rt]<=gt;)Rt++;Rt=Math.max(0,Rt-1);let Lt=Rt;for(;Lt<St.length&&St[Lt]<gt+1;)Lt++;Lt=Math.min(St.length-1,Lt);const Nt=St[Rt],zt=St[Lt];return vt.kind==="composite"?{kind:"composite",minZoom:Nt,maxZoom:zt,interpolationType:Et}:{kind:"camera",minZoom:Nt,maxZoom:zt,minSize:vt.evaluate(new No(Nt)),maxSize:vt.evaluate(new No(zt)),interpolationType:Et}}}function w_(gt,pt,vt){let St="never";const Et=gt.get(pt);return Et?St=Et:gt.get(vt)&&(St="always"),St}const Xx=tp.VectorTileFeature.types,Kx=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Iy(gt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir){const or=Nt?Math.min(np,Math.round(Nt[0])):0,lr=Nt?Math.min(np,Math.round(Nt[1])):0;gt.emplaceBack(pt,vt,Math.round(32*St),Math.round(32*Et),Rt,Lt,(or<<1)+(zt?1:0),lr,16*jt,16*Wt,256*qt,256*ir)}function S_(gt,pt,vt){gt.emplaceBack(pt.x,pt.y,vt),gt.emplaceBack(pt.x,pt.y,vt),gt.emplaceBack(pt.x,pt.y,vt),gt.emplaceBack(pt.x,pt.y,vt)}function Jx(gt){for(const pt of gt.sections)if(Ky(pt.text))return!0;return!1}class T_{constructor(pt){this.layoutVertexArray=new um,this.indexArray=new Cl,this.programConfigurations=pt,this.segments=new bo,this.dynamicLayoutVertexArray=new cv,this.opacityVertexArray=new Qs,this.hasVisibleVertices=!1,this.placedSymbolArray=new Fo}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(pt,vt,St,Et){this.isEmpty()||(St&&(this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,Cx.members),this.indexBuffer=pt.createIndexBuffer(this.indexArray,vt),this.dynamicLayoutVertexBuffer=pt.createVertexBuffer(this.dynamicLayoutVertexArray,Dx.members,!0),this.opacityVertexBuffer=pt.createVertexBuffer(this.opacityVertexArray,Kx,!0),this.opacityVertexBuffer.itemSize=1),(St||Et)&&this.programConfigurations.upload(pt))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nn("SymbolBuffers",T_);class A_{constructor(pt,vt,St){this.layoutVertexArray=new pt,this.layoutAttributes=vt,this.indexArray=new St,this.segments=new bo,this.collisionVertexArray=new ru}upload(pt){this.layoutVertexBuffer=pt.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=pt.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=pt.createVertexBuffer(this.collisionVertexArray,Px.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nn("CollisionBuffers",A_);class wm{constructor(pt){this.collisionBoxArray=pt.collisionBoxArray,this.zoom=pt.zoom,this.overscaling=pt.overscaling,this.layers=pt.layers,this.layerIds=this.layers.map(Lt=>Lt.id),this.index=pt.index,this.pixelRatio=pt.pixelRatio,this.sourceLayerIndex=pt.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=i_([]),this.placementViewportMatrix=i_([]);const vt=this.layers[0]._unevaluatedLayout._values;this.textSizeData=V0(this.zoom,vt["text-size"]),this.iconSizeData=V0(this.zoom,vt["icon-size"]);const St=this.layers[0].layout,Et=St.get("symbol-sort-key"),Rt=St.get("symbol-z-order");this.canOverlap=w_(St,"text-overlap","text-allow-overlap")!=="never"||w_(St,"icon-overlap","icon-allow-overlap")!=="never"||St.get("text-ignore-placement")||St.get("icon-ignore-placement"),this.sortFeaturesByKey=Rt!=="viewport-y"&&!Et.isConstant(),this.sortFeaturesByY=(Rt==="viewport-y"||Rt==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,St.get("symbol-placement")==="point"&&(this.writingModes=St.get("text-writing-mode").map(Lt=>nt.ah[Lt])),this.stateDependentLayerIds=this.layers.filter(Lt=>Lt.isStateDependent()).map(Lt=>Lt.id),this.sourceID=pt.sourceID}createArrays(){this.text=new T_(new Mp(this.layers,this.zoom,pt=>/^text/.test(pt))),this.icon=new T_(new Mp(this.layers,this.zoom,pt=>/^icon/.test(pt))),this.glyphOffsetArray=new Bo,this.lineVertexArray=new bs,this.symbolInstances=new vo,this.textAnchorOffsets=new zo}calculateGlyphDependencies(pt,vt,St,Et,Rt){for(let Lt=0;Lt<pt.length;Lt++)if(vt[pt.charCodeAt(Lt)]=!0,(St||Et)&&Rt){const Nt=xv[pt.charAt(Lt)];Nt&&(vt[Nt.charCodeAt(0)]=!0)}}populate(pt,vt,St){const Et=this.layers[0],Rt=Et.layout,Lt=Rt.get("text-font"),Nt=Rt.get("text-field"),zt=Rt.get("icon-image"),jt=(Nt.value.kind!=="constant"||Nt.value.value instanceof to&&!Nt.value.value.isEmpty()||Nt.value.value.toString().length>0)&&(Lt.value.kind!=="constant"||Lt.value.value.length>0),Wt=zt.value.kind!=="constant"||!!zt.value.value||Object.keys(zt.parameters).length>0,qt=Rt.get("symbol-sort-key");if(this.features=[],!jt&&!Wt)return;const ir=vt.iconDependencies,or=vt.glyphDependencies,lr=vt.availableImages,pr=new No(this.zoom);for(const{feature:Tr,id:Ir,index:Wr,sourceLayerIndex:$r}of pt){const jr=Et._featureFilter.needGeometry,en=Lp(Tr,jr);if(!Et._featureFilter.filter(pr,en,St))continue;let dn,Ln;if(jr||(en.geometry=Rp(Tr)),jt){const Pn=Et.getValueAndResolveTokens("text-field",en,St,lr),En=to.factory(Pn),Hn=this.hasRTLText=this.hasRTLText||Jx(En);(!Hn||js.getRTLTextPluginStatus()==="unavailable"||Hn&&js.isParsed())&&(dn=Rx(En,Et,en))}if(Wt){const Pn=Et.getValueAndResolveTokens("icon-image",en,St,lr);Ln=Pn instanceof hs?Pn:hs.fromString(Pn)}if(!dn&&!Ln)continue;const Jn=this.sortFeaturesByKey?qt.evaluate(en,{},St):void 0;if(this.features.push({id:Ir,text:dn,icon:Ln,index:Wr,sourceLayerIndex:$r,geometry:en.geometry,properties:Tr.properties,type:Xx[Tr.type],sortKey:Jn}),Ln&&(ir[Ln.name]=!0),dn){const Pn=Lt.evaluate(en,{},St).join(","),En=Rt.get("text-rotation-alignment")!=="viewport"&&Rt.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(nt.ah.vertical)>=0;for(const Hn of dn.sections)if(Hn.image)ir[Hn.image.name]=!0;else{const Fn=av(dn.toString()),kn=Hn.fontStack||Pn,on=or[kn]=or[kn]||{};this.calculateGlyphDependencies(Hn.text,on,En,this.allowVerticalPlacement,Fn)}}}Rt.get("symbol-placement")==="line"&&(this.features=function(Tr){const Ir={},Wr={},$r=[];let jr=0;function en(Pn){$r.push(Tr[Pn]),jr++}function dn(Pn,En,Hn){const Fn=Wr[Pn];return delete Wr[Pn],Wr[En]=Fn,$r[Fn].geometry[0].pop(),$r[Fn].geometry[0]=$r[Fn].geometry[0].concat(Hn[0]),Fn}function Ln(Pn,En,Hn){const Fn=Ir[En];return delete Ir[En],Ir[Pn]=Fn,$r[Fn].geometry[0].shift(),$r[Fn].geometry[0]=Hn[0].concat($r[Fn].geometry[0]),Fn}function Jn(Pn,En,Hn){const Fn=Hn?En[0][En[0].length-1]:En[0][0];return`${Pn}:${Fn.x}:${Fn.y}`}for(let Pn=0;Pn<Tr.length;Pn++){const En=Tr[Pn],Hn=En.geometry,Fn=En.text?En.text.toString():null;if(!Fn){en(Pn);continue}const kn=Jn(Fn,Hn),on=Jn(Fn,Hn,!0);if(kn in Wr&&on in Ir&&Wr[kn]!==Ir[on]){const qn=Ln(kn,on,Hn),jn=dn(kn,on,$r[qn].geometry);delete Ir[kn],delete Wr[on],Wr[Jn(Fn,$r[jn].geometry,!0)]=jn,$r[qn].geometry=null}else kn in Wr?dn(kn,on,Hn):on in Ir?Ln(kn,on,Hn):(en(Pn),Ir[kn]=jr-1,Wr[on]=jr-1)}return $r.filter(Pn=>Pn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Tr,Ir)=>Tr.sortKey-Ir.sortKey)}update(pt,vt,St){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(pt,vt,this.layers,St),this.icon.programConfigurations.updatePaintArrays(pt,vt,this.layers,St))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(pt){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(pt),this.iconCollisionBox.upload(pt)),this.text.upload(pt,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(pt,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(pt,vt){const St=this.lineVertexArray.length;if(pt.segment!==void 0){let Et=pt.dist(vt[pt.segment+1]),Rt=pt.dist(vt[pt.segment]);const Lt={};for(let Nt=pt.segment+1;Nt<vt.length;Nt++)Lt[Nt]={x:vt[Nt].x,y:vt[Nt].y,tileUnitDistanceFromAnchor:Et},Nt<vt.length-1&&(Et+=vt[Nt+1].dist(vt[Nt]));for(let Nt=pt.segment||0;Nt>=0;Nt--)Lt[Nt]={x:vt[Nt].x,y:vt[Nt].y,tileUnitDistanceFromAnchor:Rt},Nt>0&&(Rt+=vt[Nt-1].dist(vt[Nt]));for(let Nt=0;Nt<vt.length;Nt++){const zt=Lt[Nt];this.lineVertexArray.emplaceBack(zt.x,zt.y,zt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:St,lineLength:this.lineVertexArray.length-St}}addSymbols(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir){const or=pt.indexArray,lr=pt.layoutVertexArray,pr=pt.segments.prepareSegment(4*vt.length,lr,or,this.canOverlap?Lt.sortKey:void 0),Tr=this.glyphOffsetArray.length,Ir=pr.vertexLength,Wr=this.allowVerticalPlacement&&Nt===nt.ah.vertical?Math.PI/2:0,$r=Lt.text&&Lt.text.sections;for(let jr=0;jr<vt.length;jr++){const{tl:en,tr:dn,bl:Ln,br:Jn,tex:Pn,pixelOffsetTL:En,pixelOffsetBR:Hn,minFontScaleX:Fn,minFontScaleY:kn,glyphOffset:on,isSDF:qn,sectionIndex:jn}=vt[jr],xa=pr.vertexLength,Lo=on[1];Iy(lr,zt.x,zt.y,en.x,Lo+en.y,Pn.x,Pn.y,St,qn,En.x,En.y,Fn,kn),Iy(lr,zt.x,zt.y,dn.x,Lo+dn.y,Pn.x+Pn.w,Pn.y,St,qn,Hn.x,En.y,Fn,kn),Iy(lr,zt.x,zt.y,Ln.x,Lo+Ln.y,Pn.x,Pn.y+Pn.h,St,qn,En.x,Hn.y,Fn,kn),Iy(lr,zt.x,zt.y,Jn.x,Lo+Jn.y,Pn.x+Pn.w,Pn.y+Pn.h,St,qn,Hn.x,Hn.y,Fn,kn),S_(pt.dynamicLayoutVertexArray,zt,Wr),or.emplaceBack(xa,xa+1,xa+2),or.emplaceBack(xa+1,xa+2,xa+3),pr.vertexLength+=4,pr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(on[0]),jr!==vt.length-1&&jn===vt[jr+1].sectionIndex||pt.programConfigurations.populatePaintArrays(lr.length,Lt,Lt.index,{},ir,$r&&$r[jn])}pt.placedSymbolArray.emplaceBack(zt.x,zt.y,Tr,this.glyphOffsetArray.length-Tr,Ir,jt,Wt,zt.segment,St?St[0]:0,St?St[1]:0,Et[0],Et[1],Nt,0,!1,0,qt)}_addCollisionDebugVertex(pt,vt,St,Et,Rt,Lt){return vt.emplaceBack(0,0),pt.emplaceBack(St.x,St.y,Et,Rt,Math.round(Lt.x),Math.round(Lt.y))}addCollisionDebugVertices(pt,vt,St,Et,Rt,Lt,Nt){const zt=Rt.segments.prepareSegment(4,Rt.layoutVertexArray,Rt.indexArray),jt=zt.vertexLength,Wt=Rt.layoutVertexArray,qt=Rt.collisionVertexArray,ir=Nt.anchorX,or=Nt.anchorY;this._addCollisionDebugVertex(Wt,qt,Lt,ir,or,new ot(pt,vt)),this._addCollisionDebugVertex(Wt,qt,Lt,ir,or,new ot(St,vt)),this._addCollisionDebugVertex(Wt,qt,Lt,ir,or,new ot(St,Et)),this._addCollisionDebugVertex(Wt,qt,Lt,ir,or,new ot(pt,Et)),zt.vertexLength+=4;const lr=Rt.indexArray;lr.emplaceBack(jt,jt+1),lr.emplaceBack(jt+1,jt+2),lr.emplaceBack(jt+2,jt+3),lr.emplaceBack(jt+3,jt),zt.primitiveLength+=4}addDebugCollisionBoxes(pt,vt,St,Et){for(let Rt=pt;Rt<vt;Rt++){const Lt=this.collisionBoxArray.get(Rt);this.addCollisionDebugVertices(Lt.x1,Lt.y1,Lt.x2,Lt.y2,Et?this.textCollisionBox:this.iconCollisionBox,Lt.anchorPoint,St)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new A_(yl,T0.members,ps),this.iconCollisionBox=new A_(yl,T0.members,ps);for(let pt=0;pt<this.symbolInstances.length;pt++){const vt=this.symbolInstances.get(pt);this.addDebugCollisionBoxes(vt.textBoxStartIndex,vt.textBoxEndIndex,vt,!0),this.addDebugCollisionBoxes(vt.verticalTextBoxStartIndex,vt.verticalTextBoxEndIndex,vt,!0),this.addDebugCollisionBoxes(vt.iconBoxStartIndex,vt.iconBoxEndIndex,vt,!1),this.addDebugCollisionBoxes(vt.verticalIconBoxStartIndex,vt.verticalIconBoxEndIndex,vt,!1)}}_deserializeCollisionBoxesForSymbol(pt,vt,St,Et,Rt,Lt,Nt,zt,jt){const Wt={};for(let qt=vt;qt<St;qt++){const ir=pt.get(qt);Wt.textBox={x1:ir.x1,y1:ir.y1,x2:ir.x2,y2:ir.y2,anchorPointX:ir.anchorPointX,anchorPointY:ir.anchorPointY},Wt.textFeatureIndex=ir.featureIndex;break}for(let qt=Et;qt<Rt;qt++){const ir=pt.get(qt);Wt.verticalTextBox={x1:ir.x1,y1:ir.y1,x2:ir.x2,y2:ir.y2,anchorPointX:ir.anchorPointX,anchorPointY:ir.anchorPointY},Wt.verticalTextFeatureIndex=ir.featureIndex;break}for(let qt=Lt;qt<Nt;qt++){const ir=pt.get(qt);Wt.iconBox={x1:ir.x1,y1:ir.y1,x2:ir.x2,y2:ir.y2,anchorPointX:ir.anchorPointX,anchorPointY:ir.anchorPointY},Wt.iconFeatureIndex=ir.featureIndex;break}for(let qt=zt;qt<jt;qt++){const ir=pt.get(qt);Wt.verticalIconBox={x1:ir.x1,y1:ir.y1,x2:ir.x2,y2:ir.y2,anchorPointX:ir.anchorPointX,anchorPointY:ir.anchorPointY},Wt.verticalIconFeatureIndex=ir.featureIndex;break}return Wt}deserializeCollisionBoxes(pt){this.collisionArrays=[];for(let vt=0;vt<this.symbolInstances.length;vt++){const St=this.symbolInstances.get(vt);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(pt,St.textBoxStartIndex,St.textBoxEndIndex,St.verticalTextBoxStartIndex,St.verticalTextBoxEndIndex,St.iconBoxStartIndex,St.iconBoxEndIndex,St.verticalIconBoxStartIndex,St.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(pt,vt){const St=pt.placedSymbolArray.get(vt),Et=St.vertexStartIndex+4*St.numGlyphs;for(let Rt=St.vertexStartIndex;Rt<Et;Rt+=4)pt.indexArray.emplaceBack(Rt,Rt+1,Rt+2),pt.indexArray.emplaceBack(Rt+1,Rt+2,Rt+3)}getSortedSymbolIndexes(pt){if(this.sortedAngle===pt&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const vt=Math.sin(pt),St=Math.cos(pt),Et=[],Rt=[],Lt=[];for(let Nt=0;Nt<this.symbolInstances.length;++Nt){Lt.push(Nt);const zt=this.symbolInstances.get(Nt);Et.push(0|Math.round(vt*zt.anchorX+St*zt.anchorY)),Rt.push(zt.featureIndex)}return Lt.sort((Nt,zt)=>Et[Nt]-Et[zt]||Rt[zt]-Rt[Nt]),Lt}addToSortKeyRanges(pt,vt){const St=this.sortKeyRanges[this.sortKeyRanges.length-1];St&&St.sortKey===vt?St.symbolInstanceEnd=pt+1:this.sortKeyRanges.push({sortKey:vt,symbolInstanceStart:pt,symbolInstanceEnd:pt+1})}sortFeatures(pt){if(this.sortFeaturesByY&&this.sortedAngle!==pt&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(pt),this.sortedAngle=pt,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const vt of this.symbolInstanceIndexes){const St=this.symbolInstances.get(vt);this.featureSortOrder.push(St.featureIndex),[St.rightJustifiedTextSymbolIndex,St.centerJustifiedTextSymbolIndex,St.leftJustifiedTextSymbolIndex].forEach((Et,Rt,Lt)=>{Et>=0&&Lt.indexOf(Et)===Rt&&this.addIndicesForPlacedSymbol(this.text,Et)}),St.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,St.verticalPlacedTextSymbolIndex),St.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,St.placedIconSymbolIndex),St.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,St.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let U0,G0;Nn("SymbolBucket",wm,{omit:["layers","collisionBoxArray","features","compareText"]}),wm.MAX_GLYPHS=65535,wm.addDynamicAttributes=S_;var I_={get paint(){return G0=G0||new Mt({"icon-opacity":new _i(zr.paint_symbol["icon-opacity"]),"icon-color":new _i(zr.paint_symbol["icon-color"]),"icon-halo-color":new _i(zr.paint_symbol["icon-halo-color"]),"icon-halo-width":new _i(zr.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _i(zr.paint_symbol["icon-halo-blur"]),"icon-translate":new Vn(zr.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vn(zr.paint_symbol["icon-translate-anchor"]),"text-opacity":new _i(zr.paint_symbol["text-opacity"]),"text-color":new _i(zr.paint_symbol["text-color"],{runtimeType:ts,getOverride:gt=>gt.textColor,hasOverride:gt=>!!gt.textColor}),"text-halo-color":new _i(zr.paint_symbol["text-halo-color"]),"text-halo-width":new _i(zr.paint_symbol["text-halo-width"]),"text-halo-blur":new _i(zr.paint_symbol["text-halo-blur"]),"text-translate":new Vn(zr.paint_symbol["text-translate"]),"text-translate-anchor":new Vn(zr.paint_symbol["text-translate-anchor"])})},get layout(){return U0=U0||new Mt({"symbol-placement":new Vn(zr.layout_symbol["symbol-placement"]),"symbol-spacing":new Vn(zr.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vn(zr.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _i(zr.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vn(zr.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Vn(zr.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Vn(zr.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Vn(zr.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vn(zr.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vn(zr.layout_symbol["icon-rotation-alignment"]),"icon-size":new _i(zr.layout_symbol["icon-size"]),"icon-text-fit":new Vn(zr.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Vn(zr.layout_symbol["icon-text-fit-padding"]),"icon-image":new _i(zr.layout_symbol["icon-image"]),"icon-rotate":new _i(zr.layout_symbol["icon-rotate"]),"icon-padding":new _i(zr.layout_symbol["icon-padding"]),"icon-keep-upright":new Vn(zr.layout_symbol["icon-keep-upright"]),"icon-offset":new _i(zr.layout_symbol["icon-offset"]),"icon-anchor":new _i(zr.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vn(zr.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vn(zr.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vn(zr.layout_symbol["text-rotation-alignment"]),"text-field":new _i(zr.layout_symbol["text-field"]),"text-font":new _i(zr.layout_symbol["text-font"]),"text-size":new _i(zr.layout_symbol["text-size"]),"text-max-width":new _i(zr.layout_symbol["text-max-width"]),"text-line-height":new Vn(zr.layout_symbol["text-line-height"]),"text-letter-spacing":new _i(zr.layout_symbol["text-letter-spacing"]),"text-justify":new _i(zr.layout_symbol["text-justify"]),"text-radial-offset":new _i(zr.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vn(zr.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _i(zr.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _i(zr.layout_symbol["text-anchor"]),"text-max-angle":new Vn(zr.layout_symbol["text-max-angle"]),"text-writing-mode":new Vn(zr.layout_symbol["text-writing-mode"]),"text-rotate":new _i(zr.layout_symbol["text-rotate"]),"text-padding":new Vn(zr.layout_symbol["text-padding"]),"text-keep-upright":new Vn(zr.layout_symbol["text-keep-upright"]),"text-transform":new _i(zr.layout_symbol["text-transform"]),"text-offset":new _i(zr.layout_symbol["text-offset"]),"text-allow-overlap":new Vn(zr.layout_symbol["text-allow-overlap"]),"text-overlap":new Vn(zr.layout_symbol["text-overlap"]),"text-ignore-placement":new Vn(zr.layout_symbol["text-ignore-placement"]),"text-optional":new Vn(zr.layout_symbol["text-optional"])})}};class j0{constructor(pt){if(pt.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=pt.property.overrides?pt.property.overrides.runtimeType:ko,this.defaultValue=pt}evaluate(pt){if(pt.formattedSection){const vt=this.defaultValue.property.overrides;if(vt&&vt.hasOverride(pt.formattedSection))return vt.getOverride(pt.formattedSection)}return pt.feature&&pt.featureState?this.defaultValue.evaluate(pt.feature,pt.featureState):this.defaultValue.property.specification.default}eachChild(pt){this.defaultValue.isConstant()||pt(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nn("FormatSectionOverride",j0,{omit:["defaultValue"]});class Ey extends xt{constructor(pt){super(pt,I_)}recalculate(pt,vt){if(super.recalculate(pt,vt),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const St=this.layout.get("text-writing-mode");if(St){const Et=[];for(const Rt of St)Et.indexOf(Rt)<0&&Et.push(Rt);this.layout._values["text-writing-mode"]=Et}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(pt,vt,St,Et){const Rt=this.layout.get(pt).evaluate(vt,{},St,Et),Lt=this._unevaluatedLayout._values[pt];return Lt.isDataDriven()||qp(Lt.value)||!Rt?Rt:function(Nt,zt){return zt.replace(/{([^{}]+)}/g,(jt,Wt)=>Nt&&Wt in Nt?String(Nt[Wt]):"")}(vt.properties,Rt)}createBucket(pt){return new wm(pt)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const pt of I_.paint.overridableProperties){if(!Ey.hasPaintOverride(this.layout,pt))continue;const vt=this.paint.get(pt),St=new j0(vt),Et=new Yp(St,vt.property.specification);let Rt=null;Rt=vt.value.kind==="constant"||vt.value.kind==="source"?new zu("source",Et):new Vu("composite",Et,vt.value.zoomStops),this.paint._values[pt]=new Vl(vt.property,Rt,vt.parameters)}}_handleOverridablePaintPropertyUpdate(pt,vt,St){return!(!this.layout||vt.isDataDriven()||St.isDataDriven())&&Ey.hasPaintOverride(this.layout,pt)}static hasPaintOverride(pt,vt){const St=pt.get("text-field"),Et=I_.paint.properties[vt];let Rt=!1;const Lt=Nt=>{for(const zt of Nt)if(Et.overrides&&Et.overrides.hasOverride(zt))return void(Rt=!0)};if(St.value.kind==="constant"&&St.value.value instanceof to)Lt(St.value.value.sections);else if(St.value.kind==="source"){const Nt=jt=>{Rt||(jt instanceof Ls&&To(jt.value)===cs?Lt(jt.value.sections):jt instanceof wn?Lt(jt.sections):jt.eachChild(Nt))},zt=St.value;zt._styleExpression&&Nt(zt._styleExpression.expression)}return Rt}}let H0;var Qx={get paint(){return H0=H0||new Mt({"background-color":new Vn(zr.paint_background["background-color"]),"background-pattern":new sm(zr.paint_background["background-pattern"]),"background-opacity":new Vn(zr.paint_background["background-opacity"])})}};class ew extends xt{constructor(pt){super(pt,Qx)}}let W0;var tw={get paint(){return W0=W0||new Mt({"raster-opacity":new Vn(zr.paint_raster["raster-opacity"]),"raster-hue-rotate":new Vn(zr.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vn(zr.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vn(zr.paint_raster["raster-brightness-max"]),"raster-saturation":new Vn(zr.paint_raster["raster-saturation"]),"raster-contrast":new Vn(zr.paint_raster["raster-contrast"]),"raster-resampling":new Vn(zr.paint_raster["raster-resampling"]),"raster-fade-duration":new Vn(zr.paint_raster["raster-fade-duration"])})}};class rw extends xt{constructor(pt){super(pt,tw)}}class nw extends xt{constructor(pt){super(pt,{}),this.onAdd=vt=>{this.implementation.onAdd&&this.implementation.onAdd(vt,vt.painter.context.gl)},this.onRemove=vt=>{this.implementation.onRemove&&this.implementation.onRemove(vt,vt.painter.context.gl)},this.implementation=pt}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class iw{constructor(pt){this._methodToThrottle=pt,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const E_=63710088e-1;class ip{constructor(pt,vt){if(isNaN(pt)||isNaN(vt))throw new Error(`Invalid LngLat object: (${pt}, ${vt})`);if(this.lng=+pt,this.lat=+vt,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ip(Ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(pt){const vt=Math.PI/180,St=this.lat*vt,Et=pt.lat*vt,Rt=Math.sin(St)*Math.sin(Et)+Math.cos(St)*Math.cos(Et)*Math.cos((pt.lng-this.lng)*vt);return E_*Math.acos(Math.min(Rt,1))}static convert(pt){if(pt instanceof ip)return pt;if(Array.isArray(pt)&&(pt.length===2||pt.length===3))return new ip(Number(pt[0]),Number(pt[1]));if(!Array.isArray(pt)&&typeof pt=="object"&&pt!==null)return new ip(Number("lng"in pt?pt.lng:pt.lon),Number(pt.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Y0=2*Math.PI*E_;function q0(gt){return Y0*Math.cos(gt*Math.PI/180)}function Z0(gt){return(180+gt)/360}function X0(gt){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+gt*Math.PI/360)))/360}function K0(gt,pt){return gt/q0(pt)}function C_(gt){return 360/Math.PI*Math.atan(Math.exp((180-360*gt)*Math.PI/180))-90}class Av{constructor(pt,vt,St=0){this.x=+pt,this.y=+vt,this.z=+St}static fromLngLat(pt,vt=0){const St=ip.convert(pt);return new Av(Z0(St.lng),X0(St.lat),K0(vt,St.lat))}toLngLat(){return new ip(360*this.x-180,C_(this.y))}toAltitude(){return this.z*q0(C_(this.y))}meterInMercatorCoordinateUnits(){return 1/Y0*(pt=C_(this.y),1/Math.cos(pt*Math.PI/180));var pt}}function J0(gt,pt,vt){var St=2*Math.PI*6378137/256/Math.pow(2,vt);return[gt*St-2*Math.PI*6378137/2,pt*St-2*Math.PI*6378137/2]}class D_{constructor(pt,vt,St){if(!function(Et,Rt,Lt){return!(Et<0||Et>25||Lt<0||Lt>=Math.pow(2,Et)||Rt<0||Rt>=Math.pow(2,Et))}(pt,vt,St))throw new Error(`x=${vt}, y=${St}, z=${pt} outside of bounds. 0<=x<${Math.pow(2,pt)}, 0<=y<${Math.pow(2,pt)} 0<=z<=25 `);this.z=pt,this.x=vt,this.y=St,this.key=Iv(0,pt,pt,vt,St)}equals(pt){return this.z===pt.z&&this.x===pt.x&&this.y===pt.y}url(pt,vt,St){const Et=(Lt=this.y,Nt=this.z,zt=J0(256*(Rt=this.x),256*(Lt=Math.pow(2,Nt)-Lt-1),Nt),jt=J0(256*(Rt+1),256*(Lt+1),Nt),zt[0]+","+zt[1]+","+jt[0]+","+jt[1]);var Rt,Lt,Nt,zt,jt;const Wt=function(qt,ir,or){let lr,pr="";for(let Tr=qt;Tr>0;Tr--)lr=1<<Tr-1,pr+=(ir&lr?1:0)+(or&lr?2:0);return pr}(this.z,this.x,this.y);return pt[(this.x+this.y)%pt.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(St==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,vt>1?"@2x":"").replace(/{quadkey}/g,Wt).replace(/{bbox-epsg-3857}/g,Et)}isChildOf(pt){const vt=this.z-pt.z;return vt>0&&pt.x===this.x>>vt&&pt.y===this.y>>vt}getTilePoint(pt){const vt=Math.pow(2,this.z);return new ot((pt.x*vt-this.x)*es,(pt.y*vt-this.y)*es)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Q0{constructor(pt,vt){this.wrap=pt,this.canonical=vt,this.key=Iv(pt,vt.z,vt.z,vt.x,vt.y)}}class Pl{constructor(pt,vt,St,Et,Rt){if(pt<St)throw new Error(`overscaledZ should be >= z; overscaledZ = ${pt}; z = ${St}`);this.overscaledZ=pt,this.wrap=vt,this.canonical=new D_(St,+Et,+Rt),this.key=Iv(vt,pt,St,Et,Rt)}clone(){return new Pl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(pt){return this.overscaledZ===pt.overscaledZ&&this.wrap===pt.wrap&&this.canonical.equals(pt.canonical)}scaledTo(pt){if(pt>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${pt}; overscaledZ = ${this.overscaledZ}`);const vt=this.canonical.z-pt;return pt>this.canonical.z?new Pl(pt,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pl(pt,this.wrap,pt,this.canonical.x>>vt,this.canonical.y>>vt)}calculateScaledKey(pt,vt){if(pt>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${pt}; overscaledZ = ${this.overscaledZ}`);const St=this.canonical.z-pt;return pt>this.canonical.z?Iv(this.wrap*+vt,pt,this.canonical.z,this.canonical.x,this.canonical.y):Iv(this.wrap*+vt,pt,pt,this.canonical.x>>St,this.canonical.y>>St)}isChildOf(pt){if(pt.wrap!==this.wrap)return!1;const vt=this.canonical.z-pt.canonical.z;return pt.overscaledZ===0||pt.overscaledZ<this.overscaledZ&&pt.canonical.x===this.canonical.x>>vt&&pt.canonical.y===this.canonical.y>>vt}children(pt){if(this.overscaledZ>=pt)return[new Pl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const vt=this.canonical.z+1,St=2*this.canonical.x,Et=2*this.canonical.y;return[new Pl(vt,this.wrap,vt,St,Et),new Pl(vt,this.wrap,vt,St+1,Et),new Pl(vt,this.wrap,vt,St,Et+1),new Pl(vt,this.wrap,vt,St+1,Et+1)]}isLessThan(pt){return this.wrap<pt.wrap||!(this.wrap>pt.wrap)&&(this.overscaledZ<pt.overscaledZ||!(this.overscaledZ>pt.overscaledZ)&&(this.canonical.x<pt.canonical.x||!(this.canonical.x>pt.canonical.x)&&this.canonical.y<pt.canonical.y))}wrapped(){return new Pl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(pt){return new Pl(this.overscaledZ,pt,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Q0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(pt){return this.canonical.getTilePoint(new Av(pt.x-this.wrap,pt.y))}}function Iv(gt,pt,vt,St,Et){(gt*=2)<0&&(gt=-1*gt-1);const Rt=1<<vt;return(Rt*Rt*gt+Rt*Et+St).toString(36)+vt.toString(36)+pt.toString(36)}Nn("CanonicalTileID",D_),Nn("OverscaledTileID",Pl,{omit:["posMatrix"]});class e1{constructor(pt,vt,St,Et=1,Rt=1,Lt=1,Nt=0){if(this.uid=pt,vt.height!==vt.width)throw new RangeError("DEM tiles must be square");if(St&&!["mapbox","terrarium","custom"].includes(St))return void Xt(`"${St}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=vt.height;const zt=this.dim=vt.height-2;switch(this.data=new Uint32Array(vt.data.buffer),St){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=Et,this.greenFactor=Rt,this.blueFactor=Lt,this.baseShift=Nt;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let jt=0;jt<zt;jt++)this.data[this._idx(-1,jt)]=this.data[this._idx(0,jt)],this.data[this._idx(zt,jt)]=this.data[this._idx(zt-1,jt)],this.data[this._idx(jt,-1)]=this.data[this._idx(jt,0)],this.data[this._idx(jt,zt)]=this.data[this._idx(jt,zt-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(zt,-1)]=this.data[this._idx(zt-1,0)],this.data[this._idx(-1,zt)]=this.data[this._idx(0,zt-1)],this.data[this._idx(zt,zt)]=this.data[this._idx(zt-1,zt-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let jt=0;jt<zt;jt++)for(let Wt=0;Wt<zt;Wt++){const qt=this.get(jt,Wt);qt>this.max&&(this.max=qt),qt<this.min&&(this.min=qt)}}get(pt,vt){const St=new Uint8Array(this.data.buffer),Et=4*this._idx(pt,vt);return this.unpack(St[Et],St[Et+1],St[Et+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(pt,vt){if(pt<-1||pt>=this.dim+1||vt<-1||vt>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(vt+1)*this.stride+(pt+1)}unpack(pt,vt,St){return pt*this.redFactor+vt*this.greenFactor+St*this.blueFactor-this.baseShift}getPixels(){return new Dl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(pt,vt,St){if(this.dim!==pt.dim)throw new Error("dem dimension mismatch");let Et=vt*this.dim,Rt=vt*this.dim+this.dim,Lt=St*this.dim,Nt=St*this.dim+this.dim;switch(vt){case-1:Et=Rt-1;break;case 1:Rt=Et+1}switch(St){case-1:Lt=Nt-1;break;case 1:Nt=Lt+1}const zt=-vt*this.dim,jt=-St*this.dim;for(let Wt=Lt;Wt<Nt;Wt++)for(let qt=Et;qt<Rt;qt++)this.data[this._idx(qt,Wt)]=pt.data[this._idx(qt+zt,Wt+jt)]}}Nn("DEMData",e1);class t1{constructor(pt){this._stringToNumber={},this._numberToString=[];for(let vt=0;vt<pt.length;vt++){const St=pt[vt];this._stringToNumber[St]=vt,this._numberToString[vt]=St}}encode(pt){return this._stringToNumber[pt]}decode(pt){if(pt>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${pt} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[pt]}}class r1{constructor(pt,vt,St,Et,Rt){this.type="Feature",this._vectorTileFeature=pt,pt._z=vt,pt._x=St,pt._y=Et,this.properties=pt.properties,this.id=Rt}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(pt){this._geometry=pt}toJSON(){const pt={geometry:this.geometry};for(const vt in this)vt!=="_geometry"&&vt!=="_vectorTileFeature"&&(pt[vt]=this[vt]);return pt}}class n1{constructor(pt,vt){this.tileID=pt,this.x=pt.canonical.x,this.y=pt.canonical.y,this.z=pt.canonical.z,this.grid=new ju(es,16,0),this.grid3D=new ju(es,16,0),this.featureIndexArray=new Es,this.promoteId=vt}insert(pt,vt,St,Et,Rt,Lt){const Nt=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(St,Et,Rt);const zt=Lt?this.grid3D:this.grid;for(let jt=0;jt<vt.length;jt++){const Wt=vt[jt],qt=[1/0,1/0,-1/0,-1/0];for(let ir=0;ir<Wt.length;ir++){const or=Wt[ir];qt[0]=Math.min(qt[0],or.x),qt[1]=Math.min(qt[1],or.y),qt[2]=Math.max(qt[2],or.x),qt[3]=Math.max(qt[3],or.y)}qt[0]<es&&qt[1]<es&&qt[2]>=0&&qt[3]>=0&&zt.insert(Nt,qt[0],qt[1],qt[2],qt[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new tp.VectorTile(new v_(this.rawTileData)).layers,this.sourceLayerCoder=new t1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(pt,vt,St,Et){this.loadVTLayers();const Rt=pt.params||{},Lt=es/pt.tileSize/pt.scale,Nt=jm(Rt.filter),zt=pt.queryGeometry,jt=pt.queryPadding*Lt,Wt=a1(zt),qt=this.grid.query(Wt.minX-jt,Wt.minY-jt,Wt.maxX+jt,Wt.maxY+jt),ir=a1(pt.cameraQueryGeometry),or=this.grid3D.query(ir.minX-jt,ir.minY-jt,ir.maxX+jt,ir.maxY+jt,(Tr,Ir,Wr,$r)=>function(jr,en,dn,Ln,Jn){for(const En of jr)if(en<=En.x&&dn<=En.y&&Ln>=En.x&&Jn>=En.y)return!0;const Pn=[new ot(en,dn),new ot(en,Jn),new ot(Ln,Jn),new ot(Ln,dn)];if(jr.length>2){for(const En of Pn)if(pm(jr,En))return!0}for(let En=0;En<jr.length-1;En++)if(k1(jr[En],jr[En+1],Pn))return!0;return!1}(pt.cameraQueryGeometry,Tr-jt,Ir-jt,Wr+jt,$r+jt));for(const Tr of or)qt.push(Tr);qt.sort(aw);const lr={};let pr;for(let Tr=0;Tr<qt.length;Tr++){const Ir=qt[Tr];if(Ir===pr)continue;pr=Ir;const Wr=this.featureIndexArray.get(Ir);let $r=null;this.loadMatchingFeature(lr,Wr.bucketIndex,Wr.sourceLayerIndex,Wr.featureIndex,Nt,Rt.layers,Rt.availableImages,vt,St,Et,(jr,en,dn)=>($r||($r=Rp(jr)),en.queryIntersectsFeature(zt,jr,dn,$r,this.z,pt.transform,Lt,pt.pixelPosMatrix)))}return lr}loadMatchingFeature(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt){const ir=this.bucketLayerIDs[vt];if(Lt&&!function(Tr,Ir){for(let Wr=0;Wr<Tr.length;Wr++)if(Ir.indexOf(Tr[Wr])>=0)return!0;return!1}(Lt,ir))return;const or=this.sourceLayerCoder.decode(St),lr=this.vtLayers[or].feature(Et);if(Rt.needGeometry){const Tr=Lp(lr,!0);if(!Rt.filter(new No(this.tileID.overscaledZ),Tr,this.tileID.canonical))return}else if(!Rt.filter(new No(this.tileID.overscaledZ),lr))return;const pr=this.getId(lr,or);for(let Tr=0;Tr<ir.length;Tr++){const Ir=ir[Tr];if(Lt&&Lt.indexOf(Ir)<0)continue;const Wr=zt[Ir];if(!Wr)continue;let $r={};pr&&Wt&&($r=Wt.getState(Wr.sourceLayer||"_geojsonTileLayer",pr));const jr=$t({},jt[Ir]);jr.paint=i1(jr.paint,Wr.paint,lr,$r,Nt),jr.layout=i1(jr.layout,Wr.layout,lr,$r,Nt);const en=!qt||qt(lr,Wr,$r);if(!en)continue;const dn=new r1(lr,this.z,this.x,this.y,pr);dn.layer=jr;let Ln=pt[Ir];Ln===void 0&&(Ln=pt[Ir]=[]),Ln.push({featureIndex:Et,feature:dn,intersectionZ:en})}}lookupSymbolFeatures(pt,vt,St,Et,Rt,Lt,Nt,zt){const jt={};this.loadVTLayers();const Wt=jm(Rt);for(const qt of pt)this.loadMatchingFeature(jt,St,Et,qt,Wt,Lt,Nt,zt,vt);return jt}hasLayer(pt){for(const vt of this.bucketLayerIDs)for(const St of vt)if(pt===St)return!0;return!1}getId(pt,vt){let St=pt.id;return this.promoteId&&(St=pt.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[vt]],typeof St=="boolean"&&(St=Number(St))),St}}function i1(gt,pt,vt,St,Et){return kt(gt,(Rt,Lt)=>{const Nt=pt instanceof Cp?pt.get(Lt):null;return Nt&&Nt.evaluate?Nt.evaluate(vt,St,Et):Nt})}function a1(gt){let pt=1/0,vt=1/0,St=-1/0,Et=-1/0;for(const Rt of gt)pt=Math.min(pt,Rt.x),vt=Math.min(vt,Rt.y),St=Math.max(St,Rt.x),Et=Math.max(Et,Rt.y);return{minX:pt,minY:vt,maxX:St,maxY:Et}}function aw(gt,pt){return pt-gt}function o1(gt,pt,vt,St,Et){const Rt=[];for(let Lt=0;Lt<gt.length;Lt++){const Nt=gt[Lt];let zt;for(let jt=0;jt<Nt.length-1;jt++){let Wt=Nt[jt],qt=Nt[jt+1];Wt.x<pt&&qt.x<pt||(Wt.x<pt?Wt=new ot(pt,Wt.y+(pt-Wt.x)/(qt.x-Wt.x)*(qt.y-Wt.y))._round():qt.x<pt&&(qt=new ot(pt,Wt.y+(pt-Wt.x)/(qt.x-Wt.x)*(qt.y-Wt.y))._round()),Wt.y<vt&&qt.y<vt||(Wt.y<vt?Wt=new ot(Wt.x+(vt-Wt.y)/(qt.y-Wt.y)*(qt.x-Wt.x),vt)._round():qt.y<vt&&(qt=new ot(Wt.x+(vt-Wt.y)/(qt.y-Wt.y)*(qt.x-Wt.x),vt)._round()),Wt.x>=St&&qt.x>=St||(Wt.x>=St?Wt=new ot(St,Wt.y+(St-Wt.x)/(qt.x-Wt.x)*(qt.y-Wt.y))._round():qt.x>=St&&(qt=new ot(St,Wt.y+(St-Wt.x)/(qt.x-Wt.x)*(qt.y-Wt.y))._round()),Wt.y>=Et&&qt.y>=Et||(Wt.y>=Et?Wt=new ot(Wt.x+(Et-Wt.y)/(qt.y-Wt.y)*(qt.x-Wt.x),Et)._round():qt.y>=Et&&(qt=new ot(Wt.x+(Et-Wt.y)/(qt.y-Wt.y)*(qt.x-Wt.x),Et)._round()),zt&&Wt.equals(zt[zt.length-1])||(zt=[Wt],Rt.push(zt)),zt.push(qt)))))}}return Rt}Nn("FeatureIndex",n1,{omit:["rawTileData","sourceLayerCoder"]});class ap extends ot{constructor(pt,vt,St,Et){super(pt,vt),this.angle=St,Et!==void 0&&(this.segment=Et)}clone(){return new ap(this.x,this.y,this.angle,this.segment)}}function s1(gt,pt,vt,St,Et){if(pt.segment===void 0||vt===0)return!0;let Rt=pt,Lt=pt.segment+1,Nt=0;for(;Nt>-vt/2;){if(Lt--,Lt<0)return!1;Nt-=gt[Lt].dist(Rt),Rt=gt[Lt]}Nt+=gt[Lt].dist(gt[Lt+1]),Lt++;const zt=[];let jt=0;for(;Nt<vt/2;){const Wt=gt[Lt],qt=gt[Lt+1];if(!qt)return!1;let ir=gt[Lt-1].angleTo(Wt)-Wt.angleTo(qt);for(ir=Math.abs((ir+3*Math.PI)%(2*Math.PI)-Math.PI),zt.push({distance:Nt,angleDelta:ir}),jt+=ir;Nt-zt[0].distance>St;)jt-=zt.shift().angleDelta;if(jt>Et)return!1;Lt++,Nt+=Wt.dist(qt)}return!0}function l1(gt){let pt=0;for(let vt=0;vt<gt.length-1;vt++)pt+=gt[vt].dist(gt[vt+1]);return pt}function u1(gt,pt,vt){return gt?.6*pt*vt:0}function c1(gt,pt){return Math.max(gt?gt.right-gt.left:0,pt?pt.right-pt.left:0)}function ow(gt,pt,vt,St,Et,Rt){const Lt=u1(vt,Et,Rt),Nt=c1(vt,St)*Rt;let zt=0;const jt=l1(gt)/2;for(let Wt=0;Wt<gt.length-1;Wt++){const qt=gt[Wt],ir=gt[Wt+1],or=qt.dist(ir);if(zt+or>jt){const lr=(jt-zt)/or,pr=fs.number(qt.x,ir.x,lr),Tr=fs.number(qt.y,ir.y,lr),Ir=new ap(pr,Tr,ir.angleTo(qt),Wt);return Ir._round(),!Lt||s1(gt,Ir,Nt,Lt,pt)?Ir:void 0}zt+=or}}function sw(gt,pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=u1(St,Rt,Lt),Wt=c1(St,Et),qt=Wt*Lt,ir=gt[0].x===0||gt[0].x===zt||gt[0].y===0||gt[0].y===zt;return pt-qt<pt/4&&(pt=qt+pt/4),h1(gt,ir?pt/2*Nt%pt:(Wt/2+2*Rt)*Lt*Nt%pt,pt,jt,vt,qt,ir,!1,zt)}function h1(gt,pt,vt,St,Et,Rt,Lt,Nt,zt){const jt=Rt/2,Wt=l1(gt);let qt=0,ir=pt-vt,or=[];for(let lr=0;lr<gt.length-1;lr++){const pr=gt[lr],Tr=gt[lr+1],Ir=pr.dist(Tr),Wr=Tr.angleTo(pr);for(;ir+vt<qt+Ir;){ir+=vt;const $r=(ir-qt)/Ir,jr=fs.number(pr.x,Tr.x,$r),en=fs.number(pr.y,Tr.y,$r);if(jr>=0&&jr<zt&&en>=0&&en<zt&&ir-jt>=0&&ir+jt<=Wt){const dn=new ap(jr,en,Wr,lr);dn._round(),St&&!s1(gt,dn,Rt,St,Et)||or.push(dn)}}qt+=Ir}return Nt||or.length||Lt||(or=h1(gt,qt/2,vt,St,Et,Rt,Lt,!0,zt)),or}Nn("Anchor",ap);const Sm=Ws;function f1(gt,pt,vt,St){const Et=[],Rt=gt.image,Lt=Rt.pixelRatio,Nt=Rt.paddedRect.w-2*Sm,zt=Rt.paddedRect.h-2*Sm;let jt={x1:gt.left,y1:gt.top,x2:gt.right,y2:gt.bottom};const Wt=Rt.stretchX||[[0,Nt]],qt=Rt.stretchY||[[0,zt]],ir=(on,qn)=>on+qn[1]-qn[0],or=Wt.reduce(ir,0),lr=qt.reduce(ir,0),pr=Nt-or,Tr=zt-lr;let Ir=0,Wr=or,$r=0,jr=lr,en=0,dn=pr,Ln=0,Jn=Tr;if(Rt.content&&St){const on=Rt.content,qn=on[2]-on[0],jn=on[3]-on[1];(Rt.textFitWidth||Rt.textFitHeight)&&(jt=B0(gt)),Ir=Cy(Wt,0,on[0]),$r=Cy(qt,0,on[1]),Wr=Cy(Wt,on[0],on[2]),jr=Cy(qt,on[1],on[3]),en=on[0]-Ir,Ln=on[1]-$r,dn=qn-Wr,Jn=jn-jr}const Pn=jt.x1,En=jt.y1,Hn=jt.x2-Pn,Fn=jt.y2-En,kn=(on,qn,jn,xa)=>{const Lo=Dy(on.stretch-Ir,Wr,Hn,Pn),Po=Py(on.fixed-en,dn,on.stretch,or),as=Dy(qn.stretch-$r,jr,Fn,En),Gl=Py(qn.fixed-Ln,Jn,qn.stretch,lr),Ts=Dy(jn.stretch-Ir,Wr,Hn,Pn),os=Py(jn.fixed-en,dn,jn.stretch,or),Ns=Dy(xa.stretch-$r,jr,Fn,En),Fs=Py(xa.fixed-Ln,Jn,xa.stretch,lr),Bs=new ot(Lo,as),Xo=new ot(Ts,as),ss=new ot(Ts,Ns),Ds=new ot(Lo,Ns),As=new ot(Po/Lt,Gl/Lt),zs=new ot(os/Lt,Fs/Lt),Is=pt*Math.PI/180;if(Is){const Io=Math.sin(Is),$o=Math.cos(Is),Vo=[$o,-Io,Io,$o];Bs._matMult(Vo),Xo._matMult(Vo),Ds._matMult(Vo),ss._matMult(Vo)}const Ml=on.stretch+on.fixed,Ys=qn.stretch+qn.fixed;return{tl:Bs,tr:Xo,bl:Ds,br:ss,tex:{x:Rt.paddedRect.x+Sm+Ml,y:Rt.paddedRect.y+Sm+Ys,w:jn.stretch+jn.fixed-Ml,h:xa.stretch+xa.fixed-Ys},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:As,pixelOffsetBR:zs,minFontScaleX:dn/Lt/Hn,minFontScaleY:Jn/Lt/Fn,isSDF:vt}};if(St&&(Rt.stretchX||Rt.stretchY)){const on=d1(Wt,pr,or),qn=d1(qt,Tr,lr);for(let jn=0;jn<on.length-1;jn++){const xa=on[jn],Lo=on[jn+1];for(let Po=0;Po<qn.length-1;Po++)Et.push(kn(xa,qn[Po],Lo,qn[Po+1]))}}else Et.push(kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Nt+1},{fixed:0,stretch:zt+1}));return Et}function Cy(gt,pt,vt){let St=0;for(const Et of gt)St+=Math.max(pt,Math.min(vt,Et[1]))-Math.max(pt,Math.min(vt,Et[0]));return St}function d1(gt,pt,vt){const St=[{fixed:-Sm,stretch:0}];for(const[Et,Rt]of gt){const Lt=St[St.length-1];St.push({fixed:Et-Lt.stretch,stretch:Lt.stretch}),St.push({fixed:Et-Lt.stretch,stretch:Lt.stretch+(Rt-Et)})}return St.push({fixed:pt+Sm,stretch:vt}),St}function Dy(gt,pt,vt,St){return gt/pt*vt+St}function Py(gt,pt,vt,St){return gt-pt*vt/St}class My{constructor(pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt){var qt;if(this.boxStartIndex=pt.length,jt){let ir=Lt.top,or=Lt.bottom;const lr=Lt.collisionPadding;lr&&(ir-=lr[1],or+=lr[3]);let pr=or-ir;pr>0&&(pr=Math.max(10,pr),this.circleDiameter=pr)}else{const ir=!((qt=Lt.image)===null||qt===void 0)&&qt.content&&(Lt.image.textFitWidth||Lt.image.textFitHeight)?B0(Lt):{x1:Lt.left,y1:Lt.top,x2:Lt.right,y2:Lt.bottom};ir.y1=ir.y1*Nt-zt[0],ir.y2=ir.y2*Nt+zt[2],ir.x1=ir.x1*Nt-zt[3],ir.x2=ir.x2*Nt+zt[1];const or=Lt.collisionPadding;if(or&&(ir.x1-=or[0]*Nt,ir.y1-=or[1]*Nt,ir.x2+=or[2]*Nt,ir.y2+=or[3]*Nt),Wt){const lr=new ot(ir.x1,ir.y1),pr=new ot(ir.x2,ir.y1),Tr=new ot(ir.x1,ir.y2),Ir=new ot(ir.x2,ir.y2),Wr=Wt*Math.PI/180;lr._rotate(Wr),pr._rotate(Wr),Tr._rotate(Wr),Ir._rotate(Wr),ir.x1=Math.min(lr.x,pr.x,Tr.x,Ir.x),ir.x2=Math.max(lr.x,pr.x,Tr.x,Ir.x),ir.y1=Math.min(lr.y,pr.y,Tr.y,Ir.y),ir.y2=Math.max(lr.y,pr.y,Tr.y,Ir.y)}pt.emplaceBack(vt.x,vt.y,ir.x1,ir.y1,ir.x2,ir.y2,St,Et,Rt)}this.boxEndIndex=pt.length}}class lw{constructor(pt=[],vt=(St,Et)=>St<Et?-1:St>Et?1:0){if(this.data=pt,this.length=this.data.length,this.compare=vt,this.length>0)for(let St=(this.length>>1)-1;St>=0;St--)this._down(St)}push(pt){this.data.push(pt),this._up(this.length++)}pop(){if(this.length===0)return;const pt=this.data[0],vt=this.data.pop();return--this.length>0&&(this.data[0]=vt,this._down(0)),pt}peek(){return this.data[0]}_up(pt){const{data:vt,compare:St}=this,Et=vt[pt];for(;pt>0;){const Rt=pt-1>>1,Lt=vt[Rt];if(St(Et,Lt)>=0)break;vt[pt]=Lt,pt=Rt}vt[pt]=Et}_down(pt){const{data:vt,compare:St}=this,Et=this.length>>1,Rt=vt[pt];for(;pt<Et;){let Lt=1+(pt<<1);const Nt=Lt+1;if(Nt<this.length&&St(vt[Nt],vt[Lt])<0&&(Lt=Nt),St(vt[Lt],Rt)>=0)break;vt[pt]=vt[Lt],pt=Lt}vt[pt]=Rt}}function uw(gt,pt=1,vt=!1){let St=1/0,Et=1/0,Rt=-1/0,Lt=-1/0;const Nt=gt[0];for(let or=0;or<Nt.length;or++){const lr=Nt[or];(!or||lr.x<St)&&(St=lr.x),(!or||lr.y<Et)&&(Et=lr.y),(!or||lr.x>Rt)&&(Rt=lr.x),(!or||lr.y>Lt)&&(Lt=lr.y)}const zt=Math.min(Rt-St,Lt-Et);let jt=zt/2;const Wt=new lw([],cw);if(zt===0)return new ot(St,Et);for(let or=St;or<Rt;or+=zt)for(let lr=Et;lr<Lt;lr+=zt)Wt.push(new Tm(or+jt,lr+jt,jt,gt));let qt=function(or){let lr=0,pr=0,Tr=0;const Ir=or[0];for(let Wr=0,$r=Ir.length,jr=$r-1;Wr<$r;jr=Wr++){const en=Ir[Wr],dn=Ir[jr],Ln=en.x*dn.y-dn.x*en.y;pr+=(en.x+dn.x)*Ln,Tr+=(en.y+dn.y)*Ln,lr+=3*Ln}return new Tm(pr/lr,Tr/lr,0,or)}(gt),ir=Wt.length;for(;Wt.length;){const or=Wt.pop();(or.d>qt.d||!qt.d)&&(qt=or,vt&&console.log("found best %d after %d probes",Math.round(1e4*or.d)/1e4,ir)),or.max-qt.d<=pt||(jt=or.h/2,Wt.push(new Tm(or.p.x-jt,or.p.y-jt,jt,gt)),Wt.push(new Tm(or.p.x+jt,or.p.y-jt,jt,gt)),Wt.push(new Tm(or.p.x-jt,or.p.y+jt,jt,gt)),Wt.push(new Tm(or.p.x+jt,or.p.y+jt,jt,gt)),ir+=4)}return vt&&(console.log(`num probes: ${ir}`),console.log(`best distance: ${qt.d}`)),qt.p}function cw(gt,pt){return pt.max-gt.max}function Tm(gt,pt,vt,St){this.p=new ot(gt,pt),this.h=vt,this.d=function(Et,Rt){let Lt=!1,Nt=1/0;for(let zt=0;zt<Rt.length;zt++){const jt=Rt[zt];for(let Wt=0,qt=jt.length,ir=qt-1;Wt<qt;ir=Wt++){const or=jt[Wt],lr=jt[ir];or.y>Et.y!=lr.y>Et.y&&Et.x<(lr.x-or.x)*(Et.y-or.y)/(lr.y-or.y)+or.x&&(Lt=!Lt),Nt=Math.min(Nt,X_(Et,or,lr))}}return(Lt?1:-1)*Math.sqrt(Nt)}(this.p,St),this.max=this.d+this.h*Math.SQRT2}var Ss;nt.aq=void 0,(Ss=nt.aq||(nt.aq={}))[Ss.center=1]="center",Ss[Ss.left=2]="left",Ss[Ss.right=3]="right",Ss[Ss.top=4]="top",Ss[Ss.bottom=5]="bottom",Ss[Ss["top-left"]=6]="top-left",Ss[Ss["top-right"]=7]="top-right",Ss[Ss["bottom-left"]=8]="bottom-left",Ss[Ss["bottom-right"]=9]="bottom-right";const op=7,P_=Number.POSITIVE_INFINITY;function p1(gt,pt){return pt[1]!==P_?function(vt,St,Et){let Rt=0,Lt=0;switch(St=Math.abs(St),Et=Math.abs(Et),vt){case"top-right":case"top-left":case"top":Lt=Et-op;break;case"bottom-right":case"bottom-left":case"bottom":Lt=-Et+op}switch(vt){case"top-right":case"bottom-right":case"right":Rt=-St;break;case"top-left":case"bottom-left":case"left":Rt=St}return[Rt,Lt]}(gt,pt[0],pt[1]):function(vt,St){let Et=0,Rt=0;St<0&&(St=0);const Lt=St/Math.SQRT2;switch(vt){case"top-right":case"top-left":Rt=Lt-op;break;case"bottom-right":case"bottom-left":Rt=-Lt+op;break;case"bottom":Rt=-St+op;break;case"top":Rt=St-op}switch(vt){case"top-right":case"bottom-right":Et=-Lt;break;case"top-left":case"bottom-left":Et=Lt;break;case"left":Et=St;break;case"right":Et=-St}return[Et,Rt]}(gt,pt[0])}function g1(gt,pt,vt){var St;const Et=gt.layout,Rt=(St=Et.get("text-variable-anchor-offset"))===null||St===void 0?void 0:St.evaluate(pt,{},vt);if(Rt){const Nt=Rt.values,zt=[];for(let jt=0;jt<Nt.length;jt+=2){const Wt=zt[jt]=Nt[jt],qt=Nt[jt+1].map(ir=>ir*rs);Wt.startsWith("top")?qt[1]-=op:Wt.startsWith("bottom")&&(qt[1]+=op),zt[jt+1]=qt}return new Yo(zt)}const Lt=Et.get("text-variable-anchor");if(Lt){let Nt;Nt=gt._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[Et.get("text-radial-offset").evaluate(pt,{},vt)*rs,P_]:Et.get("text-offset").evaluate(pt,{},vt).map(jt=>jt*rs);const zt=[];for(const jt of Lt)zt.push(jt,p1(jt,Nt));return new Yo(zt)}return null}function M_(gt){switch(gt){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hw(gt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt){let qt=Rt.textMaxSize.evaluate(pt,{});qt===void 0&&(qt=Lt);const ir=gt.layers[0].layout,or=ir.get("icon-offset").evaluate(pt,{},Wt),lr=y1(vt.horizontal),pr=Lt/24,Tr=gt.tilePixelRatio*pr,Ir=gt.tilePixelRatio*qt/24,Wr=gt.tilePixelRatio*Nt,$r=gt.tilePixelRatio*ir.get("symbol-spacing"),jr=ir.get("text-padding")*gt.tilePixelRatio,en=function(on,qn,jn,xa=1){const Lo=on.get("icon-padding").evaluate(qn,{},jn),Po=Lo&&Lo.values;return[Po[0]*xa,Po[1]*xa,Po[2]*xa,Po[3]*xa]}(ir,pt,Wt,gt.tilePixelRatio),dn=ir.get("text-max-angle")/180*Math.PI,Ln=ir.get("text-rotation-alignment")!=="viewport"&&ir.get("symbol-placement")!=="point",Jn=ir.get("icon-rotation-alignment")==="map"&&ir.get("symbol-placement")!=="point",Pn=ir.get("symbol-placement"),En=$r/2,Hn=ir.get("icon-text-fit");let Fn;St&&Hn!=="none"&&(gt.allowVerticalPlacement&&vt.vertical&&(Fn=z0(St,vt.vertical,Hn,ir.get("icon-text-fit-padding"),or,pr)),lr&&(St=z0(St,lr,Hn,ir.get("icon-text-fit-padding"),or,pr)));const kn=(on,qn)=>{qn.x<0||qn.x>=es||qn.y<0||qn.y>=es||function(jn,xa,Lo,Po,as,Gl,Ts,os,Ns,Fs,Bs,Xo,ss,Ds,As,zs,Is,Ml,Ys,Io,$o,Vo,xl,Ho,Am){const au=jn.addToLineVertexArray(xa,Lo);let ou,Hl,Rl,gs,Pu=0,Dv=0,w1=0,S1=0,B_=-1,z_=-1;const Mu={};let T1=cm("");if(jn.allowVerticalPlacement&&Po.vertical){const Ps=os.layout.get("text-rotate").evaluate($o,{},Ho)+90;Rl=new My(Ns,xa,Fs,Bs,Xo,Po.vertical,ss,Ds,As,Ps),Ts&&(gs=new My(Ns,xa,Fs,Bs,Xo,Ts,Is,Ml,As,Ps))}if(as){const Ps=os.layout.get("icon-rotate").evaluate($o,{}),Ll=os.layout.get("icon-text-fit")!=="none",$p=f1(as,Ps,xl,Ll),Ql=Ts?f1(Ts,Ps,xl,Ll):void 0;Hl=new My(Ns,xa,Fs,Bs,Xo,as,Is,Ml,!1,Ps),Pu=4*$p.length;const kp=jn.iconSizeData;let su=null;kp.kind==="source"?(su=[iu*os.layout.get("icon-size").evaluate($o,{})],su[0]>np&&Xt(`${jn.layerIds[0]}: Value for "icon-size" is >= ${Tv}. Reduce your "icon-size".`)):kp.kind==="composite"&&(su=[iu*Vo.compositeIconSizes[0].evaluate($o,{},Ho),iu*Vo.compositeIconSizes[1].evaluate($o,{},Ho)],(su[0]>np||su[1]>np)&&Xt(`${jn.layerIds[0]}: Value for "icon-size" is >= ${Tv}. Reduce your "icon-size".`)),jn.addSymbols(jn.icon,$p,su,Io,Ys,$o,nt.ah.none,xa,au.lineStartIndex,au.lineLength,-1,Ho),B_=jn.icon.placedSymbolArray.length-1,Ql&&(Dv=4*Ql.length,jn.addSymbols(jn.icon,Ql,su,Io,Ys,$o,nt.ah.vertical,xa,au.lineStartIndex,au.lineLength,-1,Ho),z_=jn.icon.placedSymbolArray.length-1)}const A1=Object.keys(Po.horizontal);for(const Ps of A1){const Ll=Po.horizontal[Ps];if(!ou){T1=cm(Ll.text);const Ql=os.layout.get("text-rotate").evaluate($o,{},Ho);ou=new My(Ns,xa,Fs,Bs,Xo,Ll,ss,Ds,As,Ql)}const $p=Ll.positionedLines.length===1;if(w1+=m1(jn,xa,Ll,Gl,os,As,$o,zs,au,Po.vertical?nt.ah.horizontal:nt.ah.horizontalOnly,$p?A1:[Ps],Mu,B_,Vo,Ho),$p)break}Po.vertical&&(S1+=m1(jn,xa,Po.vertical,Gl,os,As,$o,zs,au,nt.ah.vertical,["vertical"],Mu,z_,Vo,Ho));const pw=ou?ou.boxStartIndex:jn.collisionBoxArray.length,gw=ou?ou.boxEndIndex:jn.collisionBoxArray.length,mw=Rl?Rl.boxStartIndex:jn.collisionBoxArray.length,vw=Rl?Rl.boxEndIndex:jn.collisionBoxArray.length,yw=Hl?Hl.boxStartIndex:jn.collisionBoxArray.length,bw=Hl?Hl.boxEndIndex:jn.collisionBoxArray.length,xw=gs?gs.boxStartIndex:jn.collisionBoxArray.length,ww=gs?gs.boxEndIndex:jn.collisionBoxArray.length;let Jl=-1;const Ly=(Ps,Ll)=>Ps&&Ps.circleDiameter?Math.max(Ps.circleDiameter,Ll):Ll;Jl=Ly(ou,Jl),Jl=Ly(Rl,Jl),Jl=Ly(Hl,Jl),Jl=Ly(gs,Jl);const I1=Jl>-1?1:0;I1&&(Jl*=Am/rs),jn.glyphOffsetArray.length>=wm.MAX_GLYPHS&&Xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),$o.sortKey!==void 0&&jn.addToSortKeyRanges(jn.symbolInstances.length,$o.sortKey);const Sw=g1(os,$o,Ho),[Tw,Aw]=function(Ps,Ll){const $p=Ps.length,Ql=Ll?.values;if(Ql?.length>0)for(let kp=0;kp<Ql.length;kp+=2){const su=Ql[kp+1];Ps.emplaceBack(nt.aq[Ql[kp]],su[0],su[1])}return[$p,Ps.length]}(jn.textAnchorOffsets,Sw);jn.symbolInstances.emplaceBack(xa.x,xa.y,Mu.right>=0?Mu.right:-1,Mu.center>=0?Mu.center:-1,Mu.left>=0?Mu.left:-1,Mu.vertical||-1,B_,z_,T1,pw,gw,mw,vw,yw,bw,xw,ww,Fs,w1,S1,Pu,Dv,I1,0,ss,Jl,Tw,Aw)}(gt,qn,on,vt,St,Et,Fn,gt.layers[0],gt.collisionBoxArray,pt.index,pt.sourceLayerIndex,gt.index,Tr,[jr,jr,jr,jr],Ln,zt,Wr,en,Jn,or,pt,Rt,jt,Wt,Lt)};if(Pn==="line")for(const on of o1(pt.geometry,0,0,es,es)){const qn=sw(on,$r,dn,vt.vertical||lr,St,24,Ir,gt.overscaling,es);for(const jn of qn)lr&&fw(gt,lr.text,En,jn)||kn(on,jn)}else if(Pn==="line-center"){for(const on of pt.geometry)if(on.length>1){const qn=ow(on,dn,vt.vertical||lr,St,24,Ir);qn&&kn(on,qn)}}else if(pt.type==="Polygon")for(const on of zp(pt.geometry,0)){const qn=uw(on,16);kn(on[0],new ap(qn.x,qn.y,0))}else if(pt.type==="LineString")for(const on of pt.geometry)kn(on,new ap(on[0].x,on[0].y,0));else if(pt.type==="Point")for(const on of pt.geometry)for(const qn of on)kn([qn],new ap(qn.x,qn.y,0))}function m1(gt,pt,vt,St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr){const pr=function(Wr,$r,jr,en,dn,Ln,Jn,Pn){const En=en.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,Hn=[];for(const Fn of $r.positionedLines)for(const kn of Fn.positionedGlyphs){if(!kn.rect)continue;const on=kn.rect||{};let qn=R0+1,jn=!0,xa=1,Lo=0;const Po=(dn||Pn)&&kn.vertical,as=kn.metrics.advance*kn.scale/2;if(Pn&&$r.verticalizable&&(Lo=Fn.lineOffset/2-(kn.imageName?-(rs-kn.metrics.width*kn.scale)/2:(kn.scale-1)*rs)),kn.imageName){const Io=Jn[kn.imageName];jn=Io.sdf,xa=Io.pixelRatio,qn=Ws/xa}const Gl=dn?[kn.x+as,kn.y]:[0,0];let Ts=dn?[0,0]:[kn.x+as+jr[0],kn.y+jr[1]-Lo],os=[0,0];Po&&(os=Ts,Ts=[0,0]);const Ns=kn.metrics.isDoubleResolution?2:1,Fs=(kn.metrics.left-qn)*kn.scale-as+Ts[0],Bs=(-kn.metrics.top-qn)*kn.scale+Ts[1],Xo=Fs+on.w/Ns*kn.scale/xa,ss=Bs+on.h/Ns*kn.scale/xa,Ds=new ot(Fs,Bs),As=new ot(Xo,Bs),zs=new ot(Fs,ss),Is=new ot(Xo,ss);if(Po){const Io=new ot(-as,as-wv),$o=-Math.PI/2,Vo=rs/2-as,xl=new ot(5-wv-Vo,-(kn.imageName?Vo:0)),Ho=new ot(...os);Ds._rotateAround($o,Io)._add(xl)._add(Ho),As._rotateAround($o,Io)._add(xl)._add(Ho),zs._rotateAround($o,Io)._add(xl)._add(Ho),Is._rotateAround($o,Io)._add(xl)._add(Ho)}if(En){const Io=Math.sin(En),$o=Math.cos(En),Vo=[$o,-Io,Io,$o];Ds._matMult(Vo),As._matMult(Vo),zs._matMult(Vo),Is._matMult(Vo)}const Ml=new ot(0,0),Ys=new ot(0,0);Hn.push({tl:Ds,tr:As,bl:zs,br:Is,tex:on,writingMode:$r.writingMode,glyphOffset:Gl,sectionIndex:kn.sectionIndex,isSDF:jn,pixelOffsetTL:Ml,pixelOffsetBR:Ys,minFontScaleX:0,minFontScaleY:0})}return Hn}(0,vt,Nt,Et,Rt,Lt,St,gt.allowVerticalPlacement),Tr=gt.textSizeData;let Ir=null;Tr.kind==="source"?(Ir=[iu*Et.layout.get("text-size").evaluate(Lt,{})],Ir[0]>np&&Xt(`${gt.layerIds[0]}: Value for "text-size" is >= ${Tv}. Reduce your "text-size".`)):Tr.kind==="composite"&&(Ir=[iu*or.compositeTextSizes[0].evaluate(Lt,{},lr),iu*or.compositeTextSizes[1].evaluate(Lt,{},lr)],(Ir[0]>np||Ir[1]>np)&&Xt(`${gt.layerIds[0]}: Value for "text-size" is >= ${Tv}. Reduce your "text-size".`)),gt.addSymbols(gt.text,pr,Ir,Nt,Rt,Lt,jt,pt,zt.lineStartIndex,zt.lineLength,ir,lr);for(const Wr of Wt)qt[Wr]=gt.text.placedSymbolArray.length-1;return 4*pr.length}function y1(gt){for(const pt in gt)return gt[pt];return null}function fw(gt,pt,vt,St){const Et=gt.compareText;if(pt in Et){const Rt=Et[pt];for(let Lt=Rt.length-1;Lt>=0;Lt--)if(St.dist(Rt[Lt])<vt)return!0}else Et[pt]=[];return Et[pt].push(St),!1}const _1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class R_{static from(pt){if(!(pt instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[vt,St]=new Uint8Array(pt,0,2);if(vt!==219)throw new Error("Data does not appear to be in a KDBush format.");const Et=St>>4;if(Et!==1)throw new Error(`Got v${Et} data when expected v1.`);const Rt=_1[15&St];if(!Rt)throw new Error("Unrecognized array type.");const[Lt]=new Uint16Array(pt,2,1),[Nt]=new Uint32Array(pt,4,1);return new R_(Nt,Lt,Rt,pt)}constructor(pt,vt=64,St=Float64Array,Et){if(isNaN(pt)||pt<0)throw new Error(`Unpexpected numItems value: ${pt}.`);this.numItems=+pt,this.nodeSize=Math.min(Math.max(+vt,2),65535),this.ArrayType=St,this.IndexArrayType=pt<65536?Uint16Array:Uint32Array;const Rt=_1.indexOf(this.ArrayType),Lt=2*pt*this.ArrayType.BYTES_PER_ELEMENT,Nt=pt*this.IndexArrayType.BYTES_PER_ELEMENT,zt=(8-Nt%8)%8;if(Rt<0)throw new Error(`Unexpected typed array class: ${St}.`);Et&&Et instanceof ArrayBuffer?(this.data=Et,this.ids=new this.IndexArrayType(this.data,8,pt),this.coords=new this.ArrayType(this.data,8+Nt+zt,2*pt),this._pos=2*pt,this._finished=!0):(this.data=new ArrayBuffer(8+Lt+Nt+zt),this.ids=new this.IndexArrayType(this.data,8,pt),this.coords=new this.ArrayType(this.data,8+Nt+zt,2*pt),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+Rt]),new Uint16Array(this.data,2,1)[0]=vt,new Uint32Array(this.data,4,1)[0]=pt)}add(pt,vt){const St=this._pos>>1;return this.ids[St]=St,this.coords[this._pos++]=pt,this.coords[this._pos++]=vt,St}finish(){const pt=this._pos>>1;if(pt!==this.numItems)throw new Error(`Added ${pt} items when expected ${this.numItems}.`);return L_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(pt,vt,St,Et){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:Rt,coords:Lt,nodeSize:Nt}=this,zt=[0,Rt.length-1,0],jt=[];for(;zt.length;){const Wt=zt.pop()||0,qt=zt.pop()||0,ir=zt.pop()||0;if(qt-ir<=Nt){for(let Tr=ir;Tr<=qt;Tr++){const Ir=Lt[2*Tr],Wr=Lt[2*Tr+1];Ir>=pt&&Ir<=St&&Wr>=vt&&Wr<=Et&&jt.push(Rt[Tr])}continue}const or=ir+qt>>1,lr=Lt[2*or],pr=Lt[2*or+1];lr>=pt&&lr<=St&&pr>=vt&&pr<=Et&&jt.push(Rt[or]),(Wt===0?pt<=lr:vt<=pr)&&(zt.push(ir),zt.push(or-1),zt.push(1-Wt)),(Wt===0?St>=lr:Et>=pr)&&(zt.push(or+1),zt.push(qt),zt.push(1-Wt))}return jt}within(pt,vt,St){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:Et,coords:Rt,nodeSize:Lt}=this,Nt=[0,Et.length-1,0],zt=[],jt=St*St;for(;Nt.length;){const Wt=Nt.pop()||0,qt=Nt.pop()||0,ir=Nt.pop()||0;if(qt-ir<=Lt){for(let Tr=ir;Tr<=qt;Tr++)x1(Rt[2*Tr],Rt[2*Tr+1],pt,vt)<=jt&&zt.push(Et[Tr]);continue}const or=ir+qt>>1,lr=Rt[2*or],pr=Rt[2*or+1];x1(lr,pr,pt,vt)<=jt&&zt.push(Et[or]),(Wt===0?pt-St<=lr:vt-St<=pr)&&(Nt.push(ir),Nt.push(or-1),Nt.push(1-Wt)),(Wt===0?pt+St>=lr:vt+St>=pr)&&(Nt.push(or+1),Nt.push(qt),Nt.push(1-Wt))}return zt}}function L_(gt,pt,vt,St,Et,Rt){if(Et-St<=vt)return;const Lt=St+Et>>1;b1(gt,pt,Lt,St,Et,Rt),L_(gt,pt,vt,St,Lt-1,1-Rt),L_(gt,pt,vt,Lt+1,Et,1-Rt)}function b1(gt,pt,vt,St,Et,Rt){for(;Et>St;){if(Et-St>600){const jt=Et-St+1,Wt=vt-St+1,qt=Math.log(jt),ir=.5*Math.exp(2*qt/3),or=.5*Math.sqrt(qt*ir*(jt-ir)/jt)*(Wt-jt/2<0?-1:1);b1(gt,pt,vt,Math.max(St,Math.floor(vt-Wt*ir/jt+or)),Math.min(Et,Math.floor(vt+(jt-Wt)*ir/jt+or)),Rt)}const Lt=pt[2*vt+Rt];let Nt=St,zt=Et;for(Ev(gt,pt,St,vt),pt[2*Et+Rt]>Lt&&Ev(gt,pt,St,Et);Nt<zt;){for(Ev(gt,pt,Nt,zt),Nt++,zt--;pt[2*Nt+Rt]<Lt;)Nt++;for(;pt[2*zt+Rt]>Lt;)zt--}pt[2*St+Rt]===Lt?Ev(gt,pt,St,zt):(zt++,Ev(gt,pt,zt,Et)),zt<=vt&&(St=zt+1),vt<=zt&&(Et=zt-1)}}function Ev(gt,pt,vt,St){O_(gt,vt,St),O_(pt,2*vt,2*St),O_(pt,2*vt+1,2*St+1)}function O_(gt,pt,vt){const St=gt[pt];gt[pt]=gt[vt],gt[vt]=St}function x1(gt,pt,vt,St){const Et=gt-vt,Rt=pt-St;return Et*Et+Rt*Rt}var $_;nt.bg=void 0,($_=nt.bg||(nt.bg={})).create="create",$_.load="load",$_.fullLoad="fullLoad";let Ry=null,Cv=[];const k_=1e3/60,N_="loadTime",F_="fullLoadTime",dw={mark(gt){performance.mark(gt)},frame(gt){const pt=gt;Ry!=null&&Cv.push(pt-Ry),Ry=pt},clearMetrics(){Ry=null,Cv=[],performance.clearMeasures(N_),performance.clearMeasures(F_);for(const gt in nt.bg)performance.clearMarks(nt.bg[gt])},getPerformanceMetrics(){performance.measure(N_,nt.bg.create,nt.bg.load),performance.measure(F_,nt.bg.create,nt.bg.fullLoad);const gt=performance.getEntriesByName(N_)[0].duration,pt=performance.getEntriesByName(F_)[0].duration,vt=Cv.length,St=1/(Cv.reduce((Rt,Lt)=>Rt+Lt,0)/vt/1e3),Et=Cv.filter(Rt=>Rt>k_).reduce((Rt,Lt)=>Rt+(Lt-k_)/k_,0);return{loadTime:gt,fullLoadTime:pt,fps:St,percentDroppedFrames:Et/(vt+Et)*100,totalFrames:vt}}};nt.$=class extends Kt{},nt.A=gm,nt.B=Wy,nt.C=function(gt){if(nr==null){const pt=gt.navigator?gt.navigator.userAgent:null;nr=!!gt.safari||!(!pt||!(/\b(iPad|iPhone|iPod)\b/.test(pt)||pt.match("Safari")&&!pt.match("Chrome")))}return nr},nt.D=Vn,nt.E=Qn,nt.F=class{constructor(gt,pt){this.target=gt,this.mapId=pt,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new iw(()=>this.process()),this.subscription=function(vt,St,Et,Rt){return vt.addEventListener(St,Et,!1),{unsubscribe:()=>{vt.removeEventListener(St,Et,!1)}}}(this.target,"message",vt=>this.receive(vt)),this.globalScope=ar(self)?gt:window}registerMessageHandler(gt,pt){this.messageHandlers[gt]=pt}sendAsync(gt,pt){return new Promise((vt,St)=>{const Et=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[Et]={resolve:vt,reject:St},pt&&pt.signal.addEventListener("abort",()=>{delete this.resolveRejects[Et];const Nt={id:Et,type:"<cancel>",origin:location.origin,targetMapId:gt.targetMapId,sourceMapId:this.mapId};this.target.postMessage(Nt)},{once:!0});const Rt=[],Lt=Object.assign(Object.assign({},gt),{id:Et,sourceMapId:this.mapId,origin:location.origin,data:Hu(gt.data,Rt)});this.target.postMessage(Lt,{transfer:Rt})})}receive(gt){const pt=gt.data,vt=pt.id;if(!(pt.origin!=="file://"&&location.origin!=="file://"&&pt.origin!=="resource://android"&&location.origin!=="resource://android"&&pt.origin!==location.origin||pt.targetMapId&&this.mapId!==pt.targetMapId)){if(pt.type==="<cancel>"){delete this.tasks[vt];const St=this.abortControllers[vt];return delete this.abortControllers[vt],void(St&&St.abort())}if(ar(self)||pt.mustQueue)return this.tasks[vt]=pt,this.taskQueue.push(vt),void this.invoker.trigger();this.processTask(vt,pt)}}process(){if(this.taskQueue.length===0)return;const gt=this.taskQueue.shift(),pt=this.tasks[gt];delete this.tasks[gt],this.taskQueue.length>0&&this.invoker.trigger(),pt&&this.processTask(gt,pt)}processTask(gt,pt){return it(this,void 0,void 0,function*(){if(pt.type==="<response>"){const Et=this.resolveRejects[gt];return delete this.resolveRejects[gt],Et?void(pt.error?Et.reject(Wu(pt.error)):Et.resolve(Wu(pt.data))):void 0}if(!this.messageHandlers[pt.type])return void this.completeTask(gt,new Error(`Could not find a registered handler for ${pt.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const vt=Wu(pt.data),St=new AbortController;this.abortControllers[gt]=St;try{const Et=yield this.messageHandlers[pt.type](pt.sourceMapId,vt,St);this.completeTask(gt,null,Et)}catch(Et){this.completeTask(gt,Et)}})}completeTask(gt,pt,vt){const St=[];delete this.abortControllers[gt];const Et={id:gt,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:pt?Hu(pt):null,data:Hu(vt,St)};this.target.postMessage(Et,{transfer:St})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},nt.G=xn,nt.H=function(){var gt=new gm(16);return gm!=Float32Array&&(gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[6]=0,gt[7]=0,gt[8]=0,gt[9]=0,gt[11]=0,gt[12]=0,gt[13]=0,gt[14]=0),gt[0]=1,gt[5]=1,gt[10]=1,gt[15]=1,gt},nt.I=__,nt.J=function(gt,pt,vt){var St,Et,Rt,Lt,Nt,zt,jt,Wt,qt,ir,or,lr,pr=vt[0],Tr=vt[1],Ir=vt[2];return pt===gt?(gt[12]=pt[0]*pr+pt[4]*Tr+pt[8]*Ir+pt[12],gt[13]=pt[1]*pr+pt[5]*Tr+pt[9]*Ir+pt[13],gt[14]=pt[2]*pr+pt[6]*Tr+pt[10]*Ir+pt[14],gt[15]=pt[3]*pr+pt[7]*Tr+pt[11]*Ir+pt[15]):(Et=pt[1],Rt=pt[2],Lt=pt[3],Nt=pt[4],zt=pt[5],jt=pt[6],Wt=pt[7],qt=pt[8],ir=pt[9],or=pt[10],lr=pt[11],gt[0]=St=pt[0],gt[1]=Et,gt[2]=Rt,gt[3]=Lt,gt[4]=Nt,gt[5]=zt,gt[6]=jt,gt[7]=Wt,gt[8]=qt,gt[9]=ir,gt[10]=or,gt[11]=lr,gt[12]=St*pr+Nt*Tr+qt*Ir+pt[12],gt[13]=Et*pr+zt*Tr+ir*Ir+pt[13],gt[14]=Rt*pr+jt*Tr+or*Ir+pt[14],gt[15]=Lt*pr+Wt*Tr+lr*Ir+pt[15]),gt},nt.K=function(gt,pt,vt){var St=vt[0],Et=vt[1],Rt=vt[2];return gt[0]=pt[0]*St,gt[1]=pt[1]*St,gt[2]=pt[2]*St,gt[3]=pt[3]*St,gt[4]=pt[4]*Et,gt[5]=pt[5]*Et,gt[6]=pt[6]*Et,gt[7]=pt[7]*Et,gt[8]=pt[8]*Rt,gt[9]=pt[9]*Rt,gt[10]=pt[10]*Rt,gt[11]=pt[11]*Rt,gt[12]=pt[12],gt[13]=pt[13],gt[14]=pt[14],gt[15]=pt[15],gt},nt.L=e0,nt.M=function(gt,pt){const vt={};for(let St=0;St<pt.length;St++){const Et=pt[St];Et in gt&&(vt[Et]=gt[Et])}return vt},nt.N=ip,nt.O=Z0,nt.P=ot,nt.Q=X0,nt.R=Dl,nt.S=Pl,nt.T=am,nt.U=bt,nt.V=wt,nt.W=mr,nt.X=es,nt.Y=Bt,nt.Z=Av,nt._=it,nt.a=Jr,nt.a$=function(gt,pt){var vt=gt[0],St=gt[1],Et=gt[2],Rt=gt[3],Lt=gt[4],Nt=gt[5],zt=gt[6],jt=gt[7],Wt=gt[8],qt=gt[9],ir=gt[10],or=gt[11],lr=gt[12],pr=gt[13],Tr=gt[14],Ir=gt[15],Wr=pt[0],$r=pt[1],jr=pt[2],en=pt[3],dn=pt[4],Ln=pt[5],Jn=pt[6],Pn=pt[7],En=pt[8],Hn=pt[9],Fn=pt[10],kn=pt[11],on=pt[12],qn=pt[13],jn=pt[14],xa=pt[15];return Math.abs(vt-Wr)<=ks*Math.max(1,Math.abs(vt),Math.abs(Wr))&&Math.abs(St-$r)<=ks*Math.max(1,Math.abs(St),Math.abs($r))&&Math.abs(Et-jr)<=ks*Math.max(1,Math.abs(Et),Math.abs(jr))&&Math.abs(Rt-en)<=ks*Math.max(1,Math.abs(Rt),Math.abs(en))&&Math.abs(Lt-dn)<=ks*Math.max(1,Math.abs(Lt),Math.abs(dn))&&Math.abs(Nt-Ln)<=ks*Math.max(1,Math.abs(Nt),Math.abs(Ln))&&Math.abs(zt-Jn)<=ks*Math.max(1,Math.abs(zt),Math.abs(Jn))&&Math.abs(jt-Pn)<=ks*Math.max(1,Math.abs(jt),Math.abs(Pn))&&Math.abs(Wt-En)<=ks*Math.max(1,Math.abs(Wt),Math.abs(En))&&Math.abs(qt-Hn)<=ks*Math.max(1,Math.abs(qt),Math.abs(Hn))&&Math.abs(ir-Fn)<=ks*Math.max(1,Math.abs(ir),Math.abs(Fn))&&Math.abs(or-kn)<=ks*Math.max(1,Math.abs(or),Math.abs(kn))&&Math.abs(lr-on)<=ks*Math.max(1,Math.abs(lr),Math.abs(on))&&Math.abs(pr-qn)<=ks*Math.max(1,Math.abs(pr),Math.abs(qn))&&Math.abs(Tr-jn)<=ks*Math.max(1,Math.abs(Tr),Math.abs(jn))&&Math.abs(Ir-xa)<=ks*Math.max(1,Math.abs(Ir),Math.abs(xa))},nt.a0=bo,nt.a1=D_,nt.a2=gn,nt.a3=gt=>{const pt=window.document.createElement("video");return pt.muted=!0,new Promise(vt=>{pt.onloadstart=()=>{vt(pt)};for(const St of gt){const Et=window.document.createElement("source");yn(St)||(pt.crossOrigin="Anonymous"),Et.src=St,pt.appendChild(Et)}})},nt.a4=function(){return Ft++},nt.a5=Mn,nt.a6=wm,nt.a7=jm,nt.a8=Lp,nt.a9=r1,nt.aA=function(gt){if(gt.type==="custom")return new nw(gt);switch(gt.type){case"background":return new ew(gt);case"circle":return new B1(gt);case"fill":return new rx(gt);case"fill-extrusion":return new vx(gt);case"heatmap":return new V1(gt);case"hillshade":return new G1(gt);case"line":return new Ex(gt);case"raster":return new rw(gt);case"symbol":return new Ey(gt)}},nt.aB=Ht,nt.aC=function(gt,pt){if(!gt)return[{command:"setStyle",args:[pt]}];let vt=[];try{if(!Wn(gt.version,pt.version))return[{command:"setStyle",args:[pt]}];Wn(gt.center,pt.center)||vt.push({command:"setCenter",args:[pt.center]}),Wn(gt.zoom,pt.zoom)||vt.push({command:"setZoom",args:[pt.zoom]}),Wn(gt.bearing,pt.bearing)||vt.push({command:"setBearing",args:[pt.bearing]}),Wn(gt.pitch,pt.pitch)||vt.push({command:"setPitch",args:[pt.pitch]}),Wn(gt.sprite,pt.sprite)||vt.push({command:"setSprite",args:[pt.sprite]}),Wn(gt.glyphs,pt.glyphs)||vt.push({command:"setGlyphs",args:[pt.glyphs]}),Wn(gt.transition,pt.transition)||vt.push({command:"setTransition",args:[pt.transition]}),Wn(gt.light,pt.light)||vt.push({command:"setLight",args:[pt.light]}),Wn(gt.terrain,pt.terrain)||vt.push({command:"setTerrain",args:[pt.terrain]}),Wn(gt.sky,pt.sky)||vt.push({command:"setSky",args:[pt.sky]}),Wn(gt.projection,pt.projection)||vt.push({command:"setProjection",args:[pt.projection]});const St={},Et=[];(function(Lt,Nt,zt,jt){let Wt;for(Wt in Nt=Nt||{},Lt=Lt||{})Object.prototype.hasOwnProperty.call(Lt,Wt)&&(Object.prototype.hasOwnProperty.call(Nt,Wt)||xo(Wt,zt,jt));for(Wt in Nt)Object.prototype.hasOwnProperty.call(Nt,Wt)&&(Object.prototype.hasOwnProperty.call(Lt,Wt)?Wn(Lt[Wt],Nt[Wt])||(Lt[Wt].type==="geojson"&&Nt[Wt].type==="geojson"&&ls(Lt,Nt,Wt)?no(zt,{command:"setGeoJSONSourceData",args:[Wt,Nt[Wt].data]}):Mo(Wt,Nt,zt,jt)):Eo(Wt,Nt,zt))})(gt.sources,pt.sources,Et,St);const Rt=[];gt.layers&&gt.layers.forEach(Lt=>{"source"in Lt&&St[Lt.source]?vt.push({command:"removeLayer",args:[Lt.id]}):Rt.push(Lt)}),vt=vt.concat(Et),function(Lt,Nt,zt){Nt=Nt||[];const jt=(Lt=Lt||[]).map(wl),Wt=Nt.map(wl),qt=Lt.reduce(qs,{}),ir=Nt.reduce(qs,{}),or=jt.slice(),lr=Object.create(null);let pr,Tr,Ir,Wr,$r;for(let jr=0,en=0;jr<jt.length;jr++)pr=jt[jr],Object.prototype.hasOwnProperty.call(ir,pr)?en++:(no(zt,{command:"removeLayer",args:[pr]}),or.splice(or.indexOf(pr,en),1));for(let jr=0,en=0;jr<Wt.length;jr++)pr=Wt[Wt.length-1-jr],or[or.length-1-jr]!==pr&&(Object.prototype.hasOwnProperty.call(qt,pr)?(no(zt,{command:"removeLayer",args:[pr]}),or.splice(or.lastIndexOf(pr,or.length-en),1)):en++,Wr=or[or.length-jr],no(zt,{command:"addLayer",args:[ir[pr],Wr]}),or.splice(or.length-jr,0,pr),lr[pr]=!0);for(let jr=0;jr<Wt.length;jr++)if(pr=Wt[jr],Tr=qt[pr],Ir=ir[pr],!lr[pr]&&!Wn(Tr,Ir))if(Wn(Tr.source,Ir.source)&&Wn(Tr["source-layer"],Ir["source-layer"])&&Wn(Tr.type,Ir.type)){for($r in eo(Tr.layout,Ir.layout,zt,pr,null,"setLayoutProperty"),eo(Tr.paint,Ir.paint,zt,pr,null,"setPaintProperty"),Wn(Tr.filter,Ir.filter)||no(zt,{command:"setFilter",args:[pr,Ir.filter]}),Wn(Tr.minzoom,Ir.minzoom)&&Wn(Tr.maxzoom,Ir.maxzoom)||no(zt,{command:"setLayerZoomRange",args:[pr,Ir.minzoom,Ir.maxzoom]}),Tr)Object.prototype.hasOwnProperty.call(Tr,$r)&&$r!=="layout"&&$r!=="paint"&&$r!=="filter"&&$r!=="metadata"&&$r!=="minzoom"&&$r!=="maxzoom"&&($r.indexOf("paint.")===0?eo(Tr[$r],Ir[$r],zt,pr,$r.slice(6),"setPaintProperty"):Wn(Tr[$r],Ir[$r])||no(zt,{command:"setLayerProperty",args:[pr,$r,Ir[$r]]}));for($r in Ir)Object.prototype.hasOwnProperty.call(Ir,$r)&&!Object.prototype.hasOwnProperty.call(Tr,$r)&&$r!=="layout"&&$r!=="paint"&&$r!=="filter"&&$r!=="metadata"&&$r!=="minzoom"&&$r!=="maxzoom"&&($r.indexOf("paint.")===0?eo(Tr[$r],Ir[$r],zt,pr,$r.slice(6),"setPaintProperty"):Wn(Tr[$r],Ir[$r])||no(zt,{command:"setLayerProperty",args:[pr,$r,Ir[$r]]}))}else no(zt,{command:"removeLayer",args:[pr]}),Wr=or[or.lastIndexOf(pr)+1],no(zt,{command:"addLayer",args:[Ir,Wr]})}(Rt,pt.layers,vt)}catch(St){console.warn("Unable to compute style diff:",St),vt=[{command:"setStyle",args:[pt]}]}return vt},nt.aD=function(gt){const pt=[],vt=gt.id;return vt===void 0&&pt.push({message:`layers.${vt}: missing required property "id"`}),gt.render===void 0&&pt.push({message:`layers.${vt}: missing required method "render"`}),gt.renderingMode&&gt.renderingMode!=="2d"&&gt.renderingMode!=="3d"&&pt.push({message:`layers.${vt}: property "renderingMode" must be either "2d" or "3d"`}),pt},nt.aE=function gt(pt,vt){if(Array.isArray(pt)){if(!Array.isArray(vt)||pt.length!==vt.length)return!1;for(let St=0;St<pt.length;St++)if(!gt(pt[St],vt[St]))return!1;return!0}if(typeof pt=="object"&&pt!==null&&vt!==null){if(typeof vt!="object"||Object.keys(pt).length!==Object.keys(vt).length)return!1;for(const St in pt)if(!gt(pt[St],vt[St]))return!1;return!0}return pt===vt},nt.aF=kt,nt.aG=Vt,nt.aH=class extends Pp{constructor(gt,pt){super(gt,pt),this.current=0}set(gt){this.current!==gt&&(this.current=gt,this.gl.uniform1i(this.location,gt))}},nt.aI=py,nt.aJ=class extends Pp{constructor(gt,pt){super(gt,pt),this.current=M1}set(gt){if(gt[12]!==this.current[12]||gt[0]!==this.current[0])return this.current=gt,void this.gl.uniformMatrix4fv(this.location,!1,gt);for(let pt=1;pt<16;pt++)if(gt[pt]!==this.current[pt]){this.current=gt,this.gl.uniformMatrix4fv(this.location,!1,gt);break}}},nt.aK=G_,nt.aL=j_,nt.aM=ro,nt.aN=class extends Pp{constructor(gt,pt){super(gt,pt),this.current=[0,0,0]}set(gt){gt[0]===this.current[0]&&gt[1]===this.current[1]&&gt[2]===this.current[2]||(this.current=gt,this.gl.uniform3f(this.location,gt[0],gt[1],gt[2]))}},nt.aO=class extends Pp{constructor(gt,pt){super(gt,pt),this.current=[0,0]}set(gt){gt[0]===this.current[0]&&gt[1]===this.current[1]||(this.current=gt,this.gl.uniform2f(this.location,gt[0],gt[1]))}},nt.aP=function(gt,pt,vt,St,Et,Rt,Lt){var Nt=1/(pt-vt),zt=1/(St-Et),jt=1/(Rt-Lt);return gt[0]=-2*Nt,gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[5]=-2*zt,gt[6]=0,gt[7]=0,gt[8]=0,gt[9]=0,gt[10]=2*jt,gt[11]=0,gt[12]=(pt+vt)*Nt,gt[13]=(Et+St)*zt,gt[14]=(Lt+Rt)*jt,gt[15]=1,gt},nt.aQ=F1,nt.aR=class extends Br{},nt.aS=Mx,nt.aT=class extends qr{},nt.aU=s_,nt.aV=function(gt){return gt<=1?1:Math.pow(2,Math.ceil(Math.log(gt)/Math.LN2))},nt.aW=a0,nt.aX=xs,nt.aY=Cl,nt.aZ=class extends Un{},nt.a_=function(gt,pt){return gt[0]===pt[0]&&gt[1]===pt[1]&&gt[2]===pt[2]&&gt[3]===pt[3]&&gt[4]===pt[4]&&gt[5]===pt[5]&&gt[6]===pt[6]&&gt[7]===pt[7]&&gt[8]===pt[8]&&gt[9]===pt[9]&&gt[10]===pt[10]&&gt[11]===pt[11]&&gt[12]===pt[12]&&gt[13]===pt[13]&&gt[14]===pt[14]&&gt[15]===pt[15]},nt.aa=function(gt){const pt={};if(gt.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(vt,St,Et,Rt)=>{const Lt=Et||Rt;return pt[St]=!Lt||Lt.toLowerCase(),""}),pt["max-age"]){const vt=parseInt(pt["max-age"],10);isNaN(vt)?delete pt["max-age"]:pt["max-age"]=vt}return pt},nt.ab=function(gt,pt){const vt=[];for(const St in gt)St in pt||vt.push(St);return vt},nt.ac=Dt,nt.ad=function(gt,pt,vt){var St=Math.sin(vt),Et=Math.cos(vt),Rt=pt[0],Lt=pt[1],Nt=pt[2],zt=pt[3],jt=pt[4],Wt=pt[5],qt=pt[6],ir=pt[7];return pt!==gt&&(gt[8]=pt[8],gt[9]=pt[9],gt[10]=pt[10],gt[11]=pt[11],gt[12]=pt[12],gt[13]=pt[13],gt[14]=pt[14],gt[15]=pt[15]),gt[0]=Rt*Et+jt*St,gt[1]=Lt*Et+Wt*St,gt[2]=Nt*Et+qt*St,gt[3]=zt*Et+ir*St,gt[4]=jt*Et-Rt*St,gt[5]=Wt*Et-Lt*St,gt[6]=qt*Et-Nt*St,gt[7]=ir*Et-zt*St,gt},nt.ae=function(gt){var pt=new gm(16);return pt[0]=gt[0],pt[1]=gt[1],pt[2]=gt[2],pt[3]=gt[3],pt[4]=gt[4],pt[5]=gt[5],pt[6]=gt[6],pt[7]=gt[7],pt[8]=gt[8],pt[9]=gt[9],pt[10]=gt[10],pt[11]=gt[11],pt[12]=gt[12],pt[13]=gt[13],pt[14]=gt[14],pt[15]=gt[15],pt},nt.af=yy,nt.ag=function(gt,pt){let vt=0,St=0;if(gt.kind==="constant")St=gt.layoutSize;else if(gt.kind!=="source"){const{interpolationType:Et,minZoom:Rt,maxZoom:Lt}=gt,Nt=Et?Dt(ds.interpolationFactor(Et,pt,Rt,Lt),0,1):0;gt.kind==="camera"?St=fs.number(gt.minSize,gt.maxSize,Nt):vt=Nt}return{uSizeT:vt,uSize:St}},nt.ai=function(gt,{uSize:pt,uSizeT:vt},{lowerSize:St,upperSize:Et}){return gt.kind==="source"?St/iu:gt.kind==="composite"?fs.number(St/iu,Et/iu,vt):pt},nt.aj=S_,nt.ak=function(gt,pt,vt,St){const Et=pt.y-gt.y,Rt=pt.x-gt.x,Lt=St.y-vt.y,Nt=St.x-vt.x,zt=Lt*Rt-Nt*Et;if(zt===0)return null;const jt=(Nt*(gt.y-vt.y)-Lt*(gt.x-vt.x))/zt;return new ot(gt.x+jt*Rt,gt.y+jt*Et)},nt.al=o1,nt.am=q_,nt.an=i_,nt.ao=function(gt){let pt=1/0,vt=1/0,St=-1/0,Et=-1/0;for(const Rt of gt)pt=Math.min(pt,Rt.x),vt=Math.min(vt,Rt.y),St=Math.max(St,Rt.x),Et=Math.max(Et,Rt.y);return[pt,vt,St,Et]},nt.ap=rs,nt.ar=w_,nt.as=function(gt,pt){var vt=pt[0],St=pt[1],Et=pt[2],Rt=pt[3],Lt=pt[4],Nt=pt[5],zt=pt[6],jt=pt[7],Wt=pt[8],qt=pt[9],ir=pt[10],or=pt[11],lr=pt[12],pr=pt[13],Tr=pt[14],Ir=pt[15],Wr=vt*Nt-St*Lt,$r=vt*zt-Et*Lt,jr=vt*jt-Rt*Lt,en=St*zt-Et*Nt,dn=St*jt-Rt*Nt,Ln=Et*jt-Rt*zt,Jn=Wt*pr-qt*lr,Pn=Wt*Tr-ir*lr,En=Wt*Ir-or*lr,Hn=qt*Tr-ir*pr,Fn=qt*Ir-or*pr,kn=ir*Ir-or*Tr,on=Wr*kn-$r*Fn+jr*Hn+en*En-dn*Pn+Ln*Jn;return on?(gt[0]=(Nt*kn-zt*Fn+jt*Hn)*(on=1/on),gt[1]=(Et*Fn-St*kn-Rt*Hn)*on,gt[2]=(pr*Ln-Tr*dn+Ir*en)*on,gt[3]=(ir*dn-qt*Ln-or*en)*on,gt[4]=(zt*En-Lt*kn-jt*Pn)*on,gt[5]=(vt*kn-Et*En+Rt*Pn)*on,gt[6]=(Tr*jr-lr*Ln-Ir*$r)*on,gt[7]=(Wt*Ln-ir*jr+or*$r)*on,gt[8]=(Lt*Fn-Nt*En+jt*Jn)*on,gt[9]=(St*En-vt*Fn-Rt*Jn)*on,gt[10]=(lr*dn-pr*jr+Ir*Wr)*on,gt[11]=(qt*jr-Wt*dn-or*Wr)*on,gt[12]=(Nt*Pn-Lt*Hn-zt*Jn)*on,gt[13]=(vt*Hn-St*Pn+Et*Jn)*on,gt[14]=(pr*$r-lr*en-Tr*Wr)*on,gt[15]=(Wt*en-qt*$r+ir*Wr)*on,gt):null},nt.at=M_,nt.au=x_,nt.av=R_,nt.aw=function(){const gt={},pt=zr.$version;for(const vt in zr.$root){const St=zr.$root[vt];if(St.required){let Et=null;Et=vt==="version"?pt:St.type==="array"?[]:{},Et!=null&&(gt[vt]=Et)}}return gt},nt.ax=iv,nt.ay=hn,nt.az=function(gt){gt=gt.slice();const pt=Object.create(null);for(let vt=0;vt<gt.length;vt++)pt[gt[vt].id]=gt[vt];for(let vt=0;vt<gt.length;vt++)"ref"in gt[vt]&&(gt[vt]=oo(gt[vt],pt[gt[vt].ref]));return gt},nt.b=cr,nt.b0=function(gt,pt){return gt[0]=pt[0],gt[1]=pt[1],gt[2]=pt[2],gt[3]=pt[3],gt[4]=pt[4],gt[5]=pt[5],gt[6]=pt[6],gt[7]=pt[7],gt[8]=pt[8],gt[9]=pt[9],gt[10]=pt[10],gt[11]=pt[11],gt[12]=pt[12],gt[13]=pt[13],gt[14]=pt[14],gt[15]=pt[15],gt},nt.b1=function(gt,pt,vt){return gt[0]=pt[0]*vt[0],gt[1]=pt[1]*vt[1],gt[2]=pt[2]*vt[2],gt[3]=pt[3]*vt[3],gt},nt.b2=function(gt,pt){return gt[0]*pt[0]+gt[1]*pt[1]+gt[2]*pt[2]+gt[3]*pt[3]},nt.b3=Ot,nt.b4=Q0,nt.b5=K0,nt.b6=function(gt,pt,vt,St,Et){var Rt,Lt=1/Math.tan(pt/2);return gt[0]=Lt/vt,gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[5]=Lt,gt[6]=0,gt[7]=0,gt[8]=0,gt[9]=0,gt[11]=-1,gt[12]=0,gt[13]=0,gt[15]=0,Et!=null&&Et!==1/0?(gt[10]=(Et+St)*(Rt=1/(St-Et)),gt[14]=2*Et*St*Rt):(gt[10]=-1,gt[14]=-2*St),gt},nt.b7=function(gt,pt,vt){var St=Math.sin(vt),Et=Math.cos(vt),Rt=pt[4],Lt=pt[5],Nt=pt[6],zt=pt[7],jt=pt[8],Wt=pt[9],qt=pt[10],ir=pt[11];return pt!==gt&&(gt[0]=pt[0],gt[1]=pt[1],gt[2]=pt[2],gt[3]=pt[3],gt[12]=pt[12],gt[13]=pt[13],gt[14]=pt[14],gt[15]=pt[15]),gt[4]=Rt*Et+jt*St,gt[5]=Lt*Et+Wt*St,gt[6]=Nt*Et+qt*St,gt[7]=zt*Et+ir*St,gt[8]=jt*Et-Rt*St,gt[9]=Wt*Et-Lt*St,gt[10]=qt*Et-Nt*St,gt[11]=ir*Et-zt*St,gt},nt.b8=Tt,nt.b9=Ct,nt.bA=A0,nt.bB=function(gt){return gt.message===Yr},nt.bC=Bu,nt.bD=js,nt.ba=function(gt){return gt*Math.PI/180},nt.bb=function(gt,pt){const{x:vt,y:St}=Av.fromLngLat(pt);return!(gt<0||gt>25||St<0||St>=1||vt<0||vt>=1)},nt.bc=function(gt,pt){return gt[0]=pt[0],gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[5]=pt[1],gt[6]=0,gt[7]=0,gt[8]=0,gt[9]=0,gt[10]=pt[2],gt[11]=0,gt[12]=0,gt[13]=0,gt[14]=0,gt[15]=1,gt},nt.bd=class extends Yt{},nt.be=E_,nt.bf=dw,nt.bh=Rn,nt.bi=function(gt,pt){Jr.REGISTERED_PROTOCOLS[gt]=pt},nt.bj=function(gt){delete Jr.REGISTERED_PROTOCOLS[gt]},nt.bk=function(gt,pt){const vt={};for(let Et=0;Et<gt.length;Et++){const Rt=pt&&pt[gt[Et].id]||ry(gt[Et]);pt&&(pt[gt[Et].id]=Rt);let Lt=vt[Rt];Lt||(Lt=vt[Rt]=[]),Lt.push(gt[Et])}const St=[];for(const Et in vt)St.push(vt[Et]);return St},nt.bl=Nn,nt.bm=t1,nt.bn=n1,nt.bo=O0,nt.bp=function(gt){gt.bucket.createArrays(),gt.bucket.tilePixelRatio=es/(512*gt.bucket.overscaling),gt.bucket.compareText={},gt.bucket.iconsNeedLinear=!1;const pt=gt.bucket.layers[0],vt=pt.layout,St=pt._unevaluatedLayout._values,Et={layoutIconSize:St["icon-size"].possiblyEvaluate(new No(gt.bucket.zoom+1),gt.canonical),layoutTextSize:St["text-size"].possiblyEvaluate(new No(gt.bucket.zoom+1),gt.canonical),textMaxSize:St["text-size"].possiblyEvaluate(new No(18))};if(gt.bucket.textSizeData.kind==="composite"){const{minZoom:jt,maxZoom:Wt}=gt.bucket.textSizeData;Et.compositeTextSizes=[St["text-size"].possiblyEvaluate(new No(jt),gt.canonical),St["text-size"].possiblyEvaluate(new No(Wt),gt.canonical)]}if(gt.bucket.iconSizeData.kind==="composite"){const{minZoom:jt,maxZoom:Wt}=gt.bucket.iconSizeData;Et.compositeIconSizes=[St["icon-size"].possiblyEvaluate(new No(jt),gt.canonical),St["icon-size"].possiblyEvaluate(new No(Wt),gt.canonical)]}const Rt=vt.get("text-line-height")*rs,Lt=vt.get("text-rotation-alignment")!=="viewport"&&vt.get("symbol-placement")!=="point",Nt=vt.get("text-keep-upright"),zt=vt.get("text-size");for(const jt of gt.bucket.features){const Wt=vt.get("text-font").evaluate(jt,{},gt.canonical).join(","),qt=zt.evaluate(jt,{},gt.canonical),ir=Et.layoutTextSize.evaluate(jt,{},gt.canonical),or=Et.layoutIconSize.evaluate(jt,{},gt.canonical),lr={horizontal:{},vertical:void 0},pr=jt.text;let Tr,Ir=[0,0];if(pr){const jr=pr.toString(),en=vt.get("text-letter-spacing").evaluate(jt,{},gt.canonical)*rs,dn=Yy(jr)?en:0,Ln=vt.get("text-anchor").evaluate(jt,{},gt.canonical),Jn=g1(pt,jt,gt.canonical);if(!Jn){const Fn=vt.get("text-radial-offset").evaluate(jt,{},gt.canonical);Ir=Fn?p1(Ln,[Fn*rs,P_]):vt.get("text-offset").evaluate(jt,{},gt.canonical).map(kn=>kn*rs)}let Pn=Lt?"center":vt.get("text-justify").evaluate(jt,{},gt.canonical);const En=vt.get("symbol-placement")==="point"?vt.get("text-max-width").evaluate(jt,{},gt.canonical)*rs:1/0,Hn=()=>{gt.bucket.allowVerticalPlacement&&av(jr)&&(lr.vertical=Ty(pr,gt.glyphMap,gt.glyphPositions,gt.imagePositions,Wt,En,Rt,Ln,"left",dn,Ir,nt.ah.vertical,!0,ir,qt))};if(!Lt&&Jn){const Fn=new Set;if(Pn==="auto")for(let on=0;on<Jn.values.length;on+=2)Fn.add(M_(Jn.values[on]));else Fn.add(Pn);let kn=!1;for(const on of Fn)if(!lr.horizontal[on])if(kn)lr.horizontal[on]=lr.horizontal[0];else{const qn=Ty(pr,gt.glyphMap,gt.glyphPositions,gt.imagePositions,Wt,En,Rt,"center",on,dn,Ir,nt.ah.horizontal,!1,ir,qt);qn&&(lr.horizontal[on]=qn,kn=qn.positionedLines.length===1)}Hn()}else{Pn==="auto"&&(Pn=M_(Ln));const Fn=Ty(pr,gt.glyphMap,gt.glyphPositions,gt.imagePositions,Wt,En,Rt,Ln,Pn,dn,Ir,nt.ah.horizontal,!1,ir,qt);Fn&&(lr.horizontal[Pn]=Fn),Hn(),av(jr)&&Lt&&Nt&&(lr.vertical=Ty(pr,gt.glyphMap,gt.glyphPositions,gt.imagePositions,Wt,En,Rt,Ln,Pn,dn,Ir,nt.ah.vertical,!1,ir,qt))}}let Wr=!1;if(jt.icon&&jt.icon.name){const jr=gt.imageMap[jt.icon.name];jr&&(Tr=Zx(gt.imagePositions[jt.icon.name],vt.get("icon-offset").evaluate(jt,{},gt.canonical),vt.get("icon-anchor").evaluate(jt,{},gt.canonical)),Wr=!!jr.sdf,gt.bucket.sdfIcons===void 0?gt.bucket.sdfIcons=Wr:gt.bucket.sdfIcons!==Wr&&Xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(jr.pixelRatio!==gt.bucket.pixelRatio||vt.get("icon-rotate").constantOr(1)!==0)&&(gt.bucket.iconsNeedLinear=!0))}const $r=y1(lr.horizontal)||lr.vertical;gt.bucket.iconsInText=!!$r&&$r.iconsInText,($r||Tr)&&hw(gt.bucket,jt,lr,Tr,gt.imageMap,Et,ir,or,Ir,Wr,gt.canonical)}gt.showCollisionBoxes&&gt.bucket.generateCollisionDebugBuffers()},nt.bq=g_,nt.br=f_,nt.bs=p_,nt.bt=tp,nt.bu=v_,nt.bv=class{constructor(gt){this._marks={start:[gt.url,"start"].join("#"),end:[gt.url,"end"].join("#"),measure:gt.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let gt=performance.getEntriesByName(this._marks.measure);return gt.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),gt=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),gt}},nt.bw=function(gt,pt,vt,St,Et){return it(this,void 0,void 0,function*(){if(wt())try{return yield mr(gt,pt,vt,St,Et)}catch{}return function(Rt,Lt,Nt,zt,jt){const Wt=Rt.width,qt=Rt.height;Dr&&kr||(Dr=new OffscreenCanvas(Wt,qt),kr=Dr.getContext("2d",{willReadFrequently:!0})),Dr.width=Wt,Dr.height=qt,kr.drawImage(Rt,0,0,Wt,qt);const ir=kr.getImageData(Lt,Nt,zt,jt);return kr.clearRect(0,0,Wt,qt),ir.data}(gt,pt,vt,St,Et)})},nt.bx=e1,nt.by=st,nt.bz=ut,nt.c=Mr,nt.d=gt=>it(void 0,void 0,void 0,function*(){if(gt.byteLength===0)return createImageBitmap(new ImageData(1,1));const pt=new Blob([new Uint8Array(gt)],{type:"image/png"});try{return createImageBitmap(pt)}catch(vt){throw new Error(`Could not load image because of ${vt.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),nt.e=$t,nt.f=gt=>new Promise((pt,vt)=>{const St=new Image;St.onload=()=>{pt(St),URL.revokeObjectURL(St.src),St.onload=null,window.requestAnimationFrame(()=>{St.src=dr})},St.onerror=()=>vt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Et=new Blob([new Uint8Array(gt)],{type:"image/png"});St.src=gt.byteLength?URL.createObjectURL(Et):dr}),nt.g=an,nt.h=(gt,pt)=>pn($t(gt,{type:"json"}),pt),nt.i=ar,nt.j=Dn,nt.k=Bn,nt.l=(gt,pt)=>pn($t(gt,{type:"arrayBuffer"}),pt),nt.m=pn,nt.n=function(gt){return new v_(gt).readFields(Ux,[])},nt.o=pv,nt.p=L0,nt.q=Mt,nt.r=Hy,nt.s=yn,nt.t=rv,nt.u=Iu,nt.v=zr,nt.w=Xt,nt.x=function([gt,pt,vt]){return pt+=90,pt*=Math.PI/180,vt*=Math.PI/180,{x:gt*Math.cos(pt)*Math.sin(vt),y:gt*Math.sin(pt)*Math.sin(vt),z:gt*Math.cos(vt)}},nt.y=fs,nt.z=No}),d("worker",["./shared"],function(nt){class it{constructor(er){this.keyCache={},er&&this.replace(er)}replace(er){this._layerConfigs={},this._layers={},this.update(er,[])}update(er,tr){for(const wr of er){this._layerConfigs[wr.id]=wr;const Lr=this._layers[wr.id]=nt.aA(wr);Lr._featureFilter=nt.a7(Lr.filter),this.keyCache[wr.id]&&delete this.keyCache[wr.id]}for(const wr of tr)delete this.keyCache[wr],delete this._layerConfigs[wr],delete this._layers[wr];this.familiesBySource={};const fr=nt.bk(Object.values(this._layerConfigs),this.keyCache);for(const wr of fr){const Lr=wr.map(Kr=>this._layers[Kr.id]),Fr=Lr[0];if(Fr.visibility==="none")continue;const Hr=Fr.source||"";let Pr=this.familiesBySource[Hr];Pr||(Pr=this.familiesBySource[Hr]={});const Qr=Fr.sourceLayer||"_geojsonTileLayer";let sn=Pr[Qr];sn||(sn=Pr[Qr]=[]),sn.push(Lr)}}}class st{constructor(er){const tr={},fr=[];for(const Hr in er){const Pr=er[Hr],Qr=tr[Hr]={};for(const sn in Pr){const Kr=Pr[+sn];if(!Kr||Kr.bitmap.width===0||Kr.bitmap.height===0)continue;const vn={x:0,y:0,w:Kr.bitmap.width+2,h:Kr.bitmap.height+2};fr.push(vn),Qr[sn]={rect:vn,metrics:Kr.metrics}}}const{w:wr,h:Lr}=nt.p(fr),Fr=new nt.o({width:wr||1,height:Lr||1});for(const Hr in er){const Pr=er[Hr];for(const Qr in Pr){const sn=Pr[+Qr];if(!sn||sn.bitmap.width===0||sn.bitmap.height===0)continue;const Kr=tr[Hr][Qr].rect;nt.o.copy(sn.bitmap,Fr,{x:0,y:0},{x:Kr.x+1,y:Kr.y+1},sn.bitmap)}}this.image=Fr,this.positions=tr}}nt.bl("GlyphAtlas",st);class ut{constructor(er){this.tileID=new nt.S(er.tileID.overscaledZ,er.tileID.wrap,er.tileID.canonical.z,er.tileID.canonical.x,er.tileID.canonical.y),this.uid=er.uid,this.zoom=er.zoom,this.pixelRatio=er.pixelRatio,this.tileSize=er.tileSize,this.source=er.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=er.showCollisionBoxes,this.collectResourceTiming=!!er.collectResourceTiming,this.returnDependencies=!!er.returnDependencies,this.promoteId=er.promoteId,this.inFlightDependencies=[]}parse(er,tr,fr,wr){return nt._(this,void 0,void 0,function*(){this.status="parsing",this.data=er,this.collisionBoxArray=new nt.a5;const Lr=new nt.bm(Object.keys(er.layers).sort()),Fr=new nt.bn(this.tileID,this.promoteId);Fr.bucketLayerIDs=[];const Hr={},Pr={featureIndex:Fr,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fr},Qr=tr.familiesBySource[this.source];for(const Vr in Qr){const Xr=er.layers[Vr];if(!Xr)continue;Xr.version===1&&nt.w(`Vector tile source "${this.source}" layer "${Vr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const cn=Lr.encode(Vr),$n=[];for(let An=0;An<Xr.length;An++){const na=Xr.feature(An),wo=Fr.getId(na,Vr);$n.push({feature:na,id:wo,index:An,sourceLayerIndex:cn})}for(const An of Qr[Vr]){const na=An[0];na.source!==this.source&&nt.w(`layer.source = ${na.source} does not equal this.source = ${this.source}`),na.minzoom&&this.zoom<Math.floor(na.minzoom)||na.maxzoom&&this.zoom>=na.maxzoom||na.visibility!=="none"&&(ct(An,this.zoom,fr),(Hr[na.id]=na.createBucket({index:Fr.bucketLayerIDs.length,layers:An,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:cn,sourceID:this.source})).populate($n,Pr,this.tileID.canonical),Fr.bucketLayerIDs.push(An.map(wo=>wo.id)))}}const sn=nt.aF(Pr.glyphDependencies,Vr=>Object.keys(Vr).map(Number));this.inFlightDependencies.forEach(Vr=>Vr?.abort()),this.inFlightDependencies=[];let Kr=Promise.resolve({});if(Object.keys(sn).length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),Kr=wr.sendAsync({type:"GG",data:{stacks:sn,source:this.source,tileID:this.tileID,type:"glyphs"}},Vr)}const vn=Object.keys(Pr.iconDependencies);let zn=Promise.resolve({});if(vn.length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),zn=wr.sendAsync({type:"GI",data:{icons:vn,source:this.source,tileID:this.tileID,type:"icons"}},Vr)}const Yn=Object.keys(Pr.patternDependencies);let po=Promise.resolve({});if(Yn.length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),po=wr.sendAsync({type:"GI",data:{icons:Yn,source:this.source,tileID:this.tileID,type:"patterns"}},Vr)}const[ga,ur,br]=yield Promise.all([Kr,zn,po]),Nr=new st(ga),Ur=new nt.bo(ur,br);for(const Vr in Hr){const Xr=Hr[Vr];Xr instanceof nt.a6?(ct(Xr.layers,this.zoom,fr),nt.bp({bucket:Xr,glyphMap:ga,glyphPositions:Nr.positions,imageMap:ur,imagePositions:Ur.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Xr.hasPattern&&(Xr instanceof nt.bq||Xr instanceof nt.br||Xr instanceof nt.bs)&&(ct(Xr.layers,this.zoom,fr),Xr.addFeatures(Pr,this.tileID.canonical,Ur.patternPositions))}return this.status="done",{buckets:Object.values(Hr).filter(Vr=>!Vr.isEmpty()),featureIndex:Fr,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Nr.image,imageAtlas:Ur,glyphMap:this.returnDependencies?ga:null,iconMap:this.returnDependencies?ur:null,glyphPositions:this.returnDependencies?Nr.positions:null}})}}function ct(yr,er,tr){const fr=new nt.z(er);for(const wr of yr)wr.recalculate(fr,tr)}class ot{constructor(er,tr,fr){this.actor=er,this.layerIndex=tr,this.availableImages=fr,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(er,tr){return nt._(this,void 0,void 0,function*(){const fr=yield nt.l(er.request,tr);try{return{vectorTile:new nt.bt.VectorTile(new nt.bu(fr.data)),rawData:fr.data,cacheControl:fr.cacheControl,expires:fr.expires}}catch(wr){const Lr=new Uint8Array(fr.data);let Fr=`Unable to parse the tile at ${er.request.url}, `;throw Fr+=Lr[0]===31&&Lr[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${wr.message}`,new Error(Fr)}})}loadTile(er){return nt._(this,void 0,void 0,function*(){const tr=er.uid,fr=!!(er&&er.request&&er.request.collectResourceTiming)&&new nt.bv(er.request),wr=new ut(er);this.loading[tr]=wr;const Lr=new AbortController;wr.abort=Lr;try{const Fr=yield this.loadVectorTile(er,Lr);if(delete this.loading[tr],!Fr)return null;const Hr=Fr.rawData,Pr={};Fr.expires&&(Pr.expires=Fr.expires),Fr.cacheControl&&(Pr.cacheControl=Fr.cacheControl);const Qr={};if(fr){const Kr=fr.finish();Kr&&(Qr.resourceTiming=JSON.parse(JSON.stringify(Kr)))}wr.vectorTile=Fr.vectorTile;const sn=wr.parse(Fr.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[tr]=wr,this.fetching[tr]={rawTileData:Hr,cacheControl:Pr,resourceTiming:Qr};try{const Kr=yield sn;return nt.e({rawTileData:Hr.slice(0)},Kr,Pr,Qr)}finally{delete this.fetching[tr]}}catch(Fr){throw delete this.loading[tr],wr.status="done",this.loaded[tr]=wr,Fr}})}reloadTile(er){return nt._(this,void 0,void 0,function*(){const tr=er.uid;if(!this.loaded||!this.loaded[tr])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const fr=this.loaded[tr];if(fr.showCollisionBoxes=er.showCollisionBoxes,fr.status==="parsing"){const wr=yield fr.parse(fr.vectorTile,this.layerIndex,this.availableImages,this.actor);let Lr;if(this.fetching[tr]){const{rawTileData:Fr,cacheControl:Hr,resourceTiming:Pr}=this.fetching[tr];delete this.fetching[tr],Lr=nt.e({rawTileData:Fr.slice(0)},wr,Hr,Pr)}else Lr=wr;return Lr}if(fr.status==="done"&&fr.vectorTile)return fr.parse(fr.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(er){return nt._(this,void 0,void 0,function*(){const tr=this.loading,fr=er.uid;tr&&tr[fr]&&tr[fr].abort&&(tr[fr].abort.abort(),delete tr[fr])})}removeTile(er){return nt._(this,void 0,void 0,function*(){this.loaded&&this.loaded[er.uid]&&delete this.loaded[er.uid]})}}class at{constructor(){this.loaded={}}loadTile(er){return nt._(this,void 0,void 0,function*(){const{uid:tr,encoding:fr,rawImageData:wr,redFactor:Lr,greenFactor:Fr,blueFactor:Hr,baseShift:Pr}=er,Qr=wr.width+2,sn=wr.height+2,Kr=nt.b(wr)?new nt.R({width:Qr,height:sn},yield nt.bw(wr,-1,-1,Qr,sn)):wr,vn=new nt.bx(tr,Kr,fr,Lr,Fr,Hr,Pr);return this.loaded=this.loaded||{},this.loaded[tr]=vn,vn})}removeTile(er){const tr=this.loaded,fr=er.uid;tr&&tr[fr]&&delete tr[fr]}}function ht(yr,er){if(yr.length!==0){ft(yr[0],er);for(var tr=1;tr<yr.length;tr++)ft(yr[tr],!er)}}function ft(yr,er){for(var tr=0,fr=0,wr=0,Lr=yr.length,Fr=Lr-1;wr<Lr;Fr=wr++){var Hr=(yr[wr][0]-yr[Fr][0])*(yr[Fr][1]+yr[wr][1]),Pr=tr+Hr;fr+=Math.abs(tr)>=Math.abs(Hr)?tr-Pr+Hr:Hr-Pr+tr,tr=Pr}tr+fr>=0!=!!er&&yr.reverse()}var mt=nt.by(function yr(er,tr){var fr,wr=er&&er.type;if(wr==="FeatureCollection")for(fr=0;fr<er.features.length;fr++)yr(er.features[fr],tr);else if(wr==="GeometryCollection")for(fr=0;fr<er.geometries.length;fr++)yr(er.geometries[fr],tr);else if(wr==="Feature")yr(er.geometry,tr);else if(wr==="Polygon")ht(er.coordinates,tr);else if(wr==="MultiPolygon")for(fr=0;fr<er.coordinates.length;fr++)ht(er.coordinates[fr],tr);return er});const yt=nt.bt.VectorTileFeature.prototype.toGeoJSON;var bt={exports:{}},wt=nt.bz,Tt=nt.bt.VectorTileFeature,Ct=Dt;function Dt(yr,er){this.options=er||{},this.features=yr,this.length=yr.length}function Ot(yr,er){this.id=typeof yr.id=="number"?yr.id:void 0,this.type=yr.type,this.rawGeometry=yr.type===1?[yr.geometry]:yr.geometry,this.properties=yr.tags,this.extent=er||4096}Dt.prototype.feature=function(yr){return new Ot(this.features[yr],this.options.extent)},Ot.prototype.loadGeometry=function(){var yr=this.rawGeometry;this.geometry=[];for(var er=0;er<yr.length;er++){for(var tr=yr[er],fr=[],wr=0;wr<tr.length;wr++)fr.push(new wt(tr[wr][0],tr[wr][1]));this.geometry.push(fr)}return this.geometry},Ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var yr=this.geometry,er=1/0,tr=-1/0,fr=1/0,wr=-1/0,Lr=0;Lr<yr.length;Lr++)for(var Fr=yr[Lr],Hr=0;Hr<Fr.length;Hr++){var Pr=Fr[Hr];er=Math.min(er,Pr.x),tr=Math.max(tr,Pr.x),fr=Math.min(fr,Pr.y),wr=Math.max(wr,Pr.y)}return[er,fr,tr,wr]},Ot.prototype.toGeoJSON=Tt.prototype.toGeoJSON;var $t=nt.bA,Ft=Ct;function kt(yr){var er=new $t;return function(tr,fr){for(var wr in tr.layers)fr.writeMessage(3,Vt,tr.layers[wr])}(yr,er),er.finish()}function Vt(yr,er){var tr;er.writeVarintField(15,yr.version||1),er.writeStringField(1,yr.name||""),er.writeVarintField(5,yr.extent||4096);var fr={keys:[],values:[],keycache:{},valuecache:{}};for(tr=0;tr<yr.length;tr++)fr.feature=yr.feature(tr),er.writeMessage(2,Ht,fr);var wr=fr.keys;for(tr=0;tr<wr.length;tr++)er.writeStringField(3,wr[tr]);var Lr=fr.values;for(tr=0;tr<Lr.length;tr++)er.writeMessage(4,nr,Lr[tr])}function Ht(yr,er){var tr=yr.feature;tr.id!==void 0&&er.writeVarintField(1,tr.id),er.writeMessage(2,Qt,yr),er.writeVarintField(3,tr.type),er.writeMessage(4,ar,tr)}function Qt(yr,er){var tr=yr.feature,fr=yr.keys,wr=yr.values,Lr=yr.keycache,Fr=yr.valuecache;for(var Hr in tr.properties){var Pr=tr.properties[Hr],Qr=Lr[Hr];if(Pr!==null){Qr===void 0&&(fr.push(Hr),Lr[Hr]=Qr=fr.length-1),er.writeVarint(Qr);var sn=typeof Pr;sn!=="string"&&sn!=="boolean"&&sn!=="number"&&(Pr=JSON.stringify(Pr));var Kr=sn+":"+Pr,vn=Fr[Kr];vn===void 0&&(wr.push(Pr),Fr[Kr]=vn=wr.length-1),er.writeVarint(vn)}}}function Xt(yr,er){return(er<<3)+(7&yr)}function Zt(yr){return yr<<1^yr>>31}function ar(yr,er){for(var tr=yr.loadGeometry(),fr=yr.type,wr=0,Lr=0,Fr=tr.length,Hr=0;Hr<Fr;Hr++){var Pr=tr[Hr],Qr=1;fr===1&&(Qr=Pr.length),er.writeVarint(Xt(1,Qr));for(var sn=fr===3?Pr.length-1:Pr.length,Kr=0;Kr<sn;Kr++){Kr===1&&fr!==1&&er.writeVarint(Xt(2,sn-1));var vn=Pr[Kr].x-wr,zn=Pr[Kr].y-Lr;er.writeVarint(Zt(vn)),er.writeVarint(Zt(zn)),wr+=vn,Lr+=zn}fr===3&&er.writeVarint(Xt(7,1))}}function nr(yr,er){var tr=typeof yr;tr==="string"?er.writeStringField(1,yr):tr==="boolean"?er.writeBooleanField(7,yr):tr==="number"&&(yr%1!=0?er.writeDoubleField(3,yr):yr<0?er.writeSVarintField(6,yr):er.writeVarintField(5,yr))}bt.exports=kt,bt.exports.fromVectorTileJs=kt,bt.exports.fromGeojsonVt=function(yr,er){er=er||{};var tr={};for(var fr in yr)tr[fr]=new Ft(yr[fr].features,er),tr[fr].name=fr,tr[fr].version=er.version,tr[fr].extent=er.extent;return kt({layers:tr})},bt.exports.GeoJSONWrapper=Ft;var cr=nt.by(bt.exports);const dr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:yr=>yr},mr=Math.fround||(Dr=new Float32Array(1),yr=>(Dr[0]=+yr,Dr[0]));var Dr;const kr=3,Yr=5,Mr=6;class Jr{constructor(er){this.options=Object.assign(Object.create(dr),er),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(er){const{log:tr,minZoom:fr,maxZoom:wr}=this.options;tr&&console.time("total time");const Lr=`prepare ${er.length} points`;tr&&console.time(Lr),this.points=er;const Fr=[];for(let Pr=0;Pr<er.length;Pr++){const Qr=er[Pr];if(!Qr.geometry)continue;const[sn,Kr]=Qr.geometry.coordinates,vn=mr(Rn(sn)),zn=mr(hn(Kr));Fr.push(vn,zn,1/0,Pr,-1,1),this.options.reduce&&Fr.push(0)}let Hr=this.trees[wr+1]=this._createTree(Fr);tr&&console.timeEnd(Lr);for(let Pr=wr;Pr>=fr;Pr--){const Qr=+Date.now();Hr=this.trees[Pr]=this._createTree(this._cluster(Hr,Pr)),tr&&console.log("z%d: %d clusters in %dms",Pr,Hr.numItems,+Date.now()-Qr)}return tr&&console.timeEnd("total time"),this}getClusters(er,tr){let fr=((er[0]+180)%360+360)%360-180;const wr=Math.max(-90,Math.min(90,er[1]));let Lr=er[2]===180?180:((er[2]+180)%360+360)%360-180;const Fr=Math.max(-90,Math.min(90,er[3]));if(er[2]-er[0]>=360)fr=-180,Lr=180;else if(fr>Lr){const Kr=this.getClusters([fr,wr,180,Fr],tr),vn=this.getClusters([-180,wr,Lr,Fr],tr);return Kr.concat(vn)}const Hr=this.trees[this._limitZoom(tr)],Pr=Hr.range(Rn(fr),hn(Fr),Rn(Lr),hn(wr)),Qr=Hr.data,sn=[];for(const Kr of Pr){const vn=this.stride*Kr;sn.push(Qr[vn+Yr]>1?an(Qr,vn,this.clusterProps):this.points[Qr[vn+kr]])}return sn}getChildren(er){const tr=this._getOriginId(er),fr=this._getOriginZoom(er),wr="No cluster with the specified id.",Lr=this.trees[fr];if(!Lr)throw new Error(wr);const Fr=Lr.data;if(tr*this.stride>=Fr.length)throw new Error(wr);const Hr=this.options.radius/(this.options.extent*Math.pow(2,fr-1)),Pr=Lr.within(Fr[tr*this.stride],Fr[tr*this.stride+1],Hr),Qr=[];for(const sn of Pr){const Kr=sn*this.stride;Fr[Kr+4]===er&&Qr.push(Fr[Kr+Yr]>1?an(Fr,Kr,this.clusterProps):this.points[Fr[Kr+kr]])}if(Qr.length===0)throw new Error(wr);return Qr}getLeaves(er,tr,fr){const wr=[];return this._appendLeaves(wr,er,tr=tr||10,fr=fr||0,0),wr}getTile(er,tr,fr){const wr=this.trees[this._limitZoom(er)],Lr=Math.pow(2,er),{extent:Fr,radius:Hr}=this.options,Pr=Hr/Fr,Qr=(fr-Pr)/Lr,sn=(fr+1+Pr)/Lr,Kr={features:[]};return this._addTileFeatures(wr.range((tr-Pr)/Lr,Qr,(tr+1+Pr)/Lr,sn),wr.data,tr,fr,Lr,Kr),tr===0&&this._addTileFeatures(wr.range(1-Pr/Lr,Qr,1,sn),wr.data,Lr,fr,Lr,Kr),tr===Lr-1&&this._addTileFeatures(wr.range(0,Qr,Pr/Lr,sn),wr.data,-1,fr,Lr,Kr),Kr.features.length?Kr:null}getClusterExpansionZoom(er){let tr=this._getOriginZoom(er)-1;for(;tr<=this.options.maxZoom;){const fr=this.getChildren(er);if(tr++,fr.length!==1)break;er=fr[0].properties.cluster_id}return tr}_appendLeaves(er,tr,fr,wr,Lr){const Fr=this.getChildren(tr);for(const Hr of Fr){const Pr=Hr.properties;if(Pr&&Pr.cluster?Lr+Pr.point_count<=wr?Lr+=Pr.point_count:Lr=this._appendLeaves(er,Pr.cluster_id,fr,wr,Lr):Lr<wr?Lr++:er.push(Hr),er.length===fr)break}return Lr}_createTree(er){const tr=new nt.av(er.length/this.stride|0,this.options.nodeSize,Float32Array);for(let fr=0;fr<er.length;fr+=this.stride)tr.add(er[fr],er[fr+1]);return tr.finish(),tr.data=er,tr}_addTileFeatures(er,tr,fr,wr,Lr,Fr){for(const Hr of er){const Pr=Hr*this.stride,Qr=tr[Pr+Yr]>1;let sn,Kr,vn;if(Qr)sn=xn(tr,Pr,this.clusterProps),Kr=tr[Pr],vn=tr[Pr+1];else{const po=this.points[tr[Pr+kr]];sn=po.properties;const[ga,ur]=po.geometry.coordinates;Kr=Rn(ga),vn=hn(ur)}const zn={type:1,geometry:[[Math.round(this.options.extent*(Kr*Lr-fr)),Math.round(this.options.extent*(vn*Lr-wr))]],tags:sn};let Yn;Yn=Qr||this.options.generateId?tr[Pr+kr]:this.points[tr[Pr+kr]].id,Yn!==void 0&&(zn.id=Yn),Fr.features.push(zn)}}_limitZoom(er){return Math.max(this.options.minZoom,Math.min(Math.floor(+er),this.options.maxZoom+1))}_cluster(er,tr){const{radius:fr,extent:wr,reduce:Lr,minPoints:Fr}=this.options,Hr=fr/(wr*Math.pow(2,tr)),Pr=er.data,Qr=[],sn=this.stride;for(let Kr=0;Kr<Pr.length;Kr+=sn){if(Pr[Kr+2]<=tr)continue;Pr[Kr+2]=tr;const vn=Pr[Kr],zn=Pr[Kr+1],Yn=er.within(Pr[Kr],Pr[Kr+1],Hr),po=Pr[Kr+Yr];let ga=po;for(const ur of Yn){const br=ur*sn;Pr[br+2]>tr&&(ga+=Pr[br+Yr])}if(ga>po&&ga>=Fr){let ur,br=vn*po,Nr=zn*po,Ur=-1;const Vr=((Kr/sn|0)<<5)+(tr+1)+this.points.length;for(const Xr of Yn){const cn=Xr*sn;if(Pr[cn+2]<=tr)continue;Pr[cn+2]=tr;const $n=Pr[cn+Yr];br+=Pr[cn]*$n,Nr+=Pr[cn+1]*$n,Pr[cn+4]=Vr,Lr&&(ur||(ur=this._map(Pr,Kr,!0),Ur=this.clusterProps.length,this.clusterProps.push(ur)),Lr(ur,this._map(Pr,cn)))}Pr[Kr+4]=Vr,Qr.push(br/ga,Nr/ga,1/0,Vr,-1,ga),Lr&&Qr.push(Ur)}else{for(let ur=0;ur<sn;ur++)Qr.push(Pr[Kr+ur]);if(ga>1)for(const ur of Yn){const br=ur*sn;if(!(Pr[br+2]<=tr)){Pr[br+2]=tr;for(let Nr=0;Nr<sn;Nr++)Qr.push(Pr[br+Nr])}}}}return Qr}_getOriginId(er){return er-this.points.length>>5}_getOriginZoom(er){return(er-this.points.length)%32}_map(er,tr,fr){if(er[tr+Yr]>1){const Fr=this.clusterProps[er[tr+Mr]];return fr?Object.assign({},Fr):Fr}const wr=this.points[er[tr+kr]].properties,Lr=this.options.map(wr);return fr&&Lr===wr?Object.assign({},Lr):Lr}}function an(yr,er,tr){return{type:"Feature",id:yr[er+kr],properties:xn(yr,er,tr),geometry:{type:"Point",coordinates:[(fr=yr[er],360*(fr-.5)),pn(yr[er+1])]}};var fr}function xn(yr,er,tr){const fr=yr[er+Yr],wr=fr>=1e4?`${Math.round(fr/1e3)}k`:fr>=1e3?Math.round(fr/100)/10+"k":fr,Lr=yr[er+Mr],Fr=Lr===-1?{}:Object.assign({},tr[Lr]);return Object.assign(Fr,{cluster:!0,cluster_id:yr[er+kr],point_count:fr,point_count_abbreviated:wr})}function Rn(yr){return yr/360+.5}function hn(yr){const er=Math.sin(yr*Math.PI/180),tr=.5-.25*Math.log((1+er)/(1-er))/Math.PI;return tr<0?0:tr>1?1:tr}function pn(yr){const er=(180-360*yr)*Math.PI/180;return 360*Math.atan(Math.exp(er))/Math.PI-90}function yn(yr,er,tr,fr){let wr=fr;const Lr=er+(tr-er>>1);let Fr,Hr=tr-er;const Pr=yr[er],Qr=yr[er+1],sn=yr[tr],Kr=yr[tr+1];for(let vn=er+3;vn<tr;vn+=3){const zn=un(yr[vn],yr[vn+1],Pr,Qr,sn,Kr);if(zn>wr)Fr=vn,wr=zn;else if(zn===wr){const Yn=Math.abs(vn-Lr);Yn<Hr&&(Fr=vn,Hr=Yn)}}wr>fr&&(Fr-er>3&&yn(yr,er,Fr,fr),yr[Fr+2]=wr,tr-Fr>3&&yn(yr,Fr,tr,fr))}function un(yr,er,tr,fr,wr,Lr){let Fr=wr-tr,Hr=Lr-fr;if(Fr!==0||Hr!==0){const Pr=((yr-tr)*Fr+(er-fr)*Hr)/(Fr*Fr+Hr*Hr);Pr>1?(tr=wr,fr=Lr):Pr>0&&(tr+=Fr*Pr,fr+=Hr*Pr)}return Fr=yr-tr,Hr=er-fr,Fr*Fr+Hr*Hr}function fn(yr,er,tr,fr){const wr={id:yr??null,type:er,geometry:tr,tags:fr,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(er==="Point"||er==="MultiPoint"||er==="LineString")Bn(wr,tr);else if(er==="Polygon")Bn(wr,tr[0]);else if(er==="MultiLineString")for(const Lr of tr)Bn(wr,Lr);else if(er==="MultiPolygon")for(const Lr of tr)Bn(wr,Lr[0]);return wr}function Bn(yr,er){for(let tr=0;tr<er.length;tr+=3)yr.minX=Math.min(yr.minX,er[tr]),yr.minY=Math.min(yr.minY,er[tr+1]),yr.maxX=Math.max(yr.maxX,er[tr]),yr.maxY=Math.max(yr.maxY,er[tr+1])}function Dn(yr,er,tr,fr){if(!er.geometry)return;const wr=er.geometry.coordinates;if(wr&&wr.length===0)return;const Lr=er.geometry.type,Fr=Math.pow(tr.tolerance/((1<<tr.maxZoom)*tr.extent),2);let Hr=[],Pr=er.id;if(tr.promoteId?Pr=er.properties[tr.promoteId]:tr.generateId&&(Pr=fr||0),Lr==="Point")Qn(wr,Hr);else if(Lr==="MultiPoint")for(const Qr of wr)Qn(Qr,Hr);else if(Lr==="LineString")zr(wr,Hr,Fr,!1);else if(Lr==="MultiLineString"){if(tr.lineMetrics){for(const Qr of wr)Hr=[],zr(Qr,Hr,Fr,!1),yr.push(fn(Pr,"LineString",Hr,er.properties));return}ao(wr,Hr,Fr,!1)}else if(Lr==="Polygon")ao(wr,Hr,Fr,!0);else{if(Lr!=="MultiPolygon"){if(Lr==="GeometryCollection"){for(const Qr of er.geometry.geometries)Dn(yr,{id:Pr,geometry:Qr,properties:er.properties},tr,fr);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Qr of wr){const sn=[];ao(Qr,sn,Fr,!0),Hr.push(sn)}}yr.push(fn(Pr,Lr,Hr,er.properties))}function Qn(yr,er){er.push(oo(yr[0]),Wn(yr[1]),0)}function zr(yr,er,tr,fr){let wr,Lr,Fr=0;for(let Pr=0;Pr<yr.length;Pr++){const Qr=oo(yr[Pr][0]),sn=Wn(yr[Pr][1]);er.push(Qr,sn,0),Pr>0&&(Fr+=fr?(wr*sn-Qr*Lr)/2:Math.sqrt(Math.pow(Qr-wr,2)+Math.pow(sn-Lr,2))),wr=Qr,Lr=sn}const Hr=er.length-3;er[2]=1,yn(er,0,Hr,tr),er[Hr+2]=1,er.size=Math.abs(Fr),er.start=0,er.end=er.size}function ao(yr,er,tr,fr){for(let wr=0;wr<yr.length;wr++){const Lr=[];zr(yr[wr],Lr,tr,fr),er.push(Lr)}}function oo(yr){return yr/360+.5}function Wn(yr){const er=Math.sin(yr*Math.PI/180),tr=.5-.25*Math.log((1+er)/(1-er))/Math.PI;return tr<0?0:tr>1?1:tr}function no(yr,er,tr,fr,wr,Lr,Fr,Hr){if(fr/=er,Lr>=(tr/=er)&&Fr<fr)return yr;if(Fr<tr||Lr>=fr)return null;const Pr=[];for(const Qr of yr){const sn=Qr.geometry;let Kr=Qr.type;const vn=wr===0?Qr.minX:Qr.minY,zn=wr===0?Qr.maxX:Qr.maxY;if(vn>=tr&&zn<fr){Pr.push(Qr);continue}if(zn<tr||vn>=fr)continue;let Yn=[];if(Kr==="Point"||Kr==="MultiPoint")Eo(sn,Yn,tr,fr,wr);else if(Kr==="LineString")xo(sn,Yn,tr,fr,wr,!1,Hr.lineMetrics);else if(Kr==="MultiLineString")ls(sn,Yn,tr,fr,wr,!1);else if(Kr==="Polygon")ls(sn,Yn,tr,fr,wr,!0);else if(Kr==="MultiPolygon")for(const po of sn){const ga=[];ls(po,ga,tr,fr,wr,!0),ga.length&&Yn.push(ga)}if(Yn.length){if(Hr.lineMetrics&&Kr==="LineString"){for(const po of Yn)Pr.push(fn(Qr.id,Kr,po,Qr.tags));continue}Kr!=="LineString"&&Kr!=="MultiLineString"||(Yn.length===1?(Kr="LineString",Yn=Yn[0]):Kr="MultiLineString"),Kr!=="Point"&&Kr!=="MultiPoint"||(Kr=Yn.length===3?"Point":"MultiPoint"),Pr.push(fn(Qr.id,Kr,Yn,Qr.tags))}}return Pr.length?Pr:null}function Eo(yr,er,tr,fr,wr){for(let Lr=0;Lr<yr.length;Lr+=3){const Fr=yr[Lr+wr];Fr>=tr&&Fr<=fr&&eo(er,yr[Lr],yr[Lr+1],yr[Lr+2])}}function xo(yr,er,tr,fr,wr,Lr,Fr){let Hr=Mo(yr);const Pr=wr===0?wl:qs;let Qr,sn,Kr=yr.start;for(let ga=0;ga<yr.length-3;ga+=3){const ur=yr[ga],br=yr[ga+1],Nr=yr[ga+2],Ur=yr[ga+3],Vr=yr[ga+4],Xr=wr===0?ur:br,cn=wr===0?Ur:Vr;let $n=!1;Fr&&(Qr=Math.sqrt(Math.pow(ur-Ur,2)+Math.pow(br-Vr,2))),Xr<tr?cn>tr&&(sn=Pr(Hr,ur,br,Ur,Vr,tr),Fr&&(Hr.start=Kr+Qr*sn)):Xr>fr?cn<fr&&(sn=Pr(Hr,ur,br,Ur,Vr,fr),Fr&&(Hr.start=Kr+Qr*sn)):eo(Hr,ur,br,Nr),cn<tr&&Xr>=tr&&(sn=Pr(Hr,ur,br,Ur,Vr,tr),$n=!0),cn>fr&&Xr<=fr&&(sn=Pr(Hr,ur,br,Ur,Vr,fr),$n=!0),!Lr&&$n&&(Fr&&(Hr.end=Kr+Qr*sn),er.push(Hr),Hr=Mo(yr)),Fr&&(Kr+=Qr)}let vn=yr.length-3;const zn=yr[vn],Yn=yr[vn+1],po=wr===0?zn:Yn;po>=tr&&po<=fr&&eo(Hr,zn,Yn,yr[vn+2]),vn=Hr.length-3,Lr&&vn>=3&&(Hr[vn]!==Hr[0]||Hr[vn+1]!==Hr[1])&&eo(Hr,Hr[0],Hr[1],Hr[2]),Hr.length&&er.push(Hr)}function Mo(yr){const er=[];return er.size=yr.size,er.start=yr.start,er.end=yr.end,er}function ls(yr,er,tr,fr,wr,Lr){for(const Fr of yr)xo(Fr,er,tr,fr,wr,Lr,!1)}function eo(yr,er,tr,fr){yr.push(er,tr,fr)}function wl(yr,er,tr,fr,wr,Lr){const Fr=(Lr-er)/(fr-er);return eo(yr,Lr,tr+(wr-tr)*Fr,1),Fr}function qs(yr,er,tr,fr,wr,Lr){const Fr=(Lr-tr)/(wr-tr);return eo(yr,er+(fr-er)*Fr,Lr,1),Fr}function gn(yr,er){const tr=[];for(let fr=0;fr<yr.length;fr++){const wr=yr[fr],Lr=wr.type;let Fr;if(Lr==="Point"||Lr==="MultiPoint"||Lr==="LineString")Fr=Jo(wr.geometry,er);else if(Lr==="MultiLineString"||Lr==="Polygon"){Fr=[];for(const Hr of wr.geometry)Fr.push(Jo(Hr,er))}else if(Lr==="MultiPolygon"){Fr=[];for(const Hr of wr.geometry){const Pr=[];for(const Qr of Hr)Pr.push(Jo(Qr,er));Fr.push(Pr)}}tr.push(fn(wr.id,Lr,Fr,wr.tags))}return tr}function Jo(yr,er){const tr=[];tr.size=yr.size,yr.start!==void 0&&(tr.start=yr.start,tr.end=yr.end);for(let fr=0;fr<yr.length;fr+=3)tr.push(yr[fr]+er,yr[fr+1],yr[fr+2]);return tr}function Wo(yr,er){if(yr.transformed)return yr;const tr=1<<yr.z,fr=yr.x,wr=yr.y;for(const Lr of yr.features){const Fr=Lr.geometry,Hr=Lr.type;if(Lr.geometry=[],Hr===1)for(let Pr=0;Pr<Fr.length;Pr+=2)Lr.geometry.push(us(Fr[Pr],Fr[Pr+1],er,tr,fr,wr));else for(let Pr=0;Pr<Fr.length;Pr++){const Qr=[];for(let sn=0;sn<Fr[Pr].length;sn+=2)Qr.push(us(Fr[Pr][sn],Fr[Pr][sn+1],er,tr,fr,wr));Lr.geometry.push(Qr)}}return yr.transformed=!0,yr}function us(yr,er,tr,fr,wr,Lr){return[Math.round(tr*(yr*fr-wr)),Math.round(tr*(er*fr-Lr))]}function ko(yr,er,tr,fr,wr){const Lr=er===wr.maxZoom?0:wr.tolerance/((1<<er)*wr.extent),Fr={features:[],numPoints:0,numSimplified:0,numFeatures:yr.length,source:null,x:tr,y:fr,z:er,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Hr of yr)_n(Fr,Hr,Lr,wr);return Fr}function _n(yr,er,tr,fr){const wr=er.geometry,Lr=er.type,Fr=[];if(yr.minX=Math.min(yr.minX,er.minX),yr.minY=Math.min(yr.minY,er.minY),yr.maxX=Math.max(yr.maxX,er.maxX),yr.maxY=Math.max(yr.maxY,er.maxY),Lr==="Point"||Lr==="MultiPoint")for(let Hr=0;Hr<wr.length;Hr+=3)Fr.push(wr[Hr],wr[Hr+1]),yr.numPoints++,yr.numSimplified++;else if(Lr==="LineString")bn(Fr,wr,yr,tr,!1,!1);else if(Lr==="MultiLineString"||Lr==="Polygon")for(let Hr=0;Hr<wr.length;Hr++)bn(Fr,wr[Hr],yr,tr,Lr==="Polygon",Hr===0);else if(Lr==="MultiPolygon")for(let Hr=0;Hr<wr.length;Hr++){const Pr=wr[Hr];for(let Qr=0;Qr<Pr.length;Qr++)bn(Fr,Pr[Qr],yr,tr,!0,Qr===0)}if(Fr.length){let Hr=er.tags||null;if(Lr==="LineString"&&fr.lineMetrics){Hr={};for(const Qr in er.tags)Hr[Qr]=er.tags[Qr];Hr.mapbox_clip_start=wr.start/wr.size,Hr.mapbox_clip_end=wr.end/wr.size}const Pr={geometry:Fr,type:Lr==="Polygon"||Lr==="MultiPolygon"?3:Lr==="LineString"||Lr==="MultiLineString"?2:1,tags:Hr};er.id!==null&&(Pr.id=er.id),yr.features.push(Pr)}}function bn(yr,er,tr,fr,wr,Lr){const Fr=fr*fr;if(fr>0&&er.size<(wr?Fr:fr))return void(tr.numPoints+=er.length/3);const Hr=[];for(let Pr=0;Pr<er.length;Pr+=3)(fr===0||er[Pr+2]>Fr)&&(tr.numSimplified++,Hr.push(er[Pr],er[Pr+1])),tr.numPoints++;wr&&function(Pr,Qr){let sn=0;for(let Kr=0,vn=Pr.length,zn=vn-2;Kr<vn;zn=Kr,Kr+=2)sn+=(Pr[Kr]-Pr[zn])*(Pr[Kr+1]+Pr[zn+1]);if(sn>0===Qr)for(let Kr=0,vn=Pr.length;Kr<vn/2;Kr+=2){const zn=Pr[Kr],Yn=Pr[Kr+1];Pr[Kr]=Pr[vn-2-Kr],Pr[Kr+1]=Pr[vn-1-Kr],Pr[vn-2-Kr]=zn,Pr[vn-1-Kr]=Yn}}(Hr,Lr),yr.push(Hr)}const Zn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ts{constructor(er,tr){const fr=(tr=this.options=function(Lr,Fr){for(const Hr in Fr)Lr[Hr]=Fr[Hr];return Lr}(Object.create(Zn),tr)).debug;if(fr&&console.time("preprocess data"),tr.maxZoom<0||tr.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(tr.promoteId&&tr.generateId)throw new Error("promoteId and generateId cannot be used together.");let wr=function(Lr,Fr){const Hr=[];if(Lr.type==="FeatureCollection")for(let Pr=0;Pr<Lr.features.length;Pr++)Dn(Hr,Lr.features[Pr],Fr,Pr);else Dn(Hr,Lr.type==="Feature"?Lr:{geometry:Lr},Fr);return Hr}(er,tr);this.tiles={},this.tileCoords=[],fr&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",tr.indexMaxZoom,tr.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),wr=function(Lr,Fr){const Hr=Fr.buffer/Fr.extent;let Pr=Lr;const Qr=no(Lr,1,-1-Hr,Hr,0,-1,2,Fr),sn=no(Lr,1,1-Hr,2+Hr,0,-1,2,Fr);return(Qr||sn)&&(Pr=no(Lr,1,-Hr,1+Hr,0,-1,2,Fr)||[],Qr&&(Pr=gn(Qr,1).concat(Pr)),sn&&(Pr=Pr.concat(gn(sn,-1)))),Pr}(wr,tr),wr.length&&this.splitTile(wr,0,0,0),fr&&(wr.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(er,tr,fr,wr,Lr,Fr,Hr){const Pr=[er,tr,fr,wr],Qr=this.options,sn=Qr.debug;for(;Pr.length;){wr=Pr.pop(),fr=Pr.pop(),tr=Pr.pop(),er=Pr.pop();const Kr=1<<tr,vn=ms(tr,fr,wr);let zn=this.tiles[vn];if(!zn&&(sn>1&&console.time("creation"),zn=this.tiles[vn]=ko(er,tr,fr,wr,Qr),this.tileCoords.push({z:tr,x:fr,y:wr}),sn)){sn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",tr,fr,wr,zn.numFeatures,zn.numPoints,zn.numSimplified),console.timeEnd("creation"));const $n=`z${tr}`;this.stats[$n]=(this.stats[$n]||0)+1,this.total++}if(zn.source=er,Lr==null){if(tr===Qr.indexMaxZoom||zn.numPoints<=Qr.indexMaxPoints)continue}else{if(tr===Qr.maxZoom||tr===Lr)continue;if(Lr!=null){const $n=Lr-tr;if(fr!==Fr>>$n||wr!==Hr>>$n)continue}}if(zn.source=null,er.length===0)continue;sn>1&&console.time("clipping");const Yn=.5*Qr.buffer/Qr.extent,po=.5-Yn,ga=.5+Yn,ur=1+Yn;let br=null,Nr=null,Ur=null,Vr=null,Xr=no(er,Kr,fr-Yn,fr+ga,0,zn.minX,zn.maxX,Qr),cn=no(er,Kr,fr+po,fr+ur,0,zn.minX,zn.maxX,Qr);er=null,Xr&&(br=no(Xr,Kr,wr-Yn,wr+ga,1,zn.minY,zn.maxY,Qr),Nr=no(Xr,Kr,wr+po,wr+ur,1,zn.minY,zn.maxY,Qr),Xr=null),cn&&(Ur=no(cn,Kr,wr-Yn,wr+ga,1,zn.minY,zn.maxY,Qr),Vr=no(cn,Kr,wr+po,wr+ur,1,zn.minY,zn.maxY,Qr),cn=null),sn>1&&console.timeEnd("clipping"),Pr.push(br||[],tr+1,2*fr,2*wr),Pr.push(Nr||[],tr+1,2*fr,2*wr+1),Pr.push(Ur||[],tr+1,2*fr+1,2*wr),Pr.push(Vr||[],tr+1,2*fr+1,2*wr+1)}}getTile(er,tr,fr){er=+er,tr=+tr,fr=+fr;const wr=this.options,{extent:Lr,debug:Fr}=wr;if(er<0||er>24)return null;const Hr=1<<er,Pr=ms(er,tr=tr+Hr&Hr-1,fr);if(this.tiles[Pr])return Wo(this.tiles[Pr],Lr);Fr>1&&console.log("drilling down to z%d-%d-%d",er,tr,fr);let Qr,sn=er,Kr=tr,vn=fr;for(;!Qr&&sn>0;)sn--,Kr>>=1,vn>>=1,Qr=this.tiles[ms(sn,Kr,vn)];return Qr&&Qr.source?(Fr>1&&(console.log("found parent tile z%d-%d-%d",sn,Kr,vn),console.time("drilling down")),this.splitTile(Qr.source,sn,Kr,vn,er,tr,fr),Fr>1&&console.timeEnd("drilling down"),this.tiles[Pr]?Wo(this.tiles[Pr],Lr):null):null}}function ms(yr,er,tr){return 32*((1<<yr)*tr+er)+yr}function Kn(yr,er){return er?yr.properties[er]:yr.id}function co(yr,er){if(yr==null)return!0;if(yr.type==="Feature")return Kn(yr,er)!=null;if(yr.type==="FeatureCollection"){const tr=new Set;for(const fr of yr.features){const wr=Kn(fr,er);if(wr==null||tr.has(wr))return!1;tr.add(wr)}return!0}return!1}function cs(yr,er){const tr=new Map;if(yr!=null)if(yr.type==="Feature")tr.set(Kn(yr,er),yr);else for(const fr of yr.features)tr.set(Kn(fr,er),fr);return tr}class Ms extends ot{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(er,tr){return nt._(this,void 0,void 0,function*(){const fr=er.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const wr=this._geoJSONIndex.getTile(fr.z,fr.x,fr.y);if(!wr)return null;const Lr=new class{constructor(Hr){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=nt.X,this.length=Hr.length,this._features=Hr}feature(Hr){return new class{constructor(Pr){this._feature=Pr,this.extent=nt.X,this.type=Pr.type,this.properties=Pr.tags,"id"in Pr&&!isNaN(Pr.id)&&(this.id=parseInt(Pr.id,10))}loadGeometry(){if(this._feature.type===1){const Pr=[];for(const Qr of this._feature.geometry)Pr.push([new nt.P(Qr[0],Qr[1])]);return Pr}{const Pr=[];for(const Qr of this._feature.geometry){const sn=[];for(const Kr of Qr)sn.push(new nt.P(Kr[0],Kr[1]));Pr.push(sn)}return Pr}}toGeoJSON(Pr,Qr,sn){return yt.call(this,Pr,Qr,sn)}}(this._features[Hr])}}(wr.features);let Fr=cr(Lr);return Fr.byteOffset===0&&Fr.byteLength===Fr.buffer.byteLength||(Fr=new Uint8Array(Fr)),{vectorTile:Lr,rawData:Fr.buffer}})}loadData(er){return nt._(this,void 0,void 0,function*(){var tr;(tr=this._pendingRequest)===null||tr===void 0||tr.abort();const fr=!!(er&&er.request&&er.request.collectResourceTiming)&&new nt.bv(er.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(er,this._pendingRequest),this._geoJSONIndex=er.cluster?new Jr(function({superclusterOptions:Fr,clusterProperties:Hr}){if(!Hr||!Fr)return Fr;const Pr={},Qr={},sn={accumulated:null,zoom:0},Kr={properties:null},vn=Object.keys(Hr);for(const zn of vn){const[Yn,po]=Hr[zn],ga=nt.bC(po),ur=nt.bC(typeof Yn=="string"?[Yn,["accumulated"],["get",zn]]:Yn);Pr[zn]=ga.value,Qr[zn]=ur.value}return Fr.map=zn=>{Kr.properties=zn;const Yn={};for(const po of vn)Yn[po]=Pr[po].evaluate(sn,Kr);return Yn},Fr.reduce=(zn,Yn)=>{Kr.properties=Yn;for(const po of vn)sn.accumulated=zn[po],zn[po]=Qr[po].evaluate(sn,Kr)},Fr}(er)).load((yield this._pendingData).features):(wr=yield this._pendingData,new ts(wr,er.geojsonVtOptions)),this.loaded={};const Lr={};if(fr){const Fr=fr.finish();Fr&&(Lr.resourceTiming={},Lr.resourceTiming[er.source]=JSON.parse(JSON.stringify(Fr)))}return Lr}catch(Lr){if(delete this._pendingRequest,nt.bB(Lr))return{abandoned:!0};throw Lr}var wr})}getData(){return nt._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(er){const tr=this.loaded;return tr&&tr[er.uid]?super.reloadTile(er):this.loadTile(er)}loadAndProcessGeoJSON(er,tr){return nt._(this,void 0,void 0,function*(){let fr=yield this.loadGeoJSON(er,tr);if(delete this._pendingRequest,typeof fr!="object")throw new Error(`Input data given to '${er.source}' is not a valid GeoJSON object.`);if(mt(fr,!0),er.filter){const wr=nt.bC(er.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(wr.result==="error")throw new Error(wr.value.map(Fr=>`${Fr.key}: ${Fr.message}`).join(", "));fr={type:"FeatureCollection",features:fr.features.filter(Fr=>wr.value.evaluate({zoom:0},Fr))}}return fr})}loadGeoJSON(er,tr){return nt._(this,void 0,void 0,function*(){const{promoteId:fr}=er;if(er.request){const wr=yield nt.h(er.request,tr);return this._dataUpdateable=co(wr.data,fr)?cs(wr.data,fr):void 0,wr.data}if(typeof er.data=="string")try{const wr=JSON.parse(er.data);return this._dataUpdateable=co(wr,fr)?cs(wr,fr):void 0,wr}catch{throw new Error(`Input data given to '${er.source}' is not a valid GeoJSON object.`)}if(!er.dataDiff)throw new Error(`Input data given to '${er.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${er.source}`);return function(wr,Lr,Fr){var Hr,Pr,Qr,sn;if(Lr.removeAll&&wr.clear(),Lr.remove)for(const Kr of Lr.remove)wr.delete(Kr);if(Lr.add)for(const Kr of Lr.add){const vn=Kn(Kr,Fr);vn!=null&&wr.set(vn,Kr)}if(Lr.update)for(const Kr of Lr.update){let vn=wr.get(Kr.id);if(vn==null)continue;const zn=!Kr.removeAllProperties&&(((Hr=Kr.removeProperties)===null||Hr===void 0?void 0:Hr.length)>0||((Pr=Kr.addOrUpdateProperties)===null||Pr===void 0?void 0:Pr.length)>0);if((Kr.newGeometry||Kr.removeAllProperties||zn)&&(vn=Object.assign({},vn),wr.set(Kr.id,vn),zn&&(vn.properties=Object.assign({},vn.properties))),Kr.newGeometry&&(vn.geometry=Kr.newGeometry),Kr.removeAllProperties)vn.properties={};else if(((Qr=Kr.removeProperties)===null||Qr===void 0?void 0:Qr.length)>0)for(const Yn of Kr.removeProperties)Object.prototype.hasOwnProperty.call(vn.properties,Yn)&&delete vn.properties[Yn];if(((sn=Kr.addOrUpdateProperties)===null||sn===void 0?void 0:sn.length)>0)for(const{key:Yn,value:po}of Kr.addOrUpdateProperties)vn.properties[Yn]=po}}(this._dataUpdateable,er.dataDiff,fr),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(er){return nt._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(er){return this._geoJSONIndex.getClusterExpansionZoom(er.clusterId)}getClusterChildren(er){return this._geoJSONIndex.getChildren(er.clusterId)}getClusterLeaves(er){return this._geoJSONIndex.getLeaves(er.clusterId,er.limit,er.offset)}}class ns{constructor(er){this.self=er,this.actor=new nt.F(er),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(tr,fr)=>{if(this.externalWorkerSourceTypes[tr])throw new Error(`Worker source with name "${tr}" already registered.`);this.externalWorkerSourceTypes[tr]=fr},this.self.addProtocol=nt.bi,this.self.removeProtocol=nt.bj,this.self.registerRTLTextPlugin=tr=>{if(nt.bD.isParsed())throw new Error("RTL text plugin already registered.");nt.bD.setMethods(tr)},this.actor.registerMessageHandler("LDT",(tr,fr)=>this._getDEMWorkerSource(tr,fr.source).loadTile(fr)),this.actor.registerMessageHandler("RDT",(tr,fr)=>nt._(this,void 0,void 0,function*(){this._getDEMWorkerSource(tr,fr.source).removeTile(fr)})),this.actor.registerMessageHandler("GCEZ",(tr,fr)=>nt._(this,void 0,void 0,function*(){return this._getWorkerSource(tr,fr.type,fr.source).getClusterExpansionZoom(fr)})),this.actor.registerMessageHandler("GCC",(tr,fr)=>nt._(this,void 0,void 0,function*(){return this._getWorkerSource(tr,fr.type,fr.source).getClusterChildren(fr)})),this.actor.registerMessageHandler("GCL",(tr,fr)=>nt._(this,void 0,void 0,function*(){return this._getWorkerSource(tr,fr.type,fr.source).getClusterLeaves(fr)})),this.actor.registerMessageHandler("LD",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).loadData(fr)),this.actor.registerMessageHandler("GD",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).getData()),this.actor.registerMessageHandler("LT",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).loadTile(fr)),this.actor.registerMessageHandler("RT",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).reloadTile(fr)),this.actor.registerMessageHandler("AT",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).abortTile(fr)),this.actor.registerMessageHandler("RMT",(tr,fr)=>this._getWorkerSource(tr,fr.type,fr.source).removeTile(fr)),this.actor.registerMessageHandler("RS",(tr,fr)=>nt._(this,void 0,void 0,function*(){if(!this.workerSources[tr]||!this.workerSources[tr][fr.type]||!this.workerSources[tr][fr.type][fr.source])return;const wr=this.workerSources[tr][fr.type][fr.source];delete this.workerSources[tr][fr.type][fr.source],wr.removeSource!==void 0&&wr.removeSource(fr)})),this.actor.registerMessageHandler("RM",tr=>nt._(this,void 0,void 0,function*(){delete this.layerIndexes[tr],delete this.availableImages[tr],delete this.workerSources[tr],delete this.demWorkerSources[tr]})),this.actor.registerMessageHandler("SR",(tr,fr)=>nt._(this,void 0,void 0,function*(){this.referrer=fr})),this.actor.registerMessageHandler("SRPS",(tr,fr)=>this._syncRTLPluginState(tr,fr)),this.actor.registerMessageHandler("IS",(tr,fr)=>nt._(this,void 0,void 0,function*(){this.self.importScripts(fr)})),this.actor.registerMessageHandler("SI",(tr,fr)=>this._setImages(tr,fr)),this.actor.registerMessageHandler("UL",(tr,fr)=>nt._(this,void 0,void 0,function*(){this._getLayerIndex(tr).update(fr.layers,fr.removedIds)})),this.actor.registerMessageHandler("SL",(tr,fr)=>nt._(this,void 0,void 0,function*(){this._getLayerIndex(tr).replace(fr)}))}_setImages(er,tr){return nt._(this,void 0,void 0,function*(){this.availableImages[er]=tr;for(const fr in this.workerSources[er]){const wr=this.workerSources[er][fr];for(const Lr in wr)wr[Lr].availableImages=tr}})}_syncRTLPluginState(er,tr){return nt._(this,void 0,void 0,function*(){if(nt.bD.isParsed())return nt.bD.getState();if(tr.pluginStatus!=="loading")return nt.bD.setState(tr),tr;const fr=tr.pluginURL;if(this.self.importScripts(fr),nt.bD.isParsed()){const wr={pluginStatus:"loaded",pluginURL:fr};return nt.bD.setState(wr),wr}throw nt.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${fr}`)})}_getAvailableImages(er){let tr=this.availableImages[er];return tr||(tr=[]),tr}_getLayerIndex(er){let tr=this.layerIndexes[er];return tr||(tr=this.layerIndexes[er]=new it),tr}_getWorkerSource(er,tr,fr){if(this.workerSources[er]||(this.workerSources[er]={}),this.workerSources[er][tr]||(this.workerSources[er][tr]={}),!this.workerSources[er][tr][fr]){const wr={sendAsync:(Lr,Fr)=>(Lr.targetMapId=er,this.actor.sendAsync(Lr,Fr))};switch(tr){case"vector":this.workerSources[er][tr][fr]=new ot(wr,this._getLayerIndex(er),this._getAvailableImages(er));break;case"geojson":this.workerSources[er][tr][fr]=new Ms(wr,this._getLayerIndex(er),this._getAvailableImages(er));break;default:this.workerSources[er][tr][fr]=new this.externalWorkerSourceTypes[tr](wr,this._getLayerIndex(er),this._getAvailableImages(er))}}return this.workerSources[er][tr][fr]}_getDEMWorkerSource(er,tr){return this.demWorkerSources[er]||(this.demWorkerSources[er]={}),this.demWorkerSources[er][tr]||(this.demWorkerSources[er][tr]=new at),this.demWorkerSources[er][tr]}}return nt.i(self)&&(self.worker=new ns(self)),ns}),d("index",["exports","./shared"],function(nt,it){var st="4.7.1";let ut,ct;const ot={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:Mt=>new Promise((dt,xt)=>{const At=requestAnimationFrame(dt);Mt.signal.addEventListener("abort",()=>{cancelAnimationFrame(At),xt(it.c())})}),getImageData(Mt,dt=0){return this.getImageCanvasContext(Mt).getImageData(-dt,-dt,Mt.width+2*dt,Mt.height+2*dt)},getImageCanvasContext(Mt){const dt=window.document.createElement("canvas"),xt=dt.getContext("2d",{willReadFrequently:!0});if(!xt)throw new Error("failed to create canvas 2d context");return dt.width=Mt.width,dt.height=Mt.height,xt.drawImage(Mt,0,0,Mt.width,Mt.height),xt},resolveURL:Mt=>(ut||(ut=document.createElement("a")),ut.href=Mt,ut.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ct==null&&(ct=matchMedia("(prefers-reduced-motion: reduce)")),ct.matches)}};class at{static testProp(dt){if(!at.docStyle)return dt[0];for(let xt=0;xt<dt.length;xt++)if(dt[xt]in at.docStyle)return dt[xt];return dt[0]}static create(dt,xt,At){const It=window.document.createElement(dt);return xt!==void 0&&(It.className=xt),At&&At.appendChild(It),It}static createNS(dt,xt){return window.document.createElementNS(dt,xt)}static disableDrag(){at.docStyle&&at.selectProp&&(at.userSelect=at.docStyle[at.selectProp],at.docStyle[at.selectProp]="none")}static enableDrag(){at.docStyle&&at.selectProp&&(at.docStyle[at.selectProp]=at.userSelect)}static setTransform(dt,xt){dt.style[at.transformProp]=xt}static addEventListener(dt,xt,At,It={}){dt.addEventListener(xt,At,"passive"in It?It:It.capture)}static removeEventListener(dt,xt,At,It={}){dt.removeEventListener(xt,At,"passive"in It?It:It.capture)}static suppressClickInternal(dt){dt.preventDefault(),dt.stopPropagation(),window.removeEventListener("click",at.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",at.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",at.suppressClickInternal,!0)},0)}static getScale(dt){const xt=dt.getBoundingClientRect();return{x:xt.width/dt.offsetWidth||1,y:xt.height/dt.offsetHeight||1,boundingClientRect:xt}}static getPoint(dt,xt,At){const It=xt.boundingClientRect;return new it.P((At.clientX-It.left)/xt.x-dt.clientLeft,(At.clientY-It.top)/xt.y-dt.clientTop)}static mousePos(dt,xt){const At=at.getScale(dt);return at.getPoint(dt,At,xt)}static touchPos(dt,xt){const At=[],It=at.getScale(dt);for(let Pt=0;Pt<xt.length;Pt++)At.push(at.getPoint(dt,It,xt[Pt]));return At}static mouseButton(dt){return dt.button}static remove(dt){dt.parentNode&&dt.parentNode.removeChild(dt)}}at.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,at.selectProp=at.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),at.transformProp=at.testProp(["transform","WebkitTransform"]);const ht={supported:!1,testSupport:function(Mt){!yt&&mt&&(bt?wt(Mt):ft=Mt)}};let ft,mt,yt=!1,bt=!1;function wt(Mt){const dt=Mt.createTexture();Mt.bindTexture(Mt.TEXTURE_2D,dt);try{if(Mt.texImage2D(Mt.TEXTURE_2D,0,Mt.RGBA,Mt.RGBA,Mt.UNSIGNED_BYTE,mt),Mt.isContextLost())return;ht.supported=!0}catch{}Mt.deleteTexture(dt),yt=!0}var Tt;typeof document<"u"&&(mt=document.createElement("img"),mt.onload=()=>{ft&&wt(ft),ft=null,bt=!0},mt.onerror=()=>{yt=!0,ft=null},mt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(Mt){let dt,xt,At,It;Mt.resetRequestQueue=()=>{dt=[],xt=0,At=0,It={}},Mt.addThrottleControl=Gt=>{const Yt=At++;return It[Yt]=Gt,Yt},Mt.removeThrottleControl=Gt=>{delete It[Gt],Bt()},Mt.getImage=(Gt,Yt,Kt=!0)=>new Promise((Jt,sr)=>{ht.supported&&(Gt.headers||(Gt.headers={}),Gt.headers.accept="image/webp,*/*"),it.e(Gt,{type:"image"}),dt.push({abortController:Yt,requestParameters:Gt,supportImageRefresh:Kt,state:"queued",onError:gr=>{sr(gr)},onSuccess:gr=>{Jt(gr)}}),Bt()});const Pt=Gt=>it._(this,void 0,void 0,function*(){Gt.state="running";const{requestParameters:Yt,supportImageRefresh:Kt,onError:Jt,onSuccess:sr,abortController:gr}=Gt,vr=Kt===!1&&!it.i(self)&&!it.g(Yt.url)&&(!Yt.headers||Object.keys(Yt.headers).reduce((Cr,Rr)=>Cr&&Rr==="accept",!0));xt++;const Ar=vr?Ut(Yt,gr):it.m(Yt,gr);try{const Cr=yield Ar;delete Gt.abortController,Gt.state="completed",Cr.data instanceof HTMLImageElement||it.b(Cr.data)?sr(Cr):Cr.data&&sr({data:yield(Er=Cr.data,typeof createImageBitmap=="function"?it.d(Er):it.f(Er)),cacheControl:Cr.cacheControl,expires:Cr.expires})}catch(Cr){delete Gt.abortController,Jt(Cr)}finally{xt--,Bt()}var Er}),Bt=()=>{const Gt=(()=>{for(const Yt of Object.keys(It))if(It[Yt]())return!0;return!1})()?it.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:it.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let Yt=xt;Yt<Gt&&dt.length>0;Yt++){const Kt=dt.shift();Kt.abortController.signal.aborted?Yt--:Pt(Kt)}},Ut=(Gt,Yt)=>new Promise((Kt,Jt)=>{const sr=new Image,gr=Gt.url,vr=Gt.credentials;vr&&vr==="include"?sr.crossOrigin="use-credentials":(vr&&vr==="same-origin"||!it.s(gr))&&(sr.crossOrigin="anonymous"),Yt.signal.addEventListener("abort",()=>{sr.src="",Jt(it.c())}),sr.fetchPriority="high",sr.onload=()=>{sr.onerror=sr.onload=null,Kt({data:sr})},sr.onerror=()=>{sr.onerror=sr.onload=null,Yt.signal.aborted||Jt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},sr.src=gr})}(Tt||(Tt={})),Tt.resetRequestQueue();class Ct{constructor(dt){this._transformRequestFn=dt}transformRequest(dt,xt){return this._transformRequestFn&&this._transformRequestFn(dt,xt)||{url:dt}}setTransformRequest(dt){this._transformRequestFn=dt}}function Dt(Mt){var dt=new it.A(3);return dt[0]=Mt[0],dt[1]=Mt[1],dt[2]=Mt[2],dt}var Ot,$t=function(Mt,dt,xt){return Mt[0]=dt[0]-xt[0],Mt[1]=dt[1]-xt[1],Mt[2]=dt[2]-xt[2],Mt};Ot=new it.A(3),it.A!=Float32Array&&(Ot[0]=0,Ot[1]=0,Ot[2]=0);var Ft=function(Mt){var dt=Mt[0],xt=Mt[1];return dt*dt+xt*xt};function kt(Mt){const dt=[];if(typeof Mt=="string")dt.push({id:"default",url:Mt});else if(Mt&&Mt.length>0){const xt=[];for(const{id:At,url:It}of Mt){const Pt=`${At}${It}`;xt.indexOf(Pt)===-1&&(xt.push(Pt),dt.push({id:At,url:It}))}}return dt}function Vt(Mt,dt,xt){const At=Mt.split("?");return At[0]+=`${dt}${xt}`,At.join("?")}(function(){var Mt=new it.A(2);it.A!=Float32Array&&(Mt[0]=0,Mt[1]=0)})();class Ht{constructor(dt,xt,At,It){this.context=dt,this.format=At,this.texture=dt.gl.createTexture(),this.update(xt,It)}update(dt,xt,At){const{width:It,height:Pt}=dt,Bt=!(this.size&&this.size[0]===It&&this.size[1]===Pt||At),{context:Ut}=this,{gl:Gt}=Ut;if(this.useMipmap=!!(xt&&xt.useMipmap),Gt.bindTexture(Gt.TEXTURE_2D,this.texture),Ut.pixelStoreUnpackFlipY.set(!1),Ut.pixelStoreUnpack.set(1),Ut.pixelStoreUnpackPremultiplyAlpha.set(this.format===Gt.RGBA&&(!xt||xt.premultiply!==!1)),Bt)this.size=[It,Pt],dt instanceof HTMLImageElement||dt instanceof HTMLCanvasElement||dt instanceof HTMLVideoElement||dt instanceof ImageData||it.b(dt)?Gt.texImage2D(Gt.TEXTURE_2D,0,this.format,this.format,Gt.UNSIGNED_BYTE,dt):Gt.texImage2D(Gt.TEXTURE_2D,0,this.format,It,Pt,0,this.format,Gt.UNSIGNED_BYTE,dt.data);else{const{x:Yt,y:Kt}=At||{x:0,y:0};dt instanceof HTMLImageElement||dt instanceof HTMLCanvasElement||dt instanceof HTMLVideoElement||dt instanceof ImageData||it.b(dt)?Gt.texSubImage2D(Gt.TEXTURE_2D,0,Yt,Kt,Gt.RGBA,Gt.UNSIGNED_BYTE,dt):Gt.texSubImage2D(Gt.TEXTURE_2D,0,Yt,Kt,It,Pt,Gt.RGBA,Gt.UNSIGNED_BYTE,dt.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Gt.generateMipmap(Gt.TEXTURE_2D)}bind(dt,xt,At){const{context:It}=this,{gl:Pt}=It;Pt.bindTexture(Pt.TEXTURE_2D,this.texture),At!==Pt.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(At=Pt.LINEAR),dt!==this.filter&&(Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MAG_FILTER,dt),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MIN_FILTER,At||dt),this.filter=dt),xt!==this.wrap&&(Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_S,xt),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_T,xt),this.wrap=xt)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:dt}=this.context;dt.deleteTexture(this.texture),this.texture=null}}function Qt(Mt){const{userImage:dt}=Mt;return!!(dt&&dt.render&&dt.render())&&(Mt.data.replace(new Uint8Array(dt.data.buffer)),!0)}class Xt extends it.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new it.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(dt){if(this.loaded!==dt&&(this.loaded=dt,dt)){for(const{ids:xt,promiseResolve:At}of this.requestors)At(this._getImagesForIds(xt));this.requestors=[]}}getImage(dt){const xt=this.images[dt];if(xt&&!xt.data&&xt.spriteData){const At=xt.spriteData;xt.data=new it.R({width:At.width,height:At.height},At.context.getImageData(At.x,At.y,At.width,At.height).data),xt.spriteData=null}return xt}addImage(dt,xt){if(this.images[dt])throw new Error(`Image id ${dt} already exist, use updateImage instead`);this._validate(dt,xt)&&(this.images[dt]=xt)}_validate(dt,xt){let At=!0;const It=xt.data||xt.spriteData;return this._validateStretch(xt.stretchX,It&&It.width)||(this.fire(new it.j(new Error(`Image "${dt}" has invalid "stretchX" value`))),At=!1),this._validateStretch(xt.stretchY,It&&It.height)||(this.fire(new it.j(new Error(`Image "${dt}" has invalid "stretchY" value`))),At=!1),this._validateContent(xt.content,xt)||(this.fire(new it.j(new Error(`Image "${dt}" has invalid "content" value`))),At=!1),At}_validateStretch(dt,xt){if(!dt)return!0;let At=0;for(const It of dt){if(It[0]<At||It[1]<It[0]||xt<It[1])return!1;At=It[1]}return!0}_validateContent(dt,xt){if(!dt)return!0;if(dt.length!==4)return!1;const At=xt.spriteData,It=At&&At.width||xt.data.width,Pt=At&&At.height||xt.data.height;return!(dt[0]<0||It<dt[0]||dt[1]<0||Pt<dt[1]||dt[2]<0||It<dt[2]||dt[3]<0||Pt<dt[3]||dt[2]<dt[0]||dt[3]<dt[1])}updateImage(dt,xt,At=!0){const It=this.getImage(dt);if(At&&(It.data.width!==xt.data.width||It.data.height!==xt.data.height))throw new Error(`size mismatch between old image (${It.data.width}x${It.data.height}) and new image (${xt.data.width}x${xt.data.height}).`);xt.version=It.version+1,this.images[dt]=xt,this.updatedImages[dt]=!0}removeImage(dt){const xt=this.images[dt];delete this.images[dt],delete this.patterns[dt],xt.userImage&&xt.userImage.onRemove&&xt.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(dt){return new Promise((xt,At)=>{let It=!0;if(!this.isLoaded())for(const Pt of dt)this.images[Pt]||(It=!1);this.isLoaded()||It?xt(this._getImagesForIds(dt)):this.requestors.push({ids:dt,promiseResolve:xt})})}_getImagesForIds(dt){const xt={};for(const At of dt){let It=this.getImage(At);It||(this.fire(new it.k("styleimagemissing",{id:At})),It=this.getImage(At)),It?xt[At]={data:It.data.clone(),pixelRatio:It.pixelRatio,sdf:It.sdf,version:It.version,stretchX:It.stretchX,stretchY:It.stretchY,content:It.content,textFitWidth:It.textFitWidth,textFitHeight:It.textFitHeight,hasRenderCallback:!!(It.userImage&&It.userImage.render)}:it.w(`Image "${At}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return xt}getPixelSize(){const{width:dt,height:xt}=this.atlasImage;return{width:dt,height:xt}}getPattern(dt){const xt=this.patterns[dt],At=this.getImage(dt);if(!At)return null;if(xt&&xt.position.version===At.version)return xt.position;if(xt)xt.position.version=At.version;else{const It={w:At.data.width+2,h:At.data.height+2,x:0,y:0},Pt=new it.I(It,At);this.patterns[dt]={bin:It,position:Pt}}return this._updatePatternAtlas(),this.patterns[dt].position}bind(dt){const xt=dt.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ht(dt,this.atlasImage,xt.RGBA),this.atlasTexture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE)}_updatePatternAtlas(){const dt=[];for(const Pt in this.patterns)dt.push(this.patterns[Pt].bin);const{w:xt,h:At}=it.p(dt),It=this.atlasImage;It.resize({width:xt||1,height:At||1});for(const Pt in this.patterns){const{bin:Bt}=this.patterns[Pt],Ut=Bt.x+1,Gt=Bt.y+1,Yt=this.getImage(Pt).data,Kt=Yt.width,Jt=Yt.height;it.R.copy(Yt,It,{x:0,y:0},{x:Ut,y:Gt},{width:Kt,height:Jt}),it.R.copy(Yt,It,{x:0,y:Jt-1},{x:Ut,y:Gt-1},{width:Kt,height:1}),it.R.copy(Yt,It,{x:0,y:0},{x:Ut,y:Gt+Jt},{width:Kt,height:1}),it.R.copy(Yt,It,{x:Kt-1,y:0},{x:Ut-1,y:Gt},{width:1,height:Jt}),it.R.copy(Yt,It,{x:0,y:0},{x:Ut+Kt,y:Gt},{width:1,height:Jt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(dt){for(const xt of dt){if(this.callbackDispatchedThisFrame[xt])continue;this.callbackDispatchedThisFrame[xt]=!0;const At=this.getImage(xt);At||it.w(`Image with ID: "${xt}" was not found`),Qt(At)&&this.updateImage(xt,At)}}}const Zt=1e20;function ar(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt){for(let Yt=dt;Yt<dt+At;Yt++)nr(Mt,xt*Pt+Yt,Pt,It,Bt,Ut,Gt);for(let Yt=xt;Yt<xt+It;Yt++)nr(Mt,Yt*Pt+dt,1,At,Bt,Ut,Gt)}function nr(Mt,dt,xt,At,It,Pt,Bt){Pt[0]=0,Bt[0]=-Zt,Bt[1]=Zt,It[0]=Mt[dt];for(let Ut=1,Gt=0,Yt=0;Ut<At;Ut++){It[Ut]=Mt[dt+Ut*xt];const Kt=Ut*Ut;do{const Jt=Pt[Gt];Yt=(It[Ut]-It[Jt]+Kt-Jt*Jt)/(Ut-Jt)/2}while(Yt<=Bt[Gt]&&--Gt>-1);Gt++,Pt[Gt]=Ut,Bt[Gt]=Yt,Bt[Gt+1]=Zt}for(let Ut=0,Gt=0;Ut<At;Ut++){for(;Bt[Gt+1]<Ut;)Gt++;const Yt=Pt[Gt],Kt=Ut-Yt;Mt[dt+Ut*xt]=It[Yt]+Kt*Kt}}class cr{constructor(dt,xt){this.requestManager=dt,this.localIdeographFontFamily=xt,this.entries={}}setURL(dt){this.url=dt}getGlyphs(dt){return it._(this,void 0,void 0,function*(){const xt=[];for(const Pt in dt)for(const Bt of dt[Pt])xt.push(this._getAndCacheGlyphsPromise(Pt,Bt));const At=yield Promise.all(xt),It={};for(const{stack:Pt,id:Bt,glyph:Ut}of At)It[Pt]||(It[Pt]={}),It[Pt][Bt]=Ut&&{id:Ut.id,bitmap:Ut.bitmap.clone(),metrics:Ut.metrics};return It})}_getAndCacheGlyphsPromise(dt,xt){return it._(this,void 0,void 0,function*(){let At=this.entries[dt];At||(At=this.entries[dt]={glyphs:{},requests:{},ranges:{}});let It=At.glyphs[xt];if(It!==void 0)return{stack:dt,id:xt,glyph:It};if(It=this._tinySDF(At,dt,xt),It)return At.glyphs[xt]=It,{stack:dt,id:xt,glyph:It};const Pt=Math.floor(xt/256);if(256*Pt>65535)throw new Error("glyphs > 65535 not supported");if(At.ranges[Pt])return{stack:dt,id:xt,glyph:It};if(!this.url)throw new Error("glyphsUrl is not set");if(!At.requests[Pt]){const Ut=cr.loadGlyphRange(dt,Pt,this.url,this.requestManager);At.requests[Pt]=Ut}const Bt=yield At.requests[Pt];for(const Ut in Bt)this._doesCharSupportLocalGlyph(+Ut)||(At.glyphs[+Ut]=Bt[+Ut]);return At.ranges[Pt]=!0,{stack:dt,id:xt,glyph:Bt[xt]||null}})}_doesCharSupportLocalGlyph(dt){return!!this.localIdeographFontFamily&&/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(dt))}_tinySDF(dt,xt,At){const It=this.localIdeographFontFamily;if(!It||!this._doesCharSupportLocalGlyph(At))return;let Pt=dt.tinySDF;if(!Pt){let Ut="400";/bold/i.test(xt)?Ut="900":/medium/i.test(xt)?Ut="500":/light/i.test(xt)&&(Ut="200"),Pt=dt.tinySDF=new cr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:It,fontWeight:Ut})}const Bt=Pt.draw(String.fromCharCode(At));return{id:At,bitmap:new it.o({width:Bt.width||60,height:Bt.height||60},Bt.data),metrics:{width:Bt.glyphWidth/2||24,height:Bt.glyphHeight/2||24,left:Bt.glyphLeft/2+.5||0,top:Bt.glyphTop/2-27.5||-8,advance:Bt.glyphAdvance/2||24,isDoubleResolution:!0}}}}cr.loadGlyphRange=function(Mt,dt,xt,At){return it._(this,void 0,void 0,function*(){const It=256*dt,Pt=It+255,Bt=At.transformRequest(xt.replace("{fontstack}",Mt).replace("{range}",`${It}-${Pt}`),"Glyphs"),Ut=yield it.l(Bt,new AbortController);if(!Ut||!Ut.data)throw new Error(`Could not load glyph range. range: ${dt}, ${It}-${Pt}`);const Gt={};for(const Yt of it.n(Ut.data))Gt[Yt.id]=Yt;return Gt})},cr.TinySDF=class{constructor({fontSize:Mt=24,buffer:dt=3,radius:xt=8,cutoff:At=.25,fontFamily:It="sans-serif",fontWeight:Pt="normal",fontStyle:Bt="normal"}={}){this.buffer=dt,this.cutoff=At,this.radius=xt;const Ut=this.size=Mt+4*dt,Gt=this._createCanvas(Ut),Yt=this.ctx=Gt.getContext("2d",{willReadFrequently:!0});Yt.font=`${Bt} ${Pt} ${Mt}px ${It}`,Yt.textBaseline="alphabetic",Yt.textAlign="left",Yt.fillStyle="black",this.gridOuter=new Float64Array(Ut*Ut),this.gridInner=new Float64Array(Ut*Ut),this.f=new Float64Array(Ut),this.z=new Float64Array(Ut+1),this.v=new Uint16Array(Ut)}_createCanvas(Mt){const dt=document.createElement("canvas");return dt.width=dt.height=Mt,dt}draw(Mt){const{width:dt,actualBoundingBoxAscent:xt,actualBoundingBoxDescent:At,actualBoundingBoxLeft:It,actualBoundingBoxRight:Pt}=this.ctx.measureText(Mt),Bt=Math.ceil(xt),Ut=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(Pt-It))),Gt=Math.min(this.size-this.buffer,Bt+Math.ceil(At)),Yt=Ut+2*this.buffer,Kt=Gt+2*this.buffer,Jt=Math.max(Yt*Kt,0),sr=new Uint8ClampedArray(Jt),gr={data:sr,width:Yt,height:Kt,glyphWidth:Ut,glyphHeight:Gt,glyphTop:Bt,glyphLeft:0,glyphAdvance:dt};if(Ut===0||Gt===0)return gr;const{ctx:vr,buffer:Ar,gridInner:Er,gridOuter:Cr}=this;vr.clearRect(Ar,Ar,Ut,Gt),vr.fillText(Mt,Ar,Ar+Bt);const Rr=vr.getImageData(Ar,Ar,Ut,Gt);Cr.fill(Zt,0,Jt),Er.fill(0,0,Jt);for(let Sr=0;Sr<Gt;Sr++)for(let Br=0;Br<Ut;Br++){const Gr=Rr.data[4*(Sr*Ut+Br)+3]/255;if(Gr===0)continue;const qr=(Sr+Ar)*Yt+Br+Ar;if(Gr===1)Cr[qr]=0,Er[qr]=Zt;else{const ln=.5-Gr;Cr[qr]=ln>0?ln*ln:0,Er[qr]=ln<0?ln*ln:0}}ar(Cr,0,0,Yt,Kt,Yt,this.f,this.v,this.z),ar(Er,Ar,Ar,Ut,Gt,Yt,this.f,this.v,this.z);for(let Sr=0;Sr<Jt;Sr++){const Br=Math.sqrt(Cr[Sr])-Math.sqrt(Er[Sr]);sr[Sr]=Math.round(255-255*(Br/this.radius+this.cutoff))}return gr}};class dr{constructor(){this.specification=it.v.light.position}possiblyEvaluate(dt,xt){return it.x(dt.expression.evaluate(xt))}interpolate(dt,xt,At){return{x:it.y.number(dt.x,xt.x,At),y:it.y.number(dt.y,xt.y,At),z:it.y.number(dt.z,xt.z,At)}}}let mr;class Dr extends it.E{constructor(dt){super(),mr=mr||new it.q({anchor:new it.D(it.v.light.anchor),position:new dr,color:new it.D(it.v.light.color),intensity:new it.D(it.v.light.intensity)}),this._transitionable=new it.T(mr),this.setLight(dt),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(dt,xt={}){if(!this._validate(it.r,dt,xt))for(const At in dt){const It=dt[At];At.endsWith("-transition")?this._transitionable.setTransition(At.slice(0,-11),It):this._transitionable.setValue(At,It)}}updateTransitions(dt){this._transitioning=this._transitionable.transitioned(dt,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(dt){this.properties=this._transitioning.possiblyEvaluate(dt)}_validate(dt,xt,At){return(!At||At.validate!==!1)&&it.t(this,dt.call(it.u,{value:xt,style:{glyphs:!0,sprite:!0},styleSpec:it.v}))}}const kr=new it.q({"sky-color":new it.D(it.v.sky["sky-color"]),"horizon-color":new it.D(it.v.sky["horizon-color"]),"fog-color":new it.D(it.v.sky["fog-color"]),"fog-ground-blend":new it.D(it.v.sky["fog-ground-blend"]),"horizon-fog-blend":new it.D(it.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new it.D(it.v.sky["sky-horizon-blend"]),"atmosphere-blend":new it.D(it.v.sky["atmosphere-blend"])});class Yr extends it.E{constructor(dt){super(),this._transitionable=new it.T(kr),this.setSky(dt),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new it.z(0))}setSky(dt,xt={}){if(!this._validate(it.B,dt,xt)){dt||(dt={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const At in dt){const It=dt[At];At.endsWith("-transition")?this._transitionable.setTransition(At.slice(0,-11),It):this._transitionable.setValue(At,It)}}}getSky(){return this._transitionable.serialize()}updateTransitions(dt){this._transitioning=this._transitionable.transitioned(dt,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(dt){this.properties=this._transitioning.possiblyEvaluate(dt)}_validate(dt,xt,At={}){return At?.validate!==!1&&it.t(this,dt.call(it.u,it.e({value:xt,style:{glyphs:!0,sprite:!0},styleSpec:it.v})))}calculateFogBlendOpacity(dt){return dt<60?0:dt<70?(dt-60)/10:1}}class Mr{constructor(dt,xt){this.width=dt,this.height=xt,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(dt,xt){const At=dt.join(",")+String(xt);return this.dashEntry[At]||(this.dashEntry[At]=this.addDash(dt,xt)),this.dashEntry[At]}getDashRanges(dt,xt,At){const It=[];let Pt=dt.length%2==1?-dt[dt.length-1]*At:0,Bt=dt[0]*At,Ut=!0;It.push({left:Pt,right:Bt,isDash:Ut,zeroLength:dt[0]===0});let Gt=dt[0];for(let Yt=1;Yt<dt.length;Yt++){Ut=!Ut;const Kt=dt[Yt];Pt=Gt*At,Gt+=Kt,Bt=Gt*At,It.push({left:Pt,right:Bt,isDash:Ut,zeroLength:Kt===0})}return It}addRoundDash(dt,xt,At){const It=xt/2;for(let Pt=-At;Pt<=At;Pt++){const Bt=this.width*(this.nextRow+At+Pt);let Ut=0,Gt=dt[Ut];for(let Yt=0;Yt<this.width;Yt++){Yt/Gt.right>1&&(Gt=dt[++Ut]);const Kt=Math.abs(Yt-Gt.left),Jt=Math.abs(Yt-Gt.right),sr=Math.min(Kt,Jt);let gr;const vr=Pt/At*(It+1);if(Gt.isDash){const Ar=It-Math.abs(vr);gr=Math.sqrt(sr*sr+Ar*Ar)}else gr=It-Math.sqrt(sr*sr+vr*vr);this.data[Bt+Yt]=Math.max(0,Math.min(255,gr+128))}}}addRegularDash(dt){for(let Ut=dt.length-1;Ut>=0;--Ut){const Gt=dt[Ut],Yt=dt[Ut+1];Gt.zeroLength?dt.splice(Ut,1):Yt&&Yt.isDash===Gt.isDash&&(Yt.left=Gt.left,dt.splice(Ut,1))}const xt=dt[0],At=dt[dt.length-1];xt.isDash===At.isDash&&(xt.left=At.left-this.width,At.right=xt.right+this.width);const It=this.width*this.nextRow;let Pt=0,Bt=dt[Pt];for(let Ut=0;Ut<this.width;Ut++){Ut/Bt.right>1&&(Bt=dt[++Pt]);const Gt=Math.abs(Ut-Bt.left),Yt=Math.abs(Ut-Bt.right),Kt=Math.min(Gt,Yt);this.data[It+Ut]=Math.max(0,Math.min(255,(Bt.isDash?Kt:-Kt)+128))}}addDash(dt,xt){const At=xt?7:0,It=2*At+1;if(this.nextRow+It>this.height)return it.w("LineAtlas out of space"),null;let Pt=0;for(let Ut=0;Ut<dt.length;Ut++)Pt+=dt[Ut];if(Pt!==0){const Ut=this.width/Pt,Gt=this.getDashRanges(dt,this.width,Ut);xt?this.addRoundDash(Gt,Ut,At):this.addRegularDash(Gt)}const Bt={y:(this.nextRow+At+.5)/this.height,height:2*At/this.height,width:Pt};return this.nextRow+=It,this.dirty=!0,Bt}bind(dt){const xt=dt.gl;this.texture?(xt.bindTexture(xt.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,xt.texSubImage2D(xt.TEXTURE_2D,0,0,0,this.width,this.height,xt.ALPHA,xt.UNSIGNED_BYTE,this.data))):(this.texture=xt.createTexture(),xt.bindTexture(xt.TEXTURE_2D,this.texture),xt.texParameteri(xt.TEXTURE_2D,xt.TEXTURE_WRAP_S,xt.REPEAT),xt.texParameteri(xt.TEXTURE_2D,xt.TEXTURE_WRAP_T,xt.REPEAT),xt.texParameteri(xt.TEXTURE_2D,xt.TEXTURE_MIN_FILTER,xt.LINEAR),xt.texParameteri(xt.TEXTURE_2D,xt.TEXTURE_MAG_FILTER,xt.LINEAR),xt.texImage2D(xt.TEXTURE_2D,0,xt.ALPHA,this.width,this.height,0,xt.ALPHA,xt.UNSIGNED_BYTE,this.data))}}const Jr="maplibre_preloaded_worker_pool";class an{constructor(){this.active={}}acquire(dt){if(!this.workers)for(this.workers=[];this.workers.length<an.workerCount;)this.workers.push(new Worker(it.a.WORKER_URL));return this.active[dt]=!0,this.workers.slice()}release(dt){delete this.active[dt],this.numActive()===0&&(this.workers.forEach(xt=>{xt.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Jr]}numActive(){return Object.keys(this.active).length}}const xn=Math.floor(ot.hardwareConcurrency/2);let Rn,hn;function pn(){return Rn||(Rn=new an),Rn}an.workerCount=it.C(globalThis)?Math.max(Math.min(xn,3),1):1;class yn{constructor(dt,xt){this.workerPool=dt,this.actors=[],this.currentActor=0,this.id=xt;const At=this.workerPool.acquire(xt);for(let It=0;It<At.length;It++){const Pt=new it.F(At[It],xt);Pt.name=`Worker ${It}`,this.actors.push(Pt)}if(!this.actors.length)throw new Error("No actors found")}broadcast(dt,xt){const At=[];for(const It of this.actors)At.push(It.sendAsync({type:dt,data:xt}));return Promise.all(At)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(dt=!0){this.actors.forEach(xt=>{xt.remove()}),this.actors=[],dt&&this.workerPool.release(this.id)}registerMessageHandler(dt,xt){for(const At of this.actors)At.registerMessageHandler(dt,xt)}}function un(){return hn||(hn=new yn(pn(),it.G),hn.registerMessageHandler("GR",(Mt,dt,xt)=>it.m(dt,xt))),hn}function fn(Mt,dt){const xt=it.H();return it.J(xt,xt,[1,1,0]),it.K(xt,xt,[.5*Mt.width,.5*Mt.height,1]),it.L(xt,xt,Mt.calculatePosMatrix(dt.toUnwrapped()))}function Bn(Mt,dt,xt,At,It,Pt){const Bt=function(Jt,sr,gr){if(Jt)for(const vr of Jt){const Ar=sr[vr];if(Ar&&Ar.source===gr&&Ar.type==="fill-extrusion")return!0}else for(const vr in sr){const Ar=sr[vr];if(Ar.source===gr&&Ar.type==="fill-extrusion")return!0}return!1}(It&&It.layers,dt,Mt.id),Ut=Pt.maxPitchScaleFactor(),Gt=Mt.tilesIn(At,Ut,Bt);Gt.sort(Dn);const Yt=[];for(const Jt of Gt)Yt.push({wrappedTileID:Jt.tileID.wrapped().key,queryResults:Jt.tile.queryRenderedFeatures(dt,xt,Mt._state,Jt.queryGeometry,Jt.cameraQueryGeometry,Jt.scale,It,Pt,Ut,fn(Mt.transform,Jt.tileID))});const Kt=function(Jt){const sr={},gr={};for(const vr of Jt){const Ar=vr.queryResults,Er=vr.wrappedTileID,Cr=gr[Er]=gr[Er]||{};for(const Rr in Ar){const Sr=Ar[Rr],Br=Cr[Rr]=Cr[Rr]||{},Gr=sr[Rr]=sr[Rr]||[];for(const qr of Sr)Br[qr.featureIndex]||(Br[qr.featureIndex]=!0,Gr.push(qr))}}return sr}(Yt);for(const Jt in Kt)Kt[Jt].forEach(sr=>{const gr=sr.feature,vr=Mt.getFeatureState(gr.layer["source-layer"],gr.id);gr.source=gr.layer.source,gr.layer["source-layer"]&&(gr.sourceLayer=gr.layer["source-layer"]),gr.state=vr});return Kt}function Dn(Mt,dt){const xt=Mt.tileID,At=dt.tileID;return xt.overscaledZ-At.overscaledZ||xt.canonical.y-At.canonical.y||xt.wrap-At.wrap||xt.canonical.x-At.canonical.x}function Qn(Mt,dt,xt){return it._(this,void 0,void 0,function*(){let At=Mt;if(Mt.url?At=(yield it.h(dt.transformRequest(Mt.url,"Source"),xt)).data:yield ot.frameAsync(xt),!At)return null;const It=it.M(it.e(At,Mt),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in At&&At.vector_layers&&(It.vectorLayerIds=At.vector_layers.map(Pt=>Pt.id)),It})}class zr{constructor(dt,xt){dt&&(xt?this.setSouthWest(dt).setNorthEast(xt):Array.isArray(dt)&&(dt.length===4?this.setSouthWest([dt[0],dt[1]]).setNorthEast([dt[2],dt[3]]):this.setSouthWest(dt[0]).setNorthEast(dt[1])))}setNorthEast(dt){return this._ne=dt instanceof it.N?new it.N(dt.lng,dt.lat):it.N.convert(dt),this}setSouthWest(dt){return this._sw=dt instanceof it.N?new it.N(dt.lng,dt.lat):it.N.convert(dt),this}extend(dt){const xt=this._sw,At=this._ne;let It,Pt;if(dt instanceof it.N)It=dt,Pt=dt;else{if(!(dt instanceof zr))return Array.isArray(dt)?dt.length===4||dt.every(Array.isArray)?this.extend(zr.convert(dt)):this.extend(it.N.convert(dt)):dt&&("lng"in dt||"lon"in dt)&&"lat"in dt?this.extend(it.N.convert(dt)):this;if(It=dt._sw,Pt=dt._ne,!It||!Pt)return this}return xt||At?(xt.lng=Math.min(It.lng,xt.lng),xt.lat=Math.min(It.lat,xt.lat),At.lng=Math.max(Pt.lng,At.lng),At.lat=Math.max(Pt.lat,At.lat)):(this._sw=new it.N(It.lng,It.lat),this._ne=new it.N(Pt.lng,Pt.lat)),this}getCenter(){return new it.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new it.N(this.getWest(),this.getNorth())}getSouthEast(){return new it.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(dt){const{lng:xt,lat:At}=it.N.convert(dt);let It=this._sw.lng<=xt&&xt<=this._ne.lng;return this._sw.lng>this._ne.lng&&(It=this._sw.lng>=xt&&xt>=this._ne.lng),this._sw.lat<=At&&At<=this._ne.lat&&It}static convert(dt){return dt instanceof zr?dt:dt&&new zr(dt)}static fromLngLat(dt,xt=0){const At=360*xt/40075017,It=At/Math.cos(Math.PI/180*dt.lat);return new zr(new it.N(dt.lng-It,dt.lat-At),new it.N(dt.lng+It,dt.lat+At))}adjustAntiMeridian(){const dt=new it.N(this._sw.lng,this._sw.lat),xt=new it.N(this._ne.lng,this._ne.lat);return new zr(dt,dt.lng>xt.lng?new it.N(xt.lng+360,xt.lat):xt)}}class ao{constructor(dt,xt,At){this.bounds=zr.convert(this.validateBounds(dt)),this.minzoom=xt||0,this.maxzoom=At||24}validateBounds(dt){return Array.isArray(dt)&&dt.length===4?[Math.max(-180,dt[0]),Math.max(-90,dt[1]),Math.min(180,dt[2]),Math.min(90,dt[3])]:[-180,-90,180,90]}contains(dt){const xt=Math.pow(2,dt.z),At=Math.floor(it.O(this.bounds.getWest())*xt),It=Math.floor(it.Q(this.bounds.getNorth())*xt),Pt=Math.ceil(it.O(this.bounds.getEast())*xt),Bt=Math.ceil(it.Q(this.bounds.getSouth())*xt);return dt.x>=At&&dt.x<Pt&&dt.y>=It&&dt.y<Bt}}class oo extends it.E{constructor(dt,xt,At,It){if(super(),this.id=dt,this.dispatcher=At,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,it.e(this,it.M(xt,["url","scheme","tileSize","promoteId"])),this._options=it.e({type:"vector"},xt),this._collectResourceTiming=xt.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(It)}load(){return it._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new it.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const dt=yield Qn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),dt&&(it.e(this,dt),dt.bounds&&(this.tileBounds=new ao(dt.bounds,this.minzoom,this.maxzoom)),this.fire(new it.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new it.k("data",{dataType:"source",sourceDataType:"content"})))}catch(dt){this._tileJSONRequest=null,this.fire(new it.j(dt))}})}loaded(){return this._loaded}hasTile(dt){return!this.tileBounds||this.tileBounds.contains(dt.canonical)}onAdd(dt){this.map=dt,this.load()}setSourceProperty(dt){this._tileJSONRequest&&this._tileJSONRequest.abort(),dt(),this.load()}setTiles(dt){return this.setSourceProperty(()=>{this._options.tiles=dt}),this}setUrl(dt){return this.setSourceProperty(()=>{this.url=dt,this._options.url=dt}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return it.e({},this._options)}loadTile(dt){return it._(this,void 0,void 0,function*(){const xt=dt.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),At={request:this.map._requestManager.transformRequest(xt,"Tile"),uid:dt.uid,tileID:dt.tileID,zoom:dt.tileID.overscaledZ,tileSize:this.tileSize*dt.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};At.request.collectResourceTiming=this._collectResourceTiming;let It="RT";if(dt.actor&&dt.state!=="expired"){if(dt.state==="loading")return new Promise((Pt,Bt)=>{dt.reloadPromise={resolve:Pt,reject:Bt}})}else dt.actor=this.dispatcher.getActor(),It="LT";dt.abortController=new AbortController;try{const Pt=yield dt.actor.sendAsync({type:It,data:At},dt.abortController);if(delete dt.abortController,dt.aborted)return;this._afterTileLoadWorkerResponse(dt,Pt)}catch(Pt){if(delete dt.abortController,dt.aborted)return;if(Pt&&Pt.status!==404)throw Pt;this._afterTileLoadWorkerResponse(dt,null)}})}_afterTileLoadWorkerResponse(dt,xt){if(xt&&xt.resourceTiming&&(dt.resourceTiming=xt.resourceTiming),xt&&this.map._refreshExpiredTiles&&dt.setExpiryData(xt),dt.loadVectorData(xt,this.map.painter),dt.reloadPromise){const At=dt.reloadPromise;dt.reloadPromise=null,this.loadTile(dt).then(At.resolve).catch(At.reject)}}abortTile(dt){return it._(this,void 0,void 0,function*(){dt.abortController&&(dt.abortController.abort(),delete dt.abortController),dt.actor&&(yield dt.actor.sendAsync({type:"AT",data:{uid:dt.uid,type:this.type,source:this.id}}))})}unloadTile(dt){return it._(this,void 0,void 0,function*(){dt.unloadVectorData(),dt.actor&&(yield dt.actor.sendAsync({type:"RMT",data:{uid:dt.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Wn extends it.E{constructor(dt,xt,At,It){super(),this.id=dt,this.dispatcher=At,this.setEventedParent(It),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=it.e({type:"raster"},xt),it.e(this,it.M(xt,["url","scheme","tileSize"]))}load(){return it._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new it.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const dt=yield Qn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,dt&&(it.e(this,dt),dt.bounds&&(this.tileBounds=new ao(dt.bounds,this.minzoom,this.maxzoom)),this.fire(new it.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new it.k("data",{dataType:"source",sourceDataType:"content"})))}catch(dt){this._tileJSONRequest=null,this.fire(new it.j(dt))}})}loaded(){return this._loaded}onAdd(dt){this.map=dt,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(dt){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),dt(),this.load()}setTiles(dt){return this.setSourceProperty(()=>{this._options.tiles=dt}),this}setUrl(dt){return this.setSourceProperty(()=>{this.url=dt,this._options.url=dt}),this}serialize(){return it.e({},this._options)}hasTile(dt){return!this.tileBounds||this.tileBounds.contains(dt.canonical)}loadTile(dt){return it._(this,void 0,void 0,function*(){const xt=dt.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);dt.abortController=new AbortController;try{const At=yield Tt.getImage(this.map._requestManager.transformRequest(xt,"Tile"),dt.abortController,this.map._refreshExpiredTiles);if(delete dt.abortController,dt.aborted)return void(dt.state="unloaded");if(At&&At.data){this.map._refreshExpiredTiles&&At.cacheControl&&At.expires&&dt.setExpiryData({cacheControl:At.cacheControl,expires:At.expires});const It=this.map.painter.context,Pt=It.gl,Bt=At.data;dt.texture=this.map.painter.getTileTexture(Bt.width),dt.texture?dt.texture.update(Bt,{useMipmap:!0}):(dt.texture=new Ht(It,Bt,Pt.RGBA,{useMipmap:!0}),dt.texture.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE,Pt.LINEAR_MIPMAP_NEAREST)),dt.state="loaded"}}catch(At){if(delete dt.abortController,dt.aborted)dt.state="unloaded";else if(At)throw dt.state="errored",At}})}abortTile(dt){return it._(this,void 0,void 0,function*(){dt.abortController&&(dt.abortController.abort(),delete dt.abortController)})}unloadTile(dt){return it._(this,void 0,void 0,function*(){dt.texture&&this.map.painter.saveTileTexture(dt.texture)})}hasTransition(){return!1}}class no extends Wn{constructor(dt,xt,At,It){super(dt,xt,At,It),this.type="raster-dem",this.maxzoom=22,this._options=it.e({type:"raster-dem"},xt),this.encoding=xt.encoding||"mapbox",this.redFactor=xt.redFactor,this.greenFactor=xt.greenFactor,this.blueFactor=xt.blueFactor,this.baseShift=xt.baseShift}loadTile(dt){return it._(this,void 0,void 0,function*(){const xt=dt.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),At=this.map._requestManager.transformRequest(xt,"Tile");dt.neighboringTiles=this._getNeighboringTiles(dt.tileID),dt.abortController=new AbortController;try{const It=yield Tt.getImage(At,dt.abortController,this.map._refreshExpiredTiles);if(delete dt.abortController,dt.aborted)return void(dt.state="unloaded");if(It&&It.data){const Pt=It.data;this.map._refreshExpiredTiles&&It.cacheControl&&It.expires&&dt.setExpiryData({cacheControl:It.cacheControl,expires:It.expires});const Bt=it.b(Pt)&&it.U()?Pt:yield this.readImageNow(Pt),Ut={type:this.type,uid:dt.uid,source:this.id,rawImageData:Bt,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!dt.actor||dt.state==="expired"){dt.actor=this.dispatcher.getActor();const Gt=yield dt.actor.sendAsync({type:"LDT",data:Ut});dt.dem=Gt,dt.needsHillshadePrepare=!0,dt.needsTerrainPrepare=!0,dt.state="loaded"}}}catch(It){if(delete dt.abortController,dt.aborted)dt.state="unloaded";else if(It)throw dt.state="errored",It}})}readImageNow(dt){return it._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&it.V()){const xt=dt.width+2,At=dt.height+2;try{return new it.R({width:xt,height:At},yield it.W(dt,-1,-1,xt,At))}catch{}}return ot.getImageData(dt,1)})}_getNeighboringTiles(dt){const xt=dt.canonical,At=Math.pow(2,xt.z),It=(xt.x-1+At)%At,Pt=xt.x===0?dt.wrap-1:dt.wrap,Bt=(xt.x+1+At)%At,Ut=xt.x+1===At?dt.wrap+1:dt.wrap,Gt={};return Gt[new it.S(dt.overscaledZ,Pt,xt.z,It,xt.y).key]={backfilled:!1},Gt[new it.S(dt.overscaledZ,Ut,xt.z,Bt,xt.y).key]={backfilled:!1},xt.y>0&&(Gt[new it.S(dt.overscaledZ,Pt,xt.z,It,xt.y-1).key]={backfilled:!1},Gt[new it.S(dt.overscaledZ,dt.wrap,xt.z,xt.x,xt.y-1).key]={backfilled:!1},Gt[new it.S(dt.overscaledZ,Ut,xt.z,Bt,xt.y-1).key]={backfilled:!1}),xt.y+1<At&&(Gt[new it.S(dt.overscaledZ,Pt,xt.z,It,xt.y+1).key]={backfilled:!1},Gt[new it.S(dt.overscaledZ,dt.wrap,xt.z,xt.x,xt.y+1).key]={backfilled:!1},Gt[new it.S(dt.overscaledZ,Ut,xt.z,Bt,xt.y+1).key]={backfilled:!1}),Gt}unloadTile(dt){return it._(this,void 0,void 0,function*(){dt.demTexture&&this.map.painter.saveTileTexture(dt.demTexture),dt.fbo&&(dt.fbo.destroy(),delete dt.fbo),dt.dem&&delete dt.dem,delete dt.neighboringTiles,dt.state="unloaded",dt.actor&&(yield dt.actor.sendAsync({type:"RDT",data:{type:this.type,uid:dt.uid,source:this.id}}))})}}class Eo extends it.E{constructor(dt,xt,At,It){super(),this.id=dt,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=At.getActor(),this.setEventedParent(It),this._data=xt.data,this._options=it.e({},xt),this._collectResourceTiming=xt.collectResourceTiming,xt.maxzoom!==void 0&&(this.maxzoom=xt.maxzoom),xt.type&&(this.type=xt.type),xt.attribution&&(this.attribution=xt.attribution),this.promoteId=xt.promoteId;const Pt=it.X/this.tileSize;xt.clusterMaxZoom!==void 0&&this.maxzoom<=xt.clusterMaxZoom&&it.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${xt.clusterMaxZoom}".`),this.workerOptions=it.e({source:this.id,cluster:xt.cluster||!1,geojsonVtOptions:{buffer:(xt.buffer!==void 0?xt.buffer:128)*Pt,tolerance:(xt.tolerance!==void 0?xt.tolerance:.375)*Pt,extent:it.X,maxZoom:this.maxzoom,lineMetrics:xt.lineMetrics||!1,generateId:xt.generateId||!1},superclusterOptions:{maxZoom:xt.clusterMaxZoom!==void 0?xt.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,xt.clusterMinPoints||2),extent:it.X,radius:(xt.clusterRadius||50)*Pt,log:!1,generateId:xt.generateId||!1},clusterProperties:xt.clusterProperties,filter:xt.filter},xt.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return it._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(dt){this.map=dt,this.load()}setData(dt){return this._data=dt,this._updateWorkerData(),this}updateData(dt){return this._updateWorkerData(dt),this}getData(){return it._(this,void 0,void 0,function*(){const dt=it.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:dt})})}setClusterOptions(dt){return this.workerOptions.cluster=dt.cluster,dt&&(dt.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=dt.clusterRadius),dt.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=dt.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(dt){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:dt,source:this.id}})}getClusterChildren(dt){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:dt,source:this.id}})}getClusterLeaves(dt,xt,At){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:dt,limit:xt,offset:At}})}_updateWorkerData(dt){return it._(this,void 0,void 0,function*(){const xt=it.e({type:this.type},this.workerOptions);dt?xt.dataDiff=dt:typeof this._data=="string"?(xt.request=this.map._requestManager.transformRequest(ot.resolveURL(this._data),"Source"),xt.request.collectResourceTiming=this._collectResourceTiming):xt.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new it.k("dataloading",{dataType:"source"}));try{const At=yield this.actor.sendAsync({type:"LD",data:xt});if(this._pendingLoads--,this._removed||At.abandoned)return void this.fire(new it.k("dataabort",{dataType:"source"}));let It=null;At.resourceTiming&&At.resourceTiming[this.id]&&(It=At.resourceTiming[this.id].slice(0));const Pt={dataType:"source"};this._collectResourceTiming&&It&&It.length>0&&it.e(Pt,{resourceTiming:It}),this.fire(new it.k("data",Object.assign(Object.assign({},Pt),{sourceDataType:"metadata"}))),this.fire(new it.k("data",Object.assign(Object.assign({},Pt),{sourceDataType:"content"})))}catch(At){if(this._pendingLoads--,this._removed)return void this.fire(new it.k("dataabort",{dataType:"source"}));this.fire(new it.j(At))}})}loaded(){return this._pendingLoads===0}loadTile(dt){return it._(this,void 0,void 0,function*(){const xt=dt.actor?"RT":"LT";dt.actor=this.actor;const At={type:this.type,uid:dt.uid,tileID:dt.tileID,zoom:dt.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};dt.abortController=new AbortController;const It=yield this.actor.sendAsync({type:xt,data:At},dt.abortController);delete dt.abortController,dt.unloadVectorData(),dt.aborted||dt.loadVectorData(It,this.map.painter,xt==="RT")})}abortTile(dt){return it._(this,void 0,void 0,function*(){dt.abortController&&(dt.abortController.abort(),delete dt.abortController),dt.aborted=!0})}unloadTile(dt){return it._(this,void 0,void 0,function*(){dt.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:dt.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return it.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var xo=it.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Mo extends it.E{constructor(dt,xt,At,It){super(),this.id=dt,this.dispatcher=At,this.coordinates=xt.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(It),this.options=xt}load(dt){return it._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new it.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const xt=yield Tt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,xt&&xt.data&&(this.image=xt.data,dt&&(this.coordinates=dt),this._finishLoading())}catch(xt){this._request=null,this._loaded=!0,this.fire(new it.j(xt))}})}loaded(){return this._loaded}updateImage(dt){return dt.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=dt.url,this.load(dt.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new it.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(dt){this.map=dt,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(dt){this.coordinates=dt;const xt=dt.map(it.Z.fromLngLat);this.tileID=function(It){let Pt=1/0,Bt=1/0,Ut=-1/0,Gt=-1/0;for(const sr of It)Pt=Math.min(Pt,sr.x),Bt=Math.min(Bt,sr.y),Ut=Math.max(Ut,sr.x),Gt=Math.max(Gt,sr.y);const Yt=Math.max(Ut-Pt,Gt-Bt),Kt=Math.max(0,Math.floor(-Math.log(Yt)/Math.LN2)),Jt=Math.pow(2,Kt);return new it.a1(Kt,Math.floor((Pt+Ut)/2*Jt),Math.floor((Bt+Gt)/2*Jt))}(xt),this.minzoom=this.maxzoom=this.tileID.z;const At=xt.map(It=>this.tileID.getTilePoint(It)._round());return this._boundsArray=new it.$,this._boundsArray.emplaceBack(At[0].x,At[0].y,0,0),this._boundsArray.emplaceBack(At[1].x,At[1].y,it.X,0),this._boundsArray.emplaceBack(At[3].x,At[3].y,0,it.X),this._boundsArray.emplaceBack(At[2].x,At[2].y,it.X,it.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new it.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const dt=this.map.painter.context,xt=dt.gl;this.boundsBuffer||(this.boundsBuffer=dt.createVertexBuffer(this._boundsArray,xo.members)),this.boundsSegments||(this.boundsSegments=it.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ht(dt,this.image,xt.RGBA),this.texture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE));let At=!1;for(const It in this.tiles){const Pt=this.tiles[It];Pt.state!=="loaded"&&(Pt.state="loaded",Pt.texture=this.texture,At=!0)}At&&this.fire(new it.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(dt){return it._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(dt.tileID.canonical)?(this.tiles[String(dt.tileID.wrap)]=dt,dt.buckets={}):dt.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ls extends Mo{constructor(dt,xt,At,It){super(dt,xt,At,It),this.roundZoom=!0,this.type="video",this.options=xt}load(){return it._(this,void 0,void 0,function*(){this._loaded=!1;const dt=this.options;this.urls=[];for(const xt of dt.urls)this.urls.push(this.map._requestManager.transformRequest(xt,"Source").url);try{const xt=yield it.a3(this.urls);if(this._loaded=!0,!xt)return;this.video=xt,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(xt){this.fire(new it.j(xt))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(dt){if(this.video){const xt=this.video.seekable;dt<xt.start(0)||dt>xt.end(0)?this.fire(new it.j(new it.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${xt.start(0)} and ${xt.end(0)}-second mark.`))):this.video.currentTime=dt}}getVideo(){return this.video}onAdd(dt){this.map||(this.map=dt,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const dt=this.map.painter.context,xt=dt.gl;this.boundsBuffer||(this.boundsBuffer=dt.createVertexBuffer(this._boundsArray,xo.members)),this.boundsSegments||(this.boundsSegments=it.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE),xt.texSubImage2D(xt.TEXTURE_2D,0,0,0,xt.RGBA,xt.UNSIGNED_BYTE,this.video)):(this.texture=new Ht(dt,this.video,xt.RGBA),this.texture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE));let At=!1;for(const It in this.tiles){const Pt=this.tiles[It];Pt.state!=="loaded"&&(Pt.state="loaded",Pt.texture=this.texture,At=!0)}At&&this.fire(new it.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class eo extends Mo{constructor(dt,xt,At,It){super(dt,xt,At,It),xt.coordinates?Array.isArray(xt.coordinates)&&xt.coordinates.length===4&&!xt.coordinates.some(Pt=>!Array.isArray(Pt)||Pt.length!==2||Pt.some(Bt=>typeof Bt!="number"))||this.fire(new it.j(new it.a2(`sources.${dt}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new it.j(new it.a2(`sources.${dt}`,null,'missing required property "coordinates"'))),xt.animate&&typeof xt.animate!="boolean"&&this.fire(new it.j(new it.a2(`sources.${dt}`,null,'optional "animate" property must be a boolean value'))),xt.canvas?typeof xt.canvas=="string"||xt.canvas instanceof HTMLCanvasElement||this.fire(new it.j(new it.a2(`sources.${dt}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new it.j(new it.a2(`sources.${dt}`,null,'missing required property "canvas"'))),this.options=xt,this.animate=xt.animate===void 0||xt.animate}load(){return it._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new it.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(dt){this.map=dt,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let dt=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,dt=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,dt=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const xt=this.map.painter.context,At=xt.gl;this.boundsBuffer||(this.boundsBuffer=xt.createVertexBuffer(this._boundsArray,xo.members)),this.boundsSegments||(this.boundsSegments=it.a0.simpleSegment(0,0,4,2)),this.texture?(dt||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ht(xt,this.canvas,At.RGBA,{premultiply:!0});let It=!1;for(const Pt in this.tiles){const Bt=this.tiles[Pt];Bt.state!=="loaded"&&(Bt.state="loaded",Bt.texture=this.texture,It=!0)}It&&this.fire(new it.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const dt of[this.canvas.width,this.canvas.height])if(isNaN(dt)||dt<=0)return!0;return!1}}const wl={},qs=Mt=>{switch(Mt){case"geojson":return Eo;case"image":return Mo;case"raster":return Wn;case"raster-dem":return no;case"vector":return oo;case"video":return ls;case"canvas":return eo}return wl[Mt]},gn="RTLPluginLoaded";class Jo extends it.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=un()}_syncState(dt){return this.status=dt,this.dispatcher.broadcast("SRPS",{pluginStatus:dt,pluginURL:this.url}).catch(xt=>{throw this.status="error",xt})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(dt){return it._(this,arguments,void 0,function*(xt,At=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ot.resolveURL(xt),!this.url)throw new Error(`requested url ${xt} is invalid`);if(this.status==="unavailable"){if(!At)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return it._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new it.k(gn))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Wo=null;function us(){return Wo||(Wo=new Jo),Wo}class ko{constructor(dt,xt){this.timeAdded=0,this.fadeEndTime=0,this.tileID=dt,this.uid=it.a4(),this.uses=0,this.tileSize=xt,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(dt){const xt=dt+this.timeAdded;xt<this.fadeEndTime||(this.fadeEndTime=xt)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(dt){this.demTexture&&dt.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(dt,xt,At){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",dt){dt.featureIndex&&(this.latestFeatureIndex=dt.featureIndex,dt.rawTileData?(this.latestRawTileData=dt.rawTileData,this.latestFeatureIndex.rawTileData=dt.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=dt.collisionBoxArray,this.buckets=function(It,Pt){const Bt={};if(!Pt)return Bt;for(const Ut of It){const Gt=Ut.layerIds.map(Yt=>Pt.getLayer(Yt)).filter(Boolean);if(Gt.length!==0){Ut.layers=Gt,Ut.stateDependentLayerIds&&(Ut.stateDependentLayers=Ut.stateDependentLayerIds.map(Yt=>Gt.filter(Kt=>Kt.id===Yt)[0]));for(const Yt of Gt)Bt[Yt.id]=Ut}}return Bt}(dt.buckets,xt.style),this.hasSymbolBuckets=!1;for(const It in this.buckets){const Pt=this.buckets[It];if(Pt instanceof it.a6){if(this.hasSymbolBuckets=!0,!At)break;Pt.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const It in this.buckets){const Pt=this.buckets[It];if(Pt instanceof it.a6&&Pt.hasRTLText){this.hasRTLText=!0,us().lazyLoad();break}}this.queryPadding=0;for(const It in this.buckets){const Pt=this.buckets[It];this.queryPadding=Math.max(this.queryPadding,xt.style.getLayer(It).queryRadius(Pt))}dt.imageAtlas&&(this.imageAtlas=dt.imageAtlas),dt.glyphAtlasImage&&(this.glyphAtlasImage=dt.glyphAtlasImage)}else this.collisionBoxArray=new it.a5}unloadVectorData(){for(const dt in this.buckets)this.buckets[dt].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(dt){return this.buckets[dt.id]}upload(dt){for(const At in this.buckets){const It=this.buckets[At];It.uploadPending()&&It.upload(dt)}const xt=dt.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ht(dt,this.imageAtlas.image,xt.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ht(dt,this.glyphAtlasImage,xt.ALPHA),this.glyphAtlasImage=null)}prepare(dt){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(dt,this.imageAtlasTexture)}queryRenderedFeatures(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:It,cameraQueryGeometry:Pt,scale:Bt,tileSize:this.tileSize,pixelPosMatrix:Kt,transform:Gt,params:Ut,queryPadding:this.queryPadding*Yt},dt,xt,At):{}}querySourceFeatures(dt,xt){const At=this.latestFeatureIndex;if(!At||!At.rawTileData)return;const It=At.loadVTLayers(),Pt=xt&&xt.sourceLayer?xt.sourceLayer:"",Bt=It._geojsonTileLayer||It[Pt];if(!Bt)return;const Ut=it.a7(xt&&xt.filter),{z:Gt,x:Yt,y:Kt}=this.tileID.canonical,Jt={z:Gt,x:Yt,y:Kt};for(let sr=0;sr<Bt.length;sr++){const gr=Bt.feature(sr);if(Ut.needGeometry){const Er=it.a8(gr,!0);if(!Ut.filter(new it.z(this.tileID.overscaledZ),Er,this.tileID.canonical))continue}else if(!Ut.filter(new it.z(this.tileID.overscaledZ),gr))continue;const vr=At.getId(gr,Pt),Ar=new it.a9(gr,Gt,Yt,Kt,vr);Ar.tile=Jt,dt.push(Ar)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(dt){const xt=this.expirationTime;if(dt.cacheControl){const At=it.aa(dt.cacheControl);At["max-age"]&&(this.expirationTime=Date.now()+1e3*At["max-age"])}else dt.expires&&(this.expirationTime=new Date(dt.expires).getTime());if(this.expirationTime){const At=Date.now();let It=!1;if(this.expirationTime>At)It=!1;else if(xt)if(this.expirationTime<xt)It=!0;else{const Pt=this.expirationTime-xt;Pt?this.expirationTime=At+Math.max(Pt,3e4):It=!0}else It=!0;It?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(dt,xt){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(dt).length===0)return;const At=this.latestFeatureIndex.loadVTLayers();for(const It in this.buckets){if(!xt.style.hasLayer(It))continue;const Pt=this.buckets[It],Bt=Pt.layers[0].sourceLayer||"_geojsonTileLayer",Ut=At[Bt],Gt=dt[Bt];if(!Ut||!Gt||Object.keys(Gt).length===0)continue;Pt.update(Gt,Ut,this.imageAtlas&&this.imageAtlas.patternPositions||{});const Yt=xt&&xt.style&&xt.style.getLayer(It);Yt&&(this.queryPadding=Math.max(this.queryPadding,Yt.queryRadius(Pt)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ot.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(dt){this.symbolFadeHoldUntil=ot.now()+dt}setDependencies(dt,xt){const At={};for(const It of xt)At[It]=!0;this.dependencies[dt]=At}hasDependency(dt,xt){for(const At of dt){const It=this.dependencies[At];if(It){for(const Pt of xt)if(It[Pt])return!0}}return!1}}class _n{constructor(dt,xt){this.max=dt,this.onRemove=xt,this.reset()}reset(){for(const dt in this.data)for(const xt of this.data[dt])xt.timeout&&clearTimeout(xt.timeout),this.onRemove(xt.value);return this.data={},this.order=[],this}add(dt,xt,At){const It=dt.wrapped().key;this.data[It]===void 0&&(this.data[It]=[]);const Pt={value:xt,timeout:void 0};if(At!==void 0&&(Pt.timeout=setTimeout(()=>{this.remove(dt,Pt)},At)),this.data[It].push(Pt),this.order.push(It),this.order.length>this.max){const Bt=this._getAndRemoveByKey(this.order[0]);Bt&&this.onRemove(Bt)}return this}has(dt){return dt.wrapped().key in this.data}getAndRemove(dt){return this.has(dt)?this._getAndRemoveByKey(dt.wrapped().key):null}_getAndRemoveByKey(dt){const xt=this.data[dt].shift();return xt.timeout&&clearTimeout(xt.timeout),this.data[dt].length===0&&delete this.data[dt],this.order.splice(this.order.indexOf(dt),1),xt.value}getByKey(dt){const xt=this.data[dt];return xt?xt[0].value:null}get(dt){return this.has(dt)?this.data[dt.wrapped().key][0].value:null}remove(dt,xt){if(!this.has(dt))return this;const At=dt.wrapped().key,It=xt===void 0?0:this.data[At].indexOf(xt),Pt=this.data[At][It];return this.data[At].splice(It,1),Pt.timeout&&clearTimeout(Pt.timeout),this.data[At].length===0&&delete this.data[At],this.onRemove(Pt.value),this.order.splice(this.order.indexOf(At),1),this}setMaxSize(dt){for(this.max=dt;this.order.length>this.max;){const xt=this._getAndRemoveByKey(this.order[0]);xt&&this.onRemove(xt)}return this}filter(dt){const xt=[];for(const At in this.data)for(const It of this.data[At])dt(It.value)||xt.push(It);for(const At of xt)this.remove(At.value.tileID,At)}}class bn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(dt,xt,At){const It=String(xt);if(this.stateChanges[dt]=this.stateChanges[dt]||{},this.stateChanges[dt][It]=this.stateChanges[dt][It]||{},it.e(this.stateChanges[dt][It],At),this.deletedStates[dt]===null){this.deletedStates[dt]={};for(const Pt in this.state[dt])Pt!==It&&(this.deletedStates[dt][Pt]=null)}else if(this.deletedStates[dt]&&this.deletedStates[dt][It]===null){this.deletedStates[dt][It]={};for(const Pt in this.state[dt][It])At[Pt]||(this.deletedStates[dt][It][Pt]=null)}else for(const Pt in At)this.deletedStates[dt]&&this.deletedStates[dt][It]&&this.deletedStates[dt][It][Pt]===null&&delete this.deletedStates[dt][It][Pt]}removeFeatureState(dt,xt,At){if(this.deletedStates[dt]===null)return;const It=String(xt);if(this.deletedStates[dt]=this.deletedStates[dt]||{},At&&xt!==void 0)this.deletedStates[dt][It]!==null&&(this.deletedStates[dt][It]=this.deletedStates[dt][It]||{},this.deletedStates[dt][It][At]=null);else if(xt!==void 0)if(this.stateChanges[dt]&&this.stateChanges[dt][It])for(At in this.deletedStates[dt][It]={},this.stateChanges[dt][It])this.deletedStates[dt][It][At]=null;else this.deletedStates[dt][It]=null;else this.deletedStates[dt]=null}getState(dt,xt){const At=String(xt),It=it.e({},(this.state[dt]||{})[At],(this.stateChanges[dt]||{})[At]);if(this.deletedStates[dt]===null)return{};if(this.deletedStates[dt]){const Pt=this.deletedStates[dt][xt];if(Pt===null)return{};for(const Bt in Pt)delete It[Bt]}return It}initializeTileState(dt,xt){dt.setFeatureState(this.state,xt)}coalesceChanges(dt,xt){const At={};for(const It in this.stateChanges){this.state[It]=this.state[It]||{};const Pt={};for(const Bt in this.stateChanges[It])this.state[It][Bt]||(this.state[It][Bt]={}),it.e(this.state[It][Bt],this.stateChanges[It][Bt]),Pt[Bt]=this.state[It][Bt];At[It]=Pt}for(const It in this.deletedStates){this.state[It]=this.state[It]||{};const Pt={};if(this.deletedStates[It]===null)for(const Bt in this.state[It])Pt[Bt]={},this.state[It][Bt]={};else for(const Bt in this.deletedStates[It]){if(this.deletedStates[It][Bt]===null)this.state[It][Bt]={};else for(const Ut of Object.keys(this.deletedStates[It][Bt]))delete this.state[It][Bt][Ut];Pt[Bt]=this.state[It][Bt]}At[It]=At[It]||{},it.e(At[It],Pt)}if(this.stateChanges={},this.deletedStates={},Object.keys(At).length!==0)for(const It in dt)dt[It].setFeatureState(At,xt)}}class Zn extends it.E{constructor(dt,xt,At){super(),this.id=dt,this.dispatcher=At,this.on("data",It=>this._dataHandler(It)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((It,Pt,Bt,Ut)=>{const Gt=new(qs(Pt.type))(It,Pt,Bt,Ut);if(Gt.id!==It)throw new Error(`Expected Source id to be ${It} instead of ${Gt.id}`);return Gt})(dt,xt,At,this),this._tiles={},this._cache=new _n(0,It=>this._unloadTile(It)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new bn,this._didEmitContent=!1,this._updated=!1}onAdd(dt){this.map=dt,this._maxTileCacheSize=dt?dt._maxTileCacheSize:null,this._maxTileCacheZoomLevels=dt?dt._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(dt)}onRemove(dt){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(dt)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const dt in this._tiles){const xt=this._tiles[dt];if(xt.state!=="loaded"&&xt.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const dt=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,dt&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(dt,xt,At){return it._(this,void 0,void 0,function*(){try{yield this._source.loadTile(dt),this._tileLoaded(dt,xt,At)}catch(It){dt.state="errored",It.status!==404?this._source.fire(new it.j(It,{tile:dt})):this.update(this.transform,this.terrain)}})}_unloadTile(dt){this._source.unloadTile&&this._source.unloadTile(dt)}_abortTile(dt){this._source.abortTile&&this._source.abortTile(dt),this._source.fire(new it.k("dataabort",{tile:dt,coord:dt.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(dt){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const xt in this._tiles){const At=this._tiles[xt];At.upload(dt),At.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(dt=>dt.tileID).sort(ts).map(dt=>dt.key)}getRenderableIds(dt){const xt=[];for(const At in this._tiles)this._isIdRenderable(At,dt)&&xt.push(this._tiles[At]);return dt?xt.sort((At,It)=>{const Pt=At.tileID,Bt=It.tileID,Ut=new it.P(Pt.canonical.x,Pt.canonical.y)._rotate(this.transform.angle),Gt=new it.P(Bt.canonical.x,Bt.canonical.y)._rotate(this.transform.angle);return Pt.overscaledZ-Bt.overscaledZ||Gt.y-Ut.y||Gt.x-Ut.x}).map(At=>At.tileID.key):xt.map(At=>At.tileID).sort(ts).map(At=>At.key)}hasRenderableParent(dt){const xt=this.findLoadedParent(dt,0);return!!xt&&this._isIdRenderable(xt.tileID.key)}_isIdRenderable(dt,xt){return this._tiles[dt]&&this._tiles[dt].hasData()&&!this._coveredTiles[dt]&&(xt||!this._tiles[dt].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const dt in this._tiles)this._tiles[dt].state!=="errored"&&this._reloadTile(dt,"reloading")}}_reloadTile(dt,xt){return it._(this,void 0,void 0,function*(){const At=this._tiles[dt];At&&(At.state!=="loading"&&(At.state=xt),yield this._loadTile(At,dt,xt))})}_tileLoaded(dt,xt,At){dt.timeAdded=ot.now(),At==="expired"&&(dt.refreshedUponExpiration=!0),this._setTileReloadTimer(xt,dt),this.getSource().type==="raster-dem"&&dt.dem&&this._backfillDEM(dt),this._state.initializeTileState(dt,this.map?this.map.painter:null),dt.aborted||this._source.fire(new it.k("data",{dataType:"source",tile:dt,coord:dt.tileID}))}_backfillDEM(dt){const xt=this.getRenderableIds();for(let It=0;It<xt.length;It++){const Pt=xt[It];if(dt.neighboringTiles&&dt.neighboringTiles[Pt]){const Bt=this.getTileByID(Pt);At(dt,Bt),At(Bt,dt)}}function At(It,Pt){It.needsHillshadePrepare=!0,It.needsTerrainPrepare=!0;let Bt=Pt.tileID.canonical.x-It.tileID.canonical.x;const Ut=Pt.tileID.canonical.y-It.tileID.canonical.y,Gt=Math.pow(2,It.tileID.canonical.z),Yt=Pt.tileID.key;Bt===0&&Ut===0||Math.abs(Ut)>1||(Math.abs(Bt)>1&&(Math.abs(Bt+Gt)===1?Bt+=Gt:Math.abs(Bt-Gt)===1&&(Bt-=Gt)),Pt.dem&&It.dem&&(It.dem.backfillBorder(Pt.dem,Bt,Ut),It.neighboringTiles&&It.neighboringTiles[Yt]&&(It.neighboringTiles[Yt].backfilled=!0)))}}getTile(dt){return this.getTileByID(dt.key)}getTileByID(dt){return this._tiles[dt]}_retainLoadedChildren(dt,xt,At,It){for(const Pt in this._tiles){let Bt=this._tiles[Pt];if(It[Pt]||!Bt.hasData()||Bt.tileID.overscaledZ<=xt||Bt.tileID.overscaledZ>At)continue;let Ut=Bt.tileID;for(;Bt&&Bt.tileID.overscaledZ>xt+1;){const Yt=Bt.tileID.scaledTo(Bt.tileID.overscaledZ-1);Bt=this._tiles[Yt.key],Bt&&Bt.hasData()&&(Ut=Yt)}let Gt=Ut;for(;Gt.overscaledZ>xt;)if(Gt=Gt.scaledTo(Gt.overscaledZ-1),dt[Gt.key]){It[Ut.key]=Ut;break}}}findLoadedParent(dt,xt){if(dt.key in this._loadedParentTiles){const At=this._loadedParentTiles[dt.key];return At&&At.tileID.overscaledZ>=xt?At:null}for(let At=dt.overscaledZ-1;At>=xt;At--){const It=dt.scaledTo(At),Pt=this._getLoadedTile(It);if(Pt)return Pt}}findLoadedSibling(dt){return this._getLoadedTile(dt)}_getLoadedTile(dt){const xt=this._tiles[dt.key];return xt&&xt.hasData()?xt:this._cache.getByKey(dt.wrapped().key)}updateCacheSize(dt){const xt=Math.ceil(dt.width/this._source.tileSize)+1,At=Math.ceil(dt.height/this._source.tileSize)+1,It=Math.floor(xt*At*(this._maxTileCacheZoomLevels===null?it.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),Pt=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,It):It;this._cache.setMaxSize(Pt)}handleWrapJump(dt){const xt=Math.round((dt-(this._prevLng===void 0?dt:this._prevLng))/360);if(this._prevLng=dt,xt){const At={};for(const It in this._tiles){const Pt=this._tiles[It];Pt.tileID=Pt.tileID.unwrapTo(Pt.tileID.wrap+xt),At[Pt.tileID.key]=Pt}this._tiles=At;for(const It in this._timers)clearTimeout(this._timers[It]),delete this._timers[It];for(const It in this._tiles)this._setTileReloadTimer(It,this._tiles[It])}}_updateCoveredAndRetainedTiles(dt,xt,At,It,Pt,Bt){const Ut={},Gt={},Yt=Object.keys(dt),Kt=ot.now();for(const Jt of Yt){const sr=dt[Jt],gr=this._tiles[Jt];if(!gr||gr.fadeEndTime!==0&&gr.fadeEndTime<=Kt)continue;const vr=this.findLoadedParent(sr,xt),Ar=this.findLoadedSibling(sr),Er=vr||Ar||null;Er&&(this._addTile(Er.tileID),Ut[Er.tileID.key]=Er.tileID),Gt[Jt]=sr}this._retainLoadedChildren(Gt,It,At,dt);for(const Jt in Ut)dt[Jt]||(this._coveredTiles[Jt]=!0,dt[Jt]=Ut[Jt]);if(Bt){const Jt={},sr={};for(const gr of Pt)this._tiles[gr.key].hasData()?Jt[gr.key]=gr:sr[gr.key]=gr;for(const gr in sr){const vr=sr[gr].children(this._source.maxzoom);this._tiles[vr[0].key]&&this._tiles[vr[1].key]&&this._tiles[vr[2].key]&&this._tiles[vr[3].key]&&(Jt[vr[0].key]=dt[vr[0].key]=vr[0],Jt[vr[1].key]=dt[vr[1].key]=vr[1],Jt[vr[2].key]=dt[vr[2].key]=vr[2],Jt[vr[3].key]=dt[vr[3].key]=vr[3],delete sr[gr])}for(const gr in sr){const vr=sr[gr],Ar=this.findLoadedParent(vr,this._source.minzoom),Er=this.findLoadedSibling(vr),Cr=Ar||Er||null;if(Cr){Jt[Cr.tileID.key]=dt[Cr.tileID.key]=Cr.tileID;for(const Rr in Jt)Jt[Rr].isChildOf(Cr.tileID)&&delete Jt[Rr]}}for(const gr in this._tiles)Jt[gr]||(this._coveredTiles[gr]=!0)}}update(dt,xt){if(!this._sourceLoaded||this._paused)return;let At;this.transform=dt,this.terrain=xt,this.updateCacheSize(dt),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?At=dt.getVisibleUnwrappedCoordinates(this._source.tileID).map(Kt=>new it.S(Kt.canonical.z,Kt.wrap,Kt.canonical.z,Kt.canonical.x,Kt.canonical.y)):(At=dt.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:xt}),this._source.hasTile&&(At=At.filter(Kt=>this._source.hasTile(Kt)))):At=[];const It=dt.coveringZoomLevel(this._source),Pt=Math.max(It-Zn.maxOverzooming,this._source.minzoom),Bt=Math.max(It+Zn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Kt={};for(const Jt of At)if(Jt.canonical.z>this._source.minzoom){const sr=Jt.scaledTo(Jt.canonical.z-1);Kt[sr.key]=sr;const gr=Jt.scaledTo(Math.max(this._source.minzoom,Math.min(Jt.canonical.z,5)));Kt[gr.key]=gr}At=At.concat(Object.values(Kt))}const Ut=At.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,Ut&&this.fire(new it.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const Gt=this._updateRetainedTiles(At,It);ms(this._source.type)&&this._updateCoveredAndRetainedTiles(Gt,Pt,Bt,It,At,xt);for(const Kt in Gt)this._tiles[Kt].clearFadeHold();const Yt=it.ab(this._tiles,Gt);for(const Kt of Yt){const Jt=this._tiles[Kt];Jt.hasSymbolBuckets&&!Jt.holdingForFade()?Jt.setHoldDuration(this.map._fadeDuration):Jt.hasSymbolBuckets&&!Jt.symbolFadeFinished()||this._removeTile(Kt)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const dt in this._tiles)this._tiles[dt].holdingForFade()&&this._removeTile(dt)}_updateRetainedTiles(dt,xt){var At;const It={},Pt={},Bt=Math.max(xt-Zn.maxOverzooming,this._source.minzoom),Ut=Math.max(xt+Zn.maxUnderzooming,this._source.minzoom),Gt={};for(const Yt of dt){const Kt=this._addTile(Yt);It[Yt.key]=Yt,Kt.hasData()||xt<this._source.maxzoom&&(Gt[Yt.key]=Yt)}this._retainLoadedChildren(Gt,xt,Ut,It);for(const Yt of dt){let Kt=this._tiles[Yt.key];if(Kt.hasData())continue;if(xt+1>this._source.maxzoom){const sr=Yt.children(this._source.maxzoom)[0],gr=this.getTile(sr);if(gr&&gr.hasData()){It[sr.key]=sr;continue}}else{const sr=Yt.children(this._source.maxzoom);if(It[sr[0].key]&&It[sr[1].key]&&It[sr[2].key]&&It[sr[3].key])continue}let Jt=Kt.wasRequested();for(let sr=Yt.overscaledZ-1;sr>=Bt;--sr){const gr=Yt.scaledTo(sr);if(Pt[gr.key])break;if(Pt[gr.key]=!0,Kt=this.getTile(gr),!Kt&&Jt&&(Kt=this._addTile(gr)),Kt){const vr=Kt.hasData();if((vr||!(!((At=this.map)===null||At===void 0)&&At.cancelPendingTileRequestsWhileZooming)||Jt)&&(It[gr.key]=gr),Jt=Kt.wasRequested(),vr)break}}}return It}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const dt in this._tiles){const xt=[];let At,It=this._tiles[dt].tileID;for(;It.overscaledZ>0;){if(It.key in this._loadedParentTiles){At=this._loadedParentTiles[It.key];break}xt.push(It.key);const Pt=It.scaledTo(It.overscaledZ-1);if(At=this._getLoadedTile(Pt),At)break;It=Pt}for(const Pt of xt)this._loadedParentTiles[Pt]=At}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const dt in this._tiles){const xt=this._tiles[dt].tileID,At=this._getLoadedTile(xt);this._loadedSiblingTiles[xt.key]=At}}_addTile(dt){let xt=this._tiles[dt.key];if(xt)return xt;xt=this._cache.getAndRemove(dt),xt&&(this._setTileReloadTimer(dt.key,xt),xt.tileID=dt,this._state.initializeTileState(xt,this.map?this.map.painter:null),this._cacheTimers[dt.key]&&(clearTimeout(this._cacheTimers[dt.key]),delete this._cacheTimers[dt.key],this._setTileReloadTimer(dt.key,xt)));const At=xt;return xt||(xt=new ko(dt,this._source.tileSize*dt.overscaleFactor()),this._loadTile(xt,dt.key,xt.state)),xt.uses++,this._tiles[dt.key]=xt,At||this._source.fire(new it.k("dataloading",{tile:xt,coord:xt.tileID,dataType:"source"})),xt}_setTileReloadTimer(dt,xt){dt in this._timers&&(clearTimeout(this._timers[dt]),delete this._timers[dt]);const At=xt.getExpiryTimeout();At&&(this._timers[dt]=setTimeout(()=>{this._reloadTile(dt,"expired"),delete this._timers[dt]},At))}_removeTile(dt){const xt=this._tiles[dt];xt&&(xt.uses--,delete this._tiles[dt],this._timers[dt]&&(clearTimeout(this._timers[dt]),delete this._timers[dt]),xt.uses>0||(xt.hasData()&&xt.state!=="reloading"?this._cache.add(xt.tileID,xt,xt.getExpiryTimeout()):(xt.aborted=!0,this._abortTile(xt),this._unloadTile(xt))))}_dataHandler(dt){const xt=dt.sourceDataType;dt.dataType==="source"&&xt==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&dt.dataType==="source"&&xt==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const dt in this._tiles)this._removeTile(dt);this._cache.reset()}tilesIn(dt,xt,At){const It=[],Pt=this.transform;if(!Pt)return It;const Bt=At?Pt.getCameraQueryGeometry(dt):dt,Ut=dt.map(vr=>Pt.pointCoordinate(vr,this.terrain)),Gt=Bt.map(vr=>Pt.pointCoordinate(vr,this.terrain)),Yt=this.getIds();let Kt=1/0,Jt=1/0,sr=-1/0,gr=-1/0;for(const vr of Gt)Kt=Math.min(Kt,vr.x),Jt=Math.min(Jt,vr.y),sr=Math.max(sr,vr.x),gr=Math.max(gr,vr.y);for(let vr=0;vr<Yt.length;vr++){const Ar=this._tiles[Yt[vr]];if(Ar.holdingForFade())continue;const Er=Ar.tileID,Cr=Math.pow(2,Pt.zoom-Ar.tileID.overscaledZ),Rr=xt*Ar.queryPadding*it.X/Ar.tileSize/Cr,Sr=[Er.getTilePoint(new it.Z(Kt,Jt)),Er.getTilePoint(new it.Z(sr,gr))];if(Sr[0].x-Rr<it.X&&Sr[0].y-Rr<it.X&&Sr[1].x+Rr>=0&&Sr[1].y+Rr>=0){const Br=Ut.map(qr=>Er.getTilePoint(qr)),Gr=Gt.map(qr=>Er.getTilePoint(qr));It.push({tile:Ar,tileID:Er,queryGeometry:Br,cameraQueryGeometry:Gr,scale:Cr})}}return It}getVisibleCoordinates(dt){const xt=this.getRenderableIds(dt).map(At=>this._tiles[At].tileID);for(const At of xt)At.posMatrix=this.transform.calculatePosMatrix(At.toUnwrapped());return xt}hasTransition(){if(this._source.hasTransition())return!0;if(ms(this._source.type)){const dt=ot.now();for(const xt in this._tiles)if(this._tiles[xt].fadeEndTime>=dt)return!0}return!1}setFeatureState(dt,xt,At){this._state.updateState(dt=dt||"_geojsonTileLayer",xt,At)}removeFeatureState(dt,xt,At){this._state.removeFeatureState(dt=dt||"_geojsonTileLayer",xt,At)}getFeatureState(dt,xt){return this._state.getState(dt=dt||"_geojsonTileLayer",xt)}setDependencies(dt,xt,At){const It=this._tiles[dt];It&&It.setDependencies(xt,At)}reloadTilesForDependencies(dt,xt){for(const At in this._tiles)this._tiles[At].hasDependency(dt,xt)&&this._reloadTile(At,"reloading");this._cache.filter(At=>!At.hasDependency(dt,xt))}}function ts(Mt,dt){const xt=Math.abs(2*Mt.wrap)-+(Mt.wrap<0),At=Math.abs(2*dt.wrap)-+(dt.wrap<0);return Mt.overscaledZ-dt.overscaledZ||At-xt||dt.canonical.y-Mt.canonical.y||dt.canonical.x-Mt.canonical.x}function ms(Mt){return Mt==="raster"||Mt==="image"||Mt==="video"}Zn.maxOverzooming=10,Zn.maxUnderzooming=3;class Kn{constructor(dt,xt){this.reset(dt,xt)}reset(dt,xt){this.points=dt||[],this._distances=[0];for(let At=1;At<this.points.length;At++)this._distances[At]=this._distances[At-1]+this.points[At].dist(this.points[At-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(xt||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(dt){if(this.points.length===1)return this.points[0];dt=it.ac(dt,0,1);let xt=1,At=this._distances[xt];const It=dt*this.paddedLength+this.padding;for(;At<It&&xt<this._distances.length;)At=this._distances[++xt];const Pt=xt-1,Bt=this._distances[Pt],Ut=At-Bt,Gt=Ut>0?(It-Bt)/Ut:0;return this.points[Pt].mult(1-Gt).add(this.points[xt].mult(Gt))}}function co(Mt,dt){let xt=!0;return Mt==="always"||Mt!=="never"&&dt!=="never"||(xt=!1),xt}class cs{constructor(dt,xt,At){const It=this.boxCells=[],Pt=this.circleCells=[];this.xCellCount=Math.ceil(dt/At),this.yCellCount=Math.ceil(xt/At);for(let Bt=0;Bt<this.xCellCount*this.yCellCount;Bt++)It.push([]),Pt.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=dt,this.height=xt,this.xScale=this.xCellCount/dt,this.yScale=this.yCellCount/xt,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(dt,xt,At,It,Pt){this._forEachCell(xt,At,It,Pt,this._insertBoxCell,this.boxUid++),this.boxKeys.push(dt),this.bboxes.push(xt),this.bboxes.push(At),this.bboxes.push(It),this.bboxes.push(Pt)}insertCircle(dt,xt,At,It){this._forEachCell(xt-It,At-It,xt+It,At+It,this._insertCircleCell,this.circleUid++),this.circleKeys.push(dt),this.circles.push(xt),this.circles.push(At),this.circles.push(It)}_insertBoxCell(dt,xt,At,It,Pt,Bt){this.boxCells[Pt].push(Bt)}_insertCircleCell(dt,xt,At,It,Pt,Bt){this.circleCells[Pt].push(Bt)}_query(dt,xt,At,It,Pt,Bt,Ut){if(At<0||dt>this.width||It<0||xt>this.height)return[];const Gt=[];if(dt<=0&&xt<=0&&this.width<=At&&this.height<=It){if(Pt)return[{key:null,x1:dt,y1:xt,x2:At,y2:It}];for(let Yt=0;Yt<this.boxKeys.length;Yt++)Gt.push({key:this.boxKeys[Yt],x1:this.bboxes[4*Yt],y1:this.bboxes[4*Yt+1],x2:this.bboxes[4*Yt+2],y2:this.bboxes[4*Yt+3]});for(let Yt=0;Yt<this.circleKeys.length;Yt++){const Kt=this.circles[3*Yt],Jt=this.circles[3*Yt+1],sr=this.circles[3*Yt+2];Gt.push({key:this.circleKeys[Yt],x1:Kt-sr,y1:Jt-sr,x2:Kt+sr,y2:Jt+sr})}}else this._forEachCell(dt,xt,At,It,this._queryCell,Gt,{hitTest:Pt,overlapMode:Bt,seenUids:{box:{},circle:{}}},Ut);return Gt}query(dt,xt,At,It){return this._query(dt,xt,At,It,!1,null)}hitTest(dt,xt,At,It,Pt,Bt){return this._query(dt,xt,At,It,!0,Pt,Bt).length>0}hitTestCircle(dt,xt,At,It,Pt){const Bt=dt-At,Ut=dt+At,Gt=xt-At,Yt=xt+At;if(Ut<0||Bt>this.width||Yt<0||Gt>this.height)return!1;const Kt=[];return this._forEachCell(Bt,Gt,Ut,Yt,this._queryCellCircle,Kt,{hitTest:!0,overlapMode:It,circle:{x:dt,y:xt,radius:At},seenUids:{box:{},circle:{}}},Pt),Kt.length>0}_queryCell(dt,xt,At,It,Pt,Bt,Ut,Gt){const{seenUids:Yt,hitTest:Kt,overlapMode:Jt}=Ut,sr=this.boxCells[Pt];if(sr!==null){const vr=this.bboxes;for(const Ar of sr)if(!Yt.box[Ar]){Yt.box[Ar]=!0;const Er=4*Ar,Cr=this.boxKeys[Ar];if(dt<=vr[Er+2]&&xt<=vr[Er+3]&&At>=vr[Er+0]&&It>=vr[Er+1]&&(!Gt||Gt(Cr))&&(!Kt||!co(Jt,Cr.overlapMode))&&(Bt.push({key:Cr,x1:vr[Er],y1:vr[Er+1],x2:vr[Er+2],y2:vr[Er+3]}),Kt))return!0}}const gr=this.circleCells[Pt];if(gr!==null){const vr=this.circles;for(const Ar of gr)if(!Yt.circle[Ar]){Yt.circle[Ar]=!0;const Er=3*Ar,Cr=this.circleKeys[Ar];if(this._circleAndRectCollide(vr[Er],vr[Er+1],vr[Er+2],dt,xt,At,It)&&(!Gt||Gt(Cr))&&(!Kt||!co(Jt,Cr.overlapMode))){const Rr=vr[Er],Sr=vr[Er+1],Br=vr[Er+2];if(Bt.push({key:Cr,x1:Rr-Br,y1:Sr-Br,x2:Rr+Br,y2:Sr+Br}),Kt)return!0}}}return!1}_queryCellCircle(dt,xt,At,It,Pt,Bt,Ut,Gt){const{circle:Yt,seenUids:Kt,overlapMode:Jt}=Ut,sr=this.boxCells[Pt];if(sr!==null){const vr=this.bboxes;for(const Ar of sr)if(!Kt.box[Ar]){Kt.box[Ar]=!0;const Er=4*Ar,Cr=this.boxKeys[Ar];if(this._circleAndRectCollide(Yt.x,Yt.y,Yt.radius,vr[Er+0],vr[Er+1],vr[Er+2],vr[Er+3])&&(!Gt||Gt(Cr))&&!co(Jt,Cr.overlapMode))return Bt.push(!0),!0}}const gr=this.circleCells[Pt];if(gr!==null){const vr=this.circles;for(const Ar of gr)if(!Kt.circle[Ar]){Kt.circle[Ar]=!0;const Er=3*Ar,Cr=this.circleKeys[Ar];if(this._circlesCollide(vr[Er],vr[Er+1],vr[Er+2],Yt.x,Yt.y,Yt.radius)&&(!Gt||Gt(Cr))&&!co(Jt,Cr.overlapMode))return Bt.push(!0),!0}}}_forEachCell(dt,xt,At,It,Pt,Bt,Ut,Gt){const Yt=this._convertToXCellCoord(dt),Kt=this._convertToYCellCoord(xt),Jt=this._convertToXCellCoord(At),sr=this._convertToYCellCoord(It);for(let gr=Yt;gr<=Jt;gr++)for(let vr=Kt;vr<=sr;vr++)if(Pt.call(this,dt,xt,At,It,this.xCellCount*vr+gr,Bt,Ut,Gt))return}_convertToXCellCoord(dt){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(dt*this.xScale)))}_convertToYCellCoord(dt){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(dt*this.yScale)))}_circlesCollide(dt,xt,At,It,Pt,Bt){const Ut=It-dt,Gt=Pt-xt,Yt=At+Bt;return Yt*Yt>Ut*Ut+Gt*Gt}_circleAndRectCollide(dt,xt,At,It,Pt,Bt,Ut){const Gt=(Bt-It)/2,Yt=Math.abs(dt-(It+Gt));if(Yt>Gt+At)return!1;const Kt=(Ut-Pt)/2,Jt=Math.abs(xt-(Pt+Kt));if(Jt>Kt+At)return!1;if(Yt<=Gt||Jt<=Kt)return!0;const sr=Yt-Gt,gr=Jt-Kt;return sr*sr+gr*gr<=At*At}}function Ms(Mt,dt,xt,At,It){const Pt=it.H();return dt?(it.K(Pt,Pt,[1/It,1/It,1]),xt||it.ad(Pt,Pt,At.angle)):it.L(Pt,At.labelPlaneMatrix,Mt),Pt}function ns(Mt,dt,xt,At,It){if(dt){const Pt=it.ae(Mt);return it.K(Pt,Pt,[It,It,1]),xt||it.ad(Pt,Pt,-At.angle),Pt}return At.glCoordMatrix}function yr(Mt,dt,xt,At){let It;At?(It=[Mt,dt,At(Mt,dt),1],it.af(It,It,xt)):(It=[Mt,dt,0,1],po(It,It,xt));const Pt=It[3];return{point:new it.P(It[0]/Pt,It[1]/Pt),signedDistanceFromCamera:Pt,isOccluded:!1}}function er(Mt,dt){return .5+Mt/dt*.5}function tr(Mt,dt){return Mt.x>=-dt[0]&&Mt.x<=dt[0]&&Mt.y>=-dt[1]&&Mt.y<=dt[1]}function fr(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr,vr){const Ar=At?Mt.textSizeData:Mt.iconSizeData,Er=it.ag(Ar,xt.transform.zoom),Cr=[256/xt.width*2+1,256/xt.height*2+1],Rr=At?Mt.text.dynamicLayoutVertexArray:Mt.icon.dynamicLayoutVertexArray;Rr.clear();const Sr=Mt.lineVertexArray,Br=At?Mt.text.placedSymbolArray:Mt.icon.placedSymbolArray,Gr=xt.transform.width/xt.transform.height;let qr=!1;for(let ln=0;ln<Br.length;ln++){const mn=Br.get(ln);if(mn.hidden||mn.writingMode===it.ah.vertical&&!qr){Yn(mn.numGlyphs,Rr);continue}qr=!1;const Cn=yr(mn.anchorX,mn.anchorY,dt,vr);if(!tr(Cn.point,Cr)){Yn(mn.numGlyphs,Rr);continue}const On=er(xt.transform.cameraToCenterDistance,Cn.signedDistanceFromCamera),Tn=it.ai(Ar,Er,mn),Sn=Bt?Tn/On:Tn*On,Un={getElevation:vr,labelPlaneMatrix:It,lineVertexArray:Sr,pitchWithMap:Bt,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:Yt,tileAnchorPoint:new it.P(mn.anchorX,mn.anchorY),unwrappedTileID:Kt,width:Jt,height:sr,translation:gr},$a=Fr(Un,mn,Sn,!1,Ut,dt,Pt,Mt.glyphOffsetArray,Rr,Gr,Gt);qr=$a.useVertical,($a.notEnoughRoom||qr||$a.needsFlipping&&Fr(Un,mn,Sn,!0,Ut,dt,Pt,Mt.glyphOffsetArray,Rr,Gr,Gt).notEnoughRoom)&&Yn(mn.numGlyphs,Rr)}At?Mt.text.dynamicLayoutVertexBuffer.updateData(Rr):Mt.icon.dynamicLayoutVertexBuffer.updateData(Rr)}function wr(Mt,dt,xt,At,It,Pt,Bt,Ut){const Gt=Pt.glyphStartIndex+Pt.numGlyphs,Yt=Pt.lineStartIndex,Kt=Pt.lineStartIndex+Pt.lineLength,Jt=dt.getoffsetX(Pt.glyphStartIndex),sr=dt.getoffsetX(Gt-1),gr=vn(Mt*Jt,xt,At,It,Pt.segment,Yt,Kt,Ut,Bt);if(!gr)return null;const vr=vn(Mt*sr,xt,At,It,Pt.segment,Yt,Kt,Ut,Bt);return vr?Ut.projectionCache.anyProjectionOccluded?null:{first:gr,last:vr}:null}function Lr(Mt,dt,xt,At){return Mt===it.ah.horizontal&&Math.abs(xt.y-dt.y)>Math.abs(xt.x-dt.x)*At?{useVertical:!0}:(Mt===it.ah.vertical?dt.y<xt.y:dt.x>xt.x)?{needsFlipping:!0}:null}function Fr(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt){const Jt=xt/24,sr=dt.lineOffsetX*Jt,gr=dt.lineOffsetY*Jt;let vr;if(dt.numGlyphs>1){const Ar=dt.glyphStartIndex+dt.numGlyphs,Er=dt.lineStartIndex,Cr=dt.lineStartIndex+dt.lineLength,Rr=wr(Jt,Ut,sr,gr,At,dt,Kt,Mt);if(!Rr)return{notEnoughRoom:!0};const Sr=yr(Rr.first.point.x,Rr.first.point.y,Bt,Mt.getElevation).point,Br=yr(Rr.last.point.x,Rr.last.point.y,Bt,Mt.getElevation).point;if(It&&!At){const Gr=Lr(dt.writingMode,Sr,Br,Yt);if(Gr)return Gr}vr=[Rr.first];for(let Gr=dt.glyphStartIndex+1;Gr<Ar-1;Gr++)vr.push(vn(Jt*Ut.getoffsetX(Gr),sr,gr,At,dt.segment,Er,Cr,Mt,Kt));vr.push(Rr.last)}else{if(It&&!At){const Er=yr(Mt.tileAnchorPoint.x,Mt.tileAnchorPoint.y,Pt,Mt.getElevation).point,Cr=dt.lineStartIndex+dt.segment+1,Rr=new it.P(Mt.lineVertexArray.getx(Cr),Mt.lineVertexArray.gety(Cr)),Sr=yr(Rr.x,Rr.y,Pt,Mt.getElevation),Br=Sr.signedDistanceFromCamera>0?Sr.point:function(qr,ln,mn,Cn,On,Tn){return Hr(qr,ln,mn,1,On,Tn)}(Mt.tileAnchorPoint,Rr,Er,0,Pt,Mt),Gr=Lr(dt.writingMode,Er,Br,Yt);if(Gr)return Gr}const Ar=vn(Jt*Ut.getoffsetX(dt.glyphStartIndex),sr,gr,At,dt.segment,dt.lineStartIndex,dt.lineStartIndex+dt.lineLength,Mt,Kt);if(!Ar||Mt.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};vr=[Ar]}for(const Ar of vr)it.aj(Gt,Ar.point,Ar.angle);return{}}function Hr(Mt,dt,xt,At,It,Pt){const Bt=Mt.add(Mt.sub(dt)._unit()),Ut=It!==void 0?yr(Bt.x,Bt.y,It,Pt.getElevation).point:Qr(Bt.x,Bt.y,Pt).point,Gt=xt.sub(Ut);return xt.add(Gt._mult(At/Gt.mag()))}function Pr(Mt,dt,xt){const At=dt.projectionCache;if(At.projections[Mt])return At.projections[Mt];const It=new it.P(dt.lineVertexArray.getx(Mt),dt.lineVertexArray.gety(Mt)),Pt=Qr(It.x,It.y,dt);if(Pt.signedDistanceFromCamera>0)return At.projections[Mt]=Pt.point,At.anyProjectionOccluded=At.anyProjectionOccluded||Pt.isOccluded,Pt.point;const Bt=Mt-xt.direction;return function(Ut,Gt,Yt,Kt,Jt){return Hr(Ut,Gt,Yt,Kt,void 0,Jt)}(xt.distanceFromAnchor===0?dt.tileAnchorPoint:new it.P(dt.lineVertexArray.getx(Bt),dt.lineVertexArray.gety(Bt)),It,xt.previousVertex,xt.absOffsetX-xt.distanceFromAnchor+1,dt)}function Qr(Mt,dt,xt){const At=Mt+xt.translation[0],It=dt+xt.translation[1];let Pt;return!xt.pitchWithMap&&xt.projection.useSpecialProjectionForSymbols?(Pt=xt.projection.projectTileCoordinates(At,It,xt.unwrappedTileID,xt.getElevation),Pt.point.x=(.5*Pt.point.x+.5)*xt.width,Pt.point.y=(.5*-Pt.point.y+.5)*xt.height):(Pt=yr(At,It,xt.labelPlaneMatrix,xt.getElevation),Pt.isOccluded=!1),Pt}function sn(Mt,dt,xt){return Mt._unit()._perp()._mult(dt*xt)}function Kr(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt){if(Ut.projectionCache.offsets[Mt])return Ut.projectionCache.offsets[Mt];const Yt=xt.add(dt);if(Mt+Gt.direction<At||Mt+Gt.direction>=It)return Ut.projectionCache.offsets[Mt]=Yt,Yt;const Kt=Pr(Mt+Gt.direction,Ut,Gt),Jt=sn(Kt.sub(xt),Bt,Gt.direction),sr=xt.add(Jt),gr=Kt.add(Jt);return Ut.projectionCache.offsets[Mt]=it.ak(Pt,Yt,sr,gr)||Yt,Ut.projectionCache.offsets[Mt]}function vn(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt){const Yt=At?Mt-dt:Mt+dt;let Kt=Yt>0?1:-1,Jt=0;At&&(Kt*=-1,Jt=Math.PI),Kt<0&&(Jt+=Math.PI);let sr,gr=Kt>0?Pt+It:Pt+It+1;Ut.projectionCache.cachedAnchorPoint?sr=Ut.projectionCache.cachedAnchorPoint:(sr=Qr(Ut.tileAnchorPoint.x,Ut.tileAnchorPoint.y,Ut).point,Ut.projectionCache.cachedAnchorPoint=sr);let vr,Ar,Er=sr,Cr=sr,Rr=0,Sr=0;const Br=Math.abs(Yt),Gr=[];let qr;for(;Rr+Sr<=Br;){if(gr+=Kt,gr<Pt||gr>=Bt)return null;Rr+=Sr,Cr=Er,Ar=vr;const Cn={absOffsetX:Br,direction:Kt,distanceFromAnchor:Rr,previousVertex:Cr};if(Er=Pr(gr,Ut,Cn),xt===0)Gr.push(Cr),qr=Er.sub(Cr);else{let On;const Tn=Er.sub(Cr);On=Tn.mag()===0?sn(Pr(gr+Kt,Ut,Cn).sub(Er),xt,Kt):sn(Tn,xt,Kt),Ar||(Ar=Cr.add(On)),vr=Kr(gr,On,Er,Pt,Bt,Ar,xt,Ut,Cn),Gr.push(Ar),qr=vr.sub(Ar)}Sr=qr.mag()}const ln=qr._mult((Br-Rr)/Sr)._add(Ar||Cr),mn=Jt+Math.atan2(Er.y-Cr.y,Er.x-Cr.x);return Gr.push(ln),{point:ln,angle:Gt?mn:0,path:Gr}}const zn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yn(Mt,dt){for(let xt=0;xt<Mt;xt++){const At=dt.length;dt.resize(At+4),dt.float32.set(zn,3*At)}}function po(Mt,dt,xt){const At=dt[0],It=dt[1];return Mt[0]=xt[0]*At+xt[4]*It+xt[12],Mt[1]=xt[1]*At+xt[5]*It+xt[13],Mt[3]=xt[3]*At+xt[7]*It+xt[15],Mt}const ga=100;class ur{constructor(dt,xt,At=new cs(dt.width+200,dt.height+200,25),It=new cs(dt.width+200,dt.height+200,25)){this.transform=dt,this.mapProjection=xt,this.grid=At,this.ignoredGrid=It,this.pitchFactor=Math.cos(dt._pitch)*dt.cameraToCenterDistance,this.screenRightBoundary=dt.width+ga,this.screenBottomBoundary=dt.height+ga,this.gridRightBoundary=dt.width+200,this.gridBottomBoundary=dt.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt){const sr=dt.anchorPointX+Gt[0],gr=dt.anchorPointY+Gt[1],vr=this.projectAndGetPerspectiveRatio(It,sr,gr,Pt,Kt),Ar=At*vr.perspectiveRatio;let Er;if(Bt||Ut)Er=this._projectCollisionBox(dt,Ar,It,Pt,Bt,Ut,Gt,vr,Kt,Jt);else{const Gr=vr.point.x+(Jt?Jt.x*Ar:0),qr=vr.point.y+(Jt?Jt.y*Ar:0);Er={allPointsOccluded:!1,box:[Gr+dt.x1*Ar,qr+dt.y1*Ar,Gr+dt.x2*Ar,qr+dt.y2*Ar]}}const[Cr,Rr,Sr,Br]=Er.box;return this.mapProjection.useSpecialProjectionForSymbols&&(Bt?Er.allPointsOccluded:this.mapProjection.isOccluded(sr,gr,Pt))||vr.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Cr,Rr,Sr,Br)||xt!=="always"&&this.grid.hitTest(Cr,Rr,Sr,Br,xt,Yt)?{box:[Cr,Rr,Sr,Br],placeable:!1,offscreen:!1}:{box:[Cr,Rr,Sr,Br],placeable:!0,offscreen:this.isOffscreen(Cr,Rr,Sr,Br)}}placeCollisionCircles(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr,vr,Ar,Er){const Cr=[],Rr=new it.P(xt.anchorX,xt.anchorY),Sr=this.getPerspectiveRatio(Bt,Rr.x,Rr.y,Ut,Er),Br=(Jt?Pt/Sr:Pt*Sr)/it.ap,Gr={getElevation:Er,labelPlaneMatrix:Gt,lineVertexArray:At,pitchWithMap:Jt,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Rr,unwrappedTileID:Ut,width:this.transform.width,height:this.transform.height,translation:Ar},qr=wr(Br,It,xt.lineOffsetX*Br,xt.lineOffsetY*Br,!1,xt,!1,Gr);let ln=!1,mn=!1,Cn=!0;if(qr){const On=.5*gr*Sr+vr,Tn=new it.P(-100,-100),Sn=new it.P(this.screenRightBoundary,this.screenBottomBoundary),Un=new Kn,$a=qr.first,In=qr.last;let Mn=[];for(let uo=$a.path.length-1;uo>=1;uo--)Mn.push($a.path[uo]);for(let uo=1;uo<In.path.length;uo++)Mn.push(In.path[uo]);const ba=2.5*On;if(Yt){const uo=this.projectPathToScreenSpace(Mn,Gr,Yt);Mn=uo.some(vo=>vo.signedDistanceFromCamera<=0)?[]:uo.map(vo=>vo.point)}let Fo=[];if(Mn.length>0){const uo=Mn[0].clone(),vo=Mn[0].clone();for(let Bo=1;Bo<Mn.length;Bo++)uo.x=Math.min(uo.x,Mn[Bo].x),uo.y=Math.min(uo.y,Mn[Bo].y),vo.x=Math.max(vo.x,Mn[Bo].x),vo.y=Math.max(vo.y,Mn[Bo].y);Fo=uo.x>=Tn.x&&vo.x<=Sn.x&&uo.y>=Tn.y&&vo.y<=Sn.y?[Mn]:vo.x<Tn.x||uo.x>Sn.x||vo.y<Tn.y||uo.y>Sn.y?[]:it.al([Mn],Tn.x,Tn.y,Sn.x,Sn.y)}for(const uo of Fo){Un.reset(uo,.25*On);let vo=0;vo=Un.length<=.5*On?1:Math.ceil(Un.paddedLength/ba)+1;for(let Bo=0;Bo<vo;Bo++){const bs=Bo/Math.max(vo-1,1),El=Un.lerp(bs),zo=El.x+ga,$s=El.y+ga;Cr.push(zo,$s,On,0);const Es=zo-On,xs=$s-On,Cs=zo+On,Ul=$s+On;if(Cn=Cn&&this.isOffscreen(Es,xs,Cs,Ul),mn=mn||this.isInsideGrid(Es,xs,Cs,Ul),dt!=="always"&&this.grid.hitTestCircle(zo,$s,On,dt,sr)&&(ln=!0,!Kt))return{circles:[],offscreen:!1,collisionDetected:ln}}}}return{circles:!Kt&&ln||!mn||Sr<this.perspectiveRatioCutoff?[]:Cr,offscreen:Cn,collisionDetected:ln}}projectPathToScreenSpace(dt,xt,At){return dt.map(It=>yr(It.x,It.y,At,xt.getElevation))}queryRenderedSymbols(dt){if(dt.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const xt=[];let At=1/0,It=1/0,Pt=-1/0,Bt=-1/0;for(const Kt of dt){const Jt=new it.P(Kt.x+ga,Kt.y+ga);At=Math.min(At,Jt.x),It=Math.min(It,Jt.y),Pt=Math.max(Pt,Jt.x),Bt=Math.max(Bt,Jt.y),xt.push(Jt)}const Ut=this.grid.query(At,It,Pt,Bt).concat(this.ignoredGrid.query(At,It,Pt,Bt)),Gt={},Yt={};for(const Kt of Ut){const Jt=Kt.key;if(Gt[Jt.bucketInstanceId]===void 0&&(Gt[Jt.bucketInstanceId]={}),Gt[Jt.bucketInstanceId][Jt.featureIndex])continue;const sr=[new it.P(Kt.x1,Kt.y1),new it.P(Kt.x2,Kt.y1),new it.P(Kt.x2,Kt.y2),new it.P(Kt.x1,Kt.y2)];it.am(xt,sr)&&(Gt[Jt.bucketInstanceId][Jt.featureIndex]=!0,Yt[Jt.bucketInstanceId]===void 0&&(Yt[Jt.bucketInstanceId]=[]),Yt[Jt.bucketInstanceId].push(Jt.featureIndex))}return Yt}insertCollisionBox(dt,xt,At,It,Pt,Bt){(At?this.ignoredGrid:this.grid).insert({bucketInstanceId:It,featureIndex:Pt,collisionGroupID:Bt,overlapMode:xt},dt[0],dt[1],dt[2],dt[3])}insertCollisionCircles(dt,xt,At,It,Pt,Bt){const Ut=At?this.ignoredGrid:this.grid,Gt={bucketInstanceId:It,featureIndex:Pt,collisionGroupID:Bt,overlapMode:xt};for(let Yt=0;Yt<dt.length;Yt+=4)Ut.insertCircle(Gt,dt[Yt],dt[Yt+1],dt[Yt+2])}projectAndGetPerspectiveRatio(dt,xt,At,It,Pt){let Bt;Pt?(Bt=[xt,At,Pt(xt,At),1],it.af(Bt,Bt,dt)):(Bt=[xt,At,0,1],po(Bt,Bt,dt));const Ut=Bt[3];return{point:new it.P((Bt[0]/Ut+1)/2*this.transform.width+ga,(-Bt[1]/Ut+1)/2*this.transform.height+ga),perspectiveRatio:.5+this.transform.cameraToCenterDistance/Ut*.5,isOccluded:!1,signedDistanceFromCamera:Ut}}getPerspectiveRatio(dt,xt,At,It,Pt){const Bt=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(xt,At,It,Pt):yr(xt,At,dt,Pt);return .5+this.transform.cameraToCenterDistance/Bt.signedDistanceFromCamera*.5}isOffscreen(dt,xt,At,It){return At<ga||dt>=this.screenRightBoundary||It<ga||xt>this.screenBottomBoundary}isInsideGrid(dt,xt,At,It){return At>=0&&dt<this.gridRightBoundary&&It>=0&&xt<this.gridBottomBoundary}getViewportMatrix(){const dt=it.an([]);return it.J(dt,dt,[-100,-100,0]),dt}_projectCollisionBox(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt){let Jt=new it.P(1,0),sr=new it.P(0,1);const gr=new it.P(dt.anchorPointX+Ut[0],dt.anchorPointY+Ut[1]);if(Bt&&!Pt){const Cn=this.projectAndGetPerspectiveRatio(At,gr.x+1,gr.y,It,Yt).point.sub(Gt.point).unit(),On=Math.atan(Cn.y/Cn.x)+(Cn.x<0?Math.PI:0),Tn=Math.sin(On),Sn=Math.cos(On);Jt=new it.P(Sn,Tn),sr=new it.P(-Tn,Sn)}else if(!Bt&&Pt){const Cn=-this.transform.angle,On=Math.sin(Cn),Tn=Math.cos(Cn);Jt=new it.P(Tn,On),sr=new it.P(-On,Tn)}let vr=Gt.point,Ar=xt;if(Pt){vr=gr;const Cn=this.transform.zoom-Math.floor(this.transform.zoom);Ar=Math.pow(2,-Cn),Ar*=this.mapProjection.getPitchedTextCorrection(this.transform,gr,It),Kt||(Ar*=it.ac(.5+Gt.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}Kt&&(vr=vr.add(Jt.mult(Kt.x*Ar)).add(sr.mult(Kt.y*Ar)));const Er=dt.x1*Ar,Cr=dt.x2*Ar,Rr=(Er+Cr)/2,Sr=dt.y1*Ar,Br=dt.y2*Ar,Gr=(Sr+Br)/2,qr=[{offsetX:Er,offsetY:Sr},{offsetX:Rr,offsetY:Sr},{offsetX:Cr,offsetY:Sr},{offsetX:Cr,offsetY:Gr},{offsetX:Cr,offsetY:Br},{offsetX:Rr,offsetY:Br},{offsetX:Er,offsetY:Br},{offsetX:Er,offsetY:Gr}];let ln=[];for(const{offsetX:Cn,offsetY:On}of qr)ln.push(new it.P(vr.x+Jt.x*Cn+sr.x*On,vr.y+Jt.y*Cn+sr.y*On));let mn=!1;if(Pt){const Cn=ln.map(On=>this.projectAndGetPerspectiveRatio(At,On.x,On.y,It,Yt));mn=Cn.some(On=>!On.isOccluded),ln=Cn.map(On=>On.point)}else mn=!0;return{box:it.ao(ln),allPointsOccluded:!mn}}}function br(Mt,dt,xt){return dt*(it.X/(Mt.tileSize*Math.pow(2,xt-Mt.tileID.overscaledZ)))}class Nr{constructor(dt,xt,At,It){this.opacity=dt?Math.max(0,Math.min(1,dt.opacity+(dt.placed?xt:-xt))):It&&At?1:0,this.placed=At}isHidden(){return this.opacity===0&&!this.placed}}class Ur{constructor(dt,xt,At,It,Pt){this.text=new Nr(dt?dt.text:null,xt,At,Pt),this.icon=new Nr(dt?dt.icon:null,xt,It,Pt)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vr{constructor(dt,xt,At){this.text=dt,this.icon=xt,this.skipFade=At}}class Xr{constructor(){this.invProjMatrix=it.H(),this.viewportMatrix=it.H(),this.circles=[]}}class cn{constructor(dt,xt,At,It,Pt){this.bucketInstanceId=dt,this.featureIndex=xt,this.sourceLayerIndex=At,this.bucketIndex=It,this.tileID=Pt}}class $n{constructor(dt){this.crossSourceCollisions=dt,this.maxGroupID=0,this.collisionGroups={}}get(dt){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[dt]){const xt=++this.maxGroupID;this.collisionGroups[dt]={ID:xt,predicate:At=>At.collisionGroupID===xt}}return this.collisionGroups[dt]}}function An(Mt,dt,xt,At,It){const{horizontalAlign:Pt,verticalAlign:Bt}=it.au(Mt);return new it.P(-(Pt-.5)*dt+At[0]*It,-(Bt-.5)*xt+At[1]*It)}class na{constructor(dt,xt,At,It,Pt,Bt){this.transform=dt.clone(),this.terrain=At,this.collisionIndex=new ur(this.transform,xt),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=It,this.retainedQueryData={},this.collisionGroups=new $n(Pt),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=Bt,Bt&&(Bt.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(dt){const xt=this.terrain;return xt?(At,It)=>xt.getElevation(dt,At,It):null}getBucketParts(dt,xt,At,It){const Pt=At.getBucket(xt),Bt=At.latestFeatureIndex;if(!Pt||!Bt||xt.id!==Pt.layerIds[0])return;const Ut=At.collisionBoxArray,Gt=Pt.layers[0].layout,Yt=Pt.layers[0].paint,Kt=Math.pow(2,this.transform.zoom-At.tileID.overscaledZ),Jt=At.tileSize/it.X,sr=At.tileID.toUnwrapped(),gr=this.transform.calculatePosMatrix(sr),vr=Gt.get("text-pitch-alignment")==="map",Ar=Gt.get("text-rotation-alignment")==="map",Er=br(At,1,this.transform.zoom),Cr=this.collisionIndex.mapProjection.translatePosition(this.transform,At,Yt.get("text-translate"),Yt.get("text-translate-anchor")),Rr=this.collisionIndex.mapProjection.translatePosition(this.transform,At,Yt.get("icon-translate"),Yt.get("icon-translate-anchor")),Sr=Ms(gr,vr,Ar,this.transform,Er);let Br=null;if(vr){const qr=ns(gr,vr,Ar,this.transform,Er);Br=it.L([],this.transform.labelPlaneMatrix,qr)}this.retainedQueryData[Pt.bucketInstanceId]=new cn(Pt.bucketInstanceId,Bt,Pt.sourceLayerIndex,Pt.index,At.tileID);const Gr={bucket:Pt,layout:Gt,translationText:Cr,translationIcon:Rr,posMatrix:gr,unwrappedTileID:sr,textLabelPlaneMatrix:Sr,labelToScreenMatrix:Br,scale:Kt,textPixelRatio:Jt,holdingForFade:At.holdingForFade(),collisionBoxArray:Ut,partiallyEvaluatedTextSize:it.ag(Pt.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Pt.sourceID)};if(It)for(const qr of Pt.sortKeyRanges){const{sortKey:ln,symbolInstanceStart:mn,symbolInstanceEnd:Cn}=qr;dt.push({sortKey:ln,symbolInstanceStart:mn,symbolInstanceEnd:Cn,parameters:Gr})}else dt.push({symbolInstanceStart:0,symbolInstanceEnd:Pt.symbolInstances.length,parameters:Gr})}attemptAnchorPlacement(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr,vr,Ar,Er,Cr,Rr,Sr){const Br=it.aq[dt.textAnchor],Gr=[dt.textOffset0,dt.textOffset1],qr=An(Br,At,It,Gr,Pt),ln=this.collisionIndex.placeCollisionBox(xt,sr,Gt,Yt,Kt,Ut,Bt,Er,Jt.predicate,Sr,qr);if((!Rr||this.collisionIndex.placeCollisionBox(Rr,sr,Gt,Yt,Kt,Ut,Bt,Cr,Jt.predicate,Sr,qr).placeable)&&ln.placeable){let mn;if(this.prevPlacement&&this.prevPlacement.variableOffsets[gr.crossTileID]&&this.prevPlacement.placements[gr.crossTileID]&&this.prevPlacement.placements[gr.crossTileID].text&&(mn=this.prevPlacement.variableOffsets[gr.crossTileID].anchor),gr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[gr.crossTileID]={textOffset:Gr,width:At,height:It,anchor:Br,textBoxScale:Pt,prevAnchor:mn},this.markUsedJustification(vr,Br,gr,Ar),vr.allowVerticalPlacement&&(this.markUsedOrientation(vr,Ar,gr),this.placedOrientations[gr.crossTileID]=Ar),{shift:qr,placedGlyphBoxes:ln}}}placeLayerBucketPart(dt,xt,At){const{bucket:It,layout:Pt,translationText:Bt,translationIcon:Ut,posMatrix:Gt,unwrappedTileID:Yt,textLabelPlaneMatrix:Kt,labelToScreenMatrix:Jt,textPixelRatio:sr,holdingForFade:gr,collisionBoxArray:vr,partiallyEvaluatedTextSize:Ar,collisionGroup:Er}=dt.parameters,Cr=Pt.get("text-optional"),Rr=Pt.get("icon-optional"),Sr=it.ar(Pt,"text-overlap","text-allow-overlap"),Br=Sr==="always",Gr=it.ar(Pt,"icon-overlap","icon-allow-overlap"),qr=Gr==="always",ln=Pt.get("text-rotation-alignment")==="map",mn=Pt.get("text-pitch-alignment")==="map",Cn=Pt.get("icon-text-fit")!=="none",On=Pt.get("symbol-z-order")==="viewport-y",Tn=Br&&(qr||!It.hasIconData()||Rr),Sn=qr&&(Br||!It.hasTextData()||Cr);!It.collisionArrays&&vr&&It.deserializeCollisionBoxes(vr);const Un=this._getTerrainElevationFunc(this.retainedQueryData[It.bucketInstanceId].tileID),$a=(In,Mn,ba)=>{var Fo,uo;if(xt[In.crossTileID])return;if(gr)return void(this.placements[In.crossTileID]=new Vr(!1,!1,!1));let vo=!1,Bo=!1,bs=!0,El=null,zo={box:null,placeable:!1,offscreen:null},$s={placeable:!1},Es=null,xs=null,Cs=null,Ul=0,Zu=0,lm=0;Mn.textFeatureIndex?Ul=Mn.textFeatureIndex:In.useRuntimeCollisionCircles&&(Ul=In.featureIndex),Mn.verticalTextFeatureIndex&&(Zu=Mn.verticalTextFeatureIndex);const Xu=Mn.textBox;if(Xu){const Qs=ps=>{let ws=it.ah.horizontal;if(It.allowVerticalPlacement&&!ps&&this.prevPlacement){const Hs=this.prevPlacement.placedOrientations[In.crossTileID];Hs&&(this.placedOrientations[In.crossTileID]=Hs,ws=Hs,this.markUsedOrientation(It,ws,In))}return ws},yl=(ps,ws)=>{if(It.allowVerticalPlacement&&In.numVerticalGlyphVertices>0&&Mn.verticalTextBox){for(const Hs of It.writingModes)if(Hs===it.ah.vertical?(zo=ws(),$s=zo):zo=ps(),zo&&zo.placeable)break}else zo=ps()},ru=In.textAnchorOffsetStartIndex,Cl=In.textAnchorOffsetEndIndex;if(Cl===ru){const ps=(ws,Hs)=>{const bo=this.collisionIndex.placeCollisionBox(ws,Sr,sr,Gt,Yt,mn,ln,Bt,Er.predicate,Un);return bo&&bo.placeable&&(this.markUsedOrientation(It,Hs,In),this.placedOrientations[In.crossTileID]=Hs),bo};yl(()=>ps(Xu,it.ah.horizontal),()=>{const ws=Mn.verticalTextBox;return It.allowVerticalPlacement&&In.numVerticalGlyphVertices>0&&ws?ps(ws,it.ah.vertical):{box:null,offscreen:null}}),Qs(zo&&zo.placeable)}else{let ps=it.aq[(uo=(Fo=this.prevPlacement)===null||Fo===void 0?void 0:Fo.variableOffsets[In.crossTileID])===null||uo===void 0?void 0:uo.anchor];const ws=(bo,Eu,Ku)=>{const Ju=bo.x2-bo.x1,hy=bo.y2-bo.y1,Jy=In.textBoxScale,fy=Cn&&Gr==="never"?Eu:null;let nu=null,dy=Sr==="never"?1:2,cm="never";ps&&dy++;for(let Dp=0;Dp<dy;Dp++){for(let hm=ru;hm<Cl;hm++){const fm=It.textAnchorOffsets.get(hm);if(ps&&fm.textAnchor!==ps)continue;const Qu=this.attemptAnchorPlacement(fm,bo,Ju,hy,Jy,ln,mn,sr,Gt,Yt,Er,cm,In,It,Ku,Bt,Ut,fy,Un);if(Qu&&(nu=Qu.placedGlyphBoxes,nu&&nu.placeable))return vo=!0,El=Qu.shift,nu}ps?ps=null:cm=Sr}return At&&!nu&&(nu={box:this.collisionIndex.placeCollisionBox(Xu,"always",sr,Gt,Yt,mn,ln,Bt,Er.predicate,Un,new it.P(0,0)).box,offscreen:!1,placeable:!1}),nu};yl(()=>ws(Xu,Mn.iconBox,it.ah.horizontal),()=>{const bo=Mn.verticalTextBox;return It.allowVerticalPlacement&&(!zo||!zo.placeable)&&In.numVerticalGlyphVertices>0&&bo?ws(bo,Mn.verticalIconBox,it.ah.vertical):{box:null,occluded:!0,offscreen:null}}),zo&&(vo=zo.placeable,bs=zo.offscreen);const Hs=Qs(zo&&zo.placeable);if(!vo&&this.prevPlacement){const bo=this.prevPlacement.variableOffsets[In.crossTileID];bo&&(this.variableOffsets[In.crossTileID]=bo,this.markUsedJustification(It,bo.anchor,In,Hs))}}}if(Es=zo,vo=Es&&Es.placeable,bs=Es&&Es.offscreen,In.useRuntimeCollisionCircles){const Qs=It.text.placedSymbolArray.get(In.centerJustifiedTextSymbolIndex),yl=it.ai(It.textSizeData,Ar,Qs),ru=Pt.get("text-padding");xs=this.collisionIndex.placeCollisionCircles(Sr,Qs,It.lineVertexArray,It.glyphOffsetArray,yl,Gt,Yt,Kt,Jt,At,mn,Er.predicate,In.collisionCircleDiameter,ru,Bt,Un),xs.circles.length&&xs.collisionDetected&&!At&&it.w("Collisions detected, but collision boxes are not shown"),vo=Br||xs.circles.length>0&&!xs.collisionDetected,bs=bs&&xs.offscreen}if(Mn.iconFeatureIndex&&(lm=Mn.iconFeatureIndex),Mn.iconBox){const Qs=yl=>this.collisionIndex.placeCollisionBox(yl,Gr,sr,Gt,Yt,mn,ln,Ut,Er.predicate,Un,Cn&&El?El:void 0);$s&&$s.placeable&&Mn.verticalIconBox?(Cs=Qs(Mn.verticalIconBox),Bo=Cs.placeable):(Cs=Qs(Mn.iconBox),Bo=Cs.placeable),bs=bs&&Cs.offscreen}const Js=Cr||In.numHorizontalGlyphVertices===0&&In.numVerticalGlyphVertices===0,um=Rr||In.numIconVertices===0;Js||um?um?Js||(Bo=Bo&&vo):vo=Bo&&vo:Bo=vo=Bo&&vo;const cv=Bo&&Cs.placeable;if(vo&&Es.placeable&&this.collisionIndex.insertCollisionBox(Es.box,Sr,Pt.get("text-ignore-placement"),It.bucketInstanceId,$s&&$s.placeable&&Zu?Zu:Ul,Er.ID),cv&&this.collisionIndex.insertCollisionBox(Cs.box,Gr,Pt.get("icon-ignore-placement"),It.bucketInstanceId,lm,Er.ID),xs&&vo&&this.collisionIndex.insertCollisionCircles(xs.circles,Sr,Pt.get("text-ignore-placement"),It.bucketInstanceId,Ul,Er.ID),At&&this.storeCollisionData(It.bucketInstanceId,ba,Mn,Es,Cs,xs),In.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(It.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[In.crossTileID]=new Vr(vo||Tn,Bo||Sn,bs||It.justReloaded),xt[In.crossTileID]=!0};if(On){if(dt.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const In=It.getSortedSymbolIndexes(this.transform.angle);for(let Mn=In.length-1;Mn>=0;--Mn){const ba=In[Mn];$a(It.symbolInstances.get(ba),It.collisionArrays[ba],ba)}}else for(let In=dt.symbolInstanceStart;In<dt.symbolInstanceEnd;In++)$a(It.symbolInstances.get(In),It.collisionArrays[In],In);if(At&&It.bucketInstanceId in this.collisionCircleArrays){const In=this.collisionCircleArrays[It.bucketInstanceId];it.as(In.invProjMatrix,Gt),In.viewportMatrix=this.collisionIndex.getViewportMatrix()}It.justReloaded=!1}storeCollisionData(dt,xt,At,It,Pt,Bt){if(At.textBox||At.iconBox){let Ut,Gt;this.collisionBoxArrays.has(dt)?Ut=this.collisionBoxArrays.get(dt):(Ut=new Map,this.collisionBoxArrays.set(dt,Ut)),Ut.has(xt)?Gt=Ut.get(xt):(Gt={text:null,icon:null},Ut.set(xt,Gt)),At.textBox&&(Gt.text=It.box),At.iconBox&&(Gt.icon=Pt.box)}if(Bt){let Ut=this.collisionCircleArrays[dt];Ut===void 0&&(Ut=this.collisionCircleArrays[dt]=new Xr);for(let Gt=0;Gt<Bt.circles.length;Gt+=4)Ut.circles.push(Bt.circles[Gt+0]),Ut.circles.push(Bt.circles[Gt+1]),Ut.circles.push(Bt.circles[Gt+2]),Ut.circles.push(Bt.collisionDetected?1:0)}}markUsedJustification(dt,xt,At,It){let Pt;Pt=It===it.ah.vertical?At.verticalPlacedTextSymbolIndex:{left:At.leftJustifiedTextSymbolIndex,center:At.centerJustifiedTextSymbolIndex,right:At.rightJustifiedTextSymbolIndex}[it.at(xt)];const Bt=[At.leftJustifiedTextSymbolIndex,At.centerJustifiedTextSymbolIndex,At.rightJustifiedTextSymbolIndex,At.verticalPlacedTextSymbolIndex];for(const Ut of Bt)Ut>=0&&(dt.text.placedSymbolArray.get(Ut).crossTileID=Pt>=0&&Ut!==Pt?0:At.crossTileID)}markUsedOrientation(dt,xt,At){const It=xt===it.ah.horizontal||xt===it.ah.horizontalOnly?xt:0,Pt=xt===it.ah.vertical?xt:0,Bt=[At.leftJustifiedTextSymbolIndex,At.centerJustifiedTextSymbolIndex,At.rightJustifiedTextSymbolIndex];for(const Ut of Bt)dt.text.placedSymbolArray.get(Ut).placedOrientation=It;At.verticalPlacedTextSymbolIndex&&(dt.text.placedSymbolArray.get(At.verticalPlacedTextSymbolIndex).placedOrientation=Pt)}commit(dt){this.commitTime=dt,this.zoomAtLastRecencyCheck=this.transform.zoom;const xt=this.prevPlacement;let At=!1;this.prevZoomAdjustment=xt?xt.zoomAdjustment(this.transform.zoom):0;const It=xt?xt.symbolFadeChange(dt):1,Pt=xt?xt.opacities:{},Bt=xt?xt.variableOffsets:{},Ut=xt?xt.placedOrientations:{};for(const Gt in this.placements){const Yt=this.placements[Gt],Kt=Pt[Gt];Kt?(this.opacities[Gt]=new Ur(Kt,It,Yt.text,Yt.icon),At=At||Yt.text!==Kt.text.placed||Yt.icon!==Kt.icon.placed):(this.opacities[Gt]=new Ur(null,It,Yt.text,Yt.icon,Yt.skipFade),At=At||Yt.text||Yt.icon)}for(const Gt in Pt){const Yt=Pt[Gt];if(!this.opacities[Gt]){const Kt=new Ur(Yt,It,!1,!1);Kt.isHidden()||(this.opacities[Gt]=Kt,At=At||Yt.text.placed||Yt.icon.placed)}}for(const Gt in Bt)this.variableOffsets[Gt]||!this.opacities[Gt]||this.opacities[Gt].isHidden()||(this.variableOffsets[Gt]=Bt[Gt]);for(const Gt in Ut)this.placedOrientations[Gt]||!this.opacities[Gt]||this.opacities[Gt].isHidden()||(this.placedOrientations[Gt]=Ut[Gt]);if(xt&&xt.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");At?this.lastPlacementChangeTime=dt:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=xt?xt.lastPlacementChangeTime:dt)}updateLayerOpacities(dt,xt){const At={};for(const It of xt){const Pt=It.getBucket(dt);Pt&&It.latestFeatureIndex&&dt.id===Pt.layerIds[0]&&this.updateBucketOpacities(Pt,It.tileID,At,It.collisionBoxArray)}}updateBucketOpacities(dt,xt,At,It){dt.hasTextData()&&(dt.text.opacityVertexArray.clear(),dt.text.hasVisibleVertices=!1),dt.hasIconData()&&(dt.icon.opacityVertexArray.clear(),dt.icon.hasVisibleVertices=!1),dt.hasIconCollisionBoxData()&&dt.iconCollisionBox.collisionVertexArray.clear(),dt.hasTextCollisionBoxData()&&dt.textCollisionBox.collisionVertexArray.clear();const Pt=dt.layers[0],Bt=Pt.layout,Ut=new Ur(null,0,!1,!1,!0),Gt=Bt.get("text-allow-overlap"),Yt=Bt.get("icon-allow-overlap"),Kt=Pt._unevaluatedLayout.hasValue("text-variable-anchor")||Pt._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Jt=Bt.get("text-rotation-alignment")==="map",sr=Bt.get("text-pitch-alignment")==="map",gr=Bt.get("icon-text-fit")!=="none",vr=new Ur(null,0,Gt&&(Yt||!dt.hasIconData()||Bt.get("icon-optional")),Yt&&(Gt||!dt.hasTextData()||Bt.get("text-optional")),!0);!dt.collisionArrays&&It&&(dt.hasIconCollisionBoxData()||dt.hasTextCollisionBoxData())&&dt.deserializeCollisionBoxes(It);const Ar=(Cr,Rr,Sr)=>{for(let Br=0;Br<Rr/4;Br++)Cr.opacityVertexArray.emplaceBack(Sr);Cr.hasVisibleVertices=Cr.hasVisibleVertices||Sr!==Ol},Er=this.collisionBoxArrays.get(dt.bucketInstanceId);for(let Cr=0;Cr<dt.symbolInstances.length;Cr++){const Rr=dt.symbolInstances.get(Cr),{numHorizontalGlyphVertices:Sr,numVerticalGlyphVertices:Br,crossTileID:Gr}=Rr;let qr=this.opacities[Gr];At[Gr]?qr=Ut:qr||(qr=vr,this.opacities[Gr]=qr),At[Gr]=!0;const ln=Rr.numIconVertices>0,mn=this.placedOrientations[Rr.crossTileID],Cn=mn===it.ah.vertical,On=mn===it.ah.horizontal||mn===it.ah.horizontalOnly;if(Sr>0||Br>0){const Sn=hs(qr.text);Ar(dt.text,Sr,Cn?Ol:Sn),Ar(dt.text,Br,On?Ol:Sn);const Un=qr.text.isHidden();[Rr.rightJustifiedTextSymbolIndex,Rr.centerJustifiedTextSymbolIndex,Rr.leftJustifiedTextSymbolIndex].forEach(Mn=>{Mn>=0&&(dt.text.placedSymbolArray.get(Mn).hidden=Un||Cn?1:0)}),Rr.verticalPlacedTextSymbolIndex>=0&&(dt.text.placedSymbolArray.get(Rr.verticalPlacedTextSymbolIndex).hidden=Un||On?1:0);const $a=this.variableOffsets[Rr.crossTileID];$a&&this.markUsedJustification(dt,$a.anchor,Rr,mn);const In=this.placedOrientations[Rr.crossTileID];In&&(this.markUsedJustification(dt,"left",Rr,In),this.markUsedOrientation(dt,In,Rr))}if(ln){const Sn=hs(qr.icon),Un=!(gr&&Rr.verticalPlacedIconSymbolIndex&&Cn);Rr.placedIconSymbolIndex>=0&&(Ar(dt.icon,Rr.numIconVertices,Un?Sn:Ol),dt.icon.placedSymbolArray.get(Rr.placedIconSymbolIndex).hidden=qr.icon.isHidden()),Rr.verticalPlacedIconSymbolIndex>=0&&(Ar(dt.icon,Rr.numVerticalIconVertices,Un?Ol:Sn),dt.icon.placedSymbolArray.get(Rr.verticalPlacedIconSymbolIndex).hidden=qr.icon.isHidden())}const Tn=Er&&Er.has(Cr)?Er.get(Cr):{text:null,icon:null};if(dt.hasIconCollisionBoxData()||dt.hasTextCollisionBoxData()){const Sn=dt.collisionArrays[Cr];if(Sn){let Un=new it.P(0,0);if(Sn.textBox||Sn.verticalTextBox){let $a=!0;if(Kt){const In=this.variableOffsets[Gr];In?(Un=An(In.anchor,In.width,In.height,In.textOffset,In.textBoxScale),Jt&&Un._rotate(sr?this.transform.angle:-this.transform.angle)):$a=!1}if(Sn.textBox||Sn.verticalTextBox){let In;Sn.textBox&&(In=Cn),Sn.verticalTextBox&&(In=On),wo(dt.textCollisionBox.collisionVertexArray,qr.text.placed,!$a||In,Tn.text,Un.x,Un.y)}}if(Sn.iconBox||Sn.verticalIconBox){const $a=!!(!On&&Sn.verticalIconBox);let In;Sn.iconBox&&(In=$a),Sn.verticalIconBox&&(In=!$a),wo(dt.iconCollisionBox.collisionVertexArray,qr.icon.placed,In,Tn.icon,gr?Un.x:0,gr?Un.y:0)}}}}if(dt.sortFeatures(this.transform.angle),this.retainedQueryData[dt.bucketInstanceId]&&(this.retainedQueryData[dt.bucketInstanceId].featureSortOrder=dt.featureSortOrder),dt.hasTextData()&&dt.text.opacityVertexBuffer&&dt.text.opacityVertexBuffer.updateData(dt.text.opacityVertexArray),dt.hasIconData()&&dt.icon.opacityVertexBuffer&&dt.icon.opacityVertexBuffer.updateData(dt.icon.opacityVertexArray),dt.hasIconCollisionBoxData()&&dt.iconCollisionBox.collisionVertexBuffer&&dt.iconCollisionBox.collisionVertexBuffer.updateData(dt.iconCollisionBox.collisionVertexArray),dt.hasTextCollisionBoxData()&&dt.textCollisionBox.collisionVertexBuffer&&dt.textCollisionBox.collisionVertexBuffer.updateData(dt.textCollisionBox.collisionVertexArray),dt.text.opacityVertexArray.length!==dt.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${dt.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${dt.text.layoutVertexArray.length}) / 4`);if(dt.icon.opacityVertexArray.length!==dt.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${dt.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${dt.icon.layoutVertexArray.length}) / 4`);if(dt.bucketInstanceId in this.collisionCircleArrays){const Cr=this.collisionCircleArrays[dt.bucketInstanceId];dt.placementInvProjMatrix=Cr.invProjMatrix,dt.placementViewportMatrix=Cr.viewportMatrix,dt.collisionCircleArray=Cr.circles,delete this.collisionCircleArrays[dt.bucketInstanceId]}}symbolFadeChange(dt){return this.fadeDuration===0?1:(dt-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(dt){return Math.max(0,(this.transform.zoom-dt)/1.5)}hasTransitions(dt){return this.stale||dt-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(dt,xt){const At=this.zoomAtLastRecencyCheck===xt?1-this.zoomAdjustment(xt):1;return this.zoomAtLastRecencyCheck=xt,this.commitTime+this.fadeDuration*At>dt}setStale(){this.stale=!0}}function wo(Mt,dt,xt,At,It,Pt){At&&At.length!==0||(At=[0,0,0,0]);const Bt=At[0]-ga,Ut=At[1]-ga,Gt=At[2]-ga,Yt=At[3]-ga;Mt.emplaceBack(dt?1:0,xt?1:0,It||0,Pt||0,Bt,Ut),Mt.emplaceBack(dt?1:0,xt?1:0,It||0,Pt||0,Gt,Ut),Mt.emplaceBack(dt?1:0,xt?1:0,It||0,Pt||0,Gt,Yt),Mt.emplaceBack(dt?1:0,xt?1:0,It||0,Pt||0,Bt,Yt)}const ro=Math.pow(2,25),jo=Math.pow(2,24),nn=Math.pow(2,17),to=Math.pow(2,16),mo=Math.pow(2,9),Rs=Math.pow(2,8),Yo=Math.pow(2,1);function hs(Mt){if(Mt.opacity===0&&!Mt.placed)return 0;if(Mt.opacity===1&&Mt.placed)return 4294967295;const dt=Mt.placed?1:0,xt=Math.floor(127*Mt.opacity);return xt*ro+dt*jo+xt*nn+dt*to+xt*mo+dt*Rs+xt*Yo+dt}const Ol=0;function $l(){return{isOccluded:(Mt,dt,xt)=>!1,getPitchedTextCorrection:(Mt,dt,xt)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(Mt,dt,xt,At){throw new Error("Not implemented.")},translatePosition:(Mt,dt,xt,At)=>function(It,Pt,Bt,Ut,Gt=!1){if(!Bt[0]&&!Bt[1])return[0,0];const Yt=Gt?Ut==="map"?It.angle:0:Ut==="viewport"?-It.angle:0;if(Yt){const Kt=Math.sin(Yt),Jt=Math.cos(Yt);Bt=[Bt[0]*Jt-Bt[1]*Kt,Bt[0]*Kt+Bt[1]*Jt]}return[Gt?Bt[0]:br(Pt,Bt[0],It.zoom),Gt?Bt[1]:br(Pt,Bt[1],It.zoom)]}(Mt,dt,xt,At),getCircleRadiusCorrection:Mt=>1}}class To{constructor(dt){this._sortAcrossTiles=dt.layout.get("symbol-z-order")!=="viewport-y"&&!dt.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(dt,xt,At,It,Pt){const Bt=this._bucketParts;for(;this._currentTileIndex<dt.length;)if(xt.getBucketParts(Bt,It,dt[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,Pt())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Bt.sort((Ut,Gt)=>Ut.sortKey-Gt.sortKey));this._currentPartIndex<Bt.length;)if(xt.placeLayerBucketPart(Bt[this._currentPartIndex],this._seenCrossTileIDs,At),this._currentPartIndex++,Pt())return!0;return!1}}class Nl{constructor(dt,xt,At,It,Pt,Bt,Ut,Gt){this.placement=new na(dt,$l(),xt,Bt,Ut,Gt),this._currentPlacementIndex=At.length-1,this._forceFullPlacement=It,this._showCollisionBoxes=Pt,this._done=!1}isDone(){return this._done}continuePlacement(dt,xt,At){const It=ot.now(),Pt=()=>!this._forceFullPlacement&&ot.now()-It>2;for(;this._currentPlacementIndex>=0;){const Bt=xt[dt[this._currentPlacementIndex]],Ut=this.placement.collisionIndex.transform.zoom;if(Bt.type==="symbol"&&(!Bt.minzoom||Bt.minzoom<=Ut)&&(!Bt.maxzoom||Bt.maxzoom>Ut)){if(this._inProgressLayer||(this._inProgressLayer=new To(Bt)),this._inProgressLayer.continuePlacement(At[Bt.source],this.placement,this._showCollisionBoxes,Bt,Pt))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(dt){return this.placement.commit(dt),this.placement}}const Ls=512/it.X/2;class Uo{constructor(dt,xt,At){this.tileID=dt,this.bucketInstanceId=At,this._symbolsByKey={};const It=new Map;for(let Pt=0;Pt<xt.length;Pt++){const Bt=xt.get(Pt),Ut=Bt.key,Gt=It.get(Ut);Gt?Gt.push(Bt):It.set(Ut,[Bt])}for(const[Pt,Bt]of It){const Ut={positions:Bt.map(Gt=>({x:Math.floor(Gt.anchorX*Ls),y:Math.floor(Gt.anchorY*Ls)})),crossTileIDs:Bt.map(Gt=>Gt.crossTileID)};if(Ut.positions.length>128){const Gt=new it.av(Ut.positions.length,16,Uint16Array);for(const{x:Yt,y:Kt}of Ut.positions)Gt.add(Yt,Kt);Gt.finish(),delete Ut.positions,Ut.index=Gt}this._symbolsByKey[Pt]=Ut}}getScaledCoordinates(dt,xt){const{x:At,y:It,z:Pt}=this.tileID.canonical,{x:Bt,y:Ut,z:Gt}=xt.canonical,Yt=Ls/Math.pow(2,Gt-Pt),Kt=(Ut*it.X+dt.anchorY)*Yt,Jt=It*it.X*Ls;return{x:Math.floor((Bt*it.X+dt.anchorX)*Yt-At*it.X*Ls),y:Math.floor(Kt-Jt)}}findMatches(dt,xt,At){const It=this.tileID.canonical.z<xt.canonical.z?1:Math.pow(2,this.tileID.canonical.z-xt.canonical.z);for(let Pt=0;Pt<dt.length;Pt++){const Bt=dt.get(Pt);if(Bt.crossTileID)continue;const Ut=this._symbolsByKey[Bt.key];if(!Ut)continue;const Gt=this.getScaledCoordinates(Bt,xt);if(Ut.index){const Yt=Ut.index.range(Gt.x-It,Gt.y-It,Gt.x+It,Gt.y+It).sort();for(const Kt of Yt){const Jt=Ut.crossTileIDs[Kt];if(!At[Jt]){At[Jt]=!0,Bt.crossTileID=Jt;break}}}else if(Ut.positions)for(let Yt=0;Yt<Ut.positions.length;Yt++){const Kt=Ut.positions[Yt],Jt=Ut.crossTileIDs[Yt];if(Math.abs(Kt.x-Gt.x)<=It&&Math.abs(Kt.y-Gt.y)<=It&&!At[Jt]){At[Jt]=!0,Bt.crossTileID=Jt;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:dt})=>dt)}}class uu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(dt){const xt=Math.round((dt-this.lng)/360);if(xt!==0)for(const At in this.indexes){const It=this.indexes[At],Pt={};for(const Bt in It){const Ut=It[Bt];Ut.tileID=Ut.tileID.unwrapTo(Ut.tileID.wrap+xt),Pt[Ut.tileID.key]=Ut}this.indexes[At]=Pt}this.lng=dt}addBucket(dt,xt,At){if(this.indexes[dt.overscaledZ]&&this.indexes[dt.overscaledZ][dt.key]){if(this.indexes[dt.overscaledZ][dt.key].bucketInstanceId===xt.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(dt.overscaledZ,this.indexes[dt.overscaledZ][dt.key])}for(let Pt=0;Pt<xt.symbolInstances.length;Pt++)xt.symbolInstances.get(Pt).crossTileID=0;this.usedCrossTileIDs[dt.overscaledZ]||(this.usedCrossTileIDs[dt.overscaledZ]={});const It=this.usedCrossTileIDs[dt.overscaledZ];for(const Pt in this.indexes){const Bt=this.indexes[Pt];if(Number(Pt)>dt.overscaledZ)for(const Ut in Bt){const Gt=Bt[Ut];Gt.tileID.isChildOf(dt)&&Gt.findMatches(xt.symbolInstances,dt,It)}else{const Ut=Bt[dt.scaledTo(Number(Pt)).key];Ut&&Ut.findMatches(xt.symbolInstances,dt,It)}}for(let Pt=0;Pt<xt.symbolInstances.length;Pt++){const Bt=xt.symbolInstances.get(Pt);Bt.crossTileID||(Bt.crossTileID=At.generate(),It[Bt.crossTileID]=!0)}return this.indexes[dt.overscaledZ]===void 0&&(this.indexes[dt.overscaledZ]={}),this.indexes[dt.overscaledZ][dt.key]=new Uo(dt,xt.symbolInstances,xt.bucketInstanceId),!0}removeBucketCrossTileIDs(dt,xt){for(const At of xt.getCrossTileIDsLists())for(const It of At)delete this.usedCrossTileIDs[dt][It]}removeStaleBuckets(dt){let xt=!1;for(const At in this.indexes){const It=this.indexes[At];for(const Pt in It)dt[It[Pt].bucketInstanceId]||(this.removeBucketCrossTileIDs(At,It[Pt]),delete It[Pt],xt=!0)}return xt}}class lp{constructor(){this.layerIndexes={},this.crossTileIDs=new uu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(dt,xt,At){let It=this.layerIndexes[dt.id];It===void 0&&(It=this.layerIndexes[dt.id]=new Vs);let Pt=!1;const Bt={};It.handleWrapJump(At);for(const Ut of xt){const Gt=Ut.getBucket(dt);Gt&&dt.id===Gt.layerIds[0]&&(Gt.bucketInstanceId||(Gt.bucketInstanceId=++this.maxBucketInstanceId),It.addBucket(Ut.tileID,Gt,this.crossTileIDs)&&(Pt=!0),Bt[Gt.bucketInstanceId]=!0)}return It.removeStaleBuckets(Bt)&&(Pt=!0),Pt}pruneUnusedLayers(dt){const xt={};dt.forEach(At=>{xt[At]=!0});for(const At in this.layerIndexes)xt[At]||delete this.layerIndexes[At]}}const vs=(Mt,dt)=>it.t(Mt,dt&&dt.filter(xt=>xt.identifier!=="source.canvas")),up=it.aw();class cu extends it.E{constructor(dt,xt={}){super(),this._rtlPluginLoaded=()=>{for(const At in this.sourceCaches){const It=this.sourceCaches[At].getSource().type;It!=="vector"&&It!=="geojson"||this.sourceCaches[At].reload()}},this.map=dt,this.dispatcher=new yn(pn(),dt._getMapId()),this.dispatcher.registerMessageHandler("GG",(At,It)=>this.getGlyphs(At,It)),this.dispatcher.registerMessageHandler("GI",(At,It)=>this.getImages(At,It)),this.imageManager=new Xt,this.imageManager.setEventedParent(this),this.glyphManager=new cr(dt._requestManager,xt.localIdeographFontFamily),this.lineAtlas=new Mr(256,512),this.crossTileSymbolIndex=new lp,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new it.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",it.ay()),us().on(gn,this._rtlPluginLoaded),this.on("data",At=>{if(At.dataType!=="source"||At.sourceDataType!=="metadata")return;const It=this.sourceCaches[At.sourceId];if(!It)return;const Pt=It.getSource();if(Pt&&Pt.vectorLayerIds)for(const Bt in this._layers){const Ut=this._layers[Bt];Ut.source===Pt.id&&this._validateLayer(Ut)}})}loadURL(dt,xt={},At){this.fire(new it.k("dataloading",{dataType:"style"})),xt.validate=typeof xt.validate!="boolean"||xt.validate;const It=this.map._requestManager.transformRequest(dt,"Style");this._loadStyleRequest=new AbortController;const Pt=this._loadStyleRequest;it.h(It,this._loadStyleRequest).then(Bt=>{this._loadStyleRequest=null,this._load(Bt.data,xt,At)}).catch(Bt=>{this._loadStyleRequest=null,Bt&&!Pt.signal.aborted&&this.fire(new it.j(Bt))})}loadJSON(dt,xt={},At){this.fire(new it.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ot.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,xt.validate=xt.validate!==!1,this._load(dt,xt,At)}).catch(()=>{})}loadEmpty(){this.fire(new it.k("dataloading",{dataType:"style"})),this._load(up,{validate:!1})}_load(dt,xt,At){var It;const Pt=xt.transformStyle?xt.transformStyle(At,dt):dt;if(!xt.validate||!vs(this,it.u(Pt))){this._loaded=!0,this.stylesheet=Pt;for(const Bt in Pt.sources)this.addSource(Bt,Pt.sources[Bt],{validate:!1});Pt.sprite?this._loadSprite(Pt.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(Pt.glyphs),this._createLayers(),this.light=new Dr(this.stylesheet.light),this.sky=new Yr(this.stylesheet.sky),this.map.setTerrain((It=this.stylesheet.terrain)!==null&&It!==void 0?It:null),this.fire(new it.k("data",{dataType:"style"})),this.fire(new it.k("style.load"))}}_createLayers(){const dt=it.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",dt),this._order=dt.map(xt=>xt.id),this._layers={},this._serializedLayers=null;for(const xt of dt){const At=it.aA(xt);At.setEventedParent(this,{layer:{id:xt.id}}),this._layers[xt.id]=At}}_loadSprite(dt,xt=!1,At=void 0){let It;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(Pt,Bt,Ut,Gt){return it._(this,void 0,void 0,function*(){const Yt=kt(Pt),Kt=Ut>1?"@2x":"",Jt={},sr={};for(const{id:gr,url:vr}of Yt){const Ar=Bt.transformRequest(Vt(vr,Kt,".json"),"SpriteJSON");Jt[gr]=it.h(Ar,Gt);const Er=Bt.transformRequest(Vt(vr,Kt,".png"),"SpriteImage");sr[gr]=Tt.getImage(Er,Gt)}return yield Promise.all([...Object.values(Jt),...Object.values(sr)]),function(gr,vr){return it._(this,void 0,void 0,function*(){const Ar={};for(const Er in gr){Ar[Er]={};const Cr=ot.getImageCanvasContext((yield vr[Er]).data),Rr=(yield gr[Er]).data;for(const Sr in Rr){const{width:Br,height:Gr,x:qr,y:ln,sdf:mn,pixelRatio:Cn,stretchX:On,stretchY:Tn,content:Sn,textFitWidth:Un,textFitHeight:$a}=Rr[Sr];Ar[Er][Sr]={data:null,pixelRatio:Cn,sdf:mn,stretchX:On,stretchY:Tn,content:Sn,textFitWidth:Un,textFitHeight:$a,spriteData:{width:Br,height:Gr,x:qr,y:ln,context:Cr}}}}return Ar})}(Jt,sr)})}(dt,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(Pt=>{if(this._spriteRequest=null,Pt)for(const Bt in Pt){this._spritesImagesIds[Bt]=[];const Ut=this._spritesImagesIds[Bt]?this._spritesImagesIds[Bt].filter(Gt=>!(Gt in Pt)):[];for(const Gt of Ut)this.imageManager.removeImage(Gt),this._changedImages[Gt]=!0;for(const Gt in Pt[Bt]){const Yt=Bt==="default"?Gt:`${Bt}:${Gt}`;this._spritesImagesIds[Bt].push(Yt),Yt in this.imageManager.images?this.imageManager.updateImage(Yt,Pt[Bt][Gt],!1):this.imageManager.addImage(Yt,Pt[Bt][Gt]),xt&&(this._changedImages[Yt]=!0)}}}).catch(Pt=>{this._spriteRequest=null,It=Pt,this.fire(new it.j(It))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),xt&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new it.k("data",{dataType:"style"})),At&&At(It)})}_unloadSprite(){for(const dt of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(dt),this._changedImages[dt]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new it.k("data",{dataType:"style"}))}_validateLayer(dt){const xt=this.sourceCaches[dt.source];if(!xt)return;const At=dt.sourceLayer;if(!At)return;const It=xt.getSource();(It.type==="geojson"||It.vectorLayerIds&&It.vectorLayerIds.indexOf(At)===-1)&&this.fire(new it.j(new Error(`Source layer "${At}" does not exist on source "${It.id}" as specified by style layer "${dt.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const dt in this.sourceCaches)if(!this.sourceCaches[dt].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(dt,xt=!1){const At=this._serializedAllLayers();if(!dt||dt.length===0)return Object.values(xt?it.aB(At):At);const It=[];for(const Pt of dt)if(At[Pt]){const Bt=xt?it.aB(At[Pt]):At[Pt];It.push(Bt)}return It}_serializedAllLayers(){let dt=this._serializedLayers;if(dt)return dt;dt=this._serializedLayers={};const xt=Object.keys(this._layers);for(const At of xt){const It=this._layers[At];It.type!=="custom"&&(dt[At]=It.serialize())}return dt}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const dt in this.sourceCaches)if(this.sourceCaches[dt].hasTransition())return!0;for(const dt in this._layers)if(this._layers[dt].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(dt){if(!this._loaded)return;const xt=this._changed;if(xt){const It=Object.keys(this._updatedLayers),Pt=Object.keys(this._removedLayers);(It.length||Pt.length)&&this._updateWorkerLayers(It,Pt);for(const Bt in this._updatedSources){const Ut=this._updatedSources[Bt];if(Ut==="reload")this._reloadSource(Bt);else{if(Ut!=="clear")throw new Error(`Invalid action ${Ut}`);this._clearSource(Bt)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const Bt in this._updatedPaintProps)this._layers[Bt].updateTransitions(dt);this.light.updateTransitions(dt),this.sky.updateTransitions(dt),this._resetUpdates()}const At={};for(const It in this.sourceCaches){const Pt=this.sourceCaches[It];At[It]=Pt.used,Pt.used=!1}for(const It of this._order){const Pt=this._layers[It];Pt.recalculate(dt,this._availableImages),!Pt.isHidden(dt.zoom)&&Pt.source&&(this.sourceCaches[Pt.source].used=!0)}for(const It in At){const Pt=this.sourceCaches[It];!!At[It]!=!!Pt.used&&Pt.fire(new it.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:It}))}this.light.recalculate(dt),this.sky.recalculate(dt),this.z=dt.zoom,xt&&this.fire(new it.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const dt=Object.keys(this._changedImages);if(dt.length){for(const xt in this.sourceCaches)this.sourceCaches[xt].reloadTilesForDependencies(["icons","patterns"],dt);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const dt in this.sourceCaches)this.sourceCaches[dt].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(dt,xt){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(dt,!1),removedIds:xt})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(dt,xt={}){var At;this._checkLoaded();const It=this.serialize();if(dt=xt.transformStyle?xt.transformStyle(It,dt):dt,((At=xt.validate)===null||At===void 0||At)&&vs(this,it.u(dt)))return!1;(dt=it.aB(dt)).layers=it.az(dt.layers);const Pt=it.aC(It,dt),Bt=this._getOperationsToPerform(Pt);if(Bt.unimplemented.length>0)throw new Error(`Unimplemented: ${Bt.unimplemented.join(", ")}.`);if(Bt.operations.length===0)return!1;for(const Ut of Bt.operations)Ut();return this.stylesheet=dt,this._serializedLayers=null,!0}_getOperationsToPerform(dt){const xt=[],At=[];for(const It of dt)switch(It.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":xt.push(()=>this.addLayer.apply(this,It.args));break;case"removeLayer":xt.push(()=>this.removeLayer.apply(this,It.args));break;case"setPaintProperty":xt.push(()=>this.setPaintProperty.apply(this,It.args));break;case"setLayoutProperty":xt.push(()=>this.setLayoutProperty.apply(this,It.args));break;case"setFilter":xt.push(()=>this.setFilter.apply(this,It.args));break;case"addSource":xt.push(()=>this.addSource.apply(this,It.args));break;case"removeSource":xt.push(()=>this.removeSource.apply(this,It.args));break;case"setLayerZoomRange":xt.push(()=>this.setLayerZoomRange.apply(this,It.args));break;case"setLight":xt.push(()=>this.setLight.apply(this,It.args));break;case"setGeoJSONSourceData":xt.push(()=>this.setGeoJSONSourceData.apply(this,It.args));break;case"setGlyphs":xt.push(()=>this.setGlyphs.apply(this,It.args));break;case"setSprite":xt.push(()=>this.setSprite.apply(this,It.args));break;case"setSky":xt.push(()=>this.setSky.apply(this,It.args));break;case"setTerrain":xt.push(()=>this.map.setTerrain.apply(this,It.args));break;case"setTransition":xt.push(()=>{});break;default:At.push(It.command)}return{operations:xt,unimplemented:At}}addImage(dt,xt){if(this.getImage(dt))return this.fire(new it.j(new Error(`An image named "${dt}" already exists.`)));this.imageManager.addImage(dt,xt),this._afterImageUpdated(dt)}updateImage(dt,xt){this.imageManager.updateImage(dt,xt)}getImage(dt){return this.imageManager.getImage(dt)}removeImage(dt){if(!this.getImage(dt))return this.fire(new it.j(new Error(`An image named "${dt}" does not exist.`)));this.imageManager.removeImage(dt),this._afterImageUpdated(dt)}_afterImageUpdated(dt){this._availableImages=this.imageManager.listImages(),this._changedImages[dt]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new it.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(dt,xt,At={}){if(this._checkLoaded(),this.sourceCaches[dt]!==void 0)throw new Error(`Source "${dt}" already exists.`);if(!xt.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(xt).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(xt.type)>=0&&this._validate(it.u.source,`sources.${dt}`,xt,null,At))return;this.map&&this.map._collectResourceTiming&&(xt.collectResourceTiming=!0);const It=this.sourceCaches[dt]=new Zn(dt,xt,this.dispatcher);It.style=this,It.setEventedParent(this,()=>({isSourceLoaded:It.loaded(),source:It.serialize(),sourceId:dt})),It.onAdd(this.map),this._changed=!0}removeSource(dt){if(this._checkLoaded(),this.sourceCaches[dt]===void 0)throw new Error("There is no source with this ID");for(const At in this._layers)if(this._layers[At].source===dt)return this.fire(new it.j(new Error(`Source "${dt}" cannot be removed while layer "${At}" is using it.`)));const xt=this.sourceCaches[dt];delete this.sourceCaches[dt],delete this._updatedSources[dt],xt.fire(new it.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:dt})),xt.setEventedParent(null),xt.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(dt,xt){if(this._checkLoaded(),this.sourceCaches[dt]===void 0)throw new Error(`There is no source with this ID=${dt}`);const At=this.sourceCaches[dt].getSource();if(At.type!=="geojson")throw new Error(`geojsonSource.type is ${At.type}, which is !== 'geojson`);At.setData(xt),this._changed=!0}getSource(dt){return this.sourceCaches[dt]&&this.sourceCaches[dt].getSource()}addLayer(dt,xt,At={}){this._checkLoaded();const It=dt.id;if(this.getLayer(It))return void this.fire(new it.j(new Error(`Layer "${It}" already exists on this map.`)));let Pt;if(dt.type==="custom"){if(vs(this,it.aD(dt)))return;Pt=it.aA(dt)}else{if("source"in dt&&typeof dt.source=="object"&&(this.addSource(It,dt.source),dt=it.aB(dt),dt=it.e(dt,{source:It})),this._validate(it.u.layer,`layers.${It}`,dt,{arrayIndex:-1},At))return;Pt=it.aA(dt),this._validateLayer(Pt),Pt.setEventedParent(this,{layer:{id:It}})}const Bt=xt?this._order.indexOf(xt):this._order.length;if(xt&&Bt===-1)this.fire(new it.j(new Error(`Cannot add layer "${It}" before non-existing layer "${xt}".`)));else{if(this._order.splice(Bt,0,It),this._layerOrderChanged=!0,this._layers[It]=Pt,this._removedLayers[It]&&Pt.source&&Pt.type!=="custom"){const Ut=this._removedLayers[It];delete this._removedLayers[It],Ut.type!==Pt.type?this._updatedSources[Pt.source]="clear":(this._updatedSources[Pt.source]="reload",this.sourceCaches[Pt.source].pause())}this._updateLayer(Pt),Pt.onAdd&&Pt.onAdd(this.map)}}moveLayer(dt,xt){if(this._checkLoaded(),this._changed=!0,!this._layers[dt])return void this.fire(new it.j(new Error(`The layer '${dt}' does not exist in the map's style and cannot be moved.`)));if(dt===xt)return;const At=this._order.indexOf(dt);this._order.splice(At,1);const It=xt?this._order.indexOf(xt):this._order.length;xt&&It===-1?this.fire(new it.j(new Error(`Cannot move layer "${dt}" before non-existing layer "${xt}".`))):(this._order.splice(It,0,dt),this._layerOrderChanged=!0)}removeLayer(dt){this._checkLoaded();const xt=this._layers[dt];if(!xt)return void this.fire(new it.j(new Error(`Cannot remove non-existing layer "${dt}".`)));xt.setEventedParent(null);const At=this._order.indexOf(dt);this._order.splice(At,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[dt]=xt,delete this._layers[dt],this._serializedLayers&&delete this._serializedLayers[dt],delete this._updatedLayers[dt],delete this._updatedPaintProps[dt],xt.onRemove&&xt.onRemove(this.map)}getLayer(dt){return this._layers[dt]}getLayersOrder(){return[...this._order]}hasLayer(dt){return dt in this._layers}setLayerZoomRange(dt,xt,At){this._checkLoaded();const It=this.getLayer(dt);It?It.minzoom===xt&&It.maxzoom===At||(xt!=null&&(It.minzoom=xt),At!=null&&(It.maxzoom=At),this._updateLayer(It)):this.fire(new it.j(new Error(`Cannot set the zoom range of non-existing layer "${dt}".`)))}setFilter(dt,xt,At={}){this._checkLoaded();const It=this.getLayer(dt);if(It){if(!it.aE(It.filter,xt))return xt==null?(It.filter=void 0,void this._updateLayer(It)):void(this._validate(it.u.filter,`layers.${It.id}.filter`,xt,null,At)||(It.filter=it.aB(xt),this._updateLayer(It)))}else this.fire(new it.j(new Error(`Cannot filter non-existing layer "${dt}".`)))}getFilter(dt){return it.aB(this.getLayer(dt).filter)}setLayoutProperty(dt,xt,At,It={}){this._checkLoaded();const Pt=this.getLayer(dt);Pt?it.aE(Pt.getLayoutProperty(xt),At)||(Pt.setLayoutProperty(xt,At,It),this._updateLayer(Pt)):this.fire(new it.j(new Error(`Cannot style non-existing layer "${dt}".`)))}getLayoutProperty(dt,xt){const At=this.getLayer(dt);if(At)return At.getLayoutProperty(xt);this.fire(new it.j(new Error(`Cannot get style of non-existing layer "${dt}".`)))}setPaintProperty(dt,xt,At,It={}){this._checkLoaded();const Pt=this.getLayer(dt);Pt?it.aE(Pt.getPaintProperty(xt),At)||(Pt.setPaintProperty(xt,At,It)&&this._updateLayer(Pt),this._changed=!0,this._updatedPaintProps[dt]=!0,this._serializedLayers=null):this.fire(new it.j(new Error(`Cannot style non-existing layer "${dt}".`)))}getPaintProperty(dt,xt){return this.getLayer(dt).getPaintProperty(xt)}setFeatureState(dt,xt){this._checkLoaded();const At=dt.source,It=dt.sourceLayer,Pt=this.sourceCaches[At];if(Pt===void 0)return void this.fire(new it.j(new Error(`The source '${At}' does not exist in the map's style.`)));const Bt=Pt.getSource().type;Bt==="geojson"&&It?this.fire(new it.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):Bt!=="vector"||It?(dt.id===void 0&&this.fire(new it.j(new Error("The feature id parameter must be provided."))),Pt.setFeatureState(It,dt.id,xt)):this.fire(new it.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(dt,xt){this._checkLoaded();const At=dt.source,It=this.sourceCaches[At];if(It===void 0)return void this.fire(new it.j(new Error(`The source '${At}' does not exist in the map's style.`)));const Pt=It.getSource().type,Bt=Pt==="vector"?dt.sourceLayer:void 0;Pt!=="vector"||Bt?xt&&typeof dt.id!="string"&&typeof dt.id!="number"?this.fire(new it.j(new Error("A feature id is required to remove its specific state property."))):It.removeFeatureState(Bt,dt.id,xt):this.fire(new it.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(dt){this._checkLoaded();const xt=dt.source,At=dt.sourceLayer,It=this.sourceCaches[xt];if(It!==void 0)return It.getSource().type!=="vector"||At?(dt.id===void 0&&this.fire(new it.j(new Error("The feature id parameter must be provided."))),It.getFeatureState(At,dt.id)):void this.fire(new it.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new it.j(new Error(`The source '${xt}' does not exist in the map's style.`)))}getTransition(){return it.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const dt=it.aF(this.sourceCaches,Pt=>Pt.serialize()),xt=this._serializeByIds(this._order,!0),At=this.map.getTerrain()||void 0,It=this.stylesheet;return it.aG({version:It.version,name:It.name,metadata:It.metadata,light:It.light,sky:It.sky,center:It.center,zoom:It.zoom,bearing:It.bearing,pitch:It.pitch,sprite:It.sprite,glyphs:It.glyphs,transition:It.transition,sources:dt,layers:xt,terrain:At},Pt=>Pt!==void 0)}_updateLayer(dt){this._updatedLayers[dt.id]=!0,dt.source&&!this._updatedSources[dt.source]&&this.sourceCaches[dt.source].getSource().type!=="raster"&&(this._updatedSources[dt.source]="reload",this.sourceCaches[dt.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(dt){const xt=Bt=>this._layers[Bt].type==="fill-extrusion",At={},It=[];for(let Bt=this._order.length-1;Bt>=0;Bt--){const Ut=this._order[Bt];if(xt(Ut)){At[Ut]=Bt;for(const Gt of dt){const Yt=Gt[Ut];if(Yt)for(const Kt of Yt)It.push(Kt)}}}It.sort((Bt,Ut)=>Ut.intersectionZ-Bt.intersectionZ);const Pt=[];for(let Bt=this._order.length-1;Bt>=0;Bt--){const Ut=this._order[Bt];if(xt(Ut))for(let Gt=It.length-1;Gt>=0;Gt--){const Yt=It[Gt].feature;if(At[Yt.layer.id]<Bt)break;Pt.push(Yt),It.pop()}else for(const Gt of dt){const Yt=Gt[Ut];if(Yt)for(const Kt of Yt)Pt.push(Kt.feature)}}return Pt}queryRenderedFeatures(dt,xt,At){xt&&xt.filter&&this._validate(it.u.filter,"queryRenderedFeatures.filter",xt.filter,null,xt);const It={};if(xt&&xt.layers){if(!Array.isArray(xt.layers))return this.fire(new it.j(new Error("parameters.layers must be an Array."))),[];for(const Ut of xt.layers){const Gt=this._layers[Ut];if(!Gt)return this.fire(new it.j(new Error(`The layer '${Ut}' does not exist in the map's style and cannot be queried for features.`))),[];It[Gt.source]=!0}}const Pt=[];xt.availableImages=this._availableImages;const Bt=this._serializedAllLayers();for(const Ut in this.sourceCaches)xt.layers&&!It[Ut]||Pt.push(Bn(this.sourceCaches[Ut],this._layers,Bt,dt,xt,At));return this.placement&&Pt.push(function(Ut,Gt,Yt,Kt,Jt,sr,gr){const vr={},Ar=sr.queryRenderedSymbols(Kt),Er=[];for(const Cr of Object.keys(Ar).map(Number))Er.push(gr[Cr]);Er.sort(Dn);for(const Cr of Er){const Rr=Cr.featureIndex.lookupSymbolFeatures(Ar[Cr.bucketInstanceId],Gt,Cr.bucketIndex,Cr.sourceLayerIndex,Jt.filter,Jt.layers,Jt.availableImages,Ut);for(const Sr in Rr){const Br=vr[Sr]=vr[Sr]||[],Gr=Rr[Sr];Gr.sort((qr,ln)=>{const mn=Cr.featureSortOrder;if(mn){const Cn=mn.indexOf(qr.featureIndex);return mn.indexOf(ln.featureIndex)-Cn}return ln.featureIndex-qr.featureIndex});for(const qr of Gr)Br.push(qr)}}for(const Cr in vr)vr[Cr].forEach(Rr=>{const Sr=Rr.feature,Br=Yt[Ut[Cr].source].getFeatureState(Sr.layer["source-layer"],Sr.id);Sr.source=Sr.layer.source,Sr.layer["source-layer"]&&(Sr.sourceLayer=Sr.layer["source-layer"]),Sr.state=Br});return vr}(this._layers,Bt,this.sourceCaches,dt,xt,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Pt)}querySourceFeatures(dt,xt){xt&&xt.filter&&this._validate(it.u.filter,"querySourceFeatures.filter",xt.filter,null,xt);const At=this.sourceCaches[dt];return At?function(It,Pt){const Bt=It.getRenderableIds().map(Yt=>It.getTileByID(Yt)),Ut=[],Gt={};for(let Yt=0;Yt<Bt.length;Yt++){const Kt=Bt[Yt],Jt=Kt.tileID.canonical.key;Gt[Jt]||(Gt[Jt]=!0,Kt.querySourceFeatures(Ut,Pt))}return Ut}(At,xt):[]}getLight(){return this.light.getLight()}setLight(dt,xt={}){this._checkLoaded();const At=this.light.getLight();let It=!1;for(const Bt in dt)if(!it.aE(dt[Bt],At[Bt])){It=!0;break}if(!It)return;const Pt={now:ot.now(),transition:it.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(dt,xt),this.light.updateTransitions(Pt)}getSky(){var dt;return(dt=this.stylesheet)===null||dt===void 0?void 0:dt.sky}setSky(dt,xt={}){const At=this.getSky();let It=!1;if(!dt&&!At)return;if(dt&&!At)It=!0;else if(!dt&&At)It=!0;else for(const Bt in dt)if(!it.aE(dt[Bt],At[Bt])){It=!0;break}if(!It)return;const Pt={now:ot.now(),transition:it.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=dt,this.sky.setSky(dt,xt),this.sky.updateTransitions(Pt)}_validate(dt,xt,At,It,Pt={}){return(!Pt||Pt.validate!==!1)&&vs(this,dt.call(it.u,it.e({key:xt,style:this.serialize(),value:At,styleSpec:it.v},It)))}_remove(dt=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),us().off(gn,this._rtlPluginLoaded);for(const xt in this._layers)this._layers[xt].setEventedParent(null);for(const xt in this.sourceCaches){const At=this.sourceCaches[xt];At.setEventedParent(null),At.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),dt&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(dt)}_clearSource(dt){this.sourceCaches[dt].clearTiles()}_reloadSource(dt){this.sourceCaches[dt].resume(),this.sourceCaches[dt].reload()}_updateSources(dt){for(const xt in this.sourceCaches)this.sourceCaches[xt].update(dt,this.map.terrain)}_generateCollisionBoxes(){for(const dt in this.sourceCaches)this._reloadSource(dt)}_updatePlacement(dt,xt,At,It,Pt=!1){let Bt=!1,Ut=!1;const Gt={};for(const Yt of this._order){const Kt=this._layers[Yt];if(Kt.type!=="symbol")continue;if(!Gt[Kt.source]){const sr=this.sourceCaches[Kt.source];Gt[Kt.source]=sr.getRenderableIds(!0).map(gr=>sr.getTileByID(gr)).sort((gr,vr)=>vr.tileID.overscaledZ-gr.tileID.overscaledZ||(gr.tileID.isLessThan(vr.tileID)?-1:1))}const Jt=this.crossTileSymbolIndex.addLayer(Kt,Gt[Kt.source],dt.center.lng);Bt=Bt||Jt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((Pt=Pt||this._layerOrderChanged||At===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ot.now(),dt.zoom))&&(this.pauseablePlacement=new Nl(dt,this.map.terrain,this._order,Pt,xt,At,It,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Gt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ot.now()),Ut=!0),Bt&&this.pauseablePlacement.placement.setStale()),Ut||Bt)for(const Yt of this._order){const Kt=this._layers[Yt];Kt.type==="symbol"&&this.placement.updateLayerOpacities(Kt,Gt[Kt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ot.now())}_releaseSymbolFadeTiles(){for(const dt in this.sourceCaches)this.sourceCaches[dt].releaseSymbolFadeTiles()}getImages(dt,xt){return it._(this,void 0,void 0,function*(){const At=yield this.imageManager.getImages(xt.icons);this._updateTilesForChangedImages();const It=this.sourceCaches[xt.source];return It&&It.setDependencies(xt.tileID.key,xt.type,xt.icons),At})}getGlyphs(dt,xt){return it._(this,void 0,void 0,function*(){const At=yield this.glyphManager.getGlyphs(xt.stacks),It=this.sourceCaches[xt.source];return It&&It.setDependencies(xt.tileID.key,xt.type,[""]),At})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(dt,xt={}){this._checkLoaded(),dt&&this._validate(it.u.glyphs,"glyphs",dt,null,xt)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=dt,this.glyphManager.entries={},this.glyphManager.setURL(dt))}addSprite(dt,xt,At={},It){this._checkLoaded();const Pt=[{id:dt,url:xt}],Bt=[...kt(this.stylesheet.sprite),...Pt];this._validate(it.u.sprite,"sprite",Bt,null,At)||(this.stylesheet.sprite=Bt,this._loadSprite(Pt,!0,It))}removeSprite(dt){this._checkLoaded();const xt=kt(this.stylesheet.sprite);if(xt.find(At=>At.id===dt)){if(this._spritesImagesIds[dt])for(const At of this._spritesImagesIds[dt])this.imageManager.removeImage(At),this._changedImages[At]=!0;xt.splice(xt.findIndex(At=>At.id===dt),1),this.stylesheet.sprite=xt.length>0?xt:void 0,delete this._spritesImagesIds[dt],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new it.k("data",{dataType:"style"}))}else this.fire(new it.j(new Error(`Sprite "${dt}" doesn't exists on this map.`)))}getSprite(){return kt(this.stylesheet.sprite)}setSprite(dt,xt={},At){this._checkLoaded(),dt&&this._validate(it.u.sprite,"sprite",dt,null,xt)||(this.stylesheet.sprite=dt,dt?this._loadSprite(dt,!0,At):(this._unloadSprite(),At&&At(null)))}}var Fl=it.Y([{name:"a_pos",type:"Int16",components:2}]);const Sl={prelude:So(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:So(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:So(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:So(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:So("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:So(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:So(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:So("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:So("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:So("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:So(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:So(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:So(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:So(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:So(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:So(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:So(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:So(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:So(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:So(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:So(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:So(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:So(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:So(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:So(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:So(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:So("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:So("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:So("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:So("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function So(Mt,dt){const xt=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,At=dt.match(/attribute ([\w]+) ([\w]+)/g),It=Mt.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Pt=dt.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Bt=Pt?Pt.concat(It):It,Ut={};return{fragmentSource:Mt=Mt.replace(xt,(Gt,Yt,Kt,Jt,sr)=>(Ut[sr]=!0,Yt==="define"?`
#ifndef HAS_UNIFORM_u_${sr}
varying ${Kt} ${Jt} ${sr};
#else
uniform ${Kt} ${Jt} u_${sr};
#endif
`:`
#ifdef HAS_UNIFORM_u_${sr}
    ${Kt} ${Jt} ${sr} = u_${sr};
#endif
`)),vertexSource:dt=dt.replace(xt,(Gt,Yt,Kt,Jt,sr)=>{const gr=Jt==="float"?"vec2":"vec4",vr=sr.match(/color/)?"color":gr;return Ut[sr]?Yt==="define"?`
#ifndef HAS_UNIFORM_u_${sr}
uniform lowp float u_${sr}_t;
attribute ${Kt} ${gr} a_${sr};
varying ${Kt} ${Jt} ${sr};
#else
uniform ${Kt} ${Jt} u_${sr};
#endif
`:vr==="vec4"?`
#ifndef HAS_UNIFORM_u_${sr}
    ${sr} = a_${sr};
#else
    ${Kt} ${Jt} ${sr} = u_${sr};
#endif
`:`
#ifndef HAS_UNIFORM_u_${sr}
    ${sr} = unpack_mix_${vr}(a_${sr}, u_${sr}_t);
#else
    ${Kt} ${Jt} ${sr} = u_${sr};
#endif
`:Yt==="define"?`
#ifndef HAS_UNIFORM_u_${sr}
uniform lowp float u_${sr}_t;
attribute ${Kt} ${gr} a_${sr};
#else
uniform ${Kt} ${Jt} u_${sr};
#endif
`:vr==="vec4"?`
#ifndef HAS_UNIFORM_u_${sr}
    ${Kt} ${Jt} ${sr} = a_${sr};
#else
    ${Kt} ${Jt} ${sr} = u_${sr};
#endif
`:`
#ifndef HAS_UNIFORM_u_${sr}
    ${Kt} ${Jt} ${sr} = unpack_mix_${vr}(a_${sr}, u_${sr}_t);
#else
    ${Kt} ${Jt} ${sr} = u_${sr};
#endif
`}),staticAttributes:At,staticUniforms:Bt}}class eu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt){this.context=dt;let Kt=this.boundPaintVertexBuffers.length!==It.length;for(let Jt=0;!Kt&&Jt<It.length;Jt++)this.boundPaintVertexBuffers[Jt]!==It[Jt]&&(Kt=!0);!this.vao||this.boundProgram!==xt||this.boundLayoutVertexBuffer!==At||Kt||this.boundIndexBuffer!==Pt||this.boundVertexOffset!==Bt||this.boundDynamicVertexBuffer!==Ut||this.boundDynamicVertexBuffer2!==Gt||this.boundDynamicVertexBuffer3!==Yt?this.freshBind(xt,At,It,Pt,Bt,Ut,Gt,Yt):(dt.bindVertexArray.set(this.vao),Ut&&Ut.bind(),Pt&&Pt.dynamicDraw&&Pt.bind(),Gt&&Gt.bind(),Yt&&Yt.bind())}freshBind(dt,xt,At,It,Pt,Bt,Ut,Gt){const Yt=dt.numAttributes,Kt=this.context,Jt=Kt.gl;this.vao&&this.destroy(),this.vao=Kt.createVertexArray(),Kt.bindVertexArray.set(this.vao),this.boundProgram=dt,this.boundLayoutVertexBuffer=xt,this.boundPaintVertexBuffers=At,this.boundIndexBuffer=It,this.boundVertexOffset=Pt,this.boundDynamicVertexBuffer=Bt,this.boundDynamicVertexBuffer2=Ut,this.boundDynamicVertexBuffer3=Gt,xt.enableAttributes(Jt,dt);for(const sr of At)sr.enableAttributes(Jt,dt);Bt&&Bt.enableAttributes(Jt,dt),Ut&&Ut.enableAttributes(Jt,dt),Gt&&Gt.enableAttributes(Jt,dt),xt.bind(),xt.setVertexAttribPointers(Jt,dt,Pt);for(const sr of At)sr.bind(),sr.setVertexAttribPointers(Jt,dt,Pt);Bt&&(Bt.bind(),Bt.setVertexAttribPointers(Jt,dt,Pt)),It&&It.bind(),Ut&&(Ut.bind(),Ut.setVertexAttribPointers(Jt,dt,Pt)),Gt&&(Gt.bind(),Gt.setVertexAttribPointers(Jt,dt,Pt)),Kt.currentNumAttributes=Yt}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lu=(Mt,dt,xt,At,It)=>({u_matrix:Mt,u_texture:0,u_ele_delta:dt,u_fog_matrix:xt,u_fog_color:At?At.properties.get("fog-color"):it.aM.white,u_fog_ground_blend:At?At.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:At?At.calculateFogBlendOpacity(It):0,u_horizon_color:At?At.properties.get("horizon-color"):it.aM.white,u_horizon_fog_blend:At?At.properties.get("horizon-fog-blend"):1});function Wl(Mt){const dt=[];for(let xt=0;xt<Mt.length;xt++){if(Mt[xt]===null)continue;const At=Mt[xt].split(" ");dt.push(At.pop())}return dt}class hu{constructor(dt,xt,At,It,Pt,Bt){const Ut=dt.gl;this.program=Ut.createProgram();const Gt=Wl(xt.staticAttributes),Yt=At?At.getBinderAttributes():[],Kt=Gt.concat(Yt),Jt=Sl.prelude.staticUniforms?Wl(Sl.prelude.staticUniforms):[],sr=xt.staticUniforms?Wl(xt.staticUniforms):[],gr=At?At.getBinderUniforms():[],vr=Jt.concat(sr).concat(gr),Ar=[];for(const qr of vr)Ar.indexOf(qr)<0&&Ar.push(qr);const Er=At?At.defines():[];Pt&&Er.push("#define OVERDRAW_INSPECTOR;"),Bt&&Er.push("#define TERRAIN3D;");const Cr=Er.concat(Sl.prelude.fragmentSource,xt.fragmentSource).join(`
`),Rr=Er.concat(Sl.prelude.vertexSource,xt.vertexSource).join(`
`),Sr=Ut.createShader(Ut.FRAGMENT_SHADER);if(Ut.isContextLost())return void(this.failedToCreate=!0);if(Ut.shaderSource(Sr,Cr),Ut.compileShader(Sr),!Ut.getShaderParameter(Sr,Ut.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Ut.getShaderInfoLog(Sr)}`);Ut.attachShader(this.program,Sr);const Br=Ut.createShader(Ut.VERTEX_SHADER);if(Ut.isContextLost())return void(this.failedToCreate=!0);if(Ut.shaderSource(Br,Rr),Ut.compileShader(Br),!Ut.getShaderParameter(Br,Ut.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Ut.getShaderInfoLog(Br)}`);Ut.attachShader(this.program,Br),this.attributes={};const Gr={};this.numAttributes=Kt.length;for(let qr=0;qr<this.numAttributes;qr++)Kt[qr]&&(Ut.bindAttribLocation(this.program,qr,Kt[qr]),this.attributes[Kt[qr]]=qr);if(Ut.linkProgram(this.program),!Ut.getProgramParameter(this.program,Ut.LINK_STATUS))throw new Error(`Program failed to link: ${Ut.getProgramInfoLog(this.program)}`);Ut.deleteShader(Br),Ut.deleteShader(Sr);for(let qr=0;qr<Ar.length;qr++){const ln=Ar[qr];if(ln&&!Gr[ln]){const mn=Ut.getUniformLocation(this.program,ln);mn&&(Gr[ln]=mn)}}this.fixedUniforms=It(dt,Gr),this.terrainUniforms=((qr,ln)=>({u_depth:new it.aH(qr,ln.u_depth),u_terrain:new it.aH(qr,ln.u_terrain),u_terrain_dim:new it.aI(qr,ln.u_terrain_dim),u_terrain_matrix:new it.aJ(qr,ln.u_terrain_matrix),u_terrain_unpack:new it.aK(qr,ln.u_terrain_unpack),u_terrain_exaggeration:new it.aI(qr,ln.u_terrain_exaggeration)}))(dt,Gr),this.binderUniforms=At?At.getUniforms(dt,Gr):[]}draw(dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr,vr,Ar,Er,Cr,Rr){const Sr=dt.gl;if(this.failedToCreate)return;if(dt.program.set(this.program),dt.setDepthMode(At),dt.setStencilMode(It),dt.setColorMode(Pt),dt.setCullFace(Bt),Gt){dt.activeTexture.set(Sr.TEXTURE2),Sr.bindTexture(Sr.TEXTURE_2D,Gt.depthTexture),dt.activeTexture.set(Sr.TEXTURE3),Sr.bindTexture(Sr.TEXTURE_2D,Gt.texture);for(const Gr in this.terrainUniforms)this.terrainUniforms[Gr].set(Gt[Gr])}for(const Gr in this.fixedUniforms)this.fixedUniforms[Gr].set(Ut[Gr]);Ar&&Ar.setUniforms(dt,this.binderUniforms,gr,{zoom:vr});let Br=0;switch(xt){case Sr.LINES:Br=2;break;case Sr.TRIANGLES:Br=3;break;case Sr.LINE_STRIP:Br=1}for(const Gr of sr.get()){const qr=Gr.vaos||(Gr.vaos={});(qr[Yt]||(qr[Yt]=new eu)).bind(dt,this,Kt,Ar?Ar.getPaintVertexBuffers():[],Jt,Gr.vertexOffset,Er,Cr,Rr),Sr.drawElements(xt,Gr.primitiveLength*Br,Sr.UNSIGNED_SHORT,Gr.primitiveOffset*Br*2)}}}function fu(Mt,dt,xt){const At=1/br(xt,1,dt.transform.tileZoom),It=Math.pow(2,xt.tileID.overscaledZ),Pt=xt.tileSize*Math.pow(2,dt.transform.tileZoom)/It,Bt=Pt*(xt.tileID.canonical.x+xt.tileID.wrap*It),Ut=Pt*xt.tileID.canonical.y;return{u_image:0,u_texsize:xt.imageAtlasTexture.size,u_scale:[At,Mt.fromScale,Mt.toScale],u_fade:Mt.t,u_pixel_coord_upper:[Bt>>16,Ut>>16],u_pixel_coord_lower:[65535&Bt,65535&Ut]}}const lo=(Mt,dt,xt,At)=>{const It=dt.style.light,Pt=It.properties.get("position"),Bt=[Pt.x,Pt.y,Pt.z],Ut=function(){var Yt=new it.A(9);return it.A!=Float32Array&&(Yt[1]=0,Yt[2]=0,Yt[3]=0,Yt[5]=0,Yt[6]=0,Yt[7]=0),Yt[0]=1,Yt[4]=1,Yt[8]=1,Yt}();It.properties.get("anchor")==="viewport"&&function(Yt,Kt){var Jt=Math.sin(Kt),sr=Math.cos(Kt);Yt[0]=sr,Yt[1]=Jt,Yt[2]=0,Yt[3]=-Jt,Yt[4]=sr,Yt[5]=0,Yt[6]=0,Yt[7]=0,Yt[8]=1}(Ut,-dt.transform.angle),function(Yt,Kt,Jt){var sr=Kt[0],gr=Kt[1],vr=Kt[2];Yt[0]=sr*Jt[0]+gr*Jt[3]+vr*Jt[6],Yt[1]=sr*Jt[1]+gr*Jt[4]+vr*Jt[7],Yt[2]=sr*Jt[2]+gr*Jt[5]+vr*Jt[8]}(Bt,Bt,Ut);const Gt=It.properties.get("color");return{u_matrix:Mt,u_lightpos:Bt,u_lightintensity:It.properties.get("intensity"),u_lightcolor:[Gt.r,Gt.g,Gt.b],u_vertical_gradient:+xt,u_opacity:At}},du=(Mt,dt,xt,At,It,Pt,Bt)=>it.e(lo(Mt,dt,xt,At),fu(Pt,dt,Bt),{u_height_factor:-Math.pow(2,It.overscaledZ)/Bt.tileSize/8}),so=Mt=>({u_matrix:Mt}),ho=(Mt,dt,xt,At)=>it.e(so(Mt),fu(xt,dt,At)),cp=(Mt,dt)=>({u_matrix:Mt,u_world:dt}),pu=(Mt,dt,xt,At,It)=>it.e(ho(Mt,dt,xt,At),{u_world:It}),Fp=(Mt,dt,xt,At)=>{const It=Mt.transform;let Pt,Bt;if(At.paint.get("circle-pitch-alignment")==="map"){const Ut=br(xt,1,It.zoom);Pt=!0,Bt=[Ut,Ut]}else Pt=!1,Bt=It.pixelsToGLUnits;return{u_camera_to_center_distance:It.cameraToCenterDistance,u_scale_with_map:+(At.paint.get("circle-pitch-scale")==="map"),u_matrix:Mt.translatePosMatrix(dt.posMatrix,xt,At.paint.get("circle-translate"),At.paint.get("circle-translate-anchor")),u_pitch_with_map:+Pt,u_device_pixel_ratio:Mt.pixelRatio,u_extrude_scale:Bt}},Bl=(Mt,dt,xt)=>({u_matrix:Mt,u_inv_matrix:dt,u_camera_to_center_distance:xt.cameraToCenterDistance,u_viewport_size:[xt.width,xt.height]}),tu=(Mt,dt,xt=1)=>({u_matrix:Mt,u_color:dt,u_overlay:0,u_overlay_scale:xt}),fs=Mt=>({u_matrix:Mt}),ds=(Mt,dt,xt,At)=>({u_matrix:Mt,u_extrude_scale:br(dt,1,xt),u_intensity:At}),gu=(Mt,dt,xt,At)=>{const It=it.H();it.aP(It,0,Mt.width,Mt.height,0,0,1);const Pt=Mt.context.gl;return{u_matrix:It,u_world:[Pt.drawingBufferWidth,Pt.drawingBufferHeight],u_image:xt,u_color_ramp:At,u_opacity:dt.paint.get("heatmap-opacity")}};function mu(Mt,dt){const xt=Math.pow(2,dt.canonical.z),At=dt.canonical.y;return[new it.Z(0,At/xt).toLngLat().lat,new it.Z(0,(At+1)/xt).toLngLat().lat]}const vu=(Mt,dt,xt,At)=>{const It=Mt.transform;return{u_matrix:rr(Mt,dt,xt,At),u_ratio:1/br(dt,1,It.zoom),u_device_pixel_ratio:Mt.pixelRatio,u_units_to_pixels:[1/It.pixelsToGLUnits[0],1/It.pixelsToGLUnits[1]]}},hp=(Mt,dt,xt,At,It)=>it.e(vu(Mt,dt,xt,It),{u_image:0,u_image_height:At}),Yl=(Mt,dt,xt,At,It)=>{const Pt=Mt.transform,Bt=fp(dt,Pt);return{u_matrix:rr(Mt,dt,xt,It),u_texsize:dt.imageAtlasTexture.size,u_ratio:1/br(dt,1,Pt.zoom),u_device_pixel_ratio:Mt.pixelRatio,u_image:0,u_scale:[Bt,At.fromScale,At.toScale],u_fade:At.t,u_units_to_pixels:[1/Pt.pixelsToGLUnits[0],1/Pt.pixelsToGLUnits[1]]}},Bp=(Mt,dt,xt,At,It,Pt)=>{const Bt=Mt.lineAtlas,Ut=fp(dt,Mt.transform),Gt=xt.layout.get("line-cap")==="round",Yt=Bt.getDash(At.from,Gt),Kt=Bt.getDash(At.to,Gt),Jt=Yt.width*It.fromScale,sr=Kt.width*It.toScale;return it.e(vu(Mt,dt,xt,Pt),{u_patternscale_a:[Ut/Jt,-Yt.height/2],u_patternscale_b:[Ut/sr,-Kt.height/2],u_sdfgamma:Bt.width/(256*Math.min(Jt,sr)*Mt.pixelRatio)/2,u_image:0,u_tex_y_a:Yt.y,u_tex_y_b:Kt.y,u_mix:It.t})};function fp(Mt,dt){return 1/br(Mt,1,dt.tileZoom)}function rr(Mt,dt,xt,At){return Mt.translatePosMatrix(At?At.posMatrix:dt.tileID.posMatrix,dt,xt.paint.get("line-translate"),xt.paint.get("line-translate-anchor"))}const hr=(Mt,dt,xt,At,It)=>{return{u_matrix:Mt,u_tl_parent:dt,u_scale_parent:xt,u_buffer_scale:1,u_fade_t:At.mix,u_opacity:At.opacity*It.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:It.paint.get("raster-brightness-min"),u_brightness_high:It.paint.get("raster-brightness-max"),u_saturation_factor:(Bt=It.paint.get("raster-saturation"),Bt>0?1-1/(1.001-Bt):-Bt),u_contrast_factor:(Pt=It.paint.get("raster-contrast"),Pt>0?1/(1-Pt):1+Pt),u_spin_weights:xr(It.paint.get("raster-hue-rotate"))};var Pt,Bt};function xr(Mt){Mt*=Math.PI/180;const dt=Math.sin(Mt),xt=Math.cos(Mt);return[(2*xt+1)/3,(-Math.sqrt(3)*dt-xt+1)/3,(Math.sqrt(3)*dt-xt+1)/3]}const Or=(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr)=>{const vr=Bt.transform;return{u_is_size_zoom_constant:+(Mt==="constant"||Mt==="source"),u_is_size_feature_constant:+(Mt==="constant"||Mt==="camera"),u_size_t:dt?dt.uSizeT:0,u_size:dt?dt.uSize:0,u_camera_to_center_distance:vr.cameraToCenterDistance,u_pitch:vr.pitch/360*2*Math.PI,u_rotate_symbol:+xt,u_aspect_ratio:vr.width/vr.height,u_fade_change:Bt.options.fadeDuration?Bt.symbolFadeChange:1,u_matrix:Ut,u_label_plane_matrix:Gt,u_coord_matrix:Yt,u_is_text:+Jt,u_pitch_with_map:+At,u_is_along_line:It,u_is_variable_anchor:Pt,u_texsize:sr,u_texture:0,u_translation:Kt,u_pitched_scale:gr}},Zr=(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr,vr)=>{const Ar=Bt.transform;return it.e(Or(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,vr),{u_gamma_scale:At?Math.cos(Ar._pitch)*Ar.cameraToCenterDistance:1,u_device_pixel_ratio:Bt.pixelRatio,u_is_halo:1})},rn=(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr)=>it.e(Zr(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,!0,Jt,!0,gr),{u_texsize_icon:sr,u_texture_icon:1}),wn=(Mt,dt,xt)=>({u_matrix:Mt,u_opacity:dt,u_color:xt}),Xn=(Mt,dt,xt,At,It,Pt)=>it.e(function(Bt,Ut,Gt,Yt){const Kt=Gt.imageManager.getPattern(Bt.from.toString()),Jt=Gt.imageManager.getPattern(Bt.to.toString()),{width:sr,height:gr}=Gt.imageManager.getPixelSize(),vr=Math.pow(2,Yt.tileID.overscaledZ),Ar=Yt.tileSize*Math.pow(2,Gt.transform.tileZoom)/vr,Er=Ar*(Yt.tileID.canonical.x+Yt.tileID.wrap*vr),Cr=Ar*Yt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Kt.tl,u_pattern_br_a:Kt.br,u_pattern_tl_b:Jt.tl,u_pattern_br_b:Jt.br,u_texsize:[sr,gr],u_mix:Ut.t,u_pattern_size_a:Kt.displaySize,u_pattern_size_b:Jt.displaySize,u_scale_a:Ut.fromScale,u_scale_b:Ut.toScale,u_tile_units_to_pixels:1/br(Yt,1,Gt.transform.tileZoom),u_pixel_coord_upper:[Er>>16,Cr>>16],u_pixel_coord_lower:[65535&Er,65535&Cr]}}(At,Pt,xt,It),{u_matrix:Mt,u_opacity:dt}),fo={fillExtrusion:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_lightpos:new it.aN(Mt,dt.u_lightpos),u_lightintensity:new it.aI(Mt,dt.u_lightintensity),u_lightcolor:new it.aN(Mt,dt.u_lightcolor),u_vertical_gradient:new it.aI(Mt,dt.u_vertical_gradient),u_opacity:new it.aI(Mt,dt.u_opacity)}),fillExtrusionPattern:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_lightpos:new it.aN(Mt,dt.u_lightpos),u_lightintensity:new it.aI(Mt,dt.u_lightintensity),u_lightcolor:new it.aN(Mt,dt.u_lightcolor),u_vertical_gradient:new it.aI(Mt,dt.u_vertical_gradient),u_height_factor:new it.aI(Mt,dt.u_height_factor),u_image:new it.aH(Mt,dt.u_image),u_texsize:new it.aO(Mt,dt.u_texsize),u_pixel_coord_upper:new it.aO(Mt,dt.u_pixel_coord_upper),u_pixel_coord_lower:new it.aO(Mt,dt.u_pixel_coord_lower),u_scale:new it.aN(Mt,dt.u_scale),u_fade:new it.aI(Mt,dt.u_fade),u_opacity:new it.aI(Mt,dt.u_opacity)}),fill:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix)}),fillPattern:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_image:new it.aH(Mt,dt.u_image),u_texsize:new it.aO(Mt,dt.u_texsize),u_pixel_coord_upper:new it.aO(Mt,dt.u_pixel_coord_upper),u_pixel_coord_lower:new it.aO(Mt,dt.u_pixel_coord_lower),u_scale:new it.aN(Mt,dt.u_scale),u_fade:new it.aI(Mt,dt.u_fade)}),fillOutline:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_world:new it.aO(Mt,dt.u_world)}),fillOutlinePattern:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_world:new it.aO(Mt,dt.u_world),u_image:new it.aH(Mt,dt.u_image),u_texsize:new it.aO(Mt,dt.u_texsize),u_pixel_coord_upper:new it.aO(Mt,dt.u_pixel_coord_upper),u_pixel_coord_lower:new it.aO(Mt,dt.u_pixel_coord_lower),u_scale:new it.aN(Mt,dt.u_scale),u_fade:new it.aI(Mt,dt.u_fade)}),circle:(Mt,dt)=>({u_camera_to_center_distance:new it.aI(Mt,dt.u_camera_to_center_distance),u_scale_with_map:new it.aH(Mt,dt.u_scale_with_map),u_pitch_with_map:new it.aH(Mt,dt.u_pitch_with_map),u_extrude_scale:new it.aO(Mt,dt.u_extrude_scale),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_matrix:new it.aJ(Mt,dt.u_matrix)}),collisionBox:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_pixel_extrude_scale:new it.aO(Mt,dt.u_pixel_extrude_scale)}),collisionCircle:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_inv_matrix:new it.aJ(Mt,dt.u_inv_matrix),u_camera_to_center_distance:new it.aI(Mt,dt.u_camera_to_center_distance),u_viewport_size:new it.aO(Mt,dt.u_viewport_size)}),debug:(Mt,dt)=>({u_color:new it.aL(Mt,dt.u_color),u_matrix:new it.aJ(Mt,dt.u_matrix),u_overlay:new it.aH(Mt,dt.u_overlay),u_overlay_scale:new it.aI(Mt,dt.u_overlay_scale)}),clippingMask:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix)}),heatmap:(Mt,dt)=>({u_extrude_scale:new it.aI(Mt,dt.u_extrude_scale),u_intensity:new it.aI(Mt,dt.u_intensity),u_matrix:new it.aJ(Mt,dt.u_matrix)}),heatmapTexture:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_world:new it.aO(Mt,dt.u_world),u_image:new it.aH(Mt,dt.u_image),u_color_ramp:new it.aH(Mt,dt.u_color_ramp),u_opacity:new it.aI(Mt,dt.u_opacity)}),hillshade:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_image:new it.aH(Mt,dt.u_image),u_latrange:new it.aO(Mt,dt.u_latrange),u_light:new it.aO(Mt,dt.u_light),u_shadow:new it.aL(Mt,dt.u_shadow),u_highlight:new it.aL(Mt,dt.u_highlight),u_accent:new it.aL(Mt,dt.u_accent)}),hillshadePrepare:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_image:new it.aH(Mt,dt.u_image),u_dimension:new it.aO(Mt,dt.u_dimension),u_zoom:new it.aI(Mt,dt.u_zoom),u_unpack:new it.aK(Mt,dt.u_unpack)}),line:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_ratio:new it.aI(Mt,dt.u_ratio),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_units_to_pixels:new it.aO(Mt,dt.u_units_to_pixels)}),lineGradient:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_ratio:new it.aI(Mt,dt.u_ratio),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_units_to_pixels:new it.aO(Mt,dt.u_units_to_pixels),u_image:new it.aH(Mt,dt.u_image),u_image_height:new it.aI(Mt,dt.u_image_height)}),linePattern:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_texsize:new it.aO(Mt,dt.u_texsize),u_ratio:new it.aI(Mt,dt.u_ratio),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_image:new it.aH(Mt,dt.u_image),u_units_to_pixels:new it.aO(Mt,dt.u_units_to_pixels),u_scale:new it.aN(Mt,dt.u_scale),u_fade:new it.aI(Mt,dt.u_fade)}),lineSDF:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_ratio:new it.aI(Mt,dt.u_ratio),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_units_to_pixels:new it.aO(Mt,dt.u_units_to_pixels),u_patternscale_a:new it.aO(Mt,dt.u_patternscale_a),u_patternscale_b:new it.aO(Mt,dt.u_patternscale_b),u_sdfgamma:new it.aI(Mt,dt.u_sdfgamma),u_image:new it.aH(Mt,dt.u_image),u_tex_y_a:new it.aI(Mt,dt.u_tex_y_a),u_tex_y_b:new it.aI(Mt,dt.u_tex_y_b),u_mix:new it.aI(Mt,dt.u_mix)}),raster:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_tl_parent:new it.aO(Mt,dt.u_tl_parent),u_scale_parent:new it.aI(Mt,dt.u_scale_parent),u_buffer_scale:new it.aI(Mt,dt.u_buffer_scale),u_fade_t:new it.aI(Mt,dt.u_fade_t),u_opacity:new it.aI(Mt,dt.u_opacity),u_image0:new it.aH(Mt,dt.u_image0),u_image1:new it.aH(Mt,dt.u_image1),u_brightness_low:new it.aI(Mt,dt.u_brightness_low),u_brightness_high:new it.aI(Mt,dt.u_brightness_high),u_saturation_factor:new it.aI(Mt,dt.u_saturation_factor),u_contrast_factor:new it.aI(Mt,dt.u_contrast_factor),u_spin_weights:new it.aN(Mt,dt.u_spin_weights)}),symbolIcon:(Mt,dt)=>({u_is_size_zoom_constant:new it.aH(Mt,dt.u_is_size_zoom_constant),u_is_size_feature_constant:new it.aH(Mt,dt.u_is_size_feature_constant),u_size_t:new it.aI(Mt,dt.u_size_t),u_size:new it.aI(Mt,dt.u_size),u_camera_to_center_distance:new it.aI(Mt,dt.u_camera_to_center_distance),u_pitch:new it.aI(Mt,dt.u_pitch),u_rotate_symbol:new it.aH(Mt,dt.u_rotate_symbol),u_aspect_ratio:new it.aI(Mt,dt.u_aspect_ratio),u_fade_change:new it.aI(Mt,dt.u_fade_change),u_matrix:new it.aJ(Mt,dt.u_matrix),u_label_plane_matrix:new it.aJ(Mt,dt.u_label_plane_matrix),u_coord_matrix:new it.aJ(Mt,dt.u_coord_matrix),u_is_text:new it.aH(Mt,dt.u_is_text),u_pitch_with_map:new it.aH(Mt,dt.u_pitch_with_map),u_is_along_line:new it.aH(Mt,dt.u_is_along_line),u_is_variable_anchor:new it.aH(Mt,dt.u_is_variable_anchor),u_texsize:new it.aO(Mt,dt.u_texsize),u_texture:new it.aH(Mt,dt.u_texture),u_translation:new it.aO(Mt,dt.u_translation),u_pitched_scale:new it.aI(Mt,dt.u_pitched_scale)}),symbolSDF:(Mt,dt)=>({u_is_size_zoom_constant:new it.aH(Mt,dt.u_is_size_zoom_constant),u_is_size_feature_constant:new it.aH(Mt,dt.u_is_size_feature_constant),u_size_t:new it.aI(Mt,dt.u_size_t),u_size:new it.aI(Mt,dt.u_size),u_camera_to_center_distance:new it.aI(Mt,dt.u_camera_to_center_distance),u_pitch:new it.aI(Mt,dt.u_pitch),u_rotate_symbol:new it.aH(Mt,dt.u_rotate_symbol),u_aspect_ratio:new it.aI(Mt,dt.u_aspect_ratio),u_fade_change:new it.aI(Mt,dt.u_fade_change),u_matrix:new it.aJ(Mt,dt.u_matrix),u_label_plane_matrix:new it.aJ(Mt,dt.u_label_plane_matrix),u_coord_matrix:new it.aJ(Mt,dt.u_coord_matrix),u_is_text:new it.aH(Mt,dt.u_is_text),u_pitch_with_map:new it.aH(Mt,dt.u_pitch_with_map),u_is_along_line:new it.aH(Mt,dt.u_is_along_line),u_is_variable_anchor:new it.aH(Mt,dt.u_is_variable_anchor),u_texsize:new it.aO(Mt,dt.u_texsize),u_texture:new it.aH(Mt,dt.u_texture),u_gamma_scale:new it.aI(Mt,dt.u_gamma_scale),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_is_halo:new it.aH(Mt,dt.u_is_halo),u_translation:new it.aO(Mt,dt.u_translation),u_pitched_scale:new it.aI(Mt,dt.u_pitched_scale)}),symbolTextAndIcon:(Mt,dt)=>({u_is_size_zoom_constant:new it.aH(Mt,dt.u_is_size_zoom_constant),u_is_size_feature_constant:new it.aH(Mt,dt.u_is_size_feature_constant),u_size_t:new it.aI(Mt,dt.u_size_t),u_size:new it.aI(Mt,dt.u_size),u_camera_to_center_distance:new it.aI(Mt,dt.u_camera_to_center_distance),u_pitch:new it.aI(Mt,dt.u_pitch),u_rotate_symbol:new it.aH(Mt,dt.u_rotate_symbol),u_aspect_ratio:new it.aI(Mt,dt.u_aspect_ratio),u_fade_change:new it.aI(Mt,dt.u_fade_change),u_matrix:new it.aJ(Mt,dt.u_matrix),u_label_plane_matrix:new it.aJ(Mt,dt.u_label_plane_matrix),u_coord_matrix:new it.aJ(Mt,dt.u_coord_matrix),u_is_text:new it.aH(Mt,dt.u_is_text),u_pitch_with_map:new it.aH(Mt,dt.u_pitch_with_map),u_is_along_line:new it.aH(Mt,dt.u_is_along_line),u_is_variable_anchor:new it.aH(Mt,dt.u_is_variable_anchor),u_texsize:new it.aO(Mt,dt.u_texsize),u_texsize_icon:new it.aO(Mt,dt.u_texsize_icon),u_texture:new it.aH(Mt,dt.u_texture),u_texture_icon:new it.aH(Mt,dt.u_texture_icon),u_gamma_scale:new it.aI(Mt,dt.u_gamma_scale),u_device_pixel_ratio:new it.aI(Mt,dt.u_device_pixel_ratio),u_is_halo:new it.aH(Mt,dt.u_is_halo),u_translation:new it.aO(Mt,dt.u_translation),u_pitched_scale:new it.aI(Mt,dt.u_pitched_scale)}),background:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_opacity:new it.aI(Mt,dt.u_opacity),u_color:new it.aL(Mt,dt.u_color)}),backgroundPattern:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_opacity:new it.aI(Mt,dt.u_opacity),u_image:new it.aH(Mt,dt.u_image),u_pattern_tl_a:new it.aO(Mt,dt.u_pattern_tl_a),u_pattern_br_a:new it.aO(Mt,dt.u_pattern_br_a),u_pattern_tl_b:new it.aO(Mt,dt.u_pattern_tl_b),u_pattern_br_b:new it.aO(Mt,dt.u_pattern_br_b),u_texsize:new it.aO(Mt,dt.u_texsize),u_mix:new it.aI(Mt,dt.u_mix),u_pattern_size_a:new it.aO(Mt,dt.u_pattern_size_a),u_pattern_size_b:new it.aO(Mt,dt.u_pattern_size_b),u_scale_a:new it.aI(Mt,dt.u_scale_a),u_scale_b:new it.aI(Mt,dt.u_scale_b),u_pixel_coord_upper:new it.aO(Mt,dt.u_pixel_coord_upper),u_pixel_coord_lower:new it.aO(Mt,dt.u_pixel_coord_lower),u_tile_units_to_pixels:new it.aI(Mt,dt.u_tile_units_to_pixels)}),terrain:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_texture:new it.aH(Mt,dt.u_texture),u_ele_delta:new it.aI(Mt,dt.u_ele_delta),u_fog_matrix:new it.aJ(Mt,dt.u_fog_matrix),u_fog_color:new it.aL(Mt,dt.u_fog_color),u_fog_ground_blend:new it.aI(Mt,dt.u_fog_ground_blend),u_fog_ground_blend_opacity:new it.aI(Mt,dt.u_fog_ground_blend_opacity),u_horizon_color:new it.aL(Mt,dt.u_horizon_color),u_horizon_fog_blend:new it.aI(Mt,dt.u_horizon_fog_blend)}),terrainDepth:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_ele_delta:new it.aI(Mt,dt.u_ele_delta)}),terrainCoords:(Mt,dt)=>({u_matrix:new it.aJ(Mt,dt.u_matrix),u_texture:new it.aH(Mt,dt.u_texture),u_terrain_coords_id:new it.aI(Mt,dt.u_terrain_coords_id),u_ele_delta:new it.aI(Mt,dt.u_ele_delta)}),sky:(Mt,dt)=>({u_sky_color:new it.aL(Mt,dt.u_sky_color),u_horizon_color:new it.aL(Mt,dt.u_horizon_color),u_horizon:new it.aI(Mt,dt.u_horizon),u_sky_horizon_blend:new it.aI(Mt,dt.u_sky_horizon_blend)})};class io{constructor(dt,xt,At){this.context=dt;const It=dt.gl;this.buffer=It.createBuffer(),this.dynamicDraw=!!At,this.context.unbindVAO(),dt.bindElementBuffer.set(this.buffer),It.bufferData(It.ELEMENT_ARRAY_BUFFER,xt.arrayBuffer,this.dynamicDraw?It.DYNAMIC_DRAW:It.STATIC_DRAW),this.dynamicDraw||delete xt.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(dt){const xt=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),xt.bufferSubData(xt.ELEMENT_ARRAY_BUFFER,0,dt.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Go={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Os{constructor(dt,xt,At,It){this.length=xt.length,this.attributes=At,this.itemSize=xt.bytesPerElement,this.dynamicDraw=It,this.context=dt;const Pt=dt.gl;this.buffer=Pt.createBuffer(),dt.bindVertexBuffer.set(this.buffer),Pt.bufferData(Pt.ARRAY_BUFFER,xt.arrayBuffer,this.dynamicDraw?Pt.DYNAMIC_DRAW:Pt.STATIC_DRAW),this.dynamicDraw||delete xt.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(dt){if(dt.length!==this.length)throw new Error(`Length of new data is ${dt.length}, which doesn't match current length of ${this.length}`);const xt=this.context.gl;this.bind(),xt.bufferSubData(xt.ARRAY_BUFFER,0,dt.arrayBuffer)}enableAttributes(dt,xt){for(let At=0;At<this.attributes.length;At++){const It=xt.attributes[this.attributes[At].name];It!==void 0&&dt.enableVertexAttribArray(It)}}setVertexAttribPointers(dt,xt,At){for(let It=0;It<this.attributes.length;It++){const Pt=this.attributes[It],Bt=xt.attributes[Pt.name];Bt!==void 0&&dt.vertexAttribPointer(Bt,Pt.components,dt[Go[Pt.type]],!1,this.itemSize,Pt.offset+this.itemSize*(At||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qo=new WeakMap;function tn(Mt){var dt;if(Qo.has(Mt))return Qo.get(Mt);{const xt=(dt=Mt.getParameter(Mt.VERSION))===null||dt===void 0?void 0:dt.startsWith("WebGL 2.0");return Qo.set(Mt,xt),xt}}class Gn{constructor(dt){this.gl=dt.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(dt){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ro extends Gn{getDefault(){return it.aM.transparent}set(dt){const xt=this.current;(dt.r!==xt.r||dt.g!==xt.g||dt.b!==xt.b||dt.a!==xt.a||this.dirty)&&(this.gl.clearColor(dt.r,dt.g,dt.b,dt.a),this.current=dt,this.dirty=!1)}}class Tl extends Gn{getDefault(){return 1}set(dt){(dt!==this.current||this.dirty)&&(this.gl.clearDepth(dt),this.current=dt,this.dirty=!1)}}class Us extends Gn{getDefault(){return 0}set(dt){(dt!==this.current||this.dirty)&&(this.gl.clearStencil(dt),this.current=dt,this.dirty=!1)}}class $y extends Gn{getDefault(){return[!0,!0,!0,!0]}set(dt){const xt=this.current;(dt[0]!==xt[0]||dt[1]!==xt[1]||dt[2]!==xt[2]||dt[3]!==xt[3]||this.dirty)&&(this.gl.colorMask(dt[0],dt[1],dt[2],dt[3]),this.current=dt,this.dirty=!1)}}class Fv extends Gn{getDefault(){return!0}set(dt){(dt!==this.current||this.dirty)&&(this.gl.depthMask(dt),this.current=dt,this.dirty=!1)}}class ky extends Gn{getDefault(){return 255}set(dt){(dt!==this.current||this.dirty)&&(this.gl.stencilMask(dt),this.current=dt,this.dirty=!1)}}class Bv extends Gn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(dt){const xt=this.current;(dt.func!==xt.func||dt.ref!==xt.ref||dt.mask!==xt.mask||this.dirty)&&(this.gl.stencilFunc(dt.func,dt.ref,dt.mask),this.current=dt,this.dirty=!1)}}class Mm extends Gn{getDefault(){const dt=this.gl;return[dt.KEEP,dt.KEEP,dt.KEEP]}set(dt){const xt=this.current;(dt[0]!==xt[0]||dt[1]!==xt[1]||dt[2]!==xt[2]||this.dirty)&&(this.gl.stencilOp(dt[0],dt[1],dt[2]),this.current=dt,this.dirty=!1)}}class zv extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;dt?xt.enable(xt.STENCIL_TEST):xt.disable(xt.STENCIL_TEST),this.current=dt,this.dirty=!1}}class Vv extends Gn{getDefault(){return[0,1]}set(dt){const xt=this.current;(dt[0]!==xt[0]||dt[1]!==xt[1]||this.dirty)&&(this.gl.depthRange(dt[0],dt[1]),this.current=dt,this.dirty=!1)}}class Uv extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;dt?xt.enable(xt.DEPTH_TEST):xt.disable(xt.DEPTH_TEST),this.current=dt,this.dirty=!1}}class Gv extends Gn{getDefault(){return this.gl.LESS}set(dt){(dt!==this.current||this.dirty)&&(this.gl.depthFunc(dt),this.current=dt,this.dirty=!1)}}class yu extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;dt?xt.enable(xt.BLEND):xt.disable(xt.BLEND),this.current=dt,this.dirty=!1}}class jv extends Gn{getDefault(){const dt=this.gl;return[dt.ONE,dt.ZERO]}set(dt){const xt=this.current;(dt[0]!==xt[0]||dt[1]!==xt[1]||this.dirty)&&(this.gl.blendFunc(dt[0],dt[1]),this.current=dt,this.dirty=!1)}}class Ny extends Gn{getDefault(){return it.aM.transparent}set(dt){const xt=this.current;(dt.r!==xt.r||dt.g!==xt.g||dt.b!==xt.b||dt.a!==xt.a||this.dirty)&&(this.gl.blendColor(dt.r,dt.g,dt.b,dt.a),this.current=dt,this.dirty=!1)}}class Hv extends Gn{getDefault(){return this.gl.FUNC_ADD}set(dt){(dt!==this.current||this.dirty)&&(this.gl.blendEquation(dt),this.current=dt,this.dirty=!1)}}class dp extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;dt?xt.enable(xt.CULL_FACE):xt.disable(xt.CULL_FACE),this.current=dt,this.dirty=!1}}class Fy extends Gn{getDefault(){return this.gl.BACK}set(dt){(dt!==this.current||this.dirty)&&(this.gl.cullFace(dt),this.current=dt,this.dirty=!1)}}class zp extends Gn{getDefault(){return this.gl.CCW}set(dt){(dt!==this.current||this.dirty)&&(this.gl.frontFace(dt),this.current=dt,this.dirty=!1)}}class By extends Gn{getDefault(){return null}set(dt){(dt!==this.current||this.dirty)&&(this.gl.useProgram(dt),this.current=dt,this.dirty=!1)}}class zy extends Gn{getDefault(){return this.gl.TEXTURE0}set(dt){(dt!==this.current||this.dirty)&&(this.gl.activeTexture(dt),this.current=dt,this.dirty=!1)}}class Wv extends Gn{getDefault(){const dt=this.gl;return[0,0,dt.drawingBufferWidth,dt.drawingBufferHeight]}set(dt){const xt=this.current;(dt[0]!==xt[0]||dt[1]!==xt[1]||dt[2]!==xt[2]||dt[3]!==xt[3]||this.dirty)&&(this.gl.viewport(dt[0],dt[1],dt[2],dt[3]),this.current=dt,this.dirty=!1)}}class Yv extends Gn{getDefault(){return null}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.bindFramebuffer(xt.FRAMEBUFFER,dt),this.current=dt,this.dirty=!1}}class qv extends Gn{getDefault(){return null}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.bindRenderbuffer(xt.RENDERBUFFER,dt),this.current=dt,this.dirty=!1}}class Rm extends Gn{getDefault(){return null}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.bindTexture(xt.TEXTURE_2D,dt),this.current=dt,this.dirty=!1}}class Zv extends Gn{getDefault(){return null}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.bindBuffer(xt.ARRAY_BUFFER,dt),this.current=dt,this.dirty=!1}}class Vp extends Gn{getDefault(){return null}set(dt){const xt=this.gl;xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,dt),this.current=dt,this.dirty=!1}}class Zl extends Gn{getDefault(){return null}set(dt){var xt;if(dt===this.current&&!this.dirty)return;const At=this.gl;tn(At)?At.bindVertexArray(dt):(xt=At.getExtension("OES_vertex_array_object"))===null||xt===void 0||xt.bindVertexArrayOES(dt),this.current=dt,this.dirty=!1}}class Lm extends Gn{getDefault(){return 4}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.pixelStorei(xt.UNPACK_ALIGNMENT,dt),this.current=dt,this.dirty=!1}}class Om extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.pixelStorei(xt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,dt),this.current=dt,this.dirty=!1}}class $m extends Gn{getDefault(){return!1}set(dt){if(dt===this.current&&!this.dirty)return;const xt=this.gl;xt.pixelStorei(xt.UNPACK_FLIP_Y_WEBGL,dt),this.current=dt,this.dirty=!1}}class Up extends Gn{constructor(dt,xt){super(dt),this.context=dt,this.parent=xt}getDefault(){return null}}class km extends Up{setDirty(){this.dirty=!0}set(dt){if(dt===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const xt=this.gl;xt.framebufferTexture2D(xt.FRAMEBUFFER,xt.COLOR_ATTACHMENT0,xt.TEXTURE_2D,dt,0),this.current=dt,this.dirty=!1}}class bu extends Up{set(dt){if(dt===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const xt=this.gl;xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_ATTACHMENT,xt.RENDERBUFFER,dt),this.current=dt,this.dirty=!1}}class Nm extends Up{set(dt){if(dt===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const xt=this.gl;xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_STENCIL_ATTACHMENT,xt.RENDERBUFFER,dt),this.current=dt,this.dirty=!1}}class Vy{constructor(dt,xt,At,It,Pt){this.context=dt,this.width=xt,this.height=At;const Bt=dt.gl,Ut=this.framebuffer=Bt.createFramebuffer();if(this.colorAttachment=new km(dt,Ut),It)this.depthAttachment=Pt?new Nm(dt,Ut):new bu(dt,Ut);else if(Pt)throw new Error("Stencil cannot be set without depth");if(Bt.checkFramebufferStatus(Bt.FRAMEBUFFER)!==Bt.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const dt=this.context.gl,xt=this.colorAttachment.get();if(xt&&dt.deleteTexture(xt),this.depthAttachment){const At=this.depthAttachment.get();At&&dt.deleteRenderbuffer(At)}dt.deleteFramebuffer(this.framebuffer)}}class qo{constructor(dt,xt,At){this.blendFunction=dt,this.blendColor=xt,this.mask=At}}qo.Replace=[1,0],qo.disabled=new qo(qo.Replace,it.aM.transparent,[!1,!1,!1,!1]),qo.unblended=new qo(qo.Replace,it.aM.transparent,[!0,!0,!0,!0]),qo.alphaBlended=new qo([1,771],it.aM.transparent,[!0,!0,!0,!0]);class Uy{constructor(dt){var xt,At;if(this.gl=dt,this.clearColor=new Ro(this),this.clearDepth=new Tl(this),this.clearStencil=new Us(this),this.colorMask=new $y(this),this.depthMask=new Fv(this),this.stencilMask=new ky(this),this.stencilFunc=new Bv(this),this.stencilOp=new Mm(this),this.stencilTest=new zv(this),this.depthRange=new Vv(this),this.depthTest=new Uv(this),this.depthFunc=new Gv(this),this.blend=new yu(this),this.blendFunc=new jv(this),this.blendColor=new Ny(this),this.blendEquation=new Hv(this),this.cullFace=new dp(this),this.cullFaceSide=new Fy(this),this.frontFace=new zp(this),this.program=new By(this),this.activeTexture=new zy(this),this.viewport=new Wv(this),this.bindFramebuffer=new Yv(this),this.bindRenderbuffer=new qv(this),this.bindTexture=new Rm(this),this.bindVertexBuffer=new Zv(this),this.bindElementBuffer=new Vp(this),this.bindVertexArray=new Zl(this),this.pixelStoreUnpack=new Lm(this),this.pixelStoreUnpackPremultiplyAlpha=new Om(this),this.pixelStoreUnpackFlipY=new $m(this),this.extTextureFilterAnisotropic=dt.getExtension("EXT_texture_filter_anisotropic")||dt.getExtension("MOZ_EXT_texture_filter_anisotropic")||dt.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=dt.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=dt.getParameter(dt.MAX_TEXTURE_SIZE),tn(dt)){this.HALF_FLOAT=dt.HALF_FLOAT;const It=dt.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(xt=dt.RGBA16F)!==null&&xt!==void 0?xt:It?.RGBA16F_EXT,this.RGB16F=(At=dt.RGB16F)!==null&&At!==void 0?At:It?.RGB16F_EXT,dt.getExtension("EXT_color_buffer_float")}else{dt.getExtension("EXT_color_buffer_half_float"),dt.getExtension("OES_texture_half_float_linear");const It=dt.getExtension("OES_texture_half_float");this.HALF_FLOAT=It?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(dt,xt){return new io(this,dt,xt)}createVertexBuffer(dt,xt,At){return new Os(this,dt,xt,At)}createRenderbuffer(dt,xt,At){const It=this.gl,Pt=It.createRenderbuffer();return this.bindRenderbuffer.set(Pt),It.renderbufferStorage(It.RENDERBUFFER,dt,xt,At),this.bindRenderbuffer.set(null),Pt}createFramebuffer(dt,xt,At,It){return new Vy(this,dt,xt,At,It)}clear({color:dt,depth:xt,stencil:At}){const It=this.gl;let Pt=0;dt&&(Pt|=It.COLOR_BUFFER_BIT,this.clearColor.set(dt),this.colorMask.set([!0,!0,!0,!0])),xt!==void 0&&(Pt|=It.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(xt),this.depthMask.set(!0)),At!==void 0&&(Pt|=It.STENCIL_BUFFER_BIT,this.clearStencil.set(At),this.stencilMask.set(255)),It.clear(Pt)}setCullFace(dt){dt.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(dt.mode),this.frontFace.set(dt.frontFace))}setDepthMode(dt){dt.func!==this.gl.ALWAYS||dt.mask?(this.depthTest.set(!0),this.depthFunc.set(dt.func),this.depthMask.set(dt.mask),this.depthRange.set(dt.range)):this.depthTest.set(!1)}setStencilMode(dt){dt.test.func!==this.gl.ALWAYS||dt.mask?(this.stencilTest.set(!0),this.stencilMask.set(dt.mask),this.stencilOp.set([dt.fail,dt.depthFail,dt.pass]),this.stencilFunc.set({func:dt.test.func,ref:dt.ref,mask:dt.test.mask})):this.stencilTest.set(!1)}setColorMode(dt){it.aE(dt.blendFunction,qo.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(dt.blendFunction),this.blendColor.set(dt.blendColor)),this.colorMask.set(dt.mask)}createVertexArray(){var dt;return tn(this.gl)?this.gl.createVertexArray():(dt=this.gl.getExtension("OES_vertex_array_object"))===null||dt===void 0?void 0:dt.createVertexArrayOES()}deleteVertexArray(dt){var xt;return tn(this.gl)?this.gl.deleteVertexArray(dt):(xt=this.gl.getExtension("OES_vertex_array_object"))===null||xt===void 0?void 0:xt.deleteVertexArrayOES(dt)}unbindVAO(){this.bindVertexArray.set(null)}}class go{constructor(dt,xt,At){this.func=dt,this.mask=xt,this.range=At}}go.ReadOnly=!1,go.ReadWrite=!0,go.disabled=new go(519,go.ReadOnly,[0,1]);const Gp=7680;class Oo{constructor(dt,xt,At,It,Pt,Bt){this.test=dt,this.ref=xt,this.mask=At,this.fail=It,this.depthFail=Pt,this.pass=Bt}}Oo.disabled=new Oo({func:519,mask:0},0,0,Gp,Gp,Gp);class Co{constructor(dt,xt,At){this.enable=dt,this.mode=xt,this.frontFace=At}}let xu;function pp(Mt,dt,xt,At,It){const Pt=Mt.context,Bt=Pt.gl,Ut=Mt.useProgram("collisionBox"),Gt=[];let Yt=0,Kt=0;for(let Cr=0;Cr<At.length;Cr++){const Rr=At[Cr],Sr=dt.getTile(Rr).getBucket(xt);if(!Sr)continue;const Br=It?Sr.textCollisionBox:Sr.iconCollisionBox,Gr=Sr.collisionCircleArray;if(Gr.length>0){const qr=it.H();it.aQ(qr,Sr.placementInvProjMatrix,Mt.transform.glCoordMatrix),it.aQ(qr,qr,Sr.placementViewportMatrix),Gt.push({circleArray:Gr,circleOffset:Kt,transform:Rr.posMatrix,invTransform:qr,coord:Rr}),Yt+=Gr.length/4,Kt=Yt}Br&&Ut.draw(Pt,Bt.LINES,go.disabled,Oo.disabled,Mt.colorModeForRenderPass(),Co.disabled,{u_matrix:Rr.posMatrix,u_pixel_extrude_scale:[1/(Jt=Mt.transform).width,1/Jt.height]},Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(Rr),xt.id,Br.layoutVertexBuffer,Br.indexBuffer,Br.segments,null,Mt.transform.zoom,null,null,Br.collisionVertexBuffer)}var Jt;if(!It||!Gt.length)return;const sr=Mt.useProgram("collisionCircle"),gr=new it.aR;gr.resize(4*Yt),gr._trim();let vr=0;for(const Cr of Gt)for(let Rr=0;Rr<Cr.circleArray.length/4;Rr++){const Sr=4*Rr,Br=Cr.circleArray[Sr+0],Gr=Cr.circleArray[Sr+1],qr=Cr.circleArray[Sr+2],ln=Cr.circleArray[Sr+3];gr.emplace(vr++,Br,Gr,qr,ln,0),gr.emplace(vr++,Br,Gr,qr,ln,1),gr.emplace(vr++,Br,Gr,qr,ln,2),gr.emplace(vr++,Br,Gr,qr,ln,3)}(!xu||xu.length<2*Yt)&&(xu=function(Cr){const Rr=2*Cr,Sr=new it.aT;Sr.resize(Rr),Sr._trim();for(let Br=0;Br<Rr;Br++){const Gr=6*Br;Sr.uint16[Gr+0]=4*Br+0,Sr.uint16[Gr+1]=4*Br+1,Sr.uint16[Gr+2]=4*Br+2,Sr.uint16[Gr+3]=4*Br+2,Sr.uint16[Gr+4]=4*Br+3,Sr.uint16[Gr+5]=4*Br+0}return Sr}(Yt));const Ar=Pt.createIndexBuffer(xu,!0),Er=Pt.createVertexBuffer(gr,it.aS.members,!0);for(const Cr of Gt){const Rr=Bl(Cr.transform,Cr.invTransform,Mt.transform);sr.draw(Pt,Bt.TRIANGLES,go.disabled,Oo.disabled,Mt.colorModeForRenderPass(),Co.disabled,Rr,Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(Cr.coord),xt.id,Er,Ar,it.a0.simpleSegment(0,2*Cr.circleOffset,Cr.circleArray.length,Cr.circleArray.length/2),null,Mt.transform.zoom,null,null,null)}Er.destroy(),Ar.destroy()}Co.disabled=new Co(!1,1029,2305),Co.backCCW=new Co(!0,1029,2305);const gp=it.an(new Float32Array(16));function Fm(Mt,dt,xt,At,It,Pt){const{horizontalAlign:Bt,verticalAlign:Ut}=it.au(Mt);return new it.P((-(Bt-.5)*dt/It+At[0])*Pt,(-(Ut-.5)*xt/It+At[1])*Pt)}function wu(Mt,dt,xt,At,It,Pt){const Bt=dt.tileAnchorPoint.add(new it.P(dt.translation[0],dt.translation[1]));if(dt.pitchWithMap){let Ut=At.mult(Pt);xt||(Ut=Ut.rotate(-It));const Gt=Bt.add(Ut);return yr(Gt.x,Gt.y,dt.labelPlaneMatrix,dt.getElevation).point}if(xt){const Ut=Qr(dt.tileAnchorPoint.x+1,dt.tileAnchorPoint.y,dt).point.sub(Mt),Gt=Math.atan(Ut.y/Ut.x)+(Ut.x<0?Math.PI:0);return Mt.add(At.rotate(Gt))}return Mt.add(At)}function Ou(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt,sr,gr){const vr=Mt.text.placedSymbolArray,Ar=Mt.text.dynamicLayoutVertexArray,Er=Mt.icon.dynamicLayoutVertexArray,Cr={};Ar.clear();for(let Rr=0;Rr<vr.length;Rr++){const Sr=vr.get(Rr),Br=Sr.hidden||!Sr.crossTileID||Mt.allowVerticalPlacement&&!Sr.placedOrientation?null:At[Sr.crossTileID];if(Br){const Gr=new it.P(Sr.anchorX,Sr.anchorY),qr={getElevation:gr,width:It.width,height:It.height,labelPlaneMatrix:Pt,pitchWithMap:xt,projection:Kt,tileAnchorPoint:Gr,translation:Jt,unwrappedTileID:sr},ln=xt?yr(Gr.x,Gr.y,Bt,gr):Qr(Gr.x,Gr.y,qr),mn=er(It.cameraToCenterDistance,ln.signedDistanceFromCamera);let Cn=it.ai(Mt.textSizeData,Gt,Sr)*mn/it.ap;xt&&(Cn*=Mt.tilePixelRatio/Ut);const{width:On,height:Tn,anchor:Sn,textOffset:Un,textBoxScale:$a}=Br,In=Fm(Sn,On,Tn,Un,$a,Cn),Mn=Kt.getPitchedTextCorrection(It,Gr.add(new it.P(Jt[0],Jt[1])),sr),ba=wu(ln.point,qr,dt,In,It.angle,Mn),Fo=Mt.allowVerticalPlacement&&Sr.placedOrientation===it.ah.vertical?Math.PI/2:0;for(let uo=0;uo<Sr.numGlyphs;uo++)it.aj(Ar,ba,Fo);Yt&&Sr.associatedIconIndex>=0&&(Cr[Sr.associatedIconIndex]={shiftedAnchor:ba,angle:Fo})}else Yn(Sr.numGlyphs,Ar)}if(Yt){Er.clear();const Rr=Mt.icon.placedSymbolArray;for(let Sr=0;Sr<Rr.length;Sr++){const Br=Rr.get(Sr);if(Br.hidden)Yn(Br.numGlyphs,Er);else{const Gr=Cr[Sr];if(Gr)for(let qr=0;qr<Br.numGlyphs;qr++)it.aj(Er,Gr.shiftedAnchor,Gr.angle);else Yn(Br.numGlyphs,Er)}}Mt.icon.dynamicLayoutVertexBuffer.updateData(Er)}Mt.text.dynamicLayoutVertexBuffer.updateData(Ar)}function Zs(Mt,dt,xt){return xt.iconsInText&&dt?"symbolTextAndIcon":Mt?"symbolSDF":"symbolIcon"}function Bm(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt,Kt,Jt){const sr=Mt.context,gr=sr.gl,vr=Mt.transform,Ar=$l(),Er=Ut==="map",Cr=Gt==="map",Rr=Ut!=="viewport"&&xt.layout.get("symbol-placement")!=="point",Sr=Er&&!Cr&&!Rr,Br=!Cr&&Rr,Gr=!xt.layout.get("symbol-sort-key").isConstant();let qr=!1;const ln=Mt.depthModeForSublayer(0,go.ReadOnly),mn=xt._unevaluatedLayout.hasValue("text-variable-anchor")||xt._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Cn=[],On=Ar.getCircleRadiusCorrection(vr);for(const Tn of At){const Sn=dt.getTile(Tn),Un=Sn.getBucket(xt);if(!Un)continue;const $a=It?Un.text:Un.icon;if(!$a||!$a.segments.get().length||!$a.hasVisibleVertices)continue;const In=$a.programConfigurations.get(xt.id),Mn=It||Un.sdfIcons,ba=It?Un.textSizeData:Un.iconSizeData,Fo=Cr||vr.pitch!==0,uo=Mt.useProgram(Zs(Mn,It,Un),In),vo=it.ag(ba,vr.zoom),Bo=Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(Tn);let bs,El,zo,$s,Es=[0,0],xs=null;if(It)El=Sn.glyphAtlasTexture,zo=gr.LINEAR,bs=Sn.glyphAtlasTexture.size,Un.iconsInText&&(Es=Sn.imageAtlasTexture.size,xs=Sn.imageAtlasTexture,$s=Fo||Mt.options.rotating||Mt.options.zooming||ba.kind==="composite"||ba.kind==="camera"?gr.LINEAR:gr.NEAREST);else{const bo=xt.layout.get("icon-size").constantOr(0)!==1||Un.iconsNeedLinear;El=Sn.imageAtlasTexture,zo=Mn||Mt.options.rotating||Mt.options.zooming||bo||Fo?gr.LINEAR:gr.NEAREST,bs=Sn.imageAtlasTexture.size}const Cs=br(Sn,1,Mt.transform.zoom),Ul=Br?Tn.posMatrix:gp,Zu=Ms(Ul,Cr,Er,Mt.transform,Cs),lm=ns(Ul,Cr,Er,Mt.transform,Cs),Xu=ns(Tn.posMatrix,Cr,Er,Mt.transform,Cs),Js=Ar.translatePosition(Mt.transform,Sn,Pt,Bt),um=mn&&Un.hasTextData(),cv=xt.layout.get("icon-text-fit")!=="none"&&um&&Un.hasIconData();if(Rr){const bo=Mt.style.map.terrain?(Ku,Ju)=>Mt.style.map.terrain.getElevation(Tn,Ku,Ju):null,Eu=xt.layout.get("text-rotation-alignment")==="map";fr(Un,Tn.posMatrix,Mt,It,Zu,Xu,Cr,Yt,Eu,Ar,Tn.toUnwrapped(),vr.width,vr.height,Js,bo)}const Qs=Tn.posMatrix,yl=It&&mn||cv,ru=Rr||yl?gp:Zu,Cl=lm,ps=Mn&&xt.paint.get(It?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ws;ws=Mn?Un.iconsInText?rn(ba.kind,vo,Sr,Cr,Rr,yl,Mt,Qs,ru,Cl,Js,bs,Es,On):Zr(ba.kind,vo,Sr,Cr,Rr,yl,Mt,Qs,ru,Cl,Js,It,bs,!0,On):Or(ba.kind,vo,Sr,Cr,Rr,yl,Mt,Qs,ru,Cl,Js,It,bs,On);const Hs={program:uo,buffers:$a,uniformValues:ws,atlasTexture:El,atlasTextureIcon:xs,atlasInterpolation:zo,atlasInterpolationIcon:$s,isSDF:Mn,hasHalo:ps};if(Gr&&Un.canOverlap){qr=!0;const bo=$a.segments.get();for(const Eu of bo)Cn.push({segments:new it.a0([Eu]),sortKey:Eu.sortKey,state:Hs,terrainData:Bo})}else Cn.push({segments:$a.segments,sortKey:0,state:Hs,terrainData:Bo})}qr&&Cn.sort((Tn,Sn)=>Tn.sortKey-Sn.sortKey);for(const Tn of Cn){const Sn=Tn.state;if(sr.activeTexture.set(gr.TEXTURE0),Sn.atlasTexture.bind(Sn.atlasInterpolation,gr.CLAMP_TO_EDGE),Sn.atlasTextureIcon&&(sr.activeTexture.set(gr.TEXTURE1),Sn.atlasTextureIcon&&Sn.atlasTextureIcon.bind(Sn.atlasInterpolationIcon,gr.CLAMP_TO_EDGE)),Sn.isSDF){const Un=Sn.uniformValues;Sn.hasHalo&&(Un.u_is_halo=1,zm(Sn.buffers,Tn.segments,xt,Mt,Sn.program,ln,Kt,Jt,Un,Tn.terrainData)),Un.u_is_halo=0}zm(Sn.buffers,Tn.segments,xt,Mt,Sn.program,ln,Kt,Jt,Sn.uniformValues,Tn.terrainData)}}function zm(Mt,dt,xt,At,It,Pt,Bt,Ut,Gt,Yt){const Kt=At.context;It.draw(Kt,Kt.gl.TRIANGLES,Pt,Bt,Ut,Co.disabled,Gt,Yt,xt.id,Mt.layoutVertexBuffer,Mt.indexBuffer,dt,xt.paint,At.transform.zoom,Mt.programConfigurations.get(xt.id),Mt.dynamicLayoutVertexBuffer,Mt.opacityVertexBuffer)}function Vm(Mt,dt,xt,At){const It=Mt.context,Pt=It.gl,Bt=Oo.disabled,Ut=new qo([Pt.ONE,Pt.ONE],it.aM.transparent,[!0,!0,!0,!0]),Gt=dt.getBucket(xt);if(!Gt)return;const Yt=At.key;let Kt=xt.heatmapFbos.get(Yt);Kt||(Kt=mp(It,dt.tileSize,dt.tileSize),xt.heatmapFbos.set(Yt,Kt)),It.bindFramebuffer.set(Kt.framebuffer),It.viewport.set([0,0,dt.tileSize,dt.tileSize]),It.clear({color:it.aM.transparent});const Jt=Gt.programConfigurations.get(xt.id),sr=Mt.useProgram("heatmap",Jt),gr=Mt.style.map.terrain.getTerrainData(At);sr.draw(It,Pt.TRIANGLES,go.disabled,Bt,Ut,Co.disabled,ds(At.posMatrix,dt,Mt.transform.zoom,xt.paint.get("heatmap-intensity")),gr,xt.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,xt.paint,Mt.transform.zoom,Jt)}function Su(Mt,dt,xt){const At=Mt.context,It=At.gl;At.setColorMode(Mt.colorModeForRenderPass());const Pt=vp(At,dt),Bt=xt.key,Ut=dt.heatmapFbos.get(Bt);Ut&&(At.activeTexture.set(It.TEXTURE0),It.bindTexture(It.TEXTURE_2D,Ut.colorAttachment.get()),At.activeTexture.set(It.TEXTURE1),Pt.bind(It.LINEAR,It.CLAMP_TO_EDGE),Mt.useProgram("heatmapTexture").draw(At,It.TRIANGLES,go.disabled,Oo.disabled,Mt.colorModeForRenderPass(),Co.disabled,gu(Mt,dt,0,1),null,dt.id,Mt.rasterBoundsBuffer,Mt.quadTriangleIndexBuffer,Mt.rasterBoundsSegments,dt.paint,Mt.transform.zoom),Ut.destroy(),dt.heatmapFbos.delete(Bt))}function mp(Mt,dt,xt){var At,It;const Pt=Mt.gl,Bt=Pt.createTexture();Pt.bindTexture(Pt.TEXTURE_2D,Bt),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_S,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_T,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MIN_FILTER,Pt.LINEAR),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MAG_FILTER,Pt.LINEAR);const Ut=(At=Mt.HALF_FLOAT)!==null&&At!==void 0?At:Pt.UNSIGNED_BYTE,Gt=(It=Mt.RGBA16F)!==null&&It!==void 0?It:Pt.RGBA;Pt.texImage2D(Pt.TEXTURE_2D,0,Gt,dt,xt,0,Pt.RGBA,Ut,null);const Yt=Mt.createFramebuffer(dt,xt,!1,!1);return Yt.colorAttachment.set(Bt),Yt}function vp(Mt,dt){return dt.colorRampTexture||(dt.colorRampTexture=new Ht(Mt,dt.colorRamp,Mt.gl.RGBA)),dt.colorRampTexture}function $u(Mt,dt,xt,At,It){if(!xt||!At||!At.imageAtlas)return;const Pt=At.imageAtlas.patternPositions;let Bt=Pt[xt.to.toString()],Ut=Pt[xt.from.toString()];if(!Bt&&Ut&&(Bt=Ut),!Ut&&Bt&&(Ut=Bt),!Bt||!Ut){const Gt=It.getPaintProperty(dt);Bt=Pt[Gt],Ut=Pt[Gt]}Bt&&Ut&&Mt.setConstantPatternPositions(Bt,Ut)}function yp(Mt,dt,xt,At,It,Pt,Bt){const Ut=Mt.context.gl,Gt="fill-pattern",Yt=xt.paint.get(Gt),Kt=Yt&&Yt.constantOr(1),Jt=xt.getCrossfadeParameters();let sr,gr,vr,Ar,Er;Bt?(gr=Kt&&!xt.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",sr=Ut.LINES):(gr=Kt?"fillPattern":"fill",sr=Ut.TRIANGLES);const Cr=Yt.constantOr(null);for(const Rr of At){const Sr=dt.getTile(Rr);if(Kt&&!Sr.patternsLoaded())continue;const Br=Sr.getBucket(xt);if(!Br)continue;const Gr=Br.programConfigurations.get(xt.id),qr=Mt.useProgram(gr,Gr),ln=Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(Rr);Kt&&(Mt.context.activeTexture.set(Ut.TEXTURE0),Sr.imageAtlasTexture.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),Gr.updatePaintBuffers(Jt)),$u(Gr,Gt,Cr,Sr,xt);const mn=ln?Rr:null,Cn=Mt.translatePosMatrix(mn?mn.posMatrix:Rr.posMatrix,Sr,xt.paint.get("fill-translate"),xt.paint.get("fill-translate-anchor"));if(Bt){Ar=Br.indexBuffer2,Er=Br.segments2;const On=[Ut.drawingBufferWidth,Ut.drawingBufferHeight];vr=gr==="fillOutlinePattern"&&Kt?pu(Cn,Mt,Jt,Sr,On):cp(Cn,On)}else Ar=Br.indexBuffer,Er=Br.segments,vr=Kt?ho(Cn,Mt,Jt,Sr):so(Cn);qr.draw(Mt.context,sr,It,Mt.stencilModeForClipping(Rr),Pt,Co.disabled,vr,ln,xt.id,Br.layoutVertexBuffer,Ar,Er,xt.paint,Mt.transform.zoom,Gr)}}function jp(Mt,dt,xt,At,It,Pt,Bt){const Ut=Mt.context,Gt=Ut.gl,Yt="fill-extrusion-pattern",Kt=xt.paint.get(Yt),Jt=Kt.constantOr(1),sr=xt.getCrossfadeParameters(),gr=xt.paint.get("fill-extrusion-opacity"),vr=Kt.constantOr(null);for(const Ar of At){const Er=dt.getTile(Ar),Cr=Er.getBucket(xt);if(!Cr)continue;const Rr=Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(Ar),Sr=Cr.programConfigurations.get(xt.id),Br=Mt.useProgram(Jt?"fillExtrusionPattern":"fillExtrusion",Sr);Jt&&(Mt.context.activeTexture.set(Gt.TEXTURE0),Er.imageAtlasTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Sr.updatePaintBuffers(sr)),$u(Sr,Yt,vr,Er,xt);const Gr=Mt.translatePosMatrix(Ar.posMatrix,Er,xt.paint.get("fill-extrusion-translate"),xt.paint.get("fill-extrusion-translate-anchor")),qr=xt.paint.get("fill-extrusion-vertical-gradient"),ln=Jt?du(Gr,Mt,qr,gr,Ar,sr,Er):lo(Gr,Mt,qr,gr);Br.draw(Ut,Ut.gl.TRIANGLES,It,Pt,Bt,Co.backCCW,ln,Rr,xt.id,Cr.layoutVertexBuffer,Cr.indexBuffer,Cr.segments,xt.paint,Mt.transform.zoom,Sr,Mt.style.map.terrain&&Cr.centroidVertexBuffer)}}function ku(Mt,dt,xt,At,It,Pt,Bt){const Ut=Mt.context,Gt=Ut.gl,Yt=xt.fbo;if(!Yt)return;const Kt=Mt.useProgram("hillshade"),Jt=Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(dt);Ut.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,Yt.colorAttachment.get()),Kt.draw(Ut,Gt.TRIANGLES,It,Pt,Bt,Co.disabled,((sr,gr,vr,Ar)=>{const Er=vr.paint.get("hillshade-shadow-color"),Cr=vr.paint.get("hillshade-highlight-color"),Rr=vr.paint.get("hillshade-accent-color");let Sr=vr.paint.get("hillshade-illumination-direction")*(Math.PI/180);vr.paint.get("hillshade-illumination-anchor")==="viewport"&&(Sr-=sr.transform.angle);const Br=!sr.options.moving;return{u_matrix:Ar?Ar.posMatrix:sr.transform.calculatePosMatrix(gr.tileID.toUnwrapped(),Br),u_image:0,u_latrange:mu(0,gr.tileID),u_light:[vr.paint.get("hillshade-exaggeration"),Sr],u_shadow:Er,u_highlight:Cr,u_accent:Rr}})(Mt,xt,At,Jt?dt:null),Jt,At.id,Mt.rasterBoundsBuffer,Mt.quadTriangleIndexBuffer,Mt.rasterBoundsSegments)}function Nu(Mt,dt,xt,At,It,Pt){const Bt=Mt.context,Ut=Bt.gl,Gt=dt.dem;if(Gt&&Gt.data){const Yt=Gt.dim,Kt=Gt.stride,Jt=Gt.getPixels();if(Bt.activeTexture.set(Ut.TEXTURE1),Bt.pixelStoreUnpackPremultiplyAlpha.set(!1),dt.demTexture=dt.demTexture||Mt.getTileTexture(Kt),dt.demTexture){const gr=dt.demTexture;gr.update(Jt,{premultiply:!1}),gr.bind(Ut.NEAREST,Ut.CLAMP_TO_EDGE)}else dt.demTexture=new Ht(Bt,Jt,Ut.RGBA,{premultiply:!1}),dt.demTexture.bind(Ut.NEAREST,Ut.CLAMP_TO_EDGE);Bt.activeTexture.set(Ut.TEXTURE0);let sr=dt.fbo;if(!sr){const gr=new Ht(Bt,{width:Yt,height:Yt,data:null},Ut.RGBA);gr.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),sr=dt.fbo=Bt.createFramebuffer(Yt,Yt,!0,!1),sr.colorAttachment.set(gr.texture)}Bt.bindFramebuffer.set(sr.framebuffer),Bt.viewport.set([0,0,Yt,Yt]),Mt.useProgram("hillshadePrepare").draw(Bt,Ut.TRIANGLES,At,It,Pt,Co.disabled,((gr,vr)=>{const Ar=vr.stride,Er=it.H();return it.aP(Er,0,it.X,-it.X,0,0,1),it.J(Er,Er,[0,-it.X,0]),{u_matrix:Er,u_image:1,u_dimension:[Ar,Ar],u_zoom:gr.overscaledZ,u_unpack:vr.getUnpackVector()}})(dt.tileID,Gt),null,xt.id,Mt.rasterBoundsBuffer,Mt.quadTriangleIndexBuffer,Mt.rasterBoundsSegments),dt.needsHillshadePrepare=!1}}function Xv(Mt,dt,xt,At,It,Pt){const Bt=At.paint.get("raster-fade-duration");if(!Pt&&Bt>0){const Ut=ot.now(),Gt=(Ut-Mt.timeAdded)/Bt,Yt=dt?(Ut-dt.timeAdded)/Bt:-1,Kt=xt.getSource(),Jt=It.coveringZoomLevel({tileSize:Kt.tileSize,roundZoom:Kt.roundZoom}),sr=!dt||Math.abs(dt.tileID.overscaledZ-Jt)>Math.abs(Mt.tileID.overscaledZ-Jt),gr=sr&&Mt.refreshedUponExpiration?1:it.ac(sr?Gt:1-Yt,0,1);return Mt.refreshedUponExpiration&&Gt>=1&&(Mt.refreshedUponExpiration=!1),dt?{opacity:1,mix:1-gr}:{opacity:gr,mix:0}}return{opacity:1,mix:0}}const Um=new it.aM(1,0,0,1),Ao=new it.aM(0,1,0,1),Hp=new it.aM(0,0,1,1),Gy=new it.aM(1,0,1,1),Kv=new it.aM(0,1,1,1);function Fu(Mt,dt,xt,At){Wp(Mt,0,dt+xt/2,Mt.transform.width,xt,At)}function Jv(Mt,dt,xt,At){Wp(Mt,dt-xt/2,0,xt,Mt.transform.height,At)}function Wp(Mt,dt,xt,At,It,Pt){const Bt=Mt.context,Ut=Bt.gl;Ut.enable(Ut.SCISSOR_TEST),Ut.scissor(dt*Mt.pixelRatio,xt*Mt.pixelRatio,At*Mt.pixelRatio,It*Mt.pixelRatio),Bt.clear({color:Pt}),Ut.disable(Ut.SCISSOR_TEST)}function Qv(Mt,dt,xt){const At=Mt.context,It=At.gl,Pt=xt.posMatrix,Bt=Mt.useProgram("debug"),Ut=go.disabled,Gt=Oo.disabled,Yt=Mt.colorModeForRenderPass(),Kt="$debug",Jt=Mt.style.map.terrain&&Mt.style.map.terrain.getTerrainData(xt);At.activeTexture.set(It.TEXTURE0);const sr=dt.getTileByID(xt.key).latestRawTileData,gr=Math.floor((sr&&sr.byteLength||0)/1024),vr=dt.getTile(xt).tileSize,Ar=512/Math.min(vr,512)*(xt.overscaledZ/Mt.transform.zoom)*.5;let Er=xt.canonical.toString();xt.overscaledZ!==xt.canonical.z&&(Er+=` => ${xt.overscaledZ}`),function(Cr,Rr){Cr.initDebugOverlayCanvas();const Sr=Cr.debugOverlayCanvas,Br=Cr.context.gl,Gr=Cr.debugOverlayCanvas.getContext("2d");Gr.clearRect(0,0,Sr.width,Sr.height),Gr.shadowColor="white",Gr.shadowBlur=2,Gr.lineWidth=1.5,Gr.strokeStyle="white",Gr.textBaseline="top",Gr.font="bold 36px Open Sans, sans-serif",Gr.fillText(Rr,5,5),Gr.strokeText(Rr,5,5),Cr.debugOverlayTexture.update(Sr),Cr.debugOverlayTexture.bind(Br.LINEAR,Br.CLAMP_TO_EDGE)}(Mt,`${Er} ${gr}kB`),Bt.draw(At,It.TRIANGLES,Ut,Gt,qo.alphaBlended,Co.disabled,tu(Pt,it.aM.transparent,Ar),null,Kt,Mt.debugBuffer,Mt.quadTriangleIndexBuffer,Mt.debugSegments),Bt.draw(At,It.LINE_STRIP,Ut,Gt,Yt,Co.disabled,tu(Pt,it.aM.red),Jt,Kt,Mt.debugBuffer,Mt.tileBorderIndexBuffer,Mt.debugSegments)}function ey(Mt,dt,xt){const At=Mt.context,It=At.gl,Pt=Mt.colorModeForRenderPass(),Bt=new go(It.LEQUAL,go.ReadWrite,Mt.depthRangeFor3D),Ut=Mt.useProgram("terrain"),Gt=dt.getTerrainMesh();At.bindFramebuffer.set(null),At.viewport.set([0,0,Mt.width,Mt.height]);for(const Yt of xt){const Kt=Mt.renderToTexture.getTexture(Yt),Jt=dt.getTerrainData(Yt.tileID);At.activeTexture.set(It.TEXTURE0),It.bindTexture(It.TEXTURE_2D,Kt.texture);const sr=Mt.transform.calculatePosMatrix(Yt.tileID.toUnwrapped()),gr=dt.getMeshFrameDelta(Mt.transform.zoom),vr=Mt.transform.calculateFogMatrix(Yt.tileID.toUnwrapped()),Ar=Lu(sr,gr,vr,Mt.style.sky,Mt.transform.pitch);Ut.draw(At,It.TRIANGLES,Bt,Oo.disabled,Pt,Co.backCCW,Ar,Jt,"terrain",Gt.vertexBuffer,Gt.indexBuffer,Gt.segments)}}class Yp{constructor(dt,xt,At){this.vertexBuffer=dt,this.indexBuffer=xt,this.segments=At}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class qp{constructor(dt,xt){this.context=new Uy(dt),this.transform=xt,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:it.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Zn.maxUnderzooming+Zn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new lp}resize(dt,xt,At){if(this.width=Math.floor(dt*At),this.height=Math.floor(xt*At),this.pixelRatio=At,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const It of this.style._order)this.style._layers[It].resize()}setup(){const dt=this.context,xt=new it.aX;xt.emplaceBack(0,0),xt.emplaceBack(it.X,0),xt.emplaceBack(0,it.X),xt.emplaceBack(it.X,it.X),this.tileExtentBuffer=dt.createVertexBuffer(xt,Fl.members),this.tileExtentSegments=it.a0.simpleSegment(0,0,4,2);const At=new it.aX;At.emplaceBack(0,0),At.emplaceBack(it.X,0),At.emplaceBack(0,it.X),At.emplaceBack(it.X,it.X),this.debugBuffer=dt.createVertexBuffer(At,Fl.members),this.debugSegments=it.a0.simpleSegment(0,0,4,5);const It=new it.$;It.emplaceBack(0,0,0,0),It.emplaceBack(it.X,0,it.X,0),It.emplaceBack(0,it.X,0,it.X),It.emplaceBack(it.X,it.X,it.X,it.X),this.rasterBoundsBuffer=dt.createVertexBuffer(It,xo.members),this.rasterBoundsSegments=it.a0.simpleSegment(0,0,4,2);const Pt=new it.aX;Pt.emplaceBack(0,0),Pt.emplaceBack(1,0),Pt.emplaceBack(0,1),Pt.emplaceBack(1,1),this.viewportBuffer=dt.createVertexBuffer(Pt,Fl.members),this.viewportSegments=it.a0.simpleSegment(0,0,4,2);const Bt=new it.aZ;Bt.emplaceBack(0),Bt.emplaceBack(1),Bt.emplaceBack(3),Bt.emplaceBack(2),Bt.emplaceBack(0),this.tileBorderIndexBuffer=dt.createIndexBuffer(Bt);const Ut=new it.aY;Ut.emplaceBack(0,1,2),Ut.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=dt.createIndexBuffer(Ut);const Gt=this.context.gl;this.stencilClearMode=new Oo({func:Gt.ALWAYS,mask:0},0,255,Gt.ZERO,Gt.ZERO,Gt.ZERO)}clearStencil(){const dt=this.context,xt=dt.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const At=it.H();it.aP(At,0,this.width,this.height,0,0,1),it.K(At,At,[xt.drawingBufferWidth,xt.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(dt,xt.TRIANGLES,go.disabled,this.stencilClearMode,qo.disabled,Co.disabled,fs(At),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(dt,xt){if(this.currentStencilSource===dt.source||!dt.isTileClipped()||!xt||!xt.length)return;this.currentStencilSource=dt.source;const At=this.context,It=At.gl;this.nextStencilID+xt.length>256&&this.clearStencil(),At.setColorMode(qo.disabled),At.setDepthMode(go.disabled);const Pt=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const Bt of xt){const Ut=this._tileClippingMaskIDs[Bt.key]=this.nextStencilID++,Gt=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Bt);Pt.draw(At,It.TRIANGLES,go.disabled,new Oo({func:It.ALWAYS,mask:0},Ut,255,It.KEEP,It.KEEP,It.REPLACE),qo.disabled,Co.disabled,fs(Bt.posMatrix),Gt,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const dt=this.nextStencilID++,xt=this.context.gl;return new Oo({func:xt.NOTEQUAL,mask:255},dt,255,xt.KEEP,xt.KEEP,xt.REPLACE)}stencilModeForClipping(dt){const xt=this.context.gl;return new Oo({func:xt.EQUAL,mask:255},this._tileClippingMaskIDs[dt.key],0,xt.KEEP,xt.KEEP,xt.REPLACE)}stencilConfigForOverlap(dt){const xt=this.context.gl,At=dt.sort((Bt,Ut)=>Ut.overscaledZ-Bt.overscaledZ),It=At[At.length-1].overscaledZ,Pt=At[0].overscaledZ-It+1;if(Pt>1){this.currentStencilSource=void 0,this.nextStencilID+Pt>256&&this.clearStencil();const Bt={};for(let Ut=0;Ut<Pt;Ut++)Bt[Ut+It]=new Oo({func:xt.GEQUAL,mask:255},Ut+this.nextStencilID,255,xt.KEEP,xt.KEEP,xt.REPLACE);return this.nextStencilID+=Pt,[Bt,At]}return[{[It]:Oo.disabled},At]}colorModeForRenderPass(){const dt=this.context.gl;return this._showOverdrawInspector?new qo([dt.CONSTANT_COLOR,dt.ONE],new it.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qo.unblended:qo.alphaBlended}depthModeForSublayer(dt,xt,At){if(!this.opaquePassEnabledForLayer())return go.disabled;const It=1-((1+this.currentLayer)*this.numSublayers+dt)*this.depthEpsilon;return new go(At||this.context.gl.LEQUAL,xt,[It,It])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(dt,xt){this.style=dt,this.options=xt,this.lineAtlas=dt.lineAtlas,this.imageManager=dt.imageManager,this.glyphManager=dt.glyphManager,this.symbolFadeChange=dt.placement.symbolFadeChange(ot.now()),this.imageManager.beginFrame();const At=this.style._order,It=this.style.sourceCaches,Pt={},Bt={},Ut={};for(const Gt in It){const Yt=It[Gt];Yt.used&&Yt.prepare(this.context),Pt[Gt]=Yt.getVisibleCoordinates(),Bt[Gt]=Pt[Gt].slice().reverse(),Ut[Gt]=Yt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Gt=0;Gt<At.length;Gt++)if(this.style._layers[At[Gt]].is3D()){this.opaquePassCutoff=Gt;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Gt of At){const Yt=this.style._layers[Gt];if(!Yt.hasOffscreenPass()||Yt.isHidden(this.transform.zoom))continue;const Kt=Bt[Yt.source];(Yt.type==="custom"||Kt.length)&&this.renderLayer(this,It[Yt.source],Yt,Kt)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:xt.showOverdrawInspector?it.aM.black:it.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Gt,Yt){const Kt=Gt.context,Jt=Kt.gl,sr=((Cr,Rr,Sr)=>({u_sky_color:Cr.properties.get("sky-color"),u_horizon_color:Cr.properties.get("horizon-color"),u_horizon:(Rr.height/2+Rr.getHorizon())*Sr,u_sky_horizon_blend:Cr.properties.get("sky-horizon-blend")*Rr.height/2*Sr}))(Yt,Gt.style.map.transform,Gt.pixelRatio),gr=new go(Jt.LEQUAL,go.ReadWrite,[0,1]),vr=Oo.disabled,Ar=Gt.colorModeForRenderPass(),Er=Gt.useProgram("sky");if(!Yt.mesh){const Cr=new it.aX;Cr.emplaceBack(-1,-1),Cr.emplaceBack(1,-1),Cr.emplaceBack(1,1),Cr.emplaceBack(-1,1);const Rr=new it.aY;Rr.emplaceBack(0,1,2),Rr.emplaceBack(0,2,3),Yt.mesh=new Yp(Kt.createVertexBuffer(Cr,Fl.members),Kt.createIndexBuffer(Rr),it.a0.simpleSegment(0,0,Cr.length,Rr.length))}Er.draw(Kt,Jt.TRIANGLES,gr,vr,Ar,Co.disabled,sr,void 0,"sky",Yt.mesh.vertexBuffer,Yt.mesh.indexBuffer,Yt.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=xt.showOverdrawInspector,this.depthRangeFor3D=[0,1-(dt._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=At.length-1;this.currentLayer>=0;this.currentLayer--){const Gt=this.style._layers[At[this.currentLayer]],Yt=It[Gt.source],Kt=Pt[Gt.source];this._renderTileClippingMasks(Gt,Kt),this.renderLayer(this,Yt,Gt,Kt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<At.length;this.currentLayer++){const Gt=this.style._layers[At[this.currentLayer]],Yt=It[Gt.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Gt))continue;const Kt=(Gt.type==="symbol"?Ut:Bt)[Gt.source];this._renderTileClippingMasks(Gt,Pt[Gt.source]),this.renderLayer(this,Yt,Gt,Kt)}if(this.options.showTileBoundaries){const Gt=function(Yt,Kt){let Jt=null;const sr=Object.values(Yt._layers).flatMap(Er=>Er.source&&!Er.isHidden(Kt)?[Yt.sourceCaches[Er.source]]:[]),gr=sr.filter(Er=>Er.getSource().type==="vector"),vr=sr.filter(Er=>Er.getSource().type!=="vector"),Ar=Er=>{(!Jt||Jt.getSource().maxzoom<Er.getSource().maxzoom)&&(Jt=Er)};return gr.forEach(Er=>Ar(Er)),Jt||vr.forEach(Er=>Ar(Er)),Jt}(this.style,this.transform.zoom);Gt&&function(Yt,Kt,Jt){for(let sr=0;sr<Jt.length;sr++)Qv(Yt,Kt,Jt[sr])}(this,Gt,Gt.getVisibleCoordinates())}this.options.showPadding&&function(Gt){const Yt=Gt.transform.padding;Fu(Gt,Gt.transform.height-(Yt.top||0),3,Um),Fu(Gt,Yt.bottom||0,3,Ao),Jv(Gt,Yt.left||0,3,Hp),Jv(Gt,Gt.transform.width-(Yt.right||0),3,Gy);const Kt=Gt.transform.centerPoint;(function(Jt,sr,gr,vr){Wp(Jt,sr-1,gr-10,2,20,vr),Wp(Jt,sr-10,gr-1,20,2,vr)})(Gt,Kt.x,Gt.transform.height-Kt.y,Kv)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(dt){if(!this.style||!this.style.map||!this.style.map.terrain)return;const xt=this.terrainFacilitator.matrix,At=this.transform.modelViewProjectionMatrix;let It=this.terrainFacilitator.dirty;It||(It=dt?!it.a_(xt,At):!it.a$(xt,At)),It||(It=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),It&&(it.b0(xt,At),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(Pt,Bt){const Ut=Pt.context,Gt=Ut.gl,Yt=qo.unblended,Kt=new go(Gt.LEQUAL,go.ReadWrite,[0,1]),Jt=Bt.getTerrainMesh(),sr=Bt.sourceCache.getRenderableTiles(),gr=Pt.useProgram("terrainDepth");Ut.bindFramebuffer.set(Bt.getFramebuffer("depth").framebuffer),Ut.viewport.set([0,0,Pt.width/devicePixelRatio,Pt.height/devicePixelRatio]),Ut.clear({color:it.aM.transparent,depth:1});for(const vr of sr){const Ar=Bt.getTerrainData(vr.tileID),Er={u_matrix:Pt.transform.calculatePosMatrix(vr.tileID.toUnwrapped()),u_ele_delta:Bt.getMeshFrameDelta(Pt.transform.zoom)};gr.draw(Ut,Gt.TRIANGLES,Kt,Oo.disabled,Yt,Co.backCCW,Er,Ar,"terrain",Jt.vertexBuffer,Jt.indexBuffer,Jt.segments)}Ut.bindFramebuffer.set(null),Ut.viewport.set([0,0,Pt.width,Pt.height])}(this,this.style.map.terrain),function(Pt,Bt){const Ut=Pt.context,Gt=Ut.gl,Yt=qo.unblended,Kt=new go(Gt.LEQUAL,go.ReadWrite,[0,1]),Jt=Bt.getTerrainMesh(),sr=Bt.getCoordsTexture(),gr=Bt.sourceCache.getRenderableTiles(),vr=Pt.useProgram("terrainCoords");Ut.bindFramebuffer.set(Bt.getFramebuffer("coords").framebuffer),Ut.viewport.set([0,0,Pt.width/devicePixelRatio,Pt.height/devicePixelRatio]),Ut.clear({color:it.aM.transparent,depth:1}),Bt.coordsIndex=[];for(const Ar of gr){const Er=Bt.getTerrainData(Ar.tileID);Ut.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,sr.texture);const Cr={u_matrix:Pt.transform.calculatePosMatrix(Ar.tileID.toUnwrapped()),u_terrain_coords_id:(255-Bt.coordsIndex.length)/255,u_texture:0,u_ele_delta:Bt.getMeshFrameDelta(Pt.transform.zoom)};vr.draw(Ut,Gt.TRIANGLES,Kt,Oo.disabled,Yt,Co.backCCW,Cr,Er,"terrain",Jt.vertexBuffer,Jt.indexBuffer,Jt.segments),Bt.coordsIndex.push(Ar.tileID.key)}Ut.bindFramebuffer.set(null),Ut.viewport.set([0,0,Pt.width,Pt.height])}(this,this.style.map.terrain))}renderLayer(dt,xt,At,It){if(!At.isHidden(this.transform.zoom)&&(At.type==="background"||At.type==="custom"||(It||[]).length))switch(this.id=At.id,At.type){case"symbol":(function(Pt,Bt,Ut,Gt,Yt){if(Pt.renderPass!=="translucent")return;const Kt=Oo.disabled,Jt=Pt.colorModeForRenderPass();(Ut._unevaluatedLayout.hasValue("text-variable-anchor")||Ut._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(sr,gr,vr,Ar,Er,Cr,Rr,Sr,Br){const Gr=gr.transform,qr=$l(),ln=Er==="map",mn=Cr==="map";for(const Cn of sr){const On=Ar.getTile(Cn),Tn=On.getBucket(vr);if(!Tn||!Tn.text||!Tn.text.segments.get().length)continue;const Sn=it.ag(Tn.textSizeData,Gr.zoom),Un=br(On,1,gr.transform.zoom),$a=Ms(Cn.posMatrix,mn,ln,gr.transform,Un),In=vr.layout.get("icon-text-fit")!=="none"&&Tn.hasIconData();if(Sn){const Mn=Math.pow(2,Gr.zoom-On.tileID.overscaledZ),ba=gr.style.map.terrain?(uo,vo)=>gr.style.map.terrain.getElevation(Cn,uo,vo):null,Fo=qr.translatePosition(Gr,On,Rr,Sr);Ou(Tn,ln,mn,Br,Gr,$a,Cn.posMatrix,Mn,Sn,In,qr,Fo,Cn.toUnwrapped(),ba)}}}(Gt,Pt,Ut,Bt,Ut.layout.get("text-rotation-alignment"),Ut.layout.get("text-pitch-alignment"),Ut.paint.get("text-translate"),Ut.paint.get("text-translate-anchor"),Yt),Ut.paint.get("icon-opacity").constantOr(1)!==0&&Bm(Pt,Bt,Ut,Gt,!1,Ut.paint.get("icon-translate"),Ut.paint.get("icon-translate-anchor"),Ut.layout.get("icon-rotation-alignment"),Ut.layout.get("icon-pitch-alignment"),Ut.layout.get("icon-keep-upright"),Kt,Jt),Ut.paint.get("text-opacity").constantOr(1)!==0&&Bm(Pt,Bt,Ut,Gt,!0,Ut.paint.get("text-translate"),Ut.paint.get("text-translate-anchor"),Ut.layout.get("text-rotation-alignment"),Ut.layout.get("text-pitch-alignment"),Ut.layout.get("text-keep-upright"),Kt,Jt),Bt.map.showCollisionBoxes&&(pp(Pt,Bt,Ut,Gt,!0),pp(Pt,Bt,Ut,Gt,!1))})(dt,xt,At,It,this.style.placement.variableOffsets);break;case"circle":(function(Pt,Bt,Ut,Gt){if(Pt.renderPass!=="translucent")return;const Yt=Ut.paint.get("circle-opacity"),Kt=Ut.paint.get("circle-stroke-width"),Jt=Ut.paint.get("circle-stroke-opacity"),sr=!Ut.layout.get("circle-sort-key").isConstant();if(Yt.constantOr(1)===0&&(Kt.constantOr(1)===0||Jt.constantOr(1)===0))return;const gr=Pt.context,vr=gr.gl,Ar=Pt.depthModeForSublayer(0,go.ReadOnly),Er=Oo.disabled,Cr=Pt.colorModeForRenderPass(),Rr=[];for(let Sr=0;Sr<Gt.length;Sr++){const Br=Gt[Sr],Gr=Bt.getTile(Br),qr=Gr.getBucket(Ut);if(!qr)continue;const ln=qr.programConfigurations.get(Ut.id),mn=Pt.useProgram("circle",ln),Cn=qr.layoutVertexBuffer,On=qr.indexBuffer,Tn=Pt.style.map.terrain&&Pt.style.map.terrain.getTerrainData(Br),Sn={programConfiguration:ln,program:mn,layoutVertexBuffer:Cn,indexBuffer:On,uniformValues:Fp(Pt,Br,Gr,Ut),terrainData:Tn};if(sr){const Un=qr.segments.get();for(const $a of Un)Rr.push({segments:new it.a0([$a]),sortKey:$a.sortKey,state:Sn})}else Rr.push({segments:qr.segments,sortKey:0,state:Sn})}sr&&Rr.sort((Sr,Br)=>Sr.sortKey-Br.sortKey);for(const Sr of Rr){const{programConfiguration:Br,program:Gr,layoutVertexBuffer:qr,indexBuffer:ln,uniformValues:mn,terrainData:Cn}=Sr.state;Gr.draw(gr,vr.TRIANGLES,Ar,Er,Cr,Co.disabled,mn,Cn,Ut.id,qr,ln,Sr.segments,Ut.paint,Pt.transform.zoom,Br)}})(dt,xt,At,It);break;case"heatmap":(function(Pt,Bt,Ut,Gt){if(Ut.paint.get("heatmap-opacity")===0)return;const Yt=Pt.context;if(Pt.style.map.terrain){for(const Kt of Gt){const Jt=Bt.getTile(Kt);Bt.hasRenderableParent(Kt)||(Pt.renderPass==="offscreen"?Vm(Pt,Jt,Ut,Kt):Pt.renderPass==="translucent"&&Su(Pt,Ut,Kt))}Yt.viewport.set([0,0,Pt.width,Pt.height])}else Pt.renderPass==="offscreen"?function(Kt,Jt,sr,gr){const vr=Kt.context,Ar=vr.gl,Er=Oo.disabled,Cr=new qo([Ar.ONE,Ar.ONE],it.aM.transparent,[!0,!0,!0,!0]);(function(Rr,Sr,Br){const Gr=Rr.gl;Rr.activeTexture.set(Gr.TEXTURE1),Rr.viewport.set([0,0,Sr.width/4,Sr.height/4]);let qr=Br.heatmapFbos.get(it.aU);qr?(Gr.bindTexture(Gr.TEXTURE_2D,qr.colorAttachment.get()),Rr.bindFramebuffer.set(qr.framebuffer)):(qr=mp(Rr,Sr.width/4,Sr.height/4),Br.heatmapFbos.set(it.aU,qr))})(vr,Kt,sr),vr.clear({color:it.aM.transparent});for(let Rr=0;Rr<gr.length;Rr++){const Sr=gr[Rr];if(Jt.hasRenderableParent(Sr))continue;const Br=Jt.getTile(Sr),Gr=Br.getBucket(sr);if(!Gr)continue;const qr=Gr.programConfigurations.get(sr.id),ln=Kt.useProgram("heatmap",qr),{zoom:mn}=Kt.transform;ln.draw(vr,Ar.TRIANGLES,go.disabled,Er,Cr,Co.disabled,ds(Sr.posMatrix,Br,mn,sr.paint.get("heatmap-intensity")),null,sr.id,Gr.layoutVertexBuffer,Gr.indexBuffer,Gr.segments,sr.paint,Kt.transform.zoom,qr)}vr.viewport.set([0,0,Kt.width,Kt.height])}(Pt,Bt,Ut,Gt):Pt.renderPass==="translucent"&&function(Kt,Jt){const sr=Kt.context,gr=sr.gl;sr.setColorMode(Kt.colorModeForRenderPass());const vr=Jt.heatmapFbos.get(it.aU);vr&&(sr.activeTexture.set(gr.TEXTURE0),gr.bindTexture(gr.TEXTURE_2D,vr.colorAttachment.get()),sr.activeTexture.set(gr.TEXTURE1),vp(sr,Jt).bind(gr.LINEAR,gr.CLAMP_TO_EDGE),Kt.useProgram("heatmapTexture").draw(sr,gr.TRIANGLES,go.disabled,Oo.disabled,Kt.colorModeForRenderPass(),Co.disabled,gu(Kt,Jt,0,1),null,Jt.id,Kt.viewportBuffer,Kt.quadTriangleIndexBuffer,Kt.viewportSegments,Jt.paint,Kt.transform.zoom))}(Pt,Ut)})(dt,xt,At,It);break;case"line":(function(Pt,Bt,Ut,Gt){if(Pt.renderPass!=="translucent")return;const Yt=Ut.paint.get("line-opacity"),Kt=Ut.paint.get("line-width");if(Yt.constantOr(1)===0||Kt.constantOr(1)===0)return;const Jt=Pt.depthModeForSublayer(0,go.ReadOnly),sr=Pt.colorModeForRenderPass(),gr=Ut.paint.get("line-dasharray"),vr=Ut.paint.get("line-pattern"),Ar=vr.constantOr(1),Er=Ut.paint.get("line-gradient"),Cr=Ut.getCrossfadeParameters(),Rr=Ar?"linePattern":gr?"lineSDF":Er?"lineGradient":"line",Sr=Pt.context,Br=Sr.gl;let Gr=!0;for(const qr of Gt){const ln=Bt.getTile(qr);if(Ar&&!ln.patternsLoaded())continue;const mn=ln.getBucket(Ut);if(!mn)continue;const Cn=mn.programConfigurations.get(Ut.id),On=Pt.context.program.get(),Tn=Pt.useProgram(Rr,Cn),Sn=Gr||Tn.program!==On,Un=Pt.style.map.terrain&&Pt.style.map.terrain.getTerrainData(qr),$a=vr.constantOr(null);if($a&&ln.imageAtlas){const ba=ln.imageAtlas,Fo=ba.patternPositions[$a.to.toString()],uo=ba.patternPositions[$a.from.toString()];Fo&&uo&&Cn.setConstantPatternPositions(Fo,uo)}const In=Un?qr:null,Mn=Ar?Yl(Pt,ln,Ut,Cr,In):gr?Bp(Pt,ln,Ut,gr,Cr,In):Er?hp(Pt,ln,Ut,mn.lineClipsArray.length,In):vu(Pt,ln,Ut,In);if(Ar)Sr.activeTexture.set(Br.TEXTURE0),ln.imageAtlasTexture.bind(Br.LINEAR,Br.CLAMP_TO_EDGE),Cn.updatePaintBuffers(Cr);else if(gr&&(Sn||Pt.lineAtlas.dirty))Sr.activeTexture.set(Br.TEXTURE0),Pt.lineAtlas.bind(Sr);else if(Er){const ba=mn.gradients[Ut.id];let Fo=ba.texture;if(Ut.gradientVersion!==ba.version){let uo=256;if(Ut.stepInterpolant){const vo=Bt.getSource().maxzoom,Bo=qr.canonical.z===vo?Math.ceil(1<<Pt.transform.maxZoom-qr.canonical.z):1;uo=it.ac(it.aV(mn.maxLineLength/it.X*1024*Bo),256,Sr.maxTextureSize)}ba.gradient=it.aW({expression:Ut.gradientExpression(),evaluationKey:"lineProgress",resolution:uo,image:ba.gradient||void 0,clips:mn.lineClipsArray}),ba.texture?ba.texture.update(ba.gradient):ba.texture=new Ht(Sr,ba.gradient,Br.RGBA),ba.version=Ut.gradientVersion,Fo=ba.texture}Sr.activeTexture.set(Br.TEXTURE0),Fo.bind(Ut.stepInterpolant?Br.NEAREST:Br.LINEAR,Br.CLAMP_TO_EDGE)}Tn.draw(Sr,Br.TRIANGLES,Jt,Pt.stencilModeForClipping(qr),sr,Co.disabled,Mn,Un,Ut.id,mn.layoutVertexBuffer,mn.indexBuffer,mn.segments,Ut.paint,Pt.transform.zoom,Cn,mn.layoutVertexBuffer2),Gr=!1}})(dt,xt,At,It);break;case"fill":(function(Pt,Bt,Ut,Gt){const Yt=Ut.paint.get("fill-color"),Kt=Ut.paint.get("fill-opacity");if(Kt.constantOr(1)===0)return;const Jt=Pt.colorModeForRenderPass(),sr=Ut.paint.get("fill-pattern"),gr=Pt.opaquePassEnabledForLayer()&&!sr.constantOr(1)&&Yt.constantOr(it.aM.transparent).a===1&&Kt.constantOr(0)===1?"opaque":"translucent";if(Pt.renderPass===gr){const vr=Pt.depthModeForSublayer(1,Pt.renderPass==="opaque"?go.ReadWrite:go.ReadOnly);yp(Pt,Bt,Ut,Gt,vr,Jt,!1)}if(Pt.renderPass==="translucent"&&Ut.paint.get("fill-antialias")){const vr=Pt.depthModeForSublayer(Ut.getPaintProperty("fill-outline-color")?2:0,go.ReadOnly);yp(Pt,Bt,Ut,Gt,vr,Jt,!0)}})(dt,xt,At,It);break;case"fill-extrusion":(function(Pt,Bt,Ut,Gt){const Yt=Ut.paint.get("fill-extrusion-opacity");if(Yt!==0&&Pt.renderPass==="translucent"){const Kt=new go(Pt.context.gl.LEQUAL,go.ReadWrite,Pt.depthRangeFor3D);if(Yt!==1||Ut.paint.get("fill-extrusion-pattern").constantOr(1))jp(Pt,Bt,Ut,Gt,Kt,Oo.disabled,qo.disabled),jp(Pt,Bt,Ut,Gt,Kt,Pt.stencilModeFor3D(),Pt.colorModeForRenderPass());else{const Jt=Pt.colorModeForRenderPass();jp(Pt,Bt,Ut,Gt,Kt,Oo.disabled,Jt)}}})(dt,xt,At,It);break;case"hillshade":(function(Pt,Bt,Ut,Gt){if(Pt.renderPass!=="offscreen"&&Pt.renderPass!=="translucent")return;const Yt=Pt.context,Kt=Pt.depthModeForSublayer(0,go.ReadOnly),Jt=Pt.colorModeForRenderPass(),[sr,gr]=Pt.renderPass==="translucent"?Pt.stencilConfigForOverlap(Gt):[{},Gt];for(const vr of gr){const Ar=Bt.getTile(vr);Ar.needsHillshadePrepare!==void 0&&Ar.needsHillshadePrepare&&Pt.renderPass==="offscreen"?Nu(Pt,Ar,Ut,Kt,Oo.disabled,Jt):Pt.renderPass==="translucent"&&ku(Pt,vr,Ar,Ut,Kt,sr[vr.overscaledZ],Jt)}Yt.viewport.set([0,0,Pt.width,Pt.height])})(dt,xt,At,It);break;case"raster":(function(Pt,Bt,Ut,Gt){if(Pt.renderPass!=="translucent"||Ut.paint.get("raster-opacity")===0||!Gt.length)return;const Yt=Pt.context,Kt=Yt.gl,Jt=Bt.getSource(),sr=Pt.useProgram("raster"),gr=Pt.colorModeForRenderPass(),[vr,Ar]=Jt instanceof Mo?[{},Gt]:Pt.stencilConfigForOverlap(Gt),Er=Ar[Ar.length-1].overscaledZ,Cr=!Pt.options.moving;for(const Rr of Ar){const Sr=Pt.depthModeForSublayer(Rr.overscaledZ-Er,Ut.paint.get("raster-opacity")===1?go.ReadWrite:go.ReadOnly,Kt.LESS),Br=Bt.getTile(Rr);Br.registerFadeDuration(Ut.paint.get("raster-fade-duration"));const Gr=Bt.findLoadedParent(Rr,0),qr=Bt.findLoadedSibling(Rr),ln=Xv(Br,Gr||qr||null,Bt,Ut,Pt.transform,Pt.style.map.terrain);let mn,Cn;const On=Ut.paint.get("raster-resampling")==="nearest"?Kt.NEAREST:Kt.LINEAR;Yt.activeTexture.set(Kt.TEXTURE0),Br.texture.bind(On,Kt.CLAMP_TO_EDGE,Kt.LINEAR_MIPMAP_NEAREST),Yt.activeTexture.set(Kt.TEXTURE1),Gr?(Gr.texture.bind(On,Kt.CLAMP_TO_EDGE,Kt.LINEAR_MIPMAP_NEAREST),mn=Math.pow(2,Gr.tileID.overscaledZ-Br.tileID.overscaledZ),Cn=[Br.tileID.canonical.x*mn%1,Br.tileID.canonical.y*mn%1]):Br.texture.bind(On,Kt.CLAMP_TO_EDGE,Kt.LINEAR_MIPMAP_NEAREST),Br.texture.useMipmap&&Yt.extTextureFilterAnisotropic&&Pt.transform.pitch>20&&Kt.texParameterf(Kt.TEXTURE_2D,Yt.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Yt.extTextureFilterAnisotropicMax);const Tn=Pt.style.map.terrain&&Pt.style.map.terrain.getTerrainData(Rr),Sn=Tn?Rr:null,Un=Sn?Sn.posMatrix:Pt.transform.calculatePosMatrix(Rr.toUnwrapped(),Cr),$a=hr(Un,Cn||[0,0],mn||1,ln,Ut);Jt instanceof Mo?sr.draw(Yt,Kt.TRIANGLES,Sr,Oo.disabled,gr,Co.disabled,$a,Tn,Ut.id,Jt.boundsBuffer,Pt.quadTriangleIndexBuffer,Jt.boundsSegments):sr.draw(Yt,Kt.TRIANGLES,Sr,vr[Rr.overscaledZ],gr,Co.disabled,$a,Tn,Ut.id,Pt.rasterBoundsBuffer,Pt.quadTriangleIndexBuffer,Pt.rasterBoundsSegments)}})(dt,xt,At,It);break;case"background":(function(Pt,Bt,Ut,Gt){const Yt=Ut.paint.get("background-color"),Kt=Ut.paint.get("background-opacity");if(Kt===0)return;const Jt=Pt.context,sr=Jt.gl,gr=Pt.transform,vr=gr.tileSize,Ar=Ut.paint.get("background-pattern");if(Pt.isPatternMissing(Ar))return;const Er=!Ar&&Yt.a===1&&Kt===1&&Pt.opaquePassEnabledForLayer()?"opaque":"translucent";if(Pt.renderPass!==Er)return;const Cr=Oo.disabled,Rr=Pt.depthModeForSublayer(0,Er==="opaque"?go.ReadWrite:go.ReadOnly),Sr=Pt.colorModeForRenderPass(),Br=Pt.useProgram(Ar?"backgroundPattern":"background"),Gr=Gt||gr.coveringTiles({tileSize:vr,terrain:Pt.style.map.terrain});Ar&&(Jt.activeTexture.set(sr.TEXTURE0),Pt.imageManager.bind(Pt.context));const qr=Ut.getCrossfadeParameters();for(const ln of Gr){const mn=Gt?ln.posMatrix:Pt.transform.calculatePosMatrix(ln.toUnwrapped()),Cn=Ar?Xn(mn,Kt,Pt,Ar,{tileID:ln,tileSize:vr},qr):wn(mn,Kt,Yt),On=Pt.style.map.terrain&&Pt.style.map.terrain.getTerrainData(ln);Br.draw(Jt,sr.TRIANGLES,Rr,Cr,Sr,Co.disabled,Cn,On,Ut.id,Pt.tileExtentBuffer,Pt.quadTriangleIndexBuffer,Pt.tileExtentSegments)}})(dt,0,At,It);break;case"custom":(function(Pt,Bt,Ut){const Gt=Pt.context,Yt=Ut.implementation;if(Pt.renderPass==="offscreen"){const Kt=Yt.prerender;Kt&&(Pt.setCustomLayerDefaults(),Gt.setColorMode(Pt.colorModeForRenderPass()),Kt.call(Yt,Gt.gl,Pt.transform.customLayerMatrix()),Gt.setDirty(),Pt.setBaseState())}else if(Pt.renderPass==="translucent"){Pt.setCustomLayerDefaults(),Gt.setColorMode(Pt.colorModeForRenderPass()),Gt.setStencilMode(Oo.disabled);const Kt=Yt.renderingMode==="3d"?new go(Pt.context.gl.LEQUAL,go.ReadWrite,Pt.depthRangeFor3D):Pt.depthModeForSublayer(0,go.ReadOnly);Gt.setDepthMode(Kt),Yt.render(Gt.gl,Pt.transform.customLayerMatrix(),{farZ:Pt.transform.farZ,nearZ:Pt.transform.nearZ,fov:Pt.transform._fov,modelViewProjectionMatrix:Pt.transform.modelViewProjectionMatrix,projectionMatrix:Pt.transform.projectionMatrix}),Gt.setDirty(),Pt.setBaseState(),Gt.bindFramebuffer.set(null)}})(dt,0,At)}}translatePosMatrix(dt,xt,At,It,Pt){if(!At[0]&&!At[1])return dt;const Bt=Pt?It==="map"?this.transform.angle:0:It==="viewport"?-this.transform.angle:0;if(Bt){const Yt=Math.sin(Bt),Kt=Math.cos(Bt);At=[At[0]*Kt-At[1]*Yt,At[0]*Yt+At[1]*Kt]}const Ut=[Pt?At[0]:br(xt,At[0],this.transform.zoom),Pt?At[1]:br(xt,At[1],this.transform.zoom),0],Gt=new Float32Array(16);return it.J(Gt,dt,Ut),Gt}saveTileTexture(dt){const xt=this._tileTextures[dt.size[0]];xt?xt.push(dt):this._tileTextures[dt.size[0]]=[dt]}getTileTexture(dt){const xt=this._tileTextures[dt];return xt&&xt.length>0?xt.pop():null}isPatternMissing(dt){if(!dt)return!1;if(!dt.from||!dt.to)return!0;const xt=this.imageManager.getPattern(dt.from.toString()),At=this.imageManager.getPattern(dt.to.toString());return!xt||!At}useProgram(dt,xt){this.cache=this.cache||{};const At=dt+(xt?xt.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[At]||(this.cache[At]=new hu(this.context,Sl[dt],xt,fo[dt],this._showOverdrawInspector,this.style.map.terrain)),this.cache[At]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const dt=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(dt.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ht(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:dt,drawingBufferHeight:xt}=this.context.gl;return this.width!==dt||this.height!==xt}}class Bu{constructor(dt,xt){this.points=dt,this.planes=xt}static fromInvProjectionMatrix(dt,xt,At){const It=Math.pow(2,At),Pt=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Ut=>{const Gt=1/(Ut=it.af([],Ut,dt))[3]/xt*It;return it.b1(Ut,Ut,[Gt,Gt,1/Ut[3],Gt])}),Bt=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Ut=>{const Gt=function(sr,gr){var vr=gr[0],Ar=gr[1],Er=gr[2],Cr=vr*vr+Ar*Ar+Er*Er;return Cr>0&&(Cr=1/Math.sqrt(Cr)),sr[0]=gr[0]*Cr,sr[1]=gr[1]*Cr,sr[2]=gr[2]*Cr,sr}([],function(sr,gr,vr){var Ar=gr[0],Er=gr[1],Cr=gr[2],Rr=vr[0],Sr=vr[1],Br=vr[2];return sr[0]=Er*Br-Cr*Sr,sr[1]=Cr*Rr-Ar*Br,sr[2]=Ar*Sr-Er*Rr,sr}([],$t([],Pt[Ut[0]],Pt[Ut[1]]),$t([],Pt[Ut[2]],Pt[Ut[1]]))),Yt=-((Kt=Gt)[0]*(Jt=Pt[Ut[1]])[0]+Kt[1]*Jt[1]+Kt[2]*Jt[2]);var Kt,Jt;return Gt.concat(Yt)});return new Bu(Pt,Bt)}}class zu{constructor(dt,xt){this.min=dt,this.max=xt,this.center=function(At,It,Pt){return At[0]=.5*It[0],At[1]=.5*It[1],At[2]=.5*It[2],At}([],function(At,It,Pt){return At[0]=It[0]+Pt[0],At[1]=It[1]+Pt[1],At[2]=It[2]+Pt[2],At}([],this.min,this.max))}quadrant(dt){const xt=[dt%2==0,dt<2],At=Dt(this.min),It=Dt(this.max);for(let Pt=0;Pt<xt.length;Pt++)At[Pt]=xt[Pt]?this.min[Pt]:this.center[Pt],It[Pt]=xt[Pt]?this.center[Pt]:this.max[Pt];return It[2]=this.max[2],new zu(At,It)}distanceX(dt){return Math.max(Math.min(this.max[0],dt[0]),this.min[0])-dt[0]}distanceY(dt){return Math.max(Math.min(this.max[1],dt[1]),this.min[1])-dt[1]}intersects(dt){const xt=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let At=!0;for(let It=0;It<dt.planes.length;It++){const Pt=dt.planes[It];let Bt=0;for(let Ut=0;Ut<xt.length;Ut++)it.b2(Pt,xt[Ut])>=0&&Bt++;if(Bt===0)return 0;Bt!==xt.length&&(At=!1)}if(At)return 2;for(let It=0;It<3;It++){let Pt=Number.MAX_VALUE,Bt=-Number.MAX_VALUE;for(let Ut=0;Ut<dt.points.length;Ut++){const Gt=dt.points[Ut][It]-this.min[It];Pt=Math.min(Pt,Gt),Bt=Math.max(Bt,Gt)}if(Bt<0||Pt>this.max[It]-this.min[It])return 0}return 1}}class Vu{constructor(dt=0,xt=0,At=0,It=0){if(isNaN(dt)||dt<0||isNaN(xt)||xt<0||isNaN(At)||At<0||isNaN(It)||It<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=dt,this.bottom=xt,this.left=At,this.right=It}interpolate(dt,xt,At){return xt.top!=null&&dt.top!=null&&(this.top=it.y.number(dt.top,xt.top,At)),xt.bottom!=null&&dt.bottom!=null&&(this.bottom=it.y.number(dt.bottom,xt.bottom,At)),xt.left!=null&&dt.left!=null&&(this.left=it.y.number(dt.left,xt.left,At)),xt.right!=null&&dt.right!=null&&(this.right=it.y.number(dt.right,xt.right,At)),this}getCenter(dt,xt){const At=it.ac((this.left+dt-this.right)/2,0,dt),It=it.ac((this.top+xt-this.bottom)/2,0,xt);return new it.P(At,It)}equals(dt){return this.top===dt.top&&this.bottom===dt.bottom&&this.left===dt.left&&this.right===dt.right}clone(){return new Vu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Gm=85.051129;class Uu{constructor(dt,xt,At,It,Pt){this.tileSize=512,this._renderWorldCopies=Pt===void 0||!!Pt,this._minZoom=dt||0,this._maxZoom=xt||22,this._minPitch=At??0,this._maxPitch=It??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new it.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Vu,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const dt=new Uu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return dt.apply(this),dt}apply(dt){this.tileSize=dt.tileSize,this.latRange=dt.latRange,this.lngRange=dt.lngRange,this.width=dt.width,this.height=dt.height,this._center=dt._center,this._elevation=dt._elevation,this.minElevationForCurrentTile=dt.minElevationForCurrentTile,this.zoom=dt.zoom,this.angle=dt.angle,this._fov=dt._fov,this._pitch=dt._pitch,this._unmodified=dt._unmodified,this._edgeInsets=dt._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(dt){this._minZoom!==dt&&(this._minZoom=dt,this.zoom=Math.max(this.zoom,dt))}get maxZoom(){return this._maxZoom}set maxZoom(dt){this._maxZoom!==dt&&(this._maxZoom=dt,this.zoom=Math.min(this.zoom,dt))}get minPitch(){return this._minPitch}set minPitch(dt){this._minPitch!==dt&&(this._minPitch=dt,this.pitch=Math.max(this.pitch,dt))}get maxPitch(){return this._maxPitch}set maxPitch(dt){this._maxPitch!==dt&&(this._maxPitch=dt,this.pitch=Math.min(this.pitch,dt))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(dt){dt===void 0?dt=!0:dt===null&&(dt=!1),this._renderWorldCopies=dt}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new it.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(dt){const xt=-it.b3(dt,-180,180)*Math.PI/180;this.angle!==xt&&(this._unmodified=!1,this.angle=xt,this._calcMatrices(),this.rotationMatrix=function(){var At=new it.A(4);return it.A!=Float32Array&&(At[1]=0,At[2]=0),At[0]=1,At[3]=1,At}(),function(At,It,Pt){var Bt=It[0],Ut=It[1],Gt=It[2],Yt=It[3],Kt=Math.sin(Pt),Jt=Math.cos(Pt);At[0]=Bt*Jt+Gt*Kt,At[1]=Ut*Jt+Yt*Kt,At[2]=Bt*-Kt+Gt*Jt,At[3]=Ut*-Kt+Yt*Jt}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(dt){const xt=it.ac(dt,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==xt&&(this._unmodified=!1,this._pitch=xt,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(dt){dt=Math.max(.01,Math.min(60,dt)),this._fov!==dt&&(this._unmodified=!1,this._fov=dt/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(dt){const xt=Math.min(Math.max(dt,this.minZoom),this.maxZoom);this._zoom!==xt&&(this._unmodified=!1,this._zoom=xt,this.tileZoom=Math.max(0,Math.floor(xt)),this.scale=this.zoomScale(xt),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(dt){dt.lat===this._center.lat&&dt.lng===this._center.lng||(this._unmodified=!1,this._center=dt,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(dt){dt!==this._elevation&&(this._elevation=dt,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(dt){this._edgeInsets.equals(dt)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,dt,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(dt){return this._edgeInsets.equals(dt)}interpolatePadding(dt,xt,At){this._unmodified=!1,this._edgeInsets.interpolate(dt,xt,At),this._constrain(),this._calcMatrices()}coveringZoomLevel(dt){const xt=(dt.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/dt.tileSize));return Math.max(0,xt)}getVisibleUnwrappedCoordinates(dt){const xt=[new it.b4(0,dt)];if(this._renderWorldCopies){const At=this.pointCoordinate(new it.P(0,0)),It=this.pointCoordinate(new it.P(this.width,0)),Pt=this.pointCoordinate(new it.P(this.width,this.height)),Bt=this.pointCoordinate(new it.P(0,this.height)),Ut=Math.floor(Math.min(At.x,It.x,Pt.x,Bt.x)),Gt=Math.floor(Math.max(At.x,It.x,Pt.x,Bt.x)),Yt=1;for(let Kt=Ut-Yt;Kt<=Gt+Yt;Kt++)Kt!==0&&xt.push(new it.b4(Kt,dt))}return xt}coveringTiles(dt){var xt,At;let It=this.coveringZoomLevel(dt);const Pt=It;if(dt.minzoom!==void 0&&It<dt.minzoom)return[];dt.maxzoom!==void 0&&It>dt.maxzoom&&(It=dt.maxzoom);const Bt=this.pointCoordinate(this.getCameraPoint()),Ut=it.Z.fromLngLat(this.center),Gt=Math.pow(2,It),Yt=[Gt*Bt.x,Gt*Bt.y,0],Kt=[Gt*Ut.x,Gt*Ut.y,0],Jt=Bu.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,It);let sr=dt.minzoom||0;!dt.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(sr=It);const gr=dt.terrain?2/Math.min(this.tileSize,dt.tileSize)*this.tileSize:3,vr=Sr=>({aabb:new zu([Sr*Gt,0,0],[(Sr+1)*Gt,Gt,0]),zoom:0,x:0,y:0,wrap:Sr,fullyVisible:!1}),Ar=[],Er=[],Cr=It,Rr=dt.reparseOverscaled?Pt:It;if(this._renderWorldCopies)for(let Sr=1;Sr<=3;Sr++)Ar.push(vr(-Sr)),Ar.push(vr(Sr));for(Ar.push(vr(0));Ar.length>0;){const Sr=Ar.pop(),Br=Sr.x,Gr=Sr.y;let qr=Sr.fullyVisible;if(!qr){const Tn=Sr.aabb.intersects(Jt);if(Tn===0)continue;qr=Tn===2}const ln=dt.terrain?Yt:Kt,mn=Sr.aabb.distanceX(ln),Cn=Sr.aabb.distanceY(ln),On=Math.max(Math.abs(mn),Math.abs(Cn));if(Sr.zoom===Cr||On>gr+(1<<Cr-Sr.zoom)-2&&Sr.zoom>=sr){const Tn=Cr-Sr.zoom,Sn=Yt[0]-.5-(Br<<Tn),Un=Yt[1]-.5-(Gr<<Tn);Er.push({tileID:new it.S(Sr.zoom===Cr?Rr:Sr.zoom,Sr.wrap,Sr.zoom,Br,Gr),distanceSq:Ft([Kt[0]-.5-Br,Kt[1]-.5-Gr]),tileDistanceToCamera:Math.sqrt(Sn*Sn+Un*Un)})}else for(let Tn=0;Tn<4;Tn++){const Sn=(Br<<1)+Tn%2,Un=(Gr<<1)+(Tn>>1),$a=Sr.zoom+1;let In=Sr.aabb.quadrant(Tn);if(dt.terrain){const Mn=new it.S($a,Sr.wrap,$a,Sn,Un),ba=dt.terrain.getMinMaxElevation(Mn),Fo=(xt=ba.minElevation)!==null&&xt!==void 0?xt:this.elevation,uo=(At=ba.maxElevation)!==null&&At!==void 0?At:this.elevation;In=new zu([In.min[0],In.min[1],Fo],[In.max[0],In.max[1],uo])}Ar.push({aabb:In,zoom:$a,x:Sn,y:Un,wrap:Sr.wrap,fullyVisible:qr})}}return Er.sort((Sr,Br)=>Sr.distanceSq-Br.distanceSq).map(Sr=>Sr.tileID)}resize(dt,xt){this.width=dt,this.height=xt,this.pixelsToGLUnits=[2/dt,-2/xt],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(dt){return Math.pow(2,dt)}scaleZoom(dt){return Math.log(dt)/Math.LN2}project(dt){const xt=it.ac(dt.lat,-85.051129,Gm);return new it.P(it.O(dt.lng)*this.worldSize,it.Q(xt)*this.worldSize)}unproject(dt){return new it.Z(dt.x/this.worldSize,dt.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(dt){const xt=this.elevation,At=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,It=this.pointLocation(this.centerPoint,dt),Pt=dt.getElevationForLngLatZoom(It,this.tileZoom);if(!(this.elevation-Pt))return;const Bt=At+xt-Pt,Ut=Math.cos(this._pitch)*this.cameraToCenterDistance/Bt/it.b5(1,It.lat),Gt=this.scaleZoom(Ut/this.tileSize);this._elevation=Pt,this._center=It,this.zoom=Gt}setLocationAtPoint(dt,xt){const At=this.pointCoordinate(xt),It=this.pointCoordinate(this.centerPoint),Pt=this.locationCoordinate(dt),Bt=new it.Z(Pt.x-(At.x-It.x),Pt.y-(At.y-It.y));this.center=this.coordinateLocation(Bt),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(dt,xt){return xt?this.coordinatePoint(this.locationCoordinate(dt),xt.getElevationForLngLatZoom(dt,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(dt))}pointLocation(dt,xt){return this.coordinateLocation(this.pointCoordinate(dt,xt))}locationCoordinate(dt){return it.Z.fromLngLat(dt)}coordinateLocation(dt){return dt&&dt.toLngLat()}pointCoordinate(dt,xt){if(xt){const sr=xt.pointCoordinate(dt);if(sr!=null)return sr}const At=[dt.x,dt.y,0,1],It=[dt.x,dt.y,1,1];it.af(At,At,this.pixelMatrixInverse),it.af(It,It,this.pixelMatrixInverse);const Pt=At[3],Bt=It[3],Ut=At[1]/Pt,Gt=It[1]/Bt,Yt=At[2]/Pt,Kt=It[2]/Bt,Jt=Yt===Kt?0:(0-Yt)/(Kt-Yt);return new it.Z(it.y.number(At[0]/Pt,It[0]/Bt,Jt)/this.worldSize,it.y.number(Ut,Gt,Jt)/this.worldSize)}coordinatePoint(dt,xt=0,At=this.pixelMatrix){const It=[dt.x*this.worldSize,dt.y*this.worldSize,xt,1];return it.af(It,It,At),new it.P(It[0]/It[3],It[1]/It[3])}getBounds(){const dt=Math.max(0,this.height/2-this.getHorizon());return new zr().extend(this.pointLocation(new it.P(0,dt))).extend(this.pointLocation(new it.P(this.width,dt))).extend(this.pointLocation(new it.P(this.width,this.height))).extend(this.pointLocation(new it.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new zr([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(dt){dt?(this.lngRange=[dt.getWest(),dt.getEast()],this.latRange=[dt.getSouth(),dt.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Gm])}calculateTileMatrix(dt){const xt=dt.canonical,At=this.worldSize/this.zoomScale(xt.z),It=xt.x+Math.pow(2,xt.z)*dt.wrap,Pt=it.an(new Float64Array(16));return it.J(Pt,Pt,[It*At,xt.y*At,0]),it.K(Pt,Pt,[At/it.X,At/it.X,1]),Pt}calculatePosMatrix(dt,xt=!1){const At=dt.key,It=xt?this._alignedPosMatrixCache:this._posMatrixCache;if(It[At])return It[At];const Pt=this.calculateTileMatrix(dt);return it.L(Pt,xt?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,Pt),It[At]=new Float32Array(Pt),It[At]}calculateFogMatrix(dt){const xt=dt.key,At=this._fogMatrixCache;if(At[xt])return At[xt];const It=this.calculateTileMatrix(dt);return it.L(It,this.fogMatrix,It),At[xt]=new Float32Array(It),At[xt]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(dt,xt){xt=it.ac(+xt,this.minZoom,this.maxZoom);const At={center:new it.N(dt.lng,dt.lat),zoom:xt};let It=this.lngRange;if(!this._renderWorldCopies&&It===null){const Sr=179.9999999999;It=[-Sr,Sr]}const Pt=this.tileSize*this.zoomScale(At.zoom);let Bt=0,Ut=Pt,Gt=0,Yt=Pt,Kt=0,Jt=0;const{x:sr,y:gr}=this.size;if(this.latRange){const Sr=this.latRange;Bt=it.Q(Sr[1])*Pt,Ut=it.Q(Sr[0])*Pt,Ut-Bt<gr&&(Kt=gr/(Ut-Bt))}It&&(Gt=it.b3(it.O(It[0])*Pt,0,Pt),Yt=it.b3(it.O(It[1])*Pt,0,Pt),Yt<Gt&&(Yt+=Pt),Yt-Gt<sr&&(Jt=sr/(Yt-Gt)));const{x:vr,y:Ar}=this.project.call({worldSize:Pt},dt);let Er,Cr;const Rr=Math.max(Jt||0,Kt||0);if(Rr){const Sr=new it.P(Jt?(Yt+Gt)/2:vr,Kt?(Ut+Bt)/2:Ar);return At.center=this.unproject.call({worldSize:Pt},Sr).wrap(),At.zoom+=this.scaleZoom(Rr),At}if(this.latRange){const Sr=gr/2;Ar-Sr<Bt&&(Cr=Bt+Sr),Ar+Sr>Ut&&(Cr=Ut-Sr)}if(It){const Sr=(Gt+Yt)/2;let Br=vr;this._renderWorldCopies&&(Br=it.b3(vr,Sr-Pt/2,Sr+Pt/2));const Gr=sr/2;Br-Gr<Gt&&(Er=Gt+Gr),Br+Gr>Yt&&(Er=Yt-Gr)}if(Er!==void 0||Cr!==void 0){const Sr=new it.P(Er??vr,Cr??Ar);At.center=this.unproject.call({worldSize:Pt},Sr).wrap()}return At}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const dt=this._unmodified,{center:xt,zoom:At}=this.getConstrained(this.center,this.zoom);this.center=xt,this.zoom=At,this._unmodified=dt,this._constraining=!1}_calcMatrices(){if(!this.height)return;const dt=this.centerOffset,xt=this.point.x,At=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=it.b5(1,this.center.lat)*this.worldSize;let It=it.an(new Float64Array(16));it.K(It,It,[this.width/2,-this.height/2,1]),it.J(It,It,[1,-1,0]),this.labelPlaneMatrix=It,It=it.an(new Float64Array(16)),it.K(It,It,[1,-1,1]),it.J(It,It,[-1,-1,0]),it.K(It,It,[2/this.width,2/this.height,1]),this.glCoordMatrix=It;const Pt=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),Bt=Math.min(this.elevation,this.minElevationForCurrentTile),Ut=Pt-Bt*this._pixelPerMeter/Math.cos(this._pitch),Gt=Bt<0?Ut:Pt,Yt=Math.PI/2+this._pitch,Kt=this._fov*(.5+dt.y/this.height),Jt=Math.sin(Kt)*Gt/Math.sin(it.ac(Math.PI-Yt-Kt,.01,Math.PI-.01)),sr=this.getHorizon(),gr=2*Math.atan(sr/this.cameraToCenterDistance)*(.5+dt.y/(2*sr)),vr=Math.sin(gr)*Gt/Math.sin(it.ac(Math.PI-Yt-gr,.01,Math.PI-.01)),Ar=Math.min(Jt,vr);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Ar+Gt),this.nearZ=this.height/50,It=new Float64Array(16),it.b6(It,this._fov,this.width/this.height,this.nearZ,this.farZ),It[8]=2*-dt.x/this.width,It[9]=2*dt.y/this.height,this.projectionMatrix=it.ae(It),it.K(It,It,[1,-1,1]),it.J(It,It,[0,0,-this.cameraToCenterDistance]),it.b7(It,It,this._pitch),it.ad(It,It,this.angle),it.J(It,It,[-xt,-At,0]),this.mercatorMatrix=it.K([],It,[this.worldSize,this.worldSize,this.worldSize]),it.K(It,It,[1,1,this._pixelPerMeter]),this.pixelMatrix=it.L(new Float64Array(16),this.labelPlaneMatrix,It),it.J(It,It,[0,0,-this.elevation]),this.modelViewProjectionMatrix=It,this.invModelViewProjectionMatrix=it.as([],It),this.fogMatrix=new Float64Array(16),it.b6(this.fogMatrix,this._fov,this.width/this.height,Pt,this.farZ),this.fogMatrix[8]=2*-dt.x/this.width,this.fogMatrix[9]=2*dt.y/this.height,it.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),it.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),it.b7(this.fogMatrix,this.fogMatrix,this._pitch),it.ad(this.fogMatrix,this.fogMatrix,this.angle),it.J(this.fogMatrix,this.fogMatrix,[-xt,-At,0]),it.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),it.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=it.L(new Float64Array(16),this.labelPlaneMatrix,It);const Er=this.width%2/2,Cr=this.height%2/2,Rr=Math.cos(this.angle),Sr=Math.sin(this.angle),Br=xt-Math.round(xt)+Rr*Er+Sr*Cr,Gr=At-Math.round(At)+Rr*Cr+Sr*Er,qr=new Float64Array(It);if(it.J(qr,qr,[Br>.5?Br-1:Br,Gr>.5?Gr-1:Gr,0]),this.alignedModelViewProjectionMatrix=qr,It=it.as(new Float64Array(16),this.pixelMatrix),!It)throw new Error("failed to invert matrix");this.pixelMatrixInverse=It,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const dt=this.pointCoordinate(new it.P(0,0)),xt=[dt.x*this.worldSize,dt.y*this.worldSize,0,1];return it.af(xt,xt,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const dt=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new it.P(0,dt))}getCameraQueryGeometry(dt){const xt=this.getCameraPoint();if(dt.length===1)return[dt[0],xt];{let At=xt.x,It=xt.y,Pt=xt.x,Bt=xt.y;for(const Ut of dt)At=Math.min(At,Ut.x),It=Math.min(It,Ut.y),Pt=Math.max(Pt,Ut.x),Bt=Math.max(Bt,Ut.y);return[new it.P(At,It),new it.P(Pt,It),new it.P(Pt,Bt),new it.P(At,Bt),new it.P(At,It)]}}lngLatToCameraDepth(dt,xt){const At=this.locationCoordinate(dt),It=[At.x*this.worldSize,At.y*this.worldSize,xt,1];return it.af(It,It,this.modelViewProjectionMatrix),It[2]/It[3]}}function bp(Mt,dt){let xt,At=!1,It=null,Pt=null;const Bt=()=>{It=null,At&&(Mt.apply(Pt,xt),It=setTimeout(Bt,dt),At=!1)};return(...Ut)=>(At=!0,Pt=this,xt=Ut,It||Bt(),It)}class Zp{constructor(dt){this._getCurrentHash=()=>{const xt=window.location.hash.replace("#","");if(this._hashName){let At;return xt.split("&").map(It=>It.split("=")).forEach(It=>{It[0]===this._hashName&&(At=It)}),(At&&At[1]||"").split("/")}return xt.split("/")},this._onHashChange=()=>{const xt=this._getCurrentHash();if(xt.length>=3&&!xt.some(At=>isNaN(At))){const At=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(xt[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+xt[2],+xt[1]],zoom:+xt[0],bearing:At,pitch:+(xt[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const xt=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,xt)},this._removeHash=()=>{const xt=this._getCurrentHash();if(xt.length===0)return;const At=xt.join("/");let It=At;It.split("&").length>0&&(It=It.split("&")[0]),this._hashName&&(It=`${this._hashName}=${At}`);let Pt=window.location.hash.replace(It,"");Pt.startsWith("#&")?Pt=Pt.slice(0,1)+Pt.slice(2):Pt==="#"&&(Pt="");let Bt=window.location.href.replace(/(#.+)?$/,Pt);Bt=Bt.replace("&&","&"),window.history.replaceState(window.history.state,null,Bt)},this._updateHash=bp(this._updateHashUnthrottled,300),this._hashName=dt&&encodeURIComponent(dt)}addTo(dt){return this._map=dt,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(dt){const xt=this._map.getCenter(),At=Math.round(100*this._map.getZoom())/100,It=Math.ceil((At*Math.LN2+Math.log(512/360/.5))/Math.LN10),Pt=Math.pow(10,It),Bt=Math.round(xt.lng*Pt)/Pt,Ut=Math.round(xt.lat*Pt)/Pt,Gt=this._map.getBearing(),Yt=this._map.getPitch();let Kt="";if(Kt+=dt?`/${Bt}/${Ut}/${At}`:`${At}/${Ut}/${Bt}`,(Gt||Yt)&&(Kt+="/"+Math.round(10*Gt)/10),Yt&&(Kt+=`/${Math.round(Yt)}`),this._hashName){const Jt=this._hashName;let sr=!1;const gr=window.location.hash.slice(1).split("&").map(vr=>{const Ar=vr.split("=")[0];return Ar===Jt?(sr=!0,`${Ar}=${Kt}`):vr}).filter(vr=>vr);return sr||gr.push(`${Jt}=${Kt}`),`#${gr.join("&")}`}return`#${Kt}`}}const Xp={linearity:.3,easing:it.b8(0,0,.3,1)},jm=it.e({deceleration:2500,maxSpeed:1400},Xp),jy=it.e({deceleration:20,maxSpeed:1400},Xp),ty=it.e({deceleration:1e3,maxSpeed:360},Xp),Kp=it.e({deceleration:1e3,maxSpeed:90},Xp);class Hm{constructor(dt){this._map=dt,this.clear()}clear(){this._inertiaBuffer=[]}record(dt){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ot.now(),settings:dt})}_drainInertiaBuffer(){const dt=this._inertiaBuffer,xt=ot.now();for(;dt.length>0&&xt-dt[0].time>160;)dt.shift()}_onMoveEnd(dt){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const xt={zoom:0,bearing:0,pitch:0,pan:new it.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:Pt}of this._inertiaBuffer)xt.zoom+=Pt.zoomDelta||0,xt.bearing+=Pt.bearingDelta||0,xt.pitch+=Pt.pitchDelta||0,Pt.panDelta&&xt.pan._add(Pt.panDelta),Pt.around&&(xt.around=Pt.around),Pt.pinchAround&&(xt.pinchAround=Pt.pinchAround);const At=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,It={};if(xt.pan.mag()){const Pt=wp(xt.pan.mag(),At,it.e({},jm,dt||{}));It.offset=xt.pan.mult(Pt.amount/xt.pan.mag()),It.center=this._map.transform.center,xp(It,Pt)}if(xt.zoom){const Pt=wp(xt.zoom,At,jy);It.zoom=this._map.transform.zoom+Pt.amount,xp(It,Pt)}if(xt.bearing){const Pt=wp(xt.bearing,At,ty);It.bearing=this._map.transform.bearing+it.ac(Pt.amount,-179,179),xp(It,Pt)}if(xt.pitch){const Pt=wp(xt.pitch,At,Kp);It.pitch=this._map.transform.pitch+Pt.amount,xp(It,Pt)}if(It.zoom||It.bearing){const Pt=xt.pinchAround===void 0?xt.around:xt.pinchAround;It.around=Pt?this._map.unproject(Pt):this._map.getCenter()}return this.clear(),it.e(It,{noMoveStart:!0})}}function xp(Mt,dt){(!Mt.duration||Mt.duration<dt.duration)&&(Mt.duration=dt.duration,Mt.easing=dt.easing)}function wp(Mt,dt,xt){const{maxSpeed:At,linearity:It,deceleration:Pt}=xt,Bt=it.ac(Mt*It/(dt/1e3),-At,At),Ut=Math.abs(Bt)/(Pt*It);return{easing:xt.easing,duration:1e3*Ut,amount:Bt*(Ut/2)}}class ys extends it.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(dt,xt,At,It={}){const Pt=at.mousePos(xt.getCanvas(),At),Bt=xt.unproject(Pt);super(dt,it.e({point:Pt,lngLat:Bt,originalEvent:At},It)),this._defaultPrevented=!1,this.target=xt}}class Tu extends it.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(dt,xt,At){const It=dt==="touchend"?At.changedTouches:At.touches,Pt=at.touchPos(xt.getCanvasContainer(),It),Bt=Pt.map(Gt=>xt.unproject(Gt)),Ut=Pt.reduce((Gt,Yt,Kt,Jt)=>Gt.add(Yt.div(Jt.length)),new it.P(0,0));super(dt,{points:Pt,point:Ut,lngLats:Bt,lngLat:xt.unproject(Ut),originalEvent:At}),this._defaultPrevented=!1}}class ry extends it.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(dt,xt,At){super(dt,{originalEvent:At}),this._defaultPrevented=!1}}class ny{constructor(dt,xt){this._map=dt,this._clickTolerance=xt.clickTolerance}reset(){delete this._mousedownPos}wheel(dt){return this._firePreventable(new ry(dt.type,this._map,dt))}mousedown(dt,xt){return this._mousedownPos=xt,this._firePreventable(new ys(dt.type,this._map,dt))}mouseup(dt){this._map.fire(new ys(dt.type,this._map,dt))}click(dt,xt){this._mousedownPos&&this._mousedownPos.dist(xt)>=this._clickTolerance||this._map.fire(new ys(dt.type,this._map,dt))}dblclick(dt){return this._firePreventable(new ys(dt.type,this._map,dt))}mouseover(dt){this._map.fire(new ys(dt.type,this._map,dt))}mouseout(dt){this._map.fire(new ys(dt.type,this._map,dt))}touchstart(dt){return this._firePreventable(new Tu(dt.type,this._map,dt))}touchmove(dt){this._map.fire(new Tu(dt.type,this._map,dt))}touchend(dt){this._map.fire(new Tu(dt.type,this._map,dt))}touchcancel(dt){this._map.fire(new Tu(dt.type,this._map,dt))}_firePreventable(dt){if(this._map.fire(dt),dt.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zo{constructor(dt){this._map=dt}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(dt){this._map.fire(new ys(dt.type,this._map,dt))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ys("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(dt){this._delayContextMenu?this._contextMenuEvent=dt:this._ignoreContextMenu||this._map.fire(new ys(dt.type,this._map,dt)),this._map.listens("contextmenu")&&dt.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Al{constructor(dt){this._map=dt}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(dt){return this.transform.pointLocation(it.P.convert(dt),this._map.terrain)}}class Gs{constructor(dt,xt){this._map=dt,this._tr=new Al(dt),this._el=dt.getCanvasContainer(),this._container=dt.getContainer(),this._clickTolerance=xt.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(dt,xt){this.isEnabled()&&dt.shiftKey&&dt.button===0&&(at.disableDrag(),this._startPos=this._lastPos=xt,this._active=!0)}mousemoveWindow(dt,xt){if(!this._active)return;const At=xt;if(this._lastPos.equals(At)||!this._box&&At.dist(this._startPos)<this._clickTolerance)return;const It=this._startPos;this._lastPos=At,this._box||(this._box=at.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",dt));const Pt=Math.min(It.x,At.x),Bt=Math.max(It.x,At.x),Ut=Math.min(It.y,At.y),Gt=Math.max(It.y,At.y);at.setTransform(this._box,`translate(${Pt}px,${Ut}px)`),this._box.style.width=Bt-Pt+"px",this._box.style.height=Gt-Ut+"px"}mouseupWindow(dt,xt){if(!this._active||dt.button!==0)return;const At=this._startPos,It=xt;if(this.reset(),at.suppressClick(),At.x!==It.x||At.y!==It.y)return this._map.fire(new it.k("boxzoomend",{originalEvent:dt})),{cameraAnimation:Pt=>Pt.fitScreenCoordinates(At,It,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",dt)}keydown(dt){this._active&&dt.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",dt))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(at.remove(this._box),this._box=null),at.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(dt,xt){return this._map.fire(new it.k(dt,{originalEvent:xt}))}}function Sp(Mt,dt){if(Mt.length!==dt.length)throw new Error(`The number of touches and points are not equal - touches ${Mt.length}, points ${dt.length}`);const xt={};for(let At=0;At<Mt.length;At++)xt[Mt[At].identifier]=dt[At];return xt}class Wm{constructor(dt){this.reset(),this.numTouches=dt.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(dt,xt,At){(this.centroid||At.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=dt.timeStamp),At.length===this.numTouches&&(this.centroid=function(It){const Pt=new it.P(0,0);for(const Bt of It)Pt._add(Bt);return Pt.div(It.length)}(xt),this.touches=Sp(At,xt)))}touchmove(dt,xt,At){if(this.aborted||!this.centroid)return;const It=Sp(At,xt);for(const Pt in this.touches){const Bt=It[Pt];(!Bt||Bt.dist(this.touches[Pt])>30)&&(this.aborted=!0)}}touchend(dt,xt,At){if((!this.centroid||dt.timeStamp-this.startTime>500)&&(this.aborted=!0),At.length===0){const It=!this.aborted&&this.centroid;if(this.reset(),It)return It}}}class Jp{constructor(dt){this.singleTap=new Wm(dt),this.numTaps=dt.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(dt,xt,At){this.singleTap.touchstart(dt,xt,At)}touchmove(dt,xt,At){this.singleTap.touchmove(dt,xt,At)}touchend(dt,xt,At){const It=this.singleTap.touchend(dt,xt,At);if(It){const Pt=dt.timeStamp-this.lastTime<500,Bt=!this.lastTap||this.lastTap.dist(It)<30;if(Pt&&Bt||this.reset(),this.count++,this.lastTime=dt.timeStamp,this.lastTap=It,this.count===this.numTaps)return this.reset(),It}}}class Gu{constructor(dt){this._tr=new Al(dt),this._zoomIn=new Jp({numTouches:1,numTaps:2}),this._zoomOut=new Jp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(dt,xt,At){this._zoomIn.touchstart(dt,xt,At),this._zoomOut.touchstart(dt,xt,At)}touchmove(dt,xt,At){this._zoomIn.touchmove(dt,xt,At),this._zoomOut.touchmove(dt,xt,At)}touchend(dt,xt,At){const It=this._zoomIn.touchend(dt,xt,At),Pt=this._zoomOut.touchend(dt,xt,At),Bt=this._tr;return It?(this._active=!0,dt.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:Ut=>Ut.easeTo({duration:300,zoom:Bt.zoom+1,around:Bt.unproject(It)},{originalEvent:dt})}):Pt?(this._active=!0,dt.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:Ut=>Ut.easeTo({duration:300,zoom:Bt.zoom-1,around:Bt.unproject(Pt)},{originalEvent:dt})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xl{constructor(dt){this._enabled=!!dt.enable,this._moveStateManager=dt.moveStateManager,this._clickTolerance=dt.clickTolerance||1,this._moveFunction=dt.move,this._activateOnStart=!!dt.activateOnStart,dt.assignEvents(this),this.reset()}reset(dt){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(dt)}_move(...dt){const xt=this._moveFunction(...dt);if(xt.bearingDelta||xt.pitchDelta||xt.around||xt.panDelta)return this._active=!0,xt}dragStart(dt,xt){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(dt)&&(this._moveStateManager.startMove(dt),this._lastPoint=xt.length?xt[0]:xt,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(dt,xt){if(!this.isEnabled())return;const At=this._lastPoint;if(!At)return;if(dt.preventDefault(),!this._moveStateManager.isValidMoveEvent(dt))return void this.reset(dt);const It=xt.length?xt[0]:xt;return!this._moved&&It.dist(At)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=It,this._move(At,It))}dragEnd(dt){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(dt)&&(this._moved&&at.suppressClick(),this.reset(dt))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ym={0:1,2:2};class Qp{constructor(dt){this._correctEvent=dt.checkCorrectEvent}startMove(dt){const xt=at.mouseButton(dt);this._eventButton=xt}endMove(dt){delete this._eventButton}isValidStartEvent(dt){return this._correctEvent(dt)}isValidMoveEvent(dt){return!function(xt,At){const It=Ym[At];return xt.buttons===void 0||(xt.buttons&It)!==It}(dt,this._eventButton)}isValidEndEvent(dt){return at.mouseButton(dt)===this._eventButton}}class qm{constructor(){this._firstTouch=void 0}_isOneFingerTouch(dt){return dt.targetTouches.length===1}_isSameTouchEvent(dt){return dt.targetTouches[0].identifier===this._firstTouch}startMove(dt){this._firstTouch=dt.targetTouches[0].identifier}endMove(dt){delete this._firstTouch}isValidStartEvent(dt){return this._isOneFingerTouch(dt)}isValidMoveEvent(dt){return this._isOneFingerTouch(dt)&&this._isSameTouchEvent(dt)}isValidEndEvent(dt){return this._isOneFingerTouch(dt)&&this._isSameTouchEvent(dt)}}const em=Mt=>{Mt.mousedown=Mt.dragStart,Mt.mousemoveWindow=Mt.dragMove,Mt.mouseup=Mt.dragEnd,Mt.contextmenu=dt=>{dt.preventDefault()}},Zm=({enable:Mt,clickTolerance:dt,bearingDegreesPerPixelMoved:xt=.8})=>{const At=new Qp({checkCorrectEvent:It=>at.mouseButton(It)===0&&It.ctrlKey||at.mouseButton(It)===2});return new Xl({clickTolerance:dt,move:(It,Pt)=>({bearingDelta:(Pt.x-It.x)*xt}),moveStateManager:At,enable:Mt,assignEvents:em})},Xm=({enable:Mt,clickTolerance:dt,pitchDegreesPerPixelMoved:xt=-.5})=>{const At=new Qp({checkCorrectEvent:It=>at.mouseButton(It)===0&&It.ctrlKey||at.mouseButton(It)===2});return new Xl({clickTolerance:dt,move:(It,Pt)=>({pitchDelta:(Pt.y-It.y)*xt}),moveStateManager:At,enable:Mt,assignEvents:em})};class Au{constructor(dt,xt){this._clickTolerance=dt.clickTolerance||1,this._map=xt,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new it.P(0,0)}_shouldBePrevented(dt){return dt<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(dt,xt,At){return this._calculateTransform(dt,xt,At)}touchmove(dt,xt,At){if(this._active){if(!this._shouldBePrevented(At.length))return dt.preventDefault(),this._calculateTransform(dt,xt,At);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",dt)}}touchend(dt,xt,At){this._calculateTransform(dt,xt,At),this._active&&this._shouldBePrevented(At.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(dt,xt,At){At.length>0&&(this._active=!0);const It=Sp(At,xt),Pt=new it.P(0,0),Bt=new it.P(0,0);let Ut=0;for(const Yt in It){const Kt=It[Yt],Jt=this._touches[Yt];Jt&&(Pt._add(Kt),Bt._add(Kt.sub(Jt)),Ut++,It[Yt]=Kt)}if(this._touches=It,this._shouldBePrevented(Ut)||!Bt.mag())return;const Gt=Bt.div(Ut);return this._sum._add(Gt),this._sum.mag()<this._clickTolerance?void 0:{around:Pt.div(Ut),panDelta:Gt}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tm{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(dt,xt,At){this._firstTwoTouches||At.length<2||(this._firstTwoTouches=[At[0].identifier,At[1].identifier],this._start([xt[0],xt[1]]))}touchmove(dt,xt,At){if(!this._firstTwoTouches)return;dt.preventDefault();const[It,Pt]=this._firstTwoTouches,Bt=Tp(At,xt,It),Ut=Tp(At,xt,Pt);if(!Bt||!Ut)return;const Gt=this._aroundCenter?null:Bt.add(Ut).div(2);return this._move([Bt,Ut],Gt,dt)}touchend(dt,xt,At){if(!this._firstTwoTouches)return;const[It,Pt]=this._firstTwoTouches,Bt=Tp(At,xt,It),Ut=Tp(At,xt,Pt);Bt&&Ut||(this._active&&at.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(dt){this._enabled=!0,this._aroundCenter=!!dt&&dt.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Tp(Mt,dt,xt){for(let At=0;At<Mt.length;At++)if(Mt[At].identifier===xt)return dt[At]}function Km(Mt,dt){return Math.log(Mt/dt)/Math.LN2}class Jm extends tm{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(dt){this._startDistance=this._distance=dt[0].dist(dt[1])}_move(dt,xt){const At=this._distance;if(this._distance=dt[0].dist(dt[1]),this._active||!(Math.abs(Km(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Km(this._distance,At),pinchAround:xt}}}function Qm(Mt,dt){return 180*Mt.angleWith(dt)/Math.PI}class ev extends tm{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(dt){this._startVector=this._vector=dt[0].sub(dt[1]),this._minDiameter=dt[0].dist(dt[1])}_move(dt,xt,At){const It=this._vector;if(this._vector=dt[0].sub(dt[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qm(this._vector,It),pinchAround:xt}}_isBelowThreshold(dt){this._minDiameter=Math.min(this._minDiameter,dt.mag());const xt=25/(Math.PI*this._minDiameter)*360,At=Qm(dt,this._startVector);return Math.abs(At)<xt}}function rm(Mt){return Math.abs(Mt.y)>Math.abs(Mt.x)}class Ap extends tm{constructor(dt){super(),this._currentTouchCount=0,this._map=dt}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(dt,xt,At){super.touchstart(dt,xt,At),this._currentTouchCount=At.length}_start(dt){this._lastPoints=dt,rm(dt[0].sub(dt[1]))&&(this._valid=!1)}_move(dt,xt,At){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const It=dt[0].sub(this._lastPoints[0]),Pt=dt[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(It,Pt,At.timeStamp),this._valid?(this._lastPoints=dt,this._active=!0,{pitchDelta:(It.y+Pt.y)/2*-.5}):void 0}gestureBeginsVertically(dt,xt,At){if(this._valid!==void 0)return this._valid;const It=dt.mag()>=2,Pt=xt.mag()>=2;if(!It&&!Pt)return;if(!It||!Pt)return this._firstMove===void 0&&(this._firstMove=At),At-this._firstMove<100&&void 0;const Bt=dt.y>0==xt.y>0;return rm(dt)&&rm(xt)&&Bt}}const iy={panStep:100,bearingStep:15,pitchStep:10};class Xs{constructor(dt){this._tr=new Al(dt);const xt=iy;this._panStep=xt.panStep,this._bearingStep=xt.bearingStep,this._pitchStep=xt.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(dt){if(dt.altKey||dt.ctrlKey||dt.metaKey)return;let xt=0,At=0,It=0,Pt=0,Bt=0;switch(dt.keyCode){case 61:case 107:case 171:case 187:xt=1;break;case 189:case 109:case 173:xt=-1;break;case 37:dt.shiftKey?At=-1:(dt.preventDefault(),Pt=-1);break;case 39:dt.shiftKey?At=1:(dt.preventDefault(),Pt=1);break;case 38:dt.shiftKey?It=1:(dt.preventDefault(),Bt=-1);break;case 40:dt.shiftKey?It=-1:(dt.preventDefault(),Bt=1);break;default:return}return this._rotationDisabled&&(At=0,It=0),{cameraAnimation:Ut=>{const Gt=this._tr;Ut.easeTo({duration:300,easeId:"keyboardHandler",easing:zl,zoom:xt?Math.round(Gt.zoom)+xt*(dt.shiftKey?2:1):Gt.zoom,bearing:Gt.bearing+At*this._bearingStep,pitch:Gt.pitch+It*this._pitchStep,offset:[-Pt*this._panStep,-Bt*this._panStep],center:Gt.center},{originalEvent:dt})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function zl(Mt){return Mt*(2-Mt)}const tv=4.000244140625;class Il{constructor(dt,xt){this._onTimeout=At=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(At)},this._map=dt,this._tr=new Al(dt),this._triggerRenderFrame=xt,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(dt){this._defaultZoomRate=dt}setWheelZoomRate(dt){this._wheelZoomRate=dt}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(dt){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!dt&&dt.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(dt){return!!this._map.cooperativeGestures.isEnabled()&&!(dt.ctrlKey||this._map.cooperativeGestures.isBypassed(dt))}wheel(dt){if(!this.isEnabled())return;if(this._shouldBePrevented(dt))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",dt);let xt=dt.deltaMode===WheelEvent.DOM_DELTA_LINE?40*dt.deltaY:dt.deltaY;const At=ot.now(),It=At-(this._lastWheelEventTime||0);this._lastWheelEventTime=At,xt!==0&&xt%tv==0?this._type="wheel":xt!==0&&Math.abs(xt)<4?this._type="trackpad":It>400?(this._type=null,this._lastValue=xt,this._timeout=setTimeout(this._onTimeout,40,dt)):this._type||(this._type=Math.abs(It*xt)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,xt+=this._lastValue)),dt.shiftKey&&xt&&(xt/=4),this._type&&(this._lastWheelEvent=dt,this._delta-=xt,this._active||this._start(dt)),dt.preventDefault()}_start(dt){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const xt=at.mousePos(this._map.getCanvas(),dt),At=this._tr;this._around=xt.y>At.transform.height/2-At.transform.getHorizon()?it.N.convert(this._aroundCenter?At.center:At.unproject(xt)):it.N.convert(At.center),this._aroundPoint=At.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const dt=this._tr.transform;if(this._delta!==0){const Gt=this._type==="wheel"&&Math.abs(this._delta)>tv?this._wheelZoomRate:this._defaultZoomRate;let Yt=2/(1+Math.exp(-Math.abs(this._delta*Gt)));this._delta<0&&Yt!==0&&(Yt=1/Yt);const Kt=typeof this._targetZoom=="number"?dt.zoomScale(this._targetZoom):dt.scale;this._targetZoom=Math.min(dt.maxZoom,Math.max(dt.minZoom,dt.scaleZoom(Kt*Yt))),this._type==="wheel"&&(this._startZoom=dt.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const xt=typeof this._targetZoom=="number"?this._targetZoom:dt.zoom,At=this._startZoom,It=this._easing;let Pt,Bt=!1;const Ut=ot.now()-this._lastWheelEventTime;if(this._type==="wheel"&&At&&It&&Ut){const Gt=Math.min(Ut/200,1),Yt=It(Gt);Pt=it.y.number(At,xt,Yt),Gt<1?this._frameId||(this._frameId=!0):Bt=!0}else Pt=xt,Bt=!0;return this._active=!0,Bt&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Bt,zoomDelta:Pt-dt.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(dt){let xt=it.b9;if(this._prevEase){const At=this._prevEase,It=(ot.now()-At.start)/At.duration,Pt=At.easing(It+.01)-At.easing(It),Bt=.27/Math.sqrt(Pt*Pt+1e-4)*.01,Ut=Math.sqrt(.0729-Bt*Bt);xt=it.b8(Bt,Ut,.25,1)}return this._prevEase={start:ot.now(),duration:dt,easing:xt},xt}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Iu{constructor(dt,xt){this._clickZoom=dt,this._tapZoom=xt}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hy{constructor(dt){this._tr=new Al(dt),this.reset()}reset(){this._active=!1}dblclick(dt,xt){return dt.preventDefault(),{cameraAnimation:At=>{At.easeTo({duration:300,zoom:this._tr.zoom+(dt.shiftKey?-1:1),around:this._tr.unproject(xt)},{originalEvent:dt})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wy{constructor(){this._tap=new Jp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(dt,xt,At){if(!this._swipePoint)if(this._tapTime){const It=xt[0],Pt=dt.timeStamp-this._tapTime<500,Bt=this._tapPoint.dist(It)<30;Pt&&Bt?At.length>0&&(this._swipePoint=It,this._swipeTouch=At[0].identifier):this.reset()}else this._tap.touchstart(dt,xt,At)}touchmove(dt,xt,At){if(this._tapTime){if(this._swipePoint){if(At[0].identifier!==this._swipeTouch)return;const It=xt[0],Pt=It.y-this._swipePoint.y;return this._swipePoint=It,dt.preventDefault(),this._active=!0,{zoomDelta:Pt/128}}}else this._tap.touchmove(dt,xt,At)}touchend(dt,xt,At){if(this._tapTime)this._swipePoint&&At.length===0&&this.reset();else{const It=this._tap.touchend(dt,xt,At);It&&(this._tapTime=dt.timeStamp,this._tapPoint=It)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ay{constructor(dt,xt,At){this._el=dt,this._mousePan=xt,this._touchPan=At}enable(dt){this._inertiaOptions=dt||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class oy{constructor(dt,xt,At){this._pitchWithRotate=dt.pitchWithRotate,this._mouseRotate=xt,this._mousePitch=At}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class rv{constructor(dt,xt,At,It){this._el=dt,this._touchZoom=xt,this._touchRotate=At,this._tapDragZoom=It,this._rotationDisabled=!1,this._enabled=!0}enable(dt){this._touchZoom.enable(dt),this._rotationDisabled||this._touchRotate.enable(dt),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ju{constructor(dt,xt){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=dt,this._options=xt,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const dt=this._map.getCanvasContainer();dt.classList.add("maplibregl-cooperative-gestures"),this._container=at.create("div","maplibregl-cooperative-gesture-screen",dt);let xt=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(xt=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const At=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),It=document.createElement("div");It.className="maplibregl-desktop-message",It.textContent=xt,this._container.appendChild(It);const Pt=document.createElement("div");Pt.className="maplibregl-mobile-message",Pt.textContent=At,this._container.appendChild(Pt),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(at.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(dt){return dt[this._bypassKey]}notifyGestureBlocked(dt,xt){this._enabled&&(this._map.fire(new it.k("cooperativegestureprevented",{gestureType:dt,originalEvent:xt})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ks=Mt=>Mt.zoom||Mt.drag||Mt.pitch||Mt.rotate;class Nn extends it.k{}function nm(Mt){return Mt.panDelta&&Mt.panDelta.mag()||Mt.zoomDelta||Mt.bearingDelta||Mt.pitchDelta}class nv{constructor(dt,xt){this.handleWindowEvent=It=>{this.handleEvent(It,`${It.type}Window`)},this.handleEvent=(It,Pt)=>{if(It.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const Bt=It.type==="renderFrame"?void 0:It,Ut={needsRenderFrame:!1},Gt={},Yt={},Kt=It.touches,Jt=Kt?this._getMapTouches(Kt):void 0,sr=Jt?at.touchPos(this._map.getCanvas(),Jt):at.mousePos(this._map.getCanvas(),It);for(const{handlerName:Ar,handler:Er,allowed:Cr}of this._handlers){if(!Er.isEnabled())continue;let Rr;this._blockedByActive(Yt,Cr,Ar)?Er.reset():Er[Pt||It.type]&&(Rr=Er[Pt||It.type](It,sr,Jt),this.mergeHandlerResult(Ut,Gt,Rr,Ar,Bt),Rr&&Rr.needsRenderFrame&&this._triggerRenderFrame()),(Rr||Er.isActive())&&(Yt[Ar]=Er)}const gr={};for(const Ar in this._previousActiveHandlers)Yt[Ar]||(gr[Ar]=Bt);this._previousActiveHandlers=Yt,(Object.keys(gr).length||nm(Ut))&&(this._changes.push([Ut,Gt,gr]),this._triggerRenderFrame()),(Object.keys(Yt).length||nm(Ut))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:vr}=Ut;vr&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],vr(this._map))},this._map=dt,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hm(dt),this._bearingSnap=xt.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(xt);const At=this._el;this._listeners=[[At,"touchstart",{passive:!0}],[At,"touchmove",{passive:!1}],[At,"touchend",void 0],[At,"touchcancel",void 0],[At,"mousedown",void 0],[At,"mousemove",void 0],[At,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[At,"mouseover",void 0],[At,"mouseout",void 0],[At,"dblclick",void 0],[At,"click",void 0],[At,"keydown",{capture:!1}],[At,"keyup",void 0],[At,"wheel",{passive:!1}],[At,"contextmenu",void 0],[window,"blur",void 0]];for(const[It,Pt,Bt]of this._listeners)at.addEventListener(It,Pt,It===document?this.handleWindowEvent:this.handleEvent,Bt)}destroy(){for(const[dt,xt,At]of this._listeners)at.removeEventListener(dt,xt,dt===document?this.handleWindowEvent:this.handleEvent,At)}_addDefaultHandlers(dt){const xt=this._map,At=xt.getCanvasContainer();this._add("mapEvent",new ny(xt,dt));const It=xt.boxZoom=new Gs(xt,dt);this._add("boxZoom",It),dt.interactive&&dt.boxZoom&&It.enable();const Pt=xt.cooperativeGestures=new ju(xt,dt.cooperativeGestures);this._add("cooperativeGestures",Pt),dt.cooperativeGestures&&Pt.enable();const Bt=new Gu(xt),Ut=new Hy(xt);xt.doubleClickZoom=new Iu(Ut,Bt),this._add("tapZoom",Bt),this._add("clickZoom",Ut),dt.interactive&&dt.doubleClickZoom&&xt.doubleClickZoom.enable();const Gt=new Wy;this._add("tapDragZoom",Gt);const Yt=xt.touchPitch=new Ap(xt);this._add("touchPitch",Yt),dt.interactive&&dt.touchPitch&&xt.touchPitch.enable(dt.touchPitch);const Kt=Zm(dt),Jt=Xm(dt);xt.dragRotate=new oy(dt,Kt,Jt),this._add("mouseRotate",Kt,["mousePitch"]),this._add("mousePitch",Jt,["mouseRotate"]),dt.interactive&&dt.dragRotate&&xt.dragRotate.enable();const sr=(({enable:Rr,clickTolerance:Sr})=>{const Br=new Qp({checkCorrectEvent:Gr=>at.mouseButton(Gr)===0&&!Gr.ctrlKey});return new Xl({clickTolerance:Sr,move:(Gr,qr)=>({around:qr,panDelta:qr.sub(Gr)}),activateOnStart:!0,moveStateManager:Br,enable:Rr,assignEvents:em})})(dt),gr=new Au(dt,xt);xt.dragPan=new ay(At,sr,gr),this._add("mousePan",sr),this._add("touchPan",gr,["touchZoom","touchRotate"]),dt.interactive&&dt.dragPan&&xt.dragPan.enable(dt.dragPan);const vr=new ev,Ar=new Jm;xt.touchZoomRotate=new rv(At,Ar,vr,Gt),this._add("touchRotate",vr,["touchPan","touchZoom"]),this._add("touchZoom",Ar,["touchPan","touchRotate"]),dt.interactive&&dt.touchZoomRotate&&xt.touchZoomRotate.enable(dt.touchZoomRotate);const Er=xt.scrollZoom=new Il(xt,()=>this._triggerRenderFrame());this._add("scrollZoom",Er,["mousePan"]),dt.interactive&&dt.scrollZoom&&xt.scrollZoom.enable(dt.scrollZoom);const Cr=xt.keyboard=new Xs(xt);this._add("keyboard",Cr),dt.interactive&&dt.keyboard&&xt.keyboard.enable(),this._add("blockableMapEvent",new Zo(xt))}_add(dt,xt,At){this._handlers.push({handlerName:dt,handler:xt,allowed:At}),this._handlersById[dt]=xt}stop(dt){if(!this._updatingCamera){for(const{handler:xt}of this._handlers)xt.reset();this._inertia.clear(),this._fireEvents({},{},dt),this._changes=[]}}isActive(){for(const{handler:dt}of this._handlers)if(dt.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ks(this._eventsInProgress)||this.isZooming()}_blockedByActive(dt,xt,At){for(const It in dt)if(It!==At&&(!xt||xt.indexOf(It)<0))return!0;return!1}_getMapTouches(dt){const xt=[];for(const At of dt)this._el.contains(At.target)&&xt.push(At);return xt}mergeHandlerResult(dt,xt,At,It,Pt){if(!At)return;it.e(dt,At);const Bt={handlerName:It,originalEvent:At.originalEvent||Pt};At.zoomDelta!==void 0&&(xt.zoom=Bt),At.panDelta!==void 0&&(xt.drag=Bt),At.pitchDelta!==void 0&&(xt.pitch=Bt),At.bearingDelta!==void 0&&(xt.rotate=Bt)}_applyChanges(){const dt={},xt={},At={};for(const[It,Pt,Bt]of this._changes)It.panDelta&&(dt.panDelta=(dt.panDelta||new it.P(0,0))._add(It.panDelta)),It.zoomDelta&&(dt.zoomDelta=(dt.zoomDelta||0)+It.zoomDelta),It.bearingDelta&&(dt.bearingDelta=(dt.bearingDelta||0)+It.bearingDelta),It.pitchDelta&&(dt.pitchDelta=(dt.pitchDelta||0)+It.pitchDelta),It.around!==void 0&&(dt.around=It.around),It.pinchAround!==void 0&&(dt.pinchAround=It.pinchAround),It.noInertia&&(dt.noInertia=It.noInertia),it.e(xt,Pt),it.e(At,Bt);this._updateMapTransform(dt,xt,At),this._changes=[]}_updateMapTransform(dt,xt,At){const It=this._map,Pt=It._getTransformForUpdate(),Bt=It.terrain;if(!(nm(dt)||Bt&&this._terrainMovement))return this._fireEvents(xt,At,!0);let{panDelta:Ut,zoomDelta:Gt,bearingDelta:Yt,pitchDelta:Kt,around:Jt,pinchAround:sr}=dt;sr!==void 0&&(Jt=sr),It._stop(!0),Jt=Jt||It.transform.centerPoint;const gr=Pt.pointLocation(Ut?Jt.sub(Ut):Jt);Yt&&(Pt.bearing+=Yt),Kt&&(Pt.pitch+=Kt),Gt&&(Pt.zoom+=Gt),Bt?this._terrainMovement||!xt.drag&&!xt.zoom?xt.drag&&this._terrainMovement?Pt.center=Pt.pointLocation(Pt.centerPoint.sub(Ut)):Pt.setLocationAtPoint(gr,Jt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,Pt.setLocationAtPoint(gr,Jt)):Pt.setLocationAtPoint(gr,Jt),It._applyUpdatedTransform(Pt),this._map._update(),dt.noInertia||this._inertia.record(dt),this._fireEvents(xt,At,!0)}_fireEvents(dt,xt,At){const It=Ks(this._eventsInProgress),Pt=Ks(dt),Bt={};for(const Jt in dt){const{originalEvent:sr}=dt[Jt];this._eventsInProgress[Jt]||(Bt[`${Jt}start`]=sr),this._eventsInProgress[Jt]=dt[Jt]}!It&&Pt&&this._fireEvent("movestart",Pt.originalEvent);for(const Jt in Bt)this._fireEvent(Jt,Bt[Jt]);Pt&&this._fireEvent("move",Pt.originalEvent);for(const Jt in dt){const{originalEvent:sr}=dt[Jt];this._fireEvent(Jt,sr)}const Ut={};let Gt;for(const Jt in this._eventsInProgress){const{handlerName:sr,originalEvent:gr}=this._eventsInProgress[Jt];this._handlersById[sr].isActive()||(delete this._eventsInProgress[Jt],Gt=xt[sr]||gr,Ut[`${Jt}end`]=Gt)}for(const Jt in Ut)this._fireEvent(Jt,Ut[Jt]);const Yt=Ks(this._eventsInProgress),Kt=(It||Pt)&&!Yt;if(Kt&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Jt=this._map._getTransformForUpdate();Jt.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(Jt)}if(At&&Kt){this._updatingCamera=!0;const Jt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),sr=gr=>gr!==0&&-this._bearingSnap<gr&&gr<this._bearingSnap;!Jt||!Jt.essential&&ot.prefersReducedMotion?(this._map.fire(new it.k("moveend",{originalEvent:Gt})),sr(this._map.getBearing())&&this._map.resetNorth()):(sr(Jt.bearing||this._map.getBearing())&&(Jt.bearing=0),Jt.freezeElevation=!0,this._map.easeTo(Jt,{originalEvent:Gt})),this._updatingCamera=!1}}_fireEvent(dt,xt){this._map.fire(new it.k(dt,xt?{originalEvent:xt}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(dt=>{delete this._frameId,this.handleEvent(new Nn("renderFrame",{timeStamp:dt})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class sy extends it.E{constructor(dt,xt){super(),this._renderFrameCallback=()=>{const At=Math.min((ot.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(At)),At<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=dt,this._bearingSnap=xt.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new it.N(this.transform.center.lng,this.transform.center.lat)}setCenter(dt,xt){return this.jumpTo({center:dt},xt)}panBy(dt,xt,At){return dt=it.P.convert(dt).mult(-1),this.panTo(this.transform.center,it.e({offset:dt},xt),At)}panTo(dt,xt,At){return this.easeTo(it.e({center:dt},xt),At)}getZoom(){return this.transform.zoom}setZoom(dt,xt){return this.jumpTo({zoom:dt},xt),this}zoomTo(dt,xt,At){return this.easeTo(it.e({zoom:dt},xt),At)}zoomIn(dt,xt){return this.zoomTo(this.getZoom()+1,dt,xt),this}zoomOut(dt,xt){return this.zoomTo(this.getZoom()-1,dt,xt),this}getBearing(){return this.transform.bearing}setBearing(dt,xt){return this.jumpTo({bearing:dt},xt),this}getPadding(){return this.transform.padding}setPadding(dt,xt){return this.jumpTo({padding:dt},xt),this}rotateTo(dt,xt,At){return this.easeTo(it.e({bearing:dt},xt),At)}resetNorth(dt,xt){return this.rotateTo(0,it.e({duration:1e3},dt),xt),this}resetNorthPitch(dt,xt){return this.easeTo(it.e({bearing:0,pitch:0,duration:1e3},dt),xt),this}snapToNorth(dt,xt){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(dt,xt):this}getPitch(){return this.transform.pitch}setPitch(dt,xt){return this.jumpTo({pitch:dt},xt),this}cameraForBounds(dt,xt){dt=zr.convert(dt).adjustAntiMeridian();const At=xt&&xt.bearing||0;return this._cameraForBoxAndBearing(dt.getNorthWest(),dt.getSouthEast(),At,xt)}_cameraForBoxAndBearing(dt,xt,At,It){const Pt={top:0,bottom:0,right:0,left:0};if(typeof(It=it.e({padding:Pt,offset:[0,0],maxZoom:this.transform.maxZoom},It)).padding=="number"){const Tn=It.padding;It.padding={top:Tn,bottom:Tn,right:Tn,left:Tn}}It.padding=it.e(Pt,It.padding);const Bt=this.transform,Ut=Bt.padding,Gt=new zr(dt,xt),Yt=Bt.project(Gt.getNorthWest()),Kt=Bt.project(Gt.getNorthEast()),Jt=Bt.project(Gt.getSouthEast()),sr=Bt.project(Gt.getSouthWest()),gr=it.ba(-At),vr=Yt.rotate(gr),Ar=Kt.rotate(gr),Er=Jt.rotate(gr),Cr=sr.rotate(gr),Rr=new it.P(Math.max(vr.x,Ar.x,Cr.x,Er.x),Math.max(vr.y,Ar.y,Cr.y,Er.y)),Sr=new it.P(Math.min(vr.x,Ar.x,Cr.x,Er.x),Math.min(vr.y,Ar.y,Cr.y,Er.y)),Br=Rr.sub(Sr),Gr=(Bt.width-(Ut.left+Ut.right+It.padding.left+It.padding.right))/Br.x,qr=(Bt.height-(Ut.top+Ut.bottom+It.padding.top+It.padding.bottom))/Br.y;if(qr<0||Gr<0)return void it.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ln=Math.min(Bt.scaleZoom(Bt.scale*Math.min(Gr,qr)),It.maxZoom),mn=it.P.convert(It.offset),Cn=new it.P((It.padding.left-It.padding.right)/2,(It.padding.top-It.padding.bottom)/2).rotate(it.ba(At)),On=mn.add(Cn).mult(Bt.scale/Bt.zoomScale(ln));return{center:Bt.unproject(Yt.add(Jt).div(2).sub(On)),zoom:ln,bearing:At}}fitBounds(dt,xt,At){return this._fitInternal(this.cameraForBounds(dt,xt),xt,At)}fitScreenCoordinates(dt,xt,At,It,Pt){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(it.P.convert(dt)),this.transform.pointLocation(it.P.convert(xt)),At,It),It,Pt)}_fitInternal(dt,xt,At){return dt?(delete(xt=it.e(dt,xt)).padding,xt.linear?this.easeTo(xt,At):this.flyTo(xt,At)):this}jumpTo(dt,xt){this.stop();const At=this._getTransformForUpdate();let It=!1,Pt=!1,Bt=!1;return"zoom"in dt&&At.zoom!==+dt.zoom&&(It=!0,At.zoom=+dt.zoom),dt.center!==void 0&&(At.center=it.N.convert(dt.center)),"bearing"in dt&&At.bearing!==+dt.bearing&&(Pt=!0,At.bearing=+dt.bearing),"pitch"in dt&&At.pitch!==+dt.pitch&&(Bt=!0,At.pitch=+dt.pitch),dt.padding==null||At.isPaddingEqual(dt.padding)||(At.padding=dt.padding),this._applyUpdatedTransform(At),this.fire(new it.k("movestart",xt)).fire(new it.k("move",xt)),It&&this.fire(new it.k("zoomstart",xt)).fire(new it.k("zoom",xt)).fire(new it.k("zoomend",xt)),Pt&&this.fire(new it.k("rotatestart",xt)).fire(new it.k("rotate",xt)).fire(new it.k("rotateend",xt)),Bt&&this.fire(new it.k("pitchstart",xt)).fire(new it.k("pitch",xt)).fire(new it.k("pitchend",xt)),this.fire(new it.k("moveend",xt))}calculateCameraOptionsFromTo(dt,xt,At,It=0){const Pt=it.Z.fromLngLat(dt,xt),Bt=it.Z.fromLngLat(At,It),Ut=Bt.x-Pt.x,Gt=Bt.y-Pt.y,Yt=Bt.z-Pt.z,Kt=Math.hypot(Ut,Gt,Yt);if(Kt===0)throw new Error("Can't calculate camera options with same From and To");const Jt=Math.hypot(Ut,Gt),sr=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Kt/this.transform.tileSize),gr=180*Math.atan2(Ut,-Gt)/Math.PI;let vr=180*Math.acos(Jt/Kt)/Math.PI;return vr=Yt<0?90-vr:90+vr,{center:Bt.toLngLat(),zoom:sr,pitch:vr,bearing:gr}}easeTo(dt,xt){var At;this._stop(!1,dt.easeId),((dt=it.e({offset:[0,0],duration:500,easing:it.b9},dt)).animate===!1||!dt.essential&&ot.prefersReducedMotion)&&(dt.duration=0);const It=this._getTransformForUpdate(),Pt=It.zoom,Bt=It.bearing,Ut=It.pitch,Gt=It.padding,Yt="bearing"in dt?this._normalizeBearing(dt.bearing,Bt):Bt,Kt="pitch"in dt?+dt.pitch:Ut,Jt="padding"in dt?dt.padding:It.padding,sr=it.P.convert(dt.offset);let gr=It.centerPoint.add(sr);const vr=It.pointLocation(gr),{center:Ar,zoom:Er}=It.getConstrained(it.N.convert(dt.center||vr),(At=dt.zoom)!==null&&At!==void 0?At:Pt);this._normalizeCenter(Ar,It);const Cr=It.project(vr),Rr=It.project(Ar).sub(Cr),Sr=It.zoomScale(Er-Pt);let Br,Gr;dt.around&&(Br=it.N.convert(dt.around),Gr=It.locationPoint(Br));const qr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Er!==Pt,this._rotating=this._rotating||Bt!==Yt,this._pitching=this._pitching||Kt!==Ut,this._padding=!It.isPaddingEqual(Jt),this._easeId=dt.easeId,this._prepareEase(xt,dt.noMoveStart,qr),this.terrain&&this._prepareElevation(Ar),this._ease(ln=>{if(this._zooming&&(It.zoom=it.y.number(Pt,Er,ln)),this._rotating&&(It.bearing=it.y.number(Bt,Yt,ln)),this._pitching&&(It.pitch=it.y.number(Ut,Kt,ln)),this._padding&&(It.interpolatePadding(Gt,Jt,ln),gr=It.centerPoint.add(sr)),this.terrain&&!dt.freezeElevation&&this._updateElevation(ln),Br)It.setLocationAtPoint(Br,Gr);else{const mn=It.zoomScale(It.zoom-Pt),Cn=Er>Pt?Math.min(2,Sr):Math.max(.5,Sr),On=Math.pow(Cn,1-ln),Tn=It.unproject(Cr.add(Rr.mult(ln*On)).mult(mn));It.setLocationAtPoint(It.renderWorldCopies?Tn.wrap():Tn,gr)}this._applyUpdatedTransform(It),this._fireMoveEvents(xt)},ln=>{this.terrain&&dt.freezeElevation&&this._finalizeElevation(),this._afterEase(xt,ln)},dt),this}_prepareEase(dt,xt,At={}){this._moving=!0,xt||At.moving||this.fire(new it.k("movestart",dt)),this._zooming&&!At.zooming&&this.fire(new it.k("zoomstart",dt)),this._rotating&&!At.rotating&&this.fire(new it.k("rotatestart",dt)),this._pitching&&!At.pitching&&this.fire(new it.k("pitchstart",dt))}_prepareElevation(dt){this._elevationCenter=dt,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(dt,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(dt){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const xt=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(dt<1&&xt!==this._elevationTarget){const At=this._elevationTarget-this._elevationStart;this._elevationStart+=dt*(At-(xt-(At*dt+this._elevationStart))/(1-dt)),this._elevationTarget=xt}this.transform.elevation=it.y.number(this._elevationStart,this._elevationTarget,dt)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(dt){const xt=dt.getCameraPosition(),At=this.terrain.getElevationForLngLatZoom(xt.lngLat,dt.zoom);if(xt.altitude<At){const It=this.calculateCameraOptionsFromTo(xt.lngLat,At,dt.center,dt.elevation);return{pitch:It.pitch,zoom:It.zoom}}return{}}_applyUpdatedTransform(dt){const xt=[];if(this.terrain&&xt.push(It=>this._elevateCameraIfInsideTerrain(It)),this.transformCameraUpdate&&xt.push(It=>this.transformCameraUpdate(It)),!xt.length)return;const At=dt.clone();for(const It of xt){const Pt=At.clone(),{center:Bt,zoom:Ut,pitch:Gt,bearing:Yt,elevation:Kt}=It(Pt);Bt&&(Pt.center=Bt),Ut!==void 0&&(Pt.zoom=Ut),Gt!==void 0&&(Pt.pitch=Gt),Yt!==void 0&&(Pt.bearing=Yt),Kt!==void 0&&(Pt.elevation=Kt),At.apply(Pt)}this.transform.apply(At)}_fireMoveEvents(dt){this.fire(new it.k("move",dt)),this._zooming&&this.fire(new it.k("zoom",dt)),this._rotating&&this.fire(new it.k("rotate",dt)),this._pitching&&this.fire(new it.k("pitch",dt))}_afterEase(dt,xt){if(this._easeId&&xt&&this._easeId===xt)return;delete this._easeId;const At=this._zooming,It=this._rotating,Pt=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,At&&this.fire(new it.k("zoomend",dt)),It&&this.fire(new it.k("rotateend",dt)),Pt&&this.fire(new it.k("pitchend",dt)),this.fire(new it.k("moveend",dt))}flyTo(dt,xt){var At;if(!dt.essential&&ot.prefersReducedMotion){const Mn=it.M(dt,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mn,xt)}this.stop(),dt=it.e({offset:[0,0],speed:1.2,curve:1.42,easing:it.b9},dt);const It=this._getTransformForUpdate(),Pt=It.zoom,Bt=It.bearing,Ut=It.pitch,Gt=It.padding,Yt="bearing"in dt?this._normalizeBearing(dt.bearing,Bt):Bt,Kt="pitch"in dt?+dt.pitch:Ut,Jt="padding"in dt?dt.padding:It.padding,sr=it.P.convert(dt.offset);let gr=It.centerPoint.add(sr);const vr=It.pointLocation(gr),{center:Ar,zoom:Er}=It.getConstrained(it.N.convert(dt.center||vr),(At=dt.zoom)!==null&&At!==void 0?At:Pt);this._normalizeCenter(Ar,It);const Cr=It.zoomScale(Er-Pt),Rr=It.project(vr),Sr=It.project(Ar).sub(Rr);let Br=dt.curve;const Gr=Math.max(It.width,It.height),qr=Gr/Cr,ln=Sr.mag();if("minZoom"in dt){const Mn=it.ac(Math.min(dt.minZoom,Pt,Er),It.minZoom,It.maxZoom),ba=Gr/It.zoomScale(Mn-Pt);Br=Math.sqrt(ba/ln*2)}const mn=Br*Br;function Cn(Mn){const ba=(qr*qr-Gr*Gr+(Mn?-1:1)*mn*mn*ln*ln)/(2*(Mn?qr:Gr)*mn*ln);return Math.log(Math.sqrt(ba*ba+1)-ba)}function On(Mn){return(Math.exp(Mn)-Math.exp(-Mn))/2}function Tn(Mn){return(Math.exp(Mn)+Math.exp(-Mn))/2}const Sn=Cn(!1);let Un=function(Mn){return Tn(Sn)/Tn(Sn+Br*Mn)},$a=function(Mn){return Gr*((Tn(Sn)*(On(ba=Sn+Br*Mn)/Tn(ba))-On(Sn))/mn)/ln;var ba},In=(Cn(!0)-Sn)/Br;if(Math.abs(ln)<1e-6||!isFinite(In)){if(Math.abs(Gr-qr)<1e-6)return this.easeTo(dt,xt);const Mn=qr<Gr?-1:1;In=Math.abs(Math.log(qr/Gr))/Br,$a=()=>0,Un=ba=>Math.exp(Mn*Br*ba)}return dt.duration="duration"in dt?+dt.duration:1e3*In/("screenSpeed"in dt?+dt.screenSpeed/Br:+dt.speed),dt.maxDuration&&dt.duration>dt.maxDuration&&(dt.duration=0),this._zooming=!0,this._rotating=Bt!==Yt,this._pitching=Kt!==Ut,this._padding=!It.isPaddingEqual(Jt),this._prepareEase(xt,!1),this.terrain&&this._prepareElevation(Ar),this._ease(Mn=>{const ba=Mn*In,Fo=1/Un(ba);It.zoom=Mn===1?Er:Pt+It.scaleZoom(Fo),this._rotating&&(It.bearing=it.y.number(Bt,Yt,Mn)),this._pitching&&(It.pitch=it.y.number(Ut,Kt,Mn)),this._padding&&(It.interpolatePadding(Gt,Jt,Mn),gr=It.centerPoint.add(sr)),this.terrain&&!dt.freezeElevation&&this._updateElevation(Mn);const uo=Mn===1?Ar:It.unproject(Rr.add(Sr.mult($a(ba))).mult(Fo));It.setLocationAtPoint(It.renderWorldCopies?uo.wrap():uo,gr),this._applyUpdatedTransform(It),this._fireMoveEvents(xt)},()=>{this.terrain&&dt.freezeElevation&&this._finalizeElevation(),this._afterEase(xt)},dt),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(dt,xt){var At;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const It=this._onEaseEnd;delete this._onEaseEnd,It.call(this,xt)}return dt||(At=this.handlers)===null||At===void 0||At.stop(!1),this}_ease(dt,xt,At){At.animate===!1||At.duration===0?(dt(1),xt()):(this._easeStart=ot.now(),this._easeOptions=At,this._onEaseFrame=dt,this._onEaseEnd=xt,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(dt,xt){dt=it.b3(dt,-180,180);const At=Math.abs(dt-xt);return Math.abs(dt-360-xt)<At&&(dt-=360),Math.abs(dt+360-xt)<At&&(dt+=360),dt}_normalizeCenter(dt,xt){if(!xt.renderWorldCopies||xt.lngRange)return;const At=dt.lng-xt.center.lng;dt.lng+=At>180?-360:At<-180?360:0}queryTerrainElevation(dt){return this.terrain?this.terrain.getElevationForLngLatZoom(it.N.convert(dt),this.transform.tileZoom)-this.transform.elevation:null}}const Hu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Wu{constructor(dt=Hu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=xt=>{!xt||xt.sourceDataType!=="metadata"&&xt.sourceDataType!=="visibility"&&xt.dataType!=="style"&&xt.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=dt}getDefaultPosition(){return"bottom-right"}onAdd(dt){return this._map=dt,this._compact=this.options.compact,this._container=at.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=at.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=at.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){at.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(dt,xt){const At=this._map._getUIString(`AttributionControl.${xt}`);dt.title=At,dt.setAttribute("aria-label",At)}_updateAttributions(){if(!this._map.style)return;let dt=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?dt=dt.concat(this.options.customAttribution.map(It=>typeof It!="string"?"":It)):typeof this.options.customAttribution=="string"&&dt.push(this.options.customAttribution)),this._map.style.stylesheet){const It=this._map.style.stylesheet;this.styleOwner=It.owner,this.styleId=It.id}const xt=this._map.style.sourceCaches;for(const It in xt){const Pt=xt[It];if(Pt.used||Pt.usedForTerrain){const Bt=Pt.getSource();Bt.attribution&&dt.indexOf(Bt.attribution)<0&&dt.push(Bt.attribution)}}dt=dt.filter(It=>String(It).trim()),dt.sort((It,Pt)=>It.length-Pt.length),dt=dt.filter((It,Pt)=>{for(let Bt=Pt+1;Bt<dt.length;Bt++)if(dt[Bt].indexOf(It)>=0)return!1;return!0});const At=dt.join(" | ");At!==this._attribHTML&&(this._attribHTML=At,dt.length?(this._innerContainer.innerHTML=At,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class iv{constructor(dt={}){this._updateCompact=()=>{const xt=this._container.children;if(xt.length){const At=xt[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&At.classList.add("maplibregl-compact"):At.classList.remove("maplibregl-compact")}},this.options=dt}getDefaultPosition(){return"bottom-left"}onAdd(dt){this._map=dt,this._compact=this.options&&this.options.compact,this._container=at.create("div","maplibregl-ctrl");const xt=at.create("a","maplibregl-ctrl-logo");return xt.target="_blank",xt.rel="noopener nofollow",xt.href="https://maplibre.org/",xt.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),xt.setAttribute("rel","noopener nofollow"),this._container.appendChild(xt),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){at.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class yo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(dt){const xt=++this._id;return this._queue.push({callback:dt,id:xt,cancelled:!1}),xt}remove(dt){const xt=this._currentlyRunning,At=xt?this._queue.concat(xt):this._queue;for(const It of At)if(It.id===dt)return void(It.cancelled=!0)}run(dt=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const xt=this._currentlyRunning=this._queue;this._queue=[];for(const At of xt)if(!At.cancelled&&(At.callback(dt),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var av=it.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Yy extends it.E{constructor(dt){super(),this.sourceCache=dt,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,dt.usedForTerrain=!0,dt.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(dt,xt){this.sourceCache.update(dt,xt),this._renderableTilesKeys=[];const At={};for(const It of dt.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:xt}))At[It.key]=!0,this._renderableTilesKeys.push(It.key),this._tiles[It.key]||(It.posMatrix=new Float64Array(16),it.aP(It.posMatrix,0,it.X,0,it.X,0,1),this._tiles[It.key]=new ko(It,this.tileSize));for(const It in this._tiles)At[It]||delete this._tiles[It]}freeRtt(dt){for(const xt in this._tiles){const At=this._tiles[xt];(!dt||At.tileID.equals(dt)||At.tileID.isChildOf(dt)||dt.isChildOf(At.tileID))&&(At.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(dt=>this.getTileByID(dt))}getTileByID(dt){return this._tiles[dt]}getTerrainCoords(dt){const xt={};for(const At of this._renderableTilesKeys){const It=this._tiles[At].tileID;if(It.canonical.equals(dt.canonical)){const Pt=dt.clone();Pt.posMatrix=new Float64Array(16),it.aP(Pt.posMatrix,0,it.X,0,it.X,0,1),xt[At]=Pt}else if(It.canonical.isChildOf(dt.canonical)){const Pt=dt.clone();Pt.posMatrix=new Float64Array(16);const Bt=It.canonical.z-dt.canonical.z,Ut=It.canonical.x-(It.canonical.x>>Bt<<Bt),Gt=It.canonical.y-(It.canonical.y>>Bt<<Bt),Yt=it.X>>Bt;it.aP(Pt.posMatrix,0,Yt,0,Yt,0,1),it.J(Pt.posMatrix,Pt.posMatrix,[-Ut*Yt,-Gt*Yt,0]),xt[At]=Pt}else if(dt.canonical.isChildOf(It.canonical)){const Pt=dt.clone();Pt.posMatrix=new Float64Array(16);const Bt=dt.canonical.z-It.canonical.z,Ut=dt.canonical.x-(dt.canonical.x>>Bt<<Bt),Gt=dt.canonical.y-(dt.canonical.y>>Bt<<Bt),Yt=it.X>>Bt;it.aP(Pt.posMatrix,0,it.X,0,it.X,0,1),it.J(Pt.posMatrix,Pt.posMatrix,[Ut*Yt,Gt*Yt,0]),it.K(Pt.posMatrix,Pt.posMatrix,[1/2**Bt,1/2**Bt,0]),xt[At]=Pt}}return xt}getSourceTile(dt,xt){const At=this.sourceCache._source;let It=dt.overscaledZ-this.deltaZoom;if(It>At.maxzoom&&(It=At.maxzoom),It<At.minzoom)return null;this._sourceTileCache[dt.key]||(this._sourceTileCache[dt.key]=dt.scaledTo(It).key);let Pt=this.sourceCache.getTileByID(this._sourceTileCache[dt.key]);if((!Pt||!Pt.dem)&&xt)for(;It>=At.minzoom&&(!Pt||!Pt.dem);)Pt=this.sourceCache.getTileByID(dt.scaledTo(It--).key);return Pt}tilesAfterTime(dt=Date.now()){return Object.values(this._tiles).filter(xt=>xt.timeAdded>=dt)}}class ov{constructor(dt,xt,At){this.painter=dt,this.sourceCache=new Yy(xt),this.options=At,this.exaggeration=typeof At.exaggeration=="number"?At.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(dt,xt,At,It=it.X){var Pt;if(!(xt>=0&&xt<It&&At>=0&&At<It))return 0;const Bt=this.getTerrainData(dt),Ut=(Pt=Bt.tile)===null||Pt===void 0?void 0:Pt.dem;if(!Ut)return 0;const Gt=function(vr,Ar,Er){var Cr=Ar[0],Rr=Ar[1];return vr[0]=Er[0]*Cr+Er[4]*Rr+Er[12],vr[1]=Er[1]*Cr+Er[5]*Rr+Er[13],vr}([],[xt/It*it.X,At/It*it.X],Bt.u_terrain_matrix),Yt=[Gt[0]*Ut.dim,Gt[1]*Ut.dim],Kt=Math.floor(Yt[0]),Jt=Math.floor(Yt[1]),sr=Yt[0]-Kt,gr=Yt[1]-Jt;return Ut.get(Kt,Jt)*(1-sr)*(1-gr)+Ut.get(Kt+1,Jt)*sr*(1-gr)+Ut.get(Kt,Jt+1)*(1-sr)*gr+Ut.get(Kt+1,Jt+1)*sr*gr}getElevationForLngLatZoom(dt,xt){if(!it.bb(xt,dt.wrap()))return 0;const{tileID:At,mercatorX:It,mercatorY:Pt}=this._getOverscaledTileIDFromLngLatZoom(dt,xt);return this.getElevation(At,It%it.X,Pt%it.X,it.X)}getElevation(dt,xt,At,It=it.X){return this.getDEMElevation(dt,xt,At,It)*this.exaggeration}getTerrainData(dt){if(!this._emptyDemTexture){const It=this.painter.context,Pt=new it.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ht(It,Pt,It.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ht(It,new it.R({width:1,height:1}),It.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(It.gl.NEAREST,It.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=it.an([])}const xt=this.sourceCache.getSourceTile(dt,!0);if(xt&&xt.dem&&(!xt.demTexture||xt.needsTerrainPrepare)){const It=this.painter.context;xt.demTexture=this.painter.getTileTexture(xt.dem.stride),xt.demTexture?xt.demTexture.update(xt.dem.getPixels(),{premultiply:!1}):xt.demTexture=new Ht(It,xt.dem.getPixels(),It.gl.RGBA,{premultiply:!1}),xt.demTexture.bind(It.gl.NEAREST,It.gl.CLAMP_TO_EDGE),xt.needsTerrainPrepare=!1}const At=xt&&xt+xt.tileID.key+dt.key;if(At&&!this._demMatrixCache[At]){const It=this.sourceCache.sourceCache._source.maxzoom;let Pt=dt.canonical.z-xt.tileID.canonical.z;dt.overscaledZ>dt.canonical.z&&(dt.canonical.z>=It?Pt=dt.canonical.z-It:it.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const Bt=dt.canonical.x-(dt.canonical.x>>Pt<<Pt),Ut=dt.canonical.y-(dt.canonical.y>>Pt<<Pt),Gt=it.bc(new Float64Array(16),[1/(it.X<<Pt),1/(it.X<<Pt),0]);it.J(Gt,Gt,[Bt*it.X,Ut*it.X,0]),this._demMatrixCache[dt.key]={matrix:Gt,coord:dt}}return{u_depth:2,u_terrain:3,u_terrain_dim:xt&&xt.dem&&xt.dem.dim||1,u_terrain_matrix:At?this._demMatrixCache[dt.key].matrix:this._emptyDemMatrix,u_terrain_unpack:xt&&xt.dem&&xt.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(xt&&xt.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:xt}}getFramebuffer(dt){const xt=this.painter,At=xt.width/devicePixelRatio,It=xt.height/devicePixelRatio;return!this._fbo||this._fbo.width===At&&this._fbo.height===It||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ht(xt.context,{width:At,height:It,data:null},xt.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(xt.context.gl.NEAREST,xt.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ht(xt.context,{width:At,height:It,data:null},xt.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(xt.context.gl.NEAREST,xt.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=xt.context.createFramebuffer(At,It,!0,!1),this._fbo.depthAttachment.set(xt.context.createRenderbuffer(xt.context.gl.DEPTH_COMPONENT16,At,It))),this._fbo.colorAttachment.set(dt==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const dt=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const xt=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let Pt=0,Bt=0;Pt<this._coordsTextureSize;Pt++)for(let Ut=0;Ut<this._coordsTextureSize;Ut++,Bt+=4)xt[Bt+0]=255&Ut,xt[Bt+1]=255&Pt,xt[Bt+2]=Ut>>8<<4|Pt>>8,xt[Bt+3]=0;const At=new it.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(xt.buffer)),It=new Ht(dt,At,dt.gl.RGBA,{premultiply:!1});return It.bind(dt.gl.NEAREST,dt.gl.CLAMP_TO_EDGE),this._coordsTexture=It,It}pointCoordinate(dt){this.painter.maybeDrawDepthAndCoords(!0);const xt=new Uint8Array(4),At=this.painter.context,It=At.gl,Pt=Math.round(dt.x*this.painter.pixelRatio/devicePixelRatio),Bt=Math.round(dt.y*this.painter.pixelRatio/devicePixelRatio),Ut=Math.round(this.painter.height/devicePixelRatio);At.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),It.readPixels(Pt,Ut-Bt-1,1,1,It.RGBA,It.UNSIGNED_BYTE,xt),At.bindFramebuffer.set(null);const Gt=xt[0]+(xt[2]>>4<<8),Yt=xt[1]+((15&xt[2])<<8),Kt=this.coordsIndex[255-xt[3]],Jt=Kt&&this.sourceCache.getTileByID(Kt);if(!Jt)return null;const sr=this._coordsTextureSize,gr=(1<<Jt.tileID.canonical.z)*sr;return new it.Z((Jt.tileID.canonical.x*sr+Gt)/gr+Jt.tileID.wrap,(Jt.tileID.canonical.y*sr+Yt)/gr,this.getElevation(Jt.tileID,Gt,Yt,sr))}depthAtPoint(dt){const xt=new Uint8Array(4),At=this.painter.context,It=At.gl;return At.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),It.readPixels(dt.x,this.painter.height/devicePixelRatio-dt.y-1,1,1,It.RGBA,It.UNSIGNED_BYTE,xt),At.bindFramebuffer.set(null),(xt[0]/16777216+xt[1]/65536+xt[2]/256+xt[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const dt=this.painter.context,xt=new it.bd,At=new it.aY,It=this.meshSize,Pt=it.X/It,Bt=It*It;for(let Jt=0;Jt<=It;Jt++)for(let sr=0;sr<=It;sr++)xt.emplaceBack(sr*Pt,Jt*Pt,0);for(let Jt=0;Jt<Bt;Jt+=It+1)for(let sr=0;sr<It;sr++)At.emplaceBack(sr+Jt,It+sr+Jt+1,It+sr+Jt+2),At.emplaceBack(sr+Jt,It+sr+Jt+2,sr+Jt+1);const Ut=xt.length,Gt=Ut+2*(It+1);for(const Jt of[0,1])for(let sr=0;sr<=It;sr++)for(const gr of[0,1])xt.emplaceBack(sr*Pt,Jt*it.X,gr);for(let Jt=0;Jt<2*It;Jt+=2)At.emplaceBack(Gt+Jt,Gt+Jt+1,Gt+Jt+3),At.emplaceBack(Gt+Jt,Gt+Jt+3,Gt+Jt+2),At.emplaceBack(Ut+Jt,Ut+Jt+3,Ut+Jt+1),At.emplaceBack(Ut+Jt,Ut+Jt+2,Ut+Jt+3);const Yt=xt.length,Kt=Yt+2*(It+1);for(const Jt of[0,1])for(let sr=0;sr<=It;sr++)for(const gr of[0,1])xt.emplaceBack(Jt*it.X,sr*Pt,gr);for(let Jt=0;Jt<2*It;Jt+=2)At.emplaceBack(Yt+Jt,Yt+Jt+1,Yt+Jt+3),At.emplaceBack(Yt+Jt,Yt+Jt+3,Yt+Jt+2),At.emplaceBack(Kt+Jt,Kt+Jt+3,Kt+Jt+1),At.emplaceBack(Kt+Jt,Kt+Jt+2,Kt+Jt+3);return this._mesh=new Yp(dt.createVertexBuffer(xt,av.members),dt.createIndexBuffer(At),it.a0.simpleSegment(0,0,xt.length,At.length)),this._mesh}getMeshFrameDelta(dt){return 2*Math.PI*it.be/Math.pow(2,dt)/5}getMinTileElevationForLngLatZoom(dt,xt){var At;const{tileID:It}=this._getOverscaledTileIDFromLngLatZoom(dt,xt);return(At=this.getMinMaxElevation(It).minElevation)!==null&&At!==void 0?At:0}getMinMaxElevation(dt){const xt=this.getTerrainData(dt).tile,At={minElevation:null,maxElevation:null};return xt&&xt.dem&&(At.minElevation=xt.dem.min*this.exaggeration,At.maxElevation=xt.dem.max*this.exaggeration),At}_getOverscaledTileIDFromLngLatZoom(dt,xt){const At=it.Z.fromLngLat(dt.wrap()),It=(1<<xt)*it.X,Pt=At.x*It,Bt=At.y*It,Ut=Math.floor(Pt/it.X),Gt=Math.floor(Bt/it.X);return{tileID:new it.S(xt,0,xt,Ut,Gt),mercatorX:Pt,mercatorY:Bt}}}class qy{constructor(dt,xt,At){this._context=dt,this._size=xt,this._tileSize=At,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const dt of this._objects)dt.texture.destroy(),dt.fbo.destroy()}_createObject(dt){const xt=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),At=new Ht(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return At.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),xt.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),xt.colorAttachment.set(At.texture),{id:dt,fbo:xt,texture:At,stamp:-1,inUse:!1}}getObjectForId(dt){return this._objects[dt]}useObject(dt){dt.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(xt=>dt.id!==xt),this._recentlyUsed.push(dt.id)}stampObject(dt){dt.stamp=++this._stamp}getOrCreateFreeObject(){for(const xt of this._recentlyUsed)if(!this._objects[xt].inUse)return this._objects[xt];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const dt=this._createObject(this._objects.length);return this._objects.push(dt),dt}freeObject(dt){dt.inUse=!1}freeAllObjects(){for(const dt of this._objects)this.freeObject(dt)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(dt=>!dt.inUse)===!1}}const Yu={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ly{constructor(dt,xt){this.painter=dt,this.terrain=xt,this.pool=new qy(dt.context,30,xt.sourceCache.tileSize*xt.qualityFactor)}destruct(){this.pool.destruct()}getTexture(dt){return this.pool.getObjectForId(dt.rtt[this._stacks.length-1].id).texture}prepareForRender(dt,xt){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=dt._order.filter(At=>!dt._layers[At].isHidden(xt)),this._coordsDescendingInv={};for(const At in dt.sourceCaches){this._coordsDescendingInv[At]={};const It=dt.sourceCaches[At].getVisibleCoordinates();for(const Pt of It){const Bt=this.terrain.sourceCache.getTerrainCoords(Pt);for(const Ut in Bt)this._coordsDescendingInv[At][Ut]||(this._coordsDescendingInv[At][Ut]=[]),this._coordsDescendingInv[At][Ut].push(Bt[Ut])}}this._coordsDescendingInvStr={};for(const At of dt._order){const It=dt._layers[At],Pt=It.source;if(Yu[It.type]&&!this._coordsDescendingInvStr[Pt]){this._coordsDescendingInvStr[Pt]={};for(const Bt in this._coordsDescendingInv[Pt])this._coordsDescendingInvStr[Pt][Bt]=this._coordsDescendingInv[Pt][Bt].map(Ut=>Ut.key).sort().join()}}for(const At of this._renderableTiles)for(const It in this._coordsDescendingInvStr){const Pt=this._coordsDescendingInvStr[It][At.tileID.key];Pt&&Pt!==At.rttCoords[It]&&(At.rtt=[])}}renderLayer(dt){if(dt.isHidden(this.painter.transform.zoom))return!1;const xt=dt.type,At=this.painter,It=this._renderableLayerIds[this._renderableLayerIds.length-1]===dt.id;if(Yu[xt]&&(this._prevType&&Yu[this._prevType]||this._stacks.push([]),this._prevType=xt,this._stacks[this._stacks.length-1].push(dt.id),!It))return!0;if(Yu[this._prevType]||Yu[xt]&&It){this._prevType=xt;const Pt=this._stacks.length-1,Bt=this._stacks[Pt]||[];for(const Ut of this._renderableTiles){if(this.pool.isFull()&&(ey(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(Ut),Ut.rtt[Pt]){const Yt=this.pool.getObjectForId(Ut.rtt[Pt].id);if(Yt.stamp===Ut.rtt[Pt].stamp){this.pool.useObject(Yt);continue}}const Gt=this.pool.getOrCreateFreeObject();this.pool.useObject(Gt),this.pool.stampObject(Gt),Ut.rtt[Pt]={id:Gt.id,stamp:Gt.stamp},At.context.bindFramebuffer.set(Gt.fbo.framebuffer),At.context.clear({color:it.aM.transparent,stencil:0}),At.currentStencilSource=void 0;for(let Yt=0;Yt<Bt.length;Yt++){const Kt=At.style._layers[Bt[Yt]],Jt=Kt.source?this._coordsDescendingInv[Kt.source][Ut.tileID.key]:[Ut.tileID];At.context.viewport.set([0,0,Gt.fbo.width,Gt.fbo.height]),At._renderTileClippingMasks(Kt,Jt),At.renderLayer(At,At.style.sourceCaches[Kt.source],Kt,Jt),Kt.source&&(Ut.rttCoords[Kt.source]=this._coordsDescendingInvStr[Kt.source][Ut.tileID.key])}}return ey(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Yu[xt]}return!1}}const sv={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},uy=st,Zy={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Hu,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:it.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},lv=Mt=>{Mt.touchstart=Mt.dragStart,Mt.touchmoveWindow=Mt.dragMove,Mt.touchend=Mt.dragEnd},Xy={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ky{constructor(dt,xt,At=!1){this.mousedown=Bt=>{this.startMouse(it.e({},Bt,{ctrlKey:!0,preventDefault:()=>Bt.preventDefault()}),at.mousePos(this.element,Bt)),at.addEventListener(window,"mousemove",this.mousemove),at.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=Bt=>{this.moveMouse(Bt,at.mousePos(this.element,Bt))},this.mouseup=Bt=>{this.mouseRotate.dragEnd(Bt),this.mousePitch&&this.mousePitch.dragEnd(Bt),this.offTemp()},this.touchstart=Bt=>{Bt.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=at.touchPos(this.element,Bt.targetTouches)[0],this.startTouch(Bt,this._startPos),at.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.addEventListener(window,"touchend",this.touchend))},this.touchmove=Bt=>{Bt.targetTouches.length!==1?this.reset():(this._lastPos=at.touchPos(this.element,Bt.targetTouches)[0],this.moveTouch(Bt,this._lastPos))},this.touchend=Bt=>{Bt.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const It=dt.dragRotate._mouseRotate.getClickTolerance(),Pt=dt.dragRotate._mousePitch.getClickTolerance();this.element=xt,this.mouseRotate=Zm({clickTolerance:It,enable:!0}),this.touchRotate=(({enable:Bt,clickTolerance:Ut,bearingDegreesPerPixelMoved:Gt=.8})=>{const Yt=new qm;return new Xl({clickTolerance:Ut,move:(Kt,Jt)=>({bearingDelta:(Jt.x-Kt.x)*Gt}),moveStateManager:Yt,enable:Bt,assignEvents:lv})})({clickTolerance:It,enable:!0}),this.map=dt,At&&(this.mousePitch=Xm({clickTolerance:Pt,enable:!0}),this.touchPitch=(({enable:Bt,clickTolerance:Ut,pitchDegreesPerPixelMoved:Gt=-.5})=>{const Yt=new qm;return new Xl({clickTolerance:Ut,move:(Kt,Jt)=>({pitchDelta:(Jt.y-Kt.y)*Gt}),moveStateManager:Yt,enable:Bt,assignEvents:lv})})({clickTolerance:Pt,enable:!0})),at.addEventListener(xt,"mousedown",this.mousedown),at.addEventListener(xt,"touchstart",this.touchstart,{passive:!1}),at.addEventListener(xt,"touchcancel",this.reset)}startMouse(dt,xt){this.mouseRotate.dragStart(dt,xt),this.mousePitch&&this.mousePitch.dragStart(dt,xt),at.disableDrag()}startTouch(dt,xt){this.touchRotate.dragStart(dt,xt),this.touchPitch&&this.touchPitch.dragStart(dt,xt),at.disableDrag()}moveMouse(dt,xt){const At=this.map,{bearingDelta:It}=this.mouseRotate.dragMove(dt,xt)||{};if(It&&At.setBearing(At.getBearing()+It),this.mousePitch){const{pitchDelta:Pt}=this.mousePitch.dragMove(dt,xt)||{};Pt&&At.setPitch(At.getPitch()+Pt)}}moveTouch(dt,xt){const At=this.map,{bearingDelta:It}=this.touchRotate.dragMove(dt,xt)||{};if(It&&At.setBearing(At.getBearing()+It),this.touchPitch){const{pitchDelta:Pt}=this.touchPitch.dragMove(dt,xt)||{};Pt&&At.setPitch(At.getPitch()+Pt)}}off(){const dt=this.element;at.removeEventListener(dt,"mousedown",this.mousedown),at.removeEventListener(dt,"touchstart",this.touchstart,{passive:!1}),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend),at.removeEventListener(dt,"touchcancel",this.reset),this.offTemp()}offTemp(){at.enableDrag(),at.removeEventListener(window,"mousemove",this.mousemove),at.removeEventListener(window,"mouseup",this.mouseup),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend)}}let js;function No(Mt,dt,xt){const At=new it.N(Mt.lng,Mt.lat);if(Mt=new it.N(Mt.lng,Mt.lat),dt){const It=new it.N(Mt.lng-360,Mt.lat),Pt=new it.N(Mt.lng+360,Mt.lat),Bt=xt.locationPoint(Mt).distSqr(dt);xt.locationPoint(It).distSqr(dt)<Bt?Mt=It:xt.locationPoint(Pt).distSqr(dt)<Bt&&(Mt=Pt)}for(;Math.abs(Mt.lng-xt.center.lng)>180;){const It=xt.locationPoint(Mt);if(It.x>=0&&It.y>=0&&It.x<=xt.width&&It.y<=xt.height)break;Mt.lng>xt.center.lng?Mt.lng-=360:Mt.lng+=360}return Mt.lng!==At.lng&&xt.locationPoint(Mt).y>xt.height/2-xt.getHorizon()?Mt:At}const qu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function im(Mt,dt,xt){const At=Mt.classList;for(const It in qu)At.remove(`maplibregl-${xt}-anchor-${It}`);At.add(`maplibregl-${xt}-anchor-${dt}`)}class am extends it.E{constructor(dt){if(super(),this._onKeyPress=xt=>{const At=xt.code,It=xt.charCode||xt.keyCode;At!=="Space"&&At!=="Enter"&&It!==32&&It!==13||this.togglePopup()},this._onMapClick=xt=>{const At=xt.originalEvent.target,It=this._element;this._popup&&(At===It||It.contains(At))&&this.togglePopup()},this._update=xt=>{var At;if(!this._map)return;const It=this._map.loaded()&&!this._map.isMoving();(xt?.type==="terrain"||xt?.type==="render"&&!It)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?No(this._lngLat,this._flatPos,this._map.transform):(At=this._lngLat)===null||At===void 0?void 0:At.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let Pt="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?Pt=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(Pt=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let Bt="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Bt="rotateX(0deg)":this._pitchAlignment==="map"&&(Bt=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||xt&&xt.type!=="moveend"||(this._pos=this._pos.round()),at.setTransform(this._element,`${qu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${Bt} ${Pt}`),ot.frameAsync(new AbortController).then(()=>{this._updateOpacity(xt&&xt.type==="moveend")}).catch(()=>{})},this._onMove=xt=>{if(!this._isDragging){const At=this._clickTolerance||this._map._clickTolerance;this._isDragging=xt.point.dist(this._pointerdownPos)>=At}this._isDragging&&(this._pos=xt.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new it.k("dragstart"))),this.fire(new it.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new it.k("dragend")),this._state="inactive"},this._addDragHandler=xt=>{this._element.contains(xt.originalEvent.target)&&(xt.preventDefault(),this._positionDelta=xt.point.sub(this._pos).add(this._offset),this._pointerdownPos=xt.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=dt&&dt.anchor||"center",this._color=dt&&dt.color||"#3FB1CE",this._scale=dt&&dt.scale||1,this._draggable=dt&&dt.draggable||!1,this._clickTolerance=dt&&dt.clickTolerance||0,this._subpixelPositioning=dt&&dt.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=dt&&dt.rotation||0,this._rotationAlignment=dt&&dt.rotationAlignment||"auto",this._pitchAlignment=dt&&dt.pitchAlignment&&dt.pitchAlignment!=="auto"?dt.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(dt?.opacity,dt?.opacityWhenCovered),dt&&dt.element)this._element=dt.element,this._offset=it.P.convert(dt&&dt.offset||[0,0]);else{this._defaultMarker=!0,this._element=at.create("div");const xt=at.createNS("http://www.w3.org/2000/svg","svg"),At=41,It=27;xt.setAttributeNS(null,"display","block"),xt.setAttributeNS(null,"height",`${At}px`),xt.setAttributeNS(null,"width",`${It}px`),xt.setAttributeNS(null,"viewBox",`0 0 ${It} ${At}`);const Pt=at.createNS("http://www.w3.org/2000/svg","g");Pt.setAttributeNS(null,"stroke","none"),Pt.setAttributeNS(null,"stroke-width","1"),Pt.setAttributeNS(null,"fill","none"),Pt.setAttributeNS(null,"fill-rule","evenodd");const Bt=at.createNS("http://www.w3.org/2000/svg","g");Bt.setAttributeNS(null,"fill-rule","nonzero");const Ut=at.createNS("http://www.w3.org/2000/svg","g");Ut.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Ut.setAttributeNS(null,"fill","#000000");const Gt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Cr of Gt){const Rr=at.createNS("http://www.w3.org/2000/svg","ellipse");Rr.setAttributeNS(null,"opacity","0.04"),Rr.setAttributeNS(null,"cx","10.5"),Rr.setAttributeNS(null,"cy","5.80029008"),Rr.setAttributeNS(null,"rx",Cr.rx),Rr.setAttributeNS(null,"ry",Cr.ry),Ut.appendChild(Rr)}const Yt=at.createNS("http://www.w3.org/2000/svg","g");Yt.setAttributeNS(null,"fill",this._color);const Kt=at.createNS("http://www.w3.org/2000/svg","path");Kt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Yt.appendChild(Kt);const Jt=at.createNS("http://www.w3.org/2000/svg","g");Jt.setAttributeNS(null,"opacity","0.25"),Jt.setAttributeNS(null,"fill","#000000");const sr=at.createNS("http://www.w3.org/2000/svg","path");sr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Jt.appendChild(sr);const gr=at.createNS("http://www.w3.org/2000/svg","g");gr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),gr.setAttributeNS(null,"fill","#FFFFFF");const vr=at.createNS("http://www.w3.org/2000/svg","g");vr.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ar=at.createNS("http://www.w3.org/2000/svg","circle");Ar.setAttributeNS(null,"fill","#000000"),Ar.setAttributeNS(null,"opacity","0.25"),Ar.setAttributeNS(null,"cx","5.5"),Ar.setAttributeNS(null,"cy","5.5"),Ar.setAttributeNS(null,"r","5.4999962");const Er=at.createNS("http://www.w3.org/2000/svg","circle");Er.setAttributeNS(null,"fill","#FFFFFF"),Er.setAttributeNS(null,"cx","5.5"),Er.setAttributeNS(null,"cy","5.5"),Er.setAttributeNS(null,"r","5.4999962"),vr.appendChild(Ar),vr.appendChild(Er),Bt.appendChild(Ut),Bt.appendChild(Yt),Bt.appendChild(Jt),Bt.appendChild(gr),Bt.appendChild(vr),xt.appendChild(Bt),xt.setAttributeNS(null,"height",At*this._scale+"px"),xt.setAttributeNS(null,"width",It*this._scale+"px"),this._element.appendChild(xt),this._offset=it.P.convert(dt&&dt.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",xt=>{xt.preventDefault()}),this._element.addEventListener("mousedown",xt=>{xt.preventDefault()}),im(this._element,this._anchor,"marker"),dt&&dt.className)for(const xt of dt.className.split(" "))this._element.classList.add(xt);this._popup=null}addTo(dt){return this.remove(),this._map=dt,this._element.setAttribute("aria-label",dt._getUIString("Marker.Title")),dt.getCanvasContainer().appendChild(this._element),dt.on("move",this._update),dt.on("moveend",this._update),dt.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),at.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(dt){return this._lngLat=it.N.convert(dt),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(dt){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),dt){if(!("offset"in dt.options)){const It=Math.abs(13.5)/Math.SQRT2;dt.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[It,-1*(38.1-13.5+It)],"bottom-right":[-It,-1*(38.1-13.5+It)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=dt,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(dt){return this._subpixelPositioning=dt,this}getPopup(){return this._popup}togglePopup(){const dt=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:dt?(dt.isOpen()?dt.remove():(dt.setLngLat(this._lngLat),dt.addTo(this._map)),this):this}_updateOpacity(dt=!1){var xt,At;if(!(!((xt=this._map)===null||xt===void 0)&&xt.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(dt)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const It=this._map,Pt=It.terrain.depthAtPoint(this._pos),Bt=It.terrain.getElevationForLngLatZoom(this._lngLat,It.transform.tileZoom);if(It.transform.lngLatToCameraDepth(this._lngLat,Bt)-Pt<.006)return void(this._element.style.opacity=this._opacity);const Ut=-this._offset.y/It.transform._pixelPerMeter,Gt=Math.sin(It.getPitch()*Math.PI/180)*Ut,Yt=It.terrain.depthAtPoint(new it.P(this._pos.x,this._pos.y-this._offset.y)),Kt=It.transform.lngLatToCameraDepth(this._lngLat,Bt+Gt)-Yt>.006;!((At=this._popup)===null||At===void 0)&&At.isOpen()&&Kt&&this._popup.remove(),this._element.style.opacity=Kt?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(dt){return this._offset=it.P.convert(dt),this._update(),this}addClassName(dt){this._element.classList.add(dt)}removeClassName(dt){this._element.classList.remove(dt)}toggleClassName(dt){return this._element.classList.toggle(dt)}setDraggable(dt){return this._draggable=!!dt,this._map&&(dt?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(dt){return this._rotation=dt||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(dt){return this._rotationAlignment=dt||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(dt){return this._pitchAlignment=dt&&dt!=="auto"?dt:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(dt,xt){return dt===void 0&&xt===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),dt!==void 0&&(this._opacity=dt),xt!==void 0&&(this._opacityWhenCovered=xt),this._map&&this._updateOpacity(!0),this}}const cy={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ip=0,Ep=!1;const Vl={maxWidth:100,unit:"metric"};function Cp(Mt,dt,xt){const At=xt&&xt.maxWidth||100,It=Mt._container.clientHeight/2,Pt=Mt.unproject([0,It]),Bt=Mt.unproject([At,It]),Ut=Pt.distanceTo(Bt);if(xt&&xt.unit==="imperial"){const Gt=3.2808*Ut;Gt>5280?Vn(dt,At,Gt/5280,Mt._getUIString("ScaleControl.Miles")):Vn(dt,At,Gt,Mt._getUIString("ScaleControl.Feet"))}else xt&&xt.unit==="nautical"?Vn(dt,At,Ut/1852,Mt._getUIString("ScaleControl.NauticalMiles")):Ut>=1e3?Vn(dt,At,Ut/1e3,Mt._getUIString("ScaleControl.Kilometers")):Vn(dt,At,Ut,Mt._getUIString("ScaleControl.Meters"))}function Vn(Mt,dt,xt,At){const It=function(Pt){const Bt=Math.pow(10,`${Math.floor(Pt)}`.length-1);let Ut=Pt/Bt;return Ut=Ut>=10?10:Ut>=5?5:Ut>=3?3:Ut>=2?2:Ut>=1?1:function(Gt){const Yt=Math.pow(10,Math.ceil(-Math.log(Gt)/Math.LN10));return Math.round(Gt*Yt)/Yt}(Ut),Bt*Ut}(xt);Mt.style.width=dt*(It/xt)+"px",Mt.innerHTML=`${It}&nbsp;${At}`}const _i={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},om=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function sm(Mt){if(Mt){if(typeof Mt=="number"){const dt=Math.round(Math.abs(Mt)/Math.SQRT2);return{center:new it.P(0,0),top:new it.P(0,Mt),"top-left":new it.P(dt,dt),"top-right":new it.P(-dt,dt),bottom:new it.P(0,-Mt),"bottom-left":new it.P(dt,-dt),"bottom-right":new it.P(-dt,-dt),left:new it.P(Mt,0),right:new it.P(-Mt,0)}}if(Mt instanceof it.P||Array.isArray(Mt)){const dt=it.P.convert(Mt);return{center:dt,top:dt,"top-left":dt,"top-right":dt,bottom:dt,"bottom-left":dt,"bottom-right":dt,left:dt,right:dt}}return{center:it.P.convert(Mt.center||[0,0]),top:it.P.convert(Mt.top||[0,0]),"top-left":it.P.convert(Mt["top-left"]||[0,0]),"top-right":it.P.convert(Mt["top-right"]||[0,0]),bottom:it.P.convert(Mt.bottom||[0,0]),"bottom-left":it.P.convert(Mt["bottom-left"]||[0,0]),"bottom-right":it.P.convert(Mt["bottom-right"]||[0,0]),left:it.P.convert(Mt.left||[0,0]),right:it.P.convert(Mt.right||[0,0])}}return sm(new it.P(0,0))}const uv=st;nt.AJAXError=it.bh,nt.Evented=it.E,nt.LngLat=it.N,nt.MercatorCoordinate=it.Z,nt.Point=it.P,nt.addProtocol=it.bi,nt.config=it.a,nt.removeProtocol=it.bj,nt.AttributionControl=Wu,nt.BoxZoomHandler=Gs,nt.CanvasSource=eo,nt.CooperativeGesturesHandler=ju,nt.DoubleClickZoomHandler=Iu,nt.DragPanHandler=ay,nt.DragRotateHandler=oy,nt.EdgeInsets=Vu,nt.FullscreenControl=class extends it.E{constructor(Mt={}){super(),this._onFullscreenChange=()=>{var dt;let xt=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((dt=xt?.shadowRoot)===null||dt===void 0)&&dt.fullscreenElement;)xt=xt.shadowRoot.fullscreenElement;xt===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,Mt&&Mt.container&&(Mt.container instanceof HTMLElement?this._container=Mt.container:it.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(Mt){return this._map=Mt,this._container||(this._container=this._map.getContainer()),this._controlContainer=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){at.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const Mt=this._fullscreenButton=at.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);at.create("span","maplibregl-ctrl-icon",Mt).setAttribute("aria-hidden","true"),Mt.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const Mt=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Mt),this._fullscreenButton.title=Mt}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new it.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new it.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},nt.GeoJSONSource=Eo,nt.GeolocateControl=class extends it.E{constructor(Mt){super(),this._onSuccess=dt=>{if(this._map){if(this._isOutOfMapMaxBounds(dt))return this._setErrorState(),this.fire(new it.k("outofmaxbounds",dt)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=dt,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(dt),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(dt),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new it.k("geolocate",dt)),this._finish()}},this._updateCamera=dt=>{const xt=new it.N(dt.coords.longitude,dt.coords.latitude),At=dt.coords.accuracy,It=this._map.getBearing(),Pt=it.e({bearing:It},this.options.fitBoundsOptions),Bt=zr.fromLngLat(xt,At);this._map.fitBounds(Bt,Pt,{geolocateSource:!0})},this._updateMarker=dt=>{if(dt){const xt=new it.N(dt.coords.longitude,dt.coords.latitude);this._accuracyCircleMarker.setLngLat(xt).addTo(this._map),this._userLocationDotMarker.setLngLat(xt).addTo(this._map),this._accuracy=dt.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=dt=>{if(this._map){if(this.options.trackUserLocation)if(dt.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const xt=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=xt,this._geolocateButton.setAttribute("aria-label",xt),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(dt.code===3&&Ep)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new it.k("error",dt)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",dt=>dt.preventDefault()),this._geolocateButton=at.create("button","maplibregl-ctrl-geolocate",this._container),at.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=dt=>{if(this._map){if(dt===!1){it.w("Geolocation support is not available so the GeolocateControl will be disabled.");const xt=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=xt,this._geolocateButton.setAttribute("aria-label",xt)}else{const xt=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=xt,this._geolocateButton.setAttribute("aria-label",xt)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=at.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new am({element:this._dotElement}),this._circleElement=at.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new am({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",xt=>{xt.geolocateSource||this._watchState!=="ACTIVE_LOCK"||xt.originalEvent&&xt.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new it.k("trackuserlocationend")),this.fire(new it.k("userlocationlostfocus")))})}},this.options=it.e({},cy,Mt)}onAdd(Mt){return this._map=Mt,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return it._(this,arguments,void 0,function*(dt=!1){if(js!==void 0&&!dt)return js;if(window.navigator.permissions===void 0)return js=!!window.navigator.geolocation,js;try{js=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{js=!!window.navigator.geolocation}return js})}().then(dt=>this._finishSetupUI(dt)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),at.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ip=0,Ep=!1}_isOutOfMapMaxBounds(Mt){const dt=this._map.getMaxBounds(),xt=Mt.coords;return dt&&(xt.longitude<dt.getWest()||xt.longitude>dt.getEast()||xt.latitude<dt.getSouth()||xt.latitude>dt.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const Mt=this._map.getBounds(),dt=Mt.getSouthEast(),xt=Mt.getNorthEast(),At=dt.distanceTo(xt),It=Math.ceil(this._accuracy/(At/this._map._container.clientHeight)*2);this._circleElement.style.width=`${It}px`,this._circleElement.style.height=`${It}px`}trigger(){if(!this._setup)return it.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new it.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ip--,Ep=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new it.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new it.k("trackuserlocationstart")),this.fire(new it.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let Mt;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ip++,Ip>1?(Mt={maximumAge:6e5,timeout:0},Ep=!0):(Mt=this.options.positionOptions,Ep=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Mt)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},nt.Hash=Zp,nt.ImageSource=Mo,nt.KeyboardHandler=Xs,nt.LngLatBounds=zr,nt.LogoControl=iv,nt.Map=class extends sy{constructor(Mt){it.bf.mark(it.bg.create);const dt=Object.assign(Object.assign({},Zy),Mt);if(dt.minZoom!=null&&dt.maxZoom!=null&&dt.minZoom>dt.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(dt.minPitch!=null&&dt.maxPitch!=null&&dt.minPitch>dt.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(dt.minPitch!=null&&dt.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(dt.maxPitch!=null&&dt.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Uu(dt.minZoom,dt.maxZoom,dt.minPitch,dt.maxPitch,dt.renderWorldCopies),{bearingSnap:dt.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new yo,this._controls=[],this._mapId=it.a4(),this._contextLost=xt=>{xt.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new it.k("webglcontextlost",{originalEvent:xt}))},this._contextRestored=xt=>{this._setupPainter(),this.resize(),this._update(),this.fire(new it.k("webglcontextrestored",{originalEvent:xt}))},this._onMapScroll=xt=>{if(xt.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=dt.interactive,this._maxTileCacheSize=dt.maxTileCacheSize,this._maxTileCacheZoomLevels=dt.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=dt.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=dt.preserveDrawingBuffer===!0,this._antialias=dt.antialias===!0,this._trackResize=dt.trackResize===!0,this._bearingSnap=dt.bearingSnap,this._refreshExpiredTiles=dt.refreshExpiredTiles===!0,this._fadeDuration=dt.fadeDuration,this._crossSourceCollisions=dt.crossSourceCollisions===!0,this._collectResourceTiming=dt.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},sv),dt.locale),this._clickTolerance=dt.clickTolerance,this._overridePixelRatio=dt.pixelRatio,this._maxCanvasSize=dt.maxCanvasSize,this.transformCameraUpdate=dt.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=dt.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Tt.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ct(dt.transformRequest),typeof dt.container=="string"){if(this._container=document.getElementById(dt.container),!this._container)throw new Error(`Container '${dt.container}' not found.`)}else{if(!(dt.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=dt.container}if(dt.maxBounds&&this.setMaxBounds(dt.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let xt=!1;const At=bp(It=>{this._trackResize&&!this._removed&&(this.resize(It),this.redraw())},50);this._resizeObserver=new ResizeObserver(It=>{xt?At(It):xt=!0}),this._resizeObserver.observe(this._container)}this.handlers=new nv(this,dt),this._hash=dt.hash&&new Zp(typeof dt.hash=="string"&&dt.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:dt.center,zoom:dt.zoom,bearing:dt.bearing,pitch:dt.pitch}),dt.bounds&&(this.resize(),this.fitBounds(dt.bounds,it.e({},dt.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=dt.localIdeographFontFamily,this._validateStyle=dt.validateStyle,dt.style&&this.setStyle(dt.style,{localIdeographFontFamily:dt.localIdeographFontFamily}),dt.attributionControl&&this.addControl(new Wu(typeof dt.attributionControl=="boolean"?void 0:dt.attributionControl)),dt.maplibreLogo&&this.addControl(new iv,dt.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",xt=>{this._update(xt.dataType==="style"),this.fire(new it.k(`${xt.dataType}data`,xt))}),this.on("dataloading",xt=>{this.fire(new it.k(`${xt.dataType}dataloading`,xt))}),this.on("dataabort",xt=>{this.fire(new it.k("sourcedataabort",xt))})}_getMapId(){return this._mapId}addControl(Mt,dt){if(dt===void 0&&(dt=Mt.getDefaultPosition?Mt.getDefaultPosition():"top-right"),!Mt||!Mt.onAdd)return this.fire(new it.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const xt=Mt.onAdd(this);this._controls.push(Mt);const At=this._controlPositions[dt];return dt.indexOf("bottom")!==-1?At.insertBefore(xt,At.firstChild):At.appendChild(xt),this}removeControl(Mt){if(!Mt||!Mt.onRemove)return this.fire(new it.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const dt=this._controls.indexOf(Mt);return dt>-1&&this._controls.splice(dt,1),Mt.onRemove(this),this}hasControl(Mt){return this._controls.indexOf(Mt)>-1}calculateCameraOptionsFromTo(Mt,dt,xt,At){return At==null&&this.terrain&&(At=this.terrain.getElevationForLngLatZoom(xt,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(Mt,dt,xt,At)}resize(Mt){var dt;const xt=this._containerDimensions(),At=xt[0],It=xt[1],Pt=this._getClampedPixelRatio(At,It);if(this._resizeCanvas(At,It,Pt),this.painter.resize(At,It,Pt),this.painter.overLimit()){const Ut=this.painter.context.gl;this._maxCanvasSize=[Ut.drawingBufferWidth,Ut.drawingBufferHeight];const Gt=this._getClampedPixelRatio(At,It);this._resizeCanvas(At,It,Gt),this.painter.resize(At,It,Gt)}this.transform.resize(At,It),(dt=this._requestedCameraState)===null||dt===void 0||dt.resize(At,It);const Bt=!this._moving;return Bt&&(this.stop(),this.fire(new it.k("movestart",Mt)).fire(new it.k("move",Mt))),this.fire(new it.k("resize",Mt)),Bt&&this.fire(new it.k("moveend",Mt)),this}_getClampedPixelRatio(Mt,dt){const{0:xt,1:At}=this._maxCanvasSize,It=this.getPixelRatio(),Pt=Mt*It,Bt=dt*It;return Math.min(Pt>xt?xt/Pt:1,Bt>At?At/Bt:1)*It}getPixelRatio(){var Mt;return(Mt=this._overridePixelRatio)!==null&&Mt!==void 0?Mt:devicePixelRatio}setPixelRatio(Mt){this._overridePixelRatio=Mt,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(Mt){return this.transform.setMaxBounds(zr.convert(Mt)),this._update()}setMinZoom(Mt){if((Mt=Mt??-2)>=-2&&Mt<=this.transform.maxZoom)return this.transform.minZoom=Mt,this._update(),this.getZoom()<Mt&&this.setZoom(Mt),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(Mt){if((Mt=Mt??22)>=this.transform.minZoom)return this.transform.maxZoom=Mt,this._update(),this.getZoom()>Mt&&this.setZoom(Mt),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(Mt){if((Mt=Mt??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(Mt>=0&&Mt<=this.transform.maxPitch)return this.transform.minPitch=Mt,this._update(),this.getPitch()<Mt&&this.setPitch(Mt),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(Mt){if((Mt=Mt??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(Mt>=this.transform.minPitch)return this.transform.maxPitch=Mt,this._update(),this.getPitch()>Mt&&this.setPitch(Mt),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(Mt){return this.transform.renderWorldCopies=Mt,this._update()}project(Mt){return this.transform.locationPoint(it.N.convert(Mt),this.style&&this.terrain)}unproject(Mt){return this.transform.pointLocation(it.P.convert(Mt),this.terrain)}isMoving(){var Mt;return this._moving||((Mt=this.handlers)===null||Mt===void 0?void 0:Mt.isMoving())}isZooming(){var Mt;return this._zooming||((Mt=this.handlers)===null||Mt===void 0?void 0:Mt.isZooming())}isRotating(){var Mt;return this._rotating||((Mt=this.handlers)===null||Mt===void 0?void 0:Mt.isRotating())}_createDelegatedListener(Mt,dt,xt){if(Mt==="mouseenter"||Mt==="mouseover"){let At=!1;return{layers:dt,listener:xt,delegates:{mousemove:Pt=>{const Bt=dt.filter(Gt=>this.getLayer(Gt)),Ut=Bt.length!==0?this.queryRenderedFeatures(Pt.point,{layers:Bt}):[];Ut.length?At||(At=!0,xt.call(this,new ys(Mt,this,Pt.originalEvent,{features:Ut}))):At=!1},mouseout:()=>{At=!1}}}}if(Mt==="mouseleave"||Mt==="mouseout"){let At=!1;return{layers:dt,listener:xt,delegates:{mousemove:Bt=>{const Ut=dt.filter(Gt=>this.getLayer(Gt));(Ut.length!==0?this.queryRenderedFeatures(Bt.point,{layers:Ut}):[]).length?At=!0:At&&(At=!1,xt.call(this,new ys(Mt,this,Bt.originalEvent)))},mouseout:Bt=>{At&&(At=!1,xt.call(this,new ys(Mt,this,Bt.originalEvent)))}}}}{const At=It=>{const Pt=dt.filter(Ut=>this.getLayer(Ut)),Bt=Pt.length!==0?this.queryRenderedFeatures(It.point,{layers:Pt}):[];Bt.length&&(It.features=Bt,xt.call(this,It),delete It.features)};return{layers:dt,listener:xt,delegates:{[Mt]:At}}}}_saveDelegatedListener(Mt,dt){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Mt]=this._delegatedListeners[Mt]||[],this._delegatedListeners[Mt].push(dt)}_removeDelegatedListener(Mt,dt,xt){if(!this._delegatedListeners||!this._delegatedListeners[Mt])return;const At=this._delegatedListeners[Mt];for(let It=0;It<At.length;It++){const Pt=At[It];if(Pt.listener===xt&&Pt.layers.length===dt.length&&Pt.layers.every(Bt=>dt.includes(Bt))){for(const Bt in Pt.delegates)this.off(Bt,Pt.delegates[Bt]);return void At.splice(It,1)}}}on(Mt,dt,xt){if(xt===void 0)return super.on(Mt,dt);const At=this._createDelegatedListener(Mt,typeof dt=="string"?[dt]:dt,xt);this._saveDelegatedListener(Mt,At);for(const It in At.delegates)this.on(It,At.delegates[It]);return this}once(Mt,dt,xt){if(xt===void 0)return super.once(Mt,dt);const At=typeof dt=="string"?[dt]:dt,It=this._createDelegatedListener(Mt,At,xt);for(const Pt in It.delegates){const Bt=It.delegates[Pt];It.delegates[Pt]=(...Ut)=>{this._removeDelegatedListener(Mt,At,xt),Bt(...Ut)}}this._saveDelegatedListener(Mt,It);for(const Pt in It.delegates)this.once(Pt,It.delegates[Pt]);return this}off(Mt,dt,xt){return xt===void 0?super.off(Mt,dt):(this._removeDelegatedListener(Mt,typeof dt=="string"?[dt]:dt,xt),this)}queryRenderedFeatures(Mt,dt){if(!this.style)return[];let xt;const At=Mt instanceof it.P||Array.isArray(Mt),It=At?Mt:[[0,0],[this.transform.width,this.transform.height]];if(dt=dt||(At?{}:Mt)||{},It instanceof it.P||typeof It[0]=="number")xt=[it.P.convert(It)];else{const Pt=it.P.convert(It[0]),Bt=it.P.convert(It[1]);xt=[Pt,new it.P(Bt.x,Pt.y),Bt,new it.P(Pt.x,Bt.y),Pt]}return this.style.queryRenderedFeatures(xt,dt,this.transform)}querySourceFeatures(Mt,dt){return this.style.querySourceFeatures(Mt,dt)}setStyle(Mt,dt){return(dt=it.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},dt)).diff!==!1&&dt.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Mt?(this._diffStyle(Mt,dt),this):(this._localIdeographFontFamily=dt.localIdeographFontFamily,this._updateStyle(Mt,dt))}setTransformRequest(Mt){return this._requestManager.setTransformRequest(Mt),this}_getUIString(Mt){const dt=this._locale[Mt];if(dt==null)throw new Error(`Missing UI string '${Mt}'`);return dt}_updateStyle(Mt,dt){if(dt.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(Mt,dt));const xt=this.style&&dt.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!Mt)),Mt?(this.style=new cu(this,dt||{}),this.style.setEventedParent(this,{style:this.style}),typeof Mt=="string"?this.style.loadURL(Mt,dt,xt):this.style.loadJSON(Mt,dt,xt),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(Mt,dt){if(typeof Mt=="string"){const xt=this._requestManager.transformRequest(Mt,"Style");it.h(xt,new AbortController).then(At=>{this._updateDiff(At.data,dt)}).catch(At=>{At&&this.fire(new it.j(At))})}else typeof Mt=="object"&&this._updateDiff(Mt,dt)}_updateDiff(Mt,dt){try{this.style.setState(Mt,dt)&&this._update(!0)}catch(xt){it.w(`Unable to perform style diff: ${xt.message||xt.error||xt}.  Rebuilding the style from scratch.`),this._updateStyle(Mt,dt)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():it.w("There is no style added to the map.")}addSource(Mt,dt){return this._lazyInitEmptyStyle(),this.style.addSource(Mt,dt),this._update(!0)}isSourceLoaded(Mt){const dt=this.style&&this.style.sourceCaches[Mt];if(dt!==void 0)return dt.loaded();this.fire(new it.j(new Error(`There is no source with ID '${Mt}'`)))}setTerrain(Mt){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),Mt){const dt=this.style.sourceCaches[Mt.source];if(!dt)throw new Error(`cannot load terrain, because there exists no source with ID: ${Mt.source}`);this.terrain===null&&dt.reload();for(const xt in this.style._layers){const At=this.style._layers[xt];At.type==="hillshade"&&At.source===Mt.source&&it.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ov(this.painter,dt,Mt),this.painter.renderToTexture=new ly(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=xt=>{xt.dataType==="style"?this.terrain.sourceCache.freeRtt():xt.dataType==="source"&&xt.tile&&(xt.sourceId!==Mt.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(xt.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new it.k("terrain",{terrain:Mt})),this}getTerrain(){var Mt,dt;return(dt=(Mt=this.terrain)===null||Mt===void 0?void 0:Mt.options)!==null&&dt!==void 0?dt:null}areTilesLoaded(){const Mt=this.style&&this.style.sourceCaches;for(const dt in Mt){const xt=Mt[dt]._tiles;for(const At in xt){const It=xt[At];if(It.state!=="loaded"&&It.state!=="errored")return!1}}return!0}removeSource(Mt){return this.style.removeSource(Mt),this._update(!0)}getSource(Mt){return this.style.getSource(Mt)}addImage(Mt,dt,xt={}){const{pixelRatio:At=1,sdf:It=!1,stretchX:Pt,stretchY:Bt,content:Ut,textFitWidth:Gt,textFitHeight:Yt}=xt;if(this._lazyInitEmptyStyle(),!(dt instanceof HTMLImageElement||it.b(dt))){if(dt.width===void 0||dt.height===void 0)return this.fire(new it.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Kt,height:Jt,data:sr}=dt,gr=dt;return this.style.addImage(Mt,{data:new it.R({width:Kt,height:Jt},new Uint8Array(sr)),pixelRatio:At,stretchX:Pt,stretchY:Bt,content:Ut,textFitWidth:Gt,textFitHeight:Yt,sdf:It,version:0,userImage:gr}),gr.onAdd&&gr.onAdd(this,Mt),this}}{const{width:Kt,height:Jt,data:sr}=ot.getImageData(dt);this.style.addImage(Mt,{data:new it.R({width:Kt,height:Jt},sr),pixelRatio:At,stretchX:Pt,stretchY:Bt,content:Ut,textFitWidth:Gt,textFitHeight:Yt,sdf:It,version:0})}}updateImage(Mt,dt){const xt=this.style.getImage(Mt);if(!xt)return this.fire(new it.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const At=dt instanceof HTMLImageElement||it.b(dt)?ot.getImageData(dt):dt,{width:It,height:Pt,data:Bt}=At;if(It===void 0||Pt===void 0)return this.fire(new it.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(It!==xt.data.width||Pt!==xt.data.height)return this.fire(new it.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Ut=!(dt instanceof HTMLImageElement||it.b(dt));return xt.data.replace(Bt,Ut),this.style.updateImage(Mt,xt),this}getImage(Mt){return this.style.getImage(Mt)}hasImage(Mt){return Mt?!!this.style.getImage(Mt):(this.fire(new it.j(new Error("Missing required image id"))),!1)}removeImage(Mt){this.style.removeImage(Mt)}loadImage(Mt){return Tt.getImage(this._requestManager.transformRequest(Mt,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(Mt,dt){return this._lazyInitEmptyStyle(),this.style.addLayer(Mt,dt),this._update(!0)}moveLayer(Mt,dt){return this.style.moveLayer(Mt,dt),this._update(!0)}removeLayer(Mt){return this.style.removeLayer(Mt),this._update(!0)}getLayer(Mt){return this.style.getLayer(Mt)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(Mt,dt,xt){return this.style.setLayerZoomRange(Mt,dt,xt),this._update(!0)}setFilter(Mt,dt,xt={}){return this.style.setFilter(Mt,dt,xt),this._update(!0)}getFilter(Mt){return this.style.getFilter(Mt)}setPaintProperty(Mt,dt,xt,At={}){return this.style.setPaintProperty(Mt,dt,xt,At),this._update(!0)}getPaintProperty(Mt,dt){return this.style.getPaintProperty(Mt,dt)}setLayoutProperty(Mt,dt,xt,At={}){return this.style.setLayoutProperty(Mt,dt,xt,At),this._update(!0)}getLayoutProperty(Mt,dt){return this.style.getLayoutProperty(Mt,dt)}setGlyphs(Mt,dt={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(Mt,dt),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(Mt,dt,xt={}){return this._lazyInitEmptyStyle(),this.style.addSprite(Mt,dt,xt,At=>{At||this._update(!0)}),this}removeSprite(Mt){return this._lazyInitEmptyStyle(),this.style.removeSprite(Mt),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(Mt,dt={}){return this._lazyInitEmptyStyle(),this.style.setSprite(Mt,dt,xt=>{xt||this._update(!0)}),this}setLight(Mt,dt={}){return this._lazyInitEmptyStyle(),this.style.setLight(Mt,dt),this._update(!0)}getLight(){return this.style.getLight()}setSky(Mt){return this._lazyInitEmptyStyle(),this.style.setSky(Mt),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(Mt,dt){return this.style.setFeatureState(Mt,dt),this._update()}removeFeatureState(Mt,dt){return this.style.removeFeatureState(Mt,dt),this._update()}getFeatureState(Mt){return this.style.getFeatureState(Mt)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let Mt=0,dt=0;return this._container&&(Mt=this._container.clientWidth||400,dt=this._container.clientHeight||300),[Mt,dt]}_setupContainer(){const Mt=this._container;Mt.classList.add("maplibregl-map");const dt=this._canvasContainer=at.create("div","maplibregl-canvas-container",Mt);this._interactive&&dt.classList.add("maplibregl-interactive"),this._canvas=at.create("canvas","maplibregl-canvas",dt),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const xt=this._containerDimensions(),At=this._getClampedPixelRatio(xt[0],xt[1]);this._resizeCanvas(xt[0],xt[1],At);const It=this._controlContainer=at.create("div","maplibregl-control-container",Mt),Pt=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(Bt=>{Pt[Bt]=at.create("div",`maplibregl-ctrl-${Bt} `,It)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(Mt,dt,xt){this._canvas.width=Math.floor(xt*Mt),this._canvas.height=Math.floor(xt*dt),this._canvas.style.width=`${Mt}px`,this._canvas.style.height=`${dt}px`}_setupPainter(){const Mt={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let dt=null;this._canvas.addEventListener("webglcontextcreationerror",At=>{dt={requestedAttributes:Mt},At&&(dt.statusMessage=At.statusMessage,dt.type=At.type)},{once:!0});const xt=this._canvas.getContext("webgl2",Mt)||this._canvas.getContext("webgl",Mt);if(!xt){const At="Failed to initialize WebGL";throw dt?(dt.message=At,new Error(JSON.stringify(dt))):new Error(At)}this.painter=new qp(xt,this.transform),ht.testSupport(xt)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(Mt){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||Mt,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(Mt){return this._update(),this._renderTaskQueue.add(Mt)}_cancelRenderFrame(Mt){this._renderTaskQueue.remove(Mt)}_render(Mt){const dt=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Mt),this._removed)return;let xt=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const It=this.transform.zoom,Pt=ot.now();this.style.zoomHistory.update(It,Pt);const Bt=new it.z(It,{now:Pt,fadeDuration:dt,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ut=Bt.crossFadingFactor();Ut===1&&Ut===this._crossFadingFactor||(xt=!0,this._crossFadingFactor=Ut),this.style.update(Bt)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,dt,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:dt,showPadding:this.showPadding}),this.fire(new it.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,it.bf.mark(it.bg.load),this.fire(new it.k("load"))),this.style&&(this.style.hasTransitions()||xt)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const At=this._sourcesDirty||this._styleDirty||this._placementDirty;return At||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new it.k("idle")),!this._loaded||this._fullyLoaded||At||(this._fullyLoaded=!0,it.bf.mark(it.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var Mt;this._hash&&this._hash.remove();for(const xt of this._controls)xt.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Tt.removeThrottleControl(this._imageQueueHandle),(Mt=this._resizeObserver)===null||Mt===void 0||Mt.disconnect();const dt=this.painter.context.gl.getExtension("WEBGL_lose_context");dt?.loseContext&&dt.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),at.remove(this._canvasContainer),at.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),it.bf.clearMetrics(),this._removed=!0,this.fire(new it.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ot.frameAsync(this._frameRequest).then(Mt=>{it.bf.frame(Mt),this._frameRequest=null,this._render(Mt)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(Mt){this._showTileBoundaries!==Mt&&(this._showTileBoundaries=Mt,this._update())}get showPadding(){return!!this._showPadding}set showPadding(Mt){this._showPadding!==Mt&&(this._showPadding=Mt,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(Mt){this._showCollisionBoxes!==Mt&&(this._showCollisionBoxes=Mt,Mt?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(Mt){this._showOverdrawInspector!==Mt&&(this._showOverdrawInspector=Mt,this._update())}get repaint(){return!!this._repaint}set repaint(Mt){this._repaint!==Mt&&(this._repaint=Mt,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(Mt){this._vertices=Mt,this._update()}get version(){return uy}getCameraTargetElevation(){return this.transform.elevation}},nt.MapMouseEvent=ys,nt.MapTouchEvent=Tu,nt.MapWheelEvent=ry,nt.Marker=am,nt.NavigationControl=class{constructor(Mt){this._updateZoomButtons=()=>{const dt=this._map.getZoom(),xt=dt===this._map.getMaxZoom(),At=dt===this._map.getMinZoom();this._zoomInButton.disabled=xt,this._zoomOutButton.disabled=At,this._zoomInButton.setAttribute("aria-disabled",xt.toString()),this._zoomOutButton.setAttribute("aria-disabled",At.toString())},this._rotateCompassArrow=()=>{const dt=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=dt},this._setButtonTitle=(dt,xt)=>{const At=this._map._getUIString(`NavigationControl.${xt}`);dt.title=At,dt.setAttribute("aria-label",At)},this.options=it.e({},Xy,Mt),this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",dt=>dt.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",dt=>this._map.zoomIn({},{originalEvent:dt})),at.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",dt=>this._map.zoomOut({},{originalEvent:dt})),at.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",dt=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:dt}):this._map.resetNorth({},{originalEvent:dt})}),this._compassIcon=at.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(Mt){return this._map=Mt,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ky(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){at.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(Mt,dt){const xt=at.create("button",Mt,this._container);return xt.type="button",xt.addEventListener("click",dt),xt}},nt.Popup=class extends it.E{constructor(Mt){super(),this.remove=()=>(this._content&&at.remove(this._content),this._container&&(at.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new it.k("close"))),this),this._onMouseUp=dt=>{this._update(dt.point)},this._onMouseMove=dt=>{this._update(dt.point)},this._onDrag=dt=>{this._update(dt.point)},this._update=dt=>{var xt;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=at.create("div","maplibregl-popup",this._map.getContainer()),this._tip=at.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const Ut of this.options.className.split(" "))this._container.classList.add(Ut);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?No(this._lngLat,this._flatPos,this._map.transform):(xt=this._lngLat)===null||xt===void 0?void 0:xt.wrap(),this._trackPointer&&!dt)return;const At=this._flatPos=this._pos=this._trackPointer&&dt?dt:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&dt?dt:this._map.transform.locationPoint(this._lngLat));let It=this.options.anchor;const Pt=sm(this.options.offset);if(!It){const Ut=this._container.offsetWidth,Gt=this._container.offsetHeight;let Yt;Yt=At.y+Pt.bottom.y<Gt?["top"]:At.y>this._map.transform.height-Gt?["bottom"]:[],At.x<Ut/2?Yt.push("left"):At.x>this._map.transform.width-Ut/2&&Yt.push("right"),It=Yt.length===0?"bottom":Yt.join("-")}let Bt=At.add(Pt[It]);this.options.subpixelPositioning||(Bt=Bt.round()),at.setTransform(this._container,`${qu[It]} translate(${Bt.x}px,${Bt.y}px)`),im(this._container,It,"popup")},this._onClose=()=>{this.remove()},this.options=it.e(Object.create(_i),Mt)}addTo(Mt){return this._map&&this.remove(),this._map=Mt,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new it.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(Mt){return this._lngLat=it.N.convert(Mt),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(Mt){return this.setDOMContent(document.createTextNode(Mt))}setHTML(Mt){const dt=document.createDocumentFragment(),xt=document.createElement("body");let At;for(xt.innerHTML=Mt;At=xt.firstChild,At;)dt.appendChild(At);return this.setDOMContent(dt)}getMaxWidth(){var Mt;return(Mt=this._container)===null||Mt===void 0?void 0:Mt.style.maxWidth}setMaxWidth(Mt){return this.options.maxWidth=Mt,this._update(),this}setDOMContent(Mt){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=at.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(Mt),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(Mt){return this._container&&this._container.classList.add(Mt),this}removeClassName(Mt){return this._container&&this._container.classList.remove(Mt),this}setOffset(Mt){return this.options.offset=Mt,this._update(),this}toggleClassName(Mt){if(this._container)return this._container.classList.toggle(Mt)}setSubpixelPositioning(Mt){this.options.subpixelPositioning=Mt}_createCloseButton(){this.options.closeButton&&(this._closeButton=at.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const Mt=this._container.querySelector(om);Mt&&Mt.focus()}},nt.RasterDEMTileSource=no,nt.RasterTileSource=Wn,nt.ScaleControl=class{constructor(Mt){this._onMove=()=>{Cp(this._map,this._container,this.options)},this.setUnit=dt=>{this.options.unit=dt,Cp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vl),Mt)}getDefaultPosition(){return"bottom-left"}onAdd(Mt){return this._map=Mt,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-scale",Mt.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){at.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},nt.ScrollZoomHandler=Il,nt.Style=cu,nt.TerrainControl=class{constructor(Mt){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=Mt}onAdd(Mt){return this._map=Mt,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=at.create("button","maplibregl-ctrl-terrain",this._container),at.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){at.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},nt.TwoFingersTouchPitchHandler=Ap,nt.TwoFingersTouchRotateHandler=ev,nt.TwoFingersTouchZoomHandler=Jm,nt.TwoFingersTouchZoomRotateHandler=rv,nt.VectorTileSource=oo,nt.VideoSource=ls,nt.addSourceType=(Mt,dt)=>it._(void 0,void 0,void 0,function*(){if(qs(Mt))throw new Error(`A source type called "${Mt}" already exists.`);((xt,At)=>{wl[xt]=At})(Mt,dt)}),nt.clearPrewarmedResources=function(){const Mt=Rn;Mt&&(Mt.isPreloaded()&&Mt.numActive()===1?(Mt.release(Jr),Rn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},nt.getMaxParallelImageRequests=function(){return it.a.MAX_PARALLEL_IMAGE_REQUESTS},nt.getRTLTextPluginStatus=function(){return us().getRTLTextPluginStatus()},nt.getVersion=function(){return uv},nt.getWorkerCount=function(){return an.workerCount},nt.getWorkerUrl=function(){return it.a.WORKER_URL},nt.importScriptInWorkers=function(Mt){return un().broadcast("IS",Mt)},nt.prewarm=function(){pn().acquire(Jr)},nt.setMaxParallelImageRequests=function(Mt){it.a.MAX_PARALLEL_IMAGE_REQUESTS=Mt},nt.setRTLTextPlugin=function(Mt,dt){return us().setRTLTextPlugin(Mt,dt)},nt.setWorkerCount=function(Mt){an.workerCount=Mt},nt.setWorkerUrl=function(Mt){it.a.WORKER_URL=Mt}});var tt=o;return tt})})(maplibreGl);var maplibreGlExports=maplibreGl.exports;const maplibregl=getDefaultExportFromCjs(maplibreGlExports);var __pow=Math.pow,__async=(s,a,o)=>new Promise((c,d)=>{var tt=st=>{try{it(o.next(st))}catch(ut){d(ut)}},nt=st=>{try{it(o.throw(st))}catch(ut){d(ut)}},it=st=>st.done?c(st.value):Promise.resolve(st.value).then(tt,nt);it((o=o.apply(s,a)).next())}),u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(s,a){for(var o=new u16(31),c=0;c<31;++c)o[c]=a+=1<<s[c-1];for(var d=new i32(o[30]),c=1;c<30;++c)for(var tt=o[c];tt<o[c+1];++tt)d[tt]=tt-o[c]<<5|c;return{b:o,r:d}},_a=freb(fleb,2),fl=_a.b,revfl=_a.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b.b,rev=new u16(32768);for(i=0;i<32768;++i)x=(i&43690)>>1|(i&21845)<<1,x=(x&52428)>>2|(x&13107)<<2,x=(x&61680)>>4|(x&3855)<<4,rev[i]=((x&65280)>>8|(x&255)<<8)>>1;var x,i,hMap=function(s,a,o){for(var c=s.length,d=0,tt=new u16(a);d<c;++d)s[d]&&++tt[s[d]-1];var nt=new u16(a);for(d=1;d<a;++d)nt[d]=nt[d-1]+tt[d-1]<<1;var it;{it=new u16(1<<a);var st=15-a;for(d=0;d<c;++d)if(s[d])for(var ut=d<<4|s[d],ct=a-s[d],ot=nt[s[d]-1]++<<ct,at=ot|(1<<ct)-1;ot<=at;++ot)it[rev[ot]>>st]=ut}return it},flt=new u8(288);for(i=0;i<144;++i)flt[i]=8;var i;for(i=144;i<256;++i)flt[i]=9;var i;for(i=256;i<280;++i)flt[i]=7;var i;for(i=280;i<288;++i)flt[i]=8;var i,fdt=new u8(32);for(i=0;i<32;++i)fdt[i]=5;var i,flrm=hMap(flt,9),fdrm=hMap(fdt,5),max=function(s){for(var a=s[0],o=1;o<s.length;++o)s[o]>a&&(a=s[o]);return a},bits=function(s,a,o){var c=a/8|0;return(s[c]|s[c+1]<<8)>>(a&7)&o},bits16=function(s,a){var o=a/8|0;return(s[o]|s[o+1]<<8|s[o+2]<<16)>>(a&7)},shft=function(s){return(s+7)/8|0},slc=function(s,a,o){(o==null||o>s.length)&&(o=s.length);var c=new u8(o-a);return c.set(s.subarray(a,o)),c},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(s,a,o){var c=new Error(a||ec[s]);if(c.code=s,Error.captureStackTrace&&Error.captureStackTrace(c,err),!o)throw c;return c},inflt=function(s,a,o,c){var d=s.length,tt=0;if(!d||a.f&&!a.l)return o||new u8(0);var nt=!o||a.i!=2,it=a.i;o||(o=new u8(d*3));var st=function(yn){var un=o.length;if(yn>un){var fn=new u8(Math.max(un*2,yn));fn.set(o),o=fn}},ut=a.f||0,ct=a.p||0,ot=a.b||0,at=a.l,ht=a.d,ft=a.m,mt=a.n,yt=d*8;do{if(!at){ut=bits(s,ct,1);var bt=bits(s,ct+1,3);if(ct+=3,bt)if(bt==1)at=flrm,ht=fdrm,ft=9,mt=5;else if(bt==2){var Dt=bits(s,ct,31)+257,Ot=bits(s,ct+10,15)+4,$t=Dt+bits(s,ct+5,31)+1;ct+=14;for(var Ft=new u8($t),kt=new u8(19),Vt=0;Vt<Ot;++Vt)kt[clim[Vt]]=bits(s,ct+Vt*3,7);ct+=Ot*3;for(var Ht=max(kt),Qt=(1<<Ht)-1,Xt=hMap(kt,Ht),Vt=0;Vt<$t;){var Zt=Xt[bits(s,ct,Qt)];ct+=Zt&15;var wt=Zt>>4;if(wt<16)Ft[Vt++]=wt;else{var ar=0,nr=0;for(wt==16?(nr=3+bits(s,ct,3),ct+=2,ar=Ft[Vt-1]):wt==17?(nr=3+bits(s,ct,7),ct+=3):wt==18&&(nr=11+bits(s,ct,127),ct+=7);nr--;)Ft[Vt++]=ar}}var cr=Ft.subarray(0,Dt),dr=Ft.subarray(Dt);ft=max(cr),mt=max(dr),at=hMap(cr,ft),ht=hMap(dr,mt)}else err(1);else{var wt=shft(ct)+4,Tt=s[wt-4]|s[wt-3]<<8,Ct=wt+Tt;if(Ct>d){it&&err(0);break}nt&&st(ot+Tt),o.set(s.subarray(wt,Ct),ot),a.b=ot+=Tt,a.p=ct=Ct*8,a.f=ut;continue}if(ct>yt){it&&err(0);break}}nt&&st(ot+131072);for(var mr=(1<<ft)-1,Dr=(1<<mt)-1,kr=ct;;kr=ct){var ar=at[bits16(s,ct)&mr],Yr=ar>>4;if(ct+=ar&15,ct>yt){it&&err(0);break}if(ar||err(2),Yr<256)o[ot++]=Yr;else if(Yr==256){kr=ct,at=null;break}else{var Mr=Yr-254;if(Yr>264){var Vt=Yr-257,Jr=fleb[Vt];Mr=bits(s,ct,(1<<Jr)-1)+fl[Vt],ct+=Jr}var an=ht[bits16(s,ct)&Dr],xn=an>>4;an||err(3),ct+=an&15;var dr=fd[xn];if(xn>3){var Jr=fdeb[xn];dr+=bits16(s,ct)&(1<<Jr)-1,ct+=Jr}if(ct>yt){it&&err(0);break}nt&&st(ot+131072);var Rn=ot+Mr;if(ot<dr){var hn=tt-dr,pn=Math.min(dr,Rn);for(hn+ot<0&&err(3);ot<pn;++ot)o[ot]=c[hn+ot]}for(;ot<Rn;ot+=4)o[ot]=o[ot-dr],o[ot+1]=o[ot+1-dr],o[ot+2]=o[ot+2-dr],o[ot+3]=o[ot+3-dr];ot=Rn}}a.l=at,a.p=kr,a.b=ot,a.f=ut,at&&(ut=1,a.m=ft,a.d=ht,a.n=mt)}while(!ut);return ot==o.length?o:slc(o,0,ot)},et=new u8(0),gzs=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&err(6,"invalid gzip data");var a=s[3],o=10;a&4&&(o+=(s[10]|s[11]<<8)+2);for(var c=(a>>3&1)+(a>>4&1);c>0;c-=!s[o++]);return o+(a&2)},gzl=function(s){var a=s.length;return(s[a-4]|s[a-3]<<8|s[a-2]<<16|s[a-1]<<24)>>>0},zls=function(s,a){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&err(6,"invalid zlib data"),(s[1]>>5&1)==1&&err(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function inflateSync(s,a){return inflt(s,{i:2},a,a)}function gunzipSync(s,a){var o=gzs(s);return o+8>s.length&&err(6,"invalid gzip data"),inflt(s.subarray(o,-8),{i:2},new u8(gzl(s)),a)}function unzlibSync(s,a){return inflt(s.subarray(zls(s),-4),{i:2},a,a)}function decompressSync(s,a){return s[0]==31&&s[1]==139&&s[2]==8?gunzipSync(s,a):(s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31?inflateSync(s,a):unzlibSync(s,a)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(s){}var shift=(s,a)=>s*__pow(2,a),unshift=(s,a)=>Math.floor(s/__pow(2,a)),getUint24=(s,a)=>shift(s.getUint16(a+1,!0),8)+s.getUint8(a),getUint48=(s,a)=>shift(s.getUint32(a+2,!0),16)+s.getUint16(a,!0),compare=(s,a,o,c,d)=>{if(s!==c.getUint8(d))return s-c.getUint8(d);const tt=getUint24(c,d+1);if(a!==tt)return a-tt;const nt=getUint24(c,d+4);return o!==nt?o-nt:0},queryLeafdir=(s,a,o,c)=>{const d=queryView(s,a|128,o,c);return d?{z:a,x:o,y:c,offset:d[0],length:d[1],isDir:!0}:null},queryTile=(s,a,o,c)=>{const d=queryView(s,a,o,c);return d?{z:a,x:o,y:c,offset:d[0],length:d[1],isDir:!1}:null},queryView=(s,a,o,c)=>{let d=0,tt=s.byteLength/17-1;for(;d<=tt;){const nt=tt+d>>1,it=compare(a,o,c,s,nt*17);if(it>0)d=nt+1;else if(it<0)tt=nt-1;else return[getUint48(s,nt*17+7),s.getUint32(nt*17+13,!0)]}return null},entrySort=(s,a)=>s.isDir&&!a.isDir?1:!s.isDir&&a.isDir?-1:s.z!==a.z?s.z-a.z:s.x!==a.x?s.x-a.x:s.y-a.y,parseEntry=(s,a)=>{const o=s.getUint8(a*17);return{z:o&127,x:getUint24(s,a*17+1),y:getUint24(s,a*17+4),offset:getUint48(s,a*17+7),length:s.getUint32(a*17+13,!0),isDir:o>>7===1}},sortDir=s=>{const a=[],o=new DataView(s);for(let c=0;c<o.byteLength/17;c++)a.push(parseEntry(o,c));return createDirectory(a)},createDirectory=s=>{s.sort(entrySort);const a=new ArrayBuffer(17*s.length),o=new Uint8Array(a);for(let c=0;c<s.length;c++){const d=s[c];let tt=d.z;d.isDir&&(tt=tt|128),o[c*17]=tt,o[c*17+1]=d.x&255,o[c*17+2]=d.x>>8&255,o[c*17+3]=d.x>>16&255,o[c*17+4]=d.y&255,o[c*17+5]=d.y>>8&255,o[c*17+6]=d.y>>16&255,o[c*17+7]=d.offset&255,o[c*17+8]=unshift(d.offset,8)&255,o[c*17+9]=unshift(d.offset,16)&255,o[c*17+10]=unshift(d.offset,24)&255,o[c*17+11]=unshift(d.offset,32)&255,o[c*17+12]=unshift(d.offset,48)&255,o[c*17+13]=d.length&255,o[c*17+14]=d.length>>8&255,o[c*17+15]=d.length>>16&255,o[c*17+16]=d.length>>24&255}return a},deriveLeaf=(s,a)=>{if(s.byteLength<17)return null;const o=s.byteLength/17,c=parseEntry(s,o-1);if(c.isDir){const d=c.z,tt=a.z-d,nt=Math.trunc(a.x/(1<<tt)),it=Math.trunc(a.y/(1<<tt));return{z:d,x:nt,y:it}}return null};function getHeader(s){return __async(this,null,function*(){const a=yield s.getBytes(0,512e3),o=new DataView(a.data),c=o.getUint32(4,!0),d=o.getUint16(8,!0),tt=new TextDecoder("utf-8"),nt=JSON.parse(tt.decode(new DataView(a.data,10,c)));let it=0;nt.compression==="gzip"&&(it=2);let st=0;"minzoom"in nt&&(st=+nt.minzoom);let ut=0;"maxzoom"in nt&&(ut=+nt.maxzoom);let ct=0,ot=0,at=0,ht=-180,ft=-85,mt=180,yt=85;if(nt.bounds){const wt=nt.bounds.split(",");ht=+wt[0],ft=+wt[1],mt=+wt[2],yt=+wt[3]}if(nt.center){const wt=nt.center.split(",");ct=+wt[0],ot=+wt[1],at=+wt[2]}return{specVersion:o.getUint16(2,!0),rootDirectoryOffset:10+c,rootDirectoryLength:d*17,jsonMetadataOffset:10,jsonMetadataLength:c,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:it,tileType:1,minZoom:st,maxZoom:ut,minLon:ht,minLat:ft,maxLon:mt,maxLat:yt,centerZoom:at,centerLon:ct,centerLat:ot,etag:a.etag}})}function getZxy(s,a,o,c,d,tt,nt){return __async(this,null,function*(){let it=yield o.getArrayBuffer(a,s.rootDirectoryOffset,s.rootDirectoryLength,s);s.specVersion===1&&(it=sortDir(it));const st=queryTile(new DataView(it),c,d,tt);if(st){let ot=(yield a.getBytes(st.offset,st.length,nt)).data;const at=new DataView(ot);return at.getUint8(0)===31&&at.getUint8(1)===139&&(ot=decompressSync(new Uint8Array(ot))),{data:ot}}const ut=deriveLeaf(new DataView(it),{z:c,x:d,y:tt});if(ut){const ct=queryLeafdir(new DataView(it),ut.z,ut.x,ut.y);if(ct){let ot=yield o.getArrayBuffer(a,ct.offset,ct.length,s);s.specVersion===1&&(ot=sortDir(ot));const at=queryTile(new DataView(ot),c,d,tt);if(at){let ft=(yield a.getBytes(at.offset,at.length,nt)).data;const mt=new DataView(ft);return mt.getUint8(0)===31&&mt.getUint8(1)===139&&(ft=decompressSync(new Uint8Array(ft))),{data:ft}}}}})}var v2_default={getHeader,getZxy},v3compat=s=>(a,o)=>{if(o instanceof AbortController)return s(a,o);const c=new AbortController;return s(a,c).then(d=>o(void 0,d.data,d.cacheControl||"",d.expires||""),d=>o(d)).catch(d=>o(d)),{cancel:()=>c.abort()}},Protocol=class{constructor(s){this.tilev4=(a,o)=>__async(this,null,function*(){if(a.type==="json"){const at=a.url.substr(10);let ht=this.tiles.get(at);if(ht||(ht=new PMTiles(at),this.tiles.set(at,ht)),this.metadata)return{data:yield ht.getTileJson(a.url)};const ft=yield ht.getHeader();return{data:{tiles:[`${a.url}/{z}/{x}/{y}`],minzoom:ft.minZoom,maxzoom:ft.maxZoom,bounds:[ft.minLon,ft.minLat,ft.maxLon,ft.maxLat]}}}const c=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),d=a.url.match(c);if(!d)throw new Error("Invalid PMTiles protocol URL");const tt=d[1];let nt=this.tiles.get(tt);nt||(nt=new PMTiles(tt),this.tiles.set(tt,nt));const it=d[2],st=d[3],ut=d[4],ct=yield nt.getHeader(),ot=yield nt?.getZxy(+it,+st,+ut,o.signal);return ot?{data:new Uint8Array(ot.data),cacheControl:ot.cacheControl,expires:ot.expires}:ct.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=v3compat(this.tilev4),this.tiles=new Map,this.metadata=s?.metadata||!1}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function toNum(s,a){return(a>>>0)*4294967296+(s>>>0)}function readVarintRemainder(s,a){const o=a.buf;let c=o[a.pos++],d=(c&112)>>4;if(c<128||(c=o[a.pos++],d|=(c&127)<<3,c<128)||(c=o[a.pos++],d|=(c&127)<<10,c<128)||(c=o[a.pos++],d|=(c&127)<<17,c<128)||(c=o[a.pos++],d|=(c&127)<<24,c<128)||(c=o[a.pos++],d|=(c&1)<<31,c<128))return toNum(s,d);throw new Error("Expected varint not more than 10 bytes")}function readVarint(s){const a=s.buf;let o=a[s.pos++],c=o&127;return o<128||(o=a[s.pos++],c|=(o&127)<<7,o<128)||(o=a[s.pos++],c|=(o&127)<<14,o<128)||(o=a[s.pos++],c|=(o&127)<<21,o<128)?c:(o=a[s.pos],c|=(o&15)<<28,readVarintRemainder(c,s))}function rotate(s,a,o,c){if(c===0){o===1&&(a[0]=s-1-a[0],a[1]=s-1-a[1]);const d=a[0];a[0]=a[1],a[1]=d}}var tzValues=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function zxyToTileId(s,a,o){if(s>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(a>__pow(2,s)-1||o>__pow(2,s)-1)throw Error("tile x/y outside zoom level bounds");const c=tzValues[s],d=__pow(2,s);let tt=0,nt=0,it=0;const st=[a,o];let ut=d/2;for(;ut>0;)tt=(st[0]&ut)>0?1:0,nt=(st[1]&ut)>0?1:0,it+=ut*ut*(3*tt^nt),rotate(ut,st,tt,nt),ut=ut/2;return c+it}function defaultDecompress(s,a){return __async(this,null,function*(){if(a===1||a===0)return s;if(a===2){if(typeof globalThis.DecompressionStream>"u")return decompressSync(new Uint8Array(s));const o=new Response(s).body;if(!o)throw Error("Failed to read response stream");const c=o.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(c).arrayBuffer()}throw Error("Compression method not supported")})}function tileTypeExt(s){return s===1?".mvt":s===2?".png":s===3?".jpg":s===4?".webp":s===5?".avif":""}var HEADER_SIZE_BYTES=127;function findTile(s,a){let o=0,c=s.length-1;for(;o<=c;){const d=c+o>>1,tt=a-s[d].tileId;if(tt>0)o=d+1;else if(tt<0)c=d-1;else return s[d]}return c>=0&&(s[c].runLength===0||a-s[c].tileId<s[c].runLength)?s[c]:null}var FetchSource=class{constructor(s,a=new Headers){this.url=s,this.customHeaders=a,this.mustReload=!1;let o="";"navigator"in globalThis&&(o=globalThis.navigator.userAgent||"");const c=o.indexOf("Windows")>-1,d=/Chrome|Chromium|Edg|OPR|Brave/.test(o);this.chromeWindowsNoCache=!1,c&&d&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(s){this.customHeaders=s}getBytes(s,a,o,c){return __async(this,null,function*(){let d,tt;o?tt=o:(d=new AbortController,tt=d.signal);const nt=new Headers(this.customHeaders);nt.set("range",`bytes=${s}-${s+a-1}`);let it;this.mustReload?it="reload":this.chromeWindowsNoCache&&(it="no-store");let st=yield fetch(this.url,{signal:tt,cache:it,headers:nt});if(s===0&&st.status===416){const at=st.headers.get("Content-Range");if(!at||!at.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const ht=+at.substr(8);st=yield fetch(this.url,{signal:tt,cache:"reload",headers:{range:`bytes=0-${ht-1}`}})}let ut=st.headers.get("Etag");if(ut?.startsWith("W/")&&(ut=null),st.status===416||c&&ut&&ut!==c)throw this.mustReload=!0,new EtagMismatch(`Server returned non-matching ETag ${c} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(st.status>=300)throw Error(`Bad response code: ${st.status}`);const ct=st.headers.get("Content-Length");if(st.status===200&&(!ct||+ct>a))throw d&&d.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield st.arrayBuffer(),etag:ut||void 0,cacheControl:st.headers.get("Cache-Control")||void 0,expires:st.headers.get("Expires")||void 0}})}};function getUint64(s,a){const o=s.getUint32(a+4,!0),c=s.getUint32(a+0,!0);return o*__pow(2,32)+c}function bytesToHeader(s,a){const o=new DataView(s),c=o.getUint8(7);if(c>3)throw Error(`Archive is spec version ${c} but this library supports up to spec version 3`);return{specVersion:c,rootDirectoryOffset:getUint64(o,8),rootDirectoryLength:getUint64(o,16),jsonMetadataOffset:getUint64(o,24),jsonMetadataLength:getUint64(o,32),leafDirectoryOffset:getUint64(o,40),leafDirectoryLength:getUint64(o,48),tileDataOffset:getUint64(o,56),tileDataLength:getUint64(o,64),numAddressedTiles:getUint64(o,72),numTileEntries:getUint64(o,80),numTileContents:getUint64(o,88),clustered:o.getUint8(96)===1,internalCompression:o.getUint8(97),tileCompression:o.getUint8(98),tileType:o.getUint8(99),minZoom:o.getUint8(100),maxZoom:o.getUint8(101),minLon:o.getInt32(102,!0)/1e7,minLat:o.getInt32(106,!0)/1e7,maxLon:o.getInt32(110,!0)/1e7,maxLat:o.getInt32(114,!0)/1e7,centerZoom:o.getUint8(118),centerLon:o.getInt32(119,!0)/1e7,centerLat:o.getInt32(123,!0)/1e7,etag:a}}function deserializeIndex(s){const a={buf:new Uint8Array(s),pos:0},o=readVarint(a),c=[];let d=0;for(let tt=0;tt<o;tt++){const nt=readVarint(a);c.push({tileId:d+nt,offset:0,length:0,runLength:1}),d+=nt}for(let tt=0;tt<o;tt++)c[tt].runLength=readVarint(a);for(let tt=0;tt<o;tt++)c[tt].length=readVarint(a);for(let tt=0;tt<o;tt++){const nt=readVarint(a);nt===0&&tt>0?c[tt].offset=c[tt-1].offset+c[tt-1].length:c[tt].offset=nt-1}return c}function detectVersion(s){const a=new DataView(s);return a.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):a.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var EtagMismatch=class extends Error{};function getHeaderAndRoot(s,a){return __async(this,null,function*(){const o=yield s.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(detectVersion(o.data)<3)return[yield v2_default.getHeader(s)];const d=o.data.slice(0,HEADER_SIZE_BYTES),tt=bytesToHeader(d,o.etag),nt=o.data.slice(tt.rootDirectoryOffset,tt.rootDirectoryOffset+tt.rootDirectoryLength),it=`${s.getKey()}|${tt.etag||""}|${tt.rootDirectoryOffset}|${tt.rootDirectoryLength}`,st=deserializeIndex(yield a(nt,tt.internalCompression));return[tt,[it,st.length,st]]})}function getDirectory(s,a,o,c,d){return __async(this,null,function*(){const tt=yield s.getBytes(o,c,void 0,d.etag),nt=yield a(tt.data,d.internalCompression),it=deserializeIndex(nt);if(it.length===0)throw new Error("Empty directory is invalid");return it})}var SharedPromiseCache=class{constructor(s=100,a=!0,o=defaultDecompress){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=s,this.counter=1,this.decompress=o}getHeader(s){return __async(this,null,function*(){const a=s.getKey(),o=this.cache.get(a);if(o)return o.lastUsed=this.counter++,yield o.data;const c=new Promise((d,tt)=>{getHeaderAndRoot(s,this.decompress).then(nt=>{nt[1]&&this.cache.set(nt[1][0],{lastUsed:this.counter++,data:Promise.resolve(nt[1][2])}),d(nt[0]),this.prune()}).catch(nt=>{tt(nt)})});return this.cache.set(a,{lastUsed:this.counter++,data:c}),c})}getDirectory(s,a,o,c){return __async(this,null,function*(){const d=`${s.getKey()}|${c.etag||""}|${a}|${o}`,tt=this.cache.get(d);if(tt)return tt.lastUsed=this.counter++,yield tt.data;const nt=new Promise((it,st)=>{getDirectory(s,this.decompress,a,o,c).then(ut=>{it(ut),this.prune()}).catch(ut=>{st(ut)})});return this.cache.set(d,{lastUsed:this.counter++,data:nt}),nt})}getArrayBuffer(s,a,o,c){return __async(this,null,function*(){const d=`${s.getKey()}|${c.etag||""}|${a}|${o}`,tt=this.cache.get(d);if(tt)return tt.lastUsed=this.counter++,yield tt.data;const nt=new Promise((it,st)=>{s.getBytes(a,o,void 0,c.etag).then(ut=>{it(ut.data),this.cache.has(d),this.prune()}).catch(ut=>{st(ut)})});return this.cache.set(d,{lastUsed:this.counter++,data:nt}),nt})}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,a;this.cache.forEach((o,c)=>{o.lastUsed<s&&(s=o.lastUsed,a=c)}),a&&this.cache.delete(a)}}invalidate(s){return __async(this,null,function*(){const a=s.getKey();if(this.invalidations.get(a))return yield this.invalidations.get(a);this.cache.delete(s.getKey());const o=new Promise((c,d)=>{this.getHeader(s).then(tt=>{c(),this.invalidations.delete(a)}).catch(tt=>{d(tt)})});this.invalidations.set(a,o)})}},PMTiles=class{constructor(s,a,o){typeof s=="string"?this.source=new FetchSource(s):this.source=s,o?this.decompress=o:this.decompress=defaultDecompress,a?this.cache=a:this.cache=new SharedPromiseCache}getHeader(){return __async(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(s,a,o,c){return __async(this,null,function*(){const d=zxyToTileId(s,a,o),tt=yield this.cache.getHeader(this.source);if(tt.specVersion<3)return v2_default.getZxy(tt,this.source,this.cache,s,a,o,c);if(s<tt.minZoom||s>tt.maxZoom)return;let nt=tt.rootDirectoryOffset,it=tt.rootDirectoryLength;for(let st=0;st<=3;st++){const ut=yield this.cache.getDirectory(this.source,nt,it,tt),ct=findTile(ut,d);if(ct){if(ct.runLength>0){const ot=yield this.source.getBytes(tt.tileDataOffset+ct.offset,ct.length,c,tt.etag);return{data:yield this.decompress(ot.data,tt.tileCompression),cacheControl:ot.cacheControl,expires:ot.expires}}nt=tt.leafDirectoryOffset+ct.offset,it=ct.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(s,a,o,c){return __async(this,null,function*(){try{return yield this.getZxyAttempt(s,a,o,c)}catch(d){if(d instanceof EtagMismatch)return this.cache.invalidate(this.source),yield this.getZxyAttempt(s,a,o,c);throw d}})}getMetadataAttempt(){return __async(this,null,function*(){const s=yield this.cache.getHeader(this.source),a=yield this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength,void 0,s.etag),o=yield this.decompress(a.data,s.internalCompression),c=new TextDecoder("utf-8");return JSON.parse(c.decode(o))})}getMetadata(){return __async(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(s){if(s instanceof EtagMismatch)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw s}})}getTileJson(s){return __async(this,null,function*(){const a=yield this.getHeader(),o=yield this.getMetadata(),c=tileTypeExt(a.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${s}/{z}/{x}/{y}${c}`],vector_layers:o.vector_layers,attribution:o.attribution,description:o.description,name:o.name,version:o.version,bounds:[a.minLon,a.minLat,a.maxLon,a.maxLat],center:[a.centerLon,a.centerLat,a.centerZoom],minzoom:a.minZoom,maxzoom:a.maxZoom}})}};let protocolInstalled=!1;function installPMTilesProtocol(){if(protocolInstalled)return;const s=new Protocol;return maplibregl.addProtocol("pmtiles",s.tile),protocolInstalled=!0,s}function addPMSource(s,a,o,c="vector"){s.getSource(a)||s.addSource(a,{type:c,url:`pmtiles://${o}`})}const VAR_OPTIONS=["GRAVITE","CD_GENRE_ACCDN","CD_SIT_PRTCE_ACCDN","CD_ETAT_SURFC","CD_ECLRM","CD_ENVRN_ACCDN","CD_CATEG_ROUTE","CD_ETAT_CHASS","ROUTE_ASPECT","CD_LOCLN_ACCDN","CD_POSI_ACCDN","CD_COND_METEO"],FALLBACK_VAR_LABELS={JR_SEMN_ACCDN:"Day of the week",GRAVITE:"Severity of the accident (based on victims)",CD_GENRE_ACCDN:"Type of collision (first impact)",CD_SIT_PRTCE_ACCDN:"Special situation during accident",CD_ETAT_SURFC:"Road surface condition",CD_ECLRM:"Lighting condition",CD_ENVRN_ACCDN:"Environment (land use)",CD_CATEG_ROUTE:"Road category",CD_ETAT_CHASS:"Roadway condition",T_ROUTE:"Road aspect (profile/slope)",CD_ASPCT_ROUTE:"Road aspect (profile/slope)",ROUTE_ASPECT:"Road aspect (profile/slope)",CD_LOCLN_ACCDN:"Longitudinal location",CD_POSI_ACCDN:"Transversal position on roadway",CD_CONFG_ROUTE:"Road configuration",CD_ZON_TRAVX_ROUTR:"Work zone indicator",CD_COND_METEO:"Weather conditions"},SEV_FR_TO_EN={"Dommages matériels inférieurs au seuil de rapportage":"Below reporting threshold","Dommages matériels seulement":"Property damage only",Léger:"Minor injury",Grave:"Serious injury",Mortel:"Fatal"},PARQUET_FIELD_MAP={T_ROUTE:"ROUTE_ASPECT",CD_ASPCT_ROUTE:"ROUTE_ASPECT"},FIELD_MAP={GRAVITE:["gravite"],CD_GENRE_ACCDN:["cd_genre_accdn"],CD_SIT_PRTCE_ACCDN:["cd_sit_prtce_accdn"],CD_ETAT_SURFC:["cd_etat_surfc"],CD_ECLRM:["cd_eclrm"],CD_ENVRN_ACCDN:["cd_envrn_accdn"],CD_CATEG_ROUTE:["cd_categ_route"],CD_ETAT_CHASS:["cd_etat_chass"],ROUTE_ASPECT:["route_aspect","t_route","cd_aspct_route"],CD_LOCLN_ACCDN:["cd_locln_accdn"],CD_POSI_ACCDN:["cd_posi_accdn"],CD_COND_METEO:["cd_cond_meteo"]},PALETTE=["#fff3b0","#fee08b","#fdb863","#f07c4a","#e34a33","#cc2a1f","#8E1616","#D84040","#ffffff","#ededed","#d9d9d9","#bdbdbd","#9e9e9e","#7a7a7a","#4d4d4d","#262626","#0f0f0f","#000000"],canon=s=>{if(s==null)return"NA";let a=String(s).trim();if(a==="")return"NA";const o=Number(a);return!Number.isNaN(o)&&Number.isFinite(o)?(Number.isInteger(o),String(o)):a},qstr=s=>!s||s.length===0?"":s.map(a=>typeof a=="number"?a:`'${String(a)}'`).join(",");function Block3Map(){const{filters:s}=useFilters(),[a,o]=React$2.useState("GRAVITE"),[c,d]=React$2.useState(!0),[tt,nt]=React$2.useState(!0),[it,st]=React$2.useState(!1),[ut,ct]=React$2.useState(!0),[ot,at]=React$2.useState(!1),ht=React$2.useRef(null),ft=React$2.useRef(null),[mt,yt]=React$2.useState("incidents"),bt="lisa",wt=React$2.useRef([]),Tt=React$2.useRef(null),Ct=React$2.useRef(null),[Dt,Ot]=React$2.useState([]),[$t,Ft]=React$2.useState({}),[kt,Vt]=React$2.useState([]),[Ht,Qt]=React$2.useState({}),[Xt,Zt]=React$2.useState(!1);React$2.useEffect(()=>{fetch(asset("data/dictionary.json")).then(Mr=>Mr.ok?Mr.json():{}).then(Mr=>{Qt(Mr||{}),Zt(!0)}).catch(()=>Zt(!0))},[]);const ar=React$2.useCallback(Mr=>Ht?.__labels__&&Ht.__labels__[Mr]||void 0||FALLBACK_VAR_LABELS[Mr]||Mr,[Ht]),nr=React$2.useCallback((Mr,Jr)=>{const an=Ht[Mr]||{};if(an[Jr]!==void 0)return an[Jr];const xn=Number(Jr);return!Number.isNaN(xn)&&Number.isInteger(xn)&&an[String(xn)]!==void 0?an[String(xn)]:Jr},[Ht]),cr=React$2.useMemo(()=>{const Mr=[];return s.years?.length&&Mr.push(`AN IN (${qstr(s.years)})`),s.months?.length&&Mr.push(`month IN (${qstr(s.months)})`),s.quarters?.length&&Mr.push(`quarter IN (${qstr(s.quarters)})`),s.dows?.length&&Mr.push(`CAST(JR_SEMN_ACCDN AS VARCHAR) IN (${qstr(s.dows)})`),s.severities?.length&&Mr.push(`GRAVITE IN (${qstr(s.severities)})`),s.quartiers?.length&&Mr.push(`no_qr IN (${qstr(s.quartiers)})`),s.arrs?.length&&Mr.push(`no_arr IN (${qstr(s.arrs)})`),Mr.length?`WHERE ${Mr.join(" AND ")}`:""},[s]);React$2.useEffect(()=>{(a==="T_ROUTE"||a==="CD_ASPCT_ROUTE")&&o("ROUTE_ASPECT")},[a]),React$2.useEffect(()=>{if(!window.__pmtiles_protocol_installed__){try{installPMTilesProtocol?.()}catch{const Mr=new Protocol;maplibregl.addProtocol("pmtiles",Mr.tile)}window.__pmtiles_protocol_installed__=!0}},[]),React$2.useEffect(()=>{if(!ft.current||ht.current)return;const Mr=new maplibregl.Map({container:ft.current,style:{version:8,sources:{dark:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://d.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256,attribution:"© OpenStreetMap © CARTO"}},layers:[{id:"dark",type:"raster",source:"dark"}],glyphs:"https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf"},center:[-73.5673,45.5017],zoom:10.5});return ht.current=Mr,Mr.on("load",async()=>{addPMSource(Mr,"incidents",PMTILES.incidents,"vector"),addPMSource(Mr,"lisa",PMTILES.lisa,"vector");try{const hn=PMTILES.incidents.replace(/^pmtiles:\/\//,""),fn=((await new PMTiles(hn).getMetadata())?.vector_layers||[])[0];fn?.fields&&(wt.current=Object.keys(fn.fields)),fn?.id&&yt(fn.id),console.log("[pmtiles schema fields]",wt.current)}catch(hn){console.warn("Could not fetch PMTiles metadata:",hn)}Mr.addLayer({id:"inc-pts",type:"circle",source:"incidents","source-layer":mt,paint:{"circle-radius":3.2,"circle-opacity":.85,"circle-color":"#D84040"},layout:{visibility:tt?"visible":"none"}}),Mr.addLayer({id:"lisa-fill",type:"fill",source:"lisa","source-layer":bt,filter:["in",["get","cluster"],["literal",["HH","HL","LH","LL"]]],paint:{"fill-color":["match",["get","cluster"],"HH","#8B0000","HL","#FF6B6B","LL","#0B3D91","LH","#5DA9FF","#3A3A3A"],"fill-opacity":.45},layout:{visibility:it?"visible":"none"}}),Mr.addLayer({id:"lisa-line",type:"line",source:"lisa","source-layer":bt,filter:["in",["get","cluster"],["literal",["HH","HL","LH","LL"]]],paint:{"line-color":"#262626","line-width":.6},layout:{visibility:it?"visible":"none"}}),Mr.addLayer({id:"lisa-ns-fill",type:"fill",source:"lisa","source-layer":bt,filter:["!in","cluster","HH","HL","LH","LL"],paint:{"fill-color":"#FFFFFF","fill-opacity":.35},layout:{visibility:it?"visible":"none"}}),Mr.addLayer({id:"lisa-ns-line",type:"line",source:"lisa","source-layer":bt,filter:["!in","cluster","HH","HL","LH","LL"],paint:{"line-color":"#BDBDBD","line-width":.4,"line-opacity":.6},layout:{visibility:it?"visible":"none"}}),Mr.addSource("quartiers",{type:"geojson",data:asset("data/basemap/MTL_quartier.geojson"),generateId:!0}),Mr.addLayer({id:"qr-fill",type:"fill",source:"quartiers",paint:{"fill-color":"#000000","fill-opacity":0},layout:{visibility:ot?"visible":"none"}}),Mr.addLayer({id:"qr-line",type:"line",source:"quartiers",paint:{"line-color":["case",["boolean",["feature-state","hover"],!1],"#FFFFFF","#CFD8DC"],"line-width":["case",["boolean",["feature-state","hover"],!1],2.5,1.6],"line-opacity":.95},layout:{visibility:ot?"visible":"none"}}),Mr.setLayoutProperty("dark","visibility",c?"visible":"none"),Mr.on("click","inc-pts",hn=>{const pn=hn.features?.[0];pn&&console.log("props sample:",pn.properties)});const Jr=()=>(Ct.current||(Ct.current=new maplibregl.Popup({closeButton:!1,closeOnClick:!1,anchor:"top"})),Ct.current),an=hn=>{const pn=hn?.nom_qr??hn?.NOM_QR??hn?.name??"",yn=hn?.no_qr??hn?.NO_QR??"",un=hn?.nom_arr??hn?.NOM_ARR??"",fn=hn?.no_arr??hn?.NO_ARR??"",Bn=[];return(pn||yn)&&Bn.push(`<tr><td><b>Quartier</b></td><td>${pn||""}${yn?` (#${yn})`:""}</td></tr>`),(un||fn)&&Bn.push(`<tr><td><b>Arr.</b></td><td>${un||""}${fn?` (#${fn})`:""}</td></tr>`),["pop","population","area","surface","code"].forEach(Dn=>{hn?.[Dn]!==void 0&&Bn.push(`<tr><td><b>${Dn}</b></td><td>${hn[Dn]}</td></tr>`)}),Bn.length||Object.entries(hn||{}).slice(0,6).forEach(([Qn,zr])=>Bn.push(`<tr><td><b>${Qn}</b></td><td>${String(zr)}</td></tr>`)),`<div style="font-size:12px;color:#EDEDED;"><table>${Bn.join("")}</table></div>`},xn=hn=>{if(!ot)return;const pn=Mr.queryRenderedFeatures(hn.point,{layers:["qr-fill"]});if(!pn.length){Tt.current!==null&&(Mr.setFeatureState({source:"quartiers",id:Tt.current},{hover:!1}),Tt.current=null),Ct.current&&Ct.current.remove(),Mr.getCanvas().style.cursor="";return}const yn=pn[0],un=yn.id;Tt.current!==un&&(Tt.current!==null&&Mr.setFeatureState({source:"quartiers",id:Tt.current},{hover:!1}),Tt.current=un,Mr.setFeatureState({source:"quartiers",id:un},{hover:!0})),Mr.getCanvas().style.cursor="pointer",Jr().setLngLat(hn.lngLat).setHTML(an(yn.properties)).addTo(Mr)},Rn=()=>{ot&&(Tt.current!==null&&(Mr.setFeatureState({source:"quartiers",id:Tt.current},{hover:!1}),Tt.current=null),Ct.current&&Ct.current.remove(),Mr.getCanvas().style.cursor="")};Mr.on("mousemove","qr-fill",xn),Mr.on("mouseleave","qr-fill",Rn),window.__qrHandlers={onMove:xn,onLeave:Rn},dr(),Dr()}),()=>{const Jr=ht.current;if(Jr){try{const an=window.__qrHandlers;an&&(Jr.off("mousemove","qr-fill",an.onMove),Jr.off("mouseleave","qr-fill",an.onLeave))}catch{}Jr.remove()}ht.current=null}},[]),React$2.useEffect(()=>{const Mr=ht.current;if(!Mr||!Mr.getSource("incidents"))return;const Jr=Mr.getLayer("inc-pts");Jr&&Jr["source-layer"]!==mt&&(Mr.removeLayer("inc-pts"),Mr.addLayer({id:"inc-pts",type:"circle",source:"incidents","source-layer":mt,paint:{"circle-radius":3.2,"circle-opacity":.85,"circle-color":"#D84040"},layout:{visibility:tt?"visible":"none"}}),dr(),Dr())},[mt]),React$2.useEffect(()=>{const Mr=ht.current;Mr&&(Mr.getLayer("dark")&&Mr.setLayoutProperty("dark","visibility",c?"visible":"none"),Mr.getLayer("inc-pts")&&Mr.setLayoutProperty("inc-pts","visibility",tt?"visible":"none"),Mr.getLayer("lisa-fill")&&Mr.setLayoutProperty("lisa-fill","visibility",it?"visible":"none"),Mr.getLayer("lisa-line")&&Mr.setLayoutProperty("lisa-line","visibility",it?"visible":"none"),Mr.getLayer("lisa-ns-fill")&&Mr.setLayoutProperty("lisa-ns-fill","visibility",it?"visible":"none"),Mr.getLayer("lisa-ns-line")&&Mr.setLayoutProperty("lisa-ns-line","visibility",it?"visible":"none"),Mr.getLayer("qr-fill")&&Mr.setLayoutProperty("qr-fill","visibility",ot?"visible":"none"),Mr.getLayer("qr-line")&&Mr.setLayoutProperty("qr-line","visibility",ot?"visible":"none"),!ot&&Ct.current&&Ct.current.remove())},[c,tt,it,ot]);function dr(){const Mr=ht.current;if(!Mr||!Mr.getLayer("inc-pts"))return;const Jr=["all"];s.years?.length&&Jr.push(["in",["get","AN"],["literal",s.years]]),s.months?.length&&Jr.push(["in",["get","month"],["literal",s.months]]),s.quarters?.length&&Jr.push(["in",["get","quarter"],["literal",s.quarters]]),s.dows?.length&&Jr.push(["in",["get","JR_SEMN_ACCDN"],["literal",s.dows.map(String)]]),s.severities?.length&&Jr.push(["in",["get","GRAVITE"],["literal",s.severities]]),s.quartiers?.length&&Jr.push(["in",["get","no_qr"],["literal",s.quartiers]]),s.arrs?.length&&Jr.push(["in",["get","no_arr"],["literal",s.arrs]]),Mr.setFilter("inc-pts",Jr)}const mr=React$2.useCallback(Mr=>PARQUET_FIELD_MAP[Mr]??Mr,[]);async function Dr(Mr=0){const Jr=ht.current;if(!Jr||!Jr.getLayer("inc-pts"))return;const an=Jr.querySourceFeatures?.("incidents",{sourceLayer:mt})||Jr.queryRenderedFeatures({layers:["inc-pts"]});if((!an||an.length===0)&&Mr<1){Jr.once("idle",()=>Dr(Mr+1));return}const xn=mr(a),hn=(await parquetQuery(`
      SELECT ${xn} AS k, CAST(COUNT(*) AS INT) AS cnt
      FROM read_parquet('${PARQUET.incidentVars}')
      ${cr}
      GROUP BY ${xn}
      ORDER BY cnt DESC
      LIMIT 20
    `)).map(oo=>({k:canon(oo.k),cnt:Number(oo.cnt)})),pn=an[0]?.properties||{},yn=Object.keys(pn),un=wt.current||[],fn=new Set([...un,...yn]),Bn=[a,...FIELD_MAP[a]??[],a.toLowerCase()],Dn=Bn.find(oo=>fn.has(oo));let Qn=[];if(Dn){const oo=new Set;for(const Wn of an){const no=canon(Wn.properties?.[Dn]);if(oo.add(no),oo.size>=20)break}Qn=Array.from(oo)}const zr=Array.from(new Set([...hn.map(oo=>oo.k),...Qn]));Vt(zr);const ao={};if(zr.forEach((oo,Wn)=>{ao[oo]=PALETTE[Wn%PALETTE.length]}),ao.NA||(ao.NA="#bdbdbd"),Ft(ao),Ot(hn),Dn){const oo=["let","v",["to-string",["coalesce",["get",Dn],""]],["case",["==",["var","v"],""],"NA",["var","v"]]],Wn=[];zr.forEach(Eo=>Wn.push(Eo,ao[Eo]));const no=["match",oo,...Wn,ao.NA];Jr.setPaintProperty("inc-pts","circle-color",no),window.__INC_TILE_FIELD_MISSING__=null}else Jr.setPaintProperty("inc-pts","circle-color","#9e9e9e"),window.__INC_TILE_FIELD_MISSING__=a;window.__DBG={field:a,sqlCol:xn,effectiveField:Dn||null,categories_union:zr,pie_categories:hn.map(oo=>oo.k),tile_categories:Qn,filters_snapshot:s,tile_props:yn,schema_keys:un,have_union:[...fn],rendered_features:an.length,missing_in_tiles:Dn?null:{tried:Bn,have:[...fn]}}}React$2.useEffect(()=>{dr(),Dr()},[a,cr,tt]);const kr=Mr=>SEV_FR_TO_EN[Mr]??Mr,Yr=React$2.useMemo(()=>({tooltip:{trigger:"item"},legend:{type:"plain",orient:"horizontal",top:0,left:0,width:340,itemWidth:12,itemHeight:12,itemGap:10,textStyle:{fontSize:12,color:"#EDEDED"},data:Dt.map(Mr=>a==="GRAVITE"?kr(nr(a,Mr.k)):nr(a,Mr.k))},series:[{type:"pie",radius:["15%","50%"],center:["40%","60%"],avoidLabelOverlap:!0,label:{show:!1},labelLine:{show:!1},data:Dt.map(Mr=>({name:a==="GRAVITE"?kr(nr(a,Mr.k)):nr(a,Mr.k),value:Mr.cnt,itemStyle:{color:$t[Mr.k]||$t.NA||"#ccc"}}))}]}),[Dt,$t,a,nr]);return jsxRuntimeExports.jsxs("div",{className:"card map-card",style:{position:"relative"},children:[jsxRuntimeExports.jsxs("div",{style:{position:"absolute",left:10,top:10,zIndex:10,display:"flex",gap:8,flexWrap:"wrap"},children:[jsxRuntimeExports.jsxs("div",{style:{background:"#101010",padding:"6px 8px",borderRadius:8,border:"1px solid #262626",boxShadow:"0 2px 8px rgba(0,0,0,.35)",color:"#EDEDED"},children:[jsxRuntimeExports.jsx("span",{className:"label",style:{marginRight:8},children:"Variable"}),jsxRuntimeExports.jsx("select",{value:a,onChange:Mr=>o(Mr.target.value),children:VAR_OPTIONS.map(Mr=>{const Jr=Mr==="ROUTE_ASPECT"?`${ar(Mr)}`:ar(Mr);return jsxRuntimeExports.jsx("option",{value:Mr,children:Jr},Mr)})})]}),jsxRuntimeExports.jsxs("div",{style:{background:"#101010",padding:"6px 8px",borderRadius:8,border:"1px solid #262626",boxShadow:"0 2px 8px rgba(0,0,0,.35)",color:"#EDEDED"},children:[jsxRuntimeExports.jsx("strong",{style:{marginRight:8},children:"Layers"}),jsxRuntimeExports.jsxs("label",{style:{marginRight:10},children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:c,onChange:Mr=>d(Mr.target.checked)})," Basemap"]}),jsxRuntimeExports.jsxs("label",{style:{marginRight:10},children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:tt,onChange:Mr=>nt(Mr.target.checked)})," Incidents"]}),jsxRuntimeExports.jsxs("label",{style:{marginRight:10},children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:it,onChange:Mr=>st(Mr.target.checked)})," LISA"]}),jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ot,onChange:Mr=>at(Mr.target.checked)})," Neighborhoods"]})]})]}),jsxRuntimeExports.jsx("div",{ref:ft,className:"fill"}),tt&&jsxRuntimeExports.jsxs("details",{className:"floating",style:{left:10,top:60,right:"auto"},open:ut,onToggle:Mr=>ct(Mr.target.open),children:[jsxRuntimeExports.jsxs("summary",{children:["Distribution — ",ar(a)]}),jsxRuntimeExports.jsx(EChartsReact,{option:Yr,style:{height:460,width:380},notMerge:!0})]}),it&&jsxRuntimeExports.jsxs("details",{className:"floating",style:{right:12,top:12,left:"auto",width:"auto",padding:8},children:[jsxRuntimeExports.jsx("summary",{children:"LISA legend"}),jsxRuntimeExports.jsxs("div",{style:{fontSize:13,lineHeight:1.4,marginTop:6},children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{style:{display:"inline-block",width:12,height:12,background:"#8B0000",marginRight:6}})," HH: High–High cluster"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{style:{display:"inline-block",width:12,height:12,background:"#FF6B6B",marginRight:6}})," HL: High–Low outlier"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{style:{display:"inline-block",width:12,height:12,background:"#0B3D91",marginRight:6}})," LL: Low–Low cluster"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{style:{display:"inline-block",width:12,height:12,background:"#5DA9FF",marginRight:6}})," LH: Low–High outlier"]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{style:{display:"inline-block",width:12,height:12,background:"#FFFFFF",border:"1px solid #BDBDBD",marginRight:6}})," Not significant"]})]})]}),window.__INC_TILE_FIELD_MISSING__&&tt&&jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:12,bottom:12,zIndex:15,background:"#101010",border:"1px solid #262626",borderRadius:8,boxShadow:"0 12px 24px rgba(0,0,0,.45)",padding:"8px 10px",maxWidth:520,color:"#EDEDED"},children:jsxRuntimeExports.jsxs("div",{style:{fontSize:13},children:[jsxRuntimeExports.jsxs("b",{style:{color:"#D84040"},children:["Tiles missing “",window.__INC_TILE_FIELD_MISSING__,"”."]}),jsxRuntimeExports.jsx("br",{}),"Points are grey to avoid incorrect colors.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs("span",{className:"small",children:["Schema keys: ",jsxRuntimeExports.jsx("code",{children:(window.__DBG?.schema_keys||[]).join(", ")})]})]})})]})}const palette={redDeep:"#8E1616",redBright:"#D84040",charcoal:"#262626",silver:"#C0C0C0"};function BackButton(){const s={position:"fixed",top:12,left:12,zIndex:2e3},a={display:"inline-flex",alignItems:"center",gap:8,padding:"8px 12px",borderRadius:12,backgroundColor:palette.redDeep,border:`1px solid ${palette.charcoal}`,color:palette.silver,fontWeight:700,fontSize:14,textDecoration:"none",boxShadow:"0 4px 14px rgba(216,64,64,0.25)",transition:"transform 120ms ease, background-color 120ms ease, border-color 120ms ease",willChange:"transform"},o={width:16,height:16,display:"inline-block"};return jsxRuntimeExports.jsx("div",{style:s,children:jsxRuntimeExports.jsxs(Link,{to:"/","aria-label":"Back to main page",style:a,onMouseEnter:c=>{const d=c.currentTarget;d.style.backgroundColor=palette.redBright,d.style.borderColor=palette.redBright,d.style.transform="translateY(-1px)"},onMouseLeave:c=>{const d=c.currentTarget;d.style.backgroundColor=palette.redDeep,d.style.borderColor=palette.charcoal,d.style.transform="translateY(0)"},onMouseDown:c=>c.currentTarget.style.transform="translateY(0)",onMouseUp:c=>c.currentTarget.style.transform="translateY(-1px)",children:[jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",style:o,"aria-hidden":"true",children:jsxRuntimeExports.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),"Back"]})})}function App(){return jsxRuntimeExports.jsxs("div",{className:"top-card",children:[jsxRuntimeExports.jsx(BackButton,{}),jsxRuntimeExports.jsx(TopBar,{}),jsxRuntimeExports.jsxs("div",{className:"grid grid-areas",children:[jsxRuntimeExports.jsx("div",{style:{gridArea:"trend"},children:jsxRuntimeExports.jsx(Block1Trend,{})}),jsxRuntimeExports.jsx("div",{style:{gridArea:"heat"},children:jsxRuntimeExports.jsx(Block2Heatmap,{})}),jsxRuntimeExports.jsx("div",{style:{gridArea:"map"},children:jsxRuntimeExports.jsx(Block3Map,{})})]})]})}const scriptRel="modulepreload",assetsURL=function(s){return"/traffic_collisions/"+s},seen={},__vitePreload=function s(a,o,c){let d=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const nt=document.querySelector("meta[property=csp-nonce]"),it=nt?.nonce||nt?.getAttribute("nonce");d=Promise.allSettled(o.map(st=>{if(st=assetsURL(st),st in seen)return;seen[st]=!0;const ut=st.endsWith(".css"),ct=ut?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${st}"]${ct}`))return;const ot=document.createElement("link");if(ot.rel=ut?"stylesheet":scriptRel,ut||(ot.as="script"),ot.crossOrigin="",ot.href=st,it&&ot.setAttribute("nonce",it),document.head.appendChild(ot),ut)return new Promise((at,ht)=>{ot.addEventListener("load",at),ot.addEventListener("error",()=>ht(new Error(`Unable to preload CSS for ${st}`)))})}))}function tt(nt){const it=new Event("vite:preloadError",{cancelable:!0});if(it.payload=nt,window.dispatchEvent(it),!it.defaultPrevented)throw nt}return d.then(nt=>{for(const it of nt||[])it.status==="rejected"&&tt(it.reason);return a().catch(tt)})},Occurrence=React$2.lazy(()=>__vitePreload(()=>import("./ModelOccurrence-DnJm3VgO.js"),__vite__mapDeps([0,1]))),Severity=React$2.lazy(()=>__vitePreload(()=>import("./ModelSeverity-CKJDnG33.js"),__vite__mapDeps([2,1])));function HeaderBar(){const a=useLocation().pathname.endsWith("/occurrence")?"occurrence":"severity",o={textDecoration:"none"};return jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[jsxRuntimeExports.jsx(Link,{className:"nav-btn",style:o,to:"/",children:"← Back"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:8},children:[jsxRuntimeExports.jsx(Link,{className:"nav-btn",style:{...o,...a==="occurrence"?{borderColor:"#D84040",color:"#fff"}:null},to:"/model/occurrence",children:"Occurrence"}),jsxRuntimeExports.jsx(Link,{className:"nav-btn",style:{...o,...a==="severity"?{borderColor:"#D84040",color:"#fff"}:null},to:"/model/severity",children:"Severity"})]})]})}function ModelPage(){return jsxRuntimeExports.jsxs("div",{className:"model-scope",children:[jsxRuntimeExports.jsx(HeaderBar,{}),jsxRuntimeExports.jsx("div",{className:"page-body",children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx("div",{className:"card",children:"Loading…"}),children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"occurrence",element:jsxRuntimeExports.jsx(Occurrence,{})}),jsxRuntimeExports.jsx(Route,{path:"severity",element:jsxRuntimeExports.jsx(Severity,{})}),jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(Navigate,{to:"/model/severity",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/model/severity",replace:!0})})]})})})]})}function registerChartsTheme(){registerTheme("noir",{backgroundColor:"transparent",color:["#D84040","#8E1616","#808080","#B0B0B0","#262626"],textStyle:{color:"#EDEDED"},tooltip:{backgroundColor:"#0F0F0F",borderColor:"#262626",textStyle:{color:"#EDEDED"}},grid:{left:50,right:20,top:30,bottom:40},axisPointer:{lineStyle:{color:"#808080"}},categoryAxis:{axisLine:{lineStyle:{color:"#808080"}},axisLabel:{color:"#808080"},splitLine:{show:!0,lineStyle:{color:"#262626"}}},valueAxis:{axisLine:{lineStyle:{color:"#808080"}},axisLabel:{color:"#808080"},splitLine:{show:!0,lineStyle:{color:"#262626"}}},legend:{textStyle:{color:"#EDEDED"}}})}ortWeb_minExports.env.wasm.wasmPaths=asset("onnx/");const params=new URLSearchParams(location.search),redirected=params.get("p");if(redirected){const s=new URL(location.href);s.searchParams.delete("p"),history.replaceState(null,"",redirected+s.search+s.hash)}registerChartsTheme();client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$2.StrictMode,{children:jsxRuntimeExports.jsx(HashRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Landing,{})}),jsxRuntimeExports.jsx(Route,{path:"/dashboard",element:jsxRuntimeExports.jsx(App,{})}),jsxRuntimeExports.jsx(Route,{path:"/model/*",element:jsxRuntimeExports.jsx(ModelPage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/model/occurrence",replace:!0})})]})})}));export{EChartsReact as E,React$2 as R,asset as a,jsxRuntimeExports as j,ortWeb_minExports as o,registerTheme as r};
